"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[6148],{18878:(e,t,i)=>{i.d(t,{mo:()=>h,nH:()=>M,mX:()=>y});var s=i(23174),o=i.n(s),n=i(67294),r=i(81954),a=i(24405),d=i(27006),l=i(97880),m=i(82990),c=i(5366),u=i(34859),g=i(79315),p=i(18647),f=i(65991);function h(e){window.__c={n:"RestorePermissionEdits"};const{openState:t}=e,{mainEditorCurrentBlockStore:i,currentSpaceStore:s}=(0,r.VK)((()=>g.default.state),[]),n=(0,a.yK)((e=>({scroller:{display:"flex",flexDirection:"column",maxHeight:290},editContainer:{marginTop:2,marginBottom:2,color:e.regularTextColor}})),[]);if(!i||!s)return null;const d=Date.now();return o()(p.Z,{type:u.Z.Y,style:n.scroller},void 0,t.permissionChanges.map(((e,t)=>{let[r,a]=e;const l={timestamp:d,space_id:s.id,type:"permission-changed",permission_data:{before:r,after:a}};return o()("div",{style:n.editContainer},`${r.type}-${t}`,o()(f.Z,{rootStore:i,edit:l}))})))}function M(e){return["remove","restrict"].includes(e.type)?o()(c.FormattedMessage,{id:"restrictedPermissionConfirmationModal.actionButton.restrictAccess",defaultMessage:"Restrict access"}):"restoreTeamPermissions"===e.type?o()(c.FormattedMessage,{id:"restrictedPermissionConfirmationModal.actionButton.restoreTeamPermissions",defaultMessage:"Reset Permissions"}):o()(c.FormattedMessage,{id:"restrictedPermissionConfirmationModal.actionButton.restoreAccess",defaultMessage:"Restore access"})}function y(e){switch(e.type){case"remove":return o()(c.FormattedMessage,{id:"restrictedPermissionConfirmationModal.restrict.description",defaultMessage:"Are you sure you want to remove this {permissionGroup} and restrict access? This page will no longer inherit share settings from the parent page.",values:{permissionGroup:C(e)}});case"restrict":return o()(c.FormattedMessage,{id:"restrictedPermissionConfirmationModal.remove.description",defaultMessage:"Are you sure you want to change this role and restrict access? This page will no longer inherit share settings from the parent page."});case"restore":return e.permissionChanges.length>0?o()(c.FormattedMessage,{id:"restrictedPermissionConfirmationModal.restore.description",defaultMessage:"Are you sure you want to restore access? This will inherit the following permissions from the parent page:"}):o()(c.FormattedMessage,{id:"restrictedPermissionConfirmationModal.restoreNoChanges.description",defaultMessage:"Are you sure you want to restore access?"});case"restoreTeamPermissions":return n.createElement(n.Fragment,null,o()("div",{style:{fontWeight:m.Z.fontWeight.semibold,marginBottom:4}},void 0,o()(c.FormattedMessage,{id:"restrictedPermissionConfirmationModal.restoreTeamPermissions.mainDescription",defaultMessage:"Are you sure you want to reset permissions to match the teamspace defaults?"})),o()(c.FormattedMessage,{id:"restrictedPermissionConfirmationModal.restoreTeamPermissions.warningMessage",defaultMessage:"Everyone else who is not part of the teamspace will lose access, including guests."}));default:throw l.t1(e)}}function C(e){return(0,d.jg)(e.permissionItem)?o()(c.FormattedMessage,{id:"restrictedPermissionConfirmationModal.permissionGroup.user",defaultMessage:"user"}):(0,d.hV)(e.permissionItem)?o()(c.FormattedMessage,{id:"restrictedPermissionConfirmationModal.permissionGroup.group",defaultMessage:"group"}):(0,d.ix)(e.permissionItem)?o()(c.FormattedMessage,{id:"restrictedPermissionConfirmationModal.permissionGroup.space",defaultMessage:"workspace"}):o()(c.FormattedMessage,{id:"restrictedPermissionConfirmationModal.permissionGroup.generic",defaultMessage:"permission"})}},6148:(e,t,i)=>{i.d(t,{q:()=>Z,Z:()=>A});var s=i(23174),o=i.n(s),n=i(67294),r=i(480),a=i(81954),d=i(24405),l=i(15145),m=i(53397),c=i(26825),u=i(29369),g=i(97880),p=i(82990),f=i(5366),h=i(57688),M=i(84210),y=i(98165),C=i(47307),v=i(76464),P=i(12359),w=i(18878);var b=i(25464),S=i(68216),B=i(48690),x=i(84076),R=i(76798),F=i(62385),T=i(58032),k=i(64369);function A(e){window.__c={n:"PermissionsRestoreBanner"};const{showRestoreButton:t,store:i,type:s,sudoModeStore:n}=e,{isMobile:l}=(0,r.Fy)(),m=(0,a.VK)((()=>y.uJ(i)[1]),[i]),c=(0,r.O7)(),u=(0,a.VK)((()=>({paddingLeft:c.WindowSizeStore.getSafePaddingLeftCSS(14),paddingRight:c.WindowSizeStore.getSafePaddingLeftCSS(14)})),[c]),g=(0,d.yK)((e=>({container:{display:"flex",minHeight:20,flexDirection:"row",alignItems:"center",paddingTop:8,paddingBottom:6,paddingLeft:u.paddingLeft,paddingRight:u.paddingRight},banner:{display:"flex",flexDirection:"row",width:"100%",fontSize:12},icon:{width:16,fill:e.mediumIconColor},iconContainer:{width:20,height:20,display:"flex",justifyContent:"center",alignItems:"center",marginRight:5},messageContainer:{display:"flex",flexDirection:"column"},label:{display:"inline",marginLeft:l?14:0,color:l?"#CF8807":e.mediumTextColor,fontWeight:l?p.Z.fontWeight.regular:p.Z.fontWeight.medium,marginRight:6,lineHeight:"20px"},buttonContainer:{marginLeft:-5},divider:{opacity:"75%"},mobileContainer:{borderRadius:4,height:34,marginLeft:14,marginRight:14,marginTop:5,marginBottom:5,paddingRight:9,display:"flex",alignItems:"center",justifyContent:"space-between",backgroundColor:"rgba(246, 192, 80, 0.26)"}})),[l,u]);return l?o()("div",{style:g.mobileContainer},void 0,o()(k.Z,{isMultiline:!0,isSmall:!0,style:g.label},void 0,o()(W,{type:s,navigableParentStore:m,showRestoreButton:t})),t&&o()(L,{store:i,type:s})):o()("div",{style:g.container},void 0,o()("div",{style:g.banner},void 0,o()("div",{style:g.iconContainer},void 0,_[s](g.icon)),o()("div",{},void 0,o()(k.Z,{isMultiline:!0,isSmall:!0,isSecondaryColor:!0,style:g.label},void 0,o()(W,{type:s,navigableParentStore:m,showRestoreButton:t})),t&&o()("span",{style:g.buttonContainer},void 0,o()(L,{store:i,type:s,sudoModeStore:n})))))}function L(e){window.__c={n:"PermissionsRestoreButton"};const{type:t,store:i,sudoModeStore:s}=e,{isMobile:l}=(0,r.Fy)(),m=(0,a.VK)((()=>!!s&&s.shouldSaveTransactionWithSudoMode(i)),[i,s]),u=(0,d.yK)((e=>({button:{color:l?"#CF8807":e.regularTextColor,fontWeight:p.Z.fontWeight.medium},tooltip:{width:210,whiteSpace:"initial"}})),[l]),h=(0,r.O7)();if("restore-team"===t){const e=async()=>{await async function(e){const{environment:t,useSudoMode:i,store:s}=e,n={type:"restoreTeamPermissions",permissionChanges:[]};await C.confirmUserAction({message:(0,w.mX)(n),acceptLabel:(0,w.nH)(n),cancelLabel:o()(f.FormattedMessage,{id:"restrictedPermissionConfirmationModal.actionButton.cancel",defaultMessage:"Close"})})&&P.createAndCommit({userAction:"PermissionsRestoreBanner.restoreTeamPermissions",environment:t,useSudoMode:i,perform:e=>{v.Kh({environment:t,store:s,transaction:e})}})}({environment:h,useSudoMode:m,store:i})};return o()(T.Z,{style:u.tooltip,placement:b.u.Bottom,renderTooltip:()=>o()(f.FormattedMessage,{defaultMessage:"Reset page permissions to match default teamspace permissions",id:"permissionsRestoreBanner.tooltip.teamPermissions"}),render:t=>n.createElement("span",t,o()(F.Z,{style:u.button,onClick:e},void 0,o()(f.FormattedMessage,{id:"permissionsRestoreBanner.button.teamPermissions",defaultMessage:"Reset"})))})}if("unrestrict"===t){const e=async()=>{const e=i.getPermissionItems(),t=y.Om(i),s=t?(0,c.Wo)(y.fJ(t)):[],n=(0,c.Xr)(e,s);await async function(e){const{environment:t,useSudoMode:i,store:s,permissionChanges:n}=e,r={type:"restore",permissionChanges:n};await C.confirmUserAction({message:(0,w.mX)(r),acceptLabel:(0,w.nH)(r),cancelLabel:o()(f.FormattedMessage,{id:"restrictedPermissionConfirmationModal.actionButton.cancel",defaultMessage:"Close"}),description:o()(w.mo,{openState:r})})&&(s.getPermissionItemsStore().canAdmin()?P.createAndCommit({userAction:"PermissionsRestoreBanner.restoreRestrictedPermissions",environment:t,useSudoMode:i,perform:e=>{v.MX({environment:t,store:s,transaction:e})}}):v.hs({environment:t,store:s}))}({environment:h,useSudoMode:m,store:i,permissionChanges:n})};return o()(F.Z,{style:u.button,onClick:e},void 0,o()(f.FormattedMessage,{id:"permissionsRestoreBanner.button.restrictedPermissions",defaultMessage:"Restore"}))}(0,g.t1)(t)}function Z(e){window.__c={n:"ClickableAttribution"};const{navigableParentStore:t,maxLength:i,showUnderline:s}=e,{isMobile:n}=(0,r.Fy)(),m=(0,r.O7)(),c=(0,d.yK)((e=>({linkBox:{color:e.mediumTextColor},title:{display:"inline"}})),[]),g=(0,a.VK)((()=>{if(t instanceof S.G)return(0,M.ZP)({store:t,fullyQualified:!1,pageVisitSource:l.tY.LinkInPage})}),[t]);if(!t)return null;const p=n&&t.table===u.e0;return o()(x.Z,{disabled:p,style:p?void 0:c.linkBox,underline:s&&!p,inline:!0,onClick:t.table===u.e0?()=>{t.table===u.e0&&h.RF({environment:m,teamId:t.id,tab:B.a.Members,from:"permission_item"})}:void 0,href:g},void 0,o()(R.Z,{shouldWrap:!0,maxLength:i,store:t,style:c.title}))}function W(e){window.__c={n:"PermissionsRestoreBannerLabel"};const{type:t,navigableParentStore:i,showRestoreButton:s}=e,{isMobile:n}=(0,r.Fy)(),a=o()(Z,{navigableParentStore:i,maxLength:n||!s?void 0:30,showUnderline:!0});switch(t){case"restore-team":return o()(f.FormattedMessage,{id:"pageShareMenu.restoreTeamPermissionsBanner.label",defaultMessage:"Page access is different from {linkBoxWithPageTitle}.",values:{linkBoxWithPageTitle:a}});case"unrestrict":return o()(f.FormattedMessage,n?{id:"pageShareMenu.restrictedAccessBanner.mobileLabel",defaultMessage:"Page access is restricted to people below.",values:{linkBoxWithPageTitle:a}}:{id:"pageShareMenu.restrictedAccessBanner.label",defaultMessage:"Access restricted. May not be shared with everyone from {linkBoxWithPageTitle}.",values:{linkBoxWithPageTitle:a}});default:(0,g.t1)(t)}}const _={unrestrict:m.Z.eyeHide,"restore-team":m.Z.info}}}]);