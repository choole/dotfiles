"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[9380],{81346:(e,t,o)=>{o.r(t),o.d(t,{default:()=>S});var s=o(10434),r=o.n(s),n=o(23174),a=o.n(n),i=(o(57658),o(67294)),c=o(83355),l=o(1302),d=o(32739),p=o(70203),m=o(5366),u=o(84908),g=o(98104),f=o(95477),k=o(87279),b=o(68056),h=o(80935),y=o(758),M=o(81212),N=o(45214),_=o(24666),E=o(93405),v=o(52275),I=o(1743),T=o(78140),A=o(32163),Z=o(44532),C=o(72495);class x extends c.Z{constructor(){super(...arguments),this.handleContextMenu=(e,t)=>{if(e.preventDefault(),t.misspelledWord){const e=_.default.state,o="editing"===e.mode&&(0,b.QY)(e.multiSelection);if(o&&o.selection.startIndex===o.selection.endIndex){const e=p.Oq(o.store.getValue()||[],t.misspelledWord),s=o.selection.startIndex,r=p.PE(e,s);r&&g.Z5({store:o.store,selection:r})}}N.Z.setState({open:!0,menuInfo:t})},this.handleDismiss=()=>{N.Z.setState({...N.Z.state,open:!1})}}willMount(){u.electronApi&&u.electronApi.contextMenu&&u.electronApi.contextMenu.addListener(this.handleContextMenu)}willUnmount(){u.electronApi&&u.electronApi.contextMenu&&u.electronApi.contextMenu.removeListener(this.handleContextMenu)}renderComponent(){const{menuInfo:e,open:t}=N.Z.state,{device:o}=this.environment,{x:s,y:r}=this.getClickPosition(e),n=new DOMRect(s,r,0,0),i=e?this.getMenuSections(e):[],c=document.activeElement,d=h.get();let p=null,m=null;(c instanceof HTMLInputElement||c instanceof HTMLTextAreaElement)&&(p=c.selectionStart,m=c.selectionEnd);for(const a of i)for(const e of a.items){const t=e.action;e.action=e=>{c.focus(),c instanceof HTMLInputElement||c instanceof HTMLTextAreaElement?(c.selectionStart=p,c.selectionEnd=m):d&&h.set(d,o),l.default.afterNextFlush((()=>{t(e)}))}}return a()(Z.ZP,{open:t&&i.length>0,popupType:Z.ZP.PopupType.Popup,originRect:n,render:()=>a()(I.Z,{capture:!0,allowEsc:!0},void 0,a()(T.Z,{menuType:k.og.Popup},void 0,a()(A.Z,{type:A.i.Vertical,sections:i,initialFocus:void 0,onAccept:this.handleDismiss}))),onDismiss:this.handleDismiss,overlayContainerStore:M.Z})}getClickPosition(e){const t=u.getCurrentZoom();return{x:e?e.x/t:0,y:e?e.y/t:0}}getMenuSections(e){const t=[],o=this.getSpellingCorrectionItems(e);if(o.length>0){const e=t.length>0;t.push({key:"spellingCorrectionItems",items:o,render:t=>i.createElement(C.Z,r()({},t,{topBorder:e}))})}const s=this.getDisableSpellCheckItems(e);if(s.length>0){const e=t.length>0;t.push({key:"disableSpellCheckItems",items:s,render:t=>i.createElement(C.Z,r()({},t,{topBorder:e}))})}const n=this.getSearchItems(e);if(n.length>0){const e=t.length>0;t.push({key:"searchItems",items:n,render:t=>i.createElement(C.Z,r()({},t,{topBorder:e}))})}const a=this.getLinkMenuItems(e);if(a.length>0){const e=t.length>0;t.push({key:"linkMenuItems",items:a,render:t=>i.createElement(C.Z,r()({},t,{topBorder:e}))})}const c=this.getImageMenuItems(e);if(c.length>0){const e=t.length>0;t.push({key:"imageMenuItems",items:c,render:t=>i.createElement(C.Z,r()({},t,{topBorder:e}))})}const l=this.getTextEditingItems(e);if(l.length>0){const e=t.length>0;t.push({key:"textEditingItems",items:l,render:t=>i.createElement(C.Z,r()({},t,{topBorder:e}))})}const d=this.getEnableSpellCheckItem(e);if(d.length>0){const e=t.length>0;t.push({key:"enableSpellCheckItems",items:d,render:t=>i.createElement(C.Z,r()({},t,{topBorder:e}))})}return t}getLinkMenuItems(e){const t=[];return e.linkURL&&e.linkURL.length>0&&(e.linkURL.startsWith("mailto:")?t.push({key:"copy-email",action:()=>{u.electronApi&&u.electronApi.copyText&&u.electronApi&&u.electronApi.copyText(e.linkText)},render:e=>i.createElement(v.Z,r()({},e,{title:a()(m.FormattedMessage,{defaultMessage:"Copy email address",id:"desktop.rightClickMenu.copyEmailAddress"})}))}):t.push({key:"copy-link",action:()=>{u.electronApi&&u.electronApi.copyText&&u.electronApi&&u.electronApi.copyText(d.b({url:e.linkURL,domainBaseUrl:f.default.domainBaseUrl,protocol:f.default.protocol}))},render:e=>i.createElement(v.Z,r()({},e,{title:a()(m.FormattedMessage,{defaultMessage:"Copy link",id:"desktop.rightClickMenu.copyLink"})}))}),t.push({key:"open-link",action:()=>{u.electronApi&&u.electronApi.openExternalUrl(d.b({url:e.linkURL,domainBaseUrl:f.default.domainBaseUrl,protocol:f.default.protocol}))},render:e=>i.createElement(v.Z,r()({},e,{title:a()(m.FormattedMessage,{defaultMessage:"Open link in browser",id:"desktop.rightClickMenu.openLinkInBrowser"})}))})),t}getImageMenuItems(e){const t=[];return e.hasImageContents&&e.srcURL&&e.srcURL.length>0&&(t.push({key:"copy-image",action:()=>{u.electronApi&&u.electronApi.copyImage&&u.electronApi.copyImage(e.srcURL)},render:e=>i.createElement(v.Z,r()({},e,{title:a()(m.FormattedMessage,{defaultMessage:"Copy image",id:"desktop.rightClickMenu.copyImage"})}))}),t.push({key:"copy-image-address",action:()=>{u.electronApi&&u.electronApi.copyText&&u.electronApi.copyText(e.srcURL)},render:e=>i.createElement(v.Z,r()({},e,{title:a()(m.FormattedMessage,{defaultMessage:"Copy image address",id:"desktop.rightClickMenu.copyImageAddress"})}))})),t}isEditing(e){return e.isEditable||e.inputFieldType&&"none"!==e.inputFieldType}hasMisspelling(e){return this.isEditing(e)&&e.misspelledWord&&e.misspelledWord.length>0}getSpellingCorrectionItems(e){const t="SpellCheckStore"in this.environment&&this.environment.SpellCheckStore,o=[];if(this.hasMisspelling(e)&&t&&t.isEnabled()){const s=t.getCorrections(e);for(const e of s)o.push({key:e,action:()=>{u.electronApi&&u.electronApi.replaceMisspelling&&u.electronApi.replaceMisspelling(e)},render:t=>i.createElement(v.Z,r()({},t,{title:e}))})}return o}getDisableSpellCheckItems(e){const t="SpellCheckStore"in this.environment&&this.environment.SpellCheckStore,o=[];return this.hasMisspelling(e)&&t&&t.isEnabled()&&!(0,y.x)(t)&&o.push({key:"learn-spelling",action:()=>{t.addToDictionary(e.misspelledWord)},render:e=>i.createElement(v.Z,r()({},e,{title:a()(m.FormattedMessage,{defaultMessage:"Add to dictionary",id:"desktop.spellcheckMenuItem.addToDictionary.title"})}))}),this.hasMisspelling(e)&&t&&t.isEnabled()&&o.push({key:"disable",action:()=>{t.setEnabled(!1)},render:e=>i.createElement(v.Z,r()({},e,{title:a()(m.FormattedMessage,{defaultMessage:"Disable spell check",id:"desktop.spellcheckMenuItem.disableSpellcheck.title"})}))}),o}getEnableSpellCheckItem(e){const t="SpellCheckStore"in this.environment&&this.environment.SpellCheckStore,o=[];return this.isEditing(e)&&t&&!t.isEnabled()&&o.push({key:"enable",action:()=>{t.setEnabled(!0)},render:e=>i.createElement(v.Z,r()({},e,{title:a()(m.FormattedMessage,{defaultMessage:"Enable spell check",id:"desktop.spellcheckMenuItem.enableSpellcheck.title"})}))}),o}getSearchItems(e){const t=[];return e.selectionText&&e.selectionText.length>0&&t.push({key:"google",action:()=>{if(u.electronApi){const t=`https://www.google.com/search?q=${encodeURIComponent(e.selectionText.trim())}`;u.electronApi.openExternalUrl(t)}},render:e=>i.createElement(v.Z,r()({},e,{title:a()(m.FormattedMessage,{defaultMessage:"Search with Google",id:"desktop.searchMenuItem.searchWithGoogle.title"})}))}),t}getTextEditingItems(e){const t=[];return this.isEditing(e)&&(e.editFlags.canCut&&t.push({key:"cut",action:()=>{u.electronApi&&u.electronApi.cut&&u.electronApi.cut()},render:e=>i.createElement(E.Z,r()({},e,{title:a()(m.FormattedMessage,{defaultMessage:"Cut",id:"desktop.textEditingMenuItem.cutAction.title"}),shortcuts:["cut"]}))}),e.editFlags.canCopy&&t.push({key:"copy",action:()=>{u.electronApi&&u.electronApi.copy&&u.electronApi.copy()},render:e=>i.createElement(E.Z,r()({},e,{title:a()(m.FormattedMessage,{defaultMessage:"Copy",id:"desktop.textEditingMenuItem.copyAction.title"}),shortcuts:["copy"]}))}),e.editFlags.canPaste&&t.push({key:"paste",action:()=>{u.electronApi&&u.electronApi.paste&&u.electronApi.paste()},render:e=>i.createElement(E.Z,r()({},e,{title:a()(m.FormattedMessage,{defaultMessage:"Paste",id:"desktop.textEditingMenuItem.pasteAction.title"}),shortcuts:["paste"]}))})),t}}x.displayName="ElectronContextMenu";const S=x},45214:(e,t,o)=>{o.d(t,{Z:()=>n});var s=o(49085);class r extends s.default{getInitialState(){return{open:!1}}}const n=new r},60951:(e,t,o)=>{o.r(t),o.d(t,{Notification:()=>h});var s=o(96486),r=o.n(s),n=o(40902),a=o(66897),i=o(99036),c=o(38297),l=o(55384),d=o(55061),p=o(21202),m=o(13493),u=o(70279),g=o(19889),f=o(70203),k=o(44805),b=o(64002);function h(e){const{activity:t,getRecordValue:o,baseURL:s,userTimeZone:h,pageVisitSource:M,intl:N,useSimplifiedEmailSubjectForGrouping:_}=e,E=l.om.fromGetRecordValueFn(o),v=(0,d.P6)({...e}),I=(0,d.XW)(v,N),T=(0,d.oP)({...e,intl:N}),A=(0,d.iR)({...e,intl:N}),Z=(0,d.rn)({...e,intl:N});switch(t.type){case"top-level-block-created":return{subject:N.formatMessage(d.qJ.topLevelBlockCreated,{userName:I,targetName:T,spaceName:Z})};case"top-level-block-deleted":return{subject:N.formatMessage(d.qJ.topLevelBlockDeleted,{userName:I,targetName:T,spaceName:Z})};case"collection-row-created":return{subject:N.formatMessage(d.qJ.collectionRowCreated,{userName:I,targetName:T,collectionName:A})};case"collection-row-deleted":return{subject:N.formatMessage(d.qJ.collectionRowDeleted,{userName:I,targetName:T,collectionName:A})};case"block-edited":{let a;if(t.edits){const l=t.edits[0];if("block-changed"===l.type){const t=l.block_data.after.block_value,p=(0,c.ky)({block:t,getRecordValue:o});if("page"===t.type&&p){const t=l.block_schema||i.Kc(N),s=n.OS({before:l.block_data.before.block_value,after:l.block_data.after.block_value,schema:t}).filter((e=>{const o=t[e];return o&&"formula"!==o.type})).map((s=>{const r=t[s],n=r?r.name:void 0,a=(0,d.v4)({intl:N,property:s,schema:t,block:l.block_data.after.block_value,getRecordValue:o,userTimeZone:e.userTimeZone,baseURL:e.baseURL})||N.formatMessage(d.qJ.emptyBlockEditedProperty);return N.formatMessage(d.qJ.propertyNameAndValueEdited,{propertyName:n,propertyValue:a})})),c=n.B9({before:l.block_data.before.block_value,after:l.block_data.after.block_value}),p=r().compact(c.map((e=>{const t=(0,d._u)({formatProperty:e,intl:N}),s=(0,d.W9)({formatProperty:e,intl:N,block:l.block_data.after.block_value,getRecordValue:o});if(t&&s)return N.formatMessage(d.qJ.propertyNameAndValueEdited,{propertyName:t,propertyValue:s})})));a=N.formatList(s.concat(p),{type:"conjunction",style:"narrow"})}else a=(0,d._2)({intl:N,blockValue:t,getRecordValue:o,baseURL:s,userTimeZone:h})}else if("block-created"===l.type){const e=l.block_data.block_value;a=(0,d._2)({intl:N,blockValue:e,getRecordValue:o,baseURL:s,userTimeZone:h})}else if("block-deleted"===l.type){const e=l.block_data.block_value,t=(0,d._2)({intl:N,blockValue:e,getRecordValue:o,baseURL:s,userTimeZone:h});a=N.formatMessage(d.qJ.blockDeletedEditBody,{renderedBlock:t})}}return{subject:_?y(T,N):N.formatMessage(d.qJ.blockEditedNotification,{userName:I,blockName:T}),body:a}}case"block-property-edited":const C={subject:_?y(T,N):N.formatMessage(d.qJ.blockPropertyEditedNotification,{userName:I,blockName:T}),body:void 0};if(t.edits){const s=t.edits[0],r=Object.entries(s.property_updates).filter((e=>{let[t,o]=e;const r=s.filtered_block_schema[t];return r&&!["formula","created_by","created_time"].includes(r.type)})).map((t=>{let[r,n]=t;const a=s.filtered_block_schema[r],i=a?a.name:void 0,c=(0,d.Wy)({intl:N,propertySchema:a,textValue:n.after.value,getRecordValue:o,userTimeZone:e.userTimeZone,baseURL:e.baseURL})||N.formatMessage(d.qJ.emptyBlockEditedProperty);return N.formatMessage(d.qJ.propertyNameAndValueEdited,{propertyName:i,propertyValue:c})}));C.body=N.formatList(r,{type:"conjunction",style:"narrow"})}return C;case"permissions-edited":return{subject:N.formatMessage(d.qJ.userEditedPermissionsFor,{userName:I,targetName:T}),body:(0,d.gt)({intl:N,activity:t,getRecordValue:o,pageVisitSource:M,userTimeZone:e.userTimeZone})};case"user-mentioned":return{subject:_?y(T,N):N.formatMessage(d.qJ.userMentionedIn,{userName:I,targetName:T}),body:(0,d.kU)({intl:N,getRecordValue:o,baseURL:s,userTimeZone:e.userTimeZone,blockId:t.mentioned_block_id,property:t.mentioned_property})};case"commented":{let s;if(t.edits){const r=t.edits[0];if("comment-created"===r.type){const t=o({table:u.x_,id:r.comment_id,spaceId:r.space_id}),n=r.comment_data||t;n&&(s=`💬 ${k.Xh({intl:N,textValue:n.text,getRecordModel:E,userTimeZone:e.userTimeZone})}`)}else if("comment-changed"===r.type)s=`💬 ${k.Xh({intl:N,textValue:r.comment_data.after.text,getRecordModel:E,userTimeZone:e.userTimeZone})}`;else{const t=o({table:u.x_,id:r.comment_id,spaceId:r.space_id}),n=r.comment_data||t;if(n){const t=k.Xh({intl:N,textValue:n.text,getRecordModel:E,userTimeZone:e.userTimeZone});s=N.formatMessage(d.qJ.userDeletedComment,{commentText:t})}}}return{subject:_?y(T,N):N.formatMessage(d.qJ.userCommentedSubject,{userName:I,targetName:T}),body:s}}case"user-invited":const x=(0,b.pE)(T),S=x.length>0?x:N.formatMessage(d.qJ.defaultPageName);if(t.permission_group_id)return{subject:N.formatMessage(d.qJ.userAddedToSpace,{userName:I,workspaceName:S})};return{subject:0===v.filter(a.uC).length?N.formatMessage(d.qJ.userInvitedToSpaceByBot,{workspaceName:S}):N.formatMessage(d.qJ.userInvitedToSpace,{userName:I,workspaceName:S})};case"collection-edited":{let e,o=N.formatMessage(d.qJ.userEditedCollectionSubject,{userName:I,collectionName:T});if(t.edits){const s=t.edits[0];if("collection-changed"===s.type&&s.collection_data){const t=s.collection_data.after?s.collection_data.after.description:void 0,r=s.collection_data.before?s.collection_data.before.description:void 0;r&&!t?o=N.formatMessage(d.qJ.collectionDescriptionDeleted,{userName:I,collectionName:T}):!r&&t?(o=N.formatMessage(d.qJ.collectionDescriptionCreated,{userName:I,collectionName:T}),e=f.Jc(t)):r&&t&&n.Dn(r,t)&&(e=f.Jc(t))}else if("collection-created"===s.type&&s.collection_data){const t=s.collection_data.description;t&&(o=N.formatMessage(d.qJ.userCreatedCollectionSubject,{userName:I,collectionName:T}),e=f.Jc(t))}}return{subject:o,body:e}}case"collection-view-edited":const R=e.getRecordValue({table:m.n,id:t.collection_view_id,spaceId:t.space_id}),q=R&&R.name||N.formatMessage(d.qJ.untitledCollectionView);return{subject:N.formatMessage(d.qJ.collectionViewEditedSubject,{userName:I,collectionViewName:q,collectionName:T})};case"collection-property-edited":const J=t.edits&&t.edits[0],j=J&&("collection-property-changed"===J.type?J.collection_property_data.after.name:J.collection_property_data.name)||N.formatMessage(d.qJ.collectionPropertyEditedUnknown);return t.collection_property_id,{subject:N.formatMessage(d.qJ.collectionPropertyEditedSubject,{userName:I,propertyType:j,collectionName:T})};case"reminder":return{subject:N.formatMessage(d.qJ.reminderSubject,{pageName:T}),body:(0,d.kU)({getRecordValue:o,baseURL:s,userTimeZone:e.userTimeZone,blockId:t.reminder_block_id,property:t.reminder_property,intl:N})};case"permission-group-edited":return{subject:(0,d.pF)({activity:t,intl:N,userName:I,targetName:T})};case"page-locked":case"page-unlocked":return{subject:"page-locked"===t.type?N.formatMessage(d.qJ.pageLockedActivity,{userName:I,pageName:T}):N.formatMessage(d.qJ.pageUnlockedActivity,{userName:I,pageName:T})};case"email-edited":return{subject:N.formatMessage(d.qJ.emailEditedActivity,{userName:I})};case"access-requested":return{subject:t.parent_table===p.iU?N.formatMessage(d.qJ.accessRequestedSubject,{userName:I,pageName:T}):N.formatMessage(d.qJ.membershipRequestedSubject,{userName:I,workspaceName:T})};case"page-deleted":return{subject:N.formatMessage(d.qJ.pageDeletedActivity,{userName:I})};case"page-restored":return{subject:N.formatMessage(d.qJ.pageRestoredActivity,{userName:I})};case"page-permanently-deleted":return{subject:N.formatMessage(d.qJ.pagePermanentlyDeletedActivity,{userName:I})};case"team-membership-edited":return{subject:N.formatMessage(d.qJ.userInvitedToTeam,{userName:I,teamName:T})};case"private-content-transferred":const V=t.edits&&t.edits[0].from_user_id;if(!V)return{subject:N.formatMessage({defaultMessage:"{author} transferred private content to you: {pageName}",id:"pushNotification.privateContentTransferred.noFromUserName"},{author:I,pageName:T})};const L=o({table:g.KJ,id:V});return{subject:N.formatMessage(d.qJ.privateContentTransferred,{author:I,pageName:T,fromUserName:L&&l.kk.fromValue(g.KJ,L).getFullName(N)})};case"permission-group-mentioned":const U=(0,d.Bg)({spaceId:t.space_id,permissionGroupId:t.mentioned_group_id,getRecordValue:e.getRecordValue}),w=(0,d.jQ)(N,U);return{subject:_?y(T,N):N.formatMessage(d.qJ.permissionGroupMentionedIn,{userName:I,targetName:T,groupName:w}),body:(0,d.kU)({intl:N,getRecordValue:o,baseURL:s,userTimeZone:e.userTimeZone,blockId:t.navigable_block_id,property:t.mentioned_property})};case"verification-expired":return{subject:N.formatMessage(d.qJ.verificationExpired,{pageName:T})}}}function y(e,t){return t.formatMessage({defaultMessage:"New activity in {pageTitle}",id:"emailActivity.pageActivity.simplifiedSubjectLine"},{pageTitle:e})}}}]);