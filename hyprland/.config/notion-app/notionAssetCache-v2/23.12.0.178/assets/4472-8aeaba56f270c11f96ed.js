"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[4472],{48298:(e,t,s)=>{s.d(t,{kn:()=>u,kj:()=>g,Tr:()=>b});var o=s(58129),a=s(90468),i=s(19889),n=s(50906),r=s(54642),l=s(76464),d=s(9953),c=s(12359),p=s(68216),m=s(98905);const u=async e=>{const{environment:t,store:s,accessRequestStore:o,forActor:a,status:r,from:p}=e,m=t.currentUser.id;if("approved"===r){const e={type:"existingUser",value:a,spaceRole:"read_and_write"};if(!(await l.n_({environment:t,store:s,inviteTargets:[e],inviteRole:"read_and_write",isOnboarding:!1,invite:{inviteOrigin:"membership_request"}})).success)return}c.createAndCommit({userAction:"GrantAccessActivityAction.handleGrantAccess",environment:t,perform:e=>{d.sW({store:o,transaction:e,data:{granted_time:Date.now(),granted_by_table:i.KJ,granted_by_id:m,resolved_time:Date.now(),resolved_by_table:i.KJ,resolved_by_id:m,status:r}})}}),n.O8I(t,{status:r,request_id:o.id,from:p,for_actor_id:a.id,space_role:s.getRole()})};async function g(e){if(m.Z.reset(),!e.canAdmin)return;const{environment:t,spaceId:s}=e,o=await r.getUnreadAccessRequestCount(t,{parentTable:a.bx,parentId:s,size:1});"success"===o.type&&m.Z.setState({spaceId:s,count:o.data.count})}function b(e,t){const s=new Map;for(const a of t){const t=(0,p.Kv)(e,{table:o.J8,id:a}),n=t.getValue();if(!n)continue;if(n.for_actor_table!==i.KJ||n.created_by_table!==i.KJ)continue;const r=(0,p.Kv)(e,{table:n.for_actor_table,id:n.for_actor_id}).getValue();if(!r)continue;const l=(0,p.Kv)(e,{table:n.created_by_table,id:n.created_by_id}).getValue();if(l)if(s.has(n.for_actor_id)){const e=s.get(n.for_actor_id);if(!e)continue;n.created_time>e.latestRequestTime?s.set(n.for_actor_id,{...e,createdByActorsWithReason:[{actor:l,reason:n.message},...e.createdByActorsWithReason],accessRequest:n,accessRequestStore:t,latestRequestTime:n.created_time}):s.set(n.for_actor_id,{...e,createdByActorsWithReason:[...e.createdByActorsWithReason,{actor:l,reason:n.message}]})}else s.set(n.for_actor_id,{forActor:r,createdByActorsWithReason:[{actor:l,reason:n.message}],accessRequest:n,accessRequestStore:t,latestRequestTime:n.created_time})}return Array.from(s.values())}},15025:(e,t,s)=>{s.d(t,{zq:()=>d,ac:()=>c,VR:()=>p});var o=s(23174),a=s.n(o),i=(s(67294),s(24405)),n=s(53397),r=s(5366);function l(e){window.__c={n:"CapabilityItem"};const{enabled:t,labelIfEnabled:s,labelIfDisabled:o}=e,r=(0,i.yK)((e=>({container:{color:t?e.mediumTextColor:e.lightTextColor}})),[t]);return a()("div",{style:r.container},void 0,function(e){const t={width:12,display:"inline",verticalAlign:"middle"};return e?n.Z.thinCheck(t):n.Z.close(t)}(t)," ",t?s:o)}function d(e){const t="none"!==e;return[a()(l,{enabled:t&&e.read_content,labelIfEnabled:a()(r.FormattedMessage,{id:"capabilitiesTooltip.mixedAccess.readContent.enabled",defaultMessage:"Can read content."}),labelIfDisabled:a()(r.FormattedMessage,{id:"capabilitiesTooltip.mixedaccess.readContent.disabled",defaultMessage:"Cannot read content."})},"read_content"),a()(l,{enabled:t&&e.insert_content,labelIfEnabled:a()(r.FormattedMessage,{id:"capabilitiesTooltip.mixedaccess.insertContent.enabled",defaultMessage:"Can insert content."}),labelIfDisabled:a()(r.FormattedMessage,{id:"capabilitiesTooltip.mixedaccess.insertContent.disabled",defaultMessage:"Cannot insert content."})},"insert_content"),a()(l,{enabled:t&&e.update_content,labelIfEnabled:a()(r.FormattedMessage,{id:"capabilitiesTooltip.mixedaccess.updateContent.enabled",defaultMessage:"Can update content."}),labelIfDisabled:a()(r.FormattedMessage,{id:"capabilitiesTooltip.mixedaccess.updateContent.disabled",defaultMessage:"Cannot update content."})},"update_content"),a()(l,{enabled:t&&e.insert_comment,labelIfEnabled:a()(r.FormattedMessage,{id:"capabilitiesTooltip.insertComment.enabled",defaultMessage:"Can comment."}),labelIfDisabled:a()(r.FormattedMessage,{id:"capabilitiesTooltip.insertComment.disabled",defaultMessage:"Cannot comment."})},"insert_comment"),a()(l,{enabled:t&&e.read_comment,labelIfEnabled:a()(r.FormattedMessage,{id:"capabilitiesTooltip.readComment.enabled",defaultMessage:"Can read comments."}),labelIfDisabled:a()(r.FormattedMessage,{id:"capabilitiesTooltip.readComment.disabled",defaultMessage:"Cannot read comments."})},"read_comment")]}function c(e){return[a()(l,{enabled:e.read_user_without_email,labelIfEnabled:a()(r.FormattedMessage,{id:"capabilitiesTooltip.userAccess.readUsers.enabled",defaultMessage:"Can view users."}),labelIfDisabled:a()(r.FormattedMessage,{id:"capabilitiesTooltip.userAccess.readUsers.disabled",defaultMessage:"Cannot view users."})},"read_user_without_email"),a()(l,{enabled:e.read_user_with_email,labelIfEnabled:a()(r.FormattedMessage,{id:"capabilitiesTooltip.userAccess.readUserEmailAddresses.enabled",defaultMessage:"Can view user email addresses."}),labelIfDisabled:a()(r.FormattedMessage,{id:"capabilitiesTooltip.userAccess.readUserEmailAddresses.disabled",defaultMessage:"Cannot view user email addresses."})},"read_user_with_email")]}function p(e){return[a()(l,{enabled:e.link_preview,labelIfEnabled:a()(r.FormattedMessage,{id:"capabilitiesTooltip.linkPreview.enabled",defaultMessage:"Can preview links."}),labelIfDisabled:a()(r.FormattedMessage,{id:"capabilitiesTooltip.linkPreview.disabled",defaultMessage:"Cannot preview links."})},"link_preview"),a()(l,{enabled:e.synced_database,labelIfEnabled:a()(r.FormattedMessage,{id:"capabilitiesTooltip.syncedDatabase.enabled",defaultMessage:"Can sync databases."}),labelIfDisabled:a()(r.FormattedMessage,{id:"capabilitiesTooltip.syncedDatabase.disabled",defaultMessage:"Cannot sync databases."})},"synced_database")]}},84015:(e,t,s)=>{s.d(t,{_:()=>u});var o=s(10434),a=s.n(o),i=s(23174),n=s.n(i),r=s(67294),l=s(480),d=s(26825),c=s(5366),p=s(15025),m=s(28992);function u(e){window.__c={n:"CumulativeBotBlockRoleTooltip"};const{role:t}=e,s=(0,c.useIntl)(),{device:o}=(0,l.O7)(),i=(0,p.zq)(t);return r.createElement(m.Z,a()({},e,{title:s.formatMessage((0,d.Gx)(t,void 0).label),shouldWrapCaption:!0,style:o.isMobile?{padding:"12px 4px"}:{padding:4,marginTop:2,marginBottom:2},captionStyle:{marginTop:4},caption:n()("div",{},void 0,i)}))}},47240:(e,t,s)=>{s.d(t,{Z:()=>C});var o=s(23174),a=s.n(o),i=(s(57658),s(67294)),n=s(81954),r=s(24405),l=s(80951),d=s(14215),c=(s(30541),s(21703),s(67266)),p=s.n(c),m=s(96486),u=s.n(m),g=s(5242),b=s.n(g),f=s(15095),h=s(70203),y=s(97880);let v=function(e){return e[e.removed=-1]="removed",e[e.added=1]="added",e[e.same=0]="same",e}({});function M(e){const{before:t,after:s}=e,o={count:0,encoding:{},decoding:{},annotationEncoding:{},annotationDecoding:{}},a=e=>{const t=o.encoding[e];if(t)return t;{const t=String.fromCharCode(o.count);return o.count++,o.encoding[e]=t,o.decoding[t]=e,t}},i=e=>{const t=p()(e),s=o.annotationEncoding[t];if(s)return s;{const s=String.fromCharCode(o.count);return o.count++,o.annotationEncoding[t]=s,o.annotationDecoding[s]=e,s}},n=e=>u().flatten(h.lz(e).map((e=>{const t=f.p4(e[0]).map(a);if(h.km(e)){const s=h.hD(e),o=h.I$(s);o&&(t[0]=i({type:"mention",value:o}),s.forEach((e=>{h.ZA(e)||h.ku(e)||h.QV(e)||(t.unshift(i({type:"start",value:e})),t.push(i({type:"end",value:e})))})))}else if(h.Yr(e)){const s=h.hD(e),o=h.Ap(s);if(o){t[0]=i({type:"equation",value:o});for(const e of s)h.ZA(e)||h.ku(e)||h.QV(e)||(t.unshift(i({type:"start",value:e})),t.push(i({type:"end",value:e})))}}else if(h.AJ(e)){h.hD(e).forEach((e=>{t.unshift(i({type:"start",value:e})),t.push(i({type:"end",value:e}))}))}return t}))).join("");if(o.count>65535)throw new Error("This string has way too many different characters.");const r=function(e,t){const s=new(b())({timeout:2,editCost:6}),o=s.main(t,e);return s.cleanupSemantic(o),o}(n(s),n(t)),l=[];let d=[];return r.forEach((e=>{let[t,s]=e;s.split("").forEach((e=>{if(o.decoding[e]){const s=o.decoding[e];t===v.added?l.push([s,[...d,["+"]]]):t===v.removed?l.push([s,[...d,["-"]]]):t===v.same&&l.push([s,d])}else{const s=o.annotationDecoding[e];if(t===v.added)if("mention"===s.type)l.push([h.qy,[...d,["+"],s.value]]);else if("start"===s.type)d=[...d,s.value];else if("end"===s.type)d=d.filter((e=>!u().isEqual(e,s.value)));else if("equation"===s.type){const e=h.xe(s.value),t=h.qZ(e,[...d,["+"]]);l.push(t)}else(0,y.t1)(s);else if(t===v.removed){if("mention"===s.type)l.push([h.qy,[...d,["-"],s.value]]);else if("equation"===s.type){const e=h.xe(s.value),t=h.qZ(e,[...d,["-"]]);l.push(t)}}else if(t===v.same)if("mention"===s.type)l.push([h.qy,[...d,s.value]]);else if("start"===s.type)d=[...d,s.value];else if("end"===s.type)d=d.filter((e=>!u().isEqual(e,s.value)));else if("equation"===s.type){const e=h.xe(s.value),t=h.qZ(e,d);l.push(t)}else(0,y.t1)(s)}}))})),h.Zx(l)}var w=s(53397),_=s(21202),S=s(68216),k=s(63867);function C(e){const t=e.propertySchema.type;switch(t){case"title":case"text":return i.createElement(R,e);case"relation":return a()(A,{propertySchema:e.propertySchema,beforeValue:e.beforeValue,afterValue:e.afterValue,rootStore:e.rootStore});case"checkbox":case"number":case"person":case"file":case"url":case"email":case"phone_number":case"created_time":case"created_by":case"last_edited_time":case"last_edited_by":case"last_visited_time":case"formula":case"rollup":case"select":case"multi_select":case"date":case"button":case"status":case"auto_increment_id":case"location":case"verification":return i.createElement(F,e);default:(0,y.t1)(t)}}function R(e){const t={value:M({before:e.beforeValue.value,after:e.afterValue.value}),spaceId:e.beforeValue.spaceId};return a()(k.Z,{value:t,propertySchema:e.propertySchema,rootStore:e.rootStore})}function A(e){window.__c={n:"RelationPropertyDiff"};const{beforeValue:t,afterValue:s,propertySchema:o,rootStore:i}=e,r=(0,n.VK)((()=>{const e=(0,l.rq)(t.value),a=(0,l.rq)(s.value),n=(0,d.N)(e,a,(e=>`${e.id}${e.table}`)),r=new Set(l.j$({relationValue:n.created,getRecordValue:i.getRecordValue,propertySchema:o})),c=new Set(l.j$({relationValue:n.deleted,getRecordValue:i.getRecordValue,propertySchema:o})),p=[...r,...c];return p.flatMap(((e,t)=>{const s=S.G.createChildStore(i,{table:_.iU,id:e.id}).getPropertyValue("title")||[],o=[],a=h.lz(s);for(const i of a)if(h.QJ(i)){const t=r.has(e)?"+":"-",s=[i[0],[[t]]];o.push(s)}else o.push(i);return t<p.length-1&&o.push(h.V3("\n")),o}))}),[t,s,o,i]);return a()(k.Z,{value:{value:r,spaceId:t.spaceId},propertySchema:{type:"title",name:"Title"},rootStore:i})}function F(e){window.__c={n:"ArrowPropertyDiff"};const t=(0,r.yK)((()=>({arrowDiffWrap:{display:"inline-flex",alignItems:"center"}})),[]);return a()("div",{style:t.arrowDiffWrap},void 0,a()(k.Z,{value:e.beforeValue,propertySchema:e.propertySchema,rootStore:e.rootStore}),a()(T,{}),a()(k.Z,{value:e.afterValue,propertySchema:e.propertySchema,rootStore:e.rootStore}))}function T(){window.__c={n:"Arrow"};const e=(0,r.yK)((e=>({container:{padding:"0px 8px"},icon:{width:15,height:15,fill:e.mediumIconColor}})),[]);return a()("div",{style:e.container},void 0,w.Z.arrowRightSmaller(e.icon))}},33241:(e,t,s)=>{s.d(t,{d:()=>f,M:()=>h});var o=s(10434),a=s.n(o),i=s(23174),n=s.n(i),r=s(67294),l=s(24405),d=s(8848),c=s(53397),p=s(26825),m=s(90468),u=s(97880),g=s(5366),b=s(89728);function f(e){let{role:t,events:s,disabled:o,buttonStyle:i,buttonContents:d,icon:p,table:m,isRemovable:u,isCurrentUser:f}=e;window.__c={n:"PermissionRoleButton"};const y=(0,l.yK)((e=>({button:{marginRight:8,...i},icon:{width:10,marginLeft:4,fill:e.lightIconColor}})),[i]),v=p||!o&&c.Z.chevronDownRounded;return r.createElement(b.Z,a()({},s,{disabled:o,style:y.button}),d||n()("span",{className:"notranslate"},void 0,r.createElement(g.FormattedMessage,h(t,m,u,f).label)),v&&v(y.icon))}function h(e,t,s,o){if("access"===e)return{label:p.mq.canAccessLabel};if("limited"===e)return{label:p.mq.limitedAccessLabel};if((0,p.oF)(e))return(0,p.Gx)(e,t);switch(e){case"editor":return t===m.bx?{label:p.mq.workspaceOwnerLabel,caption:p.mq.workspaceOwnerCaption}:{label:p.mq.fullAccessLabel,caption:p.mq.fullAccessCaption};case"membership_admin":return t===m.bx?{label:p.mq.membershipAdminLabel,caption:p.mq.membershipAdminCaption}:{label:p.mq.canEditLabel,caption:p.mq.canEditCaption};case"read_and_write":return t===m.bx?{label:p.mq.memberLabel,caption:p.mq.memberCaption}:{label:p.mq.canEditLabel,caption:p.mq.canEditCaption};case"content_only_editor":return{label:p.mq.canEditContentLabel,caption:p.mq.canEditContentCaption};case"reader":return{label:p.mq.canReadLabel,caption:p.mq.canReadCaption};case"comment_only":return{label:p.mq.canCommentLabel,caption:p.mq.canCommentCaption};case"none":return s?t===m.bx?o?{label:p.mq.leaveWorkspaceLabel,style:{color:d.ZP.red}}:{label:p.mq.removeFromWorkspaceLabel,style:{color:d.ZP.red}}:{label:p.mq.removeWorkspaceLabel,style:{color:d.ZP.red}}:{label:p.mq.noAccessLabel,style:{color:d.ZP.red}};default:(0,u.t1)(e)}}},7567:(e,t,s)=>{s.d(t,{QH:()=>z,jV:()=>j,ZP:()=>H});var o=s(10434),a=s.n(o),i=s(23174),n=s.n(i),r=(s(57658),s(67294)),l=s(83355),d=s(41892),c=s(53397),p=s(26825),m=s(27006),u=s(90468),g=s(47425),b=s(97880),f=s(5366),h=s(47307),y=s(1865),v=s(95477),M=s(43250),w=s(33929),_=s(87279),S=s(98742),k=s(67669),C=s(33665),R=s(21115),A=s(8323),F=s(61766),T=s(31194),I=s(52275),Z=s(31945),D=s(78140),P=s(28992),x=s(32163),U=s(74136),E=s(72495),q=s(58032),N=s(64369),B=s(84015),G=s(42402),W=s(33241),K=s(60442),V=s(42115);const L=(0,f.defineMessages)({fullAccessTeamGuestsDisabledMessage:{id:"permissionRoleSelect.teamGuestPermissionItem.disabledPermissionitem.tooltip",defaultMessage:"Teamspace guests can't have full access."}});class O extends l.Z{constructor(){super(...arguments),this.storeTypes={buttonPopupStore:F.Z},this.renderPermissionOverrideLabel=()=>{const{device:e}=this.environment;return n()(N.Z,{style:{padding:12,backgroundColor:this.theme.sidebarSecondaryBackground,boxShadow:`0 -1px 0 ${this.theme.regularDividerColor}`,marginTop:e.isMobile?28:1},isMultiline:!0,isSmall:!0},void 0,n()(f.FormattedMessage,{id:"permissionRoleSelect.overrideMessage.caption",defaultMessage:"Youâ€™ll override permissions from the parent page if you change this role."}))},this.isRemovingSelfRole=e=>this.props.isUserPermission&&(0,p.nl)(this.props.role,e)===this.props.role&&"none"===e,this.isDowngradingSelfRole=e=>this.props.isUserPermission&&(0,p.nl)(this.props.role,e)===this.props.role}renderComponent(){const{device:e}=this.environment,t=!!this.props.isUserPermission;return n()(Z.ZP,{onClick:e=>{e.stopPropagation()},popupType:e.isMobile?Z.Z4.SlideUp:Z.Z4.Popup,buttonPopupStore:this.stores.buttonPopupStore,renderOrigin:e=>this.props.origin?this.props.origin:this.props.isMenuItem?r.createElement(I.Z,a()({},e,{title:r.createElement(f.FormattedMessage,(0,W.M)(this.props.role,this.props.table,this.isRemovable(),t).label),focused:!1,showExtensionArrow:!0})):n()(W.d,{role:this.props.role,events:e,disabled:this.props.disabled,buttonContents:this.props.buttonContents,buttonStyle:this.props.buttonStyle,table:this.props.table,isRemovable:this.isRemovable(),isCurrentUser:t}),placementToOrigin:this.props.placementToOrigin?this.props.placementToOrigin:T.Iw.Bottom,alignmentToOrigin:this.props.alignmentToOrigin,render:t=>{const s=this.props.role;let o,i;if((0,p.oF)(s))o=[{key:"mixed_role_section",render:e=>r.createElement(E.Z,a()({},e,{topBorder:!1})),items:[{key:"mixed_role_description",render:()=>n()(B._,{role:s}),action:()=>{}}]},{key:"bot_capabilities_warning",render:e=>r.createElement(E.Z,a()({},e,{topBorder:!0})),items:[{key:"warning_details",render:e=>r.createElement(P.Z,a()({},e,{shouldWrapCaption:!0,caption:"Integration permissions cannot be changed on a page. You can manage integrations in settings."})),action:()=>{}}]},{key:"remove_bot",render:e=>r.createElement(E.Z,a()({},e,{topBorder:!0})),items:[{key:"none",render:e=>this.getItem({role:"none"},e.focused,e),action:()=>{this.handleSelect("none"),t.close()}}]}];else{o=[{key:"roles",render:e=>r.createElement(E.Z,a()({},e,{topBorder:0!==e.index})),items:this.getAvailableRoles().map((e=>({key:e.role,render:t=>this.getItem(e,t.focused,t),action:()=>{this.handleSelect(e.role),t.close()}})))}]}return i=e.isMobile?{menuType:_.og.Modal,title:n()(f.FormattedMessage,{id:"userPermissionsMenu.mobile.title",defaultMessage:"Select role"}),right:n()(f.FormattedMessage,{id:"userPermissionsMenu.mobile.doneButton.label",defaultMessage:"Done"}),onClickRight:t.close}:{menuType:_.og.Popup,width:264},r.createElement(D.Z,a()({className:M.a6i,header:this.props.header,footer:this.props.footer},i),n()(x.Z,{type:x.i.Vertical,initialFocus:void 0,sections:o}),this.props.showPermissionOverrideWarning&&this.renderPermissionOverrideLabel())}})}getItem(e,t,s){const o=!!this.props.isUserPermission;return this.renderItem({...(0,W.M)(e.role,this.props.table,this.isRemovable(),o),focused:t,props:s,disabledMessage:this.getItemDisabledReason(e.role),availableRole:e})}renderItem(e){const{device:t}=this.environment,{onClick:s,key:o,...i}=e.props,l=e.availableRole.disabledInfo;return l&&l.isDisabled?n()(q.Z,{delayThreshold:0,renderTooltip:e=>r.createElement("div",e,l.disabledMessage),placement:q.Z.Placement.Right,textWrap:!0,render:s=>r.createElement(I.Z,a()({},s,{focused:e.focused,disabled:!0,disabledFeedback:!0,right:this.props.role===e.availableRole.role?n()("div",{style:{width:t.isMobile?16:14}},void 0,c.Z.check()):void 0,title:n()("div",{style:{display:"flex",alignItems:"center"}},void 0,n()("div",{style:{...e.style,marginRight:e.disabledMessage?6:0}},void 0,r.createElement(f.FormattedMessage,e.label))),caption:e.caption&&n()("span",{style:{color:this.theme.mediumTextColor}},void 0,r.createElement(f.FormattedMessage,e.caption)),shouldWrapCaption:!0}))}):n()(V.Z,{requireUpgradeToTier:Boolean(e.disabledMessage)&&R.M9(this.environment),analyticsName:this.props.upgradeButtonName,renderUpgradeTooltip:()=>e.disabledMessage,tooltipPlacement:q.Z.Placement.Left,onClick:s,onUpgradeClick:this.props.onUpgradeButtonClick,render:(s,o)=>{const{focused:l,...d}=(0,S.Z)(i,s);return r.createElement(I.Z,a()({},d,{focused:l||e.focused,right:this.props.role===e.availableRole.role?n()("div",{style:{width:t.isMobile?16:14}},void 0,c.Z.check()):void 0,title:n()("div",{style:{display:"flex",alignItems:"center"}},void 0,n()("div",{style:{...e.style,marginRight:e.disabledMessage?6:0}},void 0,r.createElement(f.FormattedMessage,e.label)),o,e.availableRole.tag&&n()(U.Z,{desktopStyle:{marginLeft:7}},void 0,e.availableRole.tag)),caption:e.caption&&n()("span",{style:{color:this.theme.mediumTextColor}},void 0,r.createElement(f.FormattedMessage,e.caption)),shouldWrapCaption:!0,disabled:!!t.isMobile&&Boolean(e.disabledMessage)}))}},o)}getItemDisabledReason(e){const t=(0,A.zt)();if((0,g.QM)(t)){if((this.props.table===u.bx?m.RN(e):m.J5(e)&&!m.zz(e))&&"public_permission"!==this.props.type&&"bot_permission"!==this.props.type)return this.props.table===u.bx?n()(K.Z,{imageURL:d.Z.images.tooltips.upsells.spaceReadAndWritePng,imageWidth:240,imageHeight:100,caption:n()(f.FormattedMessage,{defaultMessage:"Members cannot change workspace settings or invite new members.",id:"permissionRoleSelect.spaceReadAndWriteUpgradeTooltip.caption"}),title:n()(f.FormattedMessage,{defaultMessage:"Upgrade to add non-admin members",id:"permissionRoleSelect.spaceReadAndWriteUpgradeTooltip.title"})}):n()(K.Z,{imageURL:d.Z.images.tooltips.upsells.userReadAndWritePng,imageWidth:240,imageHeight:100,caption:n()(f.FormattedMessage,{defaultMessage:"Users with edit access can edit a page but not share it with others.",id:"permissionRoleSelect.userReadAndWriteUpgradeTooltip.caption"}),title:n()(f.FormattedMessage,{defaultMessage:"Upgrade to add editors",id:"permissionRoleSelect.userReadAndWriteUpgradeTooltip.title"})})}return!1}getAvailableRoles(){const{type:e,table:t,isInvite:s,role:o,availableRoleItems:a,blockType:i}=this.props;if(a&&a.length>0)return a;const n=[];return"explicit_team_guest_permission"===e?n.push({role:"editor",disabledInfo:{isDisabled:!0,disabledMessage:w.default.formatMessage(L.fullAccessTeamGuestsDisabledMessage)}}):"bot_permission"!==e&&n.push({role:"editor"}),"space"===t&&(0,k.U7)()&&n.push({role:"membership_admin"}),n.push({role:"read_and_write"}),"collection_view"!==i&&"collection_view_page"!==i||"bot_permission"===e&&"content_only_editor"!==o||n.push({role:"content_only_editor"}),t!==u.bx&&("bot_permission"!==e&&n.push({role:"comment_only"}),"bot_permission"===e&&"reader"!==o||n.push({role:"reader"})),s||n.push({role:"none"}),n}isRemovingSpaceUser(e){return this.props.table===u.bx&&"none"===e}isRemovable(){const e=this.props.type;if(void 0!==this.props.isRemovableOverride)return this.props.isRemovableOverride;switch(e){case"user_permission":case"bot_permission":case"group_permission":return!0;case"space_permission":case"explicit_team_permission":case"team_permission":case"team_owner_permission":case"explicit_team_owner_permission":case"explicit_team_guest_permission":case"public_permission":case"exclusive_user_permission":return!1;default:(0,b.t1)(e)}}async handleSelect(e){const{table:t,role:s}=this.props;if(s===e)return;const o=()=>{this.props.onChange&&this.props.onChange(e)};if(this.getItemDisabledReason(e)&&!v.default.isAdminMode)y.y(this.environment,{from:this.props.upgradeButtonName,for:R.M9(this.environment)||"plus"}),this.props.onUpgradeButtonClick&&this.props.onUpgradeButtonClick();else if(this.isRemovingSelfRole(e))h.showDialog({showCancel:!0,keepFocus:!1,message:t===u.bx?n()(f.FormattedMessage,{id:"userPermissionsMenu.removePermissionsModal.removeSelfFromWorkspace.confirmationMessage",defaultMessage:"Are you sure you want to remove your own access? You will lose access to the workspace, and any private pages will be lost."}):n()(f.FormattedMessage,{id:"userPermissionsMenu.removePermissionsModal.removeSelfFromPage.confirmationMessage",defaultMessage:"Are you sure you want to remove your own access?"}),items:[{label:n()(f.FormattedMessage,{id:"userPermissionsMenu.removePermissionsModal.removeSelfButton.label",defaultMessage:"Remove"}),color:"red",onAccept:o}]});else if(this.isDowngradingSelfRole(e))h.showDialog({showCancel:!0,keepFocus:!1,message:n()(f.FormattedMessage,{id:"userPermissionsMenu.downgradePermissionsModal.downgradeSelfFromWorkspaceOrPage.confirmationMessage",defaultMessage:"Are you sure you want to downgrade your own access?"}),items:[{label:n()(f.FormattedMessage,{id:"userPermissionsMenu.downgradePermissionsModal.downgradeSelfButton.label",defaultMessage:"Downgrade"}),color:"red",onAccept:o}]});else if(this.isRemovingSpaceUser(e))if(this.props.onRemoveMemberClick)this.props.onRemoveMemberClick();else{await j({message:z(!0)})&&o()}else o()}}function z(e){return e&&(0,A.wP)()?n()(f.FormattedMessage,{id:"userPermissionsMenu.removePermissionsModal.removeUserFromWorkspace.enterprise.confirmationMessage",defaultMessage:"If you remove this member, they will lose workspace access. After their removal, you may transfer their private pages to another member. <transferpagelink>Learn more</transferpagelink>.",values:{transferpagelink:e=>n()(G.Z,{href:(0,C.UY)("guides.transferContent"),external:!0},void 0,e)}}):n()(f.FormattedMessage,e?{id:"userPermissionsMenu.removePermissionsModal.removeUserFromWorkspace.confirmationMessage",defaultMessage:"Are you sure you want to remove this person? They will lose access to the workspace, and any private pages will be lost."}:{id:"userPermissionsMenu.removePermissionsModal.removeUserFromPage.confirmationMessage",defaultMessage:"Are you sure you want to remove this person?"})}async function j(e){const{message:t}=e;return new Promise((e=>{h.showDialog({showCancel:!0,keepFocus:!1,handleCancel:()=>e(!1),message:t,items:[{label:n()(f.FormattedMessage,{id:"userPermissionsMenu.removePermissionsModal.removeUserButton.label",defaultMessage:"Remove"}),color:"red",onAccept:()=>e(!0)}]})}))}O.displayName="PermissionRoleSelect";const H=O},93963:(e,t,s)=>{s.d(t,{z:()=>r});var o=s(23174),a=s.n(o),i=(s(67294),s(24405)),n=s(5366);function r(e){let{color:t,size:s,style:o}=e;window.__c={n:"StatusDot"};const r=(0,n.useIntl)(),l=(0,i.yK)((e=>({dot:{height:s||8,width:s||8,background:t||e.blueColor,flexShrink:0,borderRadius:"100%",pointerEvents:"none",...o}})),[s,t,o]);return a()("div",{role:"img","aria-label":r.formatMessage({id:"statusDot.ariaLabel",defaultMessage:"New"}),style:l.dot})}},42115:(e,t,s)=>{s.d(t,{Z:()=>p});var o=s(23174),a=s.n(o),i=(s(67294),s(83355)),n=s(1865),r=s(98742),l=s(58032),d=s(91718);class c extends i.Z{renderComponent(){const{render:e,requireUpgradeToTier:t,analyticsName:s,renderUpgradeTooltip:o,onUpgradeClick:i,alwaysAllowClick:c,tooltipPlacement:p,upgradeButtonDesktopStyle:m,upgradeButtonMobileStyle:u}=this.props;let g,{onClick:b,renderTooltip:f}=this.props;return t&&(g=a()(d.Z,{subscriptionTier:t,analyticsName:s,desktopStyle:{display:"inline-block",pointerEvents:"none",...m},mobileStyle:{display:"inline-block",pointerEvents:"none",...u}}),c||(b=e=>{n.y(this.environment,{from:s,for:t}),i&&i(e)},f=o)),a()(l.Z,{renderTooltip:f||(()=>null),render:t=>e((0,r.Z)(t,{onClick:b}),g),disableTooltip:!f,placement:p})}}c.displayName="UpsellGate";const p=c},74136:(e,t,s)=>{s.d(t,{Z:()=>p});var o=s(10434),a=s.n(o),i=s(23174),n=s.n(i),r=s(67294),l=s(480),d=s(24405),c=s(64921);function p(e){window.__c={n:"Pill"};const t=(0,l.Fy)(),s=(0,d.yK)((e=>({sharedStyle:{display:"flex",alignItems:"center",borderRadius:3},innerStyle:{padding:"2px 6px",borderRadius:3,color:e.mediumTextColor,background:e.defaultBadgeBackground,fontSize:t.isMobile?11:9,lineHeight:t.isAndroid?1.5:1,textTransform:"uppercase",letterSpacing:"0.04em",whiteSpace:"nowrap"}})),[t.isAndroid,t.isMobile]);return t.isMobile?n()(c.Z,{style:{...s.sharedStyle,...e.mobileStyle},disabled:void 0===e.onClick},void 0,n()("div",{style:{...s.innerStyle,...e.innerStyle}},void 0,e.children)):r.createElement(c.Z,a()({style:{...s.sharedStyle,...e.desktopStyle},disabled:void 0===e.onClick},e),n()("div",{style:{...s.innerStyle,...e.innerStyle}},void 0,e.children))}},91718:(e,t,s)=>{s.d(t,{Z:()=>h});var o=s(10434),a=s.n(o),i=s(23174),n=s.n(i),r=s(67294),l=s(83355),d=s(47425),c=s(97880),p=s(5366),m=s(1865),u=s(21115),g=s(74136),b=s(58032);class f extends l.Z{constructor(){super(...arguments),this.handleClick=e=>{m.y(this.environment,{from:this.props.analyticsName,for:this.props.subscriptionTier}),this.props.onClick&&this.props.onClick(e)}}renderComponent(){const{device:e}=this.environment;if(e.isIOS&&e.isNative)return;let t;return"personal"===this.props.subscriptionTier?t=n()(p.FormattedMessage,{defaultMessage:"Personal Pro",id:"upgradeButton.personal.text"}):(0,d.eR)(this.props.subscriptionTier)?t=u.eV:(0,d.NG)(this.props.subscriptionTier)?t=n()(p.FormattedMessage,{defaultMessage:"Business",id:"upgradeButton.business.text"}):(0,d.wP)(this.props.subscriptionTier)?t=n()(p.FormattedMessage,{defaultMessage:"Enterprise",id:"upgradeButton.enterprise.text"}):(0,c.t1)(this.props.subscriptionTier),e.isMobile?n()(g.Z,{mobileStyle:this.props.mobileStyle},void 0,t):n()(b.Z,{delayThreshold:120,placement:b.Z.Placement.Bottom,renderTooltip:()=>n()("div",{style:{maxWidth:500}},void 0,n()(p.FormattedMessage,{defaultMessage:"Upgrade to use this feature.",id:"upgradeButton.upgrade.tooltip"}),n()("br",{}),n()(p.FormattedMessage,{defaultMessage:"Click to learn more.",id:"upgradeButton.learnMore.tooltip"})),originGap:6,render:e=>r.createElement(g.Z,a()({desktopStyle:this.props.desktopStyle,onClick:this.handleClick},e),t)})}}f.displayName="UpsellButton";const h=f},9919:(e,t,s)=>{s.d(t,{t0:()=>R,Zk:()=>k,CA:()=>S});var o=s(10434),a=s.n(o),i=s(23174),n=s.n(i),r=s(67294),l=s(23482),d=s(53397),c=s(97880),p=s(5366),m=s(62967),u=s(57883),g=s(50906),b=s(9953),f=s(12359);function h(e){const{environment:t,key:s,selectedKey:o,following:a,followSettings:i,navigableBlockId:n,userId:r,spaceId:l,from:d}=e;f.createAndCommit({userAction:"UpdateSidebarFollowControl.setFollowing",environment:e.environment,canUndo:!1,perform:t=>{b.Ue({environment:e.environment,table:u.t0,args:{following:a,followSettings:i,navigableBlockId:n,userId:r,spaceId:l},inMemoryRecordCache:e.environment.defaultRecordCache.inMemoryRecordCache,transaction:t})}}),a?g.RJe(t,{from:"page_updates"}):g.ubm(t,{from:"page_updates"}),o!==s&&g.kLN(t,{from:d,navigableBlockId:n,oldSetting:o,newSetting:s})}var y=s(64964),v=s(93405),M=s(64369),w=s(79315),_=s(57538);function S(e){const{followSettingsKey:t,environment:s,blockStore:o,from:a,useCopyChanges:i}=e,r=C({key:"none",selectedKey:t,title:n()(p.FormattedMessage,i?{id:"GetNotifiedDropdown.repliesAndMentions.label",defaultMessage:"Replies and @mentions"}:{id:"GetNotifiedDropdown.mentionsAndReplies.label",defaultMessage:"Only replies and @mentions"}),environment:s,blockStore:o,from:a}),d=C({key:"comments",selectedKey:t,title:n()(p.FormattedMessage,i?{id:"GetNotifiedDropdown.allComments.label",defaultMessage:"All comments"}:{id:"GetNotifiedDropdown.allUpdatesComments.label",defaultMessage:"All updates"}),caption:i?void 0:n()(p.FormattedMessage,{id:"GetNotifiedDropdown.allComments.caption",defaultMessage:"All comments and @mentions"}),environment:s,blockStore:o,from:a}),c=C({key:"all",selectedKey:t,title:n()(p.FormattedMessage,{id:"GetNotifiedDropdown.allUpdates.label",defaultMessage:"All updates"}),caption:n()(p.FormattedMessage,i?{id:"GetNotifiedDropdown.simpleAllUpdates.caption",defaultMessage:"All comments and property changes"}:{id:"GetNotifiedDropdown.allUpdates.caption",defaultMessage:"All comments, @mentions, and property changes"}),environment:s,blockStore:o,from:a}),m=o.getAssociatedCollectionStore();if(!m)return[d,r];const u=m.getDatabaseType();if(u===l.GL.tasks){return[c,C({key:"important",selectedKey:t,title:n()(p.FormattedMessage,i?{id:"GetNotifiedDropdown.importantUpdatesTasks.label",defaultMessage:"Important updates"}:{id:"GetNotifiedDropdown.onlyImportantUpdatesTasks.label",defaultMessage:"Only important updates"}),caption:n()(p.FormattedMessage,i?{id:"GetNotifiedDropdown.importantUpdatesTasks.caption",defaultMessage:"All comments and changes to Status, Assignee, or Due Date"}:{id:"GetNotifiedDropdown.onlyImportantUpdatesTasks.caption",defaultMessage:"All comments, @mentions, and changes to Status, Assignee, or Due Date"}),environment:s,blockStore:o,from:a}),r]}if(u===l.GL.projects){return[c,C({key:"important",selectedKey:t,title:n()(p.FormattedMessage,i?{id:"GetNotifiedDropdown.importantUpdatesProjects.label",defaultMessage:"Important updates"}:{id:"GetNotifiedDropdown.onlyImportantUpdatesProjects.label",defaultMessage:"Only important updates"}),caption:n()(p.FormattedMessage,i?{id:"GetNotifiedDropdown.importantUpdatesProjects.caption",defaultMessage:"All comments and changes to Status or Date"}:{id:"GetNotifiedDropdown.onlyImportantUpdatesProjects.caption",defaultMessage:"All comments, @mentions, and changes to Status or Date"}),environment:s,blockStore:o,from:a}),r]}return[c,C({key:"comments",selectedKey:t,title:n()(p.FormattedMessage,i?{id:"GetNotifiedDropdown.onlyCommentsAllComments.label",defaultMessage:"All comments"}:{id:"GetNotifiedDropdown.onlyComments.label",defaultMessage:"Only comments"}),caption:i?void 0:n()(p.FormattedMessage,{id:"GetNotifiedDropdown.onlyComments.caption",defaultMessage:"All comments and @mentions"}),environment:s,blockStore:o,from:a}),r]}function k(e){const{followSettingsKey:t,environment:s,blockStore:o,from:a}=e;return[C({key:"important",selectedKey:t,title:n()(p.FormattedMessage,{id:"inAppNotificationsFollowingOptionsHelpers.allComments.label",defaultMessage:"All comments"}),caption:n()(p.FormattedMessage,{id:"inAppNotificationsFollowingOptionsHelpers.allComments.caption",defaultMessage:"Notified of all comments and @mentions"}),environment:s,blockStore:o,from:a}),C({key:"none",selectedKey:t,title:n()(p.FormattedMessage,{id:"inAppNotificationsFollowingOptionsHelpers.mentionsAndReplies.label",defaultMessage:"Replies and @mentions"}),caption:n()(p.FormattedMessage,{id:"inAppNotificationsFollowingOptionsHelpers.mentionsAndReplies.caption",defaultMessage:"Notified of comment replies and @mentions"}),environment:s,blockStore:o,from:a})]}function C(e){const{key:t,title:s,caption:o,selectedKey:i,environment:l,blockStore:c,from:p}=e,u=R({key:t,userSelectedKey:i}),g={icon:{width:14,height:14},rightWrapper:o?{alignSelf:"flex-start",paddingTop:2}:{}};return{action:(0,m.PH)({key:t,displayName:void 0,analyticsName:t,validators:[],closeParentMenu:!0,action:()=>{const{currentUserRootStore:e}=w.default.state;if(e){const{following:s,followSettings:o}=(0,_.Z)(t),a=e.id,n=c.id,r=c.getSpaceId();h({environment:l,following:s,followSettings:o,navigableBlockId:n,spaceId:r,userId:a,from:p,key:t,selectedKey:i}),"inbox"!==p&&"more_menu"!==p||y.d4({item:{label:A(t)},undoFunc:()=>{const{following:e,followSettings:s}=(0,_.Z)(i);h({environment:l,following:e,followSettings:s,navigableBlockId:n,spaceId:r,userId:a,from:p,key:t,selectedKey:i})}})}},render:e=>r.createElement(v.Z,a()({},e,{title:n()(M.Z,{},void 0,s),caption:o,shouldWrapCaption:!0,right:u?d.Z.thinCheck(g.icon):n()("div",{style:g.icon}),rightStyle:g.right}))}),title:s}}function R(e){const{key:t,userSelectedKey:s}=e;return"important"===s||"comments"===s?"important"===t||"comments"===t:t===s}function A(e){switch(e){case"none":return n()(p.FormattedMessage,{id:"GetNotifiedDropdown.subscribedRepliesAndMentionsSuccess.snackbarMessage",defaultMessage:"Subscribed to replies and @mentions"});case"comments":return n()(p.FormattedMessage,{id:"GetNotifiedDropdown.subscribedAllCommentsSuccess.snackbarMessage",defaultMessage:"Subscribed to all comments"});case"important":return n()(p.FormattedMessage,{id:"GetNotifiedDropdown.subscribedImportantUpdatesSuccess.snackbarMessage",defaultMessage:"Subscribed to important updates"});case"all":return n()(p.FormattedMessage,{id:"GetNotifiedDropdown.subscribedAllUpdatesSuccess.snackbarMessage",defaultMessage:"Subscribed to all updates"});default:(0,c.t1)(e)}}},98905:(e,t,s)=>{s.d(t,{Z:()=>i});var o=s(49085);class a extends o.default{getInitialState(){return{count:0}}}const i=new a}}]);