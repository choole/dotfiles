"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[8586],{41311:(e,t,i)=>{i.d(t,{w1:()=>T,XP:()=>I,y2:()=>P,bA:()=>Z,T_:()=>x,B3:()=>F,h7:()=>A});i(57658);var n=i(65917),a=i(4615),o=i(98459),s=i(51859),r=i(64002),l=i(5366),d=i(95477),c=i(77373),u=i(93959),m=i(70538),p=i(91924),g=i(79315),h=i(22756),f=i(67940),v=i(50906),y=i(54642),S=i(51127),b=i(47307),M=i(84908),w=i(30738),C=i(15356),_=i(12359);const k=(0,l.defineMessages)({authenticatingWithAsana:{id:"asanaActions.authenticatingWithAsana.loadingMessage",defaultMessage:"Authenticating with Asana…"},titleMessage:{id:"asanaActions.loginWithAsanaPopupModal.title",defaultMessage:"Asana login"}});async function T(e){const{environment:t,flowId:i}=e;await y.disconnectAsana(t,{});const n=(0,p.eC)(t);let a=(0,s.s1)(d.default.domainBaseUrl,{authType:n,userId:t.currentUser.id});if(a=n.redirectToAuth?a:await(0,p.HU)(t,a),t.device.isElectron)return h.Z.setState({...h.Z.state,isAccountLinkingInProgress:!0}),void M.openExternalUrl(a);const o=await C.M(t,{width:580,height:800,url:a,titleMessage:k.titleMessage});if(!o)return;const l=r.Qc(o);if(!l.query.code||!l.query.state)return;h.Z.setState({...h.Z.state,isAccountLinkingInProgress:!0});const c=await y.authWithAsana(t,{code:l.query.code,encryptedState:l.query.state}),u=await y.getAsanaWorkspacesNames(t,{});if("failed"===c.type)v.a1y(t,{import_source:"asana",data:{import_type:"api",status:"failure",error:c.error},flowId:i}),console.error(c.error),b.showError(c);else if(v.a1y(t,{import_source:"asana",data:{import_type:"api",status:"success"},flowId:i}),"success"===u.type){const{data:{account:e,workspaces:t}}=u;h.Z.setState({...h.Z.state,isAccountLinkingInProgress:!1,account:e,workspaces:t,currentTab:"selectData",isModalOpen:!0})}}async function I(e){const{environment:t}=e;h.Z.setState({...h.Z.state,isAccountDelinkingInProgress:!0});const i=await y.disconnectAsana(t,{});"failed"===i.type?(console.error(i.error),b.showError(i)):(v.qJZ(t,{integration_name:"asana"}),"success"===i.type&&h.Z.setState({...h.Z.state,isAccountDelinkingInProgress:!1,account:void 0,workspaces:[]}))}async function P(e){const{selectedWorkspace:t,environment:i}=e;h.Z.setState({...h.Z.state,isLoadingProjects:!0});const n=await y.getTeamsAndProjectsInAsanaWorkspace(i,{workspaceId:t,size:5});"success"===n.type&&h.Z.setState({...h.Z.state,teamsAndProjects:n.data,isLoadingProjects:!1})}async function Z(e){let{environment:t}=e;h.Z.setState({...h.Z.state,isLoadingAsanaWorkspaces:!0});const i=await y.getAsanaWorkspacesNames(t,{});"success"===i.type&&h.Z.setState({...h.Z.state,account:i.data.account,workspaces:i.data.workspaces,isLoadingAsanaWorkspaces:!1})}async function x(e){let{environment:t,spaceStore:i,currentSpaceViewStore:s,teamsStores:r,flowId:l}=e;const d=h.Z.state.selectedWorkspace;if(!d)return;h.Z.setState({...h.Z.state,templateCreationInProgress:!0});const p={},b={};try{for(const e in h.Z.state.selectedProjectsAndTeamspaces){if(0===h.Z.state.selectedProjectsAndTeamspaces[e].projects.length)continue;let n;const a=h.Z.state.selectedProjectsAndTeamspaces[e],{notionTeamspaceId:o}=a;if(!o)continue;const l=r.find((e=>e.id===a.notionTeamspaceId));if(n=l||i,b[o])p[e]=b[o];else{const{serverCommitResult:i,performResult:a}=_.createAndCommit({environment:t,perform:e=>{const i={type:"preset",uri:m._F};if("preset"===i.type&&!i.uri.startsWith("notion://wiki")){var a;const o=i.uri,r=null===(a=(0,u.SP)(o))||void 0===a?void 0:a.uri;if(!r)return;const l=(0,c.p)().find((e=>e.uri===r));if(null==l?void 0:l.presets.find((e=>e.uri===o))){return S.ZF({environment:t,spaceViewStore:s,appParentStore:n,appUri:r,presetUri:o,transaction:e,from:"asana_import"})}return[]}},userAction:"importActions.importAsana"});p[e]=a,b[o]=a,await i}}}catch(A){return void h.Z.setState({...h.Z.state,templateCreationInProgress:!1,currentTab:"failure"})}const M=[],C=g.default.state.currentSpaceViewStore;if(!C)return;const k=w.Ym({environment:t,spaceStore:i,spaceViewStore:C,append:!0});await k.deferred.promise;const T=k.pageId;h.Z.setState({...h.Z.state,loggerPageId:T});const I=new Set,P=[],Z=[];for(const n in p){const e=h.Z.state.selectedProjectsAndTeamspaces[n],t=p[n];if(!(t&&e.notionTeamspaceId&&e.projects.length))continue;const a="string"==typeof e.projects?[]:e.projects;P.push(...a),I.add(e.notionTeamspaceId),Z.push(n),M.push({collectionViewBlocks:t.map((e=>({id:e.id,spaceId:(0,o.CG)(i.id)}))),projectIds:a,asanaTeamId:n,notionTeamSpaceId:e.notionTeamspaceId,importAllProjects:"all"===e.projects,importOnlyIncompleteProjects:"in_complete"===e.projects})}const x=y.parallelAsanaImport(t,{importParams:M,spaceId:(0,o.CG)(i.id),asanaWorkspaceId:d,importCompletedTasks:h.Z.state.importCompletedTasks,loggerPageId:T,flowId:l||(0,a.ZP)()});h.Z.setState({...h.Z.state,templateCreationInProgress:!1,currentTab:"importingData"}),f.Z.reset();const F=h.Z.state.workspaces.find((e=>e.gid===d));F&&function(e,t,i){try{v.qyQ(e,{import_source:"asana",data:t,flowId:i})}catch(a){n.log({level:"error",from:"asanaV2Actions",type:"parallelAsanaImport",error:{miscDataString:JSON.stringify({error:a,message:"Errored in tracking import_source_input event."})}})}}(t,{workspaceName:F.name,teams:Z,projects:P,numberOfTeamspacesUsed:I.size,completedTasks:h.Z.state.importCompletedTasks,userId:t.currentUser.id,spaceId:(0,o.CG)(i.id)},l);for await(const n of x){if(!h.Z.state.isModalOpen)break;if(n.error)return void h.Z.setState({...h.Z.state,currentTab:"failure"});"success"===n.taskStatus&&h.Z.setState({...h.Z.state,currentTab:"confirm",result:n.value.status,isComplete:!0})}}function F(e){var t;let{teamId:i,spaceId:n}=e;h.Z.setState({...h.Z.state,selectedProjectsAndTeamspaces:{...h.Z.state.selectedProjectsAndTeamspaces,[i]:{projects:(null===(t=h.Z.state.selectedProjectsAndTeamspaces[i])||void 0===t?void 0:t.projects)||[],notionTeamspaceId:n}}})}function A(){h.Z.setState({...h.Z.state,isModalOpen:!0})}},79257:(e,t,i)=>{i.d(t,{bA:()=>c,xv:()=>u,M0:()=>m,W4:()=>p,Do:()=>g,D2:()=>h});var n=i(85680),a=i(98452),o=i(52258),s=i(50906),r=i(6404),l=i(96802),d=i(12359);function c(e){const{originRect:t}=e;o.Z.reset(),a.Z.reset(),r.xv(),n.Z.setState({isOpen:!0,rect:t})}function u(){n.Z.setState({isOpen:!1})}function m(e){const{format:t,store:i,property:n,visibility:a,transaction:o}=e,s=t.property_visibility;s&&o&&l.FH({stores:[i],update:{property_visibility:Object.values(s||{}).map((e=>({property:e.property,visibility:n===e.property?a:e.visibility})))},transaction:o})}function p(e){const{store:t,pageSection:i,visibility:n,environment:a,format:o}=e,r=o.page_section_visibility;r&&(s.Mzl(a,{section:i,visibility:n}),d.createAndCommit({userAction:"customizePageActions.updatePageSectionVisibility",environment:a,perform:e=>{l.FH({stores:[t],update:{page_section_visibility:{...r,[i]:n}},transaction:e})}}))}function g(e){const{store:t,transaction:i,pageSectionFormats:n}=e;l.FH({stores:[t],update:{collection_page_sections:n},transaction:i})}function h(e){const{store:t,properties:i,environment:n}=e;d.createAndCommit({userAction:"customizePageActions.updateCollectionPageProperties",environment:n,perform:e=>{l.FH({stores:[t],update:{collection_page_properties:i},transaction:e})}})}},30738:(e,t,i)=>{i.d(t,{Ym:()=>U,A1:()=>z,am:()=>K,ro:()=>V,su:()=>W});i(57658),i(21703);var n=i(96486),a=i.n(n),o=i(13991),s=i(41432),r=i(7057),l=i(7406),d=i(65917),c=i(59730);const u=["application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.openxmlformats-officedocument.wordprocessingml.template","application/vnd.ms-word.document.macroEnabled.12","application/vnd.ms-word.template.macroEnabled.12"],m=["text/plain",".md",".mdown",".markdown",".mkdn",".mkd",".Rmd",".md.txt"],p={markdown:m,csv:["text/plain",".csv"],html:["text/html"],docx:u,gdocs:u,dropbox:u,quip:["text/html",m],workflowy:["text/plain"],confluence:["application/zip"],genericImporter:["application/zip"]};var g=i(2911),h=i(32056),f=i(29477),v=i(4615),y=i(98459),S=i(21202),b=i(5366),M=i(72340),w=i(33954),C=i(8989),_=i(33929),k=(i(46190),i(78900)),T=i(90365),I=i(82066),P=i(68216),Z=i(50906),x=i(54642),F=i(47307),A=i(94419),E=i(92625),B=i(9953),D=i(29974),R=i(12359),L=i(53471);const N=(0,b.defineMessages)({uploadingOneFile:{id:"importActions.uploadingOneFile.loadingMessage",defaultMessage:"Uploading… ({percentComplete}%)"},uploadingMultipleFilesNotStarted:{id:"importActions.uploadingMultipleFilesNotStarted.loadingMessage",defaultMessage:"Uploaded 0 of {totalNumberOfFiles}"},uploadingMultipleFilesInProgress:{id:"importActions.uploadingMultipleFilesInProgress.loadingMessage",defaultMessage:"Uploaded {numberOfUploadedFiles} of {totalNumberOfFiles}"},uploadingMultipleFilesComplete:{id:"importActions.uploadingMultipleFilesComplete.loadingMessage",defaultMessage:"Uploaded {totalNumberOfFiles} of {totalNumberOfFiles}"},importingOneFile:{id:"importActions.importingOneFile.loadingMessage",defaultMessage:"Importing…"},importingMultipleFilesNotStarted:{id:"importActions.importingMultipleFilesNotStarted.loadingMessage",defaultMessage:"Imported 0 of {totalNumberOfFiles}"},importingMultipleFilesInProgress:{id:"importActions.importingMultipleFilesInProgress.loadingMessage",defaultMessage:"Imported {numberOfImportedFiles} of {totalNumberOfFiles}"},importingMultipleFilesComplete:{id:"importActions.importingMultipleFilesComplete.loadingMessage",defaultMessage:"Imported {totalNumberOfFiles} of {totalNumberOfFiles}"},importingFromTrelloMessage:{id:"importActions.importingFromTrello.loadingMessage",defaultMessage:"{importingCount, plural, one {Importing {importingCount} board from Trello} other {Importing {importingCount} boards from Trello}}"},importingFromAsanaMessage:{id:"importActions.importingFromAsana.loadingMessage",defaultMessage:"{importingCount, plural, one {Importing {importingCount} project from Asana} other {Importing {importingCount} projects from Asana}}"},importingFromEvernoteMessage:{id:"importActions.importingFromEvernote.loadingMessage",defaultMessage:"{importingCount, plural, one {Importing {importingCount} notebook from Evernote} other {Importing {importingCount} notebooks from Evernote}}"},importingFromConfluenceViaAPIMessage:{id:"importActions.importingFromConfluenceViaAPI.loadingMessage",defaultMessage:"Importing confluence space: {confluenceSpaceKey}."},importFailed:{id:"importActions.importFailedError.message",defaultMessage:"Import failed."},fileImportFailedSizeTooLarge:{id:"importActions.fileImportFailedError.sizeTooLarge.message",defaultMessage:"Import failed: file exceeds 5MB."},trelloImportFailed:{id:"importActions.trelloImportFailedError.message",defaultMessage:"Trello import failed."},asanaImportFailed:{id:"importActions.asanaImportFailedError.message",defaultMessage:"Asana import failed."},evernoteImportFailed:{id:"importActions.evernoteImportFailedError.message",defaultMessage:"Evernote import failed."},confluenceImportViaAPIFailed:{id:"importActions.confluenceImportViaAPIFailedError.message",defaultMessage:"Confluence space import failed."},importTitle:{id:"importActions.importTitle",defaultMessage:"Import {date}"},importTitleForGenericFileImporter:{id:"importActions.importTitleForGenericFileImporter",defaultMessage:"Generic File Import {date}"}}),O=1073741824;async function V(e){const{environment:t,pageStore:i,spaceStore:n,isTeamPage:a,spaceViewStore:s,uploadType:u,flowId:m}=e;let y;try{const l=await L.y({multiple:!0,accept:p[u].join(",")});if(0===l.length)return;const d=1===l.length;if("confluence"===u){const i=(Number((0,M.$6)(t))||15)*O;if(l[0].size>i)throw Z.a1y(e.environment,{import_source:"confluence",data:{import_type:"file",status:"failure",error:"Maximum upload size exceeded",fileSize:l[0].size},flowId:m}),new c.nY("Maximum upload size exceeded",{clientData:{type:"upload_file_size_exceeded",messageValues:{maxSize:h.td(i,1)}}})}else if("genericImporter"===u){const i=(0,C.b)(t)||15,n=i*O;if(l[0].size>n)throw Z.a1y(e.environment,{import_source:"file",data:{import_type:"file",status:"failure",error:"Maximum upload size exceeded",fileSize:l[0].size},flowId:m}),new c.p8("Maximum upload size exceeded",{clientData:{type:"upload_file_size_exceeded",messageValues:{maxSize:`${i} GB}`}}})}const g=await new Promise(((e,i)=>{L.IL({environment:t,uploadType:u,files:l,bucket:"temporary",preventLimitFreeFileSize:!0,flowId:m,onBatchStart:()=>{E.j({message:d?N.uploadingOneFile:N.uploadingMultipleFilesNotStarted,interpolatedValues:{totalNumberOfFiles:l.length,percentComplete:0}})},onBatchProgress:e=>{let{uploadedFiles:t,progressPercent:i}=e;E.j({message:d?N.uploadingOneFile:N.uploadingMultipleFilesInProgress,interpolatedValues:{numberOfUploadedFiles:t,totalNumberOfFiles:l.length,percentComplete:i}})},onBatchComplete:t=>{E.j({message:d?N.uploadingOneFile:N.uploadingMultipleFilesComplete,interpolatedValues:{totalNumberOfFiles:l.length,percentComplete:100}}),e(t)},onBatchError:i})}));let b,w;if(i&&i.isEmptyPage())l.length>1||i.isInsideCollection()?(b=i.id,w="AppendToBlock"):(b=i.id,w="ReplaceBlock");else{const{performResult:e}=R.createAndCommit({userAction:"importActions.result",environment:t,perform:e=>{const i=_.default.formatMessage("genericImporter"===u?N.importTitleForGenericFileImporter:N.importTitle,{date:(0,r.Yx)(Date.now(),"medium",o.SP)}),d=D.KE({environment:t,spaceStore:n,spaceViewStore:s,isPrivate:!a,prepend:!a,title:i,transaction:e});let c;c=l.length>1?"AppendToBlock":"ReplaceBlock";const m=f.UZ();return e.postSubmitCallbacks.push((e=>{e?m.reject(e):m.resolve()})),{deferred:m,createdPage:d,pageId:d.id,importType:c}}});y=e.createdPage,b=e.pageId,w=e.importType,await e.deferred.promise}const k=g.map(((e,t)=>({fileURL:e,fileName:l[t].name})));let T=0;E.j({message:d?N.importingOneFile:N.importingMultipleFilesInProgress,interpolatedValues:{numberOfImportedFiles:T,totalNumberOfFiles:l.length}});for(const{fileURL:e,fileName:i}of k){if("confluence"===u){Z.a1y(t,{import_source:"confluence",data:{import_type:"file",status:"success",fileSize:l[0].size},flowId:m});const a=U({environment:t,spaceStore:n,spaceViewStore:s});await a.deferred.promise;const o=a.pageId,r=x.parallelImportConfluenceExport(t,{fileURL:e,fileName:i,page:{id:b,spaceId:n.id},loggerPageId:o,flowId:m||(0,v.ZP)()});for await(const e of r){if(e.error)throw e.error;e.value.isComplete||E.j(e.value.status)}}else if("AppendToBlock"===w){const a={fileURL:e,fileName:i,importType:w,block:{id:b,spaceId:n.id},flowId:m};Z.qyQ(t,{import_source:"file",data:a,flowId:m});const{value:o}=await x.importFile(t,a).next();if(o.error)throw o.error}else if("ReplaceBlock"===w){const a={fileURL:e,fileName:i,importType:w,block:{id:b,spaceId:n.id},flowId:m};Z.qyQ(t,{import_source:"file",data:a,flowId:m});const{value:o}=await x.importFile(t,a).next();if(o.error)throw o.error}T++,E.j({message:d?N.importingOneFile:N.importingMultipleFilesInProgress,interpolatedValues:{numberOfImportedFiles:T,totalNumberOfFiles:l.length}})}return E.x(),P.G.createChildStore(n,{table:S.iU,id:b})}catch(k){var b;let e;d.log({level:"error",from:"importFiles",type:"importFilesFailure",error:(0,g.Ui)(k),data:{spaceId:n.id}}),E.x(),R.createAndCommit({userAction:"importActions.importFiles",environment:t,perform:e=>{y&&A.Od({parent:n.getPagesStore(),childToRemove:y,transaction:e})}});let i=null,a=null;throw k instanceof c.hm&&k.clientData?(i=k.clientData,w.Em[k.clientData.type]&&"ImportFileSizeTooLargeError"===(0,l.tg)(k).message?a=w.Em[k.clientData.type]:w.$5[k.clientData.type]&&"CsvImportError"===(0,l.tg)(k).message?a=w.$5[k.clientData.type]:w.zP[k.clientData.type]&&(a=w.zP[k.clientData.type])):k instanceof c.nY&&"upload_file_size_exceeded"===(null===(b=k.body)||void 0===b||null===(b=b.clientData)||void 0===b?void 0:b.type)&&w.zP[k.body.clientData.type]&&(i=k.body.clientData,a=w.zP[i.type]),e=i&&a?_.default.formatMessage(a,i.messageValues):"ImportFileSizeTooLargeError"===(0,l.tg)(k).message?_.default.formatMessage(N.fileImportFailedSizeTooLarge):_.default.formatMessage(N.importFailed),F.showErrorMessage(e),k}}function U(e){const{environment:t,spaceStore:i,spaceViewStore:n,append:a}=e,{performResult:s}=R.createAndCommit({userAction:"importActions.result",environment:t,perform:e=>{const s=_.default.formatMessage(N.importTitle,{date:(0,r.Yx)(Date.now(),"medium",o.SP)}),l=D.KE({environment:t,spaceStore:i,spaceViewStore:n,isPrivate:!0,prepend:!a,title:`${s} Logs`,transaction:e}),d=f.UZ();return e.postSubmitCallbacks.push((e=>{e?d.reject(e):d.resolve()})),{deferred:d,pageId:l.id}}});return s}async function W(e){const{environment:t,boards:i,spaceStore:n,spaceViewStore:a}=e;E.j({message:N.importingFromTrelloMessage,interpolatedValues:{importingCount:i.length}}),I.Z.setState({open:!1});const{performResult:{deferred:o,pages:s}}=R.createAndCommit({userAction:"importActions.importTrello",environment:t,perform:e=>{const o=i.map((i=>D.KE({environment:t,spaceStore:n,spaceViewStore:a,isPrivate:!0,prepend:!0,loading:!0,title:i.name,transaction:e}))),s=f.UZ();return e.postSubmitCallbacks.push((e=>{e?s.reject(e):s.resolve()})),{deferred:s,pages:o}}});await o.promise;try{return await Promise.all(s.map((async(e,n)=>{const a=i[n],{value:o}=await x.importTrello(t,{boardId:a.id,block:{id:e.id,spaceId:(0,y.CG)(e.pointer.spaceId)}}).next();if(o.error)throw o.error}))),E.x(),s[0]}catch(r){throw R.createAndCommit({userAction:"importActions.importTrello",environment:t,perform:e=>{for(const t of s)A.Od({parent:n.getPagesStore(),childToRemove:t,transaction:e})}}),F.showErrorMessage(_.default.formatMessage(N.trelloImportFailed)),E.x(),new Error((0,l.tg)(r).message)}}async function K(e){const{environment:t,spaceStore:i,spaceViewStore:n,notebooks:o,userSettingsStore:r}=e;if(0===o.length)throw new Error("Expected at least one notebook");E.j({message:N.importingFromEvernoteMessage,interpolatedValues:{importingCount:o.length}}),T.Z.setState({open:!1});const l=await async function(e){const{environment:t,spaceStore:i,spaceViewStore:n,notebooks:o}=e,{serverCommitResult:r,performResult:{blockStores:l}}=R.createAndCommit({userAction:"importActions.createStacks",environment:t,perform:e=>{const r=a().uniq(a().compact(o.map((e=>e.stack)))).sort().reverse(),l={};let d=e=>!0;return o.length>1&&r.length>0&&(r.forEach((a=>{const r=D.KE({environment:t,spaceStore:i,spaceViewStore:n,isPrivate:!0,prepend:!0,loading:!1,title:a,transaction:e}),d=r.getContentStore();o.filter((e=>e.stack===a)).forEach((i=>{const n=B.j4({environment:t,type:s.Ti.copyIndicator,inMemoryRecordCache:r.inMemoryRecordCache,transaction:e,spaceId:d.pointer.spaceId});A.R3({parent:d,append:n,transaction:e}),l[i.guid]=n}))})),d=e=>!Boolean(e.stack)),o.filter(d).reverse().forEach((a=>{const o=D.KE({environment:t,spaceStore:i,spaceViewStore:n,isPrivate:!0,prepend:!0,loading:!0,title:a.title,transaction:e});l[a.guid]=o})),{blockStores:l}}});return await r,l}({environment:t,spaceStore:i,spaceViewStore:n,notebooks:o}),d=l[o[0].guid];try{return await async function(e){const{environment:t,spaceStore:i,spaceViewStore:n,notebooks:a,waitForNotebook:o,notebookMapping:s,userSettingsStore:r}=e;let l;if(f.dC(a,2,(async e=>{await Promise.all(e.map((async e=>{const i=s[e.guid];if(!i)throw new Error(`Missing notebook page ${e.guid}`);const n=f.UZ();i===o&&(l=n),await async function(e){const{environment:t,notebookStore:i,notebook:n,firstCompleted:a}=e,o=x.importEvernote(t,{notebookId:n.guid,block:{id:i.id,spaceId:(0,y.CG)(i.pointer.spaceId)},timestamp:Date.now(),parentTable:S.iU}),{value:s}=await o.next();s.error&&(console.error(s.error),R.createAndCommit({userAction:"importActions.importEvernoteNotebook",environment:t,perform:e=>{const t=i.getParentBlockStore();if(t){const n=t.getContentStore();A.Od({parent:n,childToRemove:i,transaction:e})}}}),F.showErrorMessage(_.default.formatMessage(N.evernoteImportFailed)));a.resolve(void 0)}({environment:t,notebookStore:i,notebook:e,firstCompleted:n})})))})),!l)throw new Error("waitForNotebookFirstCompleted not defined.");const d=r.getSettings();null!=d&&d.created_evernote_getting_started||await D.FI({environment:t,type:"evernote",spaceStore:i,spaceViewStore:n,userSettingsStore:r});await l.promise}({environment:t,waitForNotebook:d,notebookMapping:l,notebooks:o,spaceStore:i,spaceViewStore:n,userSettingsStore:r}),E.x(),d}catch(c){throw E.x(),F.showErrorMessage(_.default.formatMessage(N.evernoteImportFailed)),c}}async function z(e){const{environment:t,spaceStore:i,spaceViewStore:n,space:a,flowId:s}=e;if(!t.currentUser.id)throw new Error("User does not exist.");E.j({message:N.importingFromConfluenceViaAPIMessage,interpolatedValues:{confluenceSpaceKey:a.name}}),k.Z.setState({open:!1});const c=U({environment:t,spaceStore:i,spaceViewStore:n});await c.deferred.promise;const u=c.pageId,{performResult:m}=R.createAndCommit({userAction:"importActions.importConfluenceViaApi",environment:t,perform:e=>{const a=_.default.formatMessage(N.importTitle,{date:(0,r.Yx)(Date.now(),"medium",o.SP)}),s=D.KE({environment:t,spaceStore:i,spaceViewStore:n,isPrivate:!0,prepend:!0,title:a,transaction:e}),l=f.UZ();return e.postSubmitCallbacks.push((e=>{e?l.reject(e):l.resolve()})),{deferred:l,createdPage:s,pageId:s.id}}});await m.deferred.promise;const p=m.createdPage;try{if(!p)throw new Error("No root page");const e=x.parallelImportConfluenceViaApi(t,{userId:t.currentUser.id,confluenceSpaceKey:a.key,page:{id:m.pageId,spaceId:i.id},loggerPageId:u,flowId:s});for await(const t of e){if(t.error)throw t.error;t.value.isComplete||E.j(t.value.status)}return E.x(),p}catch(h){throw d.log({level:"error",from:"importConfluenceViaAPI",type:"importConfluenceViaAPIFailure",error:(0,g.Ui)(h),data:{spaceId:i.id}}),R.createAndCommit({userAction:"importActions.importConfluenceViaApi",environment:t,perform:e=>{p&&A.Od({parent:i.getPagesStore(),childToRemove:p,transaction:e})}}),F.showErrorMessage(_.default.formatMessage(N.confluenceImportViaAPIFailed)),E.x(),new Error((0,l.tg)(h).message)}}},37834:(e,t,i)=>{i.d(t,{jN:()=>h,FF:()=>f,U4:()=>v,gs:()=>y,zb:()=>S,xx:()=>b});var n=i(23174),a=i.n(n),o=(i(67294),i(98459)),s=i(82990),r=i(5366),l=i(10161),d=i(46096),c=i(50906),u=i(54642),m=i(47307),p=i(92625);const g=(0,r.defineMessages)({restoringPreviousVersion:{id:"historyModalActions.restoringPreviousVersion.loadingMessage",defaultMessage:"Restoring…"}});function h(e){const{environment:t,from:i,...n}=e;c.ya1(t,i),d.Z.setState({...n,open:!0,size:50})}const f=()=>{const e=d.Z.state;e.open&&d.Z.setState({...e,size:e.size+20})},v=function(){d.Z.setState({open:!1})};function y(e){const{environment:t,snapshot:i,nextFutureSnapshot:n}=e;c.qDg(t,i);const a=d.Z.state;a.open&&d.Z.setState({...a,snapshot:i,nextFutureSnapshot:n,openSnapshotNearTimestamp:void 0})}function S(){const e=d.Z.state;e.open&&d.Z.setState({...e,snapshot:void 0,nextFutureSnapshot:void 0})}async function b(e){if(!d.Z.state.open)return;if(!d.Z.state.snapshot)return;const t="restore_collection",i=d.Z.state.pageHasCollection,n=l.default.checkGate("snapshot_optional_collection_rollback_enabled")&&i?[{key:t,text:a()(r.FormattedMessage,{defaultMessage:"Also restore databases on this page",id:"historyModal.confirmDialog.selectOption.collection"}),description:a()(r.FormattedMessage,{defaultMessage:"All database pages will be restored to the previous version, which may impact other users or database views.",id:"historyModal.confirmDialog.selectOption.collection.description"})}]:void 0,{accept:h,selectionResult:f}=await m.confirmUserActionV2({message:a()("div",{style:{fontWeight:s.Z.fontWeight.semibold,fontSize:"medium"}},void 0,a()(r.FormattedMessage,{defaultMessage:"Restore to this version?",id:"historyModal.confirmDialog.description"})),acceptLabel:a()(r.FormattedMessage,{defaultMessage:"Restore",id:"historyModal.confirmDialog.restoreButton.label"}),selectionItems:n});if(!h)return;c.R9m(e,d.Z.state.snapshot),p.j({message:g.restoringPreviousVersion});const y=await u.restoreSnapshot(e,{block:{id:d.Z.state.blockStore.id,spaceId:(0,o.CG)(d.Z.state.blockStore.pointer.spaceId)},timestamp:d.Z.state.snapshot.timestamp,shouldRestoreCollection:(null==f?void 0:f.restore_collection)??!1}).next();y.value.error&&m.showErrorMessage(y.value.error.message),p.x(),v()}},45145:(e,t,i)=>{i.d(t,{d:()=>F});var n=i(10434),a=i.n(n),o=i(23174),s=i.n(o),r=i(67294),l=i(480),d=i(5366),c=i(73063),u=i(44532),m=i(58032),p=i(935),g=i(24405),h=i(53397),f=i(82990),v=i(42922),y=i(64921),S=i(12508),b=i(1743),M=i(74194),w=i(16354),C=i(64369),_=i(42402),k=i(43250),T=i(33665);function I(e){const{checked:t,onChange:i}=e;return s()("div",{style:{display:"flex",gap:6,alignItems:"center"}},void 0,s()(S.Z,{checked:t,onClick:i,size:14}),s()("div",{onClick:i},void 0,s()(C.Z,{style:{cursor:"pointer"},isSmall:!0},void 0,s()(d.FormattedMessage,{defaultMessage:"Share this AI session with Notion",id:"completions.FeedbackPopup.shareWithNotion"}))))}function P(){window.__c={n:"OptInLearnMore"};const e=(0,g.yK)((e=>({container:{display:"flex",flexDirection:"row"},giftIcon:{width:16,height:16,fill:e.lightIconColor},message:{marginLeft:9,color:e.mediumTextColor,fontSize:12}})),[]);return s()("div",{style:e.container},void 0,h.Z.giftOutline(e.giftIcon),s()("div",{style:e.message},void 0,s()(d.FormattedMessage,{defaultMessage:"You’re sharing data with Notion for AI quality improvement. <aiTerms>Learn more</aiTerms>",id:"completions.OptInLearnMore.description",values:{aiTerms:e=>s()(_.Z,{external:!0,href:(0,T.UY)("ai.dataSharingTerms")},void 0,e)}})))}function Z(e){window.__c={n:"ShareDataPopup"};const{onSubmit:t}=e,i=(0,g.yK)((e=>({container:{width:300,display:"flex",flexDirection:"column",alignItems:"center",padding:19,position:"relative"},closeButtonContainer:{position:"absolute",top:10,right:10},closeButton:{zIndex:10,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"100%",background:e.buttonHoveredBackground,width:20,height:20,padding:4},closeButtonHover:{background:e.buttonPressedBackground},closeButtonIcon:{width:16,fill:e.mediumTextColor},giftIcon:{width:24,height:24,fill:e.lightIconColor},terms:{color:e.mediumTextColor,textAlign:"center",fontSize:13},shareButton:{width:"100%",marginTop:17,paddingTop:7,paddingBottom:7},notNowButton:{color:e.mediumTextColor,fontSize:14,marginTop:15},title:{textAlign:"center",marginTop:9,marginBottom:8,fontWeight:f.Z.fontWeight.semibold}})),[]);return s()("div",{style:i.container},void 0,s()("div",{style:i.closeButtonContainer},void 0,s()(y.Z,{onClick:()=>{t({optIn:!1})},style:i.closeButton,hoveredStyle:i.closeButtonHover},void 0,h.Z.closeSmall(i.closeButtonIcon))),h.Z.giftOutline(i.giftIcon),s()("div",{style:i.title},void 0,s()(d.FormattedMessage,{defaultMessage:"Always share data to improve Notion AI?",id:"completions.ShareDataPopup.title"})),s()("div",{style:i.terms},void 0,s()(d.FormattedMessage,{defaultMessage:"Help Notion improve AI quality by automatically sharing data from your usage of AI powered features.{br}By continuing, you agree to <aiTerms>AI Data Sharing Terms</aiTerms>",id:"completions.ShareDataPopup.description",values:{br:s()("br",{}),aiTerms:e=>s()(_.Z,{external:!0,href:(0,T.UY)("ai.dataSharingTerms")},void 0,e)}})),s()(v.Z,{style:i.shareButton,onClick:()=>{t({optIn:!0})}},void 0,s()(d.FormattedMessage,{defaultMessage:"Always share",id:"completions.ShareDataPopup.alwaysShareButton"})),s()(w.Z,{style:i.notNowButton,onClick:()=>{t({optIn:!1})}},void 0,s()(d.FormattedMessage,{defaultMessage:"Not now",id:"completions.ShareDataPopup.notNowButton"})))}function x(e){window.__c={n:"FeedbackPopup"};const{state:t,onUpdate:i,onSubmit:n,onCancel:a,userOptIn:o}=e,u=(0,r.useCallback)((()=>{i({...t,shareWithNotion:!t.shareWithNotion})}),[t,i]),m=(0,r.useCallback)((()=>{n(t)}),[n,t]),p=(0,r.useCallback)((e=>{i({...t,userContent:e.target.value})}),[i,t]),g=(0,d.useIntl)(),f=(0,l.O7)(),v=!o;return s()("div",{style:{padding:14,...f.device.isMobile?{width:"100%"}:{minWidth:400}},className:k.YOJ},void 0,s()(b.Z,{capture:!0},void 0,s()(M.Z,{value:t.userContent,onChange:p,onSubmit:e=>{e.stopPropagation(),m()},onCancel:a,focusInitial:!0,placeholder:g.formatMessage({id:"completions.FeedbackPopup.userCommentPlaceholder",defaultMessage:"How could the output be improved? (optional)"})}),s()("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingTop:10}},void 0,v?s()(I,{checked:t.shareWithNotion,onChange:u}):s()(P,{}),s()(c.Z,{icon:h.Z.sendArrow,onClick:m,ariaLabel:g.formatMessage({id:"completions.FeedbackPopup.submitButtonLabel",defaultMessage:"Submit feedback"}),isBlue:!0,iconStyle:{height:24,width:24},style:{height:20,width:20}}))))}function F(e){window.__c={n:"FeedbackButtonWithPopup"};const{type:t,ariaLabel:i,onClick:n,feedbackState:o,onDismiss:g,onSubmit:h,onUpdate:f,showShareDataPopup:v,onDataShareSubmit:y,userOptIn:S,iconButtonStyles:b}=e,M=(0,l.O7)(),w=t===(null==o?void 0:o.type),C=(0,p.L)(t,w),_=(0,r.useCallback)((()=>n(t)),[n,t]),k=s()(m.Z,{renderTooltip:()=>s()("div",{},void 0,s()(d.FormattedMessage,{defaultMessage:"Share feedback with Notion",id:"completions.CompletionMenuActionBar.feedbackTooltip"})),placement:m.Z.Placement.Bottom,render:e=>r.createElement(c.Z,a()({onClick:_,icon:C,ariaLabel:i,style:{...b}},e))});return s()(u.ZP,{origin:k,open:(null==o?void 0:o.type)===t,popupType:M.device.isMobile?u.kQ.SlideUp:u.kQ.Popup,onDismiss:g,render:()=>o?v?s()(Z,{onCancel:g,onSubmit:y}):s()(x,{state:o,onSubmit:h,onUpdate:f,onCancel:g,userOptIn:S}):null})}},935:(e,t,i)=>{i.d(t,{L:()=>S,u:()=>b});var n=i(23174),a=i.n(n),o=i(67294),s=i(480),r=i(81954),l=i(53397),d=i(5366),c=i(50906),u=i(73928),m=i(64964),p=i(12359),g=i(37181),h=i(8323),f=i(79315),v=i(10161),y=i(45145);function S(e,t){switch(e){case"thumbsup":return t?l.Z.thumbUpFilled:l.Z.thumbUp;case"thumbsdown":return t?l.Z.thumbDownFilled:l.Z.thumbDown}}function b(e){window.__c={n:"FeedbackButtons"};const{revision:t}=e,i=(0,d.useIntl)(),n=(0,s.O7)(),[l,S]=(0,o.useState)(void 0),[b,M]=(0,o.useState)(!1),w=(0,o.useRef)(null),C=(0,r.VK)((()=>v.default.checkGate("ai_data_sharing")),[]),_=(0,r.VK)((()=>f.default.state.currentUserSettingsStore),[]),k=(0,r.VK)((()=>{var e;const t=null==_||null===(e=_.getSettings())||void 0===e?void 0:e.seen_ai_data_share_prompt_at,i=!(0,h.mq)();return!Boolean(t)&&i}),[_]),T=(0,r.VK)((()=>{var e;return(null==_||null===(e=_.getSettings())||void 0===e?void 0:e.ai_data_share_opt_in)??false}),[_]),I=(0,o.useCallback)((()=>{m.oV({label:i.formatMessage({id:"completions.CompletionMenuFooter.showFeedbackThanksMessage",defaultMessage:"Thanks for submitting feedback!"})})}),[i]),P=(0,o.useCallback)((e=>{w.current=document.activeElement,S((t=>({userContent:"",shareWithNotion:true,...t,type:e})))}),[]),Z=(0,o.useCallback)((e=>{e.shareWithNotion&&k&&C?M(!0):(I(),S(void 0)),u.bl({...e,environment:n,revision:t,userOptIn:T})}),[t,n,T,k,C,I]),x=(0,o.useCallback)((e=>{e&&e.stopPropagation&&e.stopPropagation(),S(void 0),w.current&&w.current instanceof HTMLElement&&w.current.focus()}),[]),F=(0,o.useCallback)((e=>{const{optIn:t}=e;_&&(p.createAndCommit({userAction:"FeedbackButtons.aiDataShareOptIn",environment:n,userId:_.id,perform:e=>{g.d2({userSettingsStore:_,data:{ai_data_share_opt_in:t,seen_ai_data_share_prompt_at:Date.now()},transaction:e})}}),c.bd0(n,{user_opt_in:t}),t?m.oV({label:i.formatMessage({id:"completions.CompletionMenuFooter.dataShareThanks",defaultMessage:"Thank you for your help making Notion better!"})}):I(),M(!1),S(void 0))}),[i,_,n,I]);return t.hasFeedback&&!b?null:o.createElement(o.Fragment,null,a()(y.d,{type:"thumbsup",ariaLabel:i.formatMessage({id:"completions.CompletionMenuFooter.thumbsUp",defaultMessage:"Submit positive feedback"}),onClick:P,feedbackState:l,onDismiss:x,onSubmit:Z,onUpdate:S,showShareDataPopup:b,onDataShareSubmit:F,userOptIn:T}),a()(y.d,{type:"thumbsdown",ariaLabel:i.formatMessage({id:"completions.CompletionMenuFooter.thumbsDown",defaultMessage:"Submit negative feedback"}),onClick:P,feedbackState:l,onDismiss:x,onSubmit:Z,onUpdate:S,showShareDataPopup:b,onDataShareSubmit:F,userOptIn:T}))}},3444:(e,t,i)=>{i.d(t,{cP:()=>Be,ZP:()=>Ee,a_:()=>Ae});var n=i(23174),a=i.n(n),o=(i(57658),i(67294)),s=i(13991),r=i(480),l=i(81954),d=i(24405),c=i(7057),u=i(53397),m=i(74181),p=i(77420),g=i(9844),h=i(90965),f=i(5500),v=i(9038),y=i(97880),S=i(82990),b=i(7928),M=i(63143),w=i(5366),C=(i(95477),i(38755)),_=i(79315),k=i(68216),T=i(20454),I=i(10434),P=i.n(I),Z=i(8848),x=i(58573),F=i(19889),A=i(50906),E=i(76463),B=i(5978),D=i(64964),R=i(12359),L=i(87279),N=i(33665),O=i(61766),V=i(74021),U=i(24736),W=i(26825),K=i(15025),z=i(28992);function G(e){window.__c={n:"BotCapabilitiesTooltip"};const{capabilities:t}=e,i=(0,w.useIntl)(),{device:n}=(0,r.O7)(),s=(0,W.uH)(t),l=(0,W.Rh)(t),d=(0,W.WM)(e.capabilities),c=[...(0,K.zq)(s),...(0,K.ac)(l),...(0,K.VR)(d)];return o.createElement(z.Z,P()({},e,{title:i.formatMessage((0,W.Gx)(s,void 0).label),shouldWrapCaption:!0,style:n.isMobile?{padding:"12px 4px"}:{padding:4,marginTop:2,marginBottom:2},captionStyle:{marginTop:4},caption:a()("div",{},void 0,c)}))}var q=i(52275),H=i(31945),j=i(68894),Q=i(68785),Y=i(78140),$=i(32163),X=i(53953),J=i(63296),ee=i(44532),te=i(72495),ie=i(64369),ne=i(29302);function ae(e){window.__c={n:"AdminIntegrationSettingsActionMenu"};const{integrationId:t,integrationTable:i,isLegacy:n,disableDisconnectUser:s,disableDisconnectAll:d,disableDisallow:c,botIds:u}=e,v=(0,l.VK)((()=>_.default.state.currentSpaceStore),[]),S=(0,r.Fy)(),b=(0,r.O7)(),M=(0,w.useIntl)(),C=be(),[I,Z]=(0,o.useState)(void 0),[A,E]=(0,o.useState)(!1),[B,D]=(0,o.useState)(!1),[O,V]=(0,o.useState)(!1),[W,K]=(0,o.useState)(void 0),z=(0,l.VK)((()=>v&&i?(0,k.Kv)(v,{table:i,id:t}):void 0),[v,t,i]),G=(0,l.VK)((()=>{if(n){const e=m.ns.find((e=>e.id===t));return{name:null==e?void 0:e.name,url:(0,N.UY)("guides.connectedApps")}}if(v&&i){const n=v.getRecordModel({table:i,id:t});if(i===g.K2&&!(0,f.BP)({integrationId:t,env:"production"})){var e,a;const t=n;return{name:null==n?void 0:n.name,url:null==t||null===(e=t.getInfo())||void 0===e?void 0:e.website_url,email:null==t||null===(a=t.getInfo())||void 0===a?void 0:a.email}}return{name:null==n?void 0:n.name}}}),[v,t,i,n]),q=(0,l.VK)((()=>u&&!s?u.map((e=>v&&z?k.t1.createChildStore(z,{table:p.cZ,id:e,spaceId:v.id}):void 0)):[]),[v,u,z,s]).filter(y.$K),Q=(0,l.VK)((()=>q.filter((e=>e.getAlive()))),[q]),J=(0,l.VK)((()=>{if(v&&Q&&!s){return Q.map((e=>e.getCreatedById())).filter(y.$K).map((e=>T.U.createChildStore(v,{table:F.KJ,id:e}))).filter((e=>e.isDefined()))}return[]}),[Q,v,s]),ee=(0,l.VK)((()=>null==v?void 0:v.getBotSettingsStore().getValue()),[v]),ie=(0,l.VK)((()=>null==Q?void 0:Q.reduce(((e,t)=>{const i=J.find((e=>e.id===t.getCreatedById()));return e[t.id]={userStore:i,botCapabilities:t.getCapabilities()},e}),{})),[Q,J]),ne=(0,l.VK)((()=>I?(0,x.ZP)(I,Object.entries(ie),(e=>{let[,{userStore:t}]=e;return t.getSearchName(M)})):Object.entries(ie)),[ie,I,M]),ae=!s&&(null==u?void 0:u.length)&&a()(te.Z,{isInput:!0,style:{padding:8}},void 0,a()(j.ZP,{textWrapperStyle:{margin:0},focus:!S.isMobile||void 0,focusAfterAnimation:!0,value:I||"",onChange:e=>Z(e.target.value),placeholder:M.formatMessage({id:"integrationInstallerFilter.userSearch.placeholder",defaultMessage:"Filter by user"})})),re=ne.length?[{key:"disconnect user section",render:e=>o.createElement(te.Z,e),items:se({users:ne,disableDisconnectUser:s,showDisplayModal:()=>D(!0),setSelectedUser:K,intl:M})}]:[],Se=(null==G?void 0:G.url)||(null==G?void 0:G.email),Me=Boolean(null==u?void 0:u.length)||(0,h.CJ)(ee)&&!c,we=o.createElement(o.Fragment,null,Se&&a()(te.Z,{topBorder:Boolean(ne.length)},"app-links",(null==G?void 0:G.url)&&a()(le,{environment:b,developerWebsite:G.url}),(null==G?void 0:G.email)&&a()(de,{environment:b,developerEmail:G.email})),Me&&a()(te.Z,{topBorder:Boolean(ne.length||Se)},void 0,Boolean(null==u?void 0:u.length)&&a()(ce,{showDisplayModal:()=>V(!0)}),(0,h.CJ)(ee)&&!c&&a()(ue,{showDisplayModal:()=>E(!0)})));return(Se||Me)&&G?a()(H.ZP,{popupType:S.isMobile?H.Z4.SlideUp:H.Z4.Popup,renderOrigin:e=>o.createElement(U.Z,P()({},e,{isMobile:S.isMobile,style:{marginLeft:8,marginRight:8}})),render:()=>o.createElement(o.Fragment,null,a()(Y.Z,{menuType:S.isMobile?L.og.ActionSheet:L.og.Popup,header:!s&&ae,footer:we,width:230},void 0,a()($.Z,{type:$.i.Vertical,sections:re,initialFocus:void 0})),a()(X.Z,{open:!s&&B,onDismiss:()=>{D(!1)},disableAnimation:!0,showCloseIcon:!0,innerStyle:C.innerModal,render:()=>a()(me,{title:a()(ve,{integrationName:G.name}),caption:a()(ye,{integrationName:G.name,userName:null==W?void 0:W.userName}),type:"disconnect",handleCancel:()=>{D(!1),K(void 0)},handleConfirmation:async()=>{W&&(await oe({botIds:[W.botId],environment:b}),K(void 0)),D(!1)}})}),a()(X.Z,{open:!d&&O,onDismiss:()=>{V(!1)},disableAnimation:!0,showCloseIcon:!0,innerStyle:C.innerModal,render:()=>a()(me,{title:a()(he,{integrationName:G.name}),caption:a()(fe,{integrationName:G.name}),type:"disconnect",handleCancel:()=>V(!1),handleConfirmation:async()=>{await oe({botIds:u,environment:b}),V(!1)}})}),a()(X.Z,{open:!c&&A,onDismiss:()=>{E(!1)},disableAnimation:!0,showCloseIcon:!0,innerStyle:C.innerModal,render:()=>a()(me,{title:a()(pe,{integrationName:G.name}),caption:a()(ge,{integrationName:G.name,disableDisconnectAll:d}),type:"disapprove",handleCancel:()=>E(!1),handleConfirmation:async()=>{!function(e){const{currentSpaceStore:t,environment:i,integrationId:n}=e;t&&R.createAndCommit({userAction:"AdminIntegrationSettingsActionMenu.handleDisapproveIntegration",environment:i,perform:e=>{R.applyOperation({store:t,operation:{pointer:t.pointer,path:["bot_settings","integration_approval_statuses"],command:"update",args:{[n]:null}},transaction:e})}})}({currentSpaceStore:v,environment:b,integrationId:t}),d||await oe({botIds:u,environment:b}),E(!1)}})}))}):null}async function oe(e){let{botIds:t,environment:i}=e;t&&await Promise.all(t.map((e=>E.P0({environment:i,botId:e,onSuccess:()=>{A.IN8(i,{type:"public"})}}))))}function se(e){const{intl:t,disableDisconnectUser:i,users:n,showDisplayModal:o,setSelectedUser:s}=e;return i?[]:n.map((e=>{let[i,{userStore:n,botCapabilities:r}]=e;return{key:n.id,render:e=>a()(re,{buttonMenuProps:e,userStore:n,botCapabilities:r,selectAction:()=>{o(),s({botId:i,userName:n.getDisplayName(t)})}}),action:()=>{o(),s({botId:i,userName:n.getDisplayName(t)})}}}))}function re(e){window.__c={n:"UserMenuActionItem"};const{buttonMenuProps:t,userStore:i,botCapabilities:n,selectAction:s}=e,l=(0,r.Fy)(),[d,c]=(0,o.useState)(!1);return a()(ee.ZP,{popupType:l.isMobile?H.Z4.SlideUp:H.Z4.Popup,placementToOrigin:H.pO.Right,open:d,onDismiss:()=>c(!1),origin:o.createElement(q.Z,P()({},t,{title:a()("div",{style:{display:"flex",alignContent:"center",justifyContent:"space-between"}},void 0,a()(ne.Z,{userStore:i,avatarSize:18,inline:!0,avatarShouldShowShadow:!0,style:{flexShrink:1}})),textWrapperStyle:{marginLeft:12,marginRight:12},focused:!1,onClick:()=>c(!0)})),render:()=>a()(Y.Z,{width:240,menuType:l.isMobile?L.og.ActionSheet:L.og.Popup,header:a()("div",{style:{padding:2,marginTop:4,marginBottom:4}},void 0,a()(G,{capabilities:n}))},void 0,a()($.Z,{type:$.i.Vertical,sections:[{key:"integration capabilities",render:e=>o.createElement(te.Z,P()({},e,{topBorder:!0})),items:[{key:"remove",render:e=>o.createElement(q.Z,P()({},e,{focused:!1,title:a()("div",{style:{color:Z.ZP.red}},void 0,a()(w.FormattedMessage,{id:"spaceIntegrationSettings.actionMenu.revokeUserAccess.label",defaultMessage:"Disconnect user"}))})),action:s}]}],initialFocus:void 0}))})}function le(e){let{environment:t,developerWebsite:i}=e;return a()(q.Z,{onClick:()=>{B.navigateToExternalURL({environment:t,url:i}),A.fco(t,{href:i,from:"integration-settings"})},title:a()(w.FormattedMessage,{id:"spaceIntegrationSettings.actionMenu.visitDeveloperWebsite.label",defaultMessage:"Visit developer website"}),shouldWrapCaption:!0,focused:!1,textWrapperStyle:{marginLeft:12,marginRight:12}})}function de(e){let{environment:t,developerEmail:i}=e;return a()(q.Z,{onClick:()=>{B.navigateToExternalURL({environment:t,url:`mailto:${i}`}),A.Z9y(t,{from:"integration-settings"})},title:a()(w.FormattedMessage,{id:"spaceIntegrationSettings.actionMenu.contactDeveloperSupport.label",defaultMessage:"Contact support"}),shouldWrapCaption:!0,focused:!1,textWrapperStyle:{marginLeft:12,marginRight:12}})}function ce(e){let{showDisplayModal:t}=e;return a()(q.Z,{onClick:t,title:a()(w.FormattedMessage,{id:"spaceIntegrationSettings.actionMenu.disconnectAll.label",defaultMessage:"Disconnect all users"}),shouldWrapCaption:!0,focused:!1,textWrapperStyle:{marginLeft:12,marginRight:12,color:Z.ZP.red}})}function ue(e){let{showDisplayModal:t}=e;return a()(q.Z,{onClick:t,title:a()(w.FormattedMessage,{id:"spaceIntegrationSettings.actionMenu.removeIntegrationApproval.label",defaultMessage:"Remove from approved list"}),focused:!1,textWrapperStyle:{marginLeft:12,marginRight:12,color:Z.ZP.red}})}function me(e){let{title:t,caption:i,handleConfirmation:n,handleCancel:s,type:r}=e;window.__c={n:"ModalContent"};const[l,d]=(0,o.useState)(!1);return a()("div",{style:{padding:20,width:333}},void 0,a()(ie.Z,{isMultiline:!0,style:{marginBottom:8,fontWeight:S.Z.fontWeight.semibold,paddingRight:30}},void 0,t),a()(ie.Z,{isMultiline:!0,isSecondaryColor:!0,style:{marginBottom:8}},void 0,i),a()("div",{style:{display:"flex",marginTop:12}},void 0,a()(J.Z,{style:{width:140,marginRight:9},isLarge:!0,onClick:s,disabled:l},void 0,a()(ie.Z,{},void 0,a()(w.FormattedMessage,{id:"spaceIntegrationSettings.actionMenu.removeIntegrationApproval.modal.button.cancel",defaultMessage:"Cancel"}))),a()(J.Z,{style:{width:140},isLarge:!0,onClick:async()=>await n(d),backgroundColor:Z.ZP.red,disabled:l},void 0,a()(ie.Z,{style:{color:Z.ZP.white}},void 0,"disconnect"===r&&!0===l&&a()(Q.Z,{isWhite:!0}),"disconnect"===r&&!1===l&&a()(w.FormattedMessage,{id:"spaceIntegrationSettings.actionMenu.removeIntegrationApproval.modal.button.disconnect",defaultMessage:"Disconnect"}),"disapprove"===r&&a()(w.FormattedMessage,{id:"spaceIntegrationSettings.actionMenu.removeIntegrationApproval.modal.button.remove",defaultMessage:"Remove"})))))}function pe(e){let{integrationName:t}=e;return a()(w.FormattedMessage,{id:"spaceIntegrationSettings.actionMenu.removeIntegrationApproval.modal.title",defaultMessage:"Remove {integrationName} from approved integrations",values:{integrationName:t}})}function ge(e){let{integrationName:t,disableDisconnectAll:i}=e;return a()(w.FormattedMessage,i?{id:"spaceIntegrationSettings.actionMenu.removeIntegrationApproval.modal.caption",defaultMessage:"Prevent members from installing {integrationName}.",values:{integrationName:t}}:{id:"spaceIntegrationSettings.actionMenu.removeIntegrationApprovalAndDisconnectAll.caption",defaultMessage:"Revoke access for {integrationName} for all users in this workspace and prevent members from installing {integrationName}.",values:{integrationName:t}})}function he(e){let{integrationName:t}=e;return a()(w.FormattedMessage,{id:"spaceIntegrationSettings.actionMenu.disconnectAll.modal.label",defaultMessage:"Disconnect {integrationName} for all users in workspace",values:{integrationName:t}})}function fe(e){let{integrationName:t}=e;return a()(w.FormattedMessage,{id:"spaceIntegrationSettings.actionMenu.disconnectAll.modal.caption",defaultMessage:"Revoke access for {integrationName} for all users in this workspace.",values:{integrationName:t}})}function ve(e){let{integrationName:t}=e;return a()(w.FormattedMessage,{id:"spaceIntegrationSettings.actionMenu.disconnectUser.modal.label",defaultMessage:"Disconnect {integrationName}?",values:{integrationName:t}})}function ye(e){let{integrationName:t,userName:i}=e;return a()(w.FormattedMessage,{id:"spaceIntegrationSettings.actionMenu.disconnectUser.modal.caption",defaultMessage:"Revoke access for {integrationName} for {userName}",values:{integrationName:t,userName:i}})}function Se(e){window.__c={n:"AdminComplianceIntegrationSettingsActionMenu"};const{integrationId:t,webhookSubscription:i}=e,n=(0,r.Fy)(),s=(0,r.O7)(),[l,d]=(0,o.useState)(!1),c=be(),u=(0,v.oh)(t);if(!u)return null;const m=v.$C[u],p=m.info.developer_name;if(!p)return null;const g=new O.Z,h={key:"manage",action:()=>{V.Z.setState({open:!0,integrationId:t,webhookSubscriptionId:null==i?void 0:i.id}),g.setState({open:!1})},render:e=>o.createElement(q.Z,P()({},e,{title:a()(w.FormattedMessage,{id:"complianceIntegrationSettings.actionMenu.manage",defaultMessage:"Manage"})}))},f={key:"disconnect",action:()=>{g.setState({open:!1}),d(!0)},render:e=>o.createElement(q.Z,P()({},e,{title:a()("span",{style:c.disconnect},void 0,a()(w.FormattedMessage,{id:"complianceIntegrationSettings.actionMenu.disconnect",defaultMessage:"Disconnect"}))}))},y=[...m.info.oauth?[]:[h],f];return o.createElement(o.Fragment,null,a()(H.ZP,{popupType:n.isMobile?H.Z4.SlideUp:H.Z4.Popup,renderOrigin:e=>o.createElement(U.Z,P()({},e,{isMobile:n.isMobile,style:{marginLeft:8,marginRight:8}})),buttonPopupStore:g,render:()=>a()(Y.Z,{menuType:n.isMobile?L.og.ActionSheet:L.og.Popup,width:230},void 0,a()($.Z,{type:$.i.Vertical,sections:[{key:"options",render:e=>o.createElement(te.Z,e),items:y}],initialFocus:void 0}))}),a()(X.Z,{open:l,onDismiss:()=>d(!1),disableAnimation:!0,showCloseIcon:!0,innerStyle:c.innerModal,render:()=>a()(me,{title:a()(w.FormattedMessage,{id:"complianceIntegrationSettings.disconnectModal.title",defaultMessage:"Disconnect {integrationName}?",values:{integrationName:p}}),caption:a()(w.FormattedMessage,{id:"complianceIntegrationSettings.disconnectModal.subtitle",defaultMessage:"Revoke {integrationName}'s access to this workspace. Workspace events will no longer be sent to {integrationName}.",values:{integrationName:p}}),type:"disconnect",handleCancel:()=>d(!1),handleConfirmation:async()=>{const e=null==i?void 0:i.bot_id;e&&(await E.P0({environment:s,botId:e,onSuccess:()=>{}}),A.wi(s,{integration_id:t}),D.oV({label:a()(w.FormattedMessage,{id:"complianceIntegrationSettings.snackbar.title",defaultMessage:"Disconnected {integrationName} from your workspace",values:{integrationName:p}})}))}})}))}function be(){return(0,d.yK)((()=>({disconnect:{color:Z.ZP.red},innerModal:{borderRadius:10}})),[])}var Me=i(74136),we=i(31278),Ce=i(69219),_e=i(58032),ke=i(45653),Te=i(15070),Ie=i(59054),Pe=i(43132);function Ze(e){window.__c={n:"InternalIntegrationActionMenu"};const{botId:t}=e,[,,i]=(0,l.AF)(void 0,O.Z),n=(0,r.Fy)(),s=(0,r.O7)(),d=(0,l.VK)((()=>_.default.state.currentSpaceStore),[]),[c,u]=(0,o.useState)(!1),m=(0,l.VK)((()=>d?k.t1.createChildStore(d,{table:p.cZ,id:t,spaceId:d.id}):void 0),[t,d]),g=(0,l.VK)((()=>(0,Te.Mh)(null==m?void 0:m.getModel())),[m]),[{value:h}]=(0,Ie.r5)((async()=>{if(m){return await E.VG({environment:s,botId:null==m?void 0:m.id})}}),[s,m]);if(!m)return null;let f;return f=n.isMobile?{menuType:L.og.ActionSheet}:{menuType:L.og.Popup},a()(H.ZP,{popupType:n.isMobile?H.Z4.SlideUp:H.Z4.Popup,buttonPopupStore:i,renderOrigin:e=>o.createElement(U.Z,P()({isMobile:n.isMobile},e,{style:{marginLeft:8,marginRight:8}})),render:()=>o.createElement(o.Fragment,null,o.createElement(Y.Z,f,a()($.Z,{type:$.i.Vertical,sections:[{key:"integration options",render:e=>o.createElement(te.Z,e),items:[...xe({environment:s,botToken:h}),{key:"delete",action:()=>u(!0),render:e=>o.createElement(q.Z,P()({title:a()(w.FormattedMessage,{id:"spaceIntegrationSettings.actionMenu.disconnectIntegrationButton.label",defaultMessage:"Disconnect {integrationName}",values:{integrationName:g}}),style:{color:Z.ZP.red}},e))}]}],initialFocus:void 0})),a()(X.Z,{open:c,onDismiss:()=>{u(!1)},disableAnimation:!0,render:()=>a()("div",{style:{padding:20,width:333}},void 0,a()(ie.Z,{isMultiline:!0,style:{marginBottom:8,fontWeight:S.Z.fontWeight.semibold}},void 0,a()(w.FormattedMessage,{id:"spaceIntegrationSettings.actionMenu.removeIntegration.modal.label.title",defaultMessage:"Disconnect {integrationName} in workspace",values:{integrationName:g}})),a()(ie.Z,{isMultiline:!0,isSecondaryColor:!0,style:{marginBottom:8}},void 0,a()(w.FormattedMessage,{id:"spaceIntegrationSettings.actionMenu.removeIntegration.modal.label.caption",defaultMessage:"Revoke access for {integrationName} in workspace",values:{integrationName:g}})),a()("div",{style:{display:"flex",marginTop:12}},void 0,a()(J.Z,{style:{width:140,marginRight:9},isLarge:!0,onClick:()=>u(!1)},void 0,a()(ie.Z,{},void 0,a()(w.FormattedMessage,{id:"spaceIntegrationSettings.actionMenu.removeIntegrationApproval.modal.button.cancel",defaultMessage:"Cancel"}))),a()(J.Z,{style:{width:140},isLarge:!0,onClick:async()=>{u(!1),await E.P0({environment:s,botId:m.id,onSuccess:()=>{A.IN8(s,{type:"internal"})}})},backgroundColor:Z.ZP.red},void 0,a()(ie.Z,{style:{color:Z.ZP.white}},void 0,a()(w.FormattedMessage,{id:"spaceIntegrationSettings.actionMenu.disconnectIntegration..modal.button.disconnect",defaultMessage:"Disconnect"})))))}))})}function xe(e){const{botToken:t,environment:i}=e;return t?[{key:"copy bot token",action:()=>{Pe.RD({environment:i,stringValue:t,copiedMessage:Pe.tq.copiedLinkToClipboard}),A.IVn(i,{from:"integration-settings",table:p.cZ})},render:e=>o.createElement(q.Z,P()({title:a()(w.FormattedMessage,{id:"spaceIntegrationSettings.actionMenu.copyInternalIntegrationTokenButton.label",defaultMessage:"Copy internal integration token"})},e))}]:[]}var Fe=i(40235);const Ae={internal:a()(w.FormattedMessage,{id:"spaceIntegrationSettings.integrationTable.pillLabel.internal",defaultMessage:"INTERNAL"}),databaseSync:a()(w.FormattedMessage,{id:"spaceIntegrationSettings.integrationTable.pillLabel.sync",defaultMessage:"SYNC"}),linkPreview:a()(w.FormattedMessage,{id:"spaceIntegrationSettings.integrationTable.pillLabel.preview",defaultMessage:"LINK PREVIEW"}),importer:a()(w.FormattedMessage,{id:"spaceIntegrationSettings.integrationTable.pillLabel.importer",defaultMessage:"IMPORTER"})};function Ee(e){window.__c={n:"AdminIntegrationSettingsTable"};const{integrationIdToBotIds:t,internalIntegrationIds:i,integrationIdToUsers:n}=e,s=(0,l.VK)((()=>_.default.state.currentSpaceStore),[]),r=(0,d.Fg)(),c=(0,l.VK)((()=>null==s?void 0:s.getBotSettingsStore().getValue()),[s]),u=(0,l.VK)((()=>"approved_or_built_by_notion"===(null==c?void 0:c.integration_restrictions)),[c]),v=(0,l.VK)((()=>Boolean(null==c?void 0:c.integration_restrictions)),[c]),y=(0,l.VK)((()=>null!=c&&c.integration_approval_statuses?Object.keys(c.integration_approval_statuses):[]),[c]),S=y.filter((e=>!Object.keys(t).includes(e)&&!m.T2.includes(e))),b=S.some((e=>e===f.iK.google_drive.id)),M=(0,l.VK)((()=>null==s?void 0:s.id),[s]),C=t?Object.entries(t).map((e=>{let[t,i]=e;return De({integrationPointer:{table:g.K2,id:t},userStores:n[t],botIds:i,autoApproveBuiltByNotion:u})})):[],k=M?i.map((e=>De({integrationPointer:{table:p.cZ,id:e,spaceId:M},userStores:n[e],botIds:[e]}))):[],T=v?S.map((e=>De({integrationPointer:{table:g.K2,id:e},userStores:[],botIds:[],autoApproveBuiltByNotion:u}))):[],I=m.ns.filter((e=>!(0,h.CJ)(c)||y.includes(e.id)&&(e.id!==m._o||!b))).map((e=>function(e){const{legacyIntegration:t}=e,{id:i,name:n,info:o}=t;return{key:i,columns:[a()("div",{style:{display:"flex",alignItems:"center",maxWidth:300}},0,a()("img",{src:o.icon,style:{height:28}}),a()("div",{style:{minWidth:0,marginLeft:15}},void 0,a()("div",{style:{display:"flex"}},void 0,a()(ie.Z,{},void 0,n)),a()(ie.Z,{isSmall:!0,style:{display:"flex"}},void 0,a()(w.FormattedMessage,{id:"spaceIntegrationSettings.integrationTable.installerInfoColumn.legacy",defaultMessage:"Notion Connected App"})))),a()(We,{renderedUsers:void 0,displayUsers:!1},1),a()("div",{},2,a()(ae,{integrationId:i,isLegacy:!0,disableDisconnectAll:!0,disableDisconnectUser:!0}))]}}({botSettings:c,legacyIntegration:e}))),P=C.length+k.length+T.length+I.length;return o.createElement(o.Fragment,null,a()(Fe.Z,{columns:[{key:"integration",header:a()(w.FormattedMessage,{id:"spaceConnectionsSettings.connectionsTable.connectionsColumn.title",defaultMessage:"Connection"}),style:{width:"40%"}},{key:"added_by",header:a()(w.FormattedMessage,{id:"spaceConnectionsSettings.connectionsTable.creationInfoColumn.title",defaultMessage:"Users and access"})},{key:"more",header:void 0,style:{width:"5%"}}],rows:[...C,...k,...T,...I]}),0===P?a()("div",{style:{height:120,width:"100%",fontSize:12,color:r.lightTextColor,display:"flex",alignItems:"center",justifyContent:"center",borderBottom:`1px solid ${r.lightDividerColor}`}},void 0,a()(w.FormattedMessage,{id:"spaceIntegrationSettings.integrationTable.emptyTable.message",defaultMessage:"No integration installed"})):void 0)}function Be(e){window.__c={n:"AdminIntegrationComplianceSettingsTable"};const{botIdToWebhookSubscription:t}=e,i=(0,d.yK)((e=>({emptyTable:{height:120,width:"100%",fontSize:12,color:e.lightTextColor,display:"flex",alignItems:"center",justifyContent:"center",borderBottom:`1px solid ${e.lightDividerColor}`}})),[]),n=(0,l.VK)((()=>_.default.state.currentSpaceStore),[]),s=(0,l.VK)((()=>n?(0,M.m8)(Object.keys(t).map((e=>{var t;const i=k.Qx.createChildStore(n,{table:p.cZ,id:e,spaceId:n.id});return[i.id,null===(t=i.getIntegrationId())||void 0===t?void 0:t.toString()]}))):{}),[t,n]),r=Object.keys(t||[]).map((e=>{const i=s[e];if(i)return function(e){const{integrationPointer:t,botId:i,botIdToWebhookSubscription:n}=e,o=t.id,s=(0,v.oh)(o);if(!s)return;const r=v.$C[s];if(!r)return;const l=i?n[i]:void 0;return{key:`${o}:${i}`,columns:[a()(Re,{integrationTable:g.K2,integrationId:o},"integration-title"),a()(Ve,{webhookSubscription:l},"integration-installer"),a()(Ue,{webhookSubscription:l},"integration-installed-at"),a()(Se,{integrationId:r.id,webhookSubscription:l},"integration-menu")]}}({integrationPointer:{table:g.K2,id:i},botId:e,botIdToWebhookSubscription:t})})).filter(y.$K);return o.createElement(o.Fragment,null,a()(Fe.Z,{columns:[{key:"integration",header:a()(w.FormattedMessage,{id:"spaceConnectionsSettings.complianceConnectionsTable.connectionsColumn.title",defaultMessage:"Connection"}),style:{width:"40%"}},{key:"integration-installer",header:a()(w.FormattedMessage,{id:"spaceConnectionsSettings.complianceConnectionsTable.integrationInstallerColumn.title",defaultMessage:"Added by"}),style:{width:"20%"}},{key:"integration-installed-at",header:a()(w.FormattedMessage,{id:"spaceConnectionsSettings.complianceConnectionsTable.integrationDateAdded.title",defaultMessage:"Date added"})},{key:"more",header:void 0,style:{width:"5%"}}],rows:r,tableStyle:{borderTop:"none"}}),0===r.length?a()("div",{style:i.emptyTable},void 0,a()(w.FormattedMessage,{id:"spaceIntegrationSettings.integrationTable.emptyTable.message",defaultMessage:"No integration installed"})):void 0)}function De(e){const{integrationPointer:t,userStores:i,botIds:n,autoApproveBuiltByNotion:o}=e;if(t.table===g.K2){const e=t.id,s=(0,f.BP)({integrationId:e,env:"production"});return{key:e,columns:[a()(Re,{integrationTable:g.K2,integrationId:e},"integration-title"),a()(We,{renderedUsers:i,displayUsers:!s},"integration-installer-info"),a()(ae,{integrationId:e,integrationTable:g.K2,botIds:n,disableDisconnectUser:s||void 0,disableDisallow:s&&o},"admin-integration-settings-menu")]}}if(t.table===p.cZ)return{key:t.id,columns:[a()(Re,{integrationTable:p.cZ,integrationId:t.id},"integration-title"),a()(We,{renderedUsers:i,displayUsers:!1},"integration-installer-info"),a()(Ze,{botId:t.id},"integration-settings-menu")]};(0,y.t1)(t)}function Re(e){window.__c={n:"IntegrationTitle"};const{integrationId:t,integrationTable:i}=e,n=(0,l.VK)((()=>_.default.state.currentSpaceStore),[]),o=(0,l.VK)((()=>{if(n)return n.getRecordModel({table:i,id:t})}),[n,t,i]),[s,r,d,c]=(0,l.VK)((()=>{if(!o)return[];let e;const n=[];let s;if(i===p.cZ){const r=o;r.icon&&(e={pointer:{table:i,id:t},icon:r.icon}),n.push("internal"),s=a()(Le,{botId:r.id})}else if(i===g.K2){const r=o,l=r.getInfo();l.icon&&(e={pointer:{table:i,id:t},icon:l.icon}),(0,m.mo)(r)&&(n.push("linkPreview"),(0,m.zc)(r)&&n.push("databaseSync")),s=(0,v.DB)(r.id)?null:a()(Ne,{integrationId:r.id})}else(0,y.t1)(i);return[null==o?void 0:o.name,e,n,s]}),[i,t,o]);return o&&d?a()("div",{style:{display:"flex",alignItems:"center",maxWidth:300}},void 0,a()(we.Z,{disabled:!0,icon:r,title:s,isEmptyPage:!1,size:28,isLarge:!0,useInvertedColors:!0}),a()("div",{style:{minWidth:0,marginLeft:15}},void 0,a()("div",{style:{display:"flex",marginRight:16}},void 0,a()(ie.Z,{},void 0,s),d.map((e=>e&&a()(Me.Z,{desktopStyle:{marginLeft:4}},void 0,Ae[e])))),c)):a()(Q.Z,{})}const Le=e=>{let{botId:t}=e;window.__c={n:"InternalIntegrationDeveloperName"};const i=(0,l.VK)((()=>_.default.state.currentSpaceStore),[]),n=(0,w.useIntl)(),o=(0,l.VK)((()=>null==i?void 0:i.getRecordModel({table:p.cZ,id:t})),[i,t]),s=(0,l.VK)((()=>{if(i&&o){const e=i.getRecordModel({table:o.created_by_table,id:o.created_by_id});return(0,b.Nz)(n,e)}}),[i,o,n]);return s?a()(ie.Z,{className:"notranslate",isSmall:!0},void 0,s):a()(Oe,{})},Ne=e=>{let{integrationId:t}=e;window.__c={n:"PublicIntegrationDeveloperName"};const i=(0,l.VK)((()=>_.default.state.currentSpaceStore),[]),n=(0,d.Fg)(),s=(0,l.VK)((()=>{const e=null==i?void 0:i.getRecordModel({table:g.K2,id:t});return null==e?void 0:e.getInfo().developer_name}),[i,t]);return(0,f.BP)({integrationId:t,env:"production"})?a()(ie.Z,{isSmall:!0,style:{display:"flex",alignItems:"center"}},void 0,a()(w.FormattedMessage,{id:"spaceIntegrationSettings.integrationTable.installerInfoColumn.notion",defaultMessage:"Notion {icon}",values:{icon:a()(_e.Z,{renderTooltip:()=>a()("div",{},void 0,a()(w.FormattedMessage,{id:"spaceIntegrationSettings.integrationTable.installerInfo.notion.tooltip",defaultMessage:"Developed by Notion"})),placement:_e.Z.Placement.Right,render:e=>o.createElement("div",e,u.Z.integrationSecurity({width:12,height:12,fill:n.invoiceGreen}))})}})):s?a()(ie.Z,{className:"notranslate",isSmall:!0},void 0,s):a()(Oe,{})},Oe=()=>a()(ie.Z,{isSmall:!0},void 0,a()(w.FormattedMessage,{id:"spaceIntegrationSettings.integrationTable.label.unverifiedDeveloper",defaultMessage:"Unverified developer"}));function Ve(e){window.__c={n:"AdminComplianceInstaller"};const{webhookSubscription:t}=e,i=(0,w.useIntl)(),n=(0,l.VK)((()=>{const e=_.default.state.currentSpaceStore;if(!e)return;const i=t?{id:t.created_by_id,table:t.created_by_table}:void 0;return e&&i?T.U.createChildStore(e,i):void 0}),[t]),o=(0,l.VK)((()=>null==n?void 0:n.getDisplayName(i)),[n,i]);return n&&o?a()("div",{style:{display:"flex",flexDirection:"row",justifyContent:"flex-start",gap:8,alignItems:"center",width:"100%"}},void 0,a()(ke.Z,{userStore:n,size:18}),a()(ie.Z,{},void 0,o)):null}function Ue(e){const{webhookSubscription:t}=e;return t?a()(Ce.i,{useThinTitle:!0,title:(0,c.Yx)(Number(null==t?void 0:t.created_time),"medium_with_time",s.SP)}):null}function We(e){window.__c={n:"IntegrationInstallerInfo"};const{renderedUsers:t,displayUsers:i}=e,n=(0,l.VK)((()=>_.default.state.currentSpaceStore),[]),s=(0,w.useIntl)(),d=(0,r.O7)(),c=(0,l.VK)((()=>{if(n)return(0,C.rn)(d,n)}),[d,n]),u=(0,o.useMemo)((()=>t&&t.length),[t]),m=(0,l.VK)((()=>t&&t.length>0?t[0]:void 0),[t]),p=(0,l.VK)((()=>m?m.getDisplayName(s):void 0),[m,s]);return i&&void 0!==u?m?a()("div",{style:{display:"flex",alignItems:"center"}},void 0,a()(ke.Z,{userStore:m,avatarShouldShowShadow:!0,style:{marginRight:8},size:28}),a()(ie.Z,{},void 0,a()(w.FormattedMessage,{id:"spaceIntegrationSettings.integrationTable.installerInfoColumn.listOfUsers",defaultMessage:"{remainingCount, plural, =0 {{firstUser}} one {{firstUser} +{remainingCount}} other {{firstUser} +{remainingCount}}}",values:{firstUser:p,remainingCount:u-1}}))):a()(ie.Z,{isSecondaryColor:!0,style:{display:"flex",alignItems:"center"}},void 0,a()(w.FormattedMessage,{id:"spaceIntegrationSettings.integrationTable.installerInfoColumn.noUsers",defaultMessage:"No users"})):a()(ie.Z,{style:{display:"flex",alignItems:"center"}},void 0,a()(w.FormattedMessage,{id:"spaceIntegrationSettings.integrationTable.installerInfoColumn.anyone",defaultMessage:"Anyone in {spaceName}",values:{spaceName:a()(ie.Z,{style:{fontWeight:S.Z.fontWeight.medium}},void 0,c)}}))}},66309:(e,t,i)=>{i.r(t),i.d(t,{default:()=>M});var n=i(23174),a=i.n(n),o=(i(67294),i(480)),s=i(81954),r=i(24405),l=i(27328),d=i(24677),c=i(98104),u=i(95477),m=i(33665),p=i(34859),g=i(69454),h=i(36488),f=i(28451),v=i(53953),y=i(44532),S=i(18647),b=i(32662);function M(e){window.__c={n:"AnnouncementModal"};const t=(0,o.O7)(),i=(0,r.Fg)(),n=(0,o.Fy)(),M=(0,s.VK)((()=>(0,m.__)(t)),[t]),w=(0,s.VK)((()=>t.TabbedRouterStore),[t.TabbedRouterStore]),C=(0,s.VK)((()=>(0,l.w_)(w.state)),[w]);let _=e.shouldShow&&!u.default.isAdminMode;const k=(0,s.VK)((()=>t.WindowSizeStore.isLandscape()),[t.WindowSizeStore]),T=(0,s.VK)((()=>{const e=g.Z.state.phase===g.i.hidden||g.Z.state.phase===g.i.willHide;let i=g.Z.estimatedNativeWebBottomOverlap();return n.isMobileBrowser&&(i+=32),e?t.WindowSizeStore.getSafePaddingBottomPx(i):i}),[n.isMobileBrowser,t.WindowSizeStore]);if(n.isPhone){if(M){var I;const e="web"===C.type&&((null===(I=C.redirectedTo)||void 0===I?void 0:I.route)||C.route);_=e&&"page"===e.name}function n(){var i;null===(i=e.onModalShow)||void 0===i||i.call(e),d.ZH(t),c.sD()}return a()(f.g,{calloutId:e.calloutId,shouldShow:_,onShow:n},void 0,a()(y.ZP,{open:!0,forceFullScreenSlideUp:!0,hidesMobileNativeBottomBar:!0,preventBlockRenderQueueOnEnter:!0,popupType:y.ZP.PopupType.SlideUp,style:{background:i.sidebarBackground,borderRadius:0,width:"100%",height:"100%",...e.mobileInnerStyle},render:()=>a()(S.Z,{type:p.Z.Y,style:{width:k?"80%":"100%",height:"100%",display:"flex",flexDirection:"column",alignItems:"center"}},void 0,a()(b.Z,{size:k?200:0}),e.mobileRenderInner(),a()(b.Z,{size:T}))}))}return a()(f.g,{calloutId:e.calloutId,shouldShow:e.shouldShow,onShow:e.onModalShow},void 0,a()(v.Z,{open:!0,preventHideChildrenWhileOpening:!0,onDismiss:e.desktopOnDismiss,innerStyle:{background:i.sidebarBackground,borderRadius:12,...e.desktopInnerStyle},render:()=>a()(h.Z,{capture:!0,allowEsc:!0,render:e.desktopRenderInner})}))}},13702:(e,t,i)=>{i.r(t),i.d(t,{default:()=>fc});var n=i(23174),a=i.n(n),o=i(67294),s=i(480),r=i(81954),l=i(23537),d=i(77907),c=i(73008);function u(){window.__c={n:"MessageStoreDebugPanelWrapper"};return(0,r.VK)((()=>c.Z.state.open),[],{debugName:"MessageStoreDebugPanelWrapper.isOpen"})?a()(d.LazyMessageStoreDebugPanel,{}):null}var m=i(79315),p=i(19671),g=i(13023),h=i(41464),f=i(54564),v=i(10663),y=i(45094),S=i(24229),b=i(83355),M=i(41432),w=i(5366),C=i(78089),_=i(87279),k=i(65598),T=i(34859),I=i(6890),P=i(36488),Z=i(72897),x=i(3386),F=i(78140),A=i(40721),E=i(37064),B=i(66957);const D=[S.u.Open,S.u.Resolved];class R extends b.Z{constructor(){super(...arguments),this.deepDiscussionsStores=this.createComputedStore((()=>{const{discussionIds:e}=this.props,{blockStore:t,recursivelyLoadAllDiscussions:i}=this.props;return k.al(t,{recursivelyLoadAllDiscussions:i}).filter((t=>!e||e.includes(t.id)||(0,C.De)(t)))})),this.handleChangeTab=e=>{const t=S.Z.state;t.open&&S.Z.setState({...t,tab:D[e]})},this.handleBackspace=e=>{null==e||e.preventDefault(),f.LZ()}}renderComponent(){if((0,y.Sx)(this.environment))return null;const{device:e}=this.environment;let t;return t=e.isMobile?{menuType:_.og.Modal,title:a()(w.FormattedMessage,{defaultMessage:"Comments",id:"blockDiscussionMenu.mobileMenu.title"}),header:this.renderMenuHeader(),right:a()(A.DoneMenuText,{}),onClickRight:f.LZ,whiteBackground:!0}:{menuType:_.og.Popup,header:this.renderMenuHeader(),width:480,maxHeight:"50vh",onClickOutside:f.LZ},a()(Z.Z,{capture:!0,preventType:T.Z.All},void 0,a()(P.Z,{capture:!0,allowMobileAutoScroll:!0,render:()=>a()(x.Z,{capture:!0,onEsc:f.LZ,onBackspace:this.handleBackspace,onDelete:this.handleBackspace},void 0,a()(E.Z,{store:this.props.blockStore,droppable:!0,render:()=>o.createElement(F.Z,t,this.renderMenuContent())},this.props.blockStore.id))}))}renderMenuHeader(){const{device:e}=this.environment,{resolved:t,unresolved:i}=k.bB(this.deepDiscussionsStores.state),n=i.length,o=t.length;return 0===o||0===n?null:a()(B.Z,{tabs:[a()(w.FormattedMessage,{defaultMessage:"Open ({numberOfOpenDiscussions})",id:"blockDiscussionMenu.openDiscussionsTab.title",values:{numberOfOpenDiscussions:n}}),a()(w.FormattedMessage,{defaultMessage:"Resolved ({numberOfResolvedDiscussions})",id:"blockDiscussionMenu.resolvedDiscussionsTab.title",values:{numberOfResolvedDiscussions:o}})],selectedIndex:D.indexOf(this.props.tab),onChange:this.handleChangeTab,style:{...e.isAndroid&&{borderBottom:"none"}}})}renderMenuContent(){const{device:e}=this.environment,{resolved:t,unresolved:i}=k.bB(this.deepDiscussionsStores.state);if(this.props.tab===S.u.Open){if(i.length){const t=i.map(((e,t,i)=>a()(d.LazyDiscussion,{store:e,format:C.O2.Menu,isFirst:0===t,isOnly:1===i.length,discussionLocation:"block_menu",showResolveButtonByDefaultIfPossible:!0,blockStore:this.props.blockStore,onDismiss:f.LZ},e.id))),n=this.props.blockStore.getType(),s=n&&M.p2[n];if(e.isMobile&&s){const e=I.h(this.props.blockStore);return e?a()(o.Fragment,{},void 0,a()("div",{style:{padding:"12px 16px",boxShadow:`0 1px 0 ${this.theme.regularDividerColor}`,marginBottom:1}},void 0,a()(e,{store:this.props.blockStore,disabled:!0,hideContent:!0,style:{fontSize:14,pointerEvents:"none"},isQuickFind:!0})),t):t}return t}return this.renderEmptyState(a()(w.FormattedMessage,{defaultMessage:"No comments to show.",id:"blockDiscussionMenu.emptyState.noCommentsMessage"}))}return t.length?t.map(((e,t,i)=>a()(d.LazyDiscussion,{store:e,format:C.O2.Menu,isFirst:0===t,isOnly:1===i.length,discussionLocation:"block_menu",showResolveButtonByDefaultIfPossible:!0,blockStore:this.props.blockStore,onDismiss:f.LZ},e.id))):this.renderEmptyState(a()(w.FormattedMessage,{defaultMessage:"No resolved comments.",id:"blockDiscussionMenu.emptyState.noResolvedCommentsMessage"}))}renderEmptyState(e){const{device:t}=this.environment;return a()("div",{style:{textAlign:"center",padding:t.isMobile?"64px 18px":"32px 18px 36px",fontSize:14,color:this.theme.mediumTextColor}},void 0,e)}}R.displayName="BlockDiscussionMenu";const L=R;var N=i(44532);const O=function(){window.__c={n:"BlockDiscussionMenuPopup"};const e=(0,s.O7)(),{device:t}=e,i=(0,r.VK)((()=>S.Z.state.rect),[]),n=(0,r.VK)((()=>!(0,y.Sx)(e)&&S.Z.state.open&&!(0,v.az)(e,S.Z.state.blockStore)),[e]),l=(0,o.useCallback)((()=>{if(S.Z.state.open&&!(0,y.Sx)(e))return a()(L,{rect:S.Z.state.rect,tab:S.Z.state.tab,blockStore:S.Z.state.blockStore,discussionIds:S.Z.state.discussionIds,recursivelyLoadAllDiscussions:S.Z.state.recursivelyLoadAllDiscussions})}),[e]);return a()(N.ZP,{popupType:t.isMobile?N.ZP.PopupType.SlideUp:N.ZP.PopupType.Popup,open:n,originRect:i,placementToOrigin:N.ZP.Placement.Bottom,alignmentToOrigin:N.ZP.Alignment.Center,disableMouseCapture:!0,originGap:4,render:l,preventScaleTransition:!0,preventOpacityTransition:!0,onDismiss:f.LZ})};var V=i(96486),U=i.n(V),W=i(29369),K=i(50906),z=i(6404),G=i(75079),q=i(33665),H=i(35328),j=i(8949),Q=i(68216),Y=i(27724),$=i(13713),X=i(80209),J=i(48019),ee=i(68894),te=i(72495),ie=i(83182);class ne extends b.Z{constructor(){super(...arguments),this.renderOverlay=()=>{const{device:e}=this.environment,t=j.Z.state;if(!t.isActive)return;const{originBlockRect:i,actions:n,inputValue:s,publicEditMode:r}=t,l={environment:this.environment,blocks:t.stores,originRect:i,publicEditMode:r},d=t.showInput&&this.renderInputSection(),c=t.stores[0];let u;return u=e.isPhone?{menuType:_.og.Modal,title:a()(w.FormattedMessage,{defaultMessage:"Actions",id:"blockMenu.actionButton.label"}),right:a()(A.DoneMenuText,{}),onClickRight:this.handleOverlayBgClick,header:d}:{menuType:_.og.Popup,width:265,header:d},a()(x.Z,{capture:!0,onBackspace:U().identity},void 0,o.createElement(F.Z,u,a()(J.Z,{filter:s,context:l,sections:n,onAccept:this.handleAccept,initialFocus:s?0:void 0}),!s&&this.renderBlockAuthorInfo(),!s&&a()(X.Z,{store:c}),!s&&c.isCollectionView()&&this.renderCollectionHelpButton()))},this.handleOverlayBgClick=()=>{z.xv()},this.handleAccept=e=>{const t=j.Z.state;if(!t.isActive)return;const{stores:i}=Y.default.state,{analyticsFrom:n,collectionContextStore:a}=t,o=i[0];if(o){const t=o.getParentTable(),i=o.getType();if(i&&t){let s;if(t===W.e0){const e=o.getParentId(),{currentSpaceStore:t}=m.default.getState();t&&void 0!==e&&(s=Q.zX.createChildStore(t,{table:W.e0,id:e}))}const r=(0,G.Pn)(a)||{};K.dhV(this.environment,{analyticsName:e.analyticsName,from:n,block_id:o.id,block_type:i,parentTeamStore:s,is_toggleable:(0,H._A)(i,o.getFormat()),...r})}}e.closeParentMenu&&z.xv()},this.handleInputChange=e=>{j.Z.state.isActive&&j.Z.setState({...j.Z.state,inputValue:e.target.value})}}renderComponent(){const{device:e}=this.environment,t=j.Z.state;return a()(N.ZP,{popupType:e.isPhone?N.ZP.PopupType.SlideUp:N.ZP.PopupType.Popup,open:t.isActive,originRect:t.isActive?t.originBlockRect:void 0,onDismiss:this.handleOverlayBgClick,placementToOrigin:N.ZP.Placement.Bottom,alignmentToOrigin:N.ZP.Alignment.Start,originGap:0,preventScaleTransition:!0,render:this.renderOverlay,preventBlockRenderQueueOnEnter:e.isMobile})}renderBlockAuthorInfo(){const e=j.Z.state;if(this.environment.currentUser.isLoggedIn()&&e.isActive&&!(e.stores.length>1))return a()($.Z,{store:e.stores[0],isPageMoreButton:!1})}renderInputSection(){const{device:e}=this.environment,{intl:t}=this.props,i=j.Z.state;if(!i.isActive||e.isPhone)return;const{inputValue:n}=i;return a()(te.Z,{isInput:!0},void 0,a()(ee.ZP,{value:n,onChange:this.handleInputChange,focus:!0,focusAfterAnimation:!0,placeholder:t.formatMessage({defaultMessage:"Search actions…",id:"blockMenu.filterForActions.placeholder"}),preventCaptureDeleteWhenEmpty:!0}))}renderCollectionHelpButton(){return a()(te.Z,{topBorder:!0},void 0,a()(ie.Z,{title:a()(w.FormattedMessage,{defaultMessage:"Learn about databases",id:"blocks.blockMenu.collectionHelpButton"}),href:(0,q.UY)("guides.database"),analyticsFrom:"block_menu"}))}}ne.displayName="BlockMenu";const ae=(0,w.injectIntl)(ne);var oe=i(10434),se=i.n(oe),re=(i(57658),i(62965)),le=i(79554),de=i(43250),ce=i(33929),ue=i(61207),me=i(52275),pe=i(32163);const ge=(0,w.defineMessages)({createTransclusion:{defaultMessage:"Paste and sync",id:"blockPasteMenu.actions.createTransclusion.title"},linkToPage:{defaultMessage:"Link to page",id:"blockPasteMenu.actions.linkToPage.title"},dismissItem:{defaultMessage:"Dismiss",id:"blockPasteMenu.actions.dismiss.title"}});class he extends b.Z{constructor(){super(...arguments),this.renderMenu=()=>{const{device:e}=this.environment,t=ue.Z.state;if(!t.open)return;const i=this.getSections(t);let n;return n=e.isMobile?{menuType:_.og.ActionSheet}:{menuType:_.og.Popup,width:320,maxHeight:"40vh"},o.createElement(F.Z,se()({},n,{className:de.srZ}),a()(pe.Z,{type:pe.i.Vertical,sections:i,initialFocus:0}))},this.handleDismiss=()=>{le.xv()}}willMountOrUpdate(){const e=ue.Z.state;if(e.open){const{stores:t,phase:i}=Y.default.state;(0,re.Z)(t,e.blocks)&&i===Y.SelectionPhase.Selected||le.xv()}}renderComponent(){const{device:e}=this.environment,t=ue.Z.state;return a()(N.ZP,{popupType:e.isMobileNative&&!e.isTablet?N.ZP.PopupType.SlideUp:N.ZP.PopupType.Popup,open:t.open,originRect:t.open?t.rect:void 0,placementToOrigin:N.ZP.Placement.Bottom,alignmentToOrigin:N.ZP.Alignment.End,originGap:4,disableMouseCapture:!0,disableContentScroll:!0,disableDarkOverlayBackground:e.isMobile,keepFocus:e.isMobile,render:this.renderMenu,onDismiss:this.handleDismiss})}getSections(e){const{blocks:t}=e,i=[];if("blocks"===e.type){const{copiedStores:n,pageSource:a}=e;le.H8({blocks:t,copiedStores:n})&&i.push({name:ce.default.formatMessage(ge.createTransclusion),action:async()=>{await le.ry({environment:this.environment,blocks:t,copiedBlockIds:n.map((e=>e.id))})}}),le.wK({blocks:t})&&i.push({name:ce.default.formatMessage(ge.linkToPage),action:async()=>le.Dq({environment:this.environment,blocks:t,source:{type:"blocks",copiedStores:n,pageSource:a}})})}"links"===e.type&&i.push({name:ce.default.formatMessage(ge.linkToPage),action:async()=>le.Dq({environment:this.environment,blocks:t,source:{type:"links",copiedLinks:e.copiedLinks}})});return[{key:"embed section",render:e=>o.createElement(te.Z,e),items:[{key:"dismiss",render:e=>o.createElement(me.Z,se()({},e,{title:ce.default.formatMessage(ge.dismissItem)})),action:this.handleDismiss},...i.map((e=>{let{name:t,action:i}=e;return{key:`embed ${t}`,render:e=>o.createElement(me.Z,se()({},e,{title:t})),action:i}}))]}]}}he.displayName="BlockPasteMenu";const fe=he;var ve=i(87143),ye=i(74194),Se=i(64369);class be extends b.Z{constructor(){super(...arguments),this.handleOverlayBgClick=e=>{ve.Z.setState({...ve.Z.state,active:!1,stringValue:""})}}renderComponent(){const{device:e}=this.environment,{active:t,stringValue:i}=ve.Z.state,n=window.innerWidth/2-150,o=window.innerHeight/2,s=e.isMobileNative?a()(w.FormattedMessage,{defaultMessage:"Tap to copy the link above",id:"clipboardInputRenderer.copyLink.mobile_message"}):a()(w.FormattedMessage,{defaultMessage:"Right click and copy the link above",id:"clipboardInputRenderer.copyLink.message"});return a()(N.ZP,{popupType:e.isMobileNative?N.ZP.PopupType.SlideUp:N.ZP.PopupType.Popup,open:t,originRect:{top:o,left:n},onDismiss:this.handleOverlayBgClick,placementToOrigin:N.ZP.Placement.Bottom,alignmentToOrigin:N.ZP.Alignment.Start,originGap:0,render:()=>a()(x.Z,{capture:!0,onEnter:U().identity,onCommandEnter:U().identity,onCommandShiftEnter:U().identity,onCommandSlash:U().identity,onDelete:U().identity,onBackspace:U().identity,onEsc:U().identity,onLeft:U().identity,onRight:U().identity,onUntab:U().identity,onTab:U().identity,onSelectAll:U().identity,onRedo:U().identity,onUndo:U().identity,onToggleBold:U().identity,onToggleItalics:U().identity,onToggleStrike:U().identity,onToggleCode:U().identity,onCut:U().identity,onCopy:U().identity,onPaste:U().identity,onKeypress:U().identity},void 0,a()("div",{style:{padding:8,width:300}},void 0,a()(ye.Z,{style:{width:"100%",fontSize:12},value:i,focus:!0,textarea:!0,selectAll:!0,readOnly:!0}),a()(Se.Z,{isSmall:!0,style:{marginTop:6,pointerEvents:"none"}},void 0,s)))})}}be.displayName="ClipboardInputRenderer";const Me=be;var we=i(1302),Ce=i(24405),_e=i(99036),ke=i(80951),Te=i(23482),Ie=i(53397),Pe=i(21202),Ze=i(6287),xe=i(3791),Fe=i(70203),Ae=i(95371),Ee=i(97880),Be=i(82990),De=i(63143),Re=i(51365),Le=i(26797),Ne=i(77162),Oe=i(98834),Ve=i(64434),Ue=i(19785),We=i(4636),Ke=i(9953),ze=i(79978),Ge=i(12359),qe=i(66890),He=i(28020),je=i(49616),Qe=i(78316),Ye=i(99417),$e=i(17809),Xe=i(88804),Je=i(29987),et=i(79576),tt=i(69454),it=i(78291),nt=i(73420),at=i(56940),ot=i(91839),st=i(68785),rt=i(89728),lt=i(73935),dt=i(47307),ct=i(27153),ut=i(53471),mt=i(83279),pt=i(13401),gt=i(79131),ht=i(1743),ft=i(95538),vt=i(43593),yt=i(54604),St=i(5978),bt=i(95477),Mt=i(49085);class wt extends Mt.default{getInitialState(){return{open:!1}}}const Ct=wt;var _t=i(24736),kt=i(31945),Tt=i(81865);class It extends b.Z{constructor(){super(...arguments),this.storeTypes={filePropertyMenuItemStore:Ct},this.imageNode=void 0,this.renderRenameMenu=()=>{const{device:e}=this.environment,t=this.stores.filePropertyMenuItemStore.state;if(!t.open)return;let i;return i=e.isMobile?{menuType:_.og.ActionSheet}:{menuType:_.og.Popup,width:380},o.createElement(F.Z,i,a()("div",{style:this.getInputWrapStyle()},void 0,a()(ye.Z,{style:this.getInputStyle(),value:t.inputValue,placeholder:vt.w2(this.props.url),onChange:this.handleRenameInputChange,onSubmit:this.handleCloseRename,focusInitial:!0,selectAll:!0})))},this.handleFullScreen=()=>{yt.ui({environment:this.environment,renderFullScreenNode:()=>a()(Tt.Z,{url:this.props.url,isAuthenticated:!0,permissionRecord:this.props.store.pointer,width:300,render:(e,t)=>a()("img",{src:t,style:{position:"relative",maxHeight:"100%",maxWidth:"100%",margin:0,alignSelf:"center",width:"100%"}})}),fullScreenNodeRect:this.imageNode.getBoundingClientRect(),block:this.props.store,imageUrl:this.props.url})},this.handleRename=()=>{this.stores.filePropertyMenuItemStore.setState({open:!0,inputValue:this.props.name})},this.handleCloseRename=()=>{this.stores.filePropertyMenuItemStore.setState({open:!1})},this.handleRenameInputChange=e=>{const t=this.stores.filePropertyMenuItemStore.state;if(!t.open)return;const i=e.target.value;this.stores.filePropertyMenuItemStore.setState({...t,inputValue:i});const n=vt.rF({title:i,source:this.props.url});this.props.onChange({url:this.props.url,name:n})},this.handleViewOriginal=()=>{const{url:e,name:t}=this.props;St.openFileUrl(this.environment,{url:e,type:"file",from:"view_original",downloadName:t,permissionRecord:this.props.store.pointer})},this.handleDownload=()=>{const{url:e,name:t}=this.props;K.Uk(this.environment,{url:e,fileName:t,from:"FilePropertyMenuItem"}),St.downloadFileUrl(this.environment,{url:e,download:!0,downloadName:t,permissionRecord:this.props.store.pointer})},this.handleDelete=()=>{this.props.onDelete(this.props.url)}}renderComponent(){const{url:e}=this.props;return ft.SR({url:e})?this.renderImage(e):this.renderFile()}renderImage(e){const{device:t}=this.environment,{disabled:i}=this.props;return a()(me.Z,{focused:!1,showDragHandle:!i&&!t.isMobile,style:{paddingTop:t.isMobile?12:8,paddingBottom:t.isMobile?12:8,alignItems:"flex-start"},title:a()(Tt.Z,{url:e,isAuthenticated:!0,permissionRecord:this.props.store.pointer,width:300,render:(e,t)=>a()("div",{style:It.innerStyle},void 0,o.createElement("img",{src:t,style:It.imageStyle,onClick:this.handleFullScreen,ref:e=>this.imageNode=e}))}),right:this.renderActionMenu(!0),dontShrinkRight:!0})}renderFile(){const{device:e}=this.environment,{disabled:t}=this.props,{name:i}=this.props;return a()(N.GI,{open:this.stores.filePropertyMenuItemStore.state.open,popupType:e.isMobile?kt.Z4.SlideUp:kt.Z4.Popup,origin:a()(me.Z,{focused:!1,showDragHandle:!t&&!e.isMobile,onClick:this.handleViewOriginal,title:i,icon:a()("div",{style:{width:e.isMobile?16:14}},void 0,Ie.Z.file()),right:this.renderActionMenu(!1),dontShrinkRight:!0}),render:this.renderRenameMenu,onDismiss:this.handleCloseRename})}getActionMenuItems(e){const{device:t}=this.environment,{url:i,disabled:n}=this.props,s=[];return e&&s.push({key:"fullscreen",render:e=>o.createElement(me.Z,se()({},e,{title:a()(w.FormattedMessage,{defaultMessage:"Full screen",id:"database.actionMenu.fileProperty.fullscreen.title"})})),action:this.handleFullScreen}),(vt.E$(i,[bt.default.secureFileS3.url,bt.default.secureFileS3V2.url])||t.isNative)&&s.push({key:"download",render:e=>o.createElement(me.Z,se()({},e,{title:a()(w.FormattedMessage,{defaultMessage:"Download",id:"database.actionMenu.fileProperty.download.title"})})),action:this.handleDownload}),s.push({key:"original",render:e=>o.createElement(me.Z,se()({},e,{title:a()(w.FormattedMessage,{defaultMessage:"View original",id:"database.actionMenu.fileProperty.viewOriginal.title"})})),action:this.handleViewOriginal}),n||e||s.push({key:"rename",render:e=>o.createElement(me.Z,se()({},e,{title:a()(w.FormattedMessage,{defaultMessage:"Rename",id:"database.actionMenu.fileProperty.rename.title"})})),action:this.handleRename}),n||s.push({key:"delete",render:e=>o.createElement(me.Z,se()({},e,{title:a()(w.FormattedMessage,{defaultMessage:"Delete",id:"database.actionMenu.fileProperty.delete.title"})})),action:this.handleDelete}),s}renderActionMenu(e){const{device:t}=this.environment;return a()(kt.ZP,{popupType:t.isMobile?kt.Z4.SlideUp:kt.Z4.Popup,renderOrigin:e=>o.createElement(_t.Z,se()({isMobile:t.isMobile},e)),render:i=>{let n;return n=t.isMobile?{menuType:_.og.ActionSheet}:{menuType:_.og.Popup,width:200},o.createElement(F.Z,n,a()(pe.Z,{type:pe.i.Vertical,initialFocus:0,onAccept:i.close,sections:[{key:"section",render:e=>o.createElement(te.Z,e),items:this.getActionMenuItems(e)}]}))}})}getInputWrapStyle(){return{display:"flex",alignItems:"center",color:this.theme.regularTextColor,fontSize:"13px",padding:"4px 8px"}}getInputStyle(){return{display:"flex",alignItems:"center",flexGrow:1,fontSize:14,lineHeight:"20px",paddingTop:4,paddingBottom:4,paddingLeft:10,paddingRight:10,width:"100%",borderRadius:3,boxShadow:this.theme.inputBoxShadow,background:this.theme.inputBackground,cursor:"text",position:"relative"}}}It.displayName="FilePropertyMenuItem",It.imageStyle={display:"block",maxWidth:"100%",maxHeight:180,cursor:"zoom-in"},It.innerStyle={flex:"auto",overflow:"hidden"};const Pt=It;var Zt=i(28992),xt=i(32854);class Ft extends b.Z{renderComponent(){return a()(Zt.Z,{title:a()("div",{style:{display:"flex"}},void 0,a()(st.Z,{style:{marginTop:1,marginRight:6}}),a()(xt.Z,{percentage:this.props.progressPercent}))})}}Ft.displayName="ProgressMenuItem";const At=Ft;class Et extends b.Z{constructor(){super(...arguments),this.uploadingFiles=void 0,this.storeTypes={fileUploadStore:mt.Z},this.renderFile=e=>{const{device:t}=this.environment,{value:i,disabled:n}=this.props,o=i.find((t=>t.url===e));if(o){const e=o.url,i=o.name;return t.isMobile?a()(te.Z,{},e,a()(Pt,{store:this.props.store,name:i,url:e,onDelete:this.handleFileDelete,onChange:this.handleFileChange,disabled:n})):a()(Pt,{store:this.props.store,name:i,url:e,onDelete:this.handleFileDelete,onChange:this.handleFileChange,disabled:n},e)}},this.handleAddFileMount=e=>{e&&(this.addFileButton=e)},this.handleAddFileClick=e=>{this.showMediaPicker()},this.handleDraggableDrop=e=>{const{onChange:t,value:i}=this.props;t({value:U().sortBy(i,(t=>{const i=t.url;return i?e.indexOf(i):1/0}))})},this.handleMediaPickerUploadStart=e=>{ct.Z(),this.stores.fileUploadStore.setState({isLoading:!0,progressPercent:0}),this.uploadingFiles=[e]},this.handleMediaPickerUploadComplete=e=>{const{value:t,onChange:i}=this.props;if(!this.uploadingFiles)return;const n=this.uploadingFiles[0];if(!n)return;i({value:[...t,{name:n.name||e,url:e}]}),this.stores.fileUploadStore.reset(),ct.Z()},this.handleMediaPickerEmbedComplete=e=>{const{value:t,onChange:i}=this.props;i({value:[...t,{name:e,url:e}]}),this.stores.fileUploadStore.reset(),ct.Z()},this.handleUploadFilesStart=e=>{this.stores.fileUploadStore.setState({isLoading:!0,progressPercent:0}),this.uploadingFiles=e},this.handleUploadFilesComplete=e=>{const{value:t,onChange:i}=this.props;if(!this.uploadingFiles)return;i({value:[...this.uploadingFiles.map(((t,i)=>{const n=e[i];return{name:t.name||n,url:n}})),...t]}),this.stores.fileUploadStore.reset()},this.handleUploadProgress=e=>{const{progressPercent:t}=e;this.stores.fileUploadStore.setState({...this.stores.fileUploadStore.state,progressPercent:t})},this.handleUploadError=()=>{this.stores.fileUploadStore.reset(),dt.showErrorMessage(a()(w.FormattedMessage,{id:"filePropertyMenu.uploadFileFailedError.message",defaultMessage:"Upload failed."}))},this.handleFileChange=e=>{const{value:t,onChange:i}=this.props;i({value:t.map((t=>t.url===e.url?{name:e.name,url:e.url}:t))})},this.handleFileDelete=e=>{const{value:t,onChange:i}=this.props;i({value:t.filter((t=>t.url!==e))})}}didMount(){const{device:e}=this.environment,{uploadFiles:t,store:i}=this.props;t?ut.IL({environment:this.environment,files:t,bucket:"secure",record:i.pointer,onBatchStart:this.handleUploadFilesStart,onBatchProgress:this.handleUploadProgress,onBatchComplete:this.handleUploadFilesComplete,onBatchError:this.handleUploadError}):this.isEmpty()&&!e.isMobile&&this.showMediaPicker()}willUnmount(){ct.Z()}renderComponent(){const{device:e}=this.environment,{disabled:t}=this.props,i=this.isEmpty(),{isLoading:n,progressPercent:s}=this.stores.fileUploadStore.state;let r;return r=e.isMobile?{menuType:_.og.Modal,title:a()(w.FormattedMessage,{defaultMessage:"File property",id:"database.fileProperty.mobileMenu.title"}),right:a()(A.DoneMenuText,{}),onClickRight:this.props.onDismiss}:{menuType:_.og.Popup},a()(ht.Z,{capture:!0,allowUndo:!0,allowEsc:!0,allowTabUntab:!0},void 0,o.createElement(F.Z,r,this.renderFiles(),a()(te.Z,{topBorder:!i&&!t,desktopStyle:{...i&&{paddingTop:3,paddingBottom:3}}},void 0,n&&a()(At,{progressPercent:s}),!n&&!t&&o.createElement(pt.Z,{focused:!1,onClick:this.handleAddFileClick,title:a()(w.FormattedMessage,{id:"database.fileProperty.focusedLabel",defaultMessage:"Add a file or image"}),ref:this.handleAddFileMount}))))}renderFiles(){const{device:e}=this.environment,{value:t,disabled:i}=this.props,n=U().compact(t.map((e=>e.url)));return 0===n.length?void 0:e.isMobile||i?a()(o.Fragment,{},void 0,n.map(this.renderFile)):a()(te.Z,{},void 0,a()(gt.ZP,{direction:"vertical",keys:n,renderKey:this.renderFile,onDrop:this.handleDraggableDrop}))}isEmpty(){const{value:e}=this.props;return 0===e.length}showMediaPicker(){const{store:e}=this.props,t=lt.findDOMNode(this.addFileButton);if(!t)return;if(!(t instanceof Element))return;const i=ce.default.getIntl();ct.$(this.environment,{originRect:t.getBoundingClientRect(),originGap:3,isSmallWidth:!0,showArrow:!0,title:i.formatMessage({id:"filePropertyMenu.header",defaultMessage:"File"}),currentTab:"file",tabs:[{type:"file",fileUpload:!0,imageUpload:!1,videoUpload:!1,onUpload:t=>{ut.cT({environment:this.environment,file:t,bucket:"secure",record:e.pointer,onStart:this.handleMediaPickerUploadStart,onProgress:this.handleUploadProgress,onComplete:this.handleMediaPickerUploadComplete,onError:this.handleUploadError})}},{type:"embed",onChange:this.handleMediaPickerEmbedComplete}]})}}Et.displayName="FilePropertyMenu";const Bt=Et;var Dt=i(72589),Rt=i(37770),Lt=i(66897),Nt=i(19889),Ot=i(31299),Vt=i(28463),Ut=i(43765),Wt=i(77137),Kt=i(92864),zt=i(47082),Gt=i(97680);const qt=(0,w.defineMessages)({searchForPerson:{defaultMessage:"Search for a person…",id:"database.personPropertyValue.searchPlaceholder"}});class Ht extends b.Z{constructor(){super(...arguments),this.inputValue=Mt.default.createValue(""),this.handlePersonPropertyMenuChange=e=>{const{schema:t,property:i}=this.props,n=t[i];if(!n||"person"!==n.type)return;let a;a=1===n.limit?e.length>0?[e[e.length-1]]:[]:e,this.props.onChange({value:a}),this.inputValue.setState("")}}willMount(e){super.willMount(e),e.insertChar&&this.inputValue.setState(e.insertChar)}renderComponent(){const{device:e}=this.environment,{disabled:t,intl:i,schema:n,property:s}=this.props,r=n[s];if(!r||"person"!==r.type)return;const l=this.props.value.map((i=>{const n=(0,Lt.Hl)({pointer:i,getRecordValue:this.props.parentStore.getRecordValue});return a()(Kt.ZP,{actor:n,format:e.isMobile?Kt.ZP.Format.Large:Kt.ZP.Format.Medium,showRemoveButton:!t,onClickRemove:()=>{const e=this.props.value.filter((e=>e.id!==i.id));this.props.onChange({value:e})},shouldShrink:!0,isSingle:!1},i.id)})),d={request:{query:this.inputValue.state,actors:this.props.value},performRequest:async e=>{let{query:t,actors:i}=e;const{users:n}=await Ot.CO({environment:this.environment,query:t,membersOnly:!1});return{users:n.filter((e=>!i.some((t=>t.id===e.id)))).slice(0,20)}},render:(e,t,i)=>{if(e)return a()(te.Z,{title:(0,Vt.$)(r.limit),loading:!i},void 0,a()(Ut.Z,{title:a()(w.FormattedMessage,{defaultMessage:"Something went wrong.",id:"database.personPropertyMenu.searchErrorMessage"})}));if(t&&0===t.users.length)return a()(te.Z,{title:(0,Vt.$)(r.limit),loading:!i},void 0,a()(Ut.Z,{title:a()(w.FormattedMessage,{defaultMessage:"No results",id:"database.personPropertyMenu.noSearchResults.message"})}));const n=U().compact((t&&t.users||[]).map((e=>({key:e.id,render:t=>o.createElement(Gt.Z,se()({},t,{actor:(0,Lt.dp)(e)})),action:()=>{this.handlePersonPropertyMenuChange([...this.props.value,{table:Nt.KJ,id:e.id}])}})))),s=[];return n.length>0&&s.push({key:"person section",render:e=>o.createElement(te.Z,se()({},e,{title:(0,Vt.$)(r.limit),loading:!i})),items:n}),a()(pe.Z,{type:pe.i.Vertical,initialFocus:this.inputValue.state.length>0?0:void 0,sections:s})}},c=a()(zt.Z,{focus:!e.isMobile||void 0,focusAfterAnimation:!0,format:zt.Z.Format.Person,tokens:l,placeholder:i.formatMessage(qt.searchForPerson),hideInput:t,onRemoveLastToken:()=>{this.props.onChange({value:this.props.value.slice(0,this.props.value.length-1)})},value:this.inputValue.state,onChange:e=>this.inputValue.setState(e.target.value),dontShowBorderBottom:e.isAndroid});let u;return u=e.isMobile?{menuType:_.og.Modal,title:r.name,right:a()(A.DoneMenuText,{}),onClickRight:this.props.onDismiss,header:c}:{menuType:_.og.Popup,header:c,tokenInputHeader:!0,maxHeight:333},t?o.createElement(F.Z,u):o.createElement(F.Z,u,o.createElement(Wt.Z,d))}}Ht.displayName="PersonPropertyMenu";const jt=(0,w.injectIntl)(Ht);i(21703);var Qt=i(15145),Yt=i(43690),$t=i(1800),Xt=i(96449),Jt=i(65917),ei=i(42875),ti=i(2911),ii=i(4615),ni=i(74446),ai=i(5500),oi=i(54642),si=i(43132),ri=i(761),li=i(51456),di=i(93959),ci=i(70764),ui=i(70219),mi=i(86355),pi=i(10161),gi=i(30874);class hi extends Mt.default{getInitialState(){return{searchQuery:"",searchLimit:hi.limitIncrement,searchPopupOpen:!1,addingPage:!1}}}hi.limitIncrement=20,hi.incrementScrollOffset=200;const fi=hi;var vi=i(72087),yi=i(84076),Si=i(31278),bi=i(76798),Mi=i(46247),wi=i(86765);function Ci(e){window.__c={n:"RelationCreateNewRow"};const{targetCollectionStore:t,title:i,onClick:n,focused:l,isSection:d,index:c}=e,u=(0,r.VK)((()=>t.canEdit()),[t]),m=(0,r.VK)((()=>t.isSyncedCollection()),[t]),p=(0,s.Fy)(),g=(0,Ce.yK)((e=>({wrapper:{borderTop:`1px solid ${e.lightDividerColor}`,paddingTop:4,paddingBottom:4},icon:{width:16,fill:e.mediumIconColor,marginRight:4,marginLeft:-2},row:{fontSize:p.isMobile?16:14,minHeight:p.isMobile?44:32}})),[p]);if(!u)return null;const h=a()(me.Z,{focused:l,icon:Ie.Z.plus(g.icon),style:g.row,onClick:()=>n(c),title:a()(wi.Z,{targetCollectionStore:t,title:i})});return m?o.createElement(o.Fragment,null):d?a()(te.Z,{style:g.wrapper,disableDesktopPadding:!0,disableMobilePadding:!0},void 0,h):h}i(30541);var _i=i(60971),ki=i(14473),Ti=i(73744),Ii=i(45452),Pi=i(29798),Zi=i(17126),xi=i(8848),Fi=i(7057),Ai=i(53877),Ei=i(84795),Bi=i(59054),Di=i(20270),Ri=i(55384),Li=i(44805),Ni=i(44876),Oi=i(77719),Vi=i(6398),Ui=i(12534),Wi=i(98742),Ki=i(82484),zi=i(1634),Gi=i(71669),qi=i(58032);function Hi(){window.__c={n:"FigmaRelationPropertyMenuResults"};const e=(0,s.O7)(),t=function(){const e=(0,s.Fy)().isMobile;return(0,Ce.yK)((t=>({figmaResults:{display:"flex",flexDirection:"column",alignItems:"flex-start",fontSize:e?16:12,padding:16,paddingBottom:4},figmaResultsCopyWrapper:{marginTop:0,color:t.lightTextColor}})),[e])}();return e.device.isMobile?o.createElement(o.Fragment,null):o.createElement(o.Fragment,null,a()("div",{style:t.figmaResults},void 0,a()("p",{style:t.figmaResultsCopyWrapper},void 0,a()(w.FormattedMessage,{defaultMessage:"To link, paste the Figma File URL above",id:"connectedRelationPropertyMenuResults.figmaRelationUserEducationPasteUrl.description"}))))}var ji=i(90559),Qi=i(74882),Yi=i(16956),$i=i(49122),Xi=i(64921),Ji=i(61519),en=i(32662);const tn=(0,w.defineMessages)({githubCopyIdAria:{defaultMessage:"Copy the ID value.",id:"connectedRelationPropertyMenuResults.githubPrRelationUserEducation.copyIdAria"},githubAddIdAria:{defaultMessage:"Add a unique id property to the database.",id:"connectedRelationPropertyMenuResults.githubPrRelationUserEducation.addIdAria"},githubLearnMoreAria:{defaultMessage:"Learn more about the GitHub Pull Requests feature.",id:"connectedRelationPropertyMenuResults.githubPrRelationUserEducation.learnMoreAria"}});function nn(e){window.__c={n:"GithubRelationPropertyMenuResults"};const{pageBlockStore:t,blockPropertyValueOverlayStore:i}=e,n=(0,s.O7)(),l=(0,w.useIntl)(),d=an(),c=(0,qe.Y$)(),u=(0,r.VK)((()=>c.collectionStore()),[c]),m=(0,r.VK)((()=>c.databaseType),[c]),p=(0,r.VK)((()=>{var e;return u&&(null===(e=u.getRecordKeyStore())||void 0===e?void 0:e.getRecordKey())}),[u]),{uniqueIdPropertyId:g,uniqueIdValue:h}=(0,r.VK)((()=>{const e=t.getSchema(),i=(0,ji.$z)(e);if(1!==i.length)return{uniqueIdPropertyId:void 0,uniqueIdValue:void 0};const n=t.getPropertyValue(i[0]);return{uniqueIdPropertyId:i[0],uniqueIdValue:(0,ke.ah)(n)}}),[t]),f=(0,r.VK)((()=>(0,ji.wf)(p,h)),[p,h]),v=(0,r.VK)((()=>!Boolean(p)||!Boolean(h)),[p,h]);function y(){const e=an();return o.createElement(o.Fragment,null,a()("p",{style:e.githubResultsCopyWrapper},void 0,a()(w.FormattedMessage,{defaultMessage:"To link, paste the GitHub PR URL above",id:"connectedRelationPropertyMenuResults.githubPrRelationUserEducationPasteUrl.description"})),a()("div",{style:e.githubLinkPastingContainer},void 0,a()(Ji.Z,{size:1,style:e.githubLinkPastingSeparator}),a()("div",{style:e.githubLinkPastingSeparatorText},void 0,"or")),a()(en.Z,{size:8}))}return o.createElement(o.Fragment,null,a()("div",{style:d.githubResults},void 0,a()(y,{}),a()("p",{style:d.githubResultsCopyWrapper},void 0,a()(w.FormattedMessage,v?{defaultMessage:"Create a prefixed ID property to paste in the GitHub PR title.",id:"connectedRelationPropertyMenuResults.githubPrRelationUserEducation.badIdError"}:{defaultMessage:"Copy the {singleItemName} ID and paste it into the title of your PR in GitHub.",id:"connectedRelationPropertyMenuResults.githubPrRelationUserEducationLinkPastingOn.description",values:{singleItemName:(0,Te.hf)(m).defaultMessage}})),a()($i.Z,{width:"100%",uniqueIdPrefix:p,uniqueIdValue:h})),a()("div",{style:d.githubResultsButtonsWrapper},void 0,a()(Xi.Z,{style:d.githubResultsLearnMore,ariaLabel:l.formatMessage(tn.githubLearnMoreAria),onClick:e=>{e.preventDefault(),St.navigateToExternalURL({environment:n,url:(0,q.UY)("guides.githubRelation"),targetSelf:!1})}},void 0,Ie.Z.help({width:n.device.isMobile?16:12}),a()(en.Z,{size:4}),a()(w.FormattedMessage,{defaultMessage:"Learn more",id:"connectedRelationPropertyMenuResults.githubPrRelationUserEducation.learnMore"})),v?a()(Xi.Z,{style:d.githubResultsCTAButton,ariaLabel:l.formatMessage(tn.githubAddIdAria),onClick:async e=>{e.preventDefault(),u&&(await Qi.K({environment:n,collectionStore:u}),Ge.createAndCommit({userAction:"CollectionSettingsAutoIncrementIdPropertyCreateNewIdProperty",environment:n,perform:e=>{Yi.G3({environment:n,collectionStore:u,collectionViewArgs:void 0,propertyType:"auto_increment_id",transaction:e})}}),Ne._H({environment:n,collectionContextStore:c,from:"github_relation_menu",property_type:"auto_increment_id",integration_id:ai.U9}))}},void 0,Ie.Z.plus({width:n.device.isMobile?16:12}),a()(en.Z,{size:4}),a()(w.FormattedMessage,{defaultMessage:"Add ID property",id:"connectedRelationPropertyMenuResults.githubPrRelationUserEducation.addId"})):a()(Xi.Z,{style:d.githubResultsCTAButton,ariaLabel:l.formatMessage(tn.githubCopyIdAria),onClick:async e=>{e.preventDefault(),await si.RD({stringValue:f,environment:n,copiedMessage:si.tq.copiedPropertyToClipboard}),g&&Ne.S$(n,c,{block_id:t.id,property:g,property_type:"auto_increment_id",github_relation_menu:!0}),i.setState({isOpen:!1})}},void 0,Ie.Z.copy({width:n.device.isMobile?16:12}),a()(en.Z,{size:4}),a()(w.FormattedMessage,{defaultMessage:"Copy {singleItemName} ID",id:"connectedRelationPropertyMenuResults.githubPrRelationUserEducation.copyId",values:{singleItemName:(0,Te.hf)(m).defaultMessage}}))))}function an(){const e=(0,s.Fy)().isMobile;return(0,Ce.yK)((t=>({githubResults:{display:"flex",flexDirection:"column",alignItems:"flex-start",fontSize:e?16:12,padding:16,paddingBottom:4},githubResultsCopyWrapper:{marginTop:0,color:t.lightTextColor},githubResultsErrorWrapper:{marginTop:0,color:xi.ZP.red},githubResultsButtonsWrapper:{width:"100%",display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between",fontSize:e?16:12,padding:"10px"},githubResultsLearnMore:{display:"flex",flexDirection:"row",alignItems:"center",padding:4,borderRadius:5,color:t.lightTextColor},githubResultsCTAButton:{display:"flex",flexDirection:"row",alignItems:"center",padding:4,borderRadius:5,color:t.blueColor},githubLinkPastingSeparator:{border:t.tableDividerColor,width:"100%"},githubLinkPastingContainer:{width:"100%",position:"relative",display:"flex",justifyContent:"center",alignItems:"center",margin:"8px 0px"},githubLinkPastingSeparatorText:{position:"absolute",backgroundColor:t.popoverBackground,color:t.lightTextColor,padding:"0px 8px"}})),[e])}var on=i(28415);function sn(e){window.__c={n:"GoogleDriveRelationPropertyMenuResults"};const t=(0,s.O7)(),i=function(){const e=(0,s.Fy)().isMobile;return(0,Ce.yK)((t=>({googleDriveResults:{display:"flex",flexDirection:"column",alignItems:"flex-start",fontSize:e?16:12,padding:16,paddingBottom:4,paddingTop:4},googleDriveResultsCopyWrapper:{marginTop:0,color:t.lightTextColor,marginBottom:0},googleDriveResultsLearnMore:{display:"flex",flexDirection:"row",alignItems:"center",padding:4,borderRadius:5},googleDriveResultsAccount:{fontSize:12,margin:0},googleDriveLinkPastingSeparator:{border:t.tableDividerColor,width:"100%"},googleDriveLinkPastingContainer:{width:"100%",position:"relative",display:"flex",justifyContent:"center",alignItems:"center",margin:"8px 0px"},googleDriveLinkPastingSeparatorText:{position:"absolute",backgroundColor:t.cardContentBackground,color:t.lightTextColor,padding:"0px 8px"}})),[e])}(),n=(0,r.VK)((()=>gi.Z.externalAuthentications.state.filter((e=>{let{integration_id:t}=e;return t===ai.f3}))),[]);return t.device.isMobile?o.createElement(o.Fragment,null):o.createElement(o.Fragment,null,a()("div",{style:i.googleDriveResults},void 0,a()("p",{style:i.googleDriveResultsCopyWrapper},void 0,a()(w.FormattedMessage,{defaultMessage:"To link, paste the Google Drive File URL above",id:"connectedRelationPropertyMenuResults.googleDriveRelationUserEducationPasteUrl.description"})),a()("div",{style:i.googleDriveLinkPastingContainer},void 0,a()(Ji.Z,{size:1,style:i.googleDriveLinkPastingSeparator}),a()("div",{style:i.googleDriveLinkPastingSeparatorText},void 0,"or")),a()(en.Z,{size:2}),a()("p",{style:i.googleDriveResultsCopyWrapper},void 0,a()(w.FormattedMessage,{defaultMessage:"Select an account below to browse files on your Google Drive",id:"connectedRelationPropertyMenuResults.googleDriveRelationUserEducationSourcePicker.description"})),a()(en.Z,{size:2}),n.map(((n,o)=>a()(Xi.Z,{style:i.googleDriveResultsLearnMore,onClick:async i=>{i.preventDefault(),await(async(i,n)=>{const a=await ri.jh({environment:t,externalAuthenticationValue:n}),o=gi.Z.integrations.state.find((e=>e.id===n.integration_id));if(!o)return;const{id:s,name:r,info:l}=o,{icon:d,dark_icon:c,accent_color:u,accent_icon:m}=l,p="dark"===t.ThemeStore.state.mode&&c?c:d;p&&u&&m&&a&&"failed"!==a.type&&await(0,on.vE)({environment:t,accessToken:a.data.access_token,callback:(t,n)=>{e.onFileSelect(i,n)},integration:{id:s,name:r,icon:p,accentColor:u,accentIcon:m},from:"connected_relation_property_value"})})(i,n)}},o,a()("p",{style:i.googleDriveResultsAccount},void 0,a()(w.FormattedMessage,{defaultMessage:"{account}",id:"connectedRelationPropertyMenuResults.googleDriveRelation.googleDriveAccount.description",values:{account:n.account_name}})))))))}function rn(e){var t;window.__c={n:"ConnectedRelationPropertyMenuResults"};const{sections:i,collectionStore:n,targetCollectionStore:l,search:d,property:c,propertySchema:u,pageRecordStore:p,blockPropertyValueOverlayStore:g}=e,h=(0,Ce.yK)((e=>({settingsMenu:{display:"flex",flexGrow:1,flexDirection:"column",padding:"8px 16px 16px 8px"},settingsMenuSearchBox:{background:e.contentBackground,marginBottom:10},addPageButton:{width:"100%",display:"flex",justifyContent:"center"},suggestionBox:{display:"flex",alignItems:"center",fontSize:12,color:xi.ZP.white,background:xi.ZP.blue,borderRadius:6,padding:10,boxShadow:e.largeLightBoxShadow,alignSelf:"center",maxWidth:"80%"},errorMessage:{alignSelf:"center",padding:10,fontSize:14,color:e.errorText},addingPage:{width:"100%",padding:10,display:"flex",justifyContent:"flex-start",fontSize:14,color:e.mediumTextColor}})),[]),f=ke.Kp(u),v=ke.gg(u),y=ke.ic(u),S=(0,r.VK)((()=>{if(!l)return;const e=l.getFormat().integration_id;return gi.Z.integrations.state.find((t=>t.id===e))}),[l]),b=(0,r.VK)((()=>S?(0,ci.NP)(S.id):[]),[S]),M=(0,s.O7)(),C=(0,w.useIntl)(),_=(0,Ce.Fg)(),T=(0,r.VK)((()=>{const e=gi.Z.state;return e.loaded?e.integrations:[]}),[]),I=(0,r.VK)((()=>{var e;return Boolean(null===(e=m.default.state.currentSpaceStore)||void 0===e?void 0:e.canAdmin())}),[]),P=(0,r.VK)((()=>{var e;return!(!(null===(e=m.default.state.currentSpaceStore)||void 0===e?void 0:e.canEdit())||!(0,ci.sw)(M))}),[M]),Z=(0,r.VK)((()=>{const e=gi.Z.state;return e.loaded&&S?e.externalAuthentications.filter((e=>e.integration_id===S.id)):[]}),[S]),x=(0,r.VK)((()=>Z.length?Z[0]:null),[Z]),[{value:F,status:A}]=(0,Bi.r5)((async()=>{if(!x||!S||"google_calendar"!==(0,ai.s9)(S.id))return;const e=x.parent_id;return oi.listExternalObjects(M,{bot_id:e,query:d})}),[M,x,d,S],{debounce:1e3}),E=(0,r.VK)((()=>l.getFormat().pattern_name),[l]),B=(0,r.VK)((()=>{if(S&&d)return ln({integration:S,patternName:E,url:d})}),[E,S,d]),D=(0,k.NZ)(p)?p:void 0,R=(0,k.NZ)(p)?p.getPropertyStore(c):void 0,L=(0,r.VK)((()=>null==l?void 0:l.getIcon()),[l]),N=(0,r.VK)((()=>{var e;return null===(e=m.default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]),O=(0,r.VK)((()=>Ki.Z.state),[]),V={key:"githubPrRelationUserEducation",render:e=>void 0!==D&&a()(nn,{pageBlockStore:D,blockPropertyValueOverlayStore:g}),items:[]},W={key:"googleDriveRelation",render:t=>a()(sn,{onFileSelect:(t,i)=>{(0,Ui.ZP)({context:Ui.Af.ButtonMouseDown,callback:()=>{e.addPage(i)},event:t})}}),items:[]},K={key:"figmaRelation",render:e=>a()(Hi,{}),items:[]};if(!n||!R||!S)return a()(pe.Z,{type:pe.i.Vertical,style:{padding:"4px 0px"},initialFocus:0,sections:i});if(!((null==S?void 0:S.id)===ai.U9?null===(t=b[0])||void 0===t?void 0:t.id:null==x?void 0:x.parent_id)){const e=function(e){const{collectionIcon:t,integration:i,environment:n,spaceId:s,isAdmin:r,userAllowedToAuth:l}=e,d=i.id===ai.U9,c=()=>{s&&(Oi.hM({environment:n,integration:i,spaceId:s,from:"connected_relation_property_menu"}),zi.Z.reset())};if([ai.f3,ai.mQ].includes(e.integration.id)&&e.environment.device.isMobile)return{key:"authenticateIntegrationgoogledrive",render:e=>o.createElement(te.Z,se()({},e,{disableMobilePadding:!0,title:a()("div",{style:{whiteSpace:"normal",paddingTop:8}},void 0,a()(w.FormattedMessage,{defaultMessage:"Please authorize this integration in the browser or a desktop app.",id:"connectedRelationProperty.mobile.guide.title"}))})),items:[]};return{key:"authenticateIntegration",render:e=>o.createElement(te.Z,se()({},e,{disableMobilePadding:!0,title:a()(w.FormattedMessage,{defaultMessage:"Connect to {integration}",id:"connectedRelationPropertyMenuResults.authenticateHeader.title",values:{integration:i.name}})})),items:[!d||r&&l?{key:"authenticateButton",render:e=>o.createElement(me.Z,se()({},e,{title:a()(w.FormattedMessage,{defaultMessage:"Connect to {integration}",id:"connectedRelationPropertyMenuResults.authenticateButton.title",values:{integration:i.name}}),icon:a()(Gi.Z,{src:null==t?void 0:t.icon,style:{width:14}})})),action:()=>c()}:{key:"askAdminToAuthenticateButton",render:e=>o.createElement(me.Z,se()({},e,{title:a()("div",{style:{whiteSpace:"normal"}},void 0,a()(w.FormattedMessage,{defaultMessage:"Ask your workspace admin to configure the GitHub (Workspace) connection.",id:"connectedRelationPropertyMenuResults.askAdminToAuthenticateButton.title"})),icon:a()(Gi.Z,{src:null==t?void 0:t.icon,style:{width:14}}),hoveredStyle:{cursor:"default",background:void 0},pressedStyle:{background:void 0}})),action:()=>{}}]}}({environment:M,collectionStore:n,integration:S,collectionIcon:L,spaceId:N,isAdmin:I,userAllowedToAuth:P});return a()(pe.Z,{type:pe.i.Vertical,style:{padding:"4px 0px"},initialFocus:0,sections:[...i,e]})}const z=("success"===(null==F?void 0:F.type)&&"data"in F.data?F.data.data:[]).map((e=>{const t=e.attributes.flatMap((e=>{const t=(0,Ni.GY)(e);return(0,Di.nj)(t)?[t]:(console.error(t),[])})),i=(0,De.m8)(t.flatMap((e=>[[e.id,e]])));return{uri:e.uri,attributes:t,attributesById:i}}));function G(){let e=a()(w.FormattedMessage,{id:"connectedRelationPropertyMenuResults.addPageButton.label",defaultMessage:"Link Page"});return(null==S?void 0:S.id)===ai.f3||(null==S?void 0:S.id)===ai.mQ?e=a()(w.FormattedMessage,{id:"connectedRelationPropertyMenuResults.addFileButton.label",defaultMessage:"Link File"}):(null==S?void 0:S.id)===ai.Nw?e=a()(w.FormattedMessage,{id:"connectedRelationPropertyMenuResults.addTicketButton.label",defaultMessage:"Link Ticket"}):(null==S?void 0:S.id)===ai.U9&&(e=a()(w.FormattedMessage,{id:"connectedRelationPropertyMenuResults.addPRButton.label",defaultMessage:"Link PR"})),e}const q={key:"thirdPartySearchResults",render:e=>o.createElement(te.Z,se()({},e,{disableMobilePadding:!0})),items:[{key:"addPage",render:e=>o.createElement(me.Z,se()({},e,{title:G(),icon:Ie.Z.plusThick({width:14})})),action:t=>{(0,Ui.ZP)({event:t,context:Ui.Af.ButtonMouseDown,callback:()=>{e.addPage()}})}}]},H={key:"noResultsFoundInThirdParty",render:e=>o.createElement(te.Z,se()({},e,{disableMobilePadding:!0,title:a()(w.FormattedMessage,{defaultMessage:"No results found in {integration}.",id:"connectedRelationPropertyMenuResults.notMatched.help",values:{integration:S.name}})})),items:[]},j=[];S&&"google_calendar"===(0,ai.s9)(S.id)&&j.push(...function(e){const{environment:t,intl:i,theme:n,externalIntegrations:s,emojiData:r}=e,l=e.results.flatMap((e=>{const t=e.attributesById.start;if(t&&(0,Ni.Gc)(t)){const n=(0,Ai.NK)(t.values[0],(0,ei.r)(),i.locale);return[{...e,dateTime:n.start}]}return[]})),d=U().groupBy(l,(e=>e.dateTime.toFormat(Ai.Iq))),c=U().sortBy(Object.keys(d),(e=>Zi.ou.fromFormat(e,Ai.Iq).valueOf()));return c.flatMap((l=>{const c=d[l],u=U().sortBy(c,(e=>e.dateTime.valueOf())),m=(0,Ei.parseDateTimeRangeString)(l);if(!m)return[];let p;(U().isEqual(m,(0,Ai.Lg)((0,ei.r)()))||U().isEqual(m,(0,Ai.Ro)((0,ei.r)())))&&(p="relative");const g=(0,Fi.ZV)({value:m,intl:i,allowRelativeDates:Boolean(p),date_format:p});return[{key:g,items:u.flatMap((l=>{const d=new Q.G(t,{table:Pe.iU,id:(0,ii.ZP)(),spaceId:(0,ii.ZP)()}),c={id:d.id,type:"external_object_instance",alive:!0,format:{bot_id:"",external_object_id:"",uri:l.uri,attributes:l.attributes},version:0,space_id:"",parent_id:"",parent_table:"block"};let u=null,m=null;const p=l.attributesById.title,g=l.attributesById.start,h=l.attributesById.end;return g&&h&&(0,Ni.Gc)(g)&&(0,Ni.Gc)(h)&&(u=a()("div",{},void 0,a()("span",{},void 0,a()(Vi.r4,{style:{color:void 0,display:"inline"},attribute:g,dateStyle:"exact_time",intl:i})," - ",a()(Vi.r4,{attribute:h,dateStyle:"exact_time",style:{color:void 0,display:"inline"},intl:i}))),m=a()("div",{},void 0,a()("span",{},void 0,a()(Vi.ox,{style:{color:void 0,display:"inline"},store:d,attribute:p})),u)),{key:l.uri,render:e=>a()(qi.Z,{renderTooltip:()=>m,placement:qi.Z.Placement.Left,textWrap:!0,render:a=>o.createElement(me.Z,se()({},(0,Wi.Z)(a||{},e),{title:(0,Li.dD)({blockModel:Ri.kk.fromBlock(c),intl:i,index:0,style:{},disableHover:!0,disableLinks:!0,isAndroid:!1,theme:n,baseUrl:bt.default.domainBaseUrl,emojiType:"raw",currentUserId:t.currentUser.id,getRecordModel:d.getRecordModel,externalIntegrations:s,emojiData:r}),caption:u}))}),action:t=>{(0,Ui.ZP)({event:t.event,context:Ui.Af.ButtonMouseDown,callback:()=>{e.addPage(l.uri)}})}}})),render:e=>o.createElement(te.Z,se()({},e,{disableMobilePadding:!0,title:g}))}]}))}({environment:M,intl:C,theme:_,externalIntegrations:T,results:z,addPage:e.addPage,emojiData:O}));const Y={key:"loadingSpinner",render:t=>o.createElement(te.Z,se()({},t,{disableMobilePadding:!0,title:a()("div",{style:{...h.addingPage,justifyContent:e.addingPage?"center":"flex-start"}},void 0,a()(st.Z,{}),a()("span",{style:{marginLeft:10}},void 0,a()(w.FormattedMessage,{id:"connectedRelationPropertyMenuResults.fetchingData",defaultMessage:"Fetching data..."})))})),items:[]},$=[];return"pending"===A||e.addingPage?$.push(Y):B?$.push(q):j.length>0?$.push(...j):v?$.push(W):y?$.push(K):f&&0===i.length?$.push(V):f&&i.length>0||$.push(H),a()(pe.Z,{type:pe.i.Vertical,style:{padding:"4px 0px"},initialFocus:0,sections:[...i,...$]})}const ln=e=>{var t;if(e.patternName)return null===(t=e.integration.info)||void 0===t||null===(t=t.original_url_patterns)||void 0===t?void 0:t.filter((t=>{var i;return t.name===e.patternName&&(null===(i=t.additional_types)||void 0===i?void 0:i.connectedRelation)})).find((t=>{let{regex:i}=t;return new RegExp(i).test(e.url)}))};var dn=i(18647),cn=i(43145),un=i(68139);function mn(e){window.__c={n:"RelationMoveToBacklog"};const{targetCollectionStore:t,onClick:i,focused:n,isSection:l,index:d,onMouseEnter:c,blockPropertyValueOverlayStore:u}=e,m=(0,r.VK)((()=>t.canEdit()),[t]),p=(0,r.VK)((()=>t.isSyncedCollection()),[t]),g=(0,s.Fy)(),h=(0,Ce.yK)((e=>({medium:{fontWeight:Be.Z.fontWeight.medium},wrapper:{borderTop:`1px solid ${e.lightDividerColor}`},icon:{width:14,fill:"#A6A299",marginRight:-2,marginLeft:0},row:{fontSize:g.isMobile?16:14,minHeight:g.isMobile?44:32}})),[g]),f=a()(me.Z,{focused:n,onMouseEnter:c,icon:Ie.Z.collectionInbox(h.icon),style:h.row,onClick:(0,o.useCallback)((()=>{i(d),u.setState({isOpen:!1})}),[d,i,u]),title:a()(w.FormattedMessage,{id:"database.searchRelation.MoveToBacklogFooter",defaultMessage:"<medium>Move to backlog</medium>",values:{medium:e=>a()("span",{style:h.medium},void 0,e)}})}),v=l?a()(te.Z,{style:h.wrapper,disableDesktopPadding:!0,disableMobilePadding:!0},void 0,f):f;return m?p?null:v:null}var pn=i(75203);class gn extends b.Z{constructor(){super(...arguments),this.storeTypes={menuListStore:Pi.Z,draggableListStore:Ii.Z},this.handleDraggableListDrop=(e,t)=>{const{onDrag:i}=this.props,{menuListStore:n}=this.stores;i&&i(e),_i.sv({store:n,focus:{section:0,indexLocal:t.endPosition,indexGlobal:t.endPosition}})},this.hasLimit=()=>{const{property:e,schema:t}=this.props,i=t[e];return Boolean(i&&"relation"===i.type&&1===i.limit)}}didUpdate(e){const{menuListStore:t}=this.stores,{device:i}=this.environment;!this.props.searchQuery||U().isEqual(e.searchQuery,this.props.searchQuery)||i.isMobile||t.setState({...t.state,focus:{section:0,indexLocal:0,indexGlobal:0}})}renderComponent(){const{device:e}=this.environment;return e.isMobile?this.renderMobileResults():this.renderDesktopResults()}renderDesktopResults(){const{results:e,loading:t,onScrollOffsetChange:i}=this.props,n=0===e.length;return a()(o.Fragment,{},void 0,a()(dn.Z,{style:{width:"100%",maxHeight:300,position:"relative",...n&&{marginTop:0}},type:T.Z.Y},void 0,this.renderRowsMenuList(e),t&&a()(hn,{}),i&&a()(cn.Z,{onChange:i})))}renderMobileResults(){const{results:e,loading:t,resultsType:i}=this.props,n=0===e.length,s=this.props.schema[this.props.property];return Boolean("relation"===(null==s?void 0:s.type)&&s.connectedRelation)&&n?a()("div",{style:{marginTop:20}},void 0,a()(rn,{blockPropertyValueOverlayStore:this.props.blockPropertyValueOverlayStore,collectionStore:this.props.collectionStore,targetCollectionStore:this.props.targetCollectionStore,sections:[],propertySchema:s,property:this.props.property,pageRecordStore:this.props.parentStore,search:this.props.searchQuery,relationPropertyMenuStore:this.props.relationPropertyMenuStore,addPage:this.props.addPage,addingPage:this.props.addingPage})):a()(o.Fragment,{},void 0,n&&!t&&"existing"===i?void 0:this.renderRowsMenuList(e),t&&a()(hn,{}))}renderRowsMenuList(e){const{parentStore:t,collectionStore:i,targetCollectionStore:n,property:s,canDrag:r,canConfigureCollection:l,loading:d,onCreatePage:c,handleClearProperty:u,overlayMode:m,disabled:p}=this.props,{device:g}=this.environment,h=this.props.schema[s],f=Boolean("relation"===(null==h?void 0:h.type)&&h.connectedRelation),v=n.getFormat().integration_id,y=e=>{let t=a()(w.FormattedMessage,{id:"database.relationProperty.relatedPages.subHeader",defaultMessage:"{count, plural, one {{count} linked page} other {{count} linked pages}}",values:{count:e}});return v&&([ai.f3,ai.mQ].includes(v)?t=a()(w.FormattedMessage,{id:"database.relationProperty.relatedGoogleDriveOrFigmaFiles.subHeader",defaultMessage:"{count, plural, one {{count} linked file} other {{count} linked files}}",values:{count:e}}):v===ai.U9&&(t=a()(w.FormattedMessage,{id:"database.relationProperty.relatedGithubPages.subHeader",defaultMessage:"{count, plural, one {{count} linked PR} other {{count} linked PRs}}",values:{count:e}}))),t},S=n.getFormatStore().getKeyStore("app_config_uri").getValue()===Te.p$&&(0,di.wY)(),b=[],M=[],C=e.filter((e=>e.type===mi.Rt.SelectedPage)).length;e.map((e=>{if(e.type===mi.Rt.SearchPage){Q.G.createChildStore(t,e.pointer).isTemplate()||M.push(this.renderRowMenuItem(e,C))}else e.type===mi.Rt.SelectedPage&&b.push(this.renderRowMenuItem(e,C))}));const _=[];if(b.length>0){const e=b.map((e=>e.key.toString()));_.push({key:"results",render:t=>o.createElement(fn,se()({},t,{title:S?void 0:this.hasLimit()?a()(w.FormattedMessage,{id:"database.relationProperty.relatedPages.limit.subHeader",defaultMessage:"Linked page"}):y(b.length),collectionStore:i,targetCollectionStore:n,property:s,showRight:"add"!==(null==m?void 0:m.type),disabled:!l,style:{paddingBottom:S?0:4}}),r&&!this.hasLimit()&&e.length>1?a()(gt.ZP,{direction:"vertical",keys:e,renderKey:i=>t.children[e.indexOf(i)],onDrop:this.handleDraggableListDrop,store:this.stores.draggableListStore}):t.children),items:b})}if(!f&&(0===M.length&&0===b.length||M.length>0)){const e=S||d?void 0:M.length>0?b.length>0?a()(w.FormattedMessage,{id:"database.relationProperty.unrelatedPages.anotherPage.subHeader",defaultMessage:"Link another page"}):a()(w.FormattedMessage,{id:"database.relationProperty.unrelatedPages.subHeader",defaultMessage:"Link a page"}):a()(w.FormattedMessage,{id:"database.relationProperty.noResults.subHeader",defaultMessage:"No results"});let t;d||0!==M.length||g.isMobile||f||!this.props.searchQuery||!(S&&M.length<1)&&S||(M.push({key:"empty",render:e=>a()(Ci,{targetCollectionStore:n,title:this.props.searchQuery||"",focused:e.focused,onClick:c,isSection:!1,index:this.props.index}),action:()=>{c&&c()}}),t={paddingBottom:0}),S&&(t={paddingBottom:0});const r={key:"unrelated",render:a=>o.createElement(fn,se()({},a,{title:e,collectionStore:i,targetCollectionStore:n,property:s,showRight:0===b.length||"add"===(null==m?void 0:m.type),disabled:!l,style:t})),items:M};"add"===(null==m?void 0:m.type)?_.unshift(r):_.push(r)}const k=[];let T;if(S&&!g.isMobile&&b.length>0&&!p){k.push({key:"sprints_backlog",render:e=>a()(mn,{focused:e.focused,onMouseEnter:e.onMouseEnter,targetCollectionStore:n,onClick:u,isSection:!1,index:this.props.index,blockPropertyValueOverlayStore:this.props.blockPropertyValueOverlayStore}),action:()=>{u&&u()}}),T={paddingBottom:0,paddingTop:0};const e={key:"backlog",render:e=>o.createElement(fn,se()({},e,{collectionStore:i,targetCollectionStore:n,property:s,showRight:0===b.length||"add"===(null==m?void 0:m.type),disabled:!l,style:T})),items:k};_.push(e)}return f?a()(rn,{blockPropertyValueOverlayStore:this.props.blockPropertyValueOverlayStore,collectionStore:i,targetCollectionStore:n,sections:_,propertySchema:h,property:s,pageRecordStore:this.props.parentStore,search:this.props.searchQuery,relationPropertyMenuStore:this.props.relationPropertyMenuStore,addPage:this.props.addPage,addingPage:this.props.addingPage}):a()(pe.Z,{type:pe.i.Vertical,store:this.stores.menuListStore,style:{padding:"4px 0px"},initialFocus:this.environment.device.isMobile?void 0:0,sections:_})}renderRowMenuItem(e,t){const{disabled:i,canDrag:n,parentStore:a,collectionStore:s,targetCollectionStore:r,onAccept:l,property:d,blockPropertyValueOverlayStore:c}=this.props,u=Q.G.createChildStore(a,e.pointer),m=this.props.targetCollectionStore.getFormatStore().getKeyStore("app_config_uri").getValue()===Te.p$&&(0,di.wY)();let p=n&&!this.hasLimit()&&!m;t&&(p=p&&t>1);return{key:u.id,render:t=>{const n=e.type===mi.Rt.SelectedPage;return o.createElement(un.Z,se()({},t,{canDrag:p&&n,collectionStore:s,targetCollectionStore:r,relatedPageStore:u,disabled:i,isSelected:n,pageStore:a,property:d,rowType:"popup",onActionButtonClick:()=>this.props.onClickActionButton(e),blockPropertyValueOverlayStore:c,propertyLimit:this.hasLimit()?1:void 0,onOpenPageButtonClick:()=>{ki.O([e.pointer],u,this.environment,"relation_property")},handleClearProperty:()=>this.props.handleClearProperty()}))},action:t=>{l(e,Ti.DJ(t.event))}}}}function hn(){return a()("div",{style:{height:"100%",padding:mi.wI,display:"flex",alignItems:"center",justifyContent:"center"}},void 0,a()(st.Z,{style:{margin:"0 auto"}}))}function fn(e){window.__c={n:"RelationSectionHeader"};const{collectionStore:t,targetCollectionStore:i,property:n,showRight:s,disabled:l,style:d}=e,c=(0,r.VK)((()=>i.isSyncedCollection()),[i]),u=(0,r.VK)((()=>{const e=t.getSchema()[n];return Boolean(e&&_e.NK(e))}),[t,n]);return o.createElement(te.Z,se()({},e,{noTextOverflow:!0,isTitleUppercase:!1,right:s&&!c&&!u&&a()(pn.Z,{collectionStore:t,targetCollectionStore:i,property:n,disabled:l}),style:{paddingTop:0,paddingBottom:4,...d},desktopTitleStyle:{height:19,alignItems:"center",marginTop:6,marginBottom:6,paddingLeft:12,paddingRight:9}}))}gn.displayName="RelationPropertyMenuResults";const vn=gn,yn=(0,w.defineMessages)({inputPlaceholder:{defaultMessage:"Link or create a page…",id:"relationPropertyMenu2.searchPlaceholder"},searchLinkedInputPlaceholder:{defaultMessage:"Search linked pages…",id:"relationPropertyMenu2.viewExisting.searchPlaceholder"},syncedCollectionInputPlaceholder:{defaultMessage:"Link a page",id:"relationPropertyMenu2.syncedCollection.searchPlaceholder"},connectedRelationInputPlaceholder:{defaultMessage:"Find a page",id:"relationPropertyMenu2.connectedRelation.searchPlaceholder"},connectedRelationGoogleDriveInputPlaceholder:{defaultMessage:"Paste in Google Drive or Google Docs link",id:"relationPropertyMenu2.connectedRelationGoogleDrive.searchPlaceholder"},connectedRelationFigmaInputPlaceholder:{defaultMessage:"Paste in https://figma.com/...",id:"relationPropertyMenu2.connectedRelationFigma.searchPlaceholder"},connectedRelationGithubInputPlaceholder:{defaultMessage:"Paste in https://github.com/...",id:"relationPropertyMenu2.connectedRelationGithub.searchPlaceholder"},sprintTypedPropertyInputAddPlaceholder:{defaultMessage:"Search...",id:"relationPropertyMenu2.sprintTypedPropertyInputAddPlaceholder.searchPlaceholder"},sprintTypedPropertyInputViewPlaceholder:{defaultMessage:"Search linked sprints…",id:"relationPropertyMenu2.sprintTypedPropertyInputViewPlaceholder.searchPlaceholder"}});class Sn extends b.Z{constructor(){super(...arguments),this.storeTypes={store:fi,requestStore:vi.Z},this.maybeOverwriteBaseUrlFromSpaceId=(0,ui.b)(this.environment),this.addPage=async e=>{const{collectionStore:t,blockPropertyValueOverlayStore:i,blockStore:n,schema:o,property:s}=this.props,r=this.getRenderState();if(!r)return;const{targetCollectionStore:l}=r,d=l.getFormat().integration_id,c=gi.Z.externalAuthentications.state.filter((e=>e.integration_id===d))[0],u=l.getFormat().pattern_name,m=gi.Z.integrations.state.find((e=>e.id===d)),{searchQuery:p}=this.stores.store.state,g=(0,k.NZ)(n)?n:void 0,h=(0,k.NZ)(n)?n.getPropertyStore(s):void 0;this.stores.store.setState({...this.stores.store.state,addingPage:!0});try{var f,v;if(!(t&&m&&g&&h))return;const n=ke.rq(h.getValue()),r=e||p||"";if(!wn({integration:m,patternName:u,url:r}))return void dt.showDialog({items:[{label:a()(w.FormattedMessage,{id:"connectedRelationPropertyMenuResults.unsupportedUrlErrorDialog.copyDebuggingInformation",defaultMessage:"Copy debugging information"}),color:"blue",onAccept:()=>{si.RD({environment:this.environment,stringValue:JSON.stringify({botId:null==c?void 0:c.parent_id,url:r},null,2),copiedMessage:si.tq.copiedToClipboard})}},{label:a()(w.FormattedMessage,{id:"connectedRelationPropertyMenuResults.unsupportedUrlErrorDialog.closeButton",defaultMessage:"Close"}),onAccept:()=>{}}],showCancel:!1,keepFocus:!1,message:a()(w.FormattedMessage,{id:"connectedRelationPropertyMenuResults.unsupportedUrlErrorDialog.title",defaultMessage:"This source is currently not supported. Please try a different source."})});const d=o[s],y=ke.Kp(d),S=y?h.id:void 0,b=ke.gg(d),M=ke.ic(d),C=ke.U8(d),_=M&&pi.default.checkGate("figma_connected_relation"),k=C&&pi.default.checkGate("zendesk_connected_relation"),T=b&&pi.default.checkGate("google_drive_connected_relation"),I=(0,ci.NP)(m.id),P=(null==m?void 0:m.id)===ai.U9?null===(f=I[0])||void 0===f?void 0:f.id:null==c?void 0:c.parent_id,Z=y||T||k||_?I.map((e=>e.id)):[P],x=await ri.yp({environment:this.environment,url:r,botIds:Z,userDefinedExternalCollectionStore:l,relatedPageId:S});if(!x)return;const F=(null===(v=it.default.state.data)||void 0===v?void 0:v.addOns)??[];if(k&&(0,xe.de)(F)){const e=this.environment;oi.getZendeskTicketConversation(e,{ticketUrl:r,spaceId:x.getSpaceId(),botId:Z[0],pageId:h.id}),li.j(e,"zendesk_unfurl_ai")}Ge.createAndCommit({userAction:"connectedRelationPropertyMenuResults.createRelationPage",environment:this.environment,perform:e=>{const t={id:x.id,table:Pe.iU,spaceId:x.getSpaceId()},a=null!=d&&d.limit?[t]:[...n,t],o=ke.ow(a);Ke.sO({store:h,value:o,transaction:e}),i&&i.state.isOpen&&i.state.collectionContextStore&&(Ne.rv({environment:this.environment,collectionContextStore:i.state.collectionContextStore,block_id:g.id,property:s,property_type:"relation",from:"relation_section",isFromBulkActionsToolbar:!1,integration_id:m.id,action:"add"}),K.kmb(this.environment,{...(0,G.Pn)(i.state.collectionContextStore),from:"relation_section",target_collection_id:l.id,integration_id:m.id}))}}),this.stores.store.reset()}finally{this.stores.store.setState({...this.stores.store.state,addingPage:!1})}},this.handleSearchInputChange=e=>{const t=e.target.value;this.stores.store.setState({...this.stores.store.state,searchQuery:t,searchLimit:fi.limitIncrement})},this.handleMobileTargetCollectionClick=()=>{const e=this.getRenderState();e&&(St.navigate({environment:this.environment,url:e.targetParentUrl}),K.ZZ8(this.environment,{from:this.props.analyticsFrom}))},this.handleMobileSearchInputClick=()=>{const e=this.stores.store.state;this.stores.store.setState({...this.stores.store.state,searchQuery:e.searchQuery,searchPopupOpen:!0,searchLimit:fi.limitIncrement})},this.handleSelectedPageClick=(e,t)=>{const{mainEditorCurrentBlockStore:i}=m.default.state;if(!i)return;let n;if(t){const t=Q.G.createChildStore(i,e.pointer),a=t.isDefined()?this.maybeOverwriteBaseUrlFromSpaceId(t.getSpaceId()):void 0;n=(0,$t.Z)({pageId:e.pointer.id,pageModel:t.getModel(),baseUrl:a,pageVisitSource:Qt.tY.LinkInPage})}else{const t=i.isDefined()?this.maybeOverwriteBaseUrlFromSpaceId(i.getSpaceId()):void 0;n=(0,$t.Z)({pageId:i.id,pageModel:i.getModel(),baseUrl:t,peekViewBlockId:e.pointer.id,pageVisitSource:Qt.tY.LinkInPage})}St.navigate({environment:this.environment,url:n,openInNew:t}),K.XXm(this.environment,{from:this.props.analyticsFrom,meta_click:Boolean(t)})},this.handleValueRelationPropertyMenuResultsAccept=(e,t)=>{e.type===mi.Rt.SelectedPage&&this.handleSelectedPageClick(e,t)},this.handleSearchRelationPropertyMenuResultsAccept=(e,t)=>{var i;if(this.props.disabled)return;const{value:n,onChange:a,overlayMode:o}=this.props,{mainEditorCurrentBlockStore:s}=m.default.state;if(!s)return;const r=null===(i=this.getRenderState())||void 0===i?void 0:i.propertySchema.limit;if(e.type===mi.Rt.SearchPage){var l,d,c,u;a({value:r?[e.pointer]:"add"===(null==o?void 0:o.type)?[...n.slice(0,o.index),e.pointer,...n.slice(o.index)]:[...n,e.pointer]}),K.dw6(this.environment,{from:this.props.analyticsFrom,collection_id:null===(l=this.props.collectionStore)||void 0===l?void 0:l.id,collection_view_id:null===(d=this.context.collectionContextStore)||void 0===d||null===(d=d.collectionViewStore())||void 0===d?void 0:d.id,collection_view_block_id:null===(c=this.context.collectionContextStore)||void 0===c||null===(c=c.collectionViewBlockStore())||void 0===c?void 0:c.id,target_collection_id:null===(u=this.getRenderState())||void 0===u||null===(u=u.targetCollectionStore)||void 0===u?void 0:u.id})}else e.type===mi.Rt.SelectedPage&&this.handleSelectedPageClick(e,t)},this.handleCreateNewPage=e=>{var t,i,n;const{searchQuery:a}=this.stores.store.state,o=(0,ii.ZP)(),s=null===(t=this.getRenderState())||void 0===t?void 0:t.targetCollectionStore.getSpaceId(),{value:r,onChange:l}=this.props,d=null===(i=this.getRenderState())||void 0===i?void 0:i.propertySchema.limit,c={id:o,table:Pe.iU,spaceId:s};l({newPage:{id:o,spaceId:s,name:a},value:d?[c]:e?[...r.slice(0,e),c,...r.slice(e)]:[...r,c]}),K.kmb(this.environment,{...(0,G.Pn)(this.context.collectionContextStore),from:this.props.analyticsFrom,target_collection_id:null===(n=this.getRenderState())||void 0===n||null===(n=n.targetCollectionStore)||void 0===n?void 0:n.id})},this.handleClearProperty=()=>{const{onChange:e}=this.props;e({value:[]})},this.handleClickActionButton=e=>{var t;const{value:i,onChange:n,overlayMode:a}=this.props,{mainEditorCurrentBlockStore:o}=m.default.state;if(!o)return;const s=null===(t=this.getRenderState())||void 0===t?void 0:t.propertySchema.limit;if(e.type===mi.Rt.SearchPage){var r;n({value:s?[e.pointer]:"add"===(null==a?void 0:a.type)?[...i.slice(0,a.index),e.pointer,...i.slice(a.index)]:[...i,e.pointer]}),K.dw6(this.environment,{from:this.props.analyticsFrom,...(0,G.Pn)(this.context.collectionContextStore),target_collection_id:null===(r=this.getRenderState())||void 0===r||null===(r=r.targetCollectionStore)||void 0===r?void 0:r.id})}else if(e.type===mi.Rt.SelectedPage){var l;n({value:s?[]:i.filter((t=>t.id!==e.pointer.id))}),K.WFT(this.environment,{...(0,G.Pn)(this.context.collectionContextStore),from:this.props.analyticsFrom,target_collection_id:null===(l=this.getRenderState())||void 0===l||null===(l=l.targetCollectionStore)||void 0===l?void 0:l.id})}var d;s&&(null===(d=this.props.blockPropertyValueOverlayStore)||void 0===d||d.setState({isOpen:!1}))},this.handleRelationPropertyMenuResultsDrag=e=>{const{collectionStore:t,onChange:i}=this.props;i({value:e.map((e=>({id:e,spaceId:t.pointer.spaceId,table:Pe.iU})))}),K.yT1(this.environment,{from:this.props.analyticsFrom})},this.handleMobileSearchMenuClickRight=()=>{this.resetInputState()},this.handleSearchScrollOffsetChange=e=>{const{store:t,requestStore:i}=this.stores,{loading:n,result:a}=i.state;e<fi.incrementScrollOffset&&a&&!n&&a.results.length>=t.state.searchLimit&&t.setState({...t.state,searchLimit:t.state.searchLimit+fi.limitIncrement})},this.performSearchRequest=async e=>{const{disabled:t}=this.props,i={results:[],query:e.query},n=this.getRenderState();if(!n)return i;if(t)return i;if(ke.gg(n.propertySchema)||ke.ic(n.propertySchema))return i;const{targetCollectionStore:a}=n;let o=[];if(a.getFormatStore().getKeyStore("app_config_uri").getValue()===Te.p$&&(0,di.wY)())try{const t=await async function(e){var t;const{environment:i,sprintCollectionStore:n,searchQuery:a}=e,o=n.getPropertyMapping(),s=null==o?void 0:o[Xt.b.StatusV2],r=null==o?void 0:o[Xt.b.Dates];if(!s||!r)throw new Error("Sprints database does not have the required properties");const l="results",d={type:"reducer",userTimeZone:(0,ei.r)(),searchQuery:a,sort:[{property:s,direction:"ascending"},{property:r,direction:"ascending"}],reducers:{[l]:{type:"results",limit:100}}},c=null===(t=n.getParentBlockStore())||void 0===t?void 0:t.getCollectionViewStores()[0],u=n.getSpaceId();if(!c)return[];const m=await oi.queryCollection(i,{source:{type:"collection",id:n.id,spaceId:u},collectionView:{id:c.id,spaceId:u},loader:d},void 0,{src:"relation_property_menu"});if("success"!==m.type)return[];const p=m.data.result.reducerResults[l];if("results"!==p.type)return[];return p.blockIds}({environment:this.environment,sprintCollectionStore:a,searchQuery:e.query});return o=this.convertPageIdsToRelationResults(t,a),{results:o,query:e.query}}catch(s){}try{const{results:t}=await Ot.df({environment:this.environment,query:e.query,collectionId:a.id,limit:e.limit,spaceId:a.getSpaceId(),excludeTemplates:!0,source:"relation_menu",includePublicPagesWithoutExplicitAccess:!0,boostRecentlyViewedPages:!0,ignoresHighlight:!0});o=this.convertPageIdsToRelationResults(t,a)}catch(s){Jt.log({level:"error",from:"relationPropertyMenu",type:"search",error:(0,ti.Ui)(s)})}return{results:o,query:e.query}},this.getRecordValue=ni.mF.fromMonomorphicFunctionUnsafe((e=>{const t=Q.G.createChildStore(this.props.blockStore,e);return t.computeWithRecordValues((e=>{let{getRecordValueAndSubscribe:i}=e;return i(t)}))}))}didMount(){super.didMount(),we.default.afterNextFlush((()=>{we.default.afterNextFlush((()=>{const e=this.getRenderState();if(e){0===this.getValueResults(e).length&&this.stores.store.setState({searchPopupOpen:this.environment.device.isMobile,searchQuery:this.props.insertChar??"",searchLimit:fi.limitIncrement,addingPage:!1})}}))}))}renderComponent(){const{device:e}=this.environment,t=this.getRenderState();if(t)return a()(P.Z,{capture:!0,allowMenuList:!0,allowEsc:!0,allowUndo:!0,allowTabUntab:!0,render:()=>e.isMobile?this.renderMobileMenu(t):this.renderDesktopMenu(t)})}realWindowAsJSDOMWindow(e){return e}lightweightIsPhoneNumber(e){return/^(\+\d{1,2}\s)?\(?\d{3}\)?[\s.-]\d{3}[\s.-]\d{4}$/.test(e)}renderDesktopMenu(e){const{searchQuery:t}=this.stores.store.state,i=this.stores.requestStore.state.result,{blockStore:n,disabled:o,analyticsFrom:s,overlayMode:r}=this.props,{targetCollectionStore:l}=e,d=Boolean(gi.Z.bots.state.find((e=>e.integration_id===ai.U9))),c=ke.Kp(e.propertySchema)&&!d,u=r&&"add"===r.type?r.index:void 0;return a()(F.Z,{menuType:_.og.Popup,header:c?null:a()(bn,{store:this.stores.store,disabled:o,renderState:e,blockStore:n,analyticsFrom:s,isConnectedRelation:Boolean(e.propertySchema.connectedRelation),overlayMode:r,addPage:this.addPage}),footer:this.renderFooter({requestStateResult:i,searchQuery:t,overlayMode:r,disabled:o,targetCollectionStore:l,index:u,propertySchema:e.propertySchema})},void 0,a()("div",{style:{overflow:"hidden",maxHeight:"70vh"}},void 0,this.renderSearchResults(e)))}renderFooter(e){const{requestStateResult:t,searchQuery:i,overlayMode:n,disabled:o,targetCollectionStore:s,index:r,propertySchema:l}=e;return!(s.getFormatStore().getKeyStore("app_config_uri").getValue()===Te.p$&&(0,di.wY)())&&"view"===(null==n?void 0:n.type)||o||l.connectedRelation?null:t&&t.results.length>0&&i&&a()(Ci,{targetCollectionStore:s,title:i,onClick:this.handleCreateNewPage,focused:!1,isSection:!0,index:r})}renderMobileMenu(e){const{device:t}=this.environment,{searchPopupOpen:i}=this.stores.store.state,{collectionStore:n,property:o,schema:s,blockStore:r,blockPropertyValueOverlayStore:l,disabled:d,canConfigureCollection:c,onDismiss:u}=this.props,{showProperties:m,targetCollectionStore:p}=e,{mediumTextColor:g}=this.theme,h=this.getValueResults(e),f=s[o],v=f&&_e.NK(f),y=Boolean(gi.Z.bots.state.find((e=>e.integration_id===ai.U9))),S=Boolean(gi.Z.bots.state.find((e=>e.integration_id===ai.f3))),b=Boolean(gi.Z.bots.state.find((e=>e.integration_id===ai.mQ))),M=ke.Kp(e.propertySchema),C=ke.gg(e.propertySchema),k=ke.ic(e.propertySchema),T=M&&!y||C&&!S||k&&!b;return a()(F.Z,{menuType:_.og.Modal,title:e.propertySchema.name,right:a()(w.FormattedMessage,{defaultMessage:"Done",id:"relationPropertyMenu.mobileMenuDone.button"}),onClickRight:u},void 0,v?null:a()(te.Z,{disableMobilePadding:!0},void 0,a()(me.Z,{focused:!1,title:a()("div",{style:{display:"flex"}},void 0,a()(w.FormattedMessage,{id:"database.relationProperty.newRelation.targetDatabase",defaultMessage:"<regular>In</regular> {databaseWithIcon}",values:{regular:e=>e,databaseWithIcon:a()("div",{style:{display:"flex",marginLeft:2*mi.Qi}},void 0,a()(Si.Z,{disabled:!0,icon:p.getIcon(),isEmptyPage:!1,size:20}),a()(bi.Z,{store:p,underline:!0,style:{marginLeft:mi.Qi}}))}})),showExtensionArrow:!1,onClick:this.handleMobileTargetCollectionClick})),T?null:a()(te.Z,{topBorder:!0,disableMobilePadding:!1},void 0,a()(N.GI,{popupType:N.kQ.SlideUp,open:i,origin:a()(me.Z,{focused:!1,title:a()("span",{style:{display:"flex",alignItems:"center"}},void 0,Ie.Z.plus({marginRight:8,width:t.isMobile?16:14,height:t.isMobile?16:14}),a()(w.FormattedMessage,{defaultMessage:"Add a page",id:"relationPropertyMenu.addAPage.button"})),onClick:this.handleMobileSearchInputClick,style:{color:g}}),render:()=>this.renderSearchResults(e)})),a()(vn,{collectionStore:n,targetCollectionStore:p,showProperties:m,results:h,resultsType:"existing",property:o,schema:s,parentStore:r,disabled:d,canConfigureCollection:c,loading:!1,canDrag:!1,blockPropertyValueOverlayStore:l,onAccept:this.handleValueRelationPropertyMenuResultsAccept,onClickActionButton:this.handleClickActionButton,onCreatePage:this.handleCreateNewPage,handleClearProperty:this.handleClearProperty,relationPropertyMenuStore:this.stores.store,addPage:this.addPage,addingPage:this.stores.store.state.addingPage}))}renderSearchResults(e){const{device:t}=this.environment,{collectionStore:i,value:n,property:s,schema:r,blockStore:l,blockPropertyValueOverlayStore:d,disabled:c,canConfigureCollection:u,overlayMode:m}=this.props,{requestStore:p}=this.stores,{showProperties:g,targetCollectionStore:h,propertySchema:f}=e,{searchQuery:v,searchLimit:y}=this.stores.store.state;let S=Je.default.mark("rum.relation_search_query");const b=f.limit?n.slice(0,1):n,M={request:{query:v,limit:y},debounce:Ot.vp,performRequest:this.performSearchRequest,render:(n,p)=>{let y=[];y=v?this.getValueResults(e).filter((e=>{const t=Q.G.createChildStore(this.props.blockStore,e.pointer),i=t.getModel();if(i)return(0,Yt.fY)({block:i,query:v,getRecordModel:t.getRecordModel,userTimeZone:(0,ei.r)(),schema:r,intl:ce.default.getIntl(),onlyPropertyIds:["title"]})})):this.getValueResults(e);const M=!p&&0===y.length,C=y;p&&p.results.forEach((e=>{if((e.type===mi.Rt.SelectedPage||e.type===mi.Rt.SearchPage)&&y.find((t=>t.pointer.id===e.pointer.id)))return;const t=e.type!==mi.Rt.NewPage?b.map((e=>e.id)).includes(e.pointer.id):void 0;t&&!v&&"add"===(null==m?void 0:m.type)||(e.type===mi.Rt.SearchPage&&t?C.push({type:mi.Rt.SelectedPage,key:e.key,pointer:e.pointer}):e.type!==mi.Rt.SelectedPage||t?C.push(e):C.push({type:mi.Rt.SearchPage,key:e.key,pointer:e.pointer}))})),!M&&""!==v&&S&&p&&p.query===v&&(Je.default.measure(S,{environment:this.environment}),S=void 0);const k=a()(vn,{collectionStore:i,targetCollectionStore:h,showProperties:g,results:C,resultsType:0===C.length&&0===this.getValueResults(e).length?"existing":"search",property:s,schema:r,parentStore:l,disabled:c,canConfigureCollection:u,loading:M,canDrag:!c&&0===v.length,blockPropertyValueOverlayStore:d,onAccept:this.handleSearchRelationPropertyMenuResultsAccept,onClickActionButton:this.handleClickActionButton,onScrollOffsetChange:this.handleSearchScrollOffsetChange,onDrag:this.handleRelationPropertyMenuResultsDrag,onCreatePage:this.handleCreateNewPage,handleClearProperty:this.handleClearProperty,searchQuery:v,overlayMode:m,relationPropertyMenuStore:this.stores.store,addPage:this.addPage,addingPage:this.stores.store.state.addingPage});if(t.isMobile){let e=ce.default.formatMessage(yn.inputPlaceholder);const i=_e.NK(f);return i&&(e=ce.default.formatMessage(yn.connectedRelationInputPlaceholder)),ke.gg(f)&&(e=ce.default.formatMessage(yn.connectedRelationGoogleDriveInputPlaceholder)),ke.ic(f)&&(e=ce.default.formatMessage(yn.connectedRelationFigmaInputPlaceholder)),ke.Kp(f)&&(e=ce.default.formatMessage(yn.connectedRelationGithubInputPlaceholder)),a()(F.Z,{menuType:_.og.Modal,title:a()(w.FormattedMessage,{defaultMessage:"Relation",id:"relationPropertyMenu.mobileRelationMenu.title"}),left:this.renderMobileHelpButton(),right:a()(w.FormattedMessage,{defaultMessage:"Done",id:"relationPropertyMenu.mobileDoneButton"}),header:o.createElement(o.Fragment,null,a()(ee.ZP,{value:v,disabled:c,onChange:this.handleSearchInputChange,placeholder:e,showClearButton:!0,focus:!t.isMobile||void 0,focusInitial:!0,style:{...t.isAndroid&&{borderBottom:"none"}}}),v&&!c&&!i&&a()(Ci,{targetCollectionStore:h,title:v,onClick:this.handleCreateNewPage,focused:!1,isSection:!0})),onClickRight:this.handleMobileSearchMenuClickRight},void 0,k)}return k}};return o.createElement(Wt.Z,se()({},M,{requestStore:p}))}renderMobileHelpButton(){return a()(Mi.Z,{href:(0,q.UY)("guides.relations"),analyticsFrom:"relation_menu"})}getRenderState(){const{schema:e,property:t,blockStore:i,collectionStore:n}=this.props,a=e[t];if(!a||"relation"!==a.type)return;const o=_e.j0(a);if(!o)return;const s=Q.NW.createChildStore(i,o),r=s.getParentId();if(!r)return;const l=Q.G.createChildStore(s,{table:Pe.iU,id:r}),d=_e.oC({schema:s.getSchema(),format:s.getFormat(),space_id:s.getSpaceId()}),c=[d[`${ke.UU}title`]?`${ke.UU}title`:"title"],u=l.isDefined()?this.maybeOverwriteBaseUrlFromSpaceId(l.getSpaceId()):void 0,m=(0,$t.Z)({pageId:l.id,pageModel:l.getModel(),baseUrl:u,pageVisitSource:void 0});return{propertySchema:a,property:t,targetCollectionStore:s,targetParentBlock:l,showProperties:c,targetCollectionSchema:d,targetParentUrl:m,collectionStore:n}}resetInputState(){this.stores.store.reset()}convertPageIdsToRelationResults(e,t){const{value:i}=this.props,n=[];return e.forEach((e=>{if(i.map((e=>e.id)).includes(e)){const i={key:e,type:mi.Rt.SelectedPage,pointer:{spaceId:t.getSpaceId(),id:e,table:Pe.iU}};n.push(i)}else{const i={key:e,type:mi.Rt.SearchPage,pointer:{spaceId:t.getSpaceId(),id:e,table:Pe.iU}};n.push(i)}})),n}getValueResults(e){const{value:t,overlayMode:i}=this.props,{propertySchema:n}=e,{searchQuery:a}=this.stores.store.state;return a||"add"!==(null==i?void 0:i.type)?ke.j$({relationValue:t,propertySchema:n,getRecordValue:this.getRecordValue}).map((e=>({key:e.id,type:mi.Rt.SelectedPage,pointer:e}))):[]}}function bn(e){var t;window.__c={n:"RelationPropertyMenuInput"};const i=(0,s.O7)(),n=(0,s.Fy)(),{targetParentUrl:o,targetCollectionStore:l,propertySchema:d}=e.renderState,[c,u,m]=(0,r.AF)(e.store),{searchQuery:p,searchPopupOpen:g}=c,h=(0,r.VK)((()=>l.getIcon()),[l]),f=(0,r.VK)((()=>l.isSyncedCollection()),[l]),v=(0,r.VK)((()=>ke.Kp(d)),[d]),y=(0,r.VK)((()=>ke.gg(d)),[d]),S=(0,r.VK)((()=>ke.ic(d)),[d]),b=(0,r.VK)((()=>l.getFormatStore().getKeyStore("app_config_uri").getValue()===Te.p$&&(0,di.wY)()),[l]),M=(0,Ce.yK)((e=>({regular:{color:e.mediumTextColor,whiteSpace:"nowrap",marginLeft:4},headerWrap:{display:"flex",width:"100%",position:"relative",zIndex:2,padding:"6px 10px",fontSize:14,background:e.inputBackground,boxShadow:`\n\t\t\t\t\t0 1px 0 ${e.darkDividerColor}\n\t\t\t\t`},recordTitle:{fontWeight:Be.Z.fontWeight.semibold,fontSize:14,marginLeft:mi.Qi*(n.isRetina?.5:1)},searchIcon:{fill:e.mediumIconColor,width:14,height:14,marginRight:10}})),[n.isRetina]);let C=yn.inputPlaceholder;if(f)C=yn.syncedCollectionInputPlaceholder;else if(v)C=yn.connectedRelationGithubInputPlaceholder;else if(y)C=yn.connectedRelationGoogleDriveInputPlaceholder;else if(S)C=yn.connectedRelationFigmaInputPlaceholder;else if(b){var _;"view"===(null===(_=e.overlayMode)||void 0===_?void 0:_.type)&&(C=yn.sprintTypedPropertyInputViewPlaceholder),C=yn.sprintTypedPropertyInputAddPlaceholder}else e.isConnectedRelation?C=yn.connectedRelationInputPlaceholder:("view"===(null===(t=e.overlayMode)||void 0===t?void 0:t.type)||e.disabled)&&(C=yn.searchLinkedInputPlaceholder);const k=ce.default.formatMessage(C);return a()("div",{style:M.headerWrap},void 0,a()(ye.Z,{style:{flexGrow:1},value:p,placeholder:k,forceShowClearButton:Boolean(p||g),focus:!0,onChange:e=>{const t=e.target.value;u({...c,searchQuery:t,searchPopupOpen:!!t,searchLimit:fi.limitIncrement})},onClearButtonClick:()=>{u(m.getInitialState())},onClick:()=>{u({...c,searchQuery:c.searchQuery,searchPopupOpen:!0,searchLimit:fi.limitIncrement})},onKeyDown:e=>{"Escape"===e.key&&u(m.getInitialState())},format:ye.B.Transparent,onSubmit:()=>(()=>{const t=l.getFormat().integration_id,i=gi.Z.integrations.state.find((e=>e.id===t)),n=l.getFormat().pattern_name;if(!i||!n)return;wn({integration:i,patternName:n,url:c.searchQuery})&&e.addPage()})()}),!e.isConnectedRelation&&!b&&a()("div",{style:{display:"flex",marginLeft:10,alignItems:"center"}},void 0,a()(w.FormattedMessage,{id:"database.relationProperty.newRelation.targetDatabase",defaultMessage:"<regular>In</regular> {databaseWithIcon}",values:{regular:e=>a()("span",{style:M.regular},void 0,e),databaseWithIcon:a()(yi.Z,{href:o,style:{marginLeft:mi.Qi},innerStyle:{display:"flex"},onClick:()=>{K.ZZ8(i,{from:e.analyticsFrom})}},void 0,a()(Si.Z,{disabled:!0,icon:h,isEmptyPage:!1,size:20}),a()(bi.Z,{store:l,underline:!0,style:M.recordTitle}))}})))}Sn.displayName="RelationPropertyMenu",Sn.contextTypes={...b.w,...qe.xm},Sn.width=400,Sn.titleColumnWidth=300,Sn.columnWidth=150,Sn.rowHeight=32;const Mn=Sn,wn=e=>{var t;if(e.patternName)return null===(t=e.integration.info)||void 0===t||null===(t=t.original_url_patterns)||void 0===t?void 0:t.filter((t=>{var i;return t.name===e.patternName&&(null===(i=t.additional_types)||void 0===i?void 0:i.connectedRelation)})).find((t=>{let{regex:i}=t;return new RegExp(i).test(e.url)}))};var Cn=i(18145),_n=i(43261),kn=i.n(_n),Tn=i(84619),In=i(71644);class Pn extends Mt.default{getInitialState(){return{inputValue:"",openPropertyActionMenu:void 0}}}const Zn=Pn;var xn=i(33846),Fn=i(73456),An=i(22084);class En extends b.Z{constructor(){super(...arguments),this.storeTypes={renameInputStore:xn.Z},this.renderActionMenuButton=()=>{const{property:e,collectionId:t,analyticsFrom:i,onChange:n,onCloseActionMenu:o,actionMenuOpen:s,focused:r,option:l,propertySchema:d}=this.props,{device:c}=this.environment;return a()(Fn.Z,{open:s,origin:a()(_t.Z,{onClick:this.handleActionButtonClick,isMobile:c.isMobile,style:{opacity:r||c.isMobile?1:0}}),option:l,propertySchema:d,property:e,collectionId:t,analyticsFrom:i,onChange:n,onClose:o})},this.handleActionButtonClick=e=>{(0,Ui.ZP)({event:e,context:Ui.Af.MenuListClick,callback:()=>this.props.onOpenActionMenu(this.props.option.value)})}}willMountOrUpdate(e){e.actionMenuOpen&&!this.props.actionMenuOpen&&this.stores.renameInputStore.setState({...this.stores.renameInputStore.state,inputValue:this.props.option.value})}renderComponent(){const{locked:e,option:t}=this.props;return a()(x.Z,{capture:this.props.actionMenuOpen,onEnter:U().identity},void 0,o.createElement(me.Z,se()({},this.props,{title:a()(An.a,{format:this.environment.device.isMobile?Tn.l.Large:Tn.l.Medium,value:t.value,color:t.color,showRemoveButton:!1,isSingle:!0,showEllipsis:!0}),desktopTitleStyle:{marginRight:6},isTokenTitle:!0,right:!e&&this.renderActionMenuButton()})))}}En.displayName="SelectPropertyMenuItem",En.contextTypes={..._.mw,...b.w};const Bn=En;class Dn extends b.Z{constructor(){super(...arguments),this.storeTypes={store:Zn,menuListStore:Pi.Z},this.handleSelectPropertyMenuItemChange=e=>{const{property:t,schema:i}=this.props,n=i[t];if(!n)return;if(!_e.cu(n))return;const a=n.options||[],o=[...a],s={},r=this.props.value.filter((e=>{const t=a.find((t=>t.value===e));return!t||o.some((e=>e.id===t.id))}));s.operations=e,U().isEqual(r,this.props.value)||(s.value=r),this.props.onChange(s)},this.handleCloseActionMenu=()=>{this.stores.store.setState({...this.stores.store.state,openPropertyActionMenu:void 0})},this.handleOpenActionMenu=e=>{this.stores.store.setState({...this.stores.store.state,openPropertyActionMenu:e})},this.handleTokenInputChange=e=>{this.stores.store.setState({...this.stores.store.state,inputValue:""});const{collectionId:t,allowMultiple:i,property:n,schema:a,onChange:o,analyticsFrom:s}=this.props,r=a[n];if(!r)return;if(!_e.cu(r))return;const l=r.options||[];let d;d=i?e:e.length>0?[e[e.length-1]]:[];const c=U().uniq(U().compact(d.map((e=>{const t=l.find((t=>t.value===e));if(t)return t.value})))),u=d.find((e=>!l.find((t=>t.value===e)))),m={value:c.concat(U().compact([u]))};if(u){const e={id:(0,ii.ZP)(),value:u,color:this.createSelectColor};let i;i="alphabetical"!==r.auto_sort_options&&"reverse_alphabetical"!==r.auto_sort_options||!pi.default.checkGate("collection_properties_select_auto_sort_options")?[{pointer:{table:Ze.v,id:t},command:"keyedObjectListAfter",path:["schema",n,"options"],args:{value:e}}]:[(0,Qe.Ch)({collectionId:t,property:n,propertySchema:r,newOption:e,isAscending:"alphabetical"===r.auto_sort_options})],m.operations=i,this.setRandomCreateSelectColor(),K.$qu(this.environment,{...(0,G.Pn)(this.context.collectionContextStore),property_type:r.type,action:"select_add_option",from:s})}o(m)},this.handleDraggableListDrop=e=>{const{collectionId:t,property:i,schema:n,onChange:a}=this.props,o=(0,Qe.YL)({newOptions:e,collectionId:t,property:i,schema:n});if(o){const e=n[i];if(e&&_e.cu(e)){"manual"!==(e.auto_sort_options||"manual")&&o.push({pointer:{table:Ze.v,id:t},command:"update",path:["schema",i],args:{auto_sort_options:"manual"}})}a({operations:o})}this.stores.menuListStore.reset()}}willMount(e){if(this.setRandomCreateSelectColor(),e.insertChar){const t=e.insertChar;this.stores.store.setState({...this.stores.store.state,inputValue:t})}}renderNoOptionsFound(){return a()(w.FormattedMessage,{id:"database.selectPropertyEditMenu.noResults",defaultMessage:"No options found"})}renderSelectOnlyPrompt(){return a()(w.FormattedMessage,{id:"database.selectPropertyEditMenu.selectOnlyPrompt",defaultMessage:"Select an option"})}renderSelectOrCreatePrompt(){return a()(w.FormattedMessage,{id:"database.selectPropertyEditMenu.selectOrCreatePrompt",defaultMessage:"Select an option or create one"})}renderComponent(){const{device:e}=this.environment,{disabled:t,canConfigureCollection:i}=this.props,n=this.props.schema[this.props.property];if(!n)return;if(!_e.cu(n))return;const s=n.options||[],r=this.renderCurrentTokens(s),l=this.getTokenResults(this.stores.store.state.inputValue,s),d=0===l.length,c=a()(zt.Z,{focus:e.isMobile?void 0:!this.stores.store.state.openPropertyActionMenu,focusAfterAnimation:!0,format:zt.Z.Format.Select,tokens:r,placeholder:this.props.intl.formatMessage({id:"database.selectPropertyEditMenu.searchPlaceholder",defaultMessage:"Search for an option..."}),onRemoveLastToken:()=>{this.handleTokenInputChange(this.props.value.slice(0,this.props.value.length-1))},value:this.stores.store.state.inputValue,disabled:t,hideInput:t,onChange:e=>this.stores.store.setState({...this.stores.store.state,inputValue:e.target.value}),dontShowBorderBottom:e.isAndroid});let u;return u=e.isMobile?{menuType:_.og.Modal,title:n.name,right:a()(A.DoneMenuText,{}),onClickRight:this.props.onDismiss,header:c}:{menuType:_.og.Popup,header:c,tokenInputHeader:!0},t?o.createElement(F.Z,u):o.createElement(F.Z,u,d?a()(te.Z,{title:i?this.renderSelectOrCreatePrompt():this.renderNoOptionsFound()},void 0,e.isMobileNative&&a()(Ut.Z,{title:this.renderNoOptionsFound()})):a()(pe.Z,{type:pe.i.Vertical,initialFocus:this.stores.store.state.inputValue.length>0?0:void 0,sections:[{key:0,render:e=>this.renderMenuListSection(e,l),items:this.getSelectMenuListItems(l,s)}],onAccept:(e,t,i)=>{this.props.onAccept(i)},store:this.stores.menuListStore}))}renderMenuListSection(e,t){const{canConfigureCollection:i}=this.props;return i?o.createElement(te.Z,se()({},e,{title:this.renderSelectOrCreatePrompt(),children:a()(gt.ZP,{direction:"vertical",keys:t,renderKey:i=>e.children[t.indexOf(i)],onDrop:this.handleDraggableListDrop})})):o.createElement(te.Z,se()({},e,{title:this.renderSelectOnlyPrompt(),children:e.children}))}renderFoundSelectPropertyMenuItem(e,t){const{schema:i,property:n}=this.props,a=i[n];if(a&&_e.cu(a))return o.createElement(Bn,se()({},e,{option:t,showDragHandle:this.props.canConfigureCollection,locked:!this.props.canConfigureCollection,property:this.props.property,analyticsFrom:this.props.analyticsFrom,collectionId:this.props.collectionId,onChange:this.handleSelectPropertyMenuItemChange,actionMenuOpen:this.stores.store.state.openPropertyActionMenu===t.value,propertySchema:a,onCloseActionMenu:this.handleCloseActionMenu,onOpenActionMenu:this.handleOpenActionMenu}))}renderCreateSelectPropertyMenuItem(e,t,i){const{device:n}=this.environment;return o.createElement(me.Z,se()({},e,{title:a()("div",{style:{display:"flex",minWidth:0}},void 0,a()("div",{style:{marginRight:6,lineHeight:1.3}},void 0,a()(w.FormattedMessage,{id:"database.selectPropertyEditMenu.createLabel",defaultMessage:"Create"})),a()(An.a,{value:t.value,color:t.color,showRemoveButton:!1,isSingle:!0,format:n.isMobile?Tn.l.Large:Tn.l.Medium,showEllipsis:!0})),isTokenTitle:!0}))}getSelectMenuListItems(e,t){return e.map((e=>{const i=t.find((t=>t.value===e));return{key:e,render:t=>{if(i)return this.renderFoundSelectPropertyMenuItem(t,i);{const i={id:(0,In.ZP)(),value:e,color:this.createSelectColor};return this.renderCreateSelectPropertyMenuItem(t,i,e)}},action:()=>{this.handleTokenInputChange([...this.props.value,e])}}}))}renderCurrentTokens(e){const{disabled:t}=this.props,{device:i}=this.environment;return U().compact(this.props.value.map((n=>{const o=(0,ke.i7)(e,n);if(o)return a()(An.a,{value:o.value,color:o.color,showRemoveButton:!t,isSingle:!1,format:i.isMobile?Tn.l.Large:Tn.l.Medium,shouldShrink:!0,onClickRemove:()=>{this.handleTokenInputChange(this.props.value.filter((e=>e!==n)))},showEllipsis:!0},o.id)})))}getTokenResults(e,t){const i=t.map((e=>e.value));let n;if(e){n=kn().filter(e,i).map((e=>e.original));!t.find((t=>t.value===e))&&e.trim().length>0&&this.props.canConfigureCollection&&n.push(e.trim().replace(/,/g,""))}else n=i;return n}setRandomCreateSelectColor(){const{schema:e,property:t}=this.props,i=e[t];if(!i)return;if(!_e.cu(i))return;const n=i.options||[],a=(0,_e.TL)(n);this.createSelectColor=a}}Dn.displayName="SelectPropertyMenu",Dn.contextTypes={...b.w,...qe.xm};const Rn=(0,w.injectIntl)(Dn);var Ln=i(40652),Nn=i(23014),On=i(5149),Vn=i(97180);function Un(e){window.__c={n:"StatusPropertyMenu"};const{device:t}=(0,s.O7)(),[i,n]=o.useState(e.initialValue??""),[l,d]=o.useState(""),c=(0,w.useIntl)(),u=(0,r.VK)((()=>{const t=e.blockPropertyValueOverlayStore.state;if(t.isOpen)return t.collectionContextStore}),[e.blockPropertyValueOverlayStore]),m=(0,r.VK)((()=>(null==u?void 0:u.permissionScopes.state.canConfigureCollection)&&"collectionPage"!==(null==u?void 0:u.contextType)),[u]),p=e.propertySchema.options??[],g=(0,ke.i7)(p,i),h=e.propertySchema.groups??[],f=g&&h.find((e=>{var t;return null===(t=e.optionIds)||void 0===t?void 0:t.includes(g.id)})),v=g&&a()(An.F,{value:g.value,color:g.color,groupColor:null==f?void 0:f.color,isSingle:!1,format:t.isMobile?Tn.l.Large:Tn.l.Medium,onClickRemove:()=>{n(""),e.onChange("")},showRemoveButton:!0,shouldShrink:!0,showEllipsis:!0}),y=a()(zt.Z,{focus:!t.isMobile||void 0,focusAfterAnimation:!0,format:zt.Z.Format.Select,tokens:[v],placeholder:c.formatMessage({id:"database.selectPropertyEditMenu.searchStatusPlaceholder",defaultMessage:"Search for an option"}),onRemoveLastToken:()=>{},value:l,disabled:e.disabled,hideInput:e.disabled,onChange:e=>{d(e.target.value)},dontShowBorderBottom:t.isAndroid});let S;if(S=t.isMobile?{menuType:_.og.Modal,title:e.propertySchema.name,right:a()(A.DoneMenuText,{}),onClickRight:e.onDismiss,header:y}:{menuType:_.og.Popup,header:y,tokenInputHeader:!0},e.disabled)return o.createElement(F.Z,S);const{propertySchema:b}=e,M=b.options??[];let C=M;if(""!==l){const e=kn().filter(l,M.map((e=>e.value))).map((e=>e.original));C=M.filter((t=>e.includes(t.value)))}const k=(b.groups??[]).map((e=>{const t=C.filter((t=>{var i;return null===(i=e.optionIds)||void 0===i?void 0:i.includes(t.id)}));if(0!==t.length)return{group:e,groupOptions:t}})).filter(Ee.$K),T=k.length>1,I=k.map(((i,n)=>{let{group:s,groupOptions:r}=i;return{items:r.map((i=>{const n=e.shouldDisableOption?e.shouldDisableOption(i.id):{disabled:!1};return{key:i.value,render:e=>o.createElement(me.Z,se()({},e,{disabled:n.disabled,disabledFeedback:!0,focused:e.focused,title:a()(qi.Z,{disableTooltip:!n.disabled||!n.disableReasonMessage,renderTooltip:()=>n.disabled&&n.disableReasonMessage,render:e=>o.createElement(An.F,se()({},e,{value:i.value,color:i.color,groupColor:s.color,showRemoveButton:!1,isSingle:!0,format:t.isMobile?Tn.l.Large:Tn.l.Medium}))}),isTokenTitle:!0})),action:()=>{e.onChange(i.value)}}})),key:`group-${n}`,render:e=>o.createElement(o.Fragment,null,o.createElement(te.Z,se()({},e,{topBorder:e.index>0,title:T&&a()(Vn.r_,{group:s,showColor:!1,style:{fontSize:12}})})))}})),P=u&&m?{items:[{key:"edit property",render:e=>o.createElement(me.Z,se()({},e,{title:a()(w.FormattedMessage,{defaultMessage:"Edit property",id:"database.tableHeaderCell.editProperty"}),icon:Ie.Z.options({width:14})})),action:()=>{const t=u.settingsStore;u.collectionStore()&&(e.onDismiss(),Ve.n1({collectionContextStore:u}),On.r$({collectionContextStore:u,collectionSettingsStore:t}),On.H4({collectionSettingsStore:t,item:{type:"property",formatKey:u.getPropertyFormatKey(),property:e.property}}))}}],key:"edit-property",render:e=>o.createElement(te.Z,se()({},e,{topBorder:e.index>0}))}:void 0;return o.createElement(F.Z,S,a()(pe.Z,{type:pe.i.Vertical,initialFocus:l.length>0?0:void 0,sections:U().compact([...I,P]),onAccept:(t,i,n)=>{e.onAccept(n)}}))}const Wn=(0,w.defineMessages)({cannotSetSprintToCurrentTooltip:{id:"SprintStatusPropertyMenu.cannotSetSprintToCurrentTooltip",defaultMessage:"Current sprint already exists"},cannotSetSprintToNextTooltip:{id:"SprintStatusPropertyMenu.cannotSetSprintToNextTooltip",defaultMessage:"Next sprint already exists"}});function Kn(e){window.__c={n:"SprintStatusPropertyMenu"};const{blockPropertyValueOverlayStore:t}=e,i=(0,s.O7)(),n=(0,qe.Y$)(),a=(0,r.VK)((()=>n.normalizedSchemaStore.state),[n.normalizedSchemaStore]),l=function(e){let{sprintCollectionStore:t,environment:i,normalizedBlockSchema:n}=e;const[{value:a,status:o}]=(0,Bi.r5)((async()=>{var e;if(!t)return;const a=Nn.qB[Ln.p$].current.reducer.get(n),o=Nn.qB[Ln.p$].next.reducer.get(n);if(!a)return;if(!o)return;const s={type:"reducer",userId:i.currentUser.id,userTimeZone:(0,ei.r)(),searchQuery:void 0,reducers:{[Ln.SF]:a,[Ln.YE]:o}},r=null===(e=t.getParentBlockStore())||void 0===e?void 0:e.getCollectionViewStores()[0],l=t.getSpaceId();if(!r)return;const d=await oi.queryCollection(i,{source:{type:"collection",id:t.id,spaceId:l},collectionView:{id:r.id,spaceId:l},loader:s},void 0,{src:"sprint_status_overlay_check"});if("success"!==d.type)return;const c=d.data.result.reducerResults[Ln.SF],u=d.data.result.reducerResults[Ln.YE];return"results"===c.type&&"results"===u.type?{hasCurrentSprint:c.blockIds.length>0,hasNextSprint:u.blockIds.length>0}:void 0}),[i,n,t]);if("resolved"!==o||!a)return;return a}({sprintCollectionStore:(0,r.VK)((()=>{const e=t.state;if(e.isOpen)return e.store.getAssociatedCollectionStore()}),[t]),environment:i,normalizedBlockSchema:a}),d=(0,w.useIntl)(),c=(0,o.useCallback)((e=>void 0===l&&[Ln.YE,Ln.SF].includes(e)?{disabled:!0}:e===Ln.YE&&null!=l&&l.hasNextSprint?{disabled:!0,disableReasonMessage:d.formatMessage(Wn.cannotSetSprintToNextTooltip)}:e===Ln.SF&&null!=l&&l.hasCurrentSprint?{disabled:!0,disableReasonMessage:d.formatMessage(Wn.cannotSetSprintToCurrentTooltip)}:{disabled:!1}),[l,d]);return o.createElement(Un,se()({},e,{shouldDisableOption:c}))}var zn=i(65187),Gn=i(4308);function qn(e){const{onClick:t}=e;return a()(te.Z,{topBorder:!0},void 0,a()(me.Z,{focused:!1,icon:Ie.Z.close({width:14,marginLeft:0}),title:a()(w.FormattedMessage,{defaultMessage:"Remove verification",id:"VerificationPropertyOverlayMenu.removeVerificationButton"}),onClick:t,style:{fontSize:14}}))}var Hn=i(66653),jn=i(93289);const Qn=(0,w.defineMessages)({placeholder:{id:"VerificationExpiryMenu.pickSpecificDate.placeholder",defaultMessage:"Pick a date"}});function Yn(e){window.__c={n:"VerificationCustomDatePicker"};const{onChange:t,clearCustomDatePicker:i}=e,n=(0,o.useRef)(e.today),s=(0,o.useRef)(e.today.plus({days:1})),[l,d]=(0,o.useState)(!1),c=(0,r.VK)((()=>He.AK.state),[]);return a()(te.Z,{mobileStyle:{paddingBottom:10},style:{padding:"12px 0"}},void 0,a()(Hn.Z,{placeholder:ce.default.formatMessage(Qn.placeholder),focused:l,value:"verified"!==e.verificationState.type||e.verificationState.isIndefinite?void 0:Ai.ME(e.verificationState.dateTimeRange.end),onUpdate:e=>{if(e.error)return;const a=e.value&&Ai.XI(e.value);a?t({start:n.current,end:a.start}):i()},onFocus:()=>d(!0),onBlur:()=>d(!1),onClearButtonClick:i,hideClearButton:!0}),a()(jn.Z,{firstDayOfWeek:c,value:s.current.toMillis(),selectValue:!1,onChange:e=>{t({start:n.current,end:Zi.ou.fromMillis(e)})},disabledDays:{before:new Date(s.current.toMillis())}}))}var $n=i(70693);function Xn(e){window.__c={n:"VerificationExpiryPickerMenu"};const{verificationState:t,onChange:i,onCustomDateClick:n}=e,s=(0,w.useIntl)(),r=(0,o.useRef)(e.today),l=(0,Ce.yK)((e=>({title:{fontSize:14,color:e.regularTextColor},optionsContainer:{width:"100%"},clockIconStyle:{width:14,marginLeft:0,marginTop:2}})),[]),d="expired"===t.type||"none"===t.type?a()(w.FormattedMessage,{defaultMessage:"Verify page",id:"VerificationExpiryPicker.verify.header"}):a()(w.FormattedMessage,{defaultMessage:"Reverify page",id:"VerificationExpiryPicker.reverify.header"}),c="verified"===t.type&&t.isIndefinite,u="verified"===t.type&&!t.isIndefinite&&t.dateTimeRange.end;return a()(te.Z,{title:d},void 0,Gn.Xs.map((e=>{const t=u&&Gn.fm({start:r.current,end:u})===e;return a()(me.Z,{focused:!1,icon:Ie.Z.alarmClock(l.clockIconStyle),inline:!1,title:a()("span",{style:l.title},void 0,a()(w.FormattedMessage,{defaultMessage:"For {numDays} days",id:"VerificationExpiryMenu.preset.title",values:{numDays:e}})),caption:s.formatMessage({defaultMessage:"Until {date}",id:"VerificationExpiryMenu.preset.subtitle"},{date:$n.mb({dateTime:Gn.z5(e,r.current).end,intl:s,shortenDateAndRange:!0})}),checkState:!!t,onClick:()=>{return t=e,void i({start:r.current,end:r.current.plus({days:t})});var t}},e)})),a()(me.Z,{focused:!1,icon:Ie.Z.infinity({width:14,marginLeft:0,marginTop:1}),inline:!1,title:a()("span",{style:l.title},void 0,a()(w.FormattedMessage,{defaultMessage:"Indefinitely",id:"VerificationExpiryPicker.option.indefinitely"})),onClick:()=>i(),checkState:c},"indefinite"),a()(me.Z,{focused:!1,icon:Ie.Z.calendar({width:14,marginLeft:0}),title:a()("span",{style:l.title},void 0,a()(w.FormattedMessage,{defaultMessage:"Pick a date",id:"VerificationExpiryPicker.option.customDate"})),onClick:n},"custom"))}function Jn(e){window.__c={n:"VerificationMetadata"};const{getRecordValue:t,actorPointer:i,lastVerifiedDate:n}=e,o=(0,s.Fy)(),l=(0,w.useIntl)(),d=(0,r.VK)((()=>(0,Lt.$4)(l,(0,Lt.Hl)({pointer:i,getRecordValue:t}))),[t,l,i]);return a()("div",{style:{padding:"8px 14px"}},void 0,a()(Se.Z,{isSmall:!0,isSecondaryColor:!0,isMobile:o.isMobile,isMultiline:!0,style:{marginBottom:4}},void 0,a()(w.FormattedMessage,{defaultMessage:"Last verified by {user}",id:"VerificationMetadata.lastVerified",values:{user:d}})),a()(Se.Z,{isSmall:!0,isSecondaryColor:!0,isMobile:o.isMobile},void 0,(0,$n.mb)({dateTime:n,intl:l})))}var ea=i(11028);function ta(e){window.__c={n:"VerificationPropertyOverlayMenu"};const{verificationValue:t,getRecordValue:i,onChange:n,blockId:r,propertyName:l,onClose:d}=e,c=(0,s.O7)(),u=(0,s.Fy)(),m=(0,Ce.Fg)(),[p,g]=(0,o.useState)(!1),h=(0,o.useMemo)((()=>Gn.WN(t)),[t]),f="verified"===h.type,v=(0,o.useRef)(Ai.Uu((0,ei.r)())),y=(0,o.useRef)(Ai.Uu((0,ei.r)()).plus({days:1})),S=e=>{var t;const i=null===(t=c.currentUser)||void 0===t?void 0:t.id;if(!i)return;if(null!=e&&e.end&&e.end.toMillis()<y.current.toMillis())return;const a={table:Nt.KJ,id:i},o=e?Ai.OQ.toPersistedDateTimeRange(e):Ai.OQ.toPersistedDateTime(v.current.toMillis()),s="none"===h.type?"add":"update";K.s$$(c,{action:s,verification_page_id:r,verification_expiry:e?e.end.toMillis():void 0}),n({value:[a,o]})};let b={menuType:_.og.Popup,footer:"none"!==h.type&&a()("div",{style:{borderTop:`1px solid ${m.regularDividerColor}`}},void 0,a()(Jn,{lastVerifiedDate:f&&h.isIndefinite?h.startDateTime:h.dateTimeRange.start,getRecordValue:i,actorPointer:h.actorPointer}))};return u.isMobile&&(b={...b,title:l,menuType:_.og.Modal,right:a()(A.DoneMenuText,{}),onClickRight:d}),o.createElement(F.Z,se()({},b,{header:!p&&"none"!==h.type&&o.createElement(o.Fragment,null,a()("div",{style:{padding:u.isMobile?10:7,paddingLeft:u.isMobile?20:7,background:u.isMobile?m.popoverBackground:m.tokenInputMenuItemBackground,display:"flex",alignItems:"center",borderBottom:`1px solid ${m.regularDividerColor}`}},void 0,a()(ea.z,{verificationValue:t})))}),p?a()(Yn,{today:v.current,verificationState:h,onChange:e=>S(e),clearCustomDatePicker:()=>g(!1)}):o.createElement(o.Fragment,null,a()(Xn,{today:v.current,verificationState:h,onChange:e=>S(e),onCustomDateClick:()=>g(!0)}),(f||"expired"===h.type)&&a()(qn,{onClick:()=>{K.s$$(c,{action:"remove",verification_page_id:r}),n({value:void 0})}})))}var ia=i(32056),na=i(83197);class aa extends b.Z{constructor(){super(...arguments),this.storeTypes={inputStore:xn.Z},this.handleInputChange=e=>{const t=e.target.value;this.stores.inputStore.setState({...this.stores.inputStore.state,inputValue:t}),this.props.onChange(this.parseInputChange(t))}}willMount(e){super.willMount(e);const{value:t,format:i,insertChar:n,intl:a}=e;n?(this.stores.inputStore.setState({...this.stores.inputStore.state,inputValue:n}),this.props.onChange(this.parseInputChange(n))):this.stores.inputStore.setState({...this.stores.inputStore.state,inputValue:ia.uf(t,i,a)||""})}renderComponent(){const{disabled:e}=this.props;return a()(x.Z,{capture:!e,onDelete:U().identity,onSpace:U().identity,onBackspace:U().identity,onLeft:U().identity,onRight:U().identity,onUp:U().identity,onDown:U().identity,onSelectAll:U().identity,onRedo:U().identity,onUndo:U().identity,onCut:U().identity,onCopy:U().identity,onPaste:U().identity,onKeypress:U().identity},void 0,a()(ye.Z,{style:{...na.F,display:"block"},value:this.stores.inputStore.state.inputValue,format:ye.Z.Format.Transparent,onChange:this.handleInputChange,inputStyle:this.getInputStyle(),focus:!e,disabled:e}))}getInputStyle(){const{isTable:e}=this.props;return{textAlign:e?"right":"left"}}parseInputChange(e){this.stores.inputStore.setState({...this.stores.inputStore.state,inputValue:e});let t=ia.p3(e);return"percent"===this.props.format&&void 0!==t&&(t/=100),t}}aa.displayName="NumberPropertyValue";const oa=(0,w.injectIntl)(aa);class sa extends b.Z{constructor(){super(...arguments),this.storeTypes={inputStore:xn.Z},this.handleInputChange=e=>{const{onChange:t}=this.props,i=e.target.value;this.stores.inputStore.setState({...this.stores.inputStore.state,inputValue:i}),t(i)}}willMount(e){super.willMount(e);const{value:t}=e;this.stores.inputStore.setState({...this.stores.inputStore.state,inputValue:t||""})}renderComponent(){const{disabled:e}=this.props;return a()(x.Z,{capture:!e,onDelete:U().identity,onSpace:U().identity,onBackspace:U().identity,onLeft:U().identity,onRight:U().identity,onUp:U().identity,onDown:U().identity,onSelectAll:U().identity,onRedo:U().identity,onUndo:U().identity,onCut:U().identity,onCopy:U().identity,onPaste:U().identity,onKeypress:U().identity},void 0,a()(ye.Z,{type:this.props.inputType,style:{...na.F,display:"block"},value:this.stores.inputStore.state.inputValue,format:ye.Z.Format.Transparent,onChange:this.handleInputChange,focus:!e,disabled:e}))}}sa.displayName="URLPropertyValue";const ra=sa;var la=i(78030),da=i(64964),ca=i(45145),ua=i(68709),ma=i(24118);function pa(e,t){const i=(0,s.O7)(),n=(0,w.useIntl)(),[a,l]=(0,o.useState)(),[d,c]=(0,o.useState)(!1),u=(0,r.VK)((()=>{const n=_e.q3(t);return!(0,ma.bb)({store:e.store,schema:e.store.getSchema(),property:e.property,userId:i.currentUser.id})&&(null==n?void 0:n.auto_update_on_edit)&&!d}),[e.property,e.store,t,d,i]),m=(0,o.useCallback)((()=>{l(void 0)}),[]),p=(0,o.useCallback)((e=>{We.V2({environment:i,feedbackType:e.type,userContent:e.userContent,shareWithNotion:e.shareWithNotion}),c(!0),da.oV({label:n.formatMessage({id:"database.propertyValues.submitAIAutofillFeedbackThanks",defaultMessage:"Thank you for making Notion better!"})})}),[i,n]);return{feedbackState:a,setFeedbackState:l,handleFeedbackButtonDismiss:m,handleFeedbackButtonSubmit:p,shouldDisplayFeedbackButtons:Boolean(u)}}function ga(e){let{autofillBlockPropertyValueFeedbackButtonsState:t}=e;window.__c={n:"AutofillBlockPropertyValueFeedbackButtons"};const i=(0,s.O7)(),n=(0,Ce.yK)((()=>({iconButtonStyles:{height:i.device.isMobile?24:28,width:i.device.isMobile?24:28}})),[i.device.isMobile]);return a()(o.Fragment,{},void 0,a()(ca.d,{type:"thumbsup",ariaLabel:"thumbs-up",onClick:()=>{t.setFeedbackState({type:"thumbsup",userContent:"",shareWithNotion:!0})},feedbackState:t.feedbackState,onDismiss:t.handleFeedbackButtonDismiss,onSubmit:t.handleFeedbackButtonSubmit,onUpdate:t.setFeedbackState,showShareDataPopup:!1,onDataShareSubmit:U().noop,userOptIn:!1,iconButtonStyles:n.iconButtonStyles}),a()(ca.d,{type:"thumbsdown",ariaLabel:"thumbs-down",onClick:()=>{t.setFeedbackState({type:"thumbsdown",userContent:"",shareWithNotion:!0})},feedbackState:t.feedbackState,onDismiss:t.handleFeedbackButtonDismiss,onSubmit:t.handleFeedbackButtonSubmit,onUpdate:t.setFeedbackState,showShareDataPopup:!1,onDataShareSubmit:U().noop,userOptIn:!1,iconButtonStyles:n.iconButtonStyles}))}function ha(e){let{overlayState:t,theme:i,propertySchema:n}=e;window.__c={n:"AutofillUpdateButtonSection"};const o=(0,r.VK)((()=>et.W.isWriting()),[]),l=(0,s.O7)(),d=pa(t,n);return l.device.isMobile||o?null:a()(ua.p,{allowSelectionWithin:!1},void 0,a()("div",{style:{position:"absolute",top:-36,right:0,borderRadius:5,fontSize:14,lineHeight:1.2,display:"flex",whiteSpace:"nowrap",background:i.popoverBackground,boxShadow:i.mediumBoxShadow,zIndex:-1,padding:2}},void 0,a()(fa,{overlayState:t,propertySchema:n}),d.shouldDisplayFeedbackButtons&&a()(ga,{autofillBlockPropertyValueFeedbackButtonsState:d})))}function fa(e){let{overlayState:t,propertySchema:i}=e;window.__c={n:"AutofillUpdateButton"};const n=(0,s.O7)(),o=(0,Ce.yK)((e=>({buttonStyle:{display:"flex",height:28},iconStyle:{height:16,width:16,fill:e.aiPurpleColor},updateTextStyle:{fontWeight:500,color:e.aiPurpleColor}})),[]);return a()(rt.Z,{style:o.buttonStyle,onClick:()=>{i&&We.CA({environment:n,stores:[t.store],property:t.property,propertySchema:i,userEventForAnalytics:"generate_from_overlay_button",collectionContextStore:t.collectionContextStore,from:je.Sy(t.format)})}},void 0,a()(nt.X2,{gap:4},void 0,Ie.Z.magicWand(o.iconStyle),a()("span",{style:o.updateTextStyle},void 0,a()(w.FormattedMessage,{defaultMessage:"Update",id:"database.propertyValues.reGenerateAiAutofill"}))))}function va(e){let{overlayState:t,propertySchema:i,showSeparator:n}=e;window.__c={n:"AutofillBlockPropertyValueOverlayFeedbackButtonsMobile"};const s=pa(t,i),r=(0,Ce.yK)((e=>({dot:{color:e.lightTextColor}})),[]);return s.shouldDisplayFeedbackButtons?o.createElement(o.Fragment,null,n?a()("div",{style:r.dot},void 0,"•"):null,a()(ga,{autofillBlockPropertyValueFeedbackButtonsState:s})):null}class ya extends b.Z{constructor(){super(...arguments),this.previousPopupProps=void 0,this.renderOverlay=()=>{const e=this.props.store.state;if(e.isOpen)return a()(x.Z,{capture:!0,onTab:this.handleTab,onUntab:this.handleUntab,onEnter:this.handleEnter,onDelete:U().identity,onBackspace:U().identity},`${e.store.id}${e.property}`,a()(qe.L1,{value:e.collectionContextStore},void 0,this.renderAutofillUpdateButton(e),a()("div",{style:{display:"flex",flexDirection:"column",overflowY:"auto",flexGrow:1}},void 0,this.renderOverlayContent(e))))},this.renderTitle=(e,t)=>{const{clonedStore:i}=e;return a()(at.Z,{capture:!0,ignoreBlockSelection:!0,restoreSelection:!0,focusOffscreenInput:!1,render:()=>a()("div",{style:ya.titleStyle},void 0,a()(zn.Z,{store:i.getTitleStore()||i.getPropertyStore(e.property),disableSlashCommands:!0,onEnter:this.handleEnter,onEsc:this.handleEsc,onTab:this.handleTab,onUntab:this.handleUntab,disableSelectAllBlocks:!0,disableSelectionDrag:!0,disableStyleAnnotations:!0,disableShiftEnter:!0,onChange:()=>this.handleTextChange(e,t),disabled:this.isDisabled(e),pasteBehavior:"inline"}))})},this.aiAutofillExplanationTextIfAIProperty=e=>{var t;const i=this.getNormalizedPropertySchema(e),n=(0,_e.q3)(i);if(!(0,Ye.Zt)(this.environment))return!1;if(et.W.isWriting())return a()(Se.Z,{isSecondaryColor:!0,style:{fontSize:12,color:this.theme.aiPurpleColor,display:"flex",alignItems:"inline",fontWeight:500,marginTop:6,marginBottom:2},isSmall:!0,isMultiline:!0},void 0,a()(w.FormattedMessage,{defaultMessage:"AI is writing",id:"BlockPropertyValueOverlay.AIActionText.overlay"}),a()("div",{style:{marginLeft:4}},void 0,a()(ot.Z,{})));const o=(0,Ye.RT)(this.environment,null===(t=this.pageContext)||void 0===t?void 0:t.publicEditModeStore.state,e.store);return null!=n&&n.auto_update_on_edit?a()("div",{style:{display:"flex",alignItems:"center",marginTop:6,marginBottom:2}},void 0,a()(Se.Z,{isSecondaryColor:!0,style:{fontSize:12},isSmall:!0,isMultiline:!0},void 0,a()(w.FormattedMessage,{defaultMessage:"Auto-updated by AI",id:"BlockPropertyValueOverlay.helpText.overlay"})),this.environment.device.isMobile&&o&&a()("div",{style:{paddingLeft:2,display:"flex",alignItems:"center"}},void 0,a()("div",{style:{color:this.theme.lightTextColor}},void 0,"•"),a()(Sa,{overlayState:e,propertySchema:i,style:{paddingLeft:2,paddingRight:2}}),a()(va,{overlayState:e,propertySchema:i,showSeparator:!0}))):this.environment.device.isMobile&&n&&o?a()(Sa,{overlayState:e,propertySchema:i,style:{marginTop:6,marginBottom:2}}):void 0},this.handleBulkAutofillClick=(e,t)=>{const{collectionsBulkActionsToolbarStore:i}=e;if(i)if(t){const t=i.state.textStoresBeingEdited;if(!(0,Ee.Of)(t))return;const n=this.getNormalizedPropertySchema(e);if(!n)return;We.CA({environment:this.environment,stores:t,property:e.property,propertySchema:n,userEventForAnalytics:"generate_from_overlay_button",isBulkAction:!0,from:je.Sy(e.format),collectionContextStore:e.collectionContextStore})}else We.qg({environment:this.environment,from:"ai_autofill_bulk_fill"})},this.bulkAutofillButton=e=>{var t;const{store:i,collectionsBulkActionsToolbarStore:n}=e,o=this.getNormalizedPropertySchema(e),s=null==o?void 0:o.name;if((0,Ye.RT)(this.environment,null===(t=this.pageContext)||void 0===t?void 0:t.publicEditModeStore.state,i)&&(0,_e.q3)(o)&&n){var r;const t=n.getNumberOfTextStoresBeingEdited(),i=(null===(r=it.default.state.data)||void 0===r?void 0:r.addOns)??[],o=(0,xe.de)(i)||t<=5;return a()(rt.Z,{style:{width:"100%",height:"auto",borderTop:`1px solid ${this.theme.regularDividerColor}`},onClick:()=>this.handleBulkAutofillClick(e,o)},void 0,a()(nt.X2,{gap:8,padding:8,alignItems:"start"},void 0,Ie.Z.magicWand({width:18,fill:this.theme.aiPurpleColor}),a()(nt.sg,{gap:4},void 0,a()("div",{style:{fontSize:14,whiteSpace:"normal"}},void 0,a()(w.FormattedMessage,s?{defaultMessage:'Update "{propertyName}" with AI',id:"BlockPropertyValueOverlay.bulkAiAutofillButton.titleWithPropertyName",values:{propertyName:s}}:{defaultMessage:"Update with AI",id:"BlockPropertyValueOverlay.bulkAiAutofillButton.title"})),a()("div",{style:{fontSize:12,color:this.theme.mediumTextColor,whiteSpace:"normal",lineHeight:"1.4em"}},void 0,a()(w.FormattedMessage,o?{defaultMessage:"{numPages, select, 1 {Update {numPages} page} other {Update {numPages} pages}}",id:"BlockPropertyValueOverlay.bulkAiAutofillButton.countAndDescription",values:{numPages:t}}:{defaultMessage:"Get the AI add-on to update more than {maxItems} pages at once",id:"BlockPropertyValueOverlay.bulkAiAutofillButton.largeBulkFillUpsellMessage",values:{maxItems:5}})))))}},this.renderText=(e,t)=>{var i;const{clonedStore:n}=e,s=this.getNormalizedPropertySchema(e);let r;return"text"===(null==s?void 0:s.type)&&null!==(i=s.ai_inference)&&void 0!==i&&i.auto_update_on_edit&&(r="Empty"),a()(at.Z,{capture:!0,ignoreBlockSelection:!0,restoreSelection:!0,focusOffscreenInput:!1,render:()=>o.createElement(o.Fragment,null,a()("div",{style:na.F},void 0,a()(zn.Z,{store:n.getPropertyStore(e.property),disableSlashCommands:!0,onEnter:this.handleEnter,onEsc:this.handleEsc,onTab:this.handleTab,onUntab:this.handleUntab,disableSelectAllBlocks:!0,disableSelectionDrag:!0,onChange:()=>this.handleTextChange(e,t),disabled:this.isDisabled(e),pasteBehavior:"inline",placeholder:r}),this.aiAutofillExplanationTextIfAIProperty(e)),this.bulkAutofillButton(e))})},this.renderURL=(e,t)=>{const i=ke.zB(this.getPropertyValue(e));let n="url";return"phone_number"===t?n="tel":"email"===t&&(n="email"),a()(ra,{value:i,inputType:n,disabled:this.isDisabled(e),onChange:this.handleURLValueChange,onDismiss:this.close})},this.renderNumber=e=>{const t=e.format===la.C.Table,i=ke.VY(this.getPropertyValue(e)),n=this.getNormalizedPropertySchema(e);if(n&&"number"===n.type)return a()(oa,{value:i,isTable:t,format:n.number_format||"number",disabled:this.isDisabled(e),insertChar:e.insertChar,onChange:this.handleNumberValueChange})},this.renderSelect=e=>{const t=this.getSchema(e),i=this.getCollectionStore(e),n=this.getNormalizedPropertySchema(e);if(!i||!n||"select"!==n.type)return;const o=n.options||[],s=ke.Sj(this.getPropertyValue(e),o);return a()(Rn,{allowMultiple:!1,value:s?[s]:[],property:e.property,collectionId:i.id,schema:t,disabled:this.isDisabled(e),canConfigureCollection:this.canConfigureCollection(e),onChange:this.handleSelectPropertyMenuUpdate,analyticsFrom:this.getAnalyticsFrom(e),insertChar:e.insertChar,onAccept:this.handleSelectPropertyMenuAccept,onDismiss:this.close})},this.renderMultiSelect=e=>{const t=this.getSchema(e),i=this.getCollectionStore(e),n=this.getNormalizedPropertySchema(e);if(!i||!n||"multi_select"!==n.type)return;const o=n.options||[],s=ke.uP(this.getPropertyValue(e),o);return a()(Rn,{allowMultiple:!0,value:s,property:e.property,collectionId:i.id,schema:t,disabled:this.isDisabled(e),canConfigureCollection:this.canConfigureCollection(e),onChange:this.handleSelectPropertyMenuUpdate,analyticsFrom:this.getAnalyticsFrom(e),insertChar:e.insertChar,onAccept:this.handleSelectPropertyMenuAccept,onDismiss:this.close})},this.renderStatus=e=>{const t=this.getCollectionStore(e),i=this.getNormalizedPropertySchema(e);if(!t||!i||"status"!==i.type)return;const n={initialValue:ke.ZG(this.getPropertyValue(e),i),property:e.property,propertySchema:i,disabled:this.isDisabled(e),onDismiss:this.close,onChange:e=>{this.handleSelectPropertyMenuUpdate({value:e?[e]:[]})},onAccept:this.handleSelectPropertyMenuAccept,blockPropertyValueOverlayStore:this.props.store};return e.property===Te.b0.StatusV2?o.createElement(Kn,n):o.createElement(Un,n)},this.renderPerson=e=>{const t=this.getSchema(e),i=this.getNormalizedPropertySchema(e);if(!i||"person"!==i.type)return;const n=ke.DW({textValue:this.getPropertyValue(e),propertySchema:i});return a()(jt,{value:n,property:e.property,schema:t,disabled:this.isDisabled(e),onChange:this.handlePersonPropertyMenuUpdate,insertChar:e.insertChar,onDismiss:this.close,parentStore:e.store})},this.renderRelation=e=>{const t=this.getSchema(e),i=ke.rq(this.getPropertyValue(e)),n=this.getCollectionStore(e);if(n)return a()(Mn,{value:i,property:e.property,collectionStore:n,schema:t,disabled:this.isDisabled(e),canConfigureCollection:this.canConfigureCollection(e),onChange:this.handleRelationPropertyMenuUpdate,analyticsFrom:this.getAnalyticsFrom(e),insertChar:e.insertChar,onDismiss:this.close,blockStore:e.store,blockPropertyValueOverlayStore:this.props.store,overlayMode:e.mode})},this.renderRollup=e=>{const t=this.getSchema(e);return a()(Cn.Z,{context:Cn.t.BlockPropertyOverlay,property:e.property,schema:t,disabled:this.isDisabled(e)||!this.canConfigureCollection(e)||this.isTypedPropertyStore.state,onChange:this.handleRollupPropertyMenuUpdate,parentStore:e.store,analyticsFrom:this.getAnalyticsFrom(e),onDismiss:this.close})},this.renderDate=e=>{const t=this.getNormalizedPropertySchema(e);if(!t||"date"!==t.type)return;const i=ke.Gl(this.getPropertyValue(e));return a()(d.DependencyConsumer,{dependency:d.deps.menus},void 0,(n=>{let{DatePropertyMenu:o}=n;return a()(o,{firstDayOfWeek:He.AK.state,value:i,onChangeValue:this.handleDatePropertyValueChange,dateFormat:t.date_format,onChangeDateFormat:this.handleDatePropertyDateFormatChange,timeFormat:t.time_format,disabled:this.isDisabled(e),canConfigureCollection:this.canConfigureCollection(e),onChangeTimeFormat:this.handleDatePropertyTimeFormatChange,onDismiss:this.close,shouldShowReminder:!0})}))},this.renderFile=e=>{const t=this.getSchema(e),i=ke.g(this.getPropertyValue(e));return a()(Bt,{store:e.store,value:i,property:e.property,schema:t,onDismiss:this.close,uploadFiles:e.uploadFiles,disabled:this.isDisabled(e),onChange:t=>{Ge.createAndCommit({userAction:"BlockPropertyValueOverlay.renderFile",environment:this.environment,perform:i=>{if(De.z4(t.schema)||this.setSchema(t.schema,i),!De.z4(t.value)){const n=ke.CC(t.value);for(const t of this.getPropertyStores(e))Ke.sO({store:t,value:n,transaction:i});this.trackEditPropertyValue(e)}}})}})},this.renderFormula=e=>{const{device:t}=this.environment,n=this.getSchema(e),{store:o}=e,s=o.getValue(),r=this.getCollectionStore(e),l=this.getNormalizedPropertySchema(e),c=this.isDisabled(e)||!this.canConfigureCollection(e)||this.isTypedPropertyStore.state;if((0,$e.formulasPrototypeEnabled)()){if(s&&r&&l&&"formula"===l.type)return a()(d.DependencyConsumer,{dependency:d.deps.formulas},void 0,(t=>a()(Dt.Z,{handleClose:this.close,property:e.property,getRecordValue:o.getRecordValue,propertySchema:l,collectionStore:r,handleSave:this.handleFormula2CodeChange,formulas:t,disabled:c,blockStore:o})))}else if(s)return a()(Rt.Z,{fetch:()=>i.e(71).then(i.bind(i,73240)),loading:e=>t.isMobile?a()(F.Z,{menuType:_.og.Modal,title:a()(w.FormattedMessage,{defaultMessage:"Formula",id:"database.propertyValues.mobileFormulaMenu.title"}),left:a()(A.CancelMenuText,{}),onClickLeft:this.handleFormulaPropertyMenuCancelClick},void 0,a()("div",{style:{width:"100%",paddingTop:"2em",display:"flex",alignItems:"center",justifyContent:"center"}},void 0,e&&a()(st.Z,{}))):a()("div",{style:{height:358,width:580,display:"flex",alignItems:"center",justifyContent:"center"}},void 0,e&&a()(st.Z,{})),render:t=>{let{default:i}=t;return a()(i,{property:e.property,exampleBlock:s,disabled:c,schema:n,onChange:this.handleFormulaPropertyMenuUpdate,onClickCancel:this.handleFormulaPropertyMenuCancelClick,analyticsFrom:this.getAnalyticsFrom(e)})}})},this.renderVerificationOverlay=e=>{const t=this.getNormalizedPropertySchema(e);if("verification"!==(null==t?void 0:t.type))return;const i=ke._w(this.getPropertyValue(e));return a()(ta,{propertyName:t.name,onChange:t=>{Ge.createAndCommit({userAction:"BlockPropertyValueOverlay.verification",environment:this.environment,perform:i=>{const n=ke.Tp(t.value);for(const t of this.getPropertyStores(e))Ke.sO({store:t,value:n,transaction:i});this.trackEditPropertyValue(e)}}),this.close()},verificationValue:i,getRecordValue:e.store.getRecordValue,blockId:e.store.id,onClose:()=>this.close()})},this.isTypedPropertyStore=this.createComputedStore((()=>{var e;const t=this.props.store.state;if(!t.isOpen)return!1;const i=null===(e=t.collectionContextStore)||void 0===e?void 0:e.collectionStore();if(!i)return!1;const n=t.property;return Boolean(i.getDatabaseType()&&i.isTypedProperty(n))})),this.renderFunctions={title:this.renderTitle,text:this.renderText,relation:this.renderRelation,rollup:this.renderRollup,select:this.renderSelect,multi_select:this.renderMultiSelect,status:this.renderStatus,person:this.renderPerson,number:this.renderNumber,date:this.renderDate,file:this.renderFile,url:this.renderURL,phone_number:this.renderURL,email:this.renderURL,formula:this.renderFormula,checkbox:void 0,created_by:void 0,created_time:void 0,last_edited_by:void 0,last_edited_time:void 0,last_visited_time:void 0,button:void 0,auto_increment_id:void 0,location:void 0,verification:this.renderVerificationOverlay},this.handleBgClick=()=>{Re.fG({environment:this.environment,blockPropertyValueOverlayStore:this.props.store})},this.handleEsc=()=>{Re.i2({environment:this.environment,blockPropertyValueOverlayStore:this.props.store})},this.handleTab=e=>{e.preventDefault(),Re.$o({environment:this.environment,blockPropertyValueOverlayStore:this.props.store})},this.handleUntab=e=>{e.preventDefault(),Re.RX({environment:this.environment,blockPropertyValueOverlayStore:this.props.store})},this.handleEnter=()=>{Re.gT({environment:this.environment,blockPropertyValueOverlayStore:this.props.store})},this.handleSelectPropertyMenuAccept=e=>{const t=this.props.store.state;if(!t.isOpen)return;const i=this.getNormalizedPropertySchema(t);!i||"select"!==i.type&&"status"!==i.type||we.default.afterNextFlush((()=>{e?Re.gT({environment:this.environment,blockPropertyValueOverlayStore:this.props.store}):Re.i2({environment:this.environment,blockPropertyValueOverlayStore:this.props.store})}))},this.handleSelectPropertyMenuUpdate=e=>{const t=this.props.store.state;t.isOpen&&Ge.createAndCommit({userAction:"BlockPropertyValueOverlay.handleSelectPropertyMenuUpdate",environment:this.environment,perform:i=>{if(De.z4(e.operations)||this.applyOperationsToSchema(e.operations,i),!De.z4(e.value)){const n=ke.zq(e.value);for(const e of this.getPropertyStores(t))Ke.sO({store:e,value:n,transaction:i});this.trackEditPropertyValue(t)}}})},this.handlePersonPropertyMenuUpdate=e=>{const t=this.props.store.state;t.isOpen&&Ge.createAndCommit({userAction:"BlockPropertyValueOverlay.handlePersonPropertyMenuUpdate",environment:this.environment,perform:i=>{if(De.z4(e.schema)||this.setSchema(e.schema,i),!De.z4(e.value)){const n=ke.C1(e.value);for(const e of this.getPropertyStores(t))Ke.sO({store:e,value:n,transaction:i});this.trackEditPropertyValue(t)}}})},this.handleRelationPropertyMenuUpdate=async e=>{const t=this.props.store.state;if(!t.isOpen)return;const i=this.getNormalizedPropertySchema(t);if(!i||"relation"!==i.type)return;const n="relation"===i.type&&_e.F0(i),a=n&&new Q.NW(this.environment,{table:Ze.v,id:n});a&&await a.load();const o=this.getSchema(t);Ge.createAndCommit({userAction:"BlockPropertyValueOverlay.handleRelationPropertyMenuUpdate",environment:this.environment,perform:i=>{if(e.newPage&&n&&a){const n=Fe.TP(e.newPage.name),o=a.getRootPagePointer(),s=o??a.pointer,r={id:e.newPage.id,version:0,type:M.Ti.page,parent_id:s.id,parent_table:s.table,properties:{title:n},alive:!0,collection_id:void 0,space_id:e.newPage.spaceId},l=Ke.ae({environment:this.environment,table:Pe.iU,value:r,inMemoryRecordCache:t.store.inMemoryRecordCache,transaction:i});if(o){const e=new Q.G(this.environment,{table:o.table,id:o.id}),t=new Q.G(this.environment,{table:Pe.iU,id:r.id});Ue.jG({parentStore:e,childStore:t,transaction:i})}const d=a.getDefaultTemplatePageStore();d&&Oe.ob({title:{text:n},environment:this.environment,store:Q.G.createChildStore(a,l.pointer),templateStore:d,isKeyboard:!1,isCreateIn:!1,transaction:i,from:"relation_property_menu_update"})}if(e.value){for(const n of this.getAllEditStores(t))ze.tG({environment:this.environment,store:n,pointers:e.value,propertyId:t.property,transaction:i});this.trackEditPropertyValue(t)}if(e.rollupPropertyId&&e.rollupPropertySchema){const t={...o,[e.rollupPropertyId]:e.rollupPropertySchema};this.setSchema(t,i)}}}),e.rollupPropertyId&&(await we.default.afterNextFlush(),Re.mm({environment:this.environment,blockPropertyValueOverlayStore:this.props.store,openProperty:e.rollupPropertyId}))},this.handleDatePropertyValueChange=e=>{const t=this.props.store.state;t.isOpen&&Ge.createAndCommit({userAction:"BlockPropertyValueOverlay.handleDatePropertyValueChange",environment:this.environment,perform:i=>{for(const n of this.getAllEditStores(t))Le.xD({environment:this.environment,store:n,type:"dateValue",dateValue:e,propertyId:t.property,transaction:i});e||Re.i2({environment:this.environment,blockPropertyValueOverlayStore:this.props.store}),this.trackEditPropertyValue(t)}})},this.handleDatePropertyDateFormatChange=e=>{const t=this.props.store.state;if(!t.isOpen)return;const i=this.getNormalizedPropertySchema(t);if(!i||"date"!==i.type)return;const n=this.getSchema(t),a={...i,date_format:e},o={...n,[t.property]:a};var s;(Ge.createAndCommit({userAction:"BlockPropertyValueOverlay.handleDatePropertyDateFormatChange",environment:this.environment,perform:e=>{this.setSchema(o,e)}}),a)&&(this.getAnalyticsFrom(t),K.$qu(this.environment,{property_type:a.type,action:"date_change_format",from:this.getAnalyticsFrom(t),collection_id:null===(s=this.getCollectionStore(t))||void 0===s?void 0:s.id}))},this.handleDatePropertyTimeFormatChange=e=>{const t=this.props.store.state;if(!t.isOpen)return;const i=this.getNormalizedPropertySchema(t);if(!i||"date"!==i.type)return;const n=this.getSchema(t),a={...i,time_format:e},o={...n,[t.property]:a};var s;(Ge.createAndCommit({userAction:"BlockPropertyValueOverlay.handleDatePropertyTimeFormatChange",environment:this.environment,perform:e=>{this.setSchema(o,e)}}),a)&&(this.getAnalyticsFrom(t),K.$qu(this.environment,{property_type:a.type,action:"date_change_format",from:this.getAnalyticsFrom(t),collection_id:null===(s=this.getCollectionStore(t))||void 0===s?void 0:s.id}))},this.handleFormula2CodeChange=e=>{const{newValue:t,newType:i,propertySchema:n,property:a,collectionStore:o}=e,s=t?{...n,formula2:{code:t,result_type:i},version:"v2"}:{...n,formula2:void 0,version:"v2"};Ge.createAndCommit({userAction:"CollectionSettingsFormulaOptions.handleFormulaChange",environment:this.environment,perform:e=>{Ve.xO({environment:this.environment,collectionStore:o,update:{[a]:s},transaction:e})}})},this.handleFormulaPropertyMenuUpdate=e=>{let{propertySchema:t,close:i}=e;const n=this.props.store.state;n.isOpen&&(Ge.createAndCommit({userAction:"BlockPropertyValueOverlay.handleFormulaPropertyMenuUpdate",environment:this.environment,perform:e=>{this.updateSchema({[n.property]:t},e)}}),i&&this.close())},this.handleNumberValueChange=e=>{const t=this.props.store.state;if(!t.isOpen)return;const i=ke.eP(e);Ge.createAndCommit({userAction:"BlockPropertyValueOverlay.handleNumberValueChange",environment:this.environment,perform:e=>{for(const n of this.getPropertyStores(t))Ke.sO({store:n,value:i,transaction:e})}}),this.trackEditPropertyValue(t)},this.handleURLValueChange=e=>{const t=this.props.store.state;if(!t.isOpen)return;const i=ke.iD(e);Ge.createAndCommit({userAction:"BlockPropertyValueOverlay.handleURLValueChange",environment:this.environment,perform:e=>{for(const n of this.getPropertyStores(t))Ke.sO({store:n,value:i,transaction:e})}}),this.trackEditPropertyValue(t),K.bOx(this.environment,{pastedText:e,source:"url_property"})},this.handleTextChange=(e,t)=>{this.measurePropertyOverlayTypingLagUntilNextRender(e,t);const{store:i,property:n,additionalStores:a}=e,o=i.getPropertyStore(n).getValue();Ge.createAndCommit({userAction:"BlockPropertyValueOverlay.handleTextChange",environment:this.environment,perform:e=>{for(const t of a)Ke.sO({store:t.getPropertyStore(n),value:o,transaction:e})}}),this.trackEditPropertyValue(e)},this.handleRollupPropertyMenuUpdate=e=>{const t=this.props.store.state;t.isOpen&&Ge.createAndCommit({userAction:"BlockPropertyValueOverlay.handleRollupPropertyMenuUpdate",environment:this.environment,perform:i=>{this.updateSchema({[t.property]:e.propertySchema},i)}})},this.handleFormulaPropertyMenuCancelClick=()=>{this.props.store.setState({...this.props.store.state,isOpen:!1})},this.close=()=>{Re.xv({environment:this.environment,blockPropertyValueOverlayStore:this.props.store})}}willMount(e){super.willMount(e),this.trackRenderTime({isFirstRender:!0})}willUpdate(e){super.willUpdate(e),this.trackRenderTime({isFirstRender:!1})}renderComponent(){const{device:e}=this.environment,t=this.props.store.state;let i,n,a;if(t.isOpen){const o=t.format===la.C.Page,l=this.getNormalizedPropertySchema(t),d=l&&l.type,c=t.store.canEdit();let u=t.rect.top,m=t.rect.left,p=t.rect.width,g=t.rect.height;if(o?(m-=1,p+=1):(u-=1,m-=1,p+=1,g+=2),"number"===d)n={width:p};else if("date"===d)u+=g-1,n={};else if("relation"===d){const e=Mn.width;n={width:Math.max(e,p),minHeight:c?65:void 0,overflow:"hidden"}}else if("person"===d)n={width:Math.max(240,p),minHeight:c?100:void 0};else if("formula"===d)u+=g-1,n={borderRadius:8};else if("select"===d||"multi_select"===d)n={width:Math.max(300,p)};else if("rollup"===d)u+=g-1,n={};else if("text"!==d&&"title"!==d||!e.isMobile)if("file"===d)n={minWidth:Math.max(240,p)};else if("verification"===d)n={width:U().clamp(p,265,365)};else{const e=24+(this.shouldShowAutofillUpdateButton(t)?28:0);n={width:Math.max(240,p),minHeight:Math.min(g,window.innerHeight-e),maxHeight:window.innerHeight-e,overflow:"visible",display:"flex",flexDirection:"column"}}else{const e=tt.Z.estimatedNativeWebBottomOverlap()+24;a={overflowY:"auto",WebkitOverflowScrolling:"touch",width:Math.max(240,p),maxHeight:`calc(100vh - ${e}px)`}}const h=t.collectionContextStore;if(h){var s,r;const e=h.subitemTreeStore.state,i=(0,Ae.DY)(e.children,(e=>e.value.store===t.store)),a=null==i?void 0:i.length,o=null===(s=h.formatStore())||void 0===s||null===(s=s.getFormat())||void 0===s||null===(s=s.table_properties)||void 0===s?void 0:s.filter((e=>e.visible)),l=o&&(null===(r=o[0])||void 0===r?void 0:r.property)===t.property;a&&l&&(n={...n,...d&&_e.Yl(d)&&{width:Math.max(90,p)}})}i=new DOMRect(m,u,p,0)}if(t.isOpen||!this.previousPopupProps){const s=this.getPopupType(),r=!e.isMobile||s===N.ZP.PopupType.Popup,l={key:this.getPopupKey(),popupType:s,open:t.isOpen,originRect:i,style:e.isMobile?{width:n?n.width:void 0,...a}:n,alignmentToOrigin:N.ZP.Alignment.Start,placementToOrigin:N.ZP.Placement.Bottom,preventScaleTransition:r,preventOpacityTransition:r,render:this.renderOverlay,onDismiss:this.handleBgClick};return this.previousPopupProps=l,o.createElement(N.ZP,l)}{const e={...this.previousPopupProps,open:!1};return o.createElement(N.ZP,e)}}trackRenderTime(e){let{isFirstRender:t}=e;const i=this.props.store.state;if(!i.isOpen||!i.collectionContextStore)return;const n=Je.default.mark("collections.block_property_value_overlay_render");Je.default.measureAfterNextFlush(n,{environment:this.environment,getData:()=>{var e;return{...G.vS(i.collectionContextStore),is_first_render:t,property_type:null===(e=this.getNormalizedPropertySchema(i))||void 0===e?void 0:e.type,from:je.Sy(i.format)}}})}shouldShowAutofillUpdateButton(e){var t;const{store:i}=e,n=this.getNormalizedPropertySchema(e);return n&&(0,Ye.RT)(this.environment,null===(t=this.pageContext)||void 0===t?void 0:t.publicEditModeStore.state,i)&&_e.q3(n)&&!e.collectionsBulkActionsToolbarStore}renderAutofillUpdateButton(e){if(this.shouldShowAutofillUpdateButton(e))return a()(ha,{theme:this.theme,propertySchema:this.getNormalizedPropertySchema(e),overlayState:e})}renderOverlayContent(e){const t=this.getNormalizedPropertySchema(e);if(!t)return;const i=this.renderFunctions[t.type];return i?i(e,t.type):void 0}getPopupType(){const{device:e}=this.environment;if(e.isMobile){const e=this.props.store.state;if(!e.isOpen)return N.kQ.SlideUp;const t=this.getNormalizedPropertySchema(e);return t?na.m[t.type]:N.kQ.SlideUp}return N.kQ.Popup}getPopupKey(){const e=this.props.store.state;if(!e.isOpen)return"ignore";const t=this.getNormalizedPropertySchema(e);return t?t.type:"ignore"}measurePropertyOverlayTypingLagUntilNextRender(e,t){const i=Je.default.mark("collections.property_overlay_typing_lag");Je.default.measureAfterNextFlush(i,{environment:this.environment,getData:()=>({...G.vS(e.collectionContextStore),property_type:t,from:je.Sy(e.format)})})}getSchema(e){return e.store.getSchema()||{}}getNormalizedPropertySchema(e){return this.getSchema(e)[e.property]}getCollectionStore(e){return e.store.getAssociatedCollectionStore()}getPropertyStores(e){return this.getAllEditStores(e).map((t=>t.getPropertyStore(e.property)))}getPropertyValue(e){return e.store.getPropertyValue(e.property)}updateSchema(e,t){const i=this.props.store.state;if(i.isOpen&&i.isOpen){const n=this.getCollectionStore(i);n&&Ve.xO({environment:this.environment,collectionStore:n,update:e,transaction:t})}}setSchema(e,t){const i=this.props.store.state;if(i.isOpen&&i.isOpen){const n=this.getCollectionStore(i);n&&Ve.Rm({environment:this.environment,collectionStore:n,update:{schema:e},transaction:t})}}applyOperationsToSchema(e,t){const i=this.props.store.state;if(i.isOpen&&i.isOpen){const n=this.getCollectionStore(i);if(n){const i=n.getSchema();for(const o of e)Ge.applyOperation({store:(0,Q.Kv)(n,o.pointer),operation:o,transaction:t});const a=n.getSchema();Ve.C_({environment:this.environment,collectionStore:n,oldSchema:i,newSchema:a,transaction:t})}}}trackEditPropertyValue(e){const t=e.store.getType(),i=this.getNormalizedPropertySchema(e),{collectionContextStore:n}=e;t&&i&&n&&Ne.rv({environment:this.environment,collectionContextStore:n,block_id:e.store.id,property:e.property,property_type:i.type,from:this.getAnalyticsFrom(e),isFromBulkActionsToolbar:je.VM(this.props.store)})}getAnalyticsFrom(e){return je.Sy(e.format)}getAllEditStores(e){return[e.store,...e.additionalStores]}canConfigureCollection(e){const t=this.getCollectionStore(e),i=null==t?void 0:t.getParentBlockStore();return Qe.eD({collectionStore:t,collectionViewBlockStore:i,checkNavigableAncestorLocked:!1})}isDisabled(e){const t=this.getNormalizedPropertySchema(e),i=(0,_e.q3)(t);return!!(i&&i.auto_update_on_edit&&(0,Ye.Zt)(this.environment))||((0,Xe.N)(this.environment,e.store)||ke.wl(e.property))}}function Sa(e){let{overlayState:t,propertySchema:i,style:n}=e;window.__c={n:"AutofillUpdateMobileLink"};const o=(0,s.O7)(),r=(0,Ce.yK)((e=>({linkStyle:{color:e.aiPurpleColor,fontSize:12,...n}})),[n]);return a()("div",{style:r.linkStyle,onClick:()=>{i&&We.CA({environment:o,stores:[t.store],property:t.property,propertySchema:i,userEventForAnalytics:"generate_from_overlay_button",collectionContextStore:t.collectionContextStore,from:je.Sy(t.format)})}},void 0,a()(w.FormattedMessage,{defaultMessage:"Update",id:"database.propertyValues.reGenerateAiAutofill"}))}ya.displayName="BlockPropertyValueOverlay",ya.titleStyle={...na.F,fontWeight:Be.Z.fontWeight.medium};const ba=ya;var Ma=i(51454),wa=i(86080),Ca=i(81700),_a=i(53953),ka=i(63296);class Ta extends b.Z{constructor(){super(...arguments),this.lastOpenState=void 0,this.renderModal=()=>{if(!this.lastOpenState)return;const{acceptLabel:e,requiredInputValue:t}=this.lastOpenState,i=[{key:"accept",render:t=>o.createElement(ka.Z,se()({isRed:!0,isLarge:!0,style:Ta.buttonStyle,hovered:t.focused},t),e),action:this.handleAccept},{key:"cancel",render:e=>o.createElement(ka.Z,se()({isLarge:!0,style:Ta.buttonStyle,hovered:e.focused},e),a()(w.FormattedMessage,{id:"confirmationInputDialog.cancelButton.label",defaultMessage:"Cancel"})),action:this.handleCancel}];return a()(Z.Z,{capture:!0,preventType:T.Z.All},void 0,a()("div",{},void 0,a()("div",{style:{minHeight:64,display:"flex",alignItems:"center",justifyContent:"center",marginBottom:16}},void 0,this.lastOpenState.message),a()(x.Z,{capture:!0,onLeft:U().identity,onRight:U().identity,onSelectAll:U().identity,onRedo:U().identity,onUndo:U().identity,onToggleBold:U().identity,onToggleItalics:U().identity,onToggleCode:U().identity,onCut:U().identity,onCopy:U().identity,onPaste:U().identity,onKeypress:U().identity,onDelete:U().identity,onBackspace:U().identity},void 0,a()(ye.Z,{value:this.lastOpenState.inputValue,onChange:this.handleInputChange,style:{height:38,marginBottom:2},placeholder:t})),a()(pe.Z,{type:pe.i.Vertical,initialFocus:void 0,sections:[{key:"dialog",render:e=>o.createElement(te.Z,e),items:i}]})))},this.handleAccept=()=>{const e=Ca.Z.state;e.open&&(this.cleanAcceptInput(e.inputValue)===this.cleanAcceptInput(e.requiredInputValue)?wa.x({didConfirm:!0}):dt.showErrorMessage(a()(w.FormattedMessage,{id:"confirmDialogInput.incorrectInputError.message",defaultMessage:'Please type "{requiredInputValue}" to continue',values:{requiredInputValue:e.requiredInputValue}})))},this.cleanAcceptInput=e=>e.trim().toLowerCase().replace(/’/g,"'"),this.handleCancel=()=>{wa.x({didConfirm:!1})},this.handleInputChange=e=>{const t=Ca.Z.state;t.open&&Ca.Z.setState({...t,inputValue:e.target.value})}}renderComponent(){const e=Ca.Z.state;return e.open&&(this.lastOpenState={...e}),a()(_a.Z,{open:e.open,keepFocus:!0,overlayZIndex:Ma.Wd,onDismiss:this.handleCancel,preventHideChildrenWhileOpening:!0,innerStyle:{borderRadius:3,paddingTop:24,paddingBottom:16,paddingLeft:32,paddingRight:32,width:this.lastOpenState&&this.lastOpenState.width||336,fontSize:16,boxShadow:this.theme.largeBoxShadow,background:this.theme.modalBackground,maxHeight:"90vh",overflowY:"scroll",marginLeft:24,marginRight:24},render:this.renderModal})}}Ta.displayName="ConfirmInputDialogRenderer",Ta.buttonStyle={width:"100%",marginTop:16};const Ia=Ta;var Pa=i(55367),Za=i(8958),xa=i(41046);class Fa extends b.Z{constructor(){super(...arguments),this.renderGhost=()=>{const e=Pa.ZP.state;if(!e.isDragging)return;const t=e.draggedStores.map(((t,i)=>a()(Za.Z,{store:t,ghostElement:e.ghostElements[i]},`${i}`)));return a()("div",{style:this.getGhostStyle()},void 0,t)},this.isDragging=this.createComputedStore((()=>Pa.ZP.state.isDragging))}renderComponent(){return a()(xa.Z,{open:this.isDragging.state},void 0,this.renderGhost())}getGhostStyle(){const e=Pa.ZP.state;if(!e.isDragging)return;const{startX:t,startY:i,currentX:n,currentY:a}=e;return{position:"absolute",top:0,left:0,transform:`translate3d(${n-t}px, ${a-i}px, 0)`}}}Fa.displayName="DragOverlay";const Aa=Fa;var Ea=i(12768);class Ba extends b.Z{constructor(){super(...arguments),this.handleContextMenu=e=>{const{device:t}=this.environment;t.isAndroid||Ea.default.isOnboarding||(0,Ui.ZP)({event:e,context:Ui.Af.EditorContextMenu,callback:()=>{t.isElectron||this.environment.currentUser.isLoggedIn()&&e.preventDefault()}})},this.handleDragStart=e=>{e.preventDefault()}}didMount(){window.addEventListener("contextmenu",this.handleContextMenu),window.addEventListener("dragstart",this.handleDragStart)}willUnmount(){window.removeEventListener("contextmenu",this.handleContextMenu),window.removeEventListener("dragstart",this.handleDragStart)}}Ba.displayName="PreventDefaultListener";const Da=Ba;var Ra=i(67133),La=i(28748);class Na extends b.Z{constructor(){super(...arguments),this.handleChangeValue=e=>{if(!e)return void this.removeDateAnnotation();const t=this.getEverythingIWant();if(!t)return;const{date_format:i,time_format:n}=t;this.setDateAnnotationData({date_format:i,time_format:n,...e})},this.handleChangeDateFormat=e=>{const t=this.getEverythingIWant();if(!t)return;const{dateValue:i,time_format:n}=t;this.setDateAnnotationData({date_format:e,time_format:n,...i})},this.handleChangeTimeFormat=e=>{const t=this.getEverythingIWant();if(!t)return;const{dateValue:i,date_format:n}=t;this.setDateAnnotationData({date_format:n,time_format:e,...i})},this.setDateAnnotationData=e=>{const t=this.getEverythingIWant();if(!t)return;const{textStore:i,textValue:n,tokenIndex:a,annotations:o}=t,s=n.map(((t,i)=>{if(i===a){const i=o.map((t=>Fe.fp(t)?["d",e]:t));return Fe.V3(t[0],i)}return t}));Ge.createAndCommit({userAction:"DateMentionMenu.setDateAnnotationData",environment:this.environment,perform:e=>{Ke.sO({store:i,value:s,transaction:e})}})},this.removeDateAnnotation=()=>{const e=this.getEverythingIWant();if(!e)return;const{textStore:t,textValue:i,tokenIndex:n}=e,a=i.filter(((e,t)=>t!==n));Ge.createAndCommit({userAction:"DateMentionMenu.removeDateAnnotation",environment:this.environment,perform:e=>{Ke.sO({store:t,value:a,transaction:e})}})}}renderComponent(){const{device:e}=this.environment,t=La.Z.state;return a()(N.ZP,{popupType:e.isMobile?N.ZP.PopupType.SlideUp:N.ZP.PopupType.Popup,open:t.open,originRect:t.originRect,onDismiss:Ra.x,render:()=>{const e=this.getEverythingIWant();if(!e)return null;const{date_format:i,time_format:n,dateValue:o}=e;return a()(d.DependencyConsumer,{dependency:d.deps.menus},void 0,(e=>{let{DatePropertyMenu:s}=e;return a()(s,{firstDayOfWeek:He.AK.state,value:o,canConfigureCollection:!0,onChangeValue:this.handleChangeValue,dateFormat:i,onChangeDateFormat:this.handleChangeDateFormat,timeFormat:n,onChangeTimeFormat:this.handleChangeTimeFormat,onDismiss:Ra.x,disabled:!1,shouldShowReminder:!!t.open&&t.allowReminders})}))}})}getEverythingIWant(){const e=La.Z.state;if(e.open){const{textStore:t,tokenIndex:i}=e,n=t.getValue();if(n){const e=n[i];if(e){const a=Fe.hD(e),o=Fe.K9(a);if(o){const{date_format:s,time_format:r,...l}=Fe.Ot(o);return{textStore:t,textValue:n,tokenIndex:i,token:e,annotations:a,date_format:s,time_format:r,dateValue:l}}}}}}}Na.displayName="DateMentionMenu";const Oa=Na;var Va=i(51859),Ua=i(89951),Wa=i(68056),Ka=i(64233),za=i(88923),Ga=i(24666);const qa=(0,w.defineMessages)({image:{defaultMessage:"Embed image",id:"embedMenu.action.image"},video:{defaultMessage:"Embed video",id:"embedMenu.action.video"},tweet:{defaultMessage:"Embed Tweet",id:"embedMenu.action.tweet"},drive:{defaultMessage:"Embed Google Drive",id:"embedMenu.action.drive"},gist:{defaultMessage:"Embed GitHub Gist",id:"embedMenu.action.gist"},figma:{defaultMessage:"Embed Figma",id:"embedMenu.action.figma"},invision:{defaultMessage:"Embed Invision project",id:"embedMenu.action.invision"},abstract:{defaultMessage:"Embed Abstract project",id:"embedMenu.action.abstract"},framer:{defaultMessage:"Embed Framer prototype",id:"embedMenu.action.framer"},whimsical:{defaultMessage:"Embed Whimsical board",id:"embedMenu.action.whimsical"},mixpanel:{defaultMessage:"Embed Mixpanel project",id:"embedMenu.action.mixpanel"},sketch:{defaultMessage:"Embed Sketch document",id:"embedMenu.action.sketch"},excalidraw:{defaultMessage:"Embed excalidraw",id:"embedMenu.action.excalidraw"},replit:{defaultMessage:"Embed a repl",id:"embedMenu.action.replit"},miro:{defaultMessage:"Embed Miro board",id:"embedMenu.action.miro"},audio:{defaultMessage:"Embed audio",id:"embedMenu.action.audio"},maps:{defaultMessage:"Embed Google Map",id:"embedMenu.action.maps"},loom:{defaultMessage:"Embed Loom",id:"embedMenu.action.loom"},typeform:{defaultMessage:"Embed Typeform",id:"embedMenu.action.typeform"},codepen:{defaultMessage:"Embed CodePen",id:"embedMenu.action.codepen"},pdf:{defaultMessage:"Embed PDF",id:"embedMenu.action.pdf"},embed:{defaultMessage:"Create embed",id:"embedMenu.action.createEmbed"},hex:{defaultMessage:"Embed Hex",id:"embedMenu.action.hex"},deepnote:{defaultMessage:"Embed Deepnote",id:"embedMenu.action.deepnote"},drawing:{defaultMessage:"Embed a drawing",id:"embedMenu.action.drawing"}}),Ha=(0,w.defineMessages)({linkToPage:{defaultMessage:"Link to page",id:"embedMenu.actions.linkToPage.title"},mentionPage:{defaultMessage:"Mention page",id:"embedMenu.actions.mentionPage.title"},mentionBlock:{defaultMessage:"Mention block",id:"embedMenu.actions.mentionBlock.title"},createLinkedDatabase:{defaultMessage:"Create linked database",id:"embedMenu.actions.createLinkedDatabase.title"},createLinkedViewOfDatabase:{defaultMessage:"Create linked view of database",id:"embedMenu.actions.createLinkedViewOfDatabase.title"},bookmarkMenuItem:{defaultMessage:"Create bookmark",id:"embedMenu.actions.createBookmark.title"},createTransclusionItem:{defaultMessage:"Paste and sync",id:"embedMenu.actions.createTransclusion.title"},dismissItem:{defaultMessage:"Dismiss",id:"embedMenu.actions.dismiss.title"}}),ja={image:ce.default.formatMessage(qa.image),video:ce.default.formatMessage(qa.video),tweet:ce.default.formatMessage(qa.tweet),drive:ce.default.formatMessage(qa.drive),gist:ce.default.formatMessage(qa.gist),figma:ce.default.formatMessage(qa.figma),invision:ce.default.formatMessage(qa.invision),abstract:ce.default.formatMessage(qa.abstract),framer:ce.default.formatMessage(qa.framer),whimsical:ce.default.formatMessage(qa.whimsical),mixpanel:ce.default.formatMessage(qa.mixpanel),miro:ce.default.formatMessage(qa.miro),sketch:ce.default.formatMessage(qa.sketch),excalidraw:ce.default.formatMessage(qa.excalidraw),replit:ce.default.formatMessage(qa.replit),audio:ce.default.formatMessage(qa.audio),maps:ce.default.formatMessage(qa.maps),loom:ce.default.formatMessage(qa.loom),typeform:ce.default.formatMessage(qa.typeform),codepen:ce.default.formatMessage(qa.codepen),pdf:ce.default.formatMessage(qa.pdf),embed:ce.default.formatMessage(qa.embed),hex:ce.default.formatMessage(qa.hex),deepnote:ce.default.formatMessage(qa.deepnote),drawing:ce.default.formatMessage(qa.drawing)};class Qa extends b.Z{constructor(){super(...arguments),this.renderMenu=()=>{const{device:e}=this.environment,t=Ka.Z.state;if(!t.open)return;const i=this.getSections(t);let n;return 0===i.length&&Ua.xv(),n=e.isMobile?{menuType:_.og.ActionSheet}:{menuType:_.og.Popup,width:320,maxHeight:"40vh"},o.createElement(F.Z,se()({},n,{className:de.srZ}),a()(pe.Z,{type:pe.i.Vertical,sections:i,initialFocus:0}))},this.handleDismiss=()=>{const e=Ka.Z.state,{url:t}=e;K.X0y(this.environment,{url:t,type:"close"}),Ua.xv()},this.handleAccept=e=>{const t=Ka.Z.state,{url:i}=t;Ua.RL({environment:this.environment,type:e}),K.X0y(this.environment,{url:i,type:e})}}willMountOrUpdate(){const e=Ka.Z.state;if(e.open){const t=Ga.default.state;if("editing"===t.mode){const{multiSelection:i}=t;(0,Wa.qS)(i)&&i.start.store.id===e.textStore.id&&i.end.index===e.urlSelection.endIndex||Ua.xv()}}}renderComponent(){const{device:e}=this.environment,t=Ka.Z.state;return a()(N.ZP,{popupType:e.isMobileNative&&!e.isTablet?N.ZP.PopupType.SlideUp:N.ZP.PopupType.Popup,open:t.open,originRect:t.open?t.selectionRect:void 0,placementToOrigin:N.ZP.Placement.Bottom,alignmentToOrigin:N.ZP.Alignment.Start,originGap:4,disableMouseCapture:!0,disableContentScroll:!0,disableDarkOverlayBackground:e.isMobile,keepFocus:e.isMobile,render:this.renderMenu,onDismiss:this.handleDismiss})}isInCollection(e){const t=e.getRecordStoreAtRootPath();return t instanceof Q.G&&void 0!==t.getParentCollectionStore()}isCollectionViewWithContent(e,t){const i=e.getCollectionViewStores(),n=U().find(i,(e=>e.id===t&&"page"===e.getType()));return Boolean(n)}getSections(e){const{device:t}=this.environment,{url:i,textStore:n}=e,a=pi.default.checkGate("reorder_embed_menu"),s=[],r=(0,Va.Wj)({url:i,baseUrl:bt.default.domainBaseUrl,publicDomainName:bt.default.publicDomainName,isMobile:t.isMobile,protocol:bt.default.protocol,currentUrl:window.location.href});if("page"===r.name){const e=Q.G.createChildStore(n,{table:Pe.iU,id:r.blockId}),t=r.scrollToBlockId?Q.G.createChildStore(n,{table:Pe.iU,id:r.scrollToBlockId}):void 0;s.push({name:ce.default.formatMessage(Ha.createLinkedViewOfDatabase),validator:()=>!t&&e.isCollectionView()&&!this.isInCollection(n)&&(!e.isCollectionViewPageWithContent()||!this.isCollectionViewWithContent(e,r.collectionViewId))&&!za.default.isMiniPeekOpen(),type:M.Ti.collectionView}),a&&s.push({name:ce.default.formatMessage(void 0===t?Ha.mentionPage:Ha.mentionBlock),validator:()=>!0,type:"mention-page"}),s.push({name:ce.default.formatMessage(Ha.createTransclusionItem),validator:()=>Boolean(t&&!t.isNavigableBlock()&&!this.isInCollection(n)&&!t.isLocked()&&!t.isNavigableAncestorLocked()&&t.canEdit()),type:"create-transclusion"}),a||s.push({name:ce.default.formatMessage(void 0===t?Ha.mentionPage:Ha.mentionBlock),validator:()=>!0,type:"mention-page"}),s.push({name:ce.default.formatMessage(Ha.linkToPage),validator:()=>!t&&!e.isCollectionView()&&!this.isInCollection(n),type:M.Ti.page})}const l=De.XP(ja);for(const o of l)"embed"!==o&&s.push({name:ja[o],validator:ft.Wb[o],type:o});s.push({name:ce.default.formatMessage(Ha.bookmarkMenuItem),validator:e=>!this.isInCollection(n)&&ft.Cm(e),type:M.Ti.bookmark}),s.push({name:ja.embed,validator:e=>!this.isInCollection(n)&&ft.Wb.embed(e),type:"embed"});const d=U().compact(s.map((e=>{let{name:t,validator:n,type:a}=e;if(n({url:i,baseUrl:bt.default.domainBaseUrl,publicDomainName:bt.default.publicDomainName})){return{key:`embed ${t}`,render:e=>o.createElement(me.Z,se()({},e,{title:t})),action:()=>this.handleAccept(a)}}}))),c={key:"dismiss",render:e=>o.createElement(me.Z,se()({},e,{title:ce.default.formatMessage(Ha.dismissItem)})),action:this.handleDismiss};if(0===d.length)return[];a&&"page"===r.name?d.push(c):d.unshift(c);return[{key:"embed section",render:e=>o.createElement(te.Z,e),items:d}]}}Qa.displayName="EmbedMenu";const Ya=Qa;var $a=i(4727),Xa=i(31352),Ja=i(88833),eo=i(38797);class to extends b.Z{constructor(){super(...arguments),this.renderMenu=()=>{const{device:e}=this.environment,t=Ja.Z.state,i=o.createRef();if(!t.open)return;let n;return n=e.isMobileNative&&!e.isTablet?{menuType:_.og.ActionSheet}:{menuType:_.og.Popup,width:eo.ZP.desktopEmojiPickerOnlyPopupWidth,maxHeight:eo.ZP.desktopEmojiPickerOnlyPopupHeight,onClickOutside:$a.xv},o.createElement(F.Z,se()({innerRef:i},n),a()(eo.ZP,{filter:this.getFilter(t)||"",onSubmit:this.handleSubmit,onNoResults:this.handleNoResults,isCallout:!1,menuRef:i}))},this.handleNoResults=()=>{const e=Ja.Z.state;if(!e.open)return;const t=this.getFilter(e);if(!t)return;const i=U().last(t);i&&(/\s/g.test(i)?$a.xv():this.trackNoResultsDebounced(t))},this.trackNoResultsDebounced=U().debounce((e=>{K.VJs(this.environment,{searchQuery:e})}),500),this.handleSubmit=e=>{Ge.createAndCommit({userAction:"EmojiMenu.handleSubmit",environment:this.environment,perform:t=>{$a.RL({environment:this.environment,emoji:e,transaction:t})}})},this.handleCancel=()=>{$a.xv()}}willMountOrUpdate(){const e=Ja.Z.state;if(e.open){var t;const i=Ga.default.state,n=this.getFilter(e);if("editing"!==i.mode)return void $a.xv();const a=Fe.ee(i.multiSelection.start.store.getValue())[i.multiSelection.start.index-1];if(!n&&":"!==a)return void $a.xv();((null===(t=(0,Wa.QY)(i.multiSelection))||void 0===t?void 0:t.store)!==e.textStore||void 0===n||":"===n||n.startsWith("\n")||n.startsWith(" "))&&$a.xv()}}renderComponent(){const{device:e}=this.environment,t=Ja.Z.state;let i=!1;if(t.open){const e=this.getFilter(t);e&&e.length>0&&(i=!0),t.showPopupWithEmptyFilter&&(i=!0)}return a()(N.ZP,{popupType:e.isMobileNative&&!e.isTablet?N.ZP.PopupType.SlideUp:N.ZP.PopupType.Popup,open:i,originRect:t.open?t.selectionRect:void 0,placementToOrigin:N.ZP.Placement.Bottom,alignmentToOrigin:N.ZP.Alignment.Start,originGap:4,disableMouseCapture:!0,disableContentScroll:!0,onDismiss:this.handleCancel,render:this.renderMenu,keepFocus:!0})}getFilter(e){return Xa.zK(e.textStore,e.oldTextValue,!0)}}to.displayName="EmojiMenu";const io=to;var no=i(42858),ao=i(24677),oo=i(39500),so=i(17504),ro=i(58202),lo=i(38302),co=i(23063),uo=i(56813);class mo extends b.Z{constructor(){var e;super(...arguments),e=this,this.zoomFocusPercentageX=0,this.zoomFocusPercentageY=0,this.isListeningToWheel=!1,this.hideControlsTimeout=void 0,this.isMovingToPrevOrNextTimeout=void 0,this.isEditingZoom=Mt.default.createValue(!1),this.contentDimensions=Mt.default.createValue(void 0),this.showControls=Mt.default.createValue(!1),this.responsiveSettings=this.createComputedStore((()=>{const e=this.environment.WindowSizeStore.state.width;return{edgePadding:yt.zp(e),backgroundOpacity:.8}})),this.renderOverlay=()=>{const{isOpen:e,renderFullScreenNode:t,fullScreenNodeRect:i,contentAspectRatio:n,zoomScale:s,panOffset:r,skipAnimations:l}=lo.Z.state;if(!i)return;e&&!this.isListeningToWheel?(window.addEventListener("wheel",this.handleWheel,{passive:!1}),this.isListeningToWheel=!0):!e&&this.isListeningToWheel&&(window.removeEventListener("wheel",this.handleWheel),this.isListeningToWheel=!1);const{edgePadding:d,backgroundOpacity:c}=this.responsiveSettings.state,u=window.innerWidth,m=window.innerHeight-2*d;let p=u-2*d;const g=n||i.height/i.width;let h=p*g;if(h>m){const e=h/m;h/=e,p/=e}const f={opacity:0},v={scale:s,opacity:1,translateX:r.x,translateY:r.y};let y,S;return t&&(y=t()),S=this.showControls.state?s>=1.5?"zoom-out":"zoom-in":"none",(0,so.Z)((t=>a()(x.Z,{capture:e,onEsc:()=>{this.handleClose(!0)},onEnter:U().identity,onSpace:()=>this.handleClose(!0),onCommandEnter:()=>this.handleClose(!0),onCommandShiftEnter:U().identity,onCommandSlash:U().identity,onUp:U().identity,onDown:U().identity,onDelete:U().identity,onBackspace:U().identity,onLeft:()=>this.handlePrevious(!0),onRight:()=>this.handleNext(!0),onUntab:U().identity,onTab:U().identity,onSelectAll:U().identity,onRedo:U().identity,onUndo:U().identity,onToggleBold:U().identity,onToggleItalics:U().identity,onToggleStrike:U().identity,onToggleCode:U().identity,onCut:U().identity,onCopy:U().identity,onPaste:U().identity,onKeypress:this.handleKeypress},void 0,a()(Z.Z,{capture:e,preventType:T.Z.All},void 0,o.createElement("div",se()({style:this.getStyle({isOpen:e})},t,{onClick:this.handleBackgroundClick,onMouseMove:this.resetHideControlsTimeout}),a()(co.Z,{isVisible:e,enterAnimationStyle:{opacity:0},exitAnimationStyle:{opacity:0},animationStyle:{opacity:c},render:()=>a()("div",{style:this.getBackgroundStyle()}),onAnimationEnd:this.handleBackgroundAnimationEnd}),a()(co.Z,{isVisible:e,enterAnimationStyle:f,exitAnimationStyle:f,animationStyle:v,skipAnimation:l,springConfig:{scale:this.getSpringConfig(),translateX:this.getSpringConfig(),translateY:this.getSpringConfig()},render:()=>o.createElement("div",{style:{display:"flex",cursor:S,maxWidth:p,maxHeight:h,justifyContent:"center"},ref:e=>{e&&this.contentDimensions.setState({width:e.clientWidth,height:e.clientHeight})},onClick:this.handleContentClick,onMouseDown:this.handleMouseDown,onMouseUp:this.handleMouseUp,onMouseLeave:this.handleMouseUp,onMouseMove:this.handleMouseMove},y),onAnimationEnd:this.handleFullscreenNodeAnimationEnd}),this.renderBottomBar())))))},this.clearHideControlsTimeout=()=>{this.hideControlsTimeout&&clearTimeout(this.hideControlsTimeout)},this.resetHideControlsTimeout=()=>{const{isSaving:e}=lo.Z.state;this.showControls.setState(!0),this.clearHideControlsTimeout(),this.isEditingZoom.state||e||(this.hideControlsTimeout=setTimeout((()=>this.showControls.setState(!1)),2e3))},this.enableZoomEditing=()=>{this.isEditingZoom.setState(!0),this.clearHideControlsTimeout()},this.disableZoomEditing=()=>{this.isEditingZoom.setState(!1),this.resetHideControlsTimeout()},this.handleBackgroundClick=e=>{(0,oo.uG)(e)||this.handleClose()},this.handleContentClick=e=>{const{zoomScale:t,panOffset:i}=lo.Z.state;if(e.stopPropagation(),(0,oo.uG)(e))return;let n,a;n=t<1?1:t<1.5?1.5:1,a=n<=1?{x:0,y:0}:this.clampPanOffset({x:(window.innerWidth/2-e.clientX)/(n/(n-1)),y:(window.innerHeight/2-e.clientY)/(n/(n-1))})??i,lo.Z.setState({...lo.Z.state,zoomScale:n,panOffset:a}),this.resetHideControlsTimeout(),this.disableZoomEditing()},this.handleClose=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];yt.xv(),e.resetControls(),K.Lfx(e.environment,{type:"close",triggered_by:t?"keypress":"click"}),ao.ZH(e.environment),e.handleMouseUp()},this.handleResize=()=>{const{isOpen:e}=lo.Z.state;e&&this.enqueueForceUpdate()},this.handleBackgroundAnimationEnd=()=>{const{isOpen:e}=lo.Z.state;e||lo.Z.setState({...lo.Z.state,backgroundAnimationComplete:!0})},this.handleFullscreenNodeAnimationEnd=()=>{const{isOpen:e}=lo.Z.state;e||lo.Z.setState({...lo.Z.state,fullscreenNodeAnimationComplete:!0})},this.cancelBackgroundClick=e=>{e.stopPropagation()},this.handlePrevious=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];e.moveToImageOffset(-1,t)},this.handleNext=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];e.moveToImageOffset(1,t)},this.handleZoomInputSubmit=e=>{const t=e.target,i=parseInt(t.value);if(!isNaN(i)){const e=i/100;K.Lfx(this.environment,{type:"set_zoom",new_zoom:e}),this.setZoomScale(e)}this.disableZoomEditing()},this.handleZoomOut=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const{zoomScale:i}=lo.Z.state;let n=Math.ceil((i-mo.ZOOM_STEP)*mo.INVERSE_ZOOM_STEP)/mo.INVERSE_ZOOM_STEP;i-n<mo.ZOOM_THRESHOLD&&(n-=mo.ZOOM_STEP),K.Lfx(e.environment,{type:"zoom_out",new_zoom:n,triggered_by:t?"keypress":"click"}),e.setZoomScale(n)},this.handleZoomIn=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const{zoomScale:i}=lo.Z.state;let n=Math.floor((i+mo.ZOOM_STEP)*mo.INVERSE_ZOOM_STEP)/mo.INVERSE_ZOOM_STEP;n-i<mo.ZOOM_THRESHOLD&&(n+=mo.ZOOM_STEP),K.Lfx(e.environment,{type:"zoom_in",new_zoom:n,triggered_by:t?"keypress":"click"}),e.setZoomScale(n)},this.addDeltaToZoomScale=e=>{const{zoomScale:t}=lo.Z.state;this.setZoomScale(t+e)},this.setZoomScale=e=>{const{panOffset:t}=lo.Z.state;this.resetHideControlsTimeout();const i=Math.max(Math.min(e,mo.MAX_ZOOM),mo.MIN_ZOOM),n=i<=1?{x:0,y:0}:t;lo.Z.setState({...lo.Z.state,zoomScale:i,panOffset:n})},this.handleWheel=e=>{const{isOpen:t,panOffset:i}=lo.Z.state;t&&(e.preventDefault(),e.ctrlKey?e.deltaY?this.addDeltaToZoomScale(e.deltaY*mo.TRACK_PAD_SCALE):e.deltaX&&this.addDeltaToZoomScale(e.deltaX*mo.TRACK_PAD_SCALE):e.metaKey?e.deltaY?this.addDeltaToZoomScale(e.deltaY*mo.MOUSE_WHEEL_SCALE):e.deltaX&&this.addDeltaToZoomScale(e.deltaX*mo.MOUSE_WHEEL_SCALE):this.canPan()&&this.setPanOffset({x:i.x-e.deltaX,y:i.y-e.deltaY}))},this.handleMouseDown=e=>{const{panOffset:t,zoomScale:i}=lo.Z.state;lo.Z.setState({...lo.Z.state,panStartPosition:{x:e.clientX/i-t.x,y:e.clientY/i-t.y},skipAnimations:!0})},this.handleMouseUp=()=>{lo.Z.setState({...lo.Z.state,skipAnimations:!1})},this.handleMouseMove=e=>{const{panStartPosition:t,zoomScale:i}=lo.Z.state;this.contentDimensions.state&&1===e.buttons&&this.canPan()&&this.setPanOffset({x:e.clientX/i-t.x,y:e.clientY/i-t.y})},this.handleDownload=e=>{const{block:t,imageUrl:i}=lo.Z.state;if(!t||!this.canDownload())return;lo.Z.setState({...lo.Z.state,isSaving:!0}),this.clearHideControlsTimeout();const n=null==t?void 0:t.getProperties();let a;if(a=i||Fe.Q(null==n?void 0:n.source),!a)return;const o=Fe.Q(null==n?void 0:n.caption);(0,vt.GN)(a,null==t?void 0:t.pointer,bt.default.domainBaseUrl,this.environment.currentUser.id,o).then((()=>{lo.Z.setState({...lo.Z.state,isSaving:!1}),K.Lfx(this.environment,{type:"download",triggered_by:"click"}),this.resetHideControlsTimeout()}))},this.handleKeypress=e=>{switch(e.key){case"+":case"=":this.handleZoomIn(!0);break;case"-":case"_":this.handleZoomOut(!0)}}}didMount(){super.didMount(),window.addEventListener("resize",this.handleResize)}willUnmount(){super.willUnmount(),window.removeEventListener("resize",this.handleResize),window.removeEventListener("wheel",this.handleWheel),this.isListeningToWheel=!1}renderComponent(){const{isOpen:e,fullscreenNodeAnimationComplete:t,backgroundAnimationComplete:i}=lo.Z.state;return a()(xa.Z,{open:e||!t||!i},void 0,this.renderOverlay())}getAllImageBlocksOnPage(){const e=Y.default.getCurrentRootStore();return ro.R.getMembersByDOMOrder({filter:t=>t instanceof uo.Z&&Boolean(t.props.store.findRecordStoreUIAncestor((t=>Boolean(e&&t===e))).ancestor)}).map((e=>e.props.store)).filter((e=>Boolean(e.getProperties().source)))}renderBottomBar(){const{isOpen:e}=lo.Z.state;if(!this.environment.device.isMobile)return a()(co.Z,{isVisible:this.showControls.state,enterAnimationStyle:{opacity:1},exitAnimationStyle:{opacity:0},animationStyle:{opacity:1},render:()=>a()("div",{style:this.getBottomContainerStyle(e),onClick:e=>{this.cancelBackgroundClick(e),this.resetHideControlsTimeout(),this.disableZoomEditing()}},void 0,a()("div",{style:{...mo.controlBarStyle,marginRight:10}},void 0,this.renderPrevNextButtons()),a()("div",{style:mo.controlBarStyle},void 0,this.renderZoomControls(),this.renderVerticalLine(),this.canDownload()?o.createElement(o.Fragment,null,this.renderDownloadButton(),this.renderVerticalLine()):void 0,this.renderCloseButton()))})}renderZoomControls(){const{zoomScale:e}=lo.Z.state,t=(100*e).toFixed(0);return a()("div",{style:{alignItems:"center",display:"flex",height:"100%",justifySelf:"flex-start"}},void 0,a()(qi.Z,{renderTooltip:()=>this.renderTooltip({primaryText:a()(w.FormattedMessage,{id:"fullScreenRenderer.zoomOut",defaultMessage:"Zoom out"}),secondaryText:"-"}),disableTooltip:e<=mo.MIN_ZOOM,render:t=>o.createElement(rt.Z,se()({},t,{disabled:e<=mo.MIN_ZOOM,style:{...this.getButtonStyle(e<=mo.MIN_ZOOM),...mo.firstButtonPadding},onClick:()=>this.handleZoomOut(),icon:e=>Ie.Z.minus({...e,fill:this.getBottomBarPrimaryColor(),height:16,margin:0,width:16})}))}),this.isEditingZoom.state?a()(po,{initialValue:t,onSubmit:this.handleZoomInputSubmit,onCancel:this.disableZoomEditing,primaryColor:this.getBottomBarPrimaryColor(),secondaryColor:this.getBottomBarSecondaryColor()}):a()(rt.Z,{onClick:e=>{e.stopPropagation(),this.enableZoomEditing()},style:{color:this.getBottomBarSecondaryColor(),margin:0,width:46,padding:0,justifyContent:"center"}},void 0,`${t}%`),a()(qi.Z,{renderTooltip:()=>this.renderTooltip({primaryText:a()(w.FormattedMessage,{id:"fullScreenRenderer.zoomIn",defaultMessage:"Zoom in"}),secondaryText:"+"}),disableTooltip:e>=mo.MAX_ZOOM,render:t=>o.createElement(rt.Z,se()({},t,{disabled:e>=mo.MAX_ZOOM,style:this.getButtonStyle(e>=mo.MAX_ZOOM),onClick:()=>this.handleZoomIn(),icon:e=>Ie.Z.plus({...e,fill:this.getBottomBarPrimaryColor(),height:16,margin:0,width:16})}))}))}renderPrevNextButtons(){const{block:e}=lo.Z.state,t=this.getAllImageBlocksOnPage(),i=(null==t?void 0:t.length)??0,n=(null==t?void 0:t.findIndex((t=>t===e)))??-1;return i<=1||n<0?a()("div",{}):o.createElement(o.Fragment,null,a()(qi.Z,{renderTooltip:()=>this.renderTooltip({primaryText:a()(w.FormattedMessage,{id:"fullScreenRenderer.previous",defaultMessage:"Back"}),secondaryText:this.renderPrevNextSecondaryText(n-1,i)}),disableTooltip:0===n,render:e=>o.createElement(rt.Z,se()({},e,{disabled:n<=0,style:{...this.getButtonStyle(n<=0),...mo.firstButtonPadding},hoveredStyle:mo.hoveredButtonStyle,onClick:()=>this.handlePrevious(),icon:e=>Ie.Z.arrowLeft({...e,fill:this.getBottomBarPrimaryColor(),height:16,margin:0,width:16})}))}),a()(qi.Z,{renderTooltip:()=>this.renderTooltip({primaryText:a()(w.FormattedMessage,{id:"fullScreenRenderer.next",defaultMessage:"Next"}),secondaryText:this.renderPrevNextSecondaryText(n+1,i)}),disableTooltip:n+1===i,render:e=>o.createElement(rt.Z,se()({},e,{disabled:n>=i-1,style:{...this.getButtonStyle(n>=i-1),...mo.lastButtonPadding},hoveredStyle:mo.hoveredButtonStyle,onClick:()=>this.handleNext(),icon:e=>Ie.Z.arrowRight({...e,fill:this.getBottomBarPrimaryColor(),height:16,margin:0,width:16})}))}))}renderDownloadButton(){const{isSaving:e}=lo.Z.state;return a()(qi.Z,{renderTooltip:()=>this.renderTooltip({primaryText:a()(w.FormattedMessage,{id:"fullScreenRenderer.download",defaultMessage:"Download"})}),render:t=>o.createElement(rt.Z,se()({},t,{disabled:e,onClick:this.handleDownload,style:this.getButtonStyle(!1),hoveredStyle:mo.hoveredButtonStyle}),e?a()(st.Z,{style:{width:16}}):Ie.Z.download({fill:this.getBottomBarPrimaryColor(),width:16}))})}renderCloseButton(){return a()(qi.Z,{renderTooltip:()=>this.renderTooltip({primaryText:a()(w.FormattedMessage,{defaultMessage:"Close",id:"fullscreenRenderer.closeButton.label"}),secondaryText:"esc"}),render:e=>o.createElement(rt.Z,se()({},e,{onClick:()=>this.handleClose(),style:{...this.getButtonStyle(!1),...mo.lastButtonPadding},hoveredStyle:mo.hoveredButtonStyle,icon:e=>Ie.Z.collapse({...e,fill:this.getBottomBarPrimaryColor(),height:16,margin:0,width:16})}))})}renderPrevNextSecondaryText(e,t){return a()(w.FormattedMessage,{values:{currentIndex:e+1,totalCount:t},defaultMessage:"{currentIndex} of {totalCount}",id:"fullscreenRenderer.imageCount.label"})}renderTooltip(e){const{primaryText:t,secondaryText:i}=e;return o.createElement(o.Fragment,null,a()("span",{style:{marginRight:i?4:void 0}},void 0,t),i?a()("span",{style:{color:this.getBottomBarSecondaryColor()}},void 0,i):void 0)}renderVerticalLine(){return a()("span",{style:{borderLeft:`1px solid ${xi.ZP.whiteWithAlpha(.25)}`,height:"100%"}})}scrollToZoomFocus(e){const t=window.innerWidth/2,i=window.innerHeight/2,n=e.scrollWidth*this.zoomFocusPercentageX,a=e.scrollHeight*this.zoomFocusPercentageY;e.scrollLeft=n-t,e.scrollTop=a-i}resetControls(){this.isEditingZoom.setState(!1),lo.Z.setState({...lo.Z.state,zoomScale:1,panStartPosition:{x:0,y:0},panOffset:{x:0,y:0}})}canPan(){const{zoomScale:e}=lo.Z.state;return e>1}clampPanOffset(e){const t=this.contentDimensions.state;if(!t)return;let i,n;i=t.width*mo.MAX_ZOOM>window.innerWidth?(t.width*mo.MAX_ZOOM-window.innerWidth)/(2*mo.MAX_ZOOM):(window.innerWidth-t.width*mo.MAX_ZOOM)/(2*mo.MAX_ZOOM),n=t.height*mo.MAX_ZOOM>window.innerHeight?(t.height*mo.MAX_ZOOM-window.innerHeight)/(2*mo.MAX_ZOOM):(window.innerHeight-t.height*mo.MAX_ZOOM)/(2*mo.MAX_ZOOM);return{x:Math.min(Math.max(e.x,-1*i),i),y:Math.min(Math.max(e.y,-1*n),n)}}setPanOffset(e){const{panStartPosition:t}=lo.Z.state,i=this.clampPanOffset(e);i&&(e.x!==i.x&&(t.x=t.x+(e.x-i.x)),e.y!==i.y&&(t.y=t.y+(e.y-i.y)),lo.Z.setState({...lo.Z.state,panOffset:i,panStartPosition:t}))}canDownload(){var e;const{block:t,imageUrl:i}=lo.Z.state;return t&&(i||(null===(e=t.getProperties())||void 0===e?void 0:e.source)&&Fe.Q(t.getProperties().source))}moveToImageOffset(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const{block:i}=lo.Z.state,n=this.getAllImageBlocksOnPage();if(!n)return;const a=n.findIndex((e=>e===i));if(a+e<0||a+e>=n.length)return;K.Lfx(this.environment,{type:e>0?"next":"previous",image_count:n.length,image_index:a+e,triggered_by:t?"keypress":"click"}),lo.Z.setState({...lo.Z.state,skipAnimations:!0}),this.isMovingToPrevOrNextTimeout&&clearTimeout(this.isMovingToPrevOrNextTimeout),this.isMovingToPrevOrNextTimeout=setTimeout((()=>{lo.Z.setState({...lo.Z.state,skipAnimations:!1})}),250);const o=n[a+e];no.dK({blocks:[o]}),this.resetControls()}getSpringConfig(){return{stiffness:100,damping:10,precision:.001}}getStyle(e){const{isOpen:t}=e;return{zIndex:Ma.mJ,position:"fixed",top:0,left:0,right:0,bottom:0,display:"flex",justifyContent:"center",alignItems:"center",pointerEvents:t?"auto":"none",cursor:this.showControls.state?void 0:"none"}}getBackgroundStyle(){return{position:"absolute",top:0,left:0,right:0,bottom:0,background:xi.ZP.black}}getBottomContainerStyle(e){return{bottom:30,display:e?"flex":"none",fontSize:14,left:"50%",lineHeight:1.2,position:"absolute",transform:"translate(-50%, 0)"}}getBottomBarPrimaryColor(){return xi.ZP.white}getBottomBarSecondaryColor(){return xi.ZP.whiteWithAlpha(.5)}getButtonStyle(e){return{borderRadius:4,opacity:e?.4:1,padding:6}}}function po(e){window.__c={n:"ZoomInput"};const[t,i]=(0,o.useState)(e.initialValue);return a()(ye.Z,{style:{width:46,color:e.primaryColor},inputStyle:{textAlign:"center",border:"solid 1px rgba(45, 156, 219, 0.72)",borderRadius:3,boxShadow:"0px 0px 0px 3px rgba(45, 156, 219, 0.2)"},onClick:e=>e.stopPropagation(),onChange:e=>{const t=e.target;i(t.value)},value:t,onSubmit:e.onSubmit,focusInitial:!0,selectAll:!0,format:ye.B.Transparent,right:a()("span",{style:{color:e.secondaryColor}},void 0,"%"),onKeyDown:t=>{t.stopPropagation(),"Escape"===t.key?e.onCancel():"Tab"===t.key&&e.onSubmit(t)}})}mo.displayName="FullScreenRenderer",mo.MAX_ZOOM=2,mo.MIN_ZOOM=.5,mo.ZOOM_STEP=.5,mo.INVERSE_ZOOM_STEP=1/mo.ZOOM_STEP,mo.ZOOM_THRESHOLD=.25,mo.MOUSE_WHEEL_SCALE=-.002,mo.TRACK_PAD_SCALE=-.004,mo.controlBarStyle={display:"flex",borderRadius:4,background:xi.ZP.blackWithAlpha(.65)},mo.firstButtonPadding={padding:"6px 6px 6px 10px"},mo.lastButtonPadding={padding:"6px 10px 6px 6px"},mo.hoveredButtonStyle={background:"rgba(255, 255, 255, 0.055)"};const go=mo;var ho=i(27830),fo=i(36280),vo=i(73959),yo=i(89086),So=i(66949),bo=i(3702);class Mo extends b.Z{constructor(){super(...arguments),this.input=o.createRef(),this.handleInputChange=(e,t)=>{So.Z.isOpen()&&So.Z.setState({...So.Z.state,value:e,error:t})},this.handleSubmit=()=>{Ge.createAndCommit({userAction:"InlineEquationOverlay.handleSubmit",environment:this.environment,perform:e=>{fo.gt({environment:this.environment,equationStore:So.Z,transaction:e})}})},this.handleClose=()=>{fo.Wj()},this.handleLeft=e=>{if(!this.input.current)return;const t=this.input.current.getSelection();t&&"altKey"in e&&!e.altKey&&"shiftKey"in e&&!e.shiftKey&&0===t.startIndex&&0===t.endIndex&&(this.handleSubmit(),fo.Wj(So.P.Backward))},this.handleRight=e=>{if(!So.Z.isOpen())return;if(!this.input.current)return;const t=this.input.current.getSelection();if(!t)return;const i=So.Z.state.value.length;"altKey"in e&&!e.altKey&&"shiftKey"in e&&!e.shiftKey&&t.startIndex===i&&t.endIndex===i&&(this.handleSubmit(),fo.Wj())},this.isDisabled=()=>{var e;if("editing"!==Ga.default.state.mode&&!So.Z.isOpen())return!0;const t=So.Z.isOpen()?null===(e=(0,Wa.QY)(So.Z.state.savedTextSelectionState.multiSelection))||void 0===e?void 0:e.store:void 0;if(t&&!t.canEdit())return!0;if(t){const e=(0,vo.J2)(t);if(e&&e.isLocked())return!0}const i={[Fe.GK.User]:Fe.GK.User,[Fe.GK.Page]:Fe.GK.Page,[Fe.GK.Comment]:Fe.GK.Comment,[Fe.GK.Bot]:Fe.GK.Bot,[Fe.GK.Date]:Fe.GK.Date,[Fe.GK.ExternalObjectInstance]:Fe.GK.ExternalObjectInstance,[Fe.GK.TemporaryPage]:Fe.GK.TemporaryPage,[Fe.GK.TemplateVariable]:Fe.GK.TemplateVariable,[Fe.GK.FormulaPageProperty]:Fe.GK.FormulaPageProperty,[Fe.GK.FormulaContextValue]:Fe.GK.FormulaContextValue,[Fe.GK.Group]:Fe.GK.Group};for(const n of Object.values(i))if((0,yo.J6)(n))return!0;return!1},this.INPUT_ORIGIN_GAP_PX=8}renderComponent(){if(!So.Z.isOpen())return;const e=!So.Z.isOpen(),t=this.isDisabled(),i=this.getInputOriginRect(),n=So.Z.state.value,s=So.Z.state.error;return a()(d.DependencyConsumer,{dependency:d.deps.prismjs},void 0,(a=>{if(!e)return o.createElement(bo.Z,{Prism:a,ref:this.input,isOpen:!0,equationValue:n,error:s,displayMode:"inline",disabled:t,originRect:i,originGap:this.INPUT_ORIGIN_GAP_PX,onDismiss:this.handleClose,onChange:this.handleInputChange,onSubmit:this.handleSubmit,onLeft:this.handleLeft,onRight:this.handleRight})}))}getInputOriginRect(){if(So.Z.isOpen())return So.Z.state.savedTextSelectionRect}}Mo.displayName="InlineEquationOverlay";const wo=Mo;var Co=i(84908),_o=i(94416);class ko extends b.Z{constructor(){super(...arguments),this.handleOpen=()=>{_o.Z.setState({open:!0})},this.handleClose=()=>{_o.Z.setState({open:!1})}}willMount(){Co.inPageSearch.started.addListener(this.handleOpen),Co.inPageSearch.stopped.addListener(this.handleClose)}willUnmount(){Co.inPageSearch.started.removeListener(this.handleOpen),Co.inPageSearch.stopped.removeListener(this.handleClose)}}ko.displayName="InPageSearchListener";const To=ko;var Io=i(96313),Po=i(70726),Zo=i(48863),xo=i(33411);function Fo(e){switch(e){case Po.Z.Preview:return a()(w.FormattedMessage,{id:"internalUnfurlingMenu.actions.pasteAsPreview.title",defaultMessage:"Paste as preview"});case Po.Z.Mention:return a()(w.FormattedMessage,{id:"internalUnfurlingMenu.actions.pasteAsMention.title",defaultMessage:"Paste as mention"});case Po.Z.Link:return a()(w.FormattedMessage,{id:"internalUnfurlingMenu.actions.pasteAsLink.title",defaultMessage:"Paste as link"});default:(0,Ee.t1)(e)}}const Ao=function(){window.__c={n:"InternalUnfurlingMenu"};const e=(0,s.O7)(),t=(0,o.useRef)(null),[i]=(0,r.AF)(Zo.Z),n=(0,o.useCallback)((t=>{if(i.open){var n;if(!t)Io.pg({actionType:i.focusedIndex,environment:e,commentStore:null===(n=i.args.commentStore)||void 0===n?void 0:n.state,useTempStores:!1});Zo.Z.setState({open:!1})}}),[e,i]),l=(0,o.useCallback)((e=>{i.open&&"ArrowUp"!==e.key&&"ArrowDown"!==e.key&&"Enter"!==e.key&&n(void 0)}),[n,i.open]),d=(0,o.useCallback)((e=>{const a=t.current;if(!i.open||!e.target||!a)return;const o=lt.findDOMNode(a);o&&(o.contains(e.target)||n(void 0))}),[n,i.open]);(0,o.useEffect)((()=>((0,Ti.lj)(window,"keydown",l),(0,Ti.lj)(window,"mousedown",d),()=>{(0,Ti.ZV)(window,"keydown",l),(0,Ti.ZV)(window,"mousedown",d)})),[l,d]);const c=(0,o.useRef)(!1);function u(t){var n;i.open&&void 0!==t.indexGlobal&&(Zo.Z.setState({...i,focusedIndex:t.indexGlobal}),Io.pg({actionType:t.indexGlobal,environment:e,commentStore:null===(n=i.args.commentStore)||void 0===n?void 0:n.state,useTempStores:!0}))}(0,r.VK)((()=>{var t,n;const a=(i.open&&(null===(t=i.args.commentStore)||void 0===t?void 0:t.state)&&(null===(n=i.args.commentStore.state)||void 0===n?void 0:n.isReady()))??!1;var o;a&&!c.current&&i.open&&Io.pg({actionType:i.focusedIndex,environment:e,commentStore:null===(o=i.args.commentStore)||void 0===o?void 0:o.state,useTempStores:!0});c.current=a}),[e,i]);const m=(0,r.VK)((()=>e.device.isMobileNative&&!e.device.isTablet),[e]),p=e.device.isMobile;return a()(N.ZP,{popupType:m?N.ZP.PopupType.SlideUp:N.ZP.PopupType.Popup,open:i.open,originRect:i.open?i.selectionRect:void 0,placementToOrigin:N.ZP.Placement.Top,alignmentToOrigin:N.ZP.Alignment.Start,originGap:4,disableMouseCapture:!0,disableContentScroll:!0,disableDarkOverlayBackground:p,keepFocus:p,render:function(){var n;const{device:s}=e;if(!i.open)return;const r=function(t){const{url:i,args:n}=t,a=[];a.push({title:Fo(Po.Z.Preview),validator:()=>!0,type:Po.Z.Preview}),a.push({title:Fo(Po.Z.Mention),validator:()=>!0,type:Po.Z.Mention}),a.push({title:Fo(Po.Z.Link),validator:()=>!0,type:Po.Z.Link});return[{key:"menu section",render:e=>o.createElement(te.Z,e),items:U().compact(a.map((t=>{let{title:a,validator:s,type:r}=t;if(s({url:i,baseUrl:bt.default.domainBaseUrl,publicDomainName:bt.default.publicDomainName})){return{key:`item ${r}`,render:t=>o.createElement(me.Z,se()({},t,{title:a,onMouseEnter:i=>{var a;t.onMouseEnter(i),Io.pg({actionType:r,environment:e,commentStore:null===(a=n.commentStore)||void 0===a?void 0:a.state,useTempStores:!0})}})),action:()=>{var t;return Io.pg({actionType:r,environment:e,commentStore:null===(t=n.commentStore)||void 0===t?void 0:t.state,useTempStores:!1})}}}})))}]}(i);let l;return l=s.isMobile?{menuType:_.og.ActionSheet}:{menuType:_.og.Popup,width:320,maxHeight:"40vh"},null!==(n=i.args.commentStore)&&void 0!==n&&n.state&&i.args.commentStore.state.isReady()?o.createElement(F.Z,se()({},l,{className:de.srZ,ref:t}),a()(pe.Z,{type:pe.i.Vertical,sections:r,onKeyboardArrow:u,initialFocus:0,priority:1,disallowBackspace:!0})):a()(xo.Z,{show:!0,showDelay:500,showHold:0,render:()=>o.createElement(F.Z,se()({},l,{className:de.srZ,ref:t}),a()(te.Z,{style:{display:"flex",justifyContent:"center"}},void 0,a()(st.Z,{})))})},onDismiss:()=>n(void 0)})};var Eo=i(64572),Bo=i(88295),Do=i(45990),Ro=i(21325),Lo=i(48709),No=i(23210);function Oo(e){window.__c={n:"RecordButton"};const{store:t,onClick:i}=e,n=(0,s.O7)(),o=(0,s.MO)(),l=(0,r.VK)((()=>t.getIcon()),[t]),d=(0,r.VK)((()=>t instanceof Q.G&&t.isEmptyPage()),[t]),c=(0,Ce.yK)((e=>({container:{display:"flex",alignItems:"center",padding:"4px 6px",marginLeft:12,marginRight:12,borderRadius:3,boxShadow:e.inputBoxShadow,background:e.inputBackground,height:28,fontSize:14,lineHeight:"120%"},phoneContainer:{display:"flex",alignItems:"center",padding:"4px 16px",boxShadow:`${e.regularDividerColor} 0px 1px 0px`,background:e.modalBackground,height:46}})),[]);return a()(Xi.Z,{style:o?c.phoneContainer:c.container,onClick:i},void 0,a()(Si.Z,{disabled:!0,icon:l,isEmptyPage:d,size:n.device.isMobile?24:20,style:{marginRight:4}}),a()(bi.Z,{store:t}))}var Vo=i(23178);function Uo(e){window.__c={n:"LinkMenuInput"};const{state:t,focusInitial:i,defaultValue:n,onBlur:o,onKeyDown:r,style:l}=e,d=(0,s.MO)(),c=(0,w.useIntl)(),u=c.formatMessage({defaultMessage:"Paste link or search pages",id:"selectionLinkButton.search.createNewLinkPlaceholder"}),m=c.formatMessage({defaultMessage:"Edit link or search pages",id:"selectionLinkButton.search.editLinkPlaceholder"}),p=!d||!t.showCreateIn,g=d?void 0:!t.showCreateIn&&t.focusLinkInput,h=t.editingToken?m:u;return p?a()(ee.ZP,{onFocus:Lo.FV,placeholder:h,value:n||t.url,onChange:Wo,onBlur:o,onKeyDown:r,focus:g,focusInitial:i,focusAfterAnimation:!0,preventCaptureArrowShortcuts:!0,style:l}):null}const Wo=e=>{const t=Vo.Z.state;t.open&&Vo.Z.setState({...t,url:e.target.value,focusLinkInput:!0})};function Ko(e){window.__c={n:"LinkMenuInputWithPreview"};const{state:t,showPreview:i,store:n}=e,o=(0,s.MO)(),r=(0,Lo.Fs)(t),{editingToken:l,focusTitleInput:d}=t;return i&&n?a()(Oo,{store:n,onClick:Lo.FV}):a()(Uo,{state:t,onBlur:Lo.cX,onKeyDown:zo,defaultValue:i?r:void 0,style:l?void 0:{marginTop:6},focusInitial:!Boolean(l)||o&&!d})}const zo=e=>{"Escape"===e.key&&(e.stopPropagation(),(0,Lo.hy)())};function Go(e){window.__c={n:"LinkMenuTitleInput"};const{title:t,focus:i,defaultTitle:n}=e,r=(0,s.O7)(),l=(0,s.MO)(),[d,c]=(0,o.useState)(),u=(0,o.useRef)(!1),m=(0,o.useMemo)((()=>({environment:r,defaultTitle:n,setPlaceholder:c,hasTitleChanged:u})),[n,r]);return(0,o.useEffect)((()=>{const e=u.current;return()=>{e&&K.pZG(r)}}),[u,r]),a()(ee.ZP,{focus:i,focusInitial:l,onFocus:jo,onBlur:()=>Qo(m),onChange:e=>qo(e,m),onKeyDown:e=>Yo(e,m),value:d?"":t,placeholder:d,preventCaptureArrowShortcuts:!0,style:{paddingBottom:8}})}const qo=(e,t)=>{Ho(e.target.value,t)},Ho=(e,t)=>{const i=Vo.Z.state;if(!i.open)return;const{editingToken:n,savedTextSelectionState:a}=i;if(!n)return;if(!e)return void Vo.Z.setState({...i,title:""});const{environment:o,setPlaceholder:s,hasTitleChanged:r}=t;Ge.createAndCommit({userAction:"LinkMenu.updateTitle",environment:o,perform:t=>{const l=Do.iX({environment:o,title:e,transaction:t,editingToken:n,savedTextSelectionState:a});l&&Vo.Z.setState({...i,...l,title:e}),s(void 0),r.current=!0}})},jo=()=>{(0,Lo.ZG)(!0)},Qo=e=>{$o(e),(0,Lo.ZG)(!1)},Yo=(e,t)=>{"Enter"!==e.key&&"Escape"!==e.key||(e.stopPropagation(),Qo(t))},$o=e=>{const t=Vo.Z.state;if(!t.open)return;const{defaultTitle:i,setPlaceholder:n}=e;t.title||(Ho(i,e),n(i))};var Xo=i(88632),Jo=i(18466),es=i(11470),ts=i(15447);function is(e){const{state:t}=e,i=(0,o.useMemo)((()=>(0,Lo.uP)(t)),[t]),n=(0,o.useMemo)((()=>(0,Lo.dY)(i)),[i]),l=function(e){const{state:t,inputUrl:i,query:n,handleLinkSelection:l}=e,{url:d}=t,c=(0,s.O7)(),u=(0,s.MO)(),m=(0,r.VK)((()=>Xo.Z.state.online),[]),p=!!d;return(0,o.useMemo)((()=>{let e,s=!1;if(!i&&p)e=a()(w.FormattedMessage,{defaultMessage:"Type a complete URL to link",id:"selectionLinkButton.invalidUrl"}),s=!0;else{if(!i)return;if("notion"===i.type&&m)return;"web"===i.type?e=a()(w.FormattedMessage,{id:"selectionLinkButton.linkToWebPage",defaultMessage:"Link to web page"}):"notion"===i.type?e=a()(w.FormattedMessage,{id:"selectionLinkButton.linkToPage",defaultMessage:"Link to page"}):"other"===i.type?e=a()(w.FormattedMessage,{id:"selectionLinkButton.linkToURL",defaultMessage:"Link to URL"}):(0,Ee.t1)(i.type)}return{key:"link to url",action:()=>l(c,t,n,u),render:t=>o.createElement(me.Z,se()({},t,{title:d,caption:e,icon:Ie.Z.globe2({width:16,paddingTop:4}),disabled:s}))}}),[t,n,c,u,m,i,l,p,d])}({state:t,inputUrl:n,query:i,handleLinkSelection:ns}),d=function(e){const{state:t,inputUrl:i,query:n,additionalItem:l}=e,{editingToken:d}=t,c=function(e){const{state:t,inputUrl:i,query:n,handleLinkSelection:l,disableEmptyQueryResults:d}=e,{savedTextSelectionState:c}=t,u=(0,s.O7)(),m=(0,s.MO)(),[{online:p}]=(0,r.AF)(Xo.Z),g=(0,o.useMemo)((()=>{var e;const t=null===(e=(0,Wa.QY)(c.multiSelection))||void 0===e?void 0:e.store;if(t&&(0,k.NZ)(t))return t}),[c]),[{value:h,status:f}]=(0,Bi.r5)((async()=>p?n?(await Ot.WL({nearBlock:g,environment:u,query:n,source:"mention_menu",limit:10})).map((e=>e.id)):d?[]:ts.X4.state.map((e=>e.pageId)):[]),[n,g,u,p,d]),v=(0,o.useMemo)((()=>{if(i&&"notion"===i.type){const e=h?U().without(h,i.notionPage.blockId):[];return[i,...e]}return h}),[h,i]);return(0,o.useMemo)((()=>{if(!v||0===v.length)return;if(i&&"web"===i.type&&i.url===n)return;const e=Jo.Z.withListenerIgnored(He.RM);if(!e)return;const s=t.url?5:3,r=a()(w.FormattedMessage,{id:"selectionLinkButton.linkToPage.linkToBlock",defaultMessage:"Link to block"}),d=a()(w.FormattedMessage,{defaultMessage:"Link to page",id:"selectionLinkButton.linkToPageSection.title"});return{items:v.map(((i,n)=>{const s="object"==typeof i?i.notionPage.peekViewBlockId||i.notionPage.blockId:i,d=Q.G.createChildStore(e,{table:Pe.iU,id:s});return{key:n,action:()=>{if("object"==typeof i){const e=(0,Eo.nR)({pageId:i.notionPage.blockId,peekViewBlockId:i.notionPage.peekViewBlockId,peekMode:i.notionPage.peekMode,discussionId:i.notionPage.discussionId,collectionViewId:i.notionPage.collectionViewId,scrollToBlockId:i.notionPage.scrollToBlockId});l(u,t,e,m)}else l(u,t,(0,Eo.nR)({pageId:s}),m)},render:e=>{const t="object"==typeof i&&i.notionPage.scrollToBlockId;return o.createElement(es.Z,se()({},e,{store:d,caption:t?r:void 0,placeholder:a()(xo.Z,{showHold:300,showDelay:300,show:"resolved"===f,render:e=>a()(w.FormattedMessage,e?{id:"selectionLinkButton.linkToPage.unknownBlock",defaultMessage:"Unknown block"}:{id:"selectionLinkButton.linkToPage.loading",defaultMessage:"Loading..."})})}))}}})).slice(0,s),title:v.some((e=>Boolean("object"==typeof e&&e.notionPage.scrollToBlockId)))?r:d}}),[v,t,u,m,n,i,f,l])}({state:t,inputUrl:i,query:n,handleLinkSelection:ns,disableEmptyQueryResults:!!d});return(0,o.useMemo)((()=>{if(c||l){return{key:"results",items:U().compact([...(null==c?void 0:c.items)||[],l]),render:e=>o.createElement(te.Z,se()({},e,{title:d||n?void 0:a()(w.FormattedMessage,{id:"selectionLinkButton.recents.title",defaultMessage:"Recents"})}))}}}),[c,l,d,n])}({state:t,inputUrl:n,query:i,additionalItem:l}),c=(0,Lo.Fs)(t),u=c&&(0,Eo.A5)({url:c,baseUrl:bt.default.domainBaseUrl,publicDomainName:bt.default.publicDomainName}),m=(0,r.VK)((()=>{if(!u)return;const e=(0,He.RM)();return e?Q.G.createChildStore(e,{table:Pe.iU,id:u}):void 0}),[u]),p=function(e){const{state:t,url:i,isEmptyResults:n,pageStore:s}=e;return(0,o.useMemo)((()=>{let e=a()(w.FormattedMessage,{defaultMessage:"Page or URL",id:"selectionLinkButton.currentInfo.pageOrUrl"});const r=!t.focusLinkInput&&n;let l;return s?l={key:"link to page",action:()=>{},render:()=>a()(Ko,{state:t,showPreview:r,store:s})}:i?l={key:"link to web",action:()=>{},render:()=>a()(Ko,{state:t,showPreview:!0})}:(e=void 0,l={key:"create link",action:()=>{},render:()=>a()(Ko,{state:t,showPreview:r})}),{key:"page or url",render:t=>o.createElement(te.Z,se()({title:e},t)),items:[l]}}),[t,i,n,s])}({state:t,url:c,isEmptyResults:!Boolean(d),pageStore:m}),g=function(e){const{state:t,url:i,pageStore:n}=e,{editingToken:s,title:l,focusTitleInput:d}=t,c=(0,r.VK)((()=>n?Fe.Q(n.getTitleValue()):void 0),[n]);return(0,o.useMemo)((()=>{if(s)return{key:"link title",render:e=>o.createElement(te.Z,se()({title:a()(w.FormattedMessage,{defaultMessage:"Link title",id:"selectionLinkButton.currentInfo.linkTitle"})},e)),items:[{key:"update title",action:()=>{},render:()=>a()(Go,{title:l,defaultTitle:c??i,focus:d})}]}}),[s,l,d,i,c])}({state:t,url:c,pageStore:m}),h=function(e){const{state:t}=e,i=function(e){const{state:t}=e,i=(0,s.O7)();return(0,o.useMemo)((()=>{if(t.editingToken)return{key:"unlink",action:()=>{Do.PP(i);const e=(0,Lo.Fs)(t);K.oSR(i,{type:"remove_link",url:e})},render:e=>o.createElement(me.Z,se()({},e,{title:a()(w.FormattedMessage,{id:"selectionLinkButton.removeLink",defaultMessage:"Remove link"}),icon:Ie.Z.trash({width:16})}))}}),[t,i])}({state:t});return(0,o.useMemo)((()=>{const e=U().compact([i]);if(0!==e.length)return{key:"link actions",render:e=>o.createElement(te.Z,se()({topBorder:!0},e)),items:e}}),[i])}({state:t});let f,v;return d?(v=1,f=U().compact([p,d])):(v=void 0,f=U().compact([p,g,h])),{initialFocus:v,sections:f}}function ns(e,t,i,n){const a=(0,No.D)(i);if(!a)return;const{editingToken:o,savedTextSelectionState:s,title:r}=t;Ge.createAndCommit({userAction:"LinkMenu.handleLinkSelection",environment:e,perform:i=>{const l=Do.gp({environment:e,transaction:i,url:a,title:r,editingToken:o,savedTextSelectionState:s});l?(K.oSR(e,{type:"edit_link",url:a}),Vo.Z.setState({...t,...l,url:"",focusLinkInput:!1,focusTitleInput:Boolean(n)})):(K.oSR(e,{type:"create_link",url:a}),Vo.Z.reset())}})}var as=i(23830);function os(){window.__c={n:"LinkMenu"};const e=(0,r.VK)((()=>Vo.Z.state),[]),t=(0,s.Fy)(),i=(0,r.VK)(l.bq,[]),n=(0,r.VK)((()=>{if(!e.open)return!1;if(e.focusLinkInput||e.focusTitleInput)return!1;const t=Ga.default.state;if("editing"!==t.mode)return!0;const i=(0,Wa.QY)(t.multiSelection);if(!i)return!0;const{store:n,selection:a}=i;return(0,yo.wd)(a)?!Fe.oP(n.getValue(),a.startIndex,a.endIndex,Fe.GK.Link):!(0,Wa._v)(t.multiSelection,e.savedTextSelectionState.multiSelection)}),[e]);return(0,o.useEffect)((()=>{n&&Do.F5()}),[n]),a()(N.ZP,{popupType:t.isMobile?t.isTablet?N.ZP.PopupType.Popup:N.ZP.PopupType.SlideUp:N.ZP.PopupType.Popup,style:{width:us(i)},keepFocus:t.isPhone,open:e.open,originRect:e.open?e.selectionRect:void 0,placementToOrigin:N.ZP.Placement.Bottom,alignmentToOrigin:N.ZP.Alignment.Center,originGap:8,disableContentScroll:!0,onDismiss:Do.F5,render:()=>e.open?a()(ss,{state:e}):void 0,preventBlockRenderQueueOnEnter:!t.isMobile})}function ss(e){window.__c={n:"LinkMenuContent"};const{state:t}=e,i=(0,s.MO)(),[n,r]=(0,o.useState)(!0);if((0,o.useEffect)((()=>r(!1)),[]),t.showCreateIn&&!i)return a()(ls,{state:t});let l;return l=i?{menuType:_.og.Modal,title:a()(w.FormattedMessage,{defaultMessage:"Link",id:"selectionLinkButton.mobile.title"}),right:a()(A.CancelMenuText,{}),onClickRight:Do.F5,footer:a()(N.ZP,{popupType:N.ZP.PopupType.SlideUp,open:t.showCreateIn||!1,render:()=>a()(ls,{state:t})})}:{menuType:_.og.Popup},a()(ht.Z,{capture:t.open&&(n||t.focusLinkInput||t.focusTitleInput),allowEsc:!0},void 0,o.createElement(F.Z,l,a()(at.Z,{capture:i&&!t.focusLinkInput&&!t.focusTitleInput,ignoreBlockSelection:!0,restoreSelection:!0,focusOffscreenInput:!0,render:()=>a()(rs,{state:t,useMenuList:is})})),a()(x.Z,{capture:!0,onCommandSlash:Lo.FV}))}function rs(e){window.__c={n:"LinkMenuList"};const{state:t,useMenuList:i}=e,{initialFocus:n,sections:o}=i({state:t});return a()(pe.Z,{type:pe.i.Vertical,initialFocus:n,sections:o})}function ls(e){var t;window.__c={n:"LinkCreateInMenu"};const{state:i}=e,n=(0,s.O7)(),d=(0,o.useCallback)((async e=>{var t;if(!Ro.M_(n))return;const a=null===(t=(0,Wa.QY)(i.savedTextSelectionState.multiSelection))||void 0===t?void 0:t.store;if(!a)return;const{performResult:{createInState:o}}=await Ge.createAndCommitAsync({environment:n,userAction:"LinkMenu.LinkCreateInMenu",waitForServerCommit:!0,perform:async t=>{const o=Bo.f8({environment:n,transaction:t,titleText:i.url||"",createInValue:e,recordStoreParent:a}),[s]=o.createdPages;return s&&(Do.gp({environment:n,url:(0,Eo.nR)({pageId:s.id}),transaction:t,editingToken:i.editingToken,savedTextSelectionState:i.savedTextSelectionState}),Vo.Z.reset()),await o.moveToStorePromise,{createInState:o}}});await Bo.c_({analyticsFrom:"link_menu",createInState:o})}),[i,n]),c=null===(t=(0,Wa.QY)(i.savedTextSelectionState.multiSelection))||void 0===t?void 0:t.store,u=c&&"block"===c.table?c.id:void 0,m=(0,r.VK)(l.bq,[]);return a()(as.Z,{targets:[],isAddTo:!0,isCreateIn:!0,onAccept:d,captureSelection:!1,restoreSelection:!1,parentBlockId:u,onAutocompleteQueryChange:ds,autocompleteQuery:i.createInQuery||"",desktopWidth:us(m),onCancel:cs})}function ds(e){const t=Vo.Z.state;t.open&&Vo.Z.setState({...t,createInQuery:e})}function cs(){const e=Vo.Z.state;e.open&&Vo.Z.setState({...e,showCreateIn:!1,createInQuery:""})}function us(e){return e?400:330}var ms=i(91390),ps=i(65792),gs=i.n(ps),hs=i(79362),fs=i(91584),vs=i(96802),ys=i(34809),Ss=i(5385);const bs="fileTypeAnyFiles",Ms="fileTypeImages",ws="fileTypeVideos",Cs="fileTypeNone";var _s=i(4323),ks=i(21115);class Ts extends Mt.default{getInitialState(){return{inputValue:"",focus:!1,result:void 0,loading:!1,hover:""}}}const Is=Ts;var Ps=i(78609);class Zs extends Mt.default{getInitialState(){return{random_id:""}}}const xs=Zs;var Fs=i(4391);function As(e){window.__c={n:"AiSourcePickerQueryInput"};const{placeholder:t,onSubmit:i}=e,n=(0,Ce.yK)((e=>({wrap:{flexGrow:1,flexShrink:1,boxShadow:e.inputBoxShadow,borderRadius:4,padding:"6px 10px",marginLeft:8,marginRight:8,overflow:"hidden",fontSize:14,..."dark"===e.mode?{backgroundColor:e.inputBackground}:{}},text:{minHeight:60},placeholder:{minHeight:60}})),[]),s=(0,o.useCallback)((e=>{if(i&&!e.shiftKey)i();else{if("editing"!==Ga.default.state.mode)return}}),[i]);return a()("div",{style:n.wrap,className:de.Wh_},void 0,a()(zn.Z,{placeholder:t,disabled:!1,store:e.store,style:n.text,placeholderStyle:n.placeholder,pasteBehavior:"inline",disableSlashCommands:!0,disableEmbedMenu:!0,disableEmojiCommands:!0,disableComment:!0,disableSelectAllBlocks:!0,disableSelectionDrag:!0,onEnter:s,disableMobileActionBar:!1,disableDateReminderMentions:!0,disableStyleAnnotations:!0}))}var Es=i(73657),Bs=i(6202);function Ds(e){window.__c={n:"AiSourcePickerInputWrapper"};const{tab:t}=e,i=(0,s.O7)(),{store:n}=(0,$e.useMockTextStore)({initialValue:void 0,onChange:V.identity}),r=(0,Ce.yK)((e=>({desktopStyle:{marginTop:8,marginBottom:6},sparkleStyle:{width:16,height:16,marginRight:4},captionStyle:{textAlign:i.device.isMobile?"left":"center"}})),[i.device.isMobile]),l=(0,o.useCallback)((async()=>{const i=n.getValue();if(!i)return;const a=[];for(const e of i){var o;if("‣"===e[0]&&null!==(o=e[1])&&void 0!==o&&o.length){if("d"===e[1][0][0]){const t=e[1][0][1].start_date;a.push(t)}else if("u"===e[1][0][0]){const t=e[1][0][1],{currentSpaceStore:i}=m.default.state;if(!i)return{users:[],bots:[]};const n=Q.U6.createChildStore(i,{table:Nt.KJ,id:t});await n.load();const o=n.getEmail();a.push(o||"")}}else a.push(e[0])}const s=a.join(""),r=t.integration;if(s){e.store.setState({...e.store.state,loading:!0});const i=await t.getResults(s,r);e.store.setState({...e.store.state,loading:!1,result:i.results})}}),[n,e.store,t]);return a()("div",{},void 0,a()(te.Z,{desktopStyle:r.desktopStyle},void 0,a()(As,{placeholder:e.placeholder,onSubmit:l,store:n})),a()(te.Z,{},void 0,a()(Bs.Z,{onClick:l,title:t.buttonText||o.createElement(o.Fragment,null,a()(w.FormattedMessage,{defaultMessage:"Ask",id:"mediaPicker.aiSourcePickerTab.askButtonText"}),a()("div",{},void 0,Ie.Z.sparkles(r.sparkleStyle))),fullWidth:e.isSmallWidth})),t.caption&&a()(Es.Z,{shouldWrapCaption:!0,caption:t.caption,style:r.captionStyle}))}var Rs=i(42922),Ls=i(55118);function Ns(e){let{type:t,dropTargetKey:i,children:n,dropzoneStyle:s,onDropFile:l}=e;window.__c={n:"FileDropTarget"};const d=(0,r.VK)((()=>m.default.state.currentSpaceStore),[]);if(!d)return o.createElement(o.Fragment,null,n);const c=e=>1===e.length&&function(e){let{fileMimeType:t,allowedType:i}=e;switch(i){case bs:return!0;case Ms:return function(e){return e.startsWith("image")&&!e.includes("photoshop")}(t);case ws:return function(e){return e.startsWith("video")}(t);case Cs:return!1;default:(0,Ee.t1)(i)}}({allowedType:t,fileMimeType:e[0]}),u=e=>{let{files:t}=e;c(t.map((e=>e.type)))?l({type:"validFileDrop",file:t[0]}):l({type:"invalidFileDrop",file:t[0]})};return a()(E.Z,{store:d,droppable:!0,render:()=>a()(Ls.G,{dropTargetKey:i,canNativeDropOnto:!0,onNativeDrop:u,keepTextSelectionOnDrop:!0,shouldShowDropZone:!0,dropzoneStyle:s,canAcceptDrop:e=>e.isNativeDrag},void 0,n)})}var Os=i(51077),Vs=i(16354),Us=i(62385),Ws=i(30506),Ks=i(91718),zs=i(43001),Gs=i(23321),qs=i(37181),Hs=i(61766),js=i(73063),Qs=i(86825),Ys=i(57670);const $s=(0,w.defineMessages)({selectSpecificIconColor:{defaultMessage:"Select icon color {iconColor}",id:"iconPickerColorPicker.selectSpecificColor"},selectIconColor:{defaultMessage:"Select icon color",id:"iconPickerColorPicker.selectColor"},selectIconColorWithCurrentColor:{defaultMessage:"Select icon color, {iconColor} selected",id:"iconPickerColorPicker.selectColorWithCurrentColor"},noIconColor:{defaultMessage:"no color",id:"iconPickerColorPicker.noColor"}});function Xs(){window.__c={n:"IconPickerColorPicker"};const e=(0,r.VK)((()=>{var e;return null===(e=m.default.state)||void 0===e||null===(e=e.currentUserSettingsStore)||void 0===e||null===(e=e.getSettings())||void 0===e?void 0:e.icon_picker_color}),[]),t=(0,w.useIntl)(),i=(0,s.O7)(),n=(0,Ce.Fg)(),l=(0,s.Fy)(),d=(0,r.qz)(void 0,Hs.Z);return a()(qi.Z,{renderTooltip:()=>t.formatMessage($s.selectIconColor),placement:qi.Z.Placement.Bottom,render:s=>a()(kt.ZP,{preventBlockRenderQueueOnEnter:!0,buttonPopupStore:d,popupType:kt.Z4.Popup,renderOrigin:i=>o.createElement(ee.DO,se()({ariaLabel:t.formatMessage($s.selectIconColorWithCurrentColor,{iconColor:t.formatMessage(e?hs.RR[e]:$s.noIconColor)}),icon:t=>Ie.Z.colorPickerCircle({...t,stroke:e?hs.Lr[n.mode][e]:hs.Lr[n.mode].lightgray,fill:e?hs.Lr[n.mode][e]:n.lightIconColor})},(0,Wi.Z)(i,s))),render:s=>function(e){const{parent:t,environment:i,currentIconPickerColor:n,theme:s,device:r,intl:l}=e,d=hs.Oe.map((e=>({key:e,action:n=>{t.close(),Js({environment:i,color:e})},render:t=>a()(qi.Z,{renderTooltip:()=>l.formatMessage(hs.RR[e]),placement:qi.Z.Placement.Bottom,render:i=>o.createElement(js.Z,se()({},(0,Wi.Z)(i,t),{ariaLabel:l.formatMessage($s.selectSpecificIconColor,{iconColor:l.formatMessage(hs.RR[e])}),style:{...r.isMobile?{width:Ys.Z.mobileButtonSize,height:Ys.Z.mobileButtonSize}:{width:Ys.Z.desktopButtonSize,height:Ys.Z.desktopButtonSize}},icon:t=>Ie.Z.colorPickerCircle({...t,height:r.isMobile?18:14,width:r.isMobile?18:14,stroke:hs.Lr[s.mode][e],fill:hs.Lr[s.mode][e]})}))})})));return d.push({key:"askEveryTime",action:()=>{t.close(),Js({environment:i,color:void 0})},render:e=>o.createElement(Qs.Z,se()({},e,{title:a()(w.FormattedMessage,{id:"iconPickerColorPicker.askEveryTime",defaultMessage:"Ask every time"}),onClick:()=>{Js(void 0!==n?{environment:i,color:void 0}:{environment:i,color:"gray"})},on:void 0===n,style:{boxShadow:void 0},textWrapperStyle:{marginLeft:r.isMobile?10:6},rightStyle:{marginRight:4}}))}),a()(ht.Z,{capture:!0,allowEsc:!0},void 0,a()(pe.Z,{type:pe.i.Grid,itemsPerRow:5,initialFocus:n?Math.max(hs.Oe.indexOf(n),0):10,sections:[{key:"variations",render:e=>o.createElement("div",e),items:d}],renderRow:(e,t)=>a()("div",{style:{display:"flex",padding:4,...t<2&&void 0===n&&{opacity:.5},...2===t&&{padding:"0 0 4px 0",flexDirection:"row-reverse"}}},t,e)}))}({parent:s,environment:i,currentIconPickerColor:e,theme:n,device:l,intl:t})})})}function Js(e){const{environment:t,color:i}=e,{currentUserSettingsStore:n}=m.default.state;n&&Ge.createAndCommit({userAction:"mediaPicker.setIconPickerColor",environment:t,perform:e=>{const t=void 0!==i?i:null;qs.d2({userSettingsStore:n,transaction:e,data:{icon_picker_color:t}})}})}var er=i(42402),tr=i(78948);const ir=(0,w.defineMessages)({embedPlaceholder:{id:"mediaPicker.embedPlaceholder.text",defaultMessage:"Paste in https://…"},filterPlaceholder:{id:"mediaPicker.emojiFilter.text",defaultMessage:"Filter…"},unsplashPlaceholder:{id:"mediaPicker.unsplashPlaceholder.text",defaultMessage:"Search for an image…"},giphyPlaceholder:{id:"mediaPicker.giphyPlaceholder.text",defaultMessage:"Search GIPHY"},aiSourcePickerPlaceholder:{id:"mediaPicker.githubPlaceholder.text",defaultMessage:"Ask query here"},aiIsFetchingLoader:{id:"mediaPicker.aiIsFetchingLoader.text",defaultMessage:"Ai is fetching"}});class nr extends b.Z{constructor(){super(...arguments),this.menuRef=o.createRef(),this.storeTypes={embedInputStore:xn.Z,emojiInputStore:xn.Z,iconInputStore:xn.Z,iconPickerStore:Fs.Z,unsplashInputStore:xn.Z,giphyInputStore:xn.Z,giphyRandomIdStore:xs,aiSourcePickerStore:Is},this.renderUnsplashResults=(e,t,i,n)=>n?!i||i&&!i.length?a()(Es.Z,{shouldWrapCaption:!0,caption:a()(w.FormattedMessage,{defaultMessage:"No results found.",id:"mediaPicker.unsplash.noResultsText"}),style:{textAlign:this.props.isSmallWidth?"left":"center",color:this.theme.mediumTextColor}}):a()(o.Fragment,{},void 0,i.map((t=>this.renderUnsplashImage(e,t))),a()(Es.Z,{shouldWrapCaption:!0,caption:a()(w.FormattedMessage,{defaultMessage:"Search to find more results.",id:"mediaPicker.unsplash.searchText"}),style:{textAlign:this.props.isSmallWidth?"left":"center",color:this.theme.mediumTextColor}})):a()("div",{style:this.getLoadingContainerStyle()},void 0,a()(st.Z,{})),this.renderUnsplashImage=(e,t)=>{const{device:i}=this.environment;return a()("div",{style:{width:i.isMobile?"33%":"25%",padding:3}},t.id,a()(Xi.Z,{hoveredStyle:{opacity:.85},onClick:()=>this.handleSelectUnsplashImage(e,t)},void 0,a()(Gi.Z,{src:t.thumbUrl,style:{width:"100%",height:64,objectFit:"cover",objectPosition:"center 0%",borderRadius:3}})),a()(Se.Z,{isSmall:!0,isSecondaryColor:!0,style:{marginTop:2,marginBottom:4}},void 0,a()(w.FormattedMessage,{defaultMessage:"by <inlinetextlink>{authorName}</inlinetextlink>",id:"mediaPicker.unsplash.byAuthor",values:{authorName:t.authorName,inlinetextlink:e=>a()(er.Z,{external:!0,href:t.unsplashUrl},void 0,e)}})))},this.renderGiphyResults=(e,t,i,n)=>n?!i||i&&!i.length?a()(Es.Z,{shouldWrapCaption:!0,caption:a()(w.FormattedMessage,{defaultMessage:"No results found.",id:"mediaPicker.giphy.noResultsText"}),style:{textAlign:this.props.isSmallWidth?"left":"center",color:this.theme.mediumTextColor}}):a()(o.Fragment,{},void 0,i.map((t=>this.renderGiphyImage(e,t))),a()(Es.Z,{shouldWrapCaption:!0,caption:a()(w.FormattedMessage,{defaultMessage:"Search to find more results.",id:"mediaPicker.giphy.searchText"}),style:{textAlign:this.props.isSmallWidth?"left":"center",color:this.theme.mediumTextColor}})):a()("div",{style:this.getLoadingContainerStyle()},void 0,a()(st.Z,{})),this.renderGiphyImage=(e,t)=>{const{device:i}=this.environment;return a()("div",{style:{width:i.isMobile?"33%":"25%",padding:3}},t.id,a()(Xi.Z,{hoveredStyle:{opacity:.85},onClick:()=>this.handleSelectGiphyImage(e,t)},void 0,a()(Gi.Z,{src:t.thumbUrl,style:{width:"100%",height:64,objectFit:"cover",objectPosition:"center 0%",borderRadius:3}})),a()(Se.Z,{isSmall:!0,isSecondaryColor:!0,style:{marginTop:2,marginBottom:4}},void 0,a()(w.FormattedMessage,{defaultMessage:"by <inlinetextlink>{authorName}</inlinetextlink>",id:"mediaPicker.giphy.byAuthor",values:{authorName:t.authorName||"GIPHY",inlinetextlink:e=>a()(er.Z,{external:!0,href:t.imageUrl},void 0,e)}})))},this.handleEmbedSubmit=e=>()=>{const t=this.stores.embedInputStore.state.inputValue;if(t){const i=(0,vt.Wv)(t,bt.default.secureFileS3.url,bt.default.secureFileS3V2.url,bt.default.secureFileConfig.rootPath,bt.default.secureFileConfig.hostname),n=i?i.link:t;e.onChange(n),K.bOx(this.environment,{pastedText:n,source:"media_picker"})}},this.handleAiSourcePickerSubmit=(e,t)=>()=>{e&&t.onChange(e)},this.handleSelectUnsplashImage=async(e,t)=>{const i=await(0,ys.ZP)({environment:this.environment,url:t.downloadUrl,method:"GET",format:"json"});"success"===i.type&&e.onChange({url:i.data.url})},this.performGiphyGetRandomIdRequest=async()=>{const{giphyRandomIdStore:e}=this.stores;if(!U().isEmpty(e.getState().random_id))return e.getState().random_id;const t=await oi.getGiphyRandomId(this.environment,{});return"success"===t.type?(e.setState({...e.state,random_id:t.data.random_id}),t.data.random_id):void 0},this.handleSelectGiphyImage=async(e,t)=>{var i;if(e.onChange({url:t.imageUrl}),null!==(i=t.analytics)&&void 0!==i&&i.onclick)try{var n;await oi.postGiphyAnalytics(this.environment,{url:null===(n=t.analytics)||void 0===n?void 0:n.onclick.url,timestamp:Date.now(),random_id:this.stores.giphyRandomIdStore.state.random_id})}catch(a){}},this.handleSwipeLeft=()=>{if(!ms.Z.state.isActive)return;const e=this.getTabs(),t=e.map((e=>e.type)).indexOf(ms.Z.state.currentTab),i=e[t+1];void 0!==i&&this.handleTabChange(i.type)},this.handleSwipeRight=()=>{if(!ms.Z.state.isActive)return;const e=this.getTabs(),t=e.map((e=>e.type)).indexOf(ms.Z.state.currentTab),i=e[t-1];void 0!==i&&this.handleTabChange(i.type)},this.handleTabChange=e=>{ms.Z.state.isActive&&(ms.Z.setState({...ms.Z.state,currentTab:e}),"icon"===e&&ms.Z.state.recordIconLoggingData&&K.kz9(this.environment,"select_icon_tab",ms.Z.state.recordIconLoggingData))},this.handleRandomEmojiClick=()=>{const{device:e}=this.environment,t=this.getTabs().find((e=>e.type===this.props.currentTab));if(t&&"emoji"===t.type){const i=vs.zM();t.onChange(i,{keepVisible:!e.isMobile})}},this.handleRandomIconClick=()=>{const{device:e}=this.environment,{iconPickerStore:t}=this.stores,i=this.getTabs().find((e=>e.type===this.props.currentTab));if(i&&"icon"===i.type){const n=i.enforceIconColor??Ss.x(),a=`/icons/${U().sample(Object.keys(t.getState().allIcons))}_${n??U().sample(hs.Oe)}.svg`;i.onChange(a,{keepVisible:!e.isMobile})}},this.handleFilterChange=e=>{const{emojiInputStore:t,iconInputStore:i,iconPickerStore:n}=this.stores,a=this.getNumIconPerRow()*(this.environment.device.isMobile?eo.pq:eo.II),o=this.getNumIconPerRow()*(this.environment.device.isMobile?Gs.L6:Gs.OF);t.setState({...t.state,inputValue:e.currentTarget.value}),Ps.Z.setState({...Ps.Z.state,loadEmojiCount:a}),i.setState({...i.state,inputValue:e.currentTarget.value}),n.setState({...n.state,loadIconCount:o})}}renderComponent(){const{device:e}=this.environment,t=this.renderTabsHeader(),i=this.renderInputHeader(),n=(t||i)&&a()(o.Fragment,{},void 0,t,i);let s;if(e.isMobile)s={menuType:_.og.Modal,title:this.props.title,header:n,right:a()(w.FormattedMessage,{defaultMessage:"Close",id:"mediaPicker.mobileCloseButton.label"}),onClickRight:this.props.onCancel,left:this.props.onDelete&&a()(w.FormattedMessage,{defaultMessage:"Remove",id:"mediaPicker.mobileRemoveButton.label"}),onClickLeft:this.props.onDelete};else{s={menuType:_.og.Popup,header:n};const e=this.getTabs().find((e=>e.type===this.props.currentTab)),t=e&&"custom"===e.type?e.tabHeight:void 0;s.width=this.props.popupWidth||300,s.height=t||this.props.popupHeight,s.maxHeight=this.props.maxHeight,s.maxWidth=this.props.maxWidth}return a()(Ws.Z,{onSwipeLeft:this.handleSwipeLeft,onSwipeRight:this.handleSwipeRight,render:e=>o.createElement(F.Z,se()({},s,e,{className:de.tQh,innerRef:this.menuRef}),this.renderCurrentTab())})}renderTabsHeader(){const{device:e}=this.environment;if(!(this.getTabs().length<=1)||this.props.onDelete){const t={gallery:a()(w.FormattedMessage,{id:"mediaPicker.tabs.gallery",defaultMessage:"Gallery"}),embed:a()(w.FormattedMessage,{id:"mediaPicker.tabs.embedLink",defaultMessage:"Embed link"}),file:a()(w.FormattedMessage,{id:"mediaPicker.tabs.upload",defaultMessage:"Upload"}),emoji:a()(w.FormattedMessage,{id:"mediaPicker.tabs.emoji",defaultMessage:"Emoji"}),icon:a()(w.FormattedMessage,{id:"mediaPicker.tabs.icon",defaultMessage:"Icon"}),custom:a()(w.FormattedMessage,{id:"mediaPicker.tabs.custom",defaultMessage:"Custom"}),unsplash:a()(o.Fragment,{},void 0,Ie.Z.unsplashLogo({width:12,marginRight:4,height:12}),a()("span",{},void 0,"Unsplash")),giphy:a()(o.Fragment,{},void 0,Ie.Z.giphyLogo({width:12,marginRight:4,height:12}),a()("span",{},void 0,"GIPHY")),drive:a()(w.FormattedMessage,{id:"mediaPicker.tabs.browse",defaultMessage:"Browse"}),box:a()(w.FormattedMessage,{id:"mediaPicker.tabs.browse",defaultMessage:"Browse"}),aiSourcePicker:a()("div",{style:{display:"flex",flexDirection:"row"}},void 0,a()(w.FormattedMessage,{id:"mediaPicker.tabs.ask",defaultMessage:"Ask"}),Ie.Z.sparkles({width:16,height:16,marginRight:4,color:this.theme.accentColors.purple[400]}))},i=this.getTabs(),n=i.findIndex((e=>e.type===this.props.currentTab)),s=i.map((e=>e.title||t[e.type])),r=i.find((e=>e.type===this.props.currentTab)),l=r&&"emoji"!==r.type&&e.isAndroid;return a()(B.Z,{tabs:s,selectedIndex:n,onChange:e=>{const t=i[e];this.handleTabChange(t.type)},right:this.props.onDelete&&!e.isMobile&&a()(rt.Z,{isGray:!0,onClick:this.props.onDelete},void 0,a()(w.FormattedMessage,{id:"mediaPicker.tabs.remove",defaultMessage:"Remove"})),style:{...l&&{borderBottom:"none"}}})}}renderInputHeader(){const{isPhone:e,isMobile:t,isAndroid:i}=this.environment.device,n=this.getTabs().find((e=>e.type===this.props.currentTab));if(n&&("emoji"===n.type||"icon"===n.type)){const s="emoji"===n.type?this.stores.emojiInputStore.state.inputValue:this.stores.iconInputStore.state.inputValue,r="emoji"===n.type?this.handleRandomEmojiClick:this.handleRandomIconClick,l=this.renderColorPicker({hasRandomButtonOnLeft:!n.hideRandomButton});return a()("div",{style:{display:"flex",...e?{}:{marginTop:16,marginBottom:10}}},void 0,a()(ee.ZP,{value:s,placeholder:ce.default.formatMessage(ir.filterPlaceholder),autoFocus:!t||void 0,focus:!t||void 0,showClearButton:!0,inputLeft:a()(ee.f_,{icon:Ie.Z.search}),onChange:this.handleFilterChange,right:a()("div",{style:{display:"flex"}},void 0,null!=n&&n.hideRandomButton?void 0:a()(qi.Z,{renderTooltip:()=>a()(w.FormattedMessage,{id:"mediaPicker.emojiTab.random",defaultMessage:"Random"}),placement:qi.Z.Placement.Bottom,render:e=>o.createElement(ee.DO,se()({icon:Ie.Z.shuffle,onClick:r},e))}),l),isRightLastElementOfInput:!0,style:{...i&&{borderBottom:"none"}}}))}}renderColorPicker(e){const t=this.getTabs().find((e=>e.type===this.props.currentTab));if(!t)return null;let i;return"emoji"===(null==t?void 0:t.type)?i=a()(zs.Z,{}):"icon"===(null==t?void 0:t.type)&&void 0===t.enforceIconColor&&(i=a()(Xs,{})),e.hasRandomButtonOnLeft&&i?a()("div",{style:{marginLeft:6}},void 0,i):i}renderCurrentTab(){const e=this.getTabs().find((e=>e.type===this.props.currentTab));if(!e)return a()(w.FormattedMessage,{defaultMessage:"Uh oh! Something went wrong.",id:"mediaPicker.errorMessage"});switch(e.type){case"embed":return this.renderEmbedTab(e);case"file":return this.renderUploadTab(e);case"emoji":return this.renderEmojiTab(e);case"icon":return this.renderIconTab(e);case"gallery":return this.renderGalleryTab(e);case"unsplash":return this.renderUnsplashTab(e);case"giphy":return this.renderGiphyTab(e);case"drive":return this.renderGoogleDriveTab(e);case"box":return this.renderBoxTab(e);case"aiSourcePicker":return this.renderAiSourcePickerTab(e);case"custom":return this.renderCustomEmbedUploadTab(e)}}renderEmojiTab(e){return a()(eo.ZP,{onSubmit:e.onChange,filter:this.stores.emojiInputStore.state.inputValue||"",isCallout:this.props.isCallout,iconLoggingData:this.props.recordIconLoggingData,menuRef:this.menuRef})}renderIconTab(e){return a()(Gs.ZP,{store:this.stores.iconPickerStore,filter:this.stores.iconInputStore.state.inputValue||"",onSubmit:e.onChange,iconLoggingData:this.props.recordIconLoggingData,enforceIconColor:e.enforceIconColor,menuRef:this.menuRef})}renderGalleryTab(e){return a()("div",{style:{paddingBottom:8}},void 0,U().map(_s.Z,((t,i)=>a()(te.Z,{title:a()(Vs.Z,{style:{marginLeft:-5},href:t.url,external:!0},void 0,a()(Us.Z,{},void 0,ce.default.formatMessage(t.title))),isTitleUppercase:!0,noTextOverflow:!0},i,a()("div",{style:this.getGalleryWrapStyle()},void 0,t.items.map(((t,i)=>{let{coverUrl:n,title:s,subtitle:r,position:l}=t;return a()("div",{style:{width:"25%",padding:3}},i,a()(qi.Z,{originGap:0,placement:qi.Z.Placement.Bottom,delayThreshold:600,renderTooltip:()=>a()("div",{style:{maxWidth:180,whiteSpace:"normal"}},void 0,a()("span",{style:{color:this.theme.regularInvertedTextColor}},void 0,ce.default.formatMessage(s))," ",a()("span",{style:{color:this.theme.mediumInvertedTextColor}},void 0,r&&ce.default.formatMessage(r))),render:t=>o.createElement(Xi.Z,se()({hoveredStyle:{opacity:.85}},t,{onClick:()=>{e.onChange({url:n,position:l})}}),a()(Tt.Z,{url:n,width:200,isAuthenticated:!1,render:(e,t)=>t&&a()(Gi.Z,{src:t,style:{width:"100%",height:64,objectFit:"cover",objectPosition:`center ${100*(l||0)}%`,borderRadius:3}})}))}))})))))))}renderUnsplashTab(e){const{device:t}=this.environment;return a()("div",{style:{paddingBottom:8}},void 0,a()(te.Z,{desktopStyle:{marginTop:8,marginBottom:6}},void 0,a()(ee.ZP,{value:this.stores.unsplashInputStore.state.inputValue,placeholder:ce.default.formatMessage(ir.unsplashPlaceholder),showClearButton:!0,focus:!t.isMobile||void 0,onChange:e=>{this.stores.unsplashInputStore.setState({...this.stores.unsplashInputStore.state,inputValue:e.target.value})}})),a()("div",{style:this.getGalleryWrapStyle()},void 0,a()(Wt.Z,{request:this.stores.unsplashInputStore.state.inputValue,debounce:Ot.vp,performRequest:async e=>{const t=await oi.searchUnsplashImages(this.environment,{query:e,page:0});if("success"===t.type)return t.data.results;throw t.error},render:(t,i,n)=>this.renderUnsplashResults(e,t,i,n)})))}renderGiphyTab(e){const{device:t}=this.environment;return a()("div",{style:{paddingBottom:8}},void 0,a()(te.Z,{desktopStyle:{marginTop:8,marginBottom:6}},void 0,a()(ee.ZP,{value:this.stores.giphyInputStore.state.inputValue,placeholder:ce.default.formatMessage(ir.giphyPlaceholder),showClearButton:!0,focus:!t.isMobile||void 0,onChange:e=>{this.stores.giphyInputStore.setState({...this.stores.giphyInputStore.state,inputValue:e.target.value})}})),a()("div",{style:this.getGalleryWrapStyle()},void 0,a()(Wt.Z,{request:this.stores.giphyInputStore.state.inputValue,debounce:Ot.vp,performRequest:async e=>{await this.performGiphyGetRandomIdRequest();const t=await oi.searchGiphyImages(this.environment,{query:e,page:0});if("success"===t.type)return t.data.results;throw t.error},render:(t,i,n)=>this.renderGiphyResults(e,t,i,n)})))}renderCustomEmbedUploadTab(e){const{device:t}=this.environment,{data:i}=it.default.state,n=a()(Rs.Z,{onClick:this.handleEmbedSubmit(e),disabled:0===this.stores.embedInputStore.state.inputValue.length,hovered:!1},void 0,e.buttonText||a()(w.FormattedMessage,{defaultMessage:"Link",id:"mediaPicker.embedTab.embedLinkButtonText"})),s=a()(te.Z,{desktopStyle:{marginTop:16,display:"flex",paddingTop:0,paddingBottom:12}},void 0,a()(ee.ZP,{type:"url",value:this.stores.embedInputStore.state.inputValue,placeholder:e.inputPlaceholder||ce.default.formatMessage(ir.embedPlaceholder),autoFocus:!t.isMobile||void 0,showClearButton:!0,focus:!t.isMobile||void 0,onSubmit:this.handleEmbedSubmit(e),onChange:e=>{this.stores.embedInputStore.setState({...this.stores.embedInputStore.state,inputValue:e.target.value})},inputRight:t.isPhone?n:void 0,right:t.isPhone?void 0:n,isRightLastElementOfInput:!0})),r=a()(Ns,{type:this.getAllowedFileTypeFromTab(e)??Cs,dropTargetKey:"uploadTab",onDropFile:t=>{"invalidFileDrop"!==t.type?e.onUpload(t.file):da.oV({label:a()(w.FormattedMessage,{id:"mediaPicker.invalidImageDrop.wrongTypeErrorMessage",defaultMessage:"Sorry, that file type is not supported."})})},dropzoneStyle:{background:(0,xi.fn)([xi.ZP.blueWithAlpha(.14),gs()(this.theme.contentBackground).alpha(.5).css()])}},void 0,a()("div",{style:{marginTop:-24,paddingTop:24}},void 0,e.fileUpload&&a()(te.Z,{desktopStyle:{marginTop:this.props.isSmallWidth?8:24}},void 0,a()(Bs.Z,{title:a()(w.FormattedMessage,{defaultMessage:"Choose a file",id:"mediaPicker.chooseFile.button.label"}),onClick:()=>this.handleUpload(e),fullWidth:this.props.isSmallWidth})),this.renderMediaCapture(e),e.caption&&a()(Es.Z,{shouldWrapCaption:!0,caption:e.caption,style:{textAlign:this.props.isSmallWidth?"left":"center",color:this.theme.mediumTextColor}}),e.preventUploadLimitFreeFileSize||i&&ks.YK(i)&&a()("div",{style:{height:8}}),i&&!e.preventUploadLimitFreeFileSize&&!ks.YK(i)&&a()(Es.Z,{shouldWrapCaption:!0,caption:a()("div",{style:{display:"flex",alignItems:"center",justifyContent:this.props.isSmallWidth?"flex-start":"center"}},void 0,a()("div",{style:{marginRight:6,color:this.theme.mediumTextColor}},void 0,a()(w.FormattedMessage,{defaultMessage:"The maximum size per file is {filesize} MB.",id:"mediaPicker.maximumFileSize.notice",values:{filesize:ut.K_}})),!Ea.default.isOnboarding.state&&a()(Ks.Z,{subscriptionTier:ks.M9(this.environment)||"plus",onClick:()=>{this.props.onCancel&&this.props.onCancel()},analyticsName:"media_picker",desktopStyle:{marginBottom:1}}))})));return o.createElement(o.Fragment,null,s,r)}renderUploadTab(e){const{data:t}=it.default.state;return a()(Ns,{type:this.getAllowedFileTypeFromTab(e)??Cs,dropTargetKey:"uploadTab",onDropFile:t=>{"invalidFileDrop"!==t.type?e.onUpload(t.file):da.oV({label:a()(w.FormattedMessage,{id:"mediaPicker.invalidImageDrop.wrongTypeErrorMessage",defaultMessage:"Sorry, that file type is not supported."})})},dropzoneStyle:{background:(0,xi.fn)([xi.ZP.blueWithAlpha(.14),gs()(this.theme.contentBackground).alpha(.5).css()])}},void 0,a()("div",{style:{marginTop:-24,paddingTop:24}},void 0,e.fileUpload&&a()(te.Z,{desktopStyle:{marginTop:this.props.isSmallWidth?8:24}},void 0,a()(Bs.Z,{title:a()(w.FormattedMessage,{defaultMessage:"Choose a file",id:"mediaPicker.chooseFile.button.label"}),onClick:()=>this.handleUpload(e),fullWidth:this.props.isSmallWidth})),this.renderMediaCapture(e),e.caption&&a()(Es.Z,{shouldWrapCaption:!0,caption:e.caption,style:{textAlign:this.props.isSmallWidth?"left":"center",color:this.theme.mediumTextColor}}),e.preventUploadLimitFreeFileSize||t&&ks.YK(t)&&a()("div",{style:{height:8}}),t&&!e.preventUploadLimitFreeFileSize&&!ks.YK(t)&&a()(Es.Z,{shouldWrapCaption:!0,caption:a()("div",{style:{display:"flex",alignItems:"center",justifyContent:this.props.isSmallWidth?"flex-start":"center"}},void 0,a()("div",{style:{marginRight:6,color:this.theme.mediumTextColor}},void 0,a()(w.FormattedMessage,{defaultMessage:"The maximum size per file is {filesize} MB.",id:"mediaPicker.maximumFileSize.notice",values:{filesize:ut.K_}})),!Ea.default.isOnboarding.state&&a()(Ks.Z,{subscriptionTier:ks.M9(this.environment)||"plus",onClick:()=>{this.props.onCancel&&this.props.onCancel()},analyticsName:"media_picker",desktopStyle:{marginBottom:1}}))})))}renderMediaCapture(e){if(e.imageUpload||e.videoUpload)return a()(te.Z,{desktopStyle:{marginTop:4,display:"flex",justifyContent:"center",marginRight:12,marginLeft:12}},void 0,e.imageUpload&&a()(ka.Z,{isLarge:!0,onClick:()=>this.handleUpload(e,"image/*"),style:{width:"100%"}},void 0,a()(w.FormattedMessage,{defaultMessage:"Upload file",id:"mediaPicker.chooseImage.buttonText"})),e.videoUpload&&a()(Bs.Z,{title:a()(w.FormattedMessage,{defaultMessage:"Choose a video",id:"mediaPicker.chooseVideo.buttonText"}),onClick:()=>this.handleUpload(e,"video/*"),fullWidth:this.props.isSmallWidth}))}renderEmbedTab(e){const{device:t}=this.environment;return a()(o.Fragment,{},void 0,a()(te.Z,{desktopStyle:{marginTop:8,marginBottom:6}},void 0,a()(ee.ZP,{type:"url",value:this.stores.embedInputStore.state.inputValue,placeholder:e.inputPlaceholder||ce.default.formatMessage(ir.embedPlaceholder),autoFocus:!t.isMobile||void 0,showClearButton:!0,focus:!t.isMobile||void 0,onSubmit:this.handleEmbedSubmit(e),onChange:e=>{this.stores.embedInputStore.setState({...this.stores.embedInputStore.state,inputValue:e.target.value})}})),a()(te.Z,{},void 0,a()(Bs.Z,{onClick:this.handleEmbedSubmit(e),title:e.buttonText||a()(w.FormattedMessage,{defaultMessage:"Link",id:"mediaPicker.embedTab.embedLinkButtonText"}),fullWidth:this.props.isSmallWidth})),e.caption&&a()(Es.Z,{shouldWrapCaption:!0,caption:e.caption,style:{textAlign:t.isMobile?"left":"center"}}))}renderGoogleDriveTab(e){return"accounts"in e?this.renderGoogleDriveAccounts(e):a()(Wt.Z,{request:this.environment,performRequest:fs.vQ,render:(t,i,n)=>{if(!n)return a()(te.Z,{},void 0,a()(tr.Z,{}));const o=i&&i.accounts?i.accounts:[];return this.renderGoogleDriveAccounts(e,o)}})}renderGoogleDriveAccounts(e,t){return"accounts"in e?e.accounts&&0===e.accounts.length?this.renderGoogleDriveConnectAccountOption(e):a()(o.Fragment,{},void 0,a()(te.Z,{},void 0,e.accounts.map(((t,i)=>a()(me.Z,{title:a()(w.FormattedMessage,{defaultMessage:"Choose from {accountName}",id:"mediaPicker.menuItem.choosePagesFromAccount.label",values:{accountName:t.account_name}}),onClick:()=>e.onSelect(t),focused:!1},t.account_key)))),a()(te.Z,{topBorder:!0},void 0,a()(me.Z,{title:a()(w.FormattedMessage,{defaultMessage:"Connect another account",id:"mediaPicker.menuItem.connectMoreGoogleAccounts.label"}),onClick:()=>e.onSelect(),style:{color:this.theme.mediumTextColor},focused:!1}))):t?0===t.length?this.renderGoogleDriveConnectAccountOption(e):a()(o.Fragment,{},void 0,a()(te.Z,{},void 0,t.map(((t,i)=>a()(me.Z,{title:a()(w.FormattedMessage,{defaultMessage:"Choose from {accountName}",id:"mediaPicker.menuItem.choosePagesFromAccount.label",values:{accountName:t.accountName}}),onClick:()=>e.onSelect(t),focused:!1},t.accountId)))),a()(te.Z,{topBorder:!0},void 0,a()(me.Z,{title:a()(w.FormattedMessage,{defaultMessage:"Connect another account",id:"mediaPicker.menuItem.connectMoreGoogleAccounts.label"}),onClick:()=>e.onSelect(),style:{color:this.theme.mediumTextColor},focused:!1}))):void 0}renderGoogleDriveConnectAccountOption(e){return a()(te.Z,{},void 0,a()(me.Z,{title:a()(w.FormattedMessage,{defaultMessage:"Connect Google account",id:"mediaPicker.menuItem.connectFirstGoogleAccount.label"}),onClick:()=>e.onSelect(),focused:!1,style:{color:this.theme.blueColor}}),a()(Es.Z,{shouldWrapCaption:!1,caption:a()(w.FormattedMessage,{defaultMessage:"Find and embed your Google Drive files.",id:"mediaPicker.menuItem.connectFirstGoogleAccount.caption"})}))}renderAiSourcePickerTab(e){var t,i;return a()(o.Fragment,{},void 0,this.stores.aiSourcePickerStore.state.result&&!1===this.stores.aiSourcePickerStore.state.loading&&(0===(null===(t=this.stores.aiSourcePickerStore.state.result)||void 0===t?void 0:t.length)?a()(Es.Z,{shouldWrapCaption:!0,caption:a()(w.FormattedMessage,{defaultMessage:"No results found.",id:"mediaPicker.aiSourcePicker.noResultsText"}),style:{textAlign:this.props.isSmallWidth?"left":"center",color:this.theme.mediumTextColor}}):null===(i=this.stores.aiSourcePickerStore.state.result)||void 0===i?void 0:i.map((t=>a()("div",{style:{cursor:"pointer",color:this.theme.mediumTextColor,textAlign:"left",hyphens:"auto",padding:"10px 8px",backgroundColor:this.stores.aiSourcePickerStore.state.hover===t.url?"rgba(55,53,47,0.08)":"",display:"flex",flexDirection:"row"},onClick:this.handleAiSourcePickerSubmit(t.url,e),onMouseEnter:()=>{this.stores.aiSourcePickerStore.setState({...this.stores.aiSourcePickerStore.state,hover:t.url})}},t.url,a()(Os.Z,{imageURL:"NONE"===t.avatar?e.defaultAvatar:t.avatar,size:24,imageStyle:{borderRadius:34,boxShadow:"0 2px 4px rgba(15, 15, 15, 0.1)"},type:"image_url"}),a()("div",{style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",color:"rgb(55, 53, 47)",fontWeight:500,fontSize:"14px",paddingLeft:8}},void 0,t.title))))),this.stores.aiSourcePickerStore.state.loading&&a()("div",{style:{flex:1,color:this.theme.accentColors.purple[400],fontWeight:500,flexDirection:"row",gap:6,display:"flex",alignItems:"center",padding:"12px 12px",marginLeft:10}},void 0,a()(w.FormattedMessage,{id:"aiSourcePicker.loadingMessage.fetching",defaultMessage:ce.default.formatMessage(ir.aiIsFetchingLoader)}),a()(ot.Z,{style:{backgroundColor:this.theme.accentColors.purple[400]}})),!this.stores.aiSourcePickerStore.state.result&&!this.stores.aiSourcePickerStore.state.loading&&a()(Ds,{tab:e,placeholder:e.inputPlaceholder||ce.default.formatMessage(ir.aiSourcePickerPlaceholder),store:this.stores.aiSourcePickerStore,isSmallWidth:this.props.isSmallWidth}))}renderBoxTab(e){const{accounts:t}=e;return 0===t.length?a()(te.Z,{},void 0,a()(me.Z,{title:a()(w.FormattedMessage,{defaultMessage:"Connect Box account",id:"mediaPicker.menuItem.connectFirstBoxAccount.label"}),onClick:()=>e.onSelect(),focused:!1,style:{color:this.theme.blueColor}}),a()(Es.Z,{shouldWrapCaption:!1,caption:a()(w.FormattedMessage,{defaultMessage:"Find and embed your Box files.",id:"mediaPicker.menuItem.connectFirstBoxAccount.caption"})})):o.createElement(o.Fragment,null,a()(te.Z,{},void 0,t.map((t=>a()(me.Z,{title:a()(w.FormattedMessage,{defaultMessage:"Choose from {accountName}",id:"mediaPicker.menuItem.choosePagesFromAccount.label",values:{accountName:t.account_name}}),onClick:()=>e.onSelect(t),focused:!1},t.account_key)))),a()(te.Z,{topBorder:!0},void 0,a()(me.Z,{title:a()(w.FormattedMessage,{defaultMessage:"Connect another account",id:"mediaPicker.menuItem.connectMoreBoxAccounts.label"}),onClick:()=>e.onSelect(),style:{color:this.theme.mediumTextColor},focused:!1})))}getTabs(){return this.props.tabs}getAllowedFileTypeFromTab(e){return e.fileUpload?bs:e.imageUpload?Ms:e.videoUpload?ws:void 0}async handleUpload(e,t){const i=await ut.y({multiple:!1,accept:t});i.length&&e.onUpload(i[0])}getNumIconPerRow(){var e,t;return null!==(e=this.menuRef)&&void 0!==e&&null!==(e=e.current)&&void 0!==e&&e.offsetWidth?((null===(t=this.menuRef)||void 0===t||null===(t=t.current)||void 0===t?void 0:t.offsetWidth)-24)/32:12}getLoadingContainerStyle(){return{display:"flex",alignItems:"center",justifyContent:"center",minHeight:320,flex:1}}getGalleryWrapStyle(){const{device:e,WindowSizeStore:t}=this.environment;return{display:"flex",flexWrap:"wrap",alignContent:"flex-start",background:this.theme.popoverBackground,paddingTop:e.isPhone?12:0,paddingBottom:e.isPhone?12:0,paddingLeft:e.isPhone?t.getSafePaddingLeftCSS(14):12,paddingRight:e.isPhone?t.getSafePaddingRightCSS(14):12,boxShadow:e.isPhone?`0 1px 0 ${this.theme.regularDividerColor}`:""}}}nr.displayName="MediaPicker";const ar=nr;class or extends b.Z{constructor(){super(...arguments),this.handleCloseOverlay=()=>{ct.Z()}}renderComponent(){const{device:e}=this.environment,{state:t}=ms.Z;return a()(N.ZP,{popupType:e.isMobile?N.ZP.PopupType.SlideUp:N.ZP.PopupType.Popup,open:t.isActive,originRect:t.isActive?t.originRect:void 0,originGap:t.isActive?t.originGap:void 0,placementToOrigin:N.ZP.Placement.Bottom,alignmentToOrigin:N.ZP.Alignment.Center,preventScaleTransition:!0,onDismiss:this.handleCloseOverlay,render:()=>{if(t.isActive)return a()(x.Z,{capture:!0,onUp:U().identity,onDown:U().identity},void 0,o.createElement(ar,se()({},t,{onCancel:this.handleCloseOverlay})))}})}}or.displayName="MediaMenu";const sr=or;i(52262),i(24506);var rr=i(97762),lr=i(41892),dr=i(40506),cr=i(58573),ur=i(92338),mr=i(7928),pr=i(47798),gr=i(993),hr=i(17731),fr=i(80084),vr=i(83089),yr=i(14568),Sr=i(63334),br=i(19111);const Mr={...Be.Z.textOverflowStyle,fontWeight:Be.Z.fontWeight.medium,maxWidth:160,display:"inline-block",verticalAlign:"bottom"};function wr(e){const{pageTitle:t}=e;return a()(w.FormattedMessage,t?{defaultMessage:"New “{filterText}” page in…",id:"createPageMenuItem.title.withPageName",values:{filterText:a()("span",{style:Mr},void 0,t)}}:{defaultMessage:"Add new page in…",id:"createPageMenuItem.title.withoutPageName"})}function Cr(e){const{pageTitle:t}=e;return a()(w.FormattedMessage,t?{defaultMessage:"New “{filterText}” sub-page",id:"createSubpageMenuItem.title.withPageName",values:{filterText:a()("span",{style:Mr},void 0,t)}}:{defaultMessage:"Add new sub-page",id:"createSubpageMenuItem.title.withoutPageName"})}var _r=i(85215),kr=i(60442);function Tr(e){window.__c={n:"SvgWorkaroundForChromiumBug"};const{svg:t,viewBox:i,fill:n}=e,s=(0,o.useMemo)((()=>{const e=(0,rr.renderToString)(a()("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:i},void 0,t));return`url("${`data:image/svg+xml,${encodeURIComponent(e)}`}")`}),[t,i]);return a()("div",{style:{width:"100%",height:"100%",backgroundColor:n,WebkitMaskImage:s,maskImage:s}})}const Ir=(0,w.defineMessages)({mentionAll:{defaultMessage:"Mention a person, page, or date…",id:"mentionMenu.personPageDate.prompt2"},mentionPersonPage:{defaultMessage:"Mention a person or page…",id:"mentionMenu.personPage.prompt2"},mentionPersonDate:{defaultMessage:"Mention a person or date…",id:"mentionMenu.personDate.prompt2"},mentionPageDate:{defaultMessage:"Mention a page or date…",id:"mentionMenu.pageDate.prompt2"},mentionPerson:{defaultMessage:"Mention a person…",id:"mentionMenu.person.prompt2"},mentionDate:{defaultMessage:"Mention a date…",id:"mentionMenu.date.prompt2"},mentionPage:{defaultMessage:"Type to link or add page…",id:"mentionMenu.page.prompt2"},addPage:{defaultMessage:"Type to add or link page…",id:"mentionMenu.addPage.prompt2"}}),Pr=(0,w.defineMessages)({autocompleteToday:{defaultMessage:"Today",id:"mentionMenu.date.autocomplete.today"},autocompleteNextTuesday:{defaultMessage:"Next Tuesday 3pm",id:"mentionMenu.date.autocomplete.nextTuesday"},autocompleteReminder:{defaultMessage:"Remind tomorrow 9am",id:"mentionMenu.date.autocomplete.reminder"},reminder:{defaultMessage:"Remind {dateTime}",id:"mentionMenu.date.remindAtDateTime"},noResults:{defaultMessage:"No results",id:"mentionMenu.noSearchResults.title"},groupMentionCaption:{defaultMessage:"{numMembersInGroup, plural, one {{numMembersInGroup} member} other {{numMembersInGroup} members}}",id:"mentionMenu.group.caption"}});class Zr extends b.Z{constructor(){super(...arguments),this.storeTypes={ignoreSelectionAreaStore:Sr.Z,localPageMentionRequestStore:vi.Z,localCachePageMentionRequestStore:vi.Z},this.renderMentionResult=(e,t)=>{const{intl:i}=this.props,n=br.Z.state,s=n.open&&n.insertionType,r={sections:[],nextSectionShouldHaveTopBorder:()=>r.sections.length>0,addSection(e){e&&this.sections.push(e)}};"+"===s&&r.addSection(this.getCreatePageMenuSection(r.nextSectionShouldHaveTopBorder())),r.addSection(this.getDateResultsMenuSection(t,r.nextSectionShouldHaveTopBorder())),r.addSection(this.getUserResultsMenuSection(t,r.nextSectionShouldHaveTopBorder())),r.addSection(this.getGroupResultsMenuSection(t,r.nextSectionShouldHaveTopBorder(),this.props.intl)),r.addSection(this.getPageResultsMenuSection(t,r.nextSectionShouldHaveTopBorder())),("@"===s&&this.filterStore.state||"[["===s)&&r.addSection(this.getCreatePageMenuSection(r.nextSectionShouldHaveTopBorder()));const{sections:l}=r;let d,c;if(Xo.Z.state.online){const e=n.mentionTypes.user,t=n.mentionTypes.page,a=n.mentionTypes.date;let o="";const s=Ir;e&&t&&a?o=i.formatMessage(s.mentionAll):e&&t?o=i.formatMessage(s.mentionPersonPage):e&&a?o=i.formatMessage(s.mentionPersonDate):t&&a?o=i.formatMessage(s.mentionPageDate):e?o=i.formatMessage(s.mentionPerson):a?o=i.formatMessage(s.mentionDate):t&&n&&(o=n.open&&"+"===n.insertionType?i.formatMessage(Ir.addPage):i.formatMessage(s.mentionPage)),this.setTemporaryInputData({title:o,icon:this.renderTemporaryInputEmptyIcon(),allowTabCompletion:!1}),d=void 0}else d=a()(Ut.Z,{title:a()(w.FormattedMessage,{defaultMessage:"Please go online to mention a person or page.",id:"mentionMenu.offlineMessage"})});0===l.length&&(c=a()(te.Z,{},void 0,a()(Ut.Z,{title:o.createElement(w.FormattedMessage,Pr.noResults)})));const{device:u}=this.environment;let m;return m=this.isActionSheet()?{menuType:_.og.ActionSheet,disableBottomPadding:!0,height:`calc(70vh - ${tt.Z.estimatedNativeWebBottomOverlap()}px)`}:{menuType:_.og.Popup,width:this.getMenuDesktopWidth(),maxHeight:u.isMobile?"30vh":"40vh",onClickOutside:this.makeHandleCancelCallback()},o.createElement(F.Z,se()({},m,{header:d}),a()(x.Z,{capture:br.Z.state.open,onBackspace:this.shouldCaptureBackspace()?this.handleEmptyBackspace:void 0,onTab:this.handleTab}),a()(pe.Z,{type:pe.i.Vertical,initialFocus:this.getMenuInitialFocus(),sections:l,onEmptyEnter:this.makeHandleCancelCallback()}),c)},this.handleCreateInAutocompleteQueryChange=e=>{this.updateOpenState({createInQuery:e})},this.renderCreateInMenu=()=>{const e=br.Z.state;if(!e.open)return;const t="block"===e.textStore.table?e.textStore.id:void 0;return a()(as.Z,{targets:[],isAddTo:!0,isCreateIn:!0,onAccept:e=>{pr.Br({environment:this.environment,titleText:this.getNormalizedFilter(),ignoreSelectionAreaStore:this.stores.ignoreSelectionAreaStore,createInValue:e,menuListItemAction:void 0})},captureSelection:!0,restoreSelection:!0,parentBlockId:t,onAutocompleteQueryChange:this.handleCreateInAutocompleteQueryChange,ignoreSelectionAreaStore:this.stores.ignoreSelectionAreaStore,autocompleteQuery:e.createInQuery,desktopWidth:this.getMenuDesktopWidth(),onCancel:this.handleCreateInCancel})},this.handleCreateInStart=()=>{this.updateOpenState({showCreateIn:!0})},this.handleCreateInCancel=()=>{this.updateOpenState({showCreateIn:!1,createInQuery:""})},this.handleEmptyBackspace=e=>{this.shouldCaptureBackspace()&&e.preventDefault(),this.makeHandleCancelCallback()()},this.makeHandleCancelCallback=()=>{const e=br.Z.state,t=this.getNormalizedFilter(),i=pr.WI();let n=Date.now();return e.open&&(n=e.openTime),()=>{K.ewV(this.environment,{timeToAbandonInMs:Date.now()-n,queryLength:t.length,analyticsFrom:i}),pr.xv()}},this.handleTab=e=>{e.preventDefault();const t=this.tabCompletionString;if(!t)return;const i=Ga.default.state;if("editing"!==i.mode)return;const n=(0,Wa.QY)(i.multiSelection);if(!n)return;const a=br.Z.state;a.open&&a.textStore===n.store&&Ge.createAndCommit({userAction:"MentionMenu.handleTab",environment:this.environment,perform:e=>{gr.hJ({environment:this.environment,transaction:e,string:t,store:n.store,selection:n.selection,disableMentions:!0,disableDateMentions:!0,disableEmojiCommands:!0,disableSlashCommands:!0})}})},this.tabCompletionString=void 0,this.inputSelectionsStore=this.createComputedStore((()=>{const e=br.Z.state;if(e.open)return Xa.O2(e.textStore,e.oldTextValue,e.isEmptyPageTitle?"":e.insertionType)})),this.filterStore=this.createComputedStore((()=>{const e=this.inputSelectionsStore.state,t=br.Z.state;if(e&&t.open)return Xa.ug(t.textStore,e)})),this.popupOpenStore=this.createComputedStore((()=>{const e=br.Z.state;return!!e.open&&("+"!==e.insertionType||""!==this.getNormalizedFilter())})),this.performUserMentionRequest=async e=>{const t=br.Z.state;if(!t.open)return;const i=t.mentionTypes.user?await this.getUserResults(e):[];return""===e?i.slice(0,2):i.slice(0,20)},this.performLocalCachePageMentionRequest=async()=>{const{currentSpaceStore:e,currentSpaceViewStore:t}=m.default.state;if(!e)return;return fr.hb({environment:this.environment,currentSpaceStore:e,currentSpaceViewStore:t})},this.performLocalPageMentionRequest=async e=>{const{localCachePageMentionRequestStore:t}=this.stores,i=t.state.result;if(!i)return;const n=He.RM();return n&&this.getNormalizedFilter()?Promise.resolve(fr.Y_({query:e,localCachedPages:i,parentStore:n,isOnline:Xo.Z.state.online,environment:this.environment,shouldLimitLocalResultsWhenOnline:!1,applyScoreThresholdWhenOnline:!0})):void 0},this.performServerPageMentionRequest=async e=>{const t=br.Z.state;return t.open&&this.getNormalizedFilter()&&t.mentionTypes.page?await this.getPageResults(e):[]},this.getUserResults=async e=>{if(Xo.Z.state.online){return await Ot.Yu({environment:this.environment,query:e,membersOnly:!1})}return[]},this.getGroupResults=e=>{var t;if(!br.Z.state.open)return[];const i=(null===(t=m.default.state.currentSpaceStore)||void 0===t?void 0:t.getPermissionGroups())||[];return(0,cr.ZP)(e,i,(e=>e.name||""))},this.getPageResults=async e=>{if(!Xo.Z.state.online)return[];const t=br.Z.state,i=t.open&&(0,k.NZ)(t.textStore)&&t.textStore;return await Ot.WL({nearBlock:i||void 0,environment:this.environment,query:e,source:"mention_menu",limit:20})},this.getDateResults=e=>{const t=br.Z.state;if(!t.open)return[];const{intl:i}=this.props,n=t.mentionTypes.reminder;return t.mentionTypes.date?function(e,t,i){if(0===e.length)return U().compact([{label:i.formatMessage(Pr.autocompleteToday),value:()=>Ai.Lg((0,ei.r)())},t?void 0:{label:i.formatMessage(Pr.autocompleteNextTuesday),value:()=>{const e=Ai.Uu((0,ei.r)()),t=e.set({weekday:2,hour:15}),i=t<=e?t.plus({week:2}):t.plus({week:1});return{type:"datetime",start_date:i.toFormat(Ai.Iq),start_time:i.toFormat(dr.jK),time_zone:(0,ei.r)()}}},t?{label:i.formatMessage(Pr.autocompleteReminder),value:()=>({type:"datetime",start_date:Ai.Ro((0,ei.r)()).start_date,start_time:"09:00",reminder:{unit:"day",value:0,time:dr.HZ,defaultTimeZone:(0,ei.r)()},time_zone:(0,ei.r)()})}:void 0]);const n=e.normalize("NFKD"),a=t?Ei.parsePersistedDateWithOptionalReminder(n,i):Ei.parsePersistedDate(n,i);if(a){let e=(0,Fi.ZV)({value:a,date_format:"relative",userTimeZone:(0,ei.r)(),intl:i,allowRelativeDates:!0});return a.reminder&&(e=i.formatMessage(Pr.reminder,{dateTime:e})),[{label:e,value:()=>a}]}return[]}(e,n,i).slice(0,6):[]},this.getTemplateVariableResults=e=>{const t=br.Z.state;if(!t.open)return[];if(!t.mentionTypes.templateVariable)return[];const{intl:i}=this.props;return Fe.XV(e,i)}}willMountOrUpdate(){const e=br.Z.state,t=this.filterStore.state;if(e.open){var i;const n=Ga.default.state,a="editing"===n.mode?(0,Wa.QY)(n.multiSelection):void 0,o=(null==a?void 0:a.store)===e.textStore,s=this.stores.ignoreSelectionAreaStore.state.savedTextSelectionStoreState,r=s&&"editing"===s.mode&&(null===(i=(0,Wa.QY)(s.multiSelection))||void 0===i?void 0:i.store)===e.textStore;if(!o&&!r)return void pr.xv();const l=o&&(null==a?void 0:a.selection),d=this.inputSelectionsStore.state;if(d&&l&&(l.startIndex<d.filter.startIndex||l.endIndex>d.filter.endIndex))return void pr.xv();const c=this.filterStore.state&&this.filterStore.state[0];if("+"===e.insertionType&&c&&!c.match(vr.Ff))return void pr.xv();if(void 0===t&&!e.isEmptyPageTitle)return void pr.xv()}}renderComponent(){const{device:e}=this.environment,t=br.Z.state,i=yr.Z.find((e=>e.props.capture)),n=this.popupOpenStore.state;let s;if(i&&e.isMobile){var r;const e=null===(r=i.stores.store.state.node)||void 0===r?void 0:r.getBoundingClientRect();e&&(s={height:`calc(100vh - ${e.height}px)`})}const l=t.open&&t.showCreateIn;return a()(N.ZP,{popupType:this.isActionSheet()?N.ZP.PopupType.SlideUp:N.ZP.PopupType.Popup,open:n,originRect:t.open?t.selectionRect:void 0,slideUpWrapStyle:s,placementToOrigin:N.ZP.Placement.Bottom,alignmentToOrigin:N.ZP.Alignment.Start,originGap:8,disableMouseCapture:!0,disableContentScroll:!0,onDismiss:this.makeHandleCancelCallback(),disableDarkOverlayBackground:e.isMobile,keepFocus:!0,render:()=>e.isMobile?o.createElement(o.Fragment,null,this.renderMentionSearch(),a()(N.ZP,{popupType:N.ZP.PopupType.SlideUp,render:this.renderCreateInMenu,open:l,keepFocus:!0})):l?this.renderCreateInMenu():this.renderMentionSearch()})}renderMentionSearch(){const e=this.getNormalizedFilter(),t=br.Z.state,i=Je.default.mark("rum.mention_menu_ready"),n={field:"relevance"};return a()(Wt.Z,{requestStore:t.userRequestStore,request:e,performRequest:this.performUserMentionRequest,render:o=>a()(Wt.Z,{requestStore:t.pageRequestStore,request:e,performRequest:this.performServerPageMentionRequest,debounce:Ot.vp,render:t=>a()(Wt.Z,{requestStore:this.stores.localCachePageMentionRequestStore,request:m.default.state.currentSpaceStore&&m.default.state.currentSpaceStore.id,performRequest:this.performLocalCachePageMentionRequest,render:s=>a()(Wt.Z,{requestStore:this.stores.localPageMentionRequestStore,debounce:Ot.E5,request:{query:{text:e,filters:ur.u4({isDeletedOnly:!1,navigableBlockContentOnly:!0,excludeTemplates:!0,requireEditPermissions:void 0}),sort:n},limit:5},performRequest:this.performLocalPageMentionRequest,render:e=>this.renderMentionResult(o||t||e,this.getCurrentMentionResults(i))})})})})}getDateResultsMenuSection(e,t){const{dateResults:i}=e,{intl:n}=this.props,s=this.getNormalizedFilter(),r=this.getTemplateVariableMenuItems(e,"date");if(0===i.length&&0===r.length)return;const l=i.map((e=>{let{label:t,value:i}=e;return{key:t,render:e=>{if(e.focused&&this.setTemporaryInputData({title:t,icon:this.renderTemporaryInputAtMentionIcon(),allowTabCompletion:!0}),Ei.parseRelativeDate(t,n)){const a=(0,Fi.ZV)({value:i(),userTimeZone:(0,ei.r)(),intl:n,allowRelativeDates:!1});return o.createElement(me.Z,se()({},e,{title:t,caption:a,inline:!0}))}return o.createElement(me.Z,se()({},e,{title:t}))},action:e=>{Ge.createAndCommit({userAction:"MentionMenu.menuItem",environment:this.environment,perform:t=>{pr.RL({environment:this.environment,annotation:["d",{...i(),date_format:"relative"}],transaction:t,menuListItemAction:e,query:s,mentionType:"date"})}})}}}));return this.applySectionLimit("date",{key:"date results",render:e=>o.createElement(te.Z,se()({},e,{title:a()(w.FormattedMessage,{defaultMessage:"Date",id:"mentionMenu.dateSection.title"}),topBorder:t,isTitleUppercase:!0})),items:r.concat(l)})}getTemplateVariableMenuItems(e,t){const{templateVariableResults:i}=e,{intl:n}=this.props,a=this.getNormalizedFilter();return i.filter((e=>Fe.i6(e,t))).map((e=>({key:e,render:t=>{const i=Fe.U$(e,n),a=Fe.Z0(e,n);return t.focused&&this.setTemporaryInputData({title:i,icon:this.renderTemporaryInputAtMentionIcon(),allowTabCompletion:!0}),o.createElement(me.Z,se()({},t,{title:i,caption:a,inline:!0}))},action:t=>{Ge.createAndCommit({userAction:"MentionMenu.menuItem",environment:this.environment,perform:i=>{pr.RL({environment:this.environment,annotation:["tv",{type:e}],transaction:i,menuListItemAction:t,query:a,mentionType:"templateVariable"})}})}})))}renderSpinner(e){return a()(xo.Z,{show:e,showDelay:500,showHold:300,render:e=>a()(st.Z,{style:{textAlign:"center",visibility:e?"visible":"hidden",display:"inline",marginLeft:8}})})}renderTemporaryInputEmptyIcon(){const e=br.Z.state;if(e.open)return"+"===e.insertionType?this.renderTemporaryInputAddIcon():a()("span",{style:{width:"1em",height:"1em",display:"inline-block",verticalAlign:"-0.15em",marginRight:"0.2em"}},void 0,o.createElement(Tr,se()({},Ie.X.search,{fill:this.theme.mediumIconColor})))}renderTemporaryInputAddIcon(){return a()("span",{style:{width:"1em",height:"1em",display:"inline-block",verticalAlign:"-0.15em",marginRight:"0.2em"}},void 0,o.createElement(Tr,se()({},Ie.X.plus,{fill:this.theme.mediumIconColor})))}renderTemporaryInputPageIcon(e){return(0,Li.tp)({pageModel:e.getModel(),pageRole:e.getRole(),showEmojiInline:!0,emojiType:(0,hr.e_)(this.environment),baseUrl:bt.default.domainBaseUrl,getRecordModel:e.getRecordModel,isClient:!0,isSafariOrIOS:this.environment.device.isSafari||this.environment.device.isIOS,currentUserId:this.environment.currentUser.id,theme:this.theme,emojiData:Ki.Z.state})}renderTemporaryInputAtMentionIcon(){return a()("span",{style:{width:"1em",height:"1em",display:"inline-block",verticalAlign:"-0.15em",marginRight:"0.2em"}},void 0,o.createElement(Tr,se()({},Ie.X.at,{fill:this.theme.mediumIconColor})))}getUserResultsMenuSection(e,t){const{userResults:i}=e,n=this.getNormalizedFilter(),s=this.getTemplateVariableMenuItems(e,"user");if(0===i.length&&0===s.length)return;const r=U().compact(i.map((e=>({key:e.id,render:t=>(t.focused&&this.setTemporaryInputData({title:(0,mr.Nz)(this.props.intl,e),icon:this.renderTemporaryInputAtMentionIcon(),allowTabCompletion:!0}),o.createElement(Gt.Z,se()({},t,{actor:(0,Lt.dp)(e),useEmailAsTooltip:!0}))),action:t=>{Ge.createAndCommit({userAction:"MentionMenu.menuItem",environment:this.environment,perform:i=>{pr.RL({environment:this.environment,annotation:(0,Fe.tE)(e.id),transaction:i,menuListItemAction:t,query:n,mentionType:"user"})}})}}))));return this.applySectionLimit("user",{key:"user results",render:e=>o.createElement(te.Z,se()({},e,{title:a()(w.FormattedMessage,{defaultMessage:"People",id:"mentionMenu.peopleSection.title"}),topBorder:t,isTitleUppercase:!0})),items:s.concat(r)})}getGroupResultsMenuSection(e,t,i){const{groupResults:n}=e;if(0===n.length)return;const s=this.getNormalizedFilter(),r=U().compact(n.map((e=>{var t;const n=i.formatMessage(Pr.groupMentionCaption,{numMembersInGroup:(null===(t=e.user_ids)||void 0===t?void 0:t.length)||0});return{key:e.id,render:t=>(t.focused&&this.setTemporaryInputData({title:e.name||"",icon:this.renderTemporaryInputAtMentionIcon(),allowTabCompletion:!0}),a()(_r.l,{menuListItemProps:{...t,caption:n},group:e})),action:t=>{var i;const n=null===(i=m.default.state.currentSpaceStore)||void 0===i?void 0:i.id;n&&Ge.createAndCommit({userAction:"MentionMenu.groupMention",environment:this.environment,perform:i=>{pr.RL({environment:this.environment,annotation:Fe.XI(e.id,n),transaction:i,menuListItemAction:t,query:s,mentionType:"group"})}})}}})));return this.applySectionLimit("group",{key:"group results",render:e=>o.createElement(te.Z,se()({},e,{title:a()(w.FormattedMessage,{defaultMessage:"Groups",id:"mentionMenu.groupSection.title"}),topBorder:t,isTitleUppercase:!0})),items:r})}getPageResultsMenuSection(e,t){const{pageResults:i}=e,n=this.getNormalizedFilter(),s=o.createElement(o.Fragment,null,0===i.length?o.createElement(w.FormattedMessage,Pr.noResults):a()(w.FormattedMessage,{defaultMessage:"Link to page",id:"mentionMenu.pagesSection.title2"}),this.renderSpinner(br.Z.state.pageRequestStore.state.loading));return this.applySectionLimit("page",{key:"page results",render:e=>o.createElement(te.Z,se()({},e,{title:s,topBorder:t,isTitleUppercase:!0})),items:U().compact(i.map((e=>{const t=He.RM();if(!t)return;const i=Q.G.createChildStore(t,{table:Pe.iU,id:e});return{key:e,render:e=>{if(e.focused){const e=i.getModel();if(e){const t=e.getRenderTitle({getRecordModel:i.getRecordModel,userTimeZone:(0,ei.r)(),intl:this.props.intl});this.setTemporaryInputData({title:t||"",icon:this.renderTemporaryInputPageIcon(i),allowTabCompletion:!0})}}return o.createElement(es.Z,se()({},e,{store:i}))},action:t=>{Ge.createAndCommit({userAction:"MentionMenu.getPageResultsMenuSection",environment:this.environment,perform:i=>{pr.RL({environment:this.environment,annotation:["p",e],transaction:i,menuListItemAction:t,query:n,mentionType:"page"})}})}}})))})}getCreatePageMenuSection(e){if(!this.canCreatePage())return;const t=br.Z.state;if(!t.open)return;const{intl:i}=this.props,n=this.getNormalizedFilter(),s="@"===t.insertionType?a()(w.FormattedMessage,{id:"mentionMenu.createPageSection.title",defaultMessage:"New page"}):void 0;return{key:"create page",render:t=>o.createElement(te.Z,se()({title:s,isTitleUppercase:!0},t,{topBorder:e})),items:[{key:"add new subpage",action:async e=>{const i=Bo.gt(t.textStore);i&&await pr.Br({environment:this.environment,ignoreSelectionAreaStore:this.stores.ignoreSelectionAreaStore,titleText:this.getNormalizedFilter(),createInValue:i.createInValue,onPageCreated:e=>{e&&""===Fe.Q(e.getTitleValue())&&St.navigateToBlock({environment:this.environment,store:e,pageVisitSource:Qt.tY.Create})},menuListItemAction:e})},render:e=>{e.focused&&this.setTemporaryInputData({title:0===n.length?i.formatMessage(Ir.addPage):"",icon:this.renderTemporaryInputAddIcon(),allowTabCompletion:!1});const t=t=>o.createElement(me.Z,se()({},(0,Wi.Z)(t||{},e),{icon:Ie.Z.plus({width:16}),title:a()(Cr,{pageTitle:this.getNormalizedFilter()})}));return this.environment.device.isMobile?t():a()(qi.Z,{renderTooltip:()=>a()(kr.Z,{imageURL:lr.Z.images.tooltips.pageMenu.newSubpagePng,imageWidth:140,imageHeight:100,caption:o.createElement(w.FormattedMessage,as.s.createSubpage)}),placement:qi.Z.Placement.Right,delayThreshold:0,render:e=>t(e)})}},{key:"open create in menu",action:this.handleCreateInStart,render:e=>{e.focused&&this.setTemporaryInputData({title:0===n.length?i.formatMessage(Ir.addPage):"",icon:this.renderTemporaryInputAddIcon(),allowTabCompletion:!1});const t=a()(wr,{pageTitle:this.getNormalizedFilter()}),s=i=>o.createElement(me.Z,se()({},(0,Wi.Z)(i||{},e),{icon:Ie.Z.alias({width:16}),title:t}));return this.environment.device.isMobile?s():a()(qi.Z,{renderTooltip:()=>a()(kr.Z,{imageURL:lr.Z.images.tooltips.pageMenu.newPageInPng,imageWidth:140,imageHeight:100,caption:o.createElement(w.FormattedMessage,as.s.newPageIn)}),placement:qi.Z.Placement.Right,delayThreshold:0,render:e=>s(e)})}}]}}applySectionLimit(e,t){const i=br.Z.state;if(!i.open)return t;if(i.expandSection&&i.expandSection===e)return t;const{items:n}=t,s=this.environment.device.isPhone?3:5;if(n.length<=s)return t;const r=[...n.slice(0,s),{key:"show more",render:e=>o.createElement(me.Z,se()({},e,{icon:Ie.Z.dots({width:16,fill:this.theme.mediumTextColor}),title:a()("span",{style:{color:this.theme.mediumTextColor}},void 0,a()(w.FormattedMessage,{defaultMessage:"{numberMore} more results",id:"mentionMenu.showMoreResultsButton.title",values:{numberMore:n.length-s}}))})),action:()=>{this.updateOpenState({expandSection:e})}}];return{...t,items:r}}updateOpenState(e){const t=br.Z.state;t.open&&br.Z.setState({...t,...e})}getNormalizedFilter(){const e=this.filterStore.state;return e?br.Z.state.open&&"@"===br.Z.state.insertionType&&this.environment.device.isAndroid&&e.startsWith("@")?e.slice(1).trim():br.Z.state.open&&"[["===br.Z.state.insertionType&&e.endsWith("]]")?e.slice(0,-2).trim():e.trim():""}setTemporaryInputData(e){const t=br.Z.state;if(!t.open)return;if(!e)return void t.temporaryInputData.setState(void 0);const{device:i}=this.environment,{title:n,icon:a,allowTabCompletion:o}=e,s=this.filterStore.state||"",r=n.toLowerCase().startsWith(s)?n.slice(s.length):"";this.tabCompletionString=o?r:void 0;const l=i.isFirefox?void 0:a;t.temporaryInputData.setState({prefix:t.insertionType,suffix:"[["===t.insertionType&&s.endsWith("]]")?"]]":"",completion:r,prefixIcon:l})}getCurrentMentionResults(e){const t=br.Z.state,i=t.userRequestStore.state.result||[],n=t.pageRequestStore.state.result||[],a=this.getDateResults(this.getNormalizedFilter()),o=this.getTemplateVariableResults(this.getNormalizedFilter()),s=t.mentionTypes.group?this.getGroupResults(this.getNormalizedFilter()):[];let r=n;const{result:l}=this.stores.localPageMentionRequestStore.state;if(l&&!l.error){const e=l.value.results,t=He.RM();r=t?fr.oO({localResults:e,serverResults:n.map(((e,i)=>({...e,serverEventProperties:void 0,originalPosition:i,store:Q.G.createChildStore(t,{table:Pe.iU,id:e.id})})))})||[]:e}let d;d=this.getNormalizedFilter()?r.map((e=>e.id)):ts.X4.state.map((e=>e.pageId));const c=t.userRequestStore.state.ready&&t.pageRequestStore.state.ready;return c&&Je.default.measure(e,{environment:this.environment}),{userResults:i,groupResults:s,pageResults:d,dateResults:a,templateVariableResults:o,ready:c}}canCreatePage(){return!!br.Z.state.mentionTypes.createPage}isActionSheet(){const{device:e}=this.environment;return e.isMobileNative&&!e.isTablet}shouldCaptureBackspace(){return""===this.filterStore.state}getMenuInitialFocus(){if(""!==this.getNormalizedFilter())return 0}getMenuDesktopWidth(){return(0,l.bq)()?400:330}}Zr.displayName="MentionMenu";const xr=(0,w.injectIntl)(Zr);var Fr=i(42239);class Ar extends b.Z{constructor(){super(...arguments),this.cancelDragTimeout=void 0,this.handleDragOver=e=>{e.preventDefault(),this.startDrag(e),this.continueDragThrottled(e)},this.handleDrop=e=>{e.preventDefault();const t=Array.from(e.dataTransfer.files);t.length>0&&Ge.createAndCommit({userAction:"NativeDragHandler.handleDrop",environment:this.environment,perform:e=>{Fr._4({environment:this.environment,files:t,analyticsFrom:"native_drag",transaction:e})}})},this.startDrag=e=>{Fr.f$(this.environment,{startX:e.clientX,startY:e.clientY,stores:[],isNativeDrag:!0,getGhostElement:void 0})&&ao.ZH(this.environment)},this.continueDrag=e=>{this.cancelDragTimeout&&window.clearTimeout(this.cancelDragTimeout),this.cancelDragTimeout=window.setTimeout(this.cancelDrag,this.getCancelDragTimeoutMS()),Fr.td(this.environment,{currentX:e.clientX,currentY:e.clientY})},this.continueDragThrottled=U().throttle(this.continueDrag,Ar.dragOverThrottleMS),this.cancelDrag=()=>{Fr.cQ(this.environment)}}didMount(){super.didMount(),window.addEventListener("dragover",this.handleDragOver),window.addEventListener("drop",this.handleDrop)}willUnmount(){super.willUnmount(),window.removeEventListener("dragover",this.handleDragOver),window.removeEventListener("drop",this.handleDrop)}getCancelDragTimeoutMS(){const{device:e}=this.environment;return e.isLinux?2e3:200}}Ar.displayName="NativeDragHandler",Ar.dragOverThrottleMS=62.5;const Er=Ar;var Br=i(40902),Dr=i(44615),Rr=i(65311),Lr=i(19719),Nr=i(2688),Or=i(12252),Vr=i(76487);class Ur extends b.Z{constructor(){super(...arguments),this.lastEmitValue=-1,this.lastSentBadgeNumber=void 0,this.lastSentCurrentSpaceBadgeNumber=void 0,this.handleNotificationEmit=async(e,t)=>{if(t===this.lastEmitValue)return;if(this.lastEmitValue=t,!this.shouldFetchUserNotifications(String(t)))return;const i=await oi.getUserNotifications(this.environment,{size:1e3});if("failed"===i.type)return;const{results:n}=i.data;Vr.Z.setState({results:n}),this.syncInitialBadgeNumber();const a=U().union.apply(null,n.map((e=>e.unreceived.notificationIds)));for(const o of a)this.displayNotification(o)},this.handleNotificationEmitThrottled=U().throttle(this.handleNotificationEmit,1e3),this.handleNotificationEmitWhenActive=(e,t)=>{Or.Z.whenActive((()=>{this.handleNotificationEmitThrottled(e,t)}))},this.listenerReference=void 0,this.updateBadgeNumbers=()=>{const{mobileNative:e}=this.environment,{allSpaces:t,currentSpace:i}=this.getBadgeCounts();e&&(t===this.lastSentBadgeNumber&&i===this.lastSentCurrentSpaceBadgeNumber||e.setBadgeNumber(t,i),this.lastSentCurrentSpaceBadgeNumber=i),t!==this.lastSentBadgeNumber&&(t>0?Co.setBadge(`${t}`):Co.setBadge("")),this.lastSentBadgeNumber=t},this.syncInitialBadgeNumber=U().once(this.updateBadgeNumbers)}willMount(){this.startMessageListeners(),Vr.Z.addListener(this.updateBadgeNumbers),this.environment.mobileNative&&m.default.addListener(this.updateBadgeNumbers)}didUpdate(e){e.rootStore.userId!==this.props.rootStore.userId&&(this.stopMessageListeners(),this.startMessageListeners(),this.handleNotificationEmit("initializeListener",-1))}willUnmount(){this.stopMessageListeners(),Vr.Z.removeListener(this.updateBadgeNumbers),this.environment.mobileNative&&m.default.removeListener(this.updateBadgeNumbers)}startMessageListeners(){const{currentUserStore:e}=m.default.state;if(e){const t=(0,Dr.Lp)(e.id);this.listenerReference=Nr.Z.addListener(t,this.handleNotificationEmitWhenActive,void 0,this.environment)}}stopMessageListeners(){this.listenerReference&&Nr.Z.removeListener(this.listenerReference,this.environment)}getBadgeCounts(){return{allSpaces:Vr.Z.getTotalUnreadMentionsCount(),currentSpace:Vr.Z.getUnreadCountForCurrentSpace().mentions}}async displayNotification(e){const t=(0,Q.Kv)(this.props.rootStore,{table:Rr.uX,id:e});await t.load();const i=t.getValue();if(!i)return;const n=(0,k.No)(t,i.activity_id,i.space_id);await n.load();const a=n.getValue(),o=n.getModel(),{currentUserStore:s,currentSpaceViewStore:r}=m.default.state;if(s&&r&&a&&o&&!a.invalid&&!Br.BX(a,s.id)&&await Co.isMainTabOrWindow()&&"undefined"!=typeof Notification){if(await r.load(),!r.isDefined())return;if(!o.isMentionType())return;if(!r.getNotifyDesktop())return;if(!this.environment.device.isDesktop)return;const e=(0,(await d.deps.desktop.loader()).Notification)({activity:a,getRecordValue:t.getRecordValue,userTimeZone:(0,ei.r)(),intl:this.props.intl,pageVisitSource:Qt.tY.PushNotification});if(!e)return;const{subject:i,body:s}=e,l=new Notification(i,{body:s,silent:!0}),c=Br.Fb(a.type),u={medium:"desktop_push",type:c,badge_number:this.getBadgeCounts().allSpaces,notification_id:t.id,activity_id:n.id},m=e=>Lr.b2({environment:this.environment,args:u,action:e});m("sent"),l.addEventListener("show",(()=>m("shown"))),l.addEventListener("close",(()=>m("closed"))),l.addEventListener("click",(()=>{const e=Br.hY({activity:o,getRecordModel:t.getRecordModel,baseUrl:bt.default.domainBaseUrl,pageVisitSource:Qt.tY.PushNotification}),i=(0,Qt.k6)(e,[c,"desktop_push"],Qt.tY.PushNotification);St.navigate({environment:this.environment,url:i}),m("clicked")}))}}shouldFetchUserNotifications(e){return 0===Vr.Z.state.results.length||(!document.hasFocus()||!e.includes("unreadCount"))}}Ur.displayName="NotificationListener";const Wr=(0,w.injectIntl)(Ur);var Kr=i(22889),zr=i(80935),Gr=i(58261);class qr extends b.Z{constructor(){super(...arguments),this.renderTooltip=()=>a()(x.Z,{capture:!0,onEnter:this.handleEnter,onCommandEnter:this.handleCommandEnter},void 0,o.createElement(o.Fragment,null,a()(w.FormattedMessage,{defaultMessage:"Open page",id:"pageMentionOverlay.openPage"}),a()("div",{},void 0,a()(Gr.Z,{onlyShowFirst:!0,name:"enter",style:{color:this.theme.mediumInvertedTextColor}})))),this.handleEnter=e=>{const t=this.pageMentionTokenStore.state;if(!t)return;const{pageId:i,store:n}=t;if(!i)return;e.preventDefault&&e.preventDefault();const a=Q.G.createChildStore(n,{table:Pe.iU,id:i});St.navigateToBlock({store:a,environment:this.environment,visitType:Kr.vu.Link,pageVisitSource:Qt.tY.MentionInPage})},this.handleCommandEnter=e=>{const t=this.pageMentionTokenStore.state;if(!t)return;const{pageId:i,store:n}=t;if(!i)return;e.preventDefault();const a=Q.G.createChildStore(n,{table:Pe.iU,id:i});St.navigateToBlock({store:a,environment:this.environment,visitType:Kr.vu.Link,openInNew:"tab",pageVisitSource:Qt.tY.MentionInPage})},this.pageMentionTokenStore=this.createComputedStore((()=>{const e=Ga.default.state;if("editing"!==e.mode)return;const t=(0,Wa.QY)(e.multiSelection);if(!t)return;const{store:i,selection:n}=t;if(n.endIndex!==n.startIndex+1)return;const a=i.getValue(),o=Fe.b1(a,n.startIndex);if(!o||!Fe.eO(o))return;const[s]=Fe.jD([o]);return{pageId:s,store:i}}))}renderComponent(){if(this.environment.device.isMobile)return;const e=zr.getSelectionRect(),t=this.pageMentionTokenStore.state;return a()(qi.Z,{render:()=>{},renderTooltip:this.renderTooltip,originRect:e,forceVisibleState:Boolean(t&&e),placement:qi.Z.Placement.Bottom})}}qr.displayName="PageMentionOverlay";const Hr=qr;var jr=i(52989),Qr=i(69784);class Yr extends b.Z{constructor(){super(...arguments),this.handleKey=e=>{Qr.Z.state.isActive&&(e.preventDefault(),jr.MZ({environment:this.environment,currentX:Qr.Z.state.currentX,currentY:Qr.Z.state.currentY,toggle:e.shiftKey}))},this.handleMouseMove=e=>{Qr.Z.state.isActive&&(e.preventDefault(),jr.MZ({environment:this.environment,currentX:e.clientX,currentY:e.clientY,toggle:e.shiftKey}))},this.handleMouseUp=e=>{Qr.Z.state.isActive&&((0,oo.N9)(e)||e.preventDefault(),jr.qw(this.environment))}}willMount(){window.addEventListener("keydown",this.handleKey),window.addEventListener("keyup",this.handleKey),window.addEventListener("mousemove",this.handleMouseMove),window.addEventListener("mouseup",this.handleMouseUp)}willUnmount(){window.removeEventListener("keydown",this.handleKey),window.removeEventListener("keyup",this.handleKey),window.removeEventListener("mousemove",this.handleMouseMove),window.removeEventListener("mouseup",this.handleMouseUp)}renderComponent(){return null}}Yr.displayName="RectangularSelectionListener";const $r=Yr;var Xr=i(43008),Jr=i(98104),el=i(64951);class tl extends b.Z{constructor(){super(...arguments),this.renderPopupContent=()=>a()(nl,{})}renderComponent(){const{device:e}=this.environment,{blockStore:t,originRect:i}=el.Z.state;return a()(N.ZP,{popupType:e.isMobile?N.ZP.PopupType.SlideUp:N.ZP.PopupType.Popup,open:Boolean(t),originRect:i,placementToOrigin:N.ZP.Placement.Bottom,alignmentToOrigin:N.ZP.Alignment.Center,originGap:4,onDismiss:()=>Xr.x(this.environment),render:this.renderPopupContent})}}tl.displayName="RenameFileMenuPopup";class il extends b.Z{didMount(){const{blockStore:e}=el.Z.state;if(!e)return;const t=e.getTitleStore();t&&Jr.mT({environment:this.environment,store:t,canSelectAllBlocks:!1})}renderComponent(){const{device:e}=this.environment,{blockStore:t}=el.Z.state;if(!t)return;const i=t.getTitleStore();if(!i)return;let n;return n=e.isMobile?{menuType:_.og.ActionSheet}:{menuType:_.og.Popup,width:380},o.createElement(F.Z,n,a()("div",{style:this.getWrapStyle()},void 0,a()(zn.Z,{store:i,disabled:!t.canEdit(),onEsc:()=>Xr.x(this.environment),onEnter:()=>Xr.x(this.environment),disableSlashCommands:!0,disableEmojiCommands:!0,disableSelectAllBlocks:!0,disableSelectionDrag:!0,placeholder:this.props.intl.formatMessage({defaultMessage:"Untitled",id:"renameFileMenuPopup.input.placeholder"}),style:this.getInputStyle(),pasteBehavior:"inline"})))}getWrapStyle(){return{display:"flex",alignItems:"center",color:this.theme.regularTextColor,fontSize:"13px",padding:"4px 8px"}}getInputStyle(){return{display:"flex",alignItems:"center",flexGrow:1,fontSize:14,lineHeight:"20px",paddingTop:4,paddingBottom:4,paddingLeft:10,paddingRight:10,width:"100%",borderRadius:3,boxShadow:this.theme.inputBoxShadow,background:this.theme.inputBackground,cursor:"text",position:"relative"}}}il.displayName="LocalizableRenameFileMenu";const nl=(0,w.injectIntl)(il),al=tl;var ol=i(52771),sl=i(82187);class rl extends b.Z{constructor(){super(...arguments),this.renderPopupContent=()=>{const{renderDelete:e}=sl.Z.state;return a()(dl,{renderDelete:Boolean(e)})}}renderComponent(){const{device:e}=this.environment,{clonedBlockStore:t,originRect:i}=sl.Z.state;return a()(N.ZP,{popupType:e.isMobile?N.ZP.PopupType.SlideUp:N.ZP.PopupType.Popup,open:Boolean(t),originRect:i,placementToOrigin:N.ZP.Placement.Bottom,alignmentToOrigin:N.ZP.Alignment.Center,originGap:4,onDismiss:()=>ol.x(this.environment),render:this.renderPopupContent})}}rl.displayName="RenamePageMenuPopup";class ll extends b.Z{constructor(){super(...arguments),this.handleRecordIconChange=e=>{const{clonedBlockStore:t}=sl.Z.state;if(t){const i=t.getIconStore();i&&Ge.createAndCommit({userAction:"RenamePageMenuPopup.handleRecordIconChange",environment:this.environment,perform:t=>{Ke.sO({store:i,value:e,transaction:t})}})}}}didMount(){const{clonedBlockStore:e}=sl.Z.state;if(!e)return;const t=e.getTitleStore();t&&Jr.mT({environment:this.environment,store:t,canSelectAllBlocks:!1})}renderComponent(){const{device:e}=this.environment,{clonedBlockStore:t}=sl.Z.state;if(!t)return;const i=t.getTitleStore();if(!i)return;const{renderDelete:n}=this.props;let s;return s=e.isMobile?{menuType:_.og.ActionSheet}:{menuType:_.og.Popup,width:380},o.createElement(F.Z,s,a()("div",{style:this.getWrapStyle()},void 0,this.renderIcon(t),a()(zn.Z,{store:i,disabled:!t.canEdit(),onEsc:()=>ol.x(this.environment),onEnter:()=>ol.x(this.environment),disableSlashCommands:!0,disableEmojiCommands:!0,disableSelectAllBlocks:!0,disableSelectionDrag:!0,disableStyleAnnotations:!0,placeholder:this.renderEmptyTitlePlaceholder(),style:this.getInputStyle(),pasteBehavior:"inline"}),n&&t.canEdit()&&this.renderDeleteButton()))}renderDeleteButton(){return a()(js.Z,{icon:e=>Ie.Z.trash({height:20,width:20,...e}),style:{marginLeft:6},hasBackground:!0,isDarkIconColor:!0,showShadow:!0,onClick:async()=>{const{originalBlockStore:e}=sl.Z.state;e&&await no.Qw({environment:this.environment,blocks:[e]}),ol.x(this.environment)}})}renderIcon(e){const t={width:28,height:28,marginRight:6,flexShrink:0,flexGrow:0,boxShadow:`inset 0 0 0 1px ${this.theme.darkDividerColor}`};if(e.canEdit()){var i,n;const o=null===(i=e.getIconStore())||void 0===i?void 0:i.table;return a()(Si.Z,{disabled:!1,bucket:"secure",store:e,icon:e.getIcon(),isEmptyPage:e.isEmptyPage(),size:18,style:t,iconLoggingData:{recordTable:o,source:"breadcrumb",block_type:e.getType(),collection_id:"collection"===o?null===(n=e.getIconStore())||void 0===n?void 0:n.id:void 0},onChange:this.handleRecordIconChange})}return a()(Si.Z,{disabled:!0,icon:e.getIcon(),isEmptyPage:e.isEmptyPage(),size:18,style:t})}renderEmptyTitlePlaceholder(){const{clonedBlockStore:e}=sl.Z.state,{intl:t}=this.props;if(null!=e&&e.isDefined())return e.getModel().getEmptyTitlePlaceholder({getRecordModel:e.getRecordModel,userTimeZone:(0,ei.r)(),intl:t})}getWrapStyle(){return{display:"flex",alignItems:"center",color:this.theme.regularTextColor,fontSize:"13px",padding:"4px 8px"}}getInputStyle(){return{display:"block",flexGrow:1,fontSize:14,lineHeight:"20px",paddingTop:4,paddingBottom:4,paddingLeft:10,paddingRight:10,width:"100%",borderRadius:3,boxShadow:this.theme.inputBoxShadow,background:this.theme.inputBackground,cursor:"text",position:"relative"}}}ll.displayName="LocalizableRenamePageMenu";const dl=(0,w.injectIntl)(ll),cl=rl;var ul=i(4083),ml=i(13264);class pl extends b.Z{constructor(){super(...arguments),this.renderDiscussion=()=>{const{device:e}=this.environment;if(ml.Z.state.open){const{discussionStore:t,discussionInputStore:i,blockStore:n,discussionLocation:s}=ml.Z.state;let r;return r=e.isMobile?{menuType:_.og.Modal,title:a()(w.FormattedMessage,{defaultMessage:"Comments",id:"discussion.mobileReplyMenu.title"}),right:a()(w.FormattedMessage,{defaultMessage:"Close",id:"discussion.mobileReplyMenu.closeButton.label"}),onClickRight:()=>ul.UZ(this.environment),whiteBackground:!0}:{menuType:_.og.Popup,width:420,maxWidth:e.isMobileBrowser?"80vw":"100%"},o.createElement(F.Z,se()({className:de.LoZ},r),a()(P.Z,{capture:!0,allowMobileAutoScroll:!0,render:()=>a()(d.LazyDiscussion,{store:t,discussionInputStore:i,onDismiss:()=>ul.UZ(this.environment),format:C.O2.Menu,isFirst:!0,isOnly:!0,discussionLocation:s,showResolveButtonByDefaultIfPossible:!0,blockStore:n})}))}}}renderComponent(){const{device:e}=this.environment,{open:t,rect:i}=ml.Z.state;return a()(N.ZP,{popupType:e.isMobile?N.ZP.PopupType.SlideUp:N.ZP.PopupType.Popup,open:t,originRect:i,placementToOrigin:N.ZP.Placement.Bottom,alignmentToOrigin:N.ZP.Alignment.Center,originGap:4,onDismiss:()=>ul.UZ(this.environment),render:this.renderDiscussion})}}pl.displayName="ReplyDiscussionMenu";const gl=pl;var hl=i(70279),fl=i(80503),vl=i(93286),yl=i(56863),Sl=i(92022),bl=i(23223),Ml=i(40959),wl=i(87078),Cl=i(45162),_l=i(67669),kl=i(15723),Tl=i(45214),Il=i(17903),Pl=i(4548),Zl=i(42057),xl=i(49557),Fl=i(4935),Al=i(99757),El=i(13966),Bl=i(64131),Dl=i(82945),Rl=i(40464),Ll=i(32404),Nl=i(73383);class Ol extends b.Z{constructor(){super(...arguments),this.mouseIsDownExternally=!1,this.lastRenderState=void 0,this.completionContextOnOpen=void 0,this.renderOverlay=()=>{const{isActive:e}=xl.Z.state;return a()(co.Z,{isVisible:e,enterAnimationStyle:{opacity:0},animationStyle:{opacity:1},exitAnimationStyle:{opacity:0},springConfig:{opacity:{stiffness:100,damping:10,precision:1e-4}},render:this.renderAnimated,onAnimationEnd:this.handleAnimationEnd})},this.renderAnimated=()=>{const{top:e,left:t}=xl.Z.state,i=this.canOnlyDiscussStore.state,n=Math.max(i?t:t-Ol.leftOffset,0),s=i?"12px 0":12;return a()("div",{className:de.Qcf,style:{pointerEvents:"none",position:"absolute",top:e,left:0,display:"flex",width:"100%"}},void 0,a()("div",{style:{flexShrink:1,width:n,minWidth:24}}),(0,so.Z)((e=>o.createElement("div",se()({style:{pointerEvents:"none",padding:s}},e),this.lastRenderState&&this.renderMenu(this.lastRenderState)))),a()("div",{style:{flexGrow:1,flexShrink:1,minWidth:36}}))},this.updateRichTextState=()=>{const e=xl.Z.state;if(Vo.Z.state.open||Fl.Z.state.open)return;if(Al.n.state)return yl.w();const t=Ga.default.state;if("empty"===t.mode)return yl.w();const i=(0,Cl.L5)(t.multiSelection);if(0===i.length)return yl.w();if(!i.every((e=>{let{store:t}=e;return t.table===Pe.iU||t.table===hl.x_||t.table===Ze.v})))return yl.w();if(!this.environment.currentUser.isLoggedIn()||!i.every((e=>{let{store:t}=e;return t.canComment()})))return;const n=zr.get();if(He.JE())return yl.w();if(i.some((e=>{let{editable:t}=e;return t.props.disableAnnotation})))return yl.w();if(i.some((e=>{let{editable:t}=e;return t.props.disabled})))return yl.w();const a=i.map((e=>{let{editable:t}=e;return t.getContextClosestSelectableStore()}));if(a.some(((e,t)=>e&&i[t].store.table!==hl.x_&&(e.isLocked()||e.isNavigableAncestorLocked()))))return yl.w();if(this.mouseIsDownExternally&&e.blockTarget!==a[0])return yl.w();const o=i.some((e=>{let{store:t}=e;const i=t.getRecordStoreAtRootPath();if(!(i instanceof Q.G))return!1;const n=i.getValue();return!!n&&Ol.richTextMenuBlockTypesDenylist[n.type]}));if(o)return yl.w();const s=n?zr.getRect(n):void 0;if(s&&!kl.kK(s,(0,wl.Z)()))return yl.w();if(sl.Z.isActive()||el.Z.isActive()||So.Z.isOpen()||o||!n||!this.hasNonCollapsedTextSelection()||Tl.Z.state.open)return yl.w();let r=0,l=0;if(s){r=s.left;const e=25,t=s.top-Ol.height-e,i=fl.R6(this.environment.device.isElectronMac),n=this.environment.WindowSizeStore.state.height-Ol.height-e;l=Math.min(Math.max(t,i),n)}0===Math.abs(xl.Z.state.top-l)&&Math.abs(xl.Z.state.left-r)<10&&(l=xl.Z.state.top,r=xl.Z.state.left),xl.Z.setState({...xl.Z.state,isActive:!0,isAnimatingClosed:!1,top:l,left:r,blockTarget:Y.default.state.stores[0]})},this.updateRichTextStateThrottled=U().throttle(this.updateRichTextState,200,{leading:!1}),this.handleAnimationEnd=()=>{xl.Z.state.isActive||xl.Z.setState({...xl.Z.state,isAnimatingClosed:!1}),this.lastRenderState=this.renderStateStore.state},this.renderStateStore=this.createComputedStore((()=>{const{isActive:e,blockTarget:t}=xl.Z.state,i=Ga.default.state;if(!e||"empty"===i.mode)return;const{multiSelection:n}=i,a=(0,Wa.qS)(n),o=Ga.default.isEditingComment(),s=Ga.default.isEditingCaption(),r=t&&t.getParentTable()===Ze.v,l=a&&t&&n.start.store===t.getCollectionViewSourceDescriptionStore(),d=this.pageContext&&this.pageContext.publicEditModeStore.state,c=!(0,_l.YF)(d)&&(n.start.store.canEdit()&&n.end.store.canEdit()),u=t&&t.getType(),m=u&&Ol.richTextMenuActionsDenylist[u],p=null==t?void 0:t.isType("button"),g=(0,bl.td)(n.start.store)||(0,bl.td)(n.end.store),h={isSingleStoreSelection:a,showTurnInto:Boolean(a&&!o&&!r&&!l&&!s&&t&&c&&!p&&!za.default.isMiniPeekOpen()),showBold:Boolean(c),showItalic:Boolean(c),showStrikethrough:Boolean(c),showUnderline:Boolean(c),showCode:Boolean(c),showLink:Boolean(a&&c),showHighlight:Boolean(c),showDiscuss:Boolean(!o&&t&&!r&&!l&&!g&&!za.default.isMiniPeekOpen()),showEquation:Boolean(a&&c),showMention:Boolean(a&&!o&&t&&!r&&c),showActionButton:Boolean(a&&!o&&!s&&t&&!r&&!za.default.isMiniPeekOpen()),blockTarget:t,isComment:o,showCompletions:Boolean((0,Ye.GD)(this.environment,d)&&c&&!o&&!s&&t&&!r&&!l&&!p&&!g)};if(m&&m.size>0)for(const f of m)h[f]=!1;return h})),this.canOnlyDiscussStore=this.createComputedStore((()=>{const e=this.renderStateStore.state;return e&&e.showDiscuss&&!e.showBold}))}didMount(){Y.default.addListener(this.updateRichTextStateThrottled),Ga.default.addListener(this.updateRichTextStateThrottled),Il.Z.addListener(this.updateRichTextState),Zl.Z.addListener(this.updateRichTextState),Pl.Z.addListener(this.updateRichTextState)}willUnmount(){Ga.default.removeListener(this.updateRichTextStateThrottled),Y.default.removeListener(this.updateRichTextStateThrottled),Il.Z.removeListener(this.updateRichTextState),Zl.Z.removeListener(this.updateRichTextState),Pl.Z.removeListener(this.updateRichTextState)}willMountOrUpdate(){const e=this.renderStateStore.state;e&&(this.lastRenderState=e)}renderComponent(){const{isActive:e,isAnimatingClosed:t}=xl.Z.state;return a()(xa.Z,{open:e||t},void 0,this.renderOverlay())}renderMenu(e){const{isActive:t}=xl.Z.state;return a()("div",{style:{display:"inline-flex",alignItems:"stretch",height:Ol.height,background:this.theme.popoverBackground,overflow:"hidden",fontSize:14,lineHeight:1.2,borderRadius:5,boxShadow:this.theme.mediumBoxShadow,pointerEvents:t?"auto":"none"},onMouseDown:e=>e.preventDefault()},void 0,e.showCompletions&&this.renderCompletionsButton(),e.showTurnInto&&e.blockTarget&&this.renderTurnInto(e.blockTarget),e.showLink&&this.renderLinkButton(!0),e.showDiscuss&&e.blockTarget&&this.renderCommentButton(e.blockTarget),a()("div",{style:{display:"flex"}},void 0,e.showBold&&this.renderBoldButton(),e.showItalic&&this.renderItalicButton(),e.showUnderline&&this.renderUnderlineButton(),e.showStrikethrough&&this.renderStrikethroughButton(),e.showCode&&this.renderCodeButton(),e.showEquation&&this.renderEquationButton()),e.showHighlight&&a()(Bl.Z,{style:this.getBorderRight()}),e.showMention&&this.renderMention(),e.showActionButton&&e.blockTarget&&this.renderActionButton(e.blockTarget))}renderTurnInto(e){let t=a()(w.FormattedMessage,{defaultMessage:"Turn into",id:"richTextMenu.turnIntoButton.label"});const{intl:i}=this.props,n=e.getType();if(n){const e=Ml.Hc[n];t=e&&e.displayName||t}return a()(kt.ZP,{popupType:kt.Z4.Popup,buttonPopupStore:Fl.Z,originGap:4,renderOrigin:e=>a()(qi.Z,{renderTooltip:()=>i.formatMessage({defaultMessage:"Turn into",id:"richTextMenu.turnIntoButton.tooltip"}),render:i=>o.createElement(Xi.Z,se()({style:{display:"flex",alignItems:"center",padding:"0 8px",whiteSpace:"nowrap",...this.getBorderRight()}},(0,Wi.Z)(e,i)),t,Ie.Z.chevronDown({width:10,marginLeft:4,fill:this.theme.lightIconColor}))}),render:()=>a()(F.Z,{menuType:_.og.Popup},void 0,a()(J.Z,{context:{blocks:[e],environment:this.environment,publicEditMode:void 0},sections:[vl.gH],onAccept:t=>{const i=e.getType(),n=e.getFormat();yl.w(),K.dhV(this.environment,{analyticsName:t.analyticsName,from:"rich_text_menu",block_id:e.id,block_type:i,is_toggleable:i?(0,H._A)(i,n):void 0})}})),onClick:()=>{K.mt_(this.environment,{action:"turn_into"})}})}renderBoldButton(){return a()(Rl.Z,{type:"b",tooltipLabel:a()(o.Fragment,{},void 0,a()("div",{},void 0,a()(w.FormattedMessage,{defaultMessage:"Bold",id:"richTextMenu.boldButton.tooltip"})),a()("div",{},void 0,a()(Gr.Z,{style:{color:this.theme.mediumInvertedTextColor},name:"toggleBold"})))},void 0,a()("span",{style:{fontWeight:Be.Z.fontWeight.semibold}},void 0,"B"))}renderItalicButton(){return a()(Rl.Z,{type:"i",tooltipLabel:a()(o.Fragment,{},void 0,a()("div",{},void 0,a()(w.FormattedMessage,{defaultMessage:"Italicize",id:"richTextMenu.italicsButton.tooltip"})),a()("div",{},void 0,a()(Gr.Z,{style:{color:this.theme.mediumInvertedTextColor},name:"toggleItalics"})))},void 0,a()("span",{style:{fontStyle:"italic"}},void 0,"i"))}renderStrikethroughButton(){return a()(Rl.Z,{type:"s",tooltipLabel:a()(o.Fragment,{},void 0,a()("div",{},void 0,a()(w.FormattedMessage,{defaultMessage:"Strike-through",id:"richTextMenu.strikeThroughButton.tooltip"})),a()("div",{},void 0,a()(Gr.Z,{style:{color:this.theme.mediumInvertedTextColor},name:"toggleStrike"})))},void 0,a()("span",{style:{textDecoration:"line-through"}},void 0,"S"))}renderUnderlineButton(){return a()(Rl.Z,{type:"_",tooltipLabel:a()(o.Fragment,{},void 0,a()("div",{},void 0,a()(w.FormattedMessage,{defaultMessage:"Underline",id:"richTextMenu.underlineButton.tooltip"})),a()("div",{},void 0,a()(Gr.Z,{style:{color:this.theme.mediumInvertedTextColor},name:"toggleUnderline"})))},void 0,a()("span",{style:{textDecoration:"underline"}},void 0,"U"))}renderCodeButton(){return a()(Rl.Z,{type:"c",style:{padding:"0 6px"},tooltipLabel:a()(o.Fragment,{},void 0,a()("div",{},void 0,a()(w.FormattedMessage,{defaultMessage:"Mark as code",id:"richTextMenu.markAsCodeButton.tooltip"})),a()("div",{},void 0,a()(Gr.Z,{style:{color:this.theme.mediumInvertedTextColor},name:"toggleCode"})))},void 0,Ie.Z.code({width:15,height:15}))}renderLinkButton(e){const t=this.environment.device.isMobile;return a()(Nl.Z,{style:this.getBorderRight()},void 0,e&&Ie.Z.alias({width:t?18:16,height:t?18:16,marginRight:4,fill:this.theme.regularIconColor}),a()("span",{style:{borderBottom:`1px solid ${this.theme.linkDecorationColor}`}},void 0,a()(w.FormattedMessage,{defaultMessage:"Link",id:"richTextMenu.linkButton.tooltip"})))}renderCompletionsButton(){const{intl:e}=this.props;return a()(qi.Z,{renderTooltip:()=>o.createElement(o.Fragment,null,a()("div",{},void 0,e.formatMessage({defaultMessage:"Ask AI to help edit, review, or generate text.",id:"richTextMenu.assist.tooltip"})),a()("div",{},void 0,a()(Gr.Z,{style:{color:this.theme.mediumInvertedTextColor},name:"commandJ"}))),render:e=>o.createElement(Xi.Z,se()({style:{display:"flex",alignItems:"center",padding:"0 8px",whiteSpace:"nowrap",...this.getBorderRight()}},e,{onClick:()=>{(0,Sl.hr)({from:"rich_text_menu",environment:this.environment}),K.mt_(this.environment,{action:"completions"})}}),Ie.Z.sparkles({width:16,height:16,fill:xi.FN.light.purple[400],marginRight:4}),a()("span",{style:{color:xi.FN.light.purple[400],fontWeight:500}},void 0,a()(w.FormattedMessage,{defaultMessage:"Ask AI",id:"richTextMenu.assistButton.label"})))})}renderEquationButton(){return a()(Ll.Z,{style:this.getBorderRight(),onClick:()=>{K.mt_(this.environment,{action:"e"}),yl.w()}},void 0,Ie.Z.equation({width:16,height:16}))}renderMention(){return a()(qi.Z,{renderTooltip:()=>a()(o.Fragment,{},void 0,a()("div",{},void 0,a()(w.FormattedMessage,{defaultMessage:"Mention a person,{br}page, or date",id:"richTextMenu.mentionButton.tooltip",values:{br:a()("br",{})}})),a()("div",{style:{color:this.theme.mediumInvertedTextColor}},void 0,"@")),render:e=>o.createElement(Xi.Z,se()({style:{...this.getBorderRight(),padding:"0 8px"}},e,{onClick:()=>{pr.lZ(this.environment,{page:!0,createPage:!0,user:!0,bot:!0,date:!0,reminder:!0,templateVariable:!0,group:!0}),K.mt_(this.environment,{action:"mention"})}}),Ie.Z.mention({width:14,fill:this.theme.regularTextColor}))})}renderCommentButton(e){return a()(Dl.Z,{style:this.getBorderRight(),blockStore:e})}renderActionButton(e){return a()(El.Z,{store:e,style:{borderRight:"none",borderRadius:0,padding:0,width:30,height:"none"},iconStyle:{fill:this.theme.regularTextColor},fadeIn:!1,onClick:()=>{K.mt_(this.environment,{action:"more"})}})}hasNonCollapsedTextSelection(){const e=zr.get();return!!e&&!e.collapsed&&"empty"!==Ga.default.state.mode&&!(0,Wa.iG)(Ga.default.state.multiSelection)}getBorderRight(){return{boxShadow:`1px 0 0 ${this.theme.regularDividerColor}`,marginRight:1}}}Ol.displayName="RichTextMenu",Ol.richTextMenuBlockTypesDenylist={[M.Ti.factory]:!0},Ol.richTextMenuActionsDenylist={[M.Ti.code]:new Set(["showMention","showCode","showCompletions"]),[M.Ti.table]:new Set(["showTurnInto","showActionButton","showCompletions"]),[M.Ti.tableRow]:new Set(["showTurnInto","showActionButton","showCompletions"])},Ol.leftOffset=60,Ol.height=32;const Vl=(0,w.injectIntl)(Ol);var Ul=i(14248),Wl=i(14714),Kl=i(70183),zl=i(92628),Gl=i(12211),ql=i(50628);const Hl=200;var jl=function(e){return e[e.Selectable=0]="Selectable",e[e.DropTarget=1]="DropTarget",e}(jl||{});function Ql(e){return e.type===jl.Selectable?{type:Pa.Dl.Selectable,store:e.target.props.store,direction:e.direction}:{type:Pa.Dl.DropTarget,key:e.target.props.dropTargetKey,direction:e.direction}}function Yl(e){const{target:t,device:i,direction:n,points:a}=e;return n===Pa.vh.Onto||!i.isPhone||t.props.dropzoneShouldNeverUseOrigin?a.mousePoint:{x:a.originPoint.x,y:a.mousePoint.y}}function $l(e){return e instanceof zl.Z?{type:jl.Selectable,target:e}:{type:jl.DropTarget,target:e}}function Xl(e){if(!(e&&e instanceof zl.Z))return!1;let t=e;const i=Pa.ZP.state;if(!i.isDragging)return!1;const{draggedStores:n}=i;for(;t;){if(n.indexOf(t.props.store)>=0)return!0;t=t.getContextClosestSelectable()}return!1}function Jl(e){const{dropzoneMustBeWithinHorizontalBound:t,device:i}=e;return t?0:i.isPhone?9999:0}function ed(e){switch(e.direction){case Pa.vh.Onto:return function(e){const{device:t,isNativeDrag:i,rect:n,target:a,points:o,priority:s,canAcceptDrop:r}=e,l=Pa.vh.Onto,d=Yl({device:t,target:a,direction:l,points:o});if((i?a.props.canNativeDropOnto:a.props.canDropOnto)&&id(d,n)&&!Xl(a)&&r(a,l))return{...$l(a),direction:l,left:n.left,top:n.top,width:n.width,height:n.height,priority:s}}(e);case Pa.vh.Left:return function(e){const{device:t,isNativeDrag:i,rect:n,target:a,points:o,priority:s,optionKeyDown:r,canAcceptDrop:l}=e,d=Pa.vh.Left,c=Yl({device:t,target:a,direction:d,points:o});if((i?a.props.canNativeDropLeft:a.props.canDropLeft)&&n&&c.y>=n.top&&c.y<=n.bottom&&Math.abs(c.x-n.left)<=200&&(r||!Xl(a))&&l(a,d))return{...$l(a),direction:d,left:n.left,top:n.top,width:0,height:n.height,priority:s}}(e);case Pa.vh.Right:return function(e){const{device:t,isNativeDrag:i,rect:n,target:a,points:o,priority:s,optionKeyDown:r,canAcceptDrop:l}=e,d=Pa.vh.Right,c=Yl({device:t,target:a,direction:d,points:o});if((i?a.props.canNativeDropRight:a.props.canDropRight)&&n&&c.y>=n.top&&c.y<=n.bottom&&Math.abs(c.x-n.right)<=Hl&&(r||!Xl(a))&&l(a,d))return{...$l(a),direction:d,left:n.right,top:n.top,width:0,height:n.height,priority:s}}(e);case Pa.vh.Above:return function(e){const{device:t,isNativeDrag:i,rect:n,target:a,points:o,priority:s,optionKeyDown:r,canAcceptDrop:l}=e,d=Jl({dropzoneMustBeWithinHorizontalBound:a.props.dropzoneMustBeWithinHorizontalBound,device:t}),c=Pa.vh.Above,u=Yl({device:t,target:a,direction:c,points:o});if((i?a.props.canNativeDropAbove:a.props.canDropAbove)&&n&&u.x>=n.left-14-d&&u.x<=n.right+d&&(r||!Xl(a))&&l(a,c))return{...$l(a),direction:c,left:n.left,top:n.top,width:n.width,height:0,priority:s}}(e);case Pa.vh.Below:return function(e){const{device:t,isNativeDrag:i,rect:n,target:a,points:o,priority:s,optionKeyDown:r,canAcceptDrop:l}=e,d=Jl({dropzoneMustBeWithinHorizontalBound:a.props.dropzoneMustBeWithinHorizontalBound,device:t}),c=Pa.vh.Below,u=Yl({device:t,target:a,direction:c,points:o});if((i?a.props.canNativeDropBelow:a.props.canDropBelow)&&n&&u.x>=n.left-14-d&&u.x<=n.right+d&&(r||!Xl(a))&&l(a,Pa.vh.Below))return{...$l(a),direction:Pa.vh.Below,left:n.left,top:n.bottom,width:n.width,height:0,priority:s}}(e)}}function td(e){const{device:t,rect:i,target:n,points:a,optionKeyDown:o}=e;return id(Yl({device:t,target:n,direction:Pa.vh.Onto,points:a}),i)&&Xl(n)&&!o}function id(e,t){return Boolean(t&&e.x>=t.left&&e.x<=t.right&&e.y>=t.top&&e.y<=t.bottom)}var nd=i(28314),ad=i(19109),od=i(35026),sd=i(17031),rd=i(27406),ld=i(81844),dd=i(16339),cd=i(95802),ud=i(91681),md=i(86486);class pd extends b.Z{constructor(){super(...arguments),this.isUpdatingDragState=!1,this.didTouchEnd=!1,this.lastMouseInfo=void 0,this.handleWindowMouseMove=e=>{const t=md.default.state;if(!e||t.isOpen&&t.menuIsOpen||(this.lastMouseInfo={target:e.target,x:e.clientX,y:e.clientY}),this.didTouchEnd)return void(this.didTouchEnd=!1);const{isDragging:i}=Pa.ZP.state;if(i){this.updateDragState();const{device:e}=this.environment;e.isPhone&&pi.default.checkGate("mobile_show_six_dot_menu")&&(this.lastMouseInfo=void 0)}else{if(!this.lastMouseInfo)return;this.updateHoverState(this.lastMouseInfo.target,this.lastMouseInfo.x,this.lastMouseInfo.y)}},this.handleDragBlockStoreChange=()=>{this.isUpdatingDragState||this.handleWindowMouseMoveThrottled(void 0)},this.handleWindowMouseMoveThrottled=U().throttle((e=>Jo.Z.withListenerIgnored((()=>this.handleWindowMouseMove(e)))),60),this.handleSelectionChange=()=>{const{isDragging:e}=Pa.ZP.state;we.default.afterNextFlush((()=>{this.lastMouseInfo&&!e&&this.updateHoverState(this.lastMouseInfo.target,this.lastMouseInfo.x,this.lastMouseInfo.y)}))},this.handleSelectionChangeThrottled=U().throttle(this.handleSelectionChange,60),this.handleWindowKeyEvent=()=>{const{isDragging:e}=Pa.ZP.state;e&&this.updateDragState()},this.handleWindowTouchEnd=()=>{this.didTouchEnd=!0},this.handleWindowScroll=()=>{ao.Ch(),this.clearHoverState()},this.handleWindowResize=()=>{ao.Ch();const{device:e}=this.environment;e.isPhone&&pi.default.checkGate("mobile_show_six_dot_menu")||this.clearHoverState()},this.handleGlobalMenuIsOpenChange=()=>{const e=md.default.state,t=He.kw.state;e.isOpen&&!e.menuIsOpen&&t&&md.default.reset(),this.environment.device.isPhone&&pi.default.checkGate("mobile_show_six_dot_menu")&&(this.lastMouseInfo=void 0)},this.memoizedCanDragCache=new WeakMap,this.memoizedCanDrag=e=>{const t=this.memoizedCanDragCache.get(e);if(this.memoizedCanDragCache.has(e))return t;const i=(0,Kl.OO)({environment:this.environment,blocks:e,publicEditMode:this.pageContext&&this.pageContext.publicEditModeStore.state});return this.memoizedCanDragCache.set(e,i),i},this.getDropZonePriority=e=>(null==e?void 0:e.priority)??0}didMount(){super.didMount();const{device:e}=this.environment;Ti.lj(window,"mousemove",this.handleWindowMouseMoveThrottled),Y.default.addListener(this.handleSelectionChangeThrottled),e.isIOS&&Ti.lj(window,"touchend",this.handleWindowTouchEnd),Ti.lj(window,"keydown",this.handleWindowKeyEvent),Ti.lj(window,"keyup",this.handleWindowKeyEvent),Pa.ZP.addListener(this.handleDragBlockStoreChange),Ti.lj(window,"scroll",this.handleWindowScroll,!0),Ti.lj(window,"resize",this.handleWindowResize),He.kw.addListener(this.handleGlobalMenuIsOpenChange),ao.Jy()}willUnmount(){super.willUnmount();const{device:e}=this.environment;Ti.ZV(window,"mousemove",this.handleWindowMouseMoveThrottled),Y.default.removeListener(this.handleSelectionChangeThrottled),e.isIOS&&Ti.ZV(window,"touchend",this.handleWindowTouchEnd),Ti.ZV(window,"keydown",this.handleWindowKeyEvent),Ti.ZV(window,"keyup",this.handleWindowKeyEvent),Pa.ZP.removeListener(this.handleDragBlockStoreChange),Ti.ZV(window,"scroll",this.handleWindowScroll,!0),Ti.ZV(window,"resize",this.handleWindowResize),He.kw.removeListener(this.handleGlobalMenuIsOpenChange)}updateDragState(){if(this.isUpdatingDragState)throw new Error("Assertion failure, updateDragState() called when this.isUpdatingDragState === true!");this.isUpdatingDragState=!0;try{this.updateDragStateInner()}finally{this.isUpdatingDragState=!1}}updateDragStateInner(){const e=Pa.ZP.state;if(!e.isDragging)return;const{draggedStores:t,currentX:i,currentY:n,offsetX:a,offsetY:o,isNativeDrag:s}=e,r={x:i,y:n},l={x:i-a,y:n-o},d=this.findNearbyDropZones({mousePoint:r,originPoint:l},t[0],s);if(d.ontoDropZone)Pa.ZP.setState({...e,currentDropZone:d.ontoDropZone,currentHintDropZones:[],currentParentStore:void 0});else if(d.verticalDropZone)Pa.ZP.setState({...e,currentDropZone:d.verticalDropZone,currentHintDropZones:[],currentParentStore:void 0});else{if(d.horizontalDropZones.length>0){const t=d.horizontalDropZones[0],i=U().tail(d.horizontalDropZones);if(t.type===Pa.Dl.Selectable){const n=cd.C.findSelectableFromStore(t.store);if(n){const a=n.getContextClosestSelectable();let o;return a&&a.props.store!==t.store&&a.props.shouldShowParentHalo&&(o=a.props.store),void Pa.ZP.setState({...e,currentDropZone:t,currentHintDropZones:i,currentParentStore:o})}}else{if(rd.Z.findDropTargetFromKey(t.key))return void Pa.ZP.setState({...e,currentDropZone:t,currentHintDropZones:i,currentParentStore:void 0})}}Pa.ZP.setState({...e,currentDropZone:void 0,currentHintDropZones:[],currentParentStore:void 0})}}clearHoverState(){const e=md.default.state;e.isOpen&&!e.menuIsOpen&&md.default.reset()}updateHoverState(e,t,i){const n=md.default.state;if(!n.isOpen||!n.menuIsOpen){const a=this.findHoverMenuTarget(e,t,i);a?n.isOpen&&a.selectable.props.store===n.currentStore||md.default.setState({isOpen:!0,currentStore:a.selectable.props.store,container:a.container,menuIsOpen:!1}):md.default.reset()}}getHighestDropZonePriorityRects(e){const t=this.getDropZonePriority(U().maxBy(e,this.getDropZonePriority));return e.filter((e=>this.getDropZonePriority(e)===t))}getSelectableContainerPriority(e){return(Y.default.state.droppableContainerStack||[]).indexOf(e)}findNearbyDropZones(e,t,i){const{device:n}=this.environment,a=nd.yA(),o=function(){const{selectableRectMap:e}=ql.Z.state,{dropTargetRectMap:t}=Gl.Z.state,i=new Map;return e.forEach(((e,t)=>{i.set(t,e)})),t.forEach(((e,t)=>{i.set(t,e)})),i}(),s=o.keys();let r=s.next();const l=cd.C.findSelectableFromStore(t),d=l?l.getContextSelectableContainer():void 0;let c=[];for(;!r.done;){const t=r.value;r=s.next();const l=o.get(t),u=t.getContextSelectableContainer();if(n.isPhone&&u!==d)continue;if(!u||u.props.disable)continue;const m=this.getSelectableContainerPriority(u),p={device:this.environment.device,isNativeDrag:i,rect:l,target:t,points:e,priority:m,optionKeyDown:a.option,canAcceptDrop:(e,t)=>this.selectableCanAcceptDrop(e,t,a.option)};if(td(p))return{ontoDropZone:void 0,verticalDropZone:void 0,horizontalDropZones:[]};c.push(...U().compact([ed({...p,direction:Pa.vh.Onto}),ed({...p,direction:Pa.vh.Left}),ed({...p,direction:Pa.vh.Right}),ed({...p,direction:Pa.vh.Above}),ed({...p,direction:Pa.vh.Below})]))}c=this.getHighestDropZonePriorityRects(c);const u=c.filter((e=>e.direction===Pa.vh.Above||e.direction===Pa.vh.Below)),m=U().minBy(u,(t=>Math.abs(t.top-this.getReferencePointForRect(t,e).y)));let p=u.filter((e=>{let{top:t}=e;return Math.abs(t-(m?m.top:0))<=pd.competingHorizontalDropZoneMinDist}));if(p.length>1){p=p.filter((t=>{const i=this.getReferencePointForRect(t,e).x,n=Jl({device:this.environment.device});return i>=t.left-n&&i<=t.left+t.width+n})),p=U().sortBy(p,(e=>{let{left:t}=e;return t}));let t=0;for(;t<p.length-1;t++){const i=p[t+1],n=this.getReferencePointForRect(i,e).x;if(i.left>n)break}p=p.slice(0,t+1),p.reverse()}const g=p.map(Ql);let h;const f=c.filter((e=>e.direction===Pa.vh.Onto)),v=U().minBy(f,(e=>e.height));if(v){u.some((t=>{const i=this.getReferencePointForRect(t,e).y;return Math.abs(t.top-i)<pd.competingOntoDropZoneVerticalOffset}))||(h=Ql(v))}let y;const S=c.filter((e=>e.direction===Pa.vh.Left||e.direction===Pa.vh.Right));let b=U().minBy(S,(t=>{const i=this.getReferencePointForRect(t,e).x;return Math.abs(t.left-i)}));if(b){const e=b,t=S.filter((t=>Math.abs(t.left-e.left)<pd.verticalDropZoneAmbiguousDist));t.length>0&&(b=U().minBy(t,(e=>e.left)))}if(b){const e=b;u.some((t=>t.top>=e.top&&t.top+t.height<=e.top+e.height))||(y=Ql(b))}return{ontoDropZone:h,verticalDropZone:y,horizontalDropZones:g}}findHoverMenuTarget(e,t,i){if(ud.Z.state.isResizing||Pa.ZP.state.isDragging||Qr.Z.state.isActive||He.kw.state)return;const{selectableRectMap:n}=ql.Z.state,a=dd.Z.getMembersByDOMOrder({filter:t=>{const i=t.getNode();return Boolean(i&&i.contains(e))}})[0],o=Y.default.getCurrentDefaultContainer(),s=a||o;if(!s)return;const r=n.keys();let l=r.next();const d=[];for(;!l.done;){const e=l.value,a=n.get(e);(e.props.shouldShowHoverMenu||e.props.shouldShowCommentMenu)&&e.getContextSelectableContainer()===s&&a&&i>=a.top&&i<=a.bottom&&t>=a.left-pd.hoverMaxHorizontalOffset&&t<=a.right&&d.push(e),l=r.next()}const c=U().sortBy(d,(e=>{const t=n.get(e);return t?-t.left:1/0})),u=c.find((e=>{const t=e.getNode();if(t){if(c.find((i=>{if(i!==e){const e=i.getNode();return Boolean(e&&t.contains(e))}return!1})))return!1}return!0}));return u?{selectable:u,container:s}:void 0}selectableCanAcceptDrop(e,t,i){if(p.Z.state.isOpen&&!za.default.state.open)return!1;if(g.Z.state.isOpen)return!1;const n=Pa.ZP.state,a=n.isDragging?n.draggedStores:[],o=!!n.isDragging&&n.isNativeDrag;let s,r,l,d=!1,c=!1;a.find((e=>{const t=ld.Z.findOutlinerItemFromStore(e);return!!t&&(s=t,r=t.type,d=t.isTopLevelItem,!0)}));const u=e instanceof zl.Z?ld.Z.findOutlinerItemFromStore(e.props.store):void 0,m=null==u?void 0:u.parentStore;var h;u&&(l=u.type,c=u.isTopLevelItem||"team"===(null===(h=u.parentStore)||void 0===h?void 0:h.table));if(this.isDraggingSharedPageOutOfTopLevelTeamSection({draggingOutlinerItem:s,selectableOutlinerItemParent:m,direction:t}))return!1;if(!(e instanceof zl.Z))return e.props.canAcceptDrop({direction:t,draggingStores:a,isNativeDrag:o});const f=e.props.store,v=f.getAssociatedCollectionStore();if(t===Pa.vh.Onto&&v){const e=v.id,t=(0,Qe.fm)(f),i=null==t?void 0:t.collectionViewStore();if(i&&"page"!==i.getType()){if(a.find((t=>{const i=t.getAssociatedCollectionStore();return Boolean(t instanceof Q.G&&i&&i.id===e)})))return!1}}if(e.props.groupsPointer){if(e.props.groupsPointer.find((e=>!(0,Ul.WL)(e)))){if(a.find((t=>{var i;const n=cd.C.findSelectableFromStore(t);return(null==n||null===(i=n.props)||void 0===i?void 0:i.groupsPointer)&&e.props.groupsPointer&&!(0,Wl.HH)(n.props.groupsPointer,e.props.groupsPointer)})))return!1}}if((0,ad.ru)({targets:a,destination:f,direction:t,draggingOutlinerType:r}))return!1;if(i&&a.find((e=>e.isTypedCollectionViewBlock()||(0,di.h7)(e))))return!1;if(u&&t!==Pa.vh.Onto&&!c&&!(0,Kl.M)({environment:this.environment,blocks:[u.store],publicEditMode:this.pageContext&&this.pageContext.publicEditModeStore.state}))return!1;if(l&&o)return!1;if("bookmarks"===r&&d&&("bookmarks"!==l||!c||t===Pa.vh.Onto))return!1;if("bookmarks"===l&&c&&t!==Pa.vh.Onto&&("bookmarks"!==r||!d))return!1;if(s&&s.isTopLevelItem&&"team"===s.type&&s.parentStore&&s.parentStore.table===W.e0){const e=s.parentStore,t=Q.zX.createChildStore(e,{...e.pointer,table:W.e0});if(t&&!(0,od.si)({teamStore:t,environment:this.environment}))return!1}if(u&&u.isTopLevelItem&&"team"===u.type&&u.parentStore&&u.parentStore.table===W.e0){const e=u.parentStore,t=Q.zX.createChildStore(e,{...e.pointer,table:W.e0});if(t&&!(0,od.si)({teamStore:t,environment:this.environment}))return!1}if("shared"===l&&c&&("shared"!==r||!d))return!1;if(l&&c&&t!==Pa.vh.Onto){if(a.find((e=>{const t=e.getType();return Boolean(!t||!M.Z7[t])})))return!1}const{device:y}=this.environment;if(l&&y.isMobile&&t===Pa.vh.Onto&&c)return!1;if(a.find((e=>Boolean(e instanceof Q.G&&e.isInlineCollectionView())))&&(t===Pa.vh.Left||t===Pa.vh.Right))return!1;if(a.some((e=>Boolean(sd.Z.findCollectionTemplatePickerItemFromStore(e))))!==Boolean(sd.Z.findCollectionTemplatePickerItemFromStore(f)))return!1;if(t===Pa.vh.Onto&&f&&!(0,Kl.J5)({environment:this.environment,blocks:[f],publicEditMode:this.pageContext&&this.pageContext.publicEditModeStore.state}))return!1;if(!this.memoizedCanDrag(a))return!1;if(a.some((e=>e.isTransclusionType()))){if(f.findRecordStoreUIAncestor((e=>{if(e===f)return!1;const t=e.isTable("block")&&e.isPath([])&&e.getValue();return Boolean(t&&(0,M.nq)(t.type))})).ancestor)return!1}return!0}getReferencePointForRect(e,t){return Yl({device:this.environment.device,target:e.target,points:t})}isDraggingSharedPageOutOfTopLevelTeamSection(e){var t;const{draggingOutlinerItem:i,selectableOutlinerItemParent:n,direction:a}=e;if(i&&"team"===i.type&&i.isTopLevelItem&&(null===(t=i.parentStore)||void 0===t?void 0:t.pointer.table)===W.e0){const e=i.parentStore;if(!(i.store.getParentId()===e.pointer.id||n&&n.pointer.id===e.pointer.id&&a!==Pa.vh.Onto))return!0}return!1}}pd.displayName="SelectableOrDropTargetListener",pd.hoverMaxHorizontalOffset=150,pd.competingOntoDropZoneVerticalOffset=7,pd.verticalDropZoneAmbiguousDist=20,pd.competingHorizontalDropZoneMinDist=2;const gd=pd;var hd=i(74647),fd=i(49427),vd=i(7755);class yd extends b.Z{constructor(){super(...arguments),this.cachedPageViewRect=void 0,this.previousMousePosition=void 0,this.mouseSpeed=1/0,this.timerId=void 0,this.setPreviousMousePosition=(e,t)=>{this.previousMousePosition={x:e,y:t},clearTimeout(this.timerId),this.timerId=setTimeout((()=>{this.previousMousePosition=void 0}),100)},this.handleWindowMouseMove=e=>{(0,Ui.ZP)({event:e,context:Ui.Af.SidebarMouseMove,callback:()=>{if(this.updatePageViewRectThrottled(),void 0!==this.previousMousePosition&&(this.mouseSpeed=Math.sqrt(Math.pow(e.clientX-this.previousMousePosition.x,2)+Math.pow(e.clientY-this.previousMousePosition.y,2))),this.setPreviousMousePosition(e.clientX,e.clientY),this.cachedPageViewRect){const{sidebarMinTriggerWidth:t,sidebarOpenWidthPercent:i}=yd,n=vd.TC.state,a=(0,y.Wk)(this.environment),o=e.clientX,s=this.cachedPageViewRect.left,r=Math.max(s*i,t,vd.Ic.state);o<r&&!za.default.isMiniOrCenterPeekOpen()&&this.mouseSpeed<yd.mouseSpeedThreshold&&0!==this.mouseSpeed&&!n&&hd.open(),o>a&&o>r&&n&&hd.close()}}})},this.handleWindowMouseOut=e=>{e.toElement||e.relatedTarget||hd.close()},this.handleWindowResize=e=>{this.environment.WindowSizeStore.state.width<hd.OnlyOneSidebarVisibleWidthThreshold&&(0,y.Sx)(this.environment)&&(0,y.in)(this.environment)&&hd.setExpand({environment:this.environment,isExpanded:!1,from:"sidebar_listener"})},this.updatePageViewRectThrottled=U().throttle(this.updatePageViewRect,500)}didMount(){window.addEventListener("mousemove",this.handleWindowMouseMove),window.addEventListener("mouseout",this.handleWindowMouseOut),window.addEventListener("resize",this.handleWindowResize)}willUnmount(){window.removeEventListener("mousemove",this.handleWindowMouseMove),window.removeEventListener("mouseout",this.handleWindowMouseOut),window.removeEventListener("resize",this.handleWindowResize)}updatePageViewRect(){const e=this.getPageViewWrapEl();this.cachedPageViewRect=e?e.getBoundingClientRect():document.body.getBoundingClientRect()}getPageViewWrapEl(){const{mainEditorCurrentBlockStore:e}=m.default.state,t=fd.Z.find((t=>t.props.store===e));if(t){const e=t.getContentWrapEl();if(e)return e}}}yd.displayName="SidebarListener",yd.sidebarOpenWidthPercent=.38,yd.sidebarMinTriggerWidth=18,yd.mouseSpeedThreshold=5;const Sd=yd;var bd=i(13991),Md=i(15944),wd=i(84084),Cd=i(68204),_d=i(64286),kd=i(10743);class Td extends b.Z{constructor(){super(...arguments),this.renderMenu=()=>{const{device:e}=this.environment,t=kd.Z.state;if(!t.open)return;const i=this.getSections(t),n=this.getFilter(t);let s;return s=e.isMobileNative&&!e.isTablet?{menuType:_.og.ActionSheet}:{menuType:_.og.Popup,width:this.getWidth(),maxHeight:"40vh",onClickOutside:wd.xv},o.createElement(F.Z,s,a()(J.Z,{sections:i,onAccept:this.handleAccept,context:{environment:this.environment,blocks:Y.default.state.stores,originRect:t.selectionRect,publicEditMode:void 0},filter:n,initialFocus:0,onEmptyEnter:this.handleCancel,useLimit:!0}))},this.handleCancel=()=>{wd.xv()},this.handleAccept=(e,t,i,n)=>{const a=Y.default.state.stores[0];if(a){const t=a.getType(),i=a.getFormat();K.dhV(this.environment,{analyticsName:e.analyticsName,from:"slash_menu",block_id:a.id,block_type:t,is_toggleable:t?(0,H._A)(t,i):void 0,slash_menu_filter_length:this.filterLength(),slash_menu_section:n})}Ge.createAndCommit({userAction:"SlashMenu.handleAccept",environment:this.environment,perform:e=>{wd.RL({environment:this.environment,transaction:e})}})},this.filterLength=()=>{const e=kd.Z.state;return e.open?e.filter.length:0}}willMountOrUpdate(){let e=kd.Z.state;if(e.open){var t;const i=Ga.default.state;if("editing"!==i.mode)return!1;const n=this.getFilter(e),a=(0,Cd.sG)({sections:this.getSections(e),context:{blocks:Y.default.state.stores,environment:this.environment,publicEditMode:void 0},query:n||""});let o=0;if(n)if(0===a.length)o=n.length-e.lettersAtLastResult;else{const t={...e,lettersAtLastResult:(null==n?void 0:n.length)??0,filter:n};kd.Z.setState(t),e=t}const{currentUserSettingsStore:s}=m.default.state;!s||null!==(t=s.getSettings())&&void 0!==t&&t.pressed_slash_tooltip||!(0,_d.u)(this.environment)||Md.q(this.environment);const{multiSelection:r}=i;(0,Wa.qS)(r)&&r.start.store===e.textStore&&!Xa.Ye(n,!0,a.length,o,e.textStore)||wd.xv()}}renderComponent(){const{device:e}=this.environment,t=kd.Z.state;return a()(N.ZP,{popupType:e.isMobileNative&&!e.isTablet?N.ZP.PopupType.SlideUp:N.ZP.PopupType.Popup,open:t.open,originRect:t.open?t.selectionRect:void 0,placementToOrigin:N.ZP.Placement.Bottom,alignmentToOrigin:N.ZP.Alignment.Start,originGap:4,disableMouseCapture:!0,disableContentScroll:!0,preventBlockRenderQueueOnEnter:!0,onDismiss:this.handleCancel,render:this.renderMenu})}getFilter(e){return Xa.zK(e.textStore,e.oldTextValue,!e.isAddMenu)}getSections(e){const{insertActions:t,slashActions:i}=vl.wg.state;return e.isAddMenu?t:i}getWidth(){return"fr-FR"===bd.SP?375:324}}Td.displayName="SlashMenu";const Id=Td;var Pd=i(1310),Zd=i(10339);class xd extends b.Z{constructor(){super(...arguments),this.showingAnimatedList=Mt.default.createValue(!1),this.handleShow=()=>{this.showingAnimatedList.setState(!0)},this.handleHide=()=>{this.showingAnimatedList.setState(!1)}}renderComponent(){const{currentItem:e}=Pd.ZP.state,t=Boolean(e||this.showingAnimatedList.state);return a()(xa.Z,{open:t,zIndex:201},void 0,a()(Zd.Z,{render:()=>U().compact([this.renderCurrentItem()]),onShow:this.handleShow,onHide:this.handleHide}))}renderCurrentItem(){const{currentItem:e}=Pd.ZP.state;if(!e)return;const t=(null==e?void 0:e.position)??"bottom",{WindowSizeStore:i,device:n}=this.environment;let o=24;if(n.isMobileNative&&n.isIOS){o=tt.Z.state.estimatedKeyboardWebViewOverlap>0?24+tt.Z.estimatedNativeWebBottomOverlap():i.getSafePaddingBottomCSS(24+tt.Z.estimatedNativeWebBottomOverlap())}const s="top"===t?{top:24}:{bottom:o};return a()(co.Z,{isVisible:!0,enterAnimationStyle:{translateY:"top"===t?-50:50,opacity:1,scale:1},animationStyle:{translateY:0,opacity:1,scale:1},exitAnimationStyle:{translateY:0,opacity:0,scale:.95},render:()=>a()("div",{"aria-live":"polite",style:{...s,position:"fixed",left:0,width:"100%",display:"flex",zIndex:Ma.E,padding:4}},void 0,a()("div",{style:{background:this.theme.tooltipBackground,color:this.theme.regularInvertedTextColor,borderRadius:8,padding:"11px 16px",boxShadow:this.theme.largeBoxShadow,margin:"0 auto",fontSize:14,display:"flex",alignItems:"center",...null==e?void 0:e.style}},void 0,e.label,e.helpUrl&&a()(yi.Z,{href:e.helpUrl,external:!0,style:{marginLeft:8,width:16,height:16,color:this.theme.regularInvertedTextColor}},void 0,Ie.Z.help({fill:this.theme.mediumInvertedTextColor})),a()("div",{style:{marginLeft:4,marginRight:-4}},void 0,e.right)))},e.key)}}xd.displayName="SnackbarRenderer";const Fd=xd;var Ad=i(6906),Ed=i(24684),Bd=i(98459),Dd=i(47425),Rd=i(37834),Ld=i(1865),Nd=i(83420),Od=i(52533),Vd=i(8323),Ud=i(46096),Wd=i(84787),Kd=i(26263),zd=i(16691),Gd=i(45953),qd=i(606),Hd=i(13493),jd=i(66213),Qd=i(82136),Yd=i(90530);class $d extends b.Z{constructor(){super(...arguments),this.handleOverrideLinkClick=e=>{Rd.U4(),St.navigate({environment:this.environment,url:e})},this.loadSnapshot=async e=>{const{timestamp:t}=e,i=e.block.id,n=await oi.getSnapshotContents(this.environment,e);if("failed"===n.type)throw n.error;const a=Gd.PF.create(n.data.contentMap),o=this.environment.currentUser.id,s=new Kd.Z({name:"PageSnapshotPreview"});for(const{pointer:u,model:m}of a)m&&s.setModelAndRole({pointer:u,userId:o},m,"reader");s.snapshotData={blockId:i,timestamp:t};const r=new Map,l=e=>{const t=s.getRecord({pointer:e,userId:o}),i=(0,zd.dn)(e);t||!(0,ii.e)(e.id)||r.has(i)||r.set(i,(0,Q.Kv)(this.props.blockStore,e))};for(const{model:u}of a)if(u)if(u.table===Pe.iU){const e=u,t=e.getProperties(),i=qd.dr.uniq(U().flatten(Object.keys(t).map((e=>t[e])).map(Fe.cC)));for(const d of i)l(d);const n=e.isNavigableBlock()?[]:e.getContentIds()||[];for(const d of n)l({table:Pe.iU,id:d});const a=e.getCollectionPointer();a&&l(a);const o=U().uniq(U().flatten(Object.keys(t).map((e=>t[e])).map(Fe.lc)));for(const d of o)l({table:Nt.KJ,id:d});const s=u.getCreatedByPointer();s&&l(s);const r=u.getLastEditedByPointer();r&&l(r)}else if(u.table===Hd.n){var d;const e=null===(d=u.getFormat())||void 0===d?void 0:d.collection_pointer;e&&l(e)}else if(u.table===hl.x_){const e=u.getCreatedByPointer();e&&l(e)}const c=Array.from(r.values());return await Promise.all(c.map((async e=>{await e.load();const t=e.getValue();t&&s.setRecord({pointer:e.pointer,userId:o},{role:"reader",value:t})}))),{blockStore:new Q.G(this.environment,{table:Pe.iU,id:i},{inMemoryRecordCache:s}),timestamp:t}}}getChildContext(){return{...this.context,overrideLinkClick:this.handleOverrideLinkClick}}renderComponent(){const e=this.props.blockStore.id,t=this.props.timestamp,i={request:{block:{id:e,spaceId:(0,Bd.CG)(this.props.blockStore.pointer.spaceId)},timestamp:t},performRequest:this.loadSnapshot,render:(e,t,i)=>a()(xo.Z,{show:!i||!t,showDelay:400,showHold:400,render:i=>i?a()("div",{style:this.getSpinnerWrapperStyles()},void 0,a()(st.Z,{})):e?a()("div",{style:{padding:32}},void 0,a()(w.FormattedMessage,{defaultMessage:"Something went wrong.",id:"pageSnapshotPreview.unknownPreviewLoadError.message"})):t?a()(E.Z,{store:t.blockStore,isDefaultContainer:!0,droppable:!0,render:e=>{let{selectableEvents:i}=e;return o.createElement(dn.Z,se()({style:{background:this.theme.contentBackground,zIndex:1,flexGrow:1},type:(0,He.Zy)({environment:this.environment,store:t.blockStore})},i),a()(Yd.Z,{store:t.blockStore,disabled:!0,loadingContainerStore:void 0,context:Qd.S.InAppTemplatePreview,paddingBottom:Yd.Z.paddingBottom(this.environment),paddingLeft:(0,He.ui)(this.environment),paddingRight:(0,He.ui)(this.environment),pageCoverHeight:Yd.Z.defaultPageCoverHeight(this.environment)}))}},t.timestamp):void 0})};return a()(jd.LF,{value:this.handleOverrideLinkClick},void 0,o.createElement(Wt.Z,i))}getSpinnerWrapperStyles(){return{padding:32,display:"flex",alignItems:"center",justifyContent:"center"}}}$d.displayName="PageSnapshotPreview",$d.contextTypes=b.w,$d.childContextTypes={...jd.wK,...b.w};const Xd=$d;class Jd extends b.Z{constructor(){super(...arguments),this.renderSnapshotsListRequest=()=>{const{device:e}=this.environment,t=Ud.Z.state;if(!t.open)return;const i={request:{block:{id:t.blockStore.id,spaceId:(0,Bd.CG)(t.blockStore.pointer.spaceId)},size:t.size},performRequest:e=>this.loadSnapshotsList(e,t),render:(i,n,o)=>a()(xo.Z,{show:Boolean(!n||n.snapshots.length>=t.size&&t.openSnapshotNearTimestamp),showDelay:400,showHold:100,render:a=>e.isMobile?this.renderMobileHistory({snapshotValues:n?n.snapshots:[],menuState:t,error:i,initialLoading:a,loadingMore:!o}):this.renderDesktopHistory({snapshotValues:n?n.snapshots:[],menuState:t,error:i,initialLoading:a,loadingMore:!o})})};return o.createElement(Wt.Z,i)},this.renderMobileHistory=e=>{let t,i;return e.loadingMore||0!==e.snapshotValues.length||(t=this.renderUnavailableMessage(Jd.noSnapshotsMessage,!1)),i=e.error?a()("div",{style:Jd.wrapStyle},void 0,a()(w.FormattedMessage,{defaultMessage:"Something went wrong",id:"historyModal.errorMessage"})):e.initialLoading?a()("div",{style:Jd.wrapStyle},void 0,a()(st.Z,{})):a()(o.Fragment,{},void 0,a()(dn.Z,{type:T.Z.Y},void 0,this.renderSnapshotsMenuList(e)),this.renderMobileSnapshotPreview(e.menuState)),a()(F.Z,{menuType:_.og.Modal,title:a()(w.FormattedMessage,{defaultMessage:"History",id:"historyModal.mobileHistoryMenu.title"}),left:this.renderMobileHelpButton(),right:a()(A.DoneMenuText,{}),onClickRight:Rd.U4,header:t},void 0,i)},this.renderDesktopHistory=e=>{let t;if(e.error)t=a()("div",{style:Jd.wrapStyle},void 0,a()(w.FormattedMessage,{defaultMessage:"Something went wrong",id:"historyModal.desktopModal.errorMessage"}));else if(e.initialLoading)t=a()("div",{style:Jd.wrapStyle},void 0,a()(st.Z,{}));else{const i=e.menuState.snapshot&&this.getSnapshotUpsell({snapshot:e.menuState.snapshot,nextFutureSnapshot:e.menuState.nextFutureSnapshot});t=i?this.renderUnavailableMessage(i.message,i.tier):e.loadingMore||0!==e.snapshotValues.length?this.renderDesktopSnapshotPreview(e.menuState):this.renderUnavailableMessage(Jd.noSnapshotsMessage,!1)}return a()(o.Fragment,{},void 0,a()("div",{style:{display:"flex",flexDirection:"column",width:`calc(100% - ${Jd.sidebarWidth}px)`,boxShadow:`1px 0 0 ${this.theme.regularDividerColor}`}},void 0,t),this.renderDesktopSidebar(e))},this.renderSnapshotsMenuList=e=>{const{device:t}=this.environment,{menuState:i,loadingMore:n}=e,s=U().compact(e.snapshotValues.map(((n,s)=>{const r=s>0?e.snapshotValues[s-1]:void 0,l=this.getSnapshotUpsell({snapshot:n,nextFutureSnapshot:r}),d=!l;return{key:n.id,action:()=>{Rd.gs({environment:this.environment,snapshot:n,nextFutureSnapshot:r})},render:e=>{const s=n.authors||[],r=this.props.intl.formatList(U().compact(s.map((e=>(0,Nd.nc)({parentStore:i.blockStore,pointer:e}).getDisplayName(this.props.intl)))),{type:"conjunction",style:"narrow"}),c=a()("div",{style:{...Be.Z.textOverflowStyle}},void 0,r),u=Boolean(i.snapshot&&i.snapshot.id===n.id),m=parseInt(n.timestamp),p=m>Date.now()-6*De.A0?(0,Fi.$b)(m,bd.SP,this.props.intl):(0,Fi.Yx)(m,"medium",bd.SP),g=(0,Fi.Yx)(m,"medium_with_time",bd.SP);return a()(qi.Z,d?{render:i=>o.createElement(me.Z,se()({},(0,Wi.Z)(e,i),{title:p,focused:!t.isMobile&&u,caption:c})),renderTooltip:()=>a()("div",{style:{maxWidth:270,whiteSpace:"normal"}},void 0,a()("div",{},void 0,g),a()("div",{},void 0,r))}:{render:i=>o.createElement(me.Z,se()({},(0,Wi.Z)(i,e),{title:a()("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"}},void 0,a()("div",{style:{...t.isMobile&&{display:"flex",flex:1},...Be.Z.textOverflowStyle}},void 0,p),a()(Ks.Z,{subscriptionTier:l.tier,analyticsName:"history_modal",desktopStyle:{marginLeft:8},onClick:()=>this.handleUpgrade(l.tier)})),focused:!t.isMobile&&u,caption:c})),renderTooltip:()=>a()(w.FormattedMessage,{defaultMessage:"Upgrade to view this snapshot.",id:"historyModal.snapshotsMenuList.upgrade.tooltip"}),disableTooltip:!Dd.QM},e.key)}}}))),r=i.snapshot&&i.snapshot.id,l=s.findIndex((e=>r===e.key)),d=[{key:"snapshots",render:e=>o.createElement(te.Z,e),items:s}];return a()(o.Fragment,{},void 0,a()(pe.Z,{type:pe.i.Vertical,initialFocus:l,sections:d}),a()(Wd.Z,{loading:n,fetchSize:i.size,resultSize:e.snapshotValues.length,onLoadMore:Rd.FF}),a()(xo.Z,{show:n,showDelay:300,showHold:100,render:e=>e&&a()("div",{style:Jd.wrapStyle},void 0,a()(st.Z,{}))}))},this.handleUpgrade=e=>{Ld.y(this.environment,{from:"history_modal",for:e})},this.getAriaLabel=()=>this.props.intl.formatMessage({id:"historyModal.ariaLabel",defaultMessage:"Page History"}),this.loadSnapshotsList=async(e,t)=>{const{device:i}=this.environment,n=await oi.getSnapshotsList(this.environment,e);if("failed"===n.type)throw n.error;const{snapshots:a}=n.data;if(t.pageHasCollection=a.some((e=>{var t;const i=null===(t=e.collection_ids)||void 0===t?void 0:t.length;return i&&0!==i})),t.openSnapshotNearTimestamp){const e=parseInt(t.openSnapshotNearTimestamp),i=a.findIndex((t=>parseInt(t.timestamp)<e));0===a.length||(0===i?Rd.gs({environment:this.environment,snapshot:a[i],nextFutureSnapshot:void 0}):i>0?Rd.gs({environment:this.environment,snapshot:a[i-1],nextFutureSnapshot:i>1?a[i-2]:void 0}):a.length<t.size?Rd.gs({environment:this.environment,snapshot:a[a.length-1],nextFutureSnapshot:a.length>1?a[a.length-2]:void 0}):Rd.FF())}else Boolean(t.snapshot)||i.isMobile||Ud.Z.setState({...t,snapshot:a[0],nextFutureSnapshot:void 0});return n.data},this.iconSize=()=>{const{device:e}=this.environment;return e.isMobile?24:20}}renderComponent(){const{device:e}=this.environment,t=Ud.Z.state;return e.isMobile?a()(N.ZP,{ariaLabel:this.getAriaLabel(),popupType:N.ZP.PopupType.SlideUp,open:t.open,render:this.renderSnapshotsListRequest,onDismiss:Rd.U4}):a()(_a.Z,{ariaLabel:this.getAriaLabel(),open:t.open,innerStyle:{height:"80vh",width:"80vw",overflow:"hidden",display:"flex"},onDismiss:Rd.U4,render:this.renderSnapshotsListRequest,className:de.Nn$})}renderMobileSnapshotPreview(e){return a()(N.ZP,{popupType:N.ZP.PopupType.SlideUp,open:Boolean(e.snapshot),forceFullScreenSlideUp:!0,render:()=>{if(!e.snapshot)return;const t=this.getSnapshotUpsell({snapshot:e.snapshot,nextFutureSnapshot:e.nextFutureSnapshot}),i=!t,n=i?a()(Xd,{blockStore:e.blockStore,timestamp:e.snapshot.timestamp}):this.renderUnavailableMessage(t.message,t.tier);return a()(F.Z,{menuType:_.og.Modal,title:(0,Fi.$b)(parseInt(e.snapshot.timestamp),bd.SP,ce.default.getIntl()),right:a()(A.DoneMenuText,{}),onClickRight:Rd.zb,leftDisabled:!i,left:a()(w.FormattedMessage,{defaultMessage:"Restore",id:"historyModal.mobileSnapshotMenu.restoreButton.label"}),onClickLeft:()=>Rd.xx(this.environment),whiteBackground:i,forceFullScreenSlideUp:!0},void 0,n)}})}hasPermissionToRestore(e){return(0,Kl.k5)({environment:this.environment,blocks:[e.blockStore],originRect:void 0,publicEditMode:void 0})}renderDesktopSidebar(e){const{menuState:t}=e,i=Boolean(t.snapshot&&!this.getSnapshotUpsell({snapshot:t.snapshot,nextFutureSnapshot:t.nextFutureSnapshot})&&this.hasPermissionToRestore(t));return a()("div",{style:this.getSidebarStyle()},void 0,a()(dn.Z,{type:T.Z.Y,style:{flex:1}},void 0,this.renderSnapshotsMenuList(e)),a()("div",{style:{display:"flex",padding:14,borderTop:`\n\t\t\t\t\t\t\t1px solid ${this.theme.regularDividerColor}\n\t\t\t\t\t\t`}},void 0,a()(qi.Z,{renderTooltip:()=>a()(w.FormattedMessage,{defaultMessage:"Upgrade to restore snapshots.",id:"historyModal.desktopModal.sidebar.upgradeMessage.tooltip"}),render:e=>o.createElement(Rs.Z,se()({isLarge:!0,onClick:()=>Rd.xx(this.environment),disabled:!i},e),a()(w.FormattedMessage,{defaultMessage:"Restore version",id:"historyModal.desktopModal.restoreButton.label"}))}),a()(ka.Z,{isLarge:!0,style:{marginLeft:12},onClick:Rd.U4},void 0,a()(w.FormattedMessage,{defaultMessage:"Cancel",id:"historyModal.desktopModal.cancelButton.label"}))),a()(te.Z,{topBorder:!0,disableDesktopPadding:!0},void 0,a()(ie.Z,{title:a()(w.FormattedMessage,{id:"historyModal.desktopModal.learnMoreButton.label",defaultMessage:"Learn about page history"}),href:(0,q.UY)("guides.pageHistory"),analyticsFrom:"page_history"})))}renderDesktopSnapshotPreview(e){if(e.snapshot)return a()(o.Fragment,{},void 0,a()("div",{style:{display:"flex",alignItems:"center",flexShrink:0,height:45,fontSize:14,paddingLeft:14}},void 0,e.blockStore.hasIcon()&&a()(Si.Z,{disabled:!0,icon:e.blockStore.getIcon(),isEmptyPage:e.blockStore.isEmptyPage(),size:this.iconSize(),style:{marginRight:6}}),a()(bi.Z,{store:e.blockStore})),a()(Xd,{blockStore:e.blockStore,timestamp:e.snapshot.timestamp}))}deviceSupportsUpgrade(e){const{device:t}=this.environment;return!t.isMobile||"personal"===e&&(0,Od.S$)({environment:this.environment})}renderUnavailableMessage(e,t){const{device:i}=this.environment,n=it.default.state.data;let o=this.deviceSupportsUpgrade(t);const s=n&&ks.GJ(n);return o&&(0,Od.S$)({environment:this.environment})&&"personal"===t&&!s&&(o=!1),a()("div",{style:this.getUnavailableMessageStyle()},void 0,this.deviceSupportsUpgrade(t)&&this.renderVersionHistoryIcon(),a()("div",{style:{...!i.isMobile&&{maxWidth:340}}},void 0,e),o&&t&&a()(Rs.Z,{isLarge:!0,onClick:()=>this.handleUpgrade(t),style:{marginTop:16}},void 0,a()(w.FormattedMessage,{defaultMessage:"Upgrade",id:"historyModal.upgradeForHistoryButton.label"})))}renderVersionHistoryIcon(){return Ie.Z.versionHistory({width:64,height:"auto",fill:this.theme.lightIconColor,marginBottom:12})}renderMobileHelpButton(){return a()(Mi.Z,{href:(0,q.UY)("guides.pageHistory"),analyticsFrom:"page_history"})}getSnapshotUpsell(e){var t;if(bt.default.isAdminMode)return;const{nextFutureSnapshot:i}=e;if(!i)return;const n=this.snapshotDaysOld(i);if((0,Vd.Aw)()&&n<=Ed.hy.plus.days)return;const o=this.getTiersSupportingSnapshotAge(n);if((0,Vd.p4)(o))return;const s=o[0]??"enterprise";return(0,Dd.QM)(s)?void 0:{tier:s,message:a()(w.FormattedMessage,{defaultMessage:"Please upgrade to the {upsellTier} Plan to access versions older than {snapshotLimitDays} days.",id:"historyModal.upsell.message",values:{upsellTier:(0,Ad.Z)((0,Dd.eR)(s)?"plus":s),snapshotLimitDays:(null===(t=this.getPlanBelow(s))||void 0===t?void 0:t.days)??Math.floor(n)}})}}getTiersSupportingSnapshotAge(e){return this.getAvailablePlansWithHistories().filter((t=>t.days>e)).map((e=>e.tier))}getPlanBelow(e){const t=this.getAvailablePlansWithHistories(),i=t.findIndex((t=>t.tier===e));if(!(i<=0))return t[i-1]}getAvailablePlansWithHistories(){return Ed.sb.filter((e=>"personal"!==e.tier))}snapshotDaysOld(e){return(Date.now()-parseInt(e.timestamp))/De.A0}getSidebarStyle(){return{display:"flex",flexDirection:"column",flexShrink:0,width:Jd.sidebarWidth}}getUnavailableMessageStyle(){const{device:e}=this.environment;return{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",marginTop:28,padding:16,textAlign:"center",fontSize:14,...e.isMobile?{position:"relative",zIndex:1,background:this.theme.popoverBackground,boxShadow:`\n\t\t\t\t\t\t\t0 -1px 0 ${this.theme.regularDividerColor},\n\t\t\t\t\t\t\t0 1px 0 ${this.theme.regularDividerColor}\n\t\t\t\t\t\t`}:{height:"100%"}}}}Jd.displayName="HistoryModal",Jd.sidebarWidth=240,Jd.noSnapshotsMessage=a()(w.FormattedMessage,{defaultMessage:"This page does not have any snapshots yet. Allow up to 10 minutes for the first snapshot to be generated.",id:"historyModal.noSnapshotsYet.message"}),Jd.wrapStyle={display:"flex",justifyContent:"center",padding:32};const ec=(0,w.injectIntl)(Jd);var tc=i(94507),ic=i(61464);function nc(){window.__c={n:"UserJoinedTeamsListener"};const e=(0,s.O7)(),{currentSpaceStore:t}=(0,r.Kw)(m.default),i=e.currentUser.id,n=(0,r.VK)((()=>null==t?void 0:t.id),[t]);return(0,o.useEffect)((()=>{if(!n||!i)return;const t=Nr.Z.addListener((0,Dr.pD)({userId:i,spaceId:n}),(async(t,a)=>{(function(e){var t;let{spaceId:i,userId:n,emitValue:a}=e;const o=null===(t=ic.Z.getUserJoinedTeamsState({userId:n,spaceId:i}))||void 0===t?void 0:t.lastEmitValue;if(o===a)return!1;if(void 0===o&&ic.Z.getHasFetched({userId:n,spaceId:i}))return!1;return!0})({spaceId:n,userId:i,emitValue:a})&&await tc.m({environment:e,spaceId:n,userId:i,emitValue:a});const o=ic.Z.getUserJoinedTeamsState({userId:i,spaceId:n});o&&ic.Z.setUserJoinedTeamsState({userId:i,spaceId:n,state:{...o,lastEmitValue:a}})}),void 0,e);return function(){t&&Nr.Z.removeListener(t,e)}}),[e,i,n]),null}var ac=i(30397);const oc=function(){window.__c={n:"TeamsInSpaceListener"};const e=(0,s.O7)(),{currentSpaceStore:t,currentUserStore:i}=(0,r.Kw)(m.default),[,n,a]=(0,r.AF)(ac.Z),d=null==i?void 0:i.id;return(0,o.useEffect)((()=>{if(!t||!d)return;const i=Nr.Z.addListener((0,Dr.je)(t.id),(async(i,o)=>{if(!a.shouldRefetchTeamsInSpace({currentUserId:d,currentSpaceId:t.id,emitValue:o}))return;const s=await(0,l.qX)({environment:e,spaceStore:t,includeArchived:!1,currentUserId:d});n({teams:s,lastEmitData:{spaceId:t.id,userId:d,value:o}})}),void 0,e);return function(){i&&Nr.Z.removeListener(i,e)}}),[t,d,e,n,a]),null};var sc=i(54814),rc=i(51752);function lc(e){window.__c={n:"TypedDatabaseListener"};const{databaseType:t,spaceStore:i}=e,n=(0,o.useRef)(),a=(0,s.O7)();return(0,o.useEffect)((()=>{if(!i)return;const e=(0,Dr.JY)({spaceId:i.id,databaseType:t});return n.current=Nr.Z.addListener(e,(async()=>{const e=await sc.rG({environment:a,spaceId:i.id,parentStore:i,databaseType:t});e&&rc.Z.setCachedDatabasesForType(t,i.id,e)}),void 0,a),()=>{n.current&&(Nr.Z.removeListener(n.current,a),n.current=void 0)}}),[t,a,i,n]),null}const dc=function(){window.__c={n:"TypedDatabasesListener"};const e=(0,r.VK)((()=>m.default.state.currentSpaceStore),[]);return(0,r.VK)((()=>"control"!==pi.default.getEligibleGroup({experimentId:"quick_capture_split_button",defaultGroup:"control"})),[])?o.createElement(o.Fragment,null,a()(lc,{databaseType:Te.iS,spaceStore:e}),a()(lc,{databaseType:Te.wW,spaceStore:e})):null};var cc=i(4926);class uc extends b.Z{constructor(){super(...arguments),this.handleConnectClick=async()=>{const e=zi.Z.state,{currentSpaceStore:t}=m.default.state;e.open&&t&&(await Oi.hM({environment:this.environment,integration:e.integration,spaceId:t.id,unfurlUrl:e.unfurlUrl,externalObjectInstanceBlockId:e.externalObjectInstanceBlockId,from:"external_object_instance_inline_popup"}),this.markPopupAsDismissed(e.integration.id),zi.Z.reset())},this.handleCloseClick=()=>{const e=zi.Z.state;e.open&&this.markPopupAsDismissed(e.integration.id),zi.Z.reset()},this.markPopupAsDismissed=e=>{const{currentUserSettingsStore:t}=m.default.state;t&&Ge.createAndCommit({userAction:"UnfurlingInformationPopup.markPopupAsDismissed",environment:this.environment,perform:i=>{qs.GK({transaction:i,userSettingsStore:t,integrationId:e})}})}}renderComponent(){const e=zi.Z.state;if(!e.open)return;const t=e.integration.info.icon;return t?a()("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",cursor:"default",padding:16,background:this.theme.popoverBackground,borderRadius:3,boxShadow:this.theme.lightBoxShadow,position:"absolute",bottom:65+cc.Z.state,right:16+cc.Z.state,width:240,zIndex:Ma.hT,clipPath:"inset(-10px -10px -10px -10px)"}},void 0,a()(Os.Z,{type:"image_url",imageURL:t,size:38,style:{marginBottom:6}}),a()("div",{style:{color:this.theme.regularTextColor,fontSize:14,fontWeight:Be.Z.fontWeight.semibold,marginBottom:6,textAlign:"center"}},void 0,a()(w.FormattedMessage,{id:"inlineUnfurlingAuthenticationPopup.title",defaultMessage:"Connect to {integration}",values:{integration:e.integration.name}})),a()("div",{style:{color:this.theme.mediumTextColor,fontSize:12,marginBottom:8,textAlign:"center",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"}},void 0,a()(w.FormattedMessage,{id:"inlineUnfurlingAuthenticationPopup.caption",defaultMessage:"You, and anyone else who has access to this Notion page, will see rich previews that update live."}),a()(er.Z,{href:(0,q.UY)("guides.unfurling"),external:!0},void 0,a()(w.FormattedMessage,{id:"inlineUnfurlingAuthenticationPopup.learnMore.text",defaultMessage:"Learn more"}))),a()(Rs.Z,{onClick:this.handleConnectClick,style:{width:"100%"}},void 0,a()(w.FormattedMessage,{id:"inlineUnfurlingAuthenticationPopup.connectButton",defaultMessage:"Connect"})),a()(js.Z,{icon:Ie.Z.close,onClick:this.handleCloseClick,style:{position:"absolute",top:6,right:6}})):void 0}}uc.displayName="UnfurlingInformationPopup";const mc=(0,w.injectIntl)(uc);var pc=i(80064);class gc extends b.Z{constructor(){super(...arguments),this.menuRef=(0,o.createRef)(),this.renderMenu=()=>{const{device:e}=this.environment,t=pc.Z.state;if(!t.open)return;const{allOptionTypes:i}=t,n={key:"embed section",render:e=>o.createElement(te.Z,e),items:i.map((e=>({key:e,render:t=>o.createElement(me.Z,se()({},t,{title:this.renderTitleForOptionType(e),onMouseEnter:i=>{t.onMouseEnter(i),this.updateUnfurlingOptionType(e)}})),action:()=>this.handleDismiss(e)})))};let s;return s=e.isMobile?{menuType:_.og.ActionSheet}:{menuType:_.og.Popup,width:320,maxHeight:"40vh"},o.createElement(F.Z,se()({},s,{className:de.b_f,ref:this.menuRef}),a()(pe.Z,{type:pe.i.Vertical,sections:[n],initialFocus:0,onKeyboardArrow:this.handleMenuListKeyboardArrow,priority:1,disallowBackspace:!0}))},this.handleDefaultDismiss=()=>{this.handleDismiss(void 0)},this.handleDismiss=e=>{Ge.createAndCommit({userAction:"UnfurlingMenu.handleDismiss",environment:this.environment,perform:t=>{ri.xv({environment:this.environment,setType:e,transaction:t})}})},this.updateUnfurlingOptionType=e=>{Ge.createAndCommit({userAction:"UnfurlingMenu.handleMenuListKeyboardArrow",environment:this.environment,perform:t=>{ri.hJ({environment:this.environment,type:e,useTemporaryRecordCache:!0,transaction:t,intl:this.props.intl})}})},this.handleMenuListKeyboardArrow=e=>{const t=pc.Z.state;if(!t.open||void 0===e.indexGlobal)return;const i=t.allOptionTypes[e.indexGlobal];i&&this.updateUnfurlingOptionType(i)},this.handleWindowKeydown=e=>{pc.Z.state.open&&"ArrowUp"!==e.key&&"ArrowDown"!==e.key&&"Enter"!==e.key&&this.handleDismiss(void 0)},this.handleWindowMousedown=e=>{const t=pc.Z.state,i=this.menuRef.current;if(!t.open||!e.target||!i)return;const n=lt.findDOMNode(i);n&&(n.contains(e.target)||this.handleDismiss(void 0))}}willMount(){(0,Ti.lj)(window,"keydown",this.handleWindowKeydown),(0,Ti.lj)(window,"mousedown",this.handleWindowMousedown)}willUnmount(){(0,Ti.ZV)(window,"keydown",this.handleWindowKeydown),(0,Ti.ZV)(window,"mousedown",this.handleWindowMousedown)}renderComponent(){const{device:e}=this.environment,t=pc.Z.state;return a()(N.ZP,{popupType:e.isMobileNative&&!e.isTablet?N.ZP.PopupType.SlideUp:N.ZP.PopupType.Popup,open:Boolean(t.open&&t.renderRect),originRect:t.open?t.renderRect:void 0,placementToOrigin:N.ZP.Placement.Top,alignmentToOrigin:N.ZP.Alignment.Start,originGap:4,disableMouseCapture:!0,disableContentScroll:!0,disableDarkOverlayBackground:e.isMobile,keepFocus:e.isMobile,render:this.renderMenu,onDismiss:this.handleDefaultDismiss})}renderTitleForOptionType(e){return"preview"===e?a()(w.FormattedMessage,{id:"unfurlingMenu.actions.pasteAsPreview.title",defaultMessage:"Paste as preview"}):"mention"===e?a()(w.FormattedMessage,{id:"unfurlingMenu.actions.pasteAsMention.title",defaultMessage:"Paste as mention"}):"link"===e?a()(w.FormattedMessage,{id:"unfurlingMenu.actions.pasteAsLink.title",defaultMessage:"Paste as link"}):"collection"===e?a()(w.FormattedMessage,{id:"unfurlingMenu.actions.pasteAsDatabase.title",defaultMessage:"Paste as database"}):void(0,Ee.t1)(e)}}gc.displayName="UnfurlingMenu";const hc=(0,w.injectIntl)(gc);const fc=function(){window.__c={n:"AppComponents"};const e=(0,s.Fy)(),t=(0,s.O7)(),{isMobile:i,isElectron:n}=e;(0,o.useEffect)((()=>{if(i){function e(e){e.preventDefault()}return document.addEventListener("gesturestart",e),()=>{document.removeEventListener("gesturestart",e)}}}),[i]);const{currentSpaceStore:c,teamsEnabled:f}=(0,r.VK)((()=>({currentSpaceStore:m.default.state.currentSpaceStore,teamsEnabled:(0,l.bq)()})),[]),v=t.currentUser.isLoggedIn();return a()(o.Fragment,{},void 0,a()(To,{}),a()(O,{}),a()(d.LazyNewDiscussionMenu,{}),a()(gl,{}),a()(u,{}),a()(Da,{}),a()(h.Z,{priority:-1,capture:!0}),a()(gd,{}),v&&!i&&a()(Sd,{}),v&&c&&a()(Wr,{rootStore:c}),v&&a()(oc,{}),v&&f&&a()(nc,{}),a()(Aa,{}),a()(Er,{}),a()(ae,{}),a()(cl,{}),a()(al,{}),a()(go,{}),a()(Me,{}),!i&&a()(Vl,{}),a()(wo,{}),a()(Hr,{}),a()(sr,{}),a()(ba,{store:p.Z}),a()(ba,{store:g.Z}),a()(xr,{}),a()(Id,{}),a()(io,{}),a()(Ya,{}),a()(hc,{}),a()(Ao,{}),a()(mc,{}),a()(fe,{}),a()(Fd,{}),a()(os,{}),n&&a()(d.LazyElectronContextMenu,{}),a()(Oa,{}),a()(Ia,{}),a()($r,{}),v&&a()(ec,{}),a()(ho.s,{}),a()(dc,{}))}},80209:(e,t,i)=>{i.d(t,{Z:()=>y});var n=i(23174),a=i.n(n),o=i(67294),s=i(83355),r=i(26825),l=i(82990),d=i(5366),c=i(47307),u=i(76464),m=i(18878),p=i(70183),g=i(98165),h=i(64921),f=i(64369);class v extends s.Z{constructor(){super(...arguments),this.handleRestorePermissionAction=async()=>{const{store:e}=this.props,t=e.getPermissionItems(),i=g.Om(e),n=i?r.Wo(g.fJ(i)):[],o={type:"restore",permissionChanges:r.Xr(t,n)};await c.confirmUserAction({message:(0,m.mX)(o),acceptLabel:(0,m.nH)(o),cancelLabel:a()(d.FormattedMessage,{id:"restrictedPermissionConfirmationModal.actionButton.cancel",defaultMessage:"Close"}),description:a()(m.mo,{openState:o})})&&u.hs({environment:this.environment,store:e})}}renderComponent(){const{store:e}=this.props,t={environment:this.environment,blocks:[e],publicEditMode:void 0};if(p.xD([p.X,p.ff(p.J5)])(t)){const{device:e}=this.environment,i=p.xD([p.c2,p.ff(p.zz)])(t);return o.createElement(o.Fragment,null,a()("div",{style:{backgroundColor:this.theme.sidebarSecondaryBackground,boxShadow:`0 -1px 0 ${this.theme.regularDividerColor}`,marginTop:e.isMobile?28:1}},void 0,a()(h.Z,{disabled:!i,style:{padding:12},onClick:this.handleRestorePermissionAction},void 0,a()(f.Z,{isMultiline:!0,isSmall:!0},void 0,a()(d.FormattedMessage,{id:"blockMenuRestrictedMessage.label",defaultMessage:"You don’t have permission to edit this block because it is restricted."})),i&&a()(f.Z,{style:{marginTop:6,fontWeight:l.Z.fontWeight.semibold}},void 0,a()(d.FormattedMessage,{id:"blockMenuRestrictedMessage.adminRestoreAction.label",defaultMessage:"Restore permissions"})))))}}}v.displayName="BlockMenuRestrictedMessage";const y=v},74687:(e,t,i)=>{i.r(t),i.d(t,{default:()=>O});var n=i(10434),a=i.n(n),o=i(23174),s=i.n(o),r=i(96486),l=i.n(r),d=i(67294),c=i(83355),u=i(41892),m=i(8848),p=i(53397),g=i(30845),h=i(82990),f=i(5366),v=i(50906),y=i(33929),S=i(49085);class b extends S.default{getInitialState(){return{step:"initial"}}}const M=b;var w=i(73796),C=i(52275),_=i(63296),k=i(14871);class T extends c.Z{renderComponent(){const{intl:e,question:t}=this.props,i={setup_trial:s()(f.FormattedMessage,{id:"enterpriseContactModalQuestionSelect.question.setup_trial",defaultMessage:"Setup an enterprise trial"}),setup_enterprise_trial:s()(f.FormattedMessage,{id:"enterpriseContactModalQuestionSelect.question.setup_trial",defaultMessage:"Setup an enterprise trial"}),setup_business_trial:s()(f.FormattedMessage,{id:"contactModalQuestionSelect.question.setup_business_trial",defaultMessage:"Setup a business trial"}),live_demo:s()(f.FormattedMessage,{id:"enterpriseContactModalQuestionSelect.question.live_demo",defaultMessage:"Schedule a live demo"}),plan_help:s()(f.FormattedMessage,{id:"enterpriseContactModalQuestionSelect.question.plan_help",defaultMessage:"Need help choosing a plan"}),other:s()(f.FormattedMessage,{id:"enterpriseContactModalQuestionSelect.question.other",defaultMessage:"Other"})},n={menuTitle:e.formatMessage({defaultMessage:"Your question",id:"enterpriseContactModal.yourQuestion.title"}),items:["setup_enterprise_trial","setup_business_trial","live_demo","plan_help","other"],width:"auto",minWidth:280,getKey:e=>e,selectedItem:t,originGap:4,onSelect:e=>{this.props.onSelect(e)},renderItem:e=>d.createElement(C.Z,a()({title:i[e.key]},e)),renderOrigin:e=>d.createElement(_.Z,a()({},e,{isLarge:!0,style:{...this.getInputStyle(),...this.props.invalid&&{border:`1px solid ${m.ZP.red}`}}}),s()("div",{style:{display:"flex",alignItems:"center",color:t?this.theme.regularTextColor:this.theme.lightTextColor}},void 0,t?i[t]:s()(f.FormattedMessage,{defaultMessage:"Select question",id:"enterpriseContactModal.selectQuestion.label"})),p.Z.expand({width:10,fill:this.theme.lightIconColor}))};return d.createElement(k.Z,a()({key:"onboarding"},n))}getInputStyle(){const{device:e}=this.environment;return{backgroundColor:this.theme.whiteButtonBackground,height:31,...e.isMobile&&{height:42},padding:"2px 10px",display:"flex",alignItems:"center",justifyContent:"space-between",borderRadius:3,border:0,transition:"box-shadow 0.3s ease",boxShadow:`0 0 0 1px ${this.theme.outlineButtonBorder}`,background:this.theme.buttonBackground}}}T.displayName="ContactModalQuestionSelect";const I=(0,f.injectIntl)(T);var P=i(23063),Z=i(42922),x=i(64921),F=i(74194),A=i(3386),E=i(53953),B=i(89728),D=i(58032),R=i(29551);const L=(0,f.defineMessages)({additionalFeedbackPlaceholder:{id:"enterpriseContactModal.additionalFeedback.placeholder",defaultMessage:"What would you like to learn more about?"}});class N extends c.Z{constructor(){super(...arguments),this.storeTypes={store:M},this.renderMenu=()=>s()("div",{style:this.getContainerStyle()},void 0,this.renderCancel(),s()(R.gq,{style:this.getInnerContainerStyle(),alignItems:"center",alignContent:"center"},void 0,this.renderStep())),this.renderInitial=()=>{const{invalidField:e}=this.stores.store.state;if(w.Z.state.open)return s()("div",{style:{...this.getSlideUpStyle(),padding:20}},void 0,p.Z.speechBubbleThin({width:"100%",height:24}),s()("div",{style:{fontSize:14,fontWeight:h.Z.fontWeight.semibold,paddingTop:6,paddingBottom:4}},void 0,s()(f.FormattedMessage,{id:"enterpriseContactModal.initial.header",defaultMessage:"Get in touch with sales"})),s()("div",{style:{fontSize:12,color:this.theme.mediumTextColor,width:200,margin:"0 auto"}},void 0,s()(f.FormattedMessage,{id:"enterpriseContactModal.initial.caption",defaultMessage:"We'll work with you on your setup and help you land on the best plan."})),s()("div",{style:{...this.getLabelStyle(),marginTop:24}},void 0,s()(f.FormattedMessage,{id:"enterpriseContactModal.initial.nameLabel",defaultMessage:"Your name"})),s()(F.Z,{focusInitial:!0,value:this.getName(),placeholder:"Ada Lovelace",style:{marginRight:4,...this.getInputStyle(),..."name"===e&&this.getInvalidInputStyle()},onChange:e=>{w.Z.setState({...w.Z.state,open:!0,name:void 0}),this.stores.store.setState({...this.stores.store.state,name:e.target.value}),v.QOK(this.environment,{contactFieldType:"name",contactFieldValue:e.target.value})}}),s()("div",{style:this.getLabelStyle()},void 0,s()(f.FormattedMessage,{id:"enterpriseContactModal.initial.emailLabel",defaultMessage:"Your work email"})),s()(F.Z,{value:this.getEmail(),placeholder:"ada@lovelace.app",type:"email",style:{marginRight:4,...this.getInputStyle(),..."email"===e&&this.getInvalidInputStyle()},onChange:e=>{w.Z.setState({...w.Z.state,open:!0,email:void 0}),this.stores.store.setState({...this.stores.store.state,email:e.target.value}),v.QOK(this.environment,{contactFieldType:"email",contactFieldValue:e.target.value})}}),s()("div",{style:this.getLabelStyle()},void 0,s()(f.FormattedMessage,{id:"enterpriseContactModal.initial.companySizeLabel",defaultMessage:"Company size"})),s()(R.gq,{},void 0,this.getCompanySizeButtonData().map((e=>{let{type:t,message:i,style:n}=e;return s()(B.Z,{isLightGray:!0,isLarge:!0,style:{...this.getBaseButtonStyle(),...this.stores.store.state.companySize===t&&this.getSelectedButtonStyle(),...n},onClick:()=>{this.stores.store.setState({...this.stores.store.state,companySize:t}),v.QOK(this.environment,{contactFieldType:"companySize",contactFieldValue:t})}},t,i)}))),s()("div",{style:this.getLabelStyle()},void 0,s()(f.FormattedMessage,{id:"enterpriseContactModal.initial.questionLabel",defaultMessage:"Your question"})),s()(I,{question:this.getQuestion(),invalid:"question"===e,onSelect:e=>{this.stores.store.setState({...this.stores.store.state,question:e,step:"other"===e?"additional_input":"initial"}),v.QOK(this.environment,{contactFieldType:"question",contactFieldValue:"other"===e?"additional_input":"initial"})}}),s()(F.Z,{textarea:!0,textareaElementAttributes:{style:this.getInnerTextAreaStyle()},style:this.getTextAreaStyle(),focus:"additional_input"===this.stores.store.state.step,value:this.stores.store.state.additionalFeedback,placeholder:y.default.formatMessage(L.additionalFeedbackPlaceholder),onChange:e=>{this.stores.store.setState({...this.stores.store.state,additionalFeedback:e.target.value}),v.QOK(this.environment,{contactFieldType:"additionalFeedback",contactFieldValue:e.target.value})}}))},this.renderCancel=()=>s()(x.Z,{onClick:()=>{v.g3X(this.environment),this.handleCancel()},style:this.getCancelStyle(),hoveredStyle:{background:this.theme.buttonPressedBackground}},void 0,p.Z.closeSmall({width:14,fill:this.theme.mediumTextColor})),this.renderThanks=()=>s()("div",{},void 0,s()("img",{style:{width:165,height:80},src:u.Z.images.feedbackThankYouPng}),s()("div",{style:this.getThanksHeaderStyle()},void 0,s()(f.FormattedMessage,{id:"enterpriseContactModal.thanks.caption",defaultMessage:"We've received your inquiry and will be contacting you via email shortly."}))),this.handleCancel=()=>{w.Z.setState({open:!1})}}renderComponent(){return s()(E.Z,{preventHideChildrenWhileOpening:!0,open:w.Z.state.open,render:this.renderMenu,onDismiss:this.handleCancel})}renderStep(){const{step:e,companySize:t}=this.stores.store.state,i="1_100"===t;return d.createElement(d.Fragment,null,s()(P.Z,{isVisible:"initial"===e||"additional_input"===e,enterAnimationStyle:{opacity:1},exitAnimationStyle:{opacity:0},render:()=>s()(A.Z,{capture:!0,onBackspace:l().identity,onLeft:l().identity,onRight:l().identity,onSelectAll:l().identity,onRedo:l().identity,onUndo:l().identity,onCut:l().identity,onCopy:l().identity,onPaste:l().identity,onKeypress:l().identity,onDelete:l().identity,onTab:l().identity},void 0,this.renderInitial())}),s()(P.Z,{isVisible:"thanks"===e,animationStyle:this.getAnimationStyle("thanks"===e),enterAnimationStyle:this.getEnterExitAnimationStyle(),exitAnimationStyle:this.getEnterExitAnimationStyle(),render:this.renderThanks}),s()(P.Z,{isVisible:"initial"===e||"additional_input"===e,enterAnimationStyle:{opacity:1},exitAnimationStyle:{opacity:0},render:()=>s()(D.Z,{style:{width:"auto"},textWrap:!0,renderTooltip:()=>i?s()(f.FormattedMessage,{id:"enterpriseContactModal.companySize.error.label",defaultMessage:"The company size selected is not eligible for a sales assisted plan. Please message support if you have any questions."}):null,render:e=>d.createElement(Z.Z,a()({},e,{disabled:i,isLarge:!0,style:{marginTop:17,width:284,position:"absolute",bottom:20},onClick:()=>{const e=this.getInvalidField();if(e){const{question:t}=this.stores.store.state;this.stores.store.setState({...this.stores.store.state,step:"initial",invalidField:e,question:"other"===t?this.getQuestion():t})}else this.stores.store.setState({...this.stores.store.state,invalidField:void 0,step:"thanks"}),w.Z.state.open&&v.Ls9(this.environment,{email:w.Z.state.email,name:w.Z.state.name,question:w.Z.state.question,...this.stores.store.state}),l().delay((()=>{w.Z.reset(),l().delay((()=>{this.stores.store.reset()}),1e3)}),2e3)}}),s()(f.FormattedMessage,{id:"enterpriseContactModal.initial.sendLabel",defaultMessage:"Send"}))})}))}getName(){if(w.Z.state.open)return this.stores.store.state.name||w.Z.state.name}getEmail(){if(w.Z.state.open)return this.stores.store.state.email||w.Z.state.email}getQuestion(){if(w.Z.state.open)return this.stores.store.state.question||w.Z.state.question}getInvalidField(){const e=this.getEmail(),t=this.getName(),{companySize:i}=this.stores.store.state;return t?e&&g.B(e,"email")?i?this.getQuestion()?void 0:"question":"company_size":"email":"name"}getCompanySizeButtonData(){return[{type:"1_100",message:s()(f.FormattedMessage,{id:"enterpriseContactModal.initial.1_100Label",defaultMessage:"1-100"})},{type:"101_1000",message:s()(f.FormattedMessage,{id:"enterpriseContactModal.initial.101_1000Label",defaultMessage:"101-1,000"}),style:{marginLeft:8,marginRight:8}},{type:"1001+",message:s()(f.FormattedMessage,{id:"enterpriseContactModal.initial.1000PlusLabel",defaultMessage:"1,001+"})}]}getThanksHeaderStyle(){return{color:this.theme.regularTextColor,fontWeight:h.Z.fontWeight.semibold,fontSize:14}}getContainerStyle(){return{background:this.theme.popoverBackground,borderRadius:5,boxShadow:this.theme.mediumBoxShadow}}getCancelStyle(){return{position:"absolute",top:"10px",right:"10px",background:this.theme.buttonHoveredBackground,borderRadius:"100%",width:20,height:20,display:"flex",alignItems:"center",justifyContent:"center",zIndex:10}}getInnerContainerStyle(){return{width:320,height:470,overflow:"hidden",position:"relative",padding:20,cursor:"default",textAlign:"center",justifyContent:"center"}}getLabelStyle(){return{marginTop:17,fontSize:12,color:this.theme.mediumTextColor,fontWeight:h.Z.fontWeight.medium,lineHeight:"135%",marginBottom:4,textAlign:"left"}}getInputStyle(){return{backgroundColor:this.theme.whiteButtonBackground,height:31}}getInvalidInputStyle(){return{border:`1px solid ${m.ZP.red}`}}getAnimationStyle(e){return{opacity:e?1:0,scale:e?1:.96}}getEnterExitAnimationStyle(){return{opacity:0,scale:.96}}getBaseButtonStyle(){return{border:"1px solid #E7E6E5",flexGrow:1,justifyContent:"center"}}getSelectedButtonStyle(){return{color:m.ZP.blue,border:`1px solid ${m.ZP.blue}`}}getSlideUpStyle(){const{step:e}=this.stores.store.state;return{position:"absolute",transition:"transform 200ms ease",transform:"initial"===e?"translateY(153px)":"translateY(-180px)"}}getInnerTextAreaStyle(){return{width:"100%",height:"100%",background:"none",border:"none",resize:"none"}}getTextAreaStyle(){return{width:"100%",background:this.theme.popoverBackground,display:"block",padding:"7px 10px",height:310,marginTop:17,marginBottom:17,transition:"opacity 200ms ease-in",opacity:"additional_input"===this.stores.store.state.step?1:.001}}}N.displayName="ContactModal";const O=N},85324:(e,t,i)=>{i.r(t),i.d(t,{default:()=>I});var n=i(10434),a=i.n(n),o=i(23174),s=i.n(o),r=i(67294),l=i(480),d=i(24405),c=i(41892),u=i(86658),m=i(82990),p=i(63143),g=i(5366),h=i(92108),f=i(36867),v=i(45293),y=i(10182),S=i(42922),b=i(89728),M=i(92660),w=i(29551);function C(){window.__c={n:"SaveAllButton"};const e=(0,d.yK)(T,[]),t=(0,l.O7)();return s()(S.Z,{isLarge:!0,style:e.acceptAllButton,onClick:()=>{h.a9(t,{necessary:!0,preference:!0,performance:!0,targeting:!0}),v.Z.setState({open:!1}),h.qo()}},void 0,r.createElement(g.FormattedMessage,u.ze.acceptAllButtonLabel))}function _(){window.__c={n:"RejectAllButton"};const e=(0,d.yK)(T,[]),t=(0,l.O7)();return s()(b.Z,{isLarge:!0,isGray:!0,style:e.moreOptionsButton,onClick:()=>{h.a9(t,{necessary:!0,preference:!1,performance:!1,targeting:!1}),v.Z.setState({open:!1}),h.qo()}},void 0,r.createElement(g.FormattedMessage,u.ze.rejectAllButtonLabel))}function k(){window.__c={n:"MoreOptionsButton"};const e=(0,d.yK)(T,[]);return s()(y.Z,{hasDismissButton:!0,onDismiss:()=>{v.Z.setState({open:!1})},renderOrigin:t=>r.createElement(b.Z,a()({},t,{isLarge:!0,isGray:!0,style:e.moreOptionsButton}),r.createElement(g.FormattedMessage,u.ze.moreOptionsButtonLabel))})}function T(e){return{modal:{maxWidth:400,padding:24},image:{height:100},title:{marginTop:8,color:e.regularTextColor,fontWeight:m.Z.fontWeight.semibold,fontSize:18},description:{color:e.mediumTextColor,textAlign:"center",fontSize:14,marginTop:8,marginBottom:18},acceptAllButton:{width:"100%",marginBottom:6},moreOptionsButton:{width:"100%",display:"flex",alignItems:"center",justifyContent:"center"}}}const I=(0,g.injectIntl)((function(){window.__c={n:"CookieModal"};const e=(0,l.O7)().currentUser.id;(0,r.useEffect)((()=>{if(!e)return;(0,f._)(e);const t=window.setInterval((()=>{(0,f._)(e)}),p.A0);return()=>{window.clearInterval(t)}}),[e]);const t=(0,d.yK)(T,[]);return s()(M.Z,{onDismiss:()=>{},render:()=>s()("div",{style:t.modal},void 0,s()(w.gq,{flexDirection:"column",justifyContent:"center",alignItems:"center"},void 0,s()("img",{style:t.image,src:c.Z.images.feedbackThankYouPng}),s()("div",{style:t.title},void 0,s()(g.FormattedMessage,{id:"cookieModal.requestConsent.title",defaultMessage:"Set your cookie preferences"})),s()("div",{style:t.description},void 0,(0,u.Fd)(h.Tz,"banner")),s()(C,{}),s()(_,{}),s()(k,{}))),requireOnline:!0,modalStore:v.Z})}))},42333:(e,t,i)=>{i.r(t),i.d(t,{default:()=>V});var n=i(23174),a=i.n(n),o=i(96486),s=i.n(o),r=i(67294),l=i(83355),d=i(18466),c=i(41892),u=i(53397),m=i(82990),p=i(51454),g=i(5366),h=i(54642),f=i(73409),v=i(10482);function y(e,t,i){if(i){const{templateId:n}=i;return e.some((e=>e.milestone===t&&e.template_id===n))}return e.some((e=>e.milestone===t))}var S=i(33929),b=i(38755),M=i(8323),w=i(79315),C=i(4926),_=i(49085);const k="rate",T="send",I="thanks";class P extends _.default{getInitialState(){return{starRating:void 0,step:k}}}const Z=P;var x=i(5188),F=i(23063),A=i(42922),E=i(64921),B=i(74194),D=i(3386),R=i(31278),L=i(29551);const N=(0,g.defineMessages)({additionalFeedbackPlaceholder:{id:"csatPopup.additionalFeedback.placeholder",defaultMessage:"Tell us more..."}});class O extends l.Z{constructor(){super(...arguments),this.storeTypes={csatPopupStore:Z},this.renderCancel=()=>a()(E.Z,{onClick:this.handleCancel,style:this.getCancelStyle(),hoveredStyle:{background:this.theme.buttonPressedBackground}},void 0,u.Z.closeSmall({width:14,fill:this.theme.mediumTextColor})),this.renderStep=()=>{const{step:e}=this.stores.csatPopupStore.state,{currentSpaceStore:t}=w.default.state;let i;if(t){const e=t.getInitialUseCases();e&&(i=s().sample(e))}return r.createElement(r.Fragment,null,a()(F.Z,{isVisible:e===k,enterAnimationStyle:{opacity:1},exitAnimationStyle:{opacity:0,translateY:-120},render:()=>a()("div",{style:{paddingBottom:40}},void 0,this.renderIcon(),this.renderFeedbackPrompt(i))}),a()(F.Z,{isVisible:e===k||e===T,enterAnimationStyle:{opacity:1},exitAnimationStyle:{opacity:0},render:()=>a()("div",{style:this.getSlideContainerStyle()},void 0,this.renderStars(i),this.renderInput(),this.renderSendButton())}),a()(F.Z,{isVisible:e===I,animationStyle:this.getAnimationStyle(e===I),enterAnimationStyle:this.getEnterExitAnimationStyle(),exitAnimationStyle:this.getEnterExitAnimationStyle(),render:this.renderThanks}))},this.renderThanks=()=>a()("div",{},void 0,a()("img",{style:{width:165,height:80},src:c.Z.images.feedbackThankYouPng}),a()("div",{style:this.getThanksHeaderStyle()},void 0,a()(g.FormattedMessage,{defaultMessage:"Thanks for your feedback!",id:"csatPopup.thanks.header"})),a()("div",{style:this.getThanksDescriptionStyle()},void 0,a()(g.FormattedMessage,{defaultMessage:"Your feedback will help us make Notion better.",id:"csatPopup.thanks.description"}))),this.renderIcon=()=>{const{mainEditorCurrentBlockStore:e}=w.default.state;if(e){const t=e.getIcon();if(t)return a()(L.gq,{justifyContent:"center",alignItems:"center"},void 0,a()(R.Z,{icon:t,isEmptyPage:!1,size:32,disabled:!0}))}return a()(L.gq,{justifyContent:"center",alignItems:"center"},void 0,u.Z.notionLogo({width:32,height:32}))},this.renderFeedbackPrompt=e=>{switch(e){case"doc_notes":return a()("div",{style:this.getFeedbackPromptStyle()},"feedback-prompt",a()(g.FormattedMessage,{defaultMessage:"How satisfied are you with using Notion for notes & docs?",id:"csatPopup.feedbackPrompt.docNotesLabel"}));case"project_management":return a()("div",{style:this.getFeedbackPromptStyle()},"feedback-prompt",a()(g.FormattedMessage,{defaultMessage:"How satisfied are you with managing projects and tasks in Notion?",id:"csatPopup.feedbackPrompt.projManagementLabel"}));case"wiki":return a()("div",{style:this.getFeedbackPromptStyle()},"feedback-prompt",a()(g.FormattedMessage,{defaultMessage:"How satisfied are you with using Notion for team wikis?",id:"csatPopup.feedbackPrompt.wikiLabel"}));default:const t=this.shouldRenderAsNPS(e);return a()("div",{style:this.getFeedbackPromptStyle()},"feedback-prompt",a()(g.FormattedMessage,t?{defaultMessage:"How likely are you to recommend Notion to a friend?",id:"csatPopup.feedbackPrompt.enterpriseDefaultLabel"}:{defaultMessage:"How satisfied are you with using Notion? ",id:"csatPopup.feedbackPrompt.defaultlabel"}))}},this.renderInput=()=>{const{step:e,additionalFeedback:t}=this.stores.csatPopupStore.state;return a()(D.Z,{capture:!0,onBackspace:s().identity,onLeft:s().identity,onRight:s().identity,onSelectAll:s().identity,onRedo:s().identity,onUndo:s().identity,onCut:s().identity,onCopy:s().identity,onPaste:s().identity,onKeypress:s().identity,onDelete:s().identity,onTab:s().identity},void 0,a()(B.Z,{textarea:!0,style:this.getInputContainerStyle(),focus:e===T,value:t,placeholder:S.default.formatMessage(N.additionalFeedbackPlaceholder),onChange:e=>{this.stores.csatPopupStore.setState({...this.stores.csatPopupStore.state,additionalFeedback:e.target.value})}}))},this.renderSendButton=()=>a()(A.Z,{isLarge:!0,style:this.getButtonStyle(),onClick:this.handleSend},void 0,a()(g.FormattedMessage,{id:"csatPopup.sendButton.label",defaultMessage:"Send"})),this.renderStars=e=>{const{starRating:t,step:i}=this.stores.csatPopupStore.state,n=e=>{let{rating:n}=e;return a()("div",{style:this.getStarStyle(),onMouseEnter:()=>{i===k&&this.stores.csatPopupStore.setState({...this.stores.csatPopupStore.state,starRating:n})},onClick:()=>{this.stores.csatPopupStore.setState({starRating:n,step:T})}},void 0,u.Z.star({width:18,fill:this.theme.mediumIconColor,position:"absolute",opacity:t&&t>=n?0:1}),u.Z.starFilled({width:18,fill:"#F6C050",position:"absolute",opacity:t&&t>=n?1:0}))},o=()=>{const i=this.shouldRenderAsNPS(e);switch(t){case 1:return a()(g.FormattedMessage,i?{defaultMessage:"Very unlikely",id:"csatPopup.stars.1StarLabelNps"}:{defaultMessage:"Very dissatisfied",id:"csatPopup.stars.1StarLabel"});case 2:return a()(g.FormattedMessage,i?{defaultMessage:"Somewhat unlikely",id:"csatPopup.stars.2StarLabelNps"}:{defaultMessage:"Somewhat dissatisfied",id:"csatPopup.stars.2StarLabel"});case 3:return a()(g.FormattedMessage,i?{defaultMessage:"Not likely nor unlikely",id:"csatPopup.stars.3StarLabelNps"}:{defaultMessage:"Not dissatisfied nor satisfied",id:"csatPopup.stars.3StarLabel"});case 4:return a()(g.FormattedMessage,i?{defaultMessage:"Somewhat likely",id:"csatPopup.stars.4StarLabelNps"}:{defaultMessage:"Somewhat satisfied",id:"csatPopup.stars.4StarLabel"});case 5:return a()(g.FormattedMessage,i?{defaultMessage:"Very likely",id:"csatPopup.stars.5StarLabelNps"}:{defaultMessage:"Very satisfied",id:"csatPopup.stars.5StarLabel"});default:return a()(g.FormattedMessage,{defaultMessage:"Select an option",id:"csatPopup.stars.notSpecifiedLabel"})}};return a()("div",{onMouseLeave:()=>{s().delay((()=>{this.stores.csatPopupStore.state.step===k&&this.stores.csatPopupStore.setState({...this.stores.csatPopupStore.state,starRating:void 0})}),500)},style:this.getStarsContainerStyle()},void 0,a()("div",{style:this.getStarsStyle()},void 0,a()(n,{rating:1}),a()(n,{rating:2}),a()(n,{rating:3}),a()(n,{rating:4}),a()(n,{rating:5})),a()("div",{style:this.getStarLabelStyle()},void 0,a()(o,{})))},this.handleCancel=async()=>{const{state:e}=x.Z;if(!e.open)return;const{open:t,...i}=e;if(t&&"trigger"===i.type){const{currentSpaceStore:e}=w.default.state;if(!e)return;await h.submitCsatFeedback(this.environment,{spaceId:e.id,rating:void 0,additionalFeedback:void 0,templateId:void 0,...i})}x.Z.setState({...x.Z.state,open:!1})},this.handleSend=async()=>{const{additionalFeedback:e,starRating:t}=this.stores.csatPopupStore.state,{currentSpaceStore:i}=w.default.state;if(!i||!t)return;const{state:n}=x.Z;if(!n.open)return;const{open:a,...o}=n,r="passive"===o.type?await h.submitCsatFeedback(this.environment,{spaceId:i.id,rating:t,additionalFeedback:e,type:o.type,milestone:void 0,templateId:void 0}):await h.submitCsatFeedback(this.environment,{spaceId:i.id,rating:t,additionalFeedback:e,templateId:void 0,...o});if("success"!==r.type)throw r.error;this.stores.csatPopupStore.setState({...this.stores.csatPopupStore.state,step:I}),s().delay((()=>{x.Z.setState({...x.Z.state,open:!1}),s().delay((()=>{this.stores.csatPopupStore.reset()}),1e3)}),2e3)},this.flexCenteredStyle={display:"flex",alignItems:"center",flexDirection:"column"}}willMount(){const{userSettingsStore:e,blockStore:t,spaceStore:i}=this.props;if(e&&t&&i){const n=this.environment;if("CsatMilestoneStore"in n){const a=d.Z.withListenerIgnored((()=>function(e,t){const{userSettingsStore:i,blockStore:n,spaceStore:a}=t,o=i.getSettings(),r=null==o?void 0:o.signup_time,{CsatMilestoneStore:l}=e,{data:d}=l.state,c=864e5,u=e=>Math.floor((Date.now()-e)/c);if(!a.isDefined()||!d)return;const{milestones:m}=d;if(!m)return;if(Math.max(...m.map((e=>e.created_time)))>Date.now()-24192e5)return;if(r){const e=u(r),t=s().sample(a.getInitialUseCases())||"legacy";if(e>=180){if(!y(m,f.Hf))return{milestone:f.Hf,useCase:t}}else if(e>=90){if(!y(m,f.Vx))return{milestone:f.Vx,useCase:t}}else if(e>=28){if(!y(m,f.Sh))return{milestone:f.Sh,useCase:t}}else if(e>=7&&!y(m,f.zK))return{milestone:f.zK,useCase:t}}const p=n.getCopiedFromPointer();return n.isDefined()&&p&&(0,v.JY)(p)&&u(n.getCreatedTime())>=7&&!y(m,f.a0,{templateId:p.id})?{milestone:f.a0,useCase:"legacy",templateId:p.id}:void 0}(n,{userSettingsStore:e,blockStore:t,spaceStore:i})));if(a){const{milestone:e,useCase:t,templateId:i}=a;s().delay((()=>{x.Z.setState({open:!0,milestone:e,type:"trigger",useCase:t,templateId:i})}),2e3)}}}}renderComponent(){const{device:e}=this.environment;if(e.isMobile)return;const{currentSpaceStore:t}=w.default.state;return t&&!(0,b.Cx)(t)?a()(F.Z,{isVisible:x.Z.state.open,animationStyle:this.getAnimationStyle(x.Z.state.open),enterAnimationStyle:this.getEnterExitAnimationStyle(),exitAnimationStyle:this.getEnterExitAnimationStyle(),springConfig:this.getSpringConfig(),render:()=>a()("div",{style:this.getContainerStyle()},void 0,this.renderCancel(),a()("div",{style:this.getInnerContainerStyle()},void 0,this.renderStep()))}):void 0}shouldRenderAsNPS(e){const t=(0,M.zt)(),{state:i}=x.Z,n=i.open&&"trigger"===i.type;return"enterprise"===t&&!e&&n}getSpringConfig(){return{scale:{stiffness:58,damping:4.3}}}getAnimationStyle(e){return{opacity:e?1:0,scale:e?1:.96}}getEnterExitAnimationStyle(){return{opacity:0,scale:.96}}getThanksHeaderStyle(){return{color:this.theme.regularTextColor,fontWeight:m.Z.fontWeight.semibold,fontSize:14}}getThanksDescriptionStyle(){return{color:this.theme.mediumTextColor,fontSize:12}}getButtonStyle(){return{width:"calc(100% - 30px)"}}getInputContainerStyle(){const{step:e}=this.stores.csatPopupStore.state;return{width:"calc(100% - 30px)",display:"block",background:this.theme.popoverBackground,height:80,marginTop:10,marginBottom:10,opacity:e===k?0:1}}getStarLabelStyle(){return{fontSize:12,color:this.theme.mediumTextColor,paddingTop:4}}getFeedbackPromptStyle(){return{paddingTop:12,paddingBottom:12,color:this.theme.regularTextColor,fontWeight:m.Z.fontWeight.semibold,fontSize:14,lineHeight:1.4,width:188}}getStarStyle(){return{display:"inline-flex",position:"relative",width:20,height:20,marginRight:3}}getSlideContainerStyle(){const{step:e}=this.stores.csatPopupStore.state;return{...this.flexCenteredStyle,position:"absolute",transition:"transform 200ms ease",width:240,transform:e===k?"translateY(120px)":"translateY(0px)"}}getStarsContainerStyle(){return{width:"100%",...this.flexCenteredStyle}}getStarsStyle(){return{display:"flex",cursor:"pointer"}}getContainerStyle(){return{background:this.theme.popoverBackground,borderRadius:5,boxShadow:this.theme.mediumBoxShadow,position:"absolute",bottom:65+C.Z.state,right:16+C.Z.state,zIndex:p.hT}}getInnerContainerStyle(){return{...this.flexCenteredStyle,width:240,height:195,overflow:"hidden",position:"relative",padding:12,cursor:"default",textAlign:"center",justifyContent:"center"}}getCancelStyle(){return{position:"absolute",top:"10px",right:"10px",background:this.theme.buttonHoveredBackground,borderRadius:"100%",width:20,height:20,display:"flex",alignItems:"center",justifyContent:"center",zIndex:10}}}O.displayName="CsatPopup";const V=(0,g.injectIntl)(O)},1459:(e,t,i)=>{i.r(t),i.d(t,{default:()=>$});var n=i(23174),a=i.n(n),o=i(67294),s=i(83355),r=i(5366),l=i(79257),d=i(11599),c=i(79315),u=i(85680),m=i(88923),p=i(44532),g=i(10434),h=i.n(g),f=i(96486),v=i.n(f),y=i(15145),S=i(6695),b=i(53397),M=i(82990),w=i(50906),C=i(96802),_=i(12359),k=i(84210),T=i(87279),I=i(33665),P=i(92547),Z=i(68216),x=i(81870),F=i(26909),A=i(44514),E=i(79131),B=i(84076),D=i(78140),R=i(28992),L=i(40721),N=i(89728),O=i(31278),V=i(76798),U=i(72495),W=i(49085),K=i(61766),z=i(43700),G=i(69872);class q extends s.Z{constructor(){super(...arguments),this.storeTypes={hovered:W.default.createClass(!1),buttonPopupStore:W.default.createClass(new K.Z)}}renderComponent(){const{schema:e,property:t,format:i,showAsSectionMenu:n,handlePageSectionClick:o}=this.props,s=e[t];if(!s)return;const r=this.getPropertyVisibility(s);return a()(G.Z,{onMouseEnter:()=>this.stores.hovered.setState(!0),onMouseLeave:()=>this.stores.hovered.setState(!1),focused:this.stores.hovered.state,showDragHandle:!this.environment.device.isMobile,showExtensionArrow:!1,propertySchema:s,format:G.Z.DisplayFormat.Name,dontShrinkRight:!0,ignoreLocalHoverState:!0,locked:this.props.locked,onClick:()=>{if(!this.props.locked){const e=this.stores.buttonPopupStore.state;e.setState({open:!e.state.open})}},right:a()(z.Z,n&&o?{buttonPopupStore:this.stores.buttonPopupStore.state,visibility:r,visibilityLevels:["show","hide","hide_if_empty","inline","minimal"],locked:this.props.locked,onSelect:e=>o(e,t,i),onClose:()=>this.stores.hovered.setState(!1),type:"relation_property",propertySchema:s,showAsMenu:!0}:{buttonPopupStore:this.stores.buttonPopupStore.state,visibility:r,locked:this.props.locked,onSelect:e=>this.handleVisibilitySelectClick(e),onClose:()=>this.stores.hovered.setState(!1),type:"property",propertySchema:s})},t)}getPropertyVisibility(e){const{visibility:t}=this.props;switch(t){case"hide_if_empty":return d.kq({propertySchema:e})?"hide_if_empty":"show";default:return t}}handleVisibilitySelectClick(e){const{property:t,format:i,store:n}=this.props;_.createAndCommit({userAction:"CustomizePageMenu.handleShowAsClick",environment:this.environment,perform:a=>{l.M0({property:t,visibility:e,format:i,store:n,transaction:a})}})}}q.displayName="CustomizePageMenuPropertyMenuItem";const H=q;class j extends s.Z{constructor(){super(...arguments),this.storeTypes={lockStore:P.Z},this.handleDraggableDrop=e=>{const t=this.getCollectionPageProperties(),i=this.props.store;if(t){const n=e.map((e=>t.find((t=>t.property===e))));l.D2({environment:this.environment,properties:n,store:i})}},this.handleDraggableDropSections=e=>{const t=this.getCollectionPageSections(),i=this.props.store;if(t){const n=e.map((e=>t.find((t=>t.section===e))));t&&_.createAndCommit({userAction:"CustomizePageMenu.handleDraggableDropSections",environment:this.environment,perform:e=>{l.Do({environment:this.environment,pageSectionFormats:n,store:i,transaction:e})}})}},this.handleShowAsClick=(e,t,i,n)=>{const a=d.$0();if(!a)return!1;let o=n.collection_page_sections?v().cloneDeep(n.collection_page_sections):[];if(!i[t])return;const s=o.findIndex((e=>e.section===t));-1!==s?o[s]={section:t,visibility:e}:o=[...o,{section:t,visibility:e}];const r="inline"===e||"minimal"===e?"section":"show";o&&(_.createAndCommit({userAction:"CustomizePageMenu.handleShowAsClick",environment:this.environment,perform:e=>{l.Do({environment:this.environment,pageSectionFormats:o,store:a,transaction:e}),l.M0({property:t,visibility:r,store:a,format:n,transaction:e})}}),w.K1b(this.environment,{from:"page_properties",mode:"inline"===e?"page_section":"minimal"===e?"minimal_page_section":"property"}))},this.handleShowAsSectionMenuClick=(e,t,i)=>{const n=d.$0();if(!n)return;let a=i.collection_page_sections?v().cloneDeep(i.collection_page_sections):[];if("inline"===e||"minimal"===e){const o=a.findIndex((e=>e.section===t));-1!==o?a[o]={section:t,visibility:e}:a=[...a,{section:t,visibility:e}];const s="inline"===e||"minimal"===e?"section":"show";a&&(_.createAndCommit({userAction:"CustomizePageMenu.handleShowAsPageSectionClick",environment:this.environment,perform:e=>{l.Do({environment:this.environment,pageSectionFormats:a,store:n,transaction:e}),l.M0({property:t,visibility:s,store:n,format:i,transaction:e})}}),w.K1b(this.environment,{from:"page_properties",mode:"minimal"===e?"minimal_page_section":"page_section"}))}else{const a=S.AX.find((t=>t===e));if(!a)return;_.createAndCommit({userAction:"CustomizePageMenu.handleShowAsPropertyClick",environment:this.environment,perform:e=>{l.M0({property:t,visibility:a,store:n,format:i,transaction:e})}}),w.K1b(this.environment,{from:"page_properties",mode:"property"})}},this.handleToggleLockClick=()=>{const e=d.$0();if(!e)return!1;const t=e.getParentBlockStore();t&&(_.createAndCommit({userAction:"CustomizePageMenu.handleToggleLockClick",environment:this.environment,perform:e=>{C.Wq({environment:this.environment,store:t,isLocked:!d.p1(),transaction:e})}}),this.stores.lockStore.setState({justUnlocked:!this.stores.lockStore.state.justUnlocked}))}}renderComponent(){const{device:e}=this.environment,t=this.createComputedStore((()=>"page"===this.props.type?this.props.store.isExternalObjectInstancePageBlockStore():this.props.store.isSyncedCollection()));let i;i=e.isMobile?{menuType:T.og.Modal,right:a()(L.DoneMenuText,{}),onClickRight:l.xv,title:this.props.intl.formatMessage({id:"customizePageMenu.mobileHeader.label",defaultMessage:"Customize page"})}:{menuType:T.og.Popup,minWidth:400};const n=this.getNormalizedFormat();return o.createElement(D.Z,h()({},i,{header:this.renderHeader()}),(this.props.locked||this.stores.lockStore.state.justUnlocked)&&this.renderLockControls(),this.renderPageSectionsSectionMenuItem(n,t.state),this.renderPropertiesSectionMenuItem(n))}renderLockControls(){return a()("div",{style:{fontSize:12,display:"flex",justifyContent:"center",alignItems:"center",borderTop:`1px solid ${this.theme.regularDividerColor}`,borderBottom:`1px solid ${this.theme.regularDividerColor}`,background:this.theme.sidebarBackground,color:this.theme.mediumTextColor,paddingTop:6,paddingBottom:6}},void 0,a()("span",{style:{display:"inline-block",verticalAlign:"middle",paddingRight:6}},void 0,this.stores.lockStore.state.justUnlocked?b.Z.unlocked({height:12,width:12,fill:this.theme.mediumIconColor}):b.Z.locked({height:12,width:12,fill:this.theme.mediumIconColor})),this.stores.lockStore.state.justUnlocked?a()(r.FormattedMessage,{id:"customizePageMenu.unlocked.header",defaultMessage:"Settings unlocked on parent database."}):a()(r.FormattedMessage,{id:"customizePageMenu.locked.header",defaultMessage:"Settings locked on parent database."}),a()(N.Z,{style:{fontSize:12,color:this.theme.mediumTextColor,fontWeight:M.Z.fontWeight.semibold,marginLeft:2,paddingLeft:4,paddingRight:4,height:20},onClick:this.handleToggleLockClick},void 0,this.stores.lockStore.state.justUnlocked?a()(r.FormattedMessage,{id:"customizePageMenu.lock.label",defaultMessage:"Re-lock"}):a()(r.FormattedMessage,{id:"customizePageMenu.unlock.label",defaultMessage:"Unlock"})))}renderPropertiesSectionMenuItem(e){if(!this.getSchema()||"page"===this.props.type)return;const t=this.getPageCustomization(e);if(!t)return;const{propertyVisibility:i}=t;if(!i)return;const n=i.reduce(((e,t)=>(e[t.property]=t.visibility,e)),{}),o=this.getCollectionPageSections().filter((e=>"inline"===e.visibility||"minimal"===e.visibility)).map((e=>e.section)),s=v().difference(this.getCollectionPageProperties().map((e=>e.property)),o);return a()(U.Z,{style:{opacity:this.props.locked?.5:1},title:a()(r.FormattedMessage,{id:"customizePageMenu.propertiesSection.header",defaultMessage:"Properties"})},void 0,this.renderDraggablePageProperties(s,n,e,this.handleDraggableDrop))}renderPageSectionsSectionMenuItem(e,t){const i=this.props.store,n=this.getSchema();if(!n||!i)return;const s=this.getPageCustomization(e);if(!s)return;const{pageSectionVisibility:c}=s;if(!c)return;const u=this.getCollectionPageSections().map((e=>e.section)),m={topLevelDiscussions:!t,backLinks:!0,pageComments:!t};return o.createElement(o.Fragment,null,a()(U.Z,{style:{opacity:this.props.locked?.5:1},title:a()(r.FormattedMessage,{id:"customizePageMenu.sectionsSection.header",defaultMessage:"Sections"}),topBorder:!this.props.locked&&!this.stores.lockStore.state.justUnlocked},void 0,a()("div",{style:{marginLeft:8}},void 0,u.length>0&&a()(U.Z,{style:{opacity:this.props.locked?.5:1,width:"100%",paddingBottom:0,paddingTop:0}},void 0,a()(E.ZP,{direction:"vertical",keys:u,renderKey:t=>{if("collection"===this.props.type&&"inline"===(0,d.ab)(void 0,t))return this.renderRelationSectionMenuItem(n,t,e)},onDrop:this.handleDraggableDropSections}),a()(E.ZP,{direction:"vertical",keys:u,renderKey:t=>{if("collection"===this.props.type&&"minimal"===(0,d.ab)(void 0,t))return this.renderRelationSectionMenuItem(n,t,e)},onDrop:this.handleDraggableDropSections})),m.topLevelDiscussions&&a()(R.Z,{title:a()(r.FormattedMessage,{id:"customizePageMenu.pageSections.topLevelPageDiscussionsTitle",defaultMessage:"Top-level page discussions"}),icon:b.Z.speechBubbleThick({height:16,width:16}),right:a()(z.Z,{visibility:c.comments,visibilityLevels:["section_show","section_hide"],locked:this.props.locked,onSelect:t=>{l.W4({environment:this.environment,pageSection:"comments",visibility:t,store:i,format:e})},type:"page"})}),m.backLinks&&a()(R.Z,{title:a()(r.FormattedMessage,{id:"customizePageMenu.pageSections.backlinksTitle",defaultMessage:"Backlinks"}),icon:b.Z.alias({height:16,width:16,transform:"rotate(180deg)"}),right:a()(z.Z,{visibility:c.backlinks,locked:this.props.locked,visibilityLevels:["section_show","section_hide","section_collapsed"],onSelect:t=>{l.W4({environment:this.environment,pageSection:"backlinks",visibility:t,store:i,format:e})},type:"page"})}),m.pageComments&&a()(R.Z,{title:a()(r.FormattedMessage,{id:"customizePageMenu.pageSections.pageCommentsTitle",defaultMessage:"Page comments"}),icon:b.Z.speechBubbleThick({height:16,width:16}),right:a()(z.Z,{visibility:(0,d.ab)(c,"margin_comments"),visibilityLevels:["inline","minimal"],locked:this.props.locked,onSelect:t=>{l.W4({environment:this.environment,pageSection:"margin_comments",visibility:t,store:i,format:e})},type:"page"})}))))}renderRelationSectionMenuItem(e,t,i){var n;return a()("div",{style:{display:"inline-flex",width:"100%"}},void 0,a()(R.Z,{title:null===(n=e[t])||void 0===n?void 0:n.name,icon:b.Z.typesRelation({height:14,width:14,color:this.theme.mediumIconColor,fill:this.theme.mediumIconColor,fontWeight:M.Z.fontWeight.medium}),disabled:this.props.locked,showDragHandle:!this.environment.device.isMobile,right:a()(z.Z,{visibility:(0,d.ab)(void 0,t),visibilityLevels:["section_hide","inline","minimal"],locked:this.props.locked,onSelect:n=>{this.handleShowAsClick(n,t,e,i)},type:"page",showAsMenu:!0})}))}renderHeader(){if(this.environment.device.isMobile)return;const{store:e}=this.props;if(e){const t=e.getIcon(),i="collection"===this.props.type?this.props.store.getParentBlockStore():void 0,n=t&&a()(O.Z,{icon:t,isEmptyPage:!1,size:14,disabled:!0,style:{display:"inline-flex",marginRight:2}}),s=a()(V.Z,{store:e,style:{display:"inline"}}),d=i?a()(A.Q,{prefix:a()(r.FormattedMessage,{id:"customizePageMenu.header.allPages.label",defaultMessage:"Customize all pages in"}),viewName:i?o.createElement(o.Fragment,null,a()(B.Z,{onClick:l.xv,href:(0,k.ZP)({store:i,fullyQualified:!1,pageVisitSource:y.tY.Breadcrumb}),inline:!0},void 0,n,s)):o.createElement(o.Fragment,null,n,s)}):a()(r.FormattedMessage,{id:"customizePageMenu.header.singlePage.label",defaultMessage:"Customize this page view"});return a()(R.Z,{style:{...F.ZP.headingStyle},title:d,right:a()(x.Z,{helpButtonContext:"customize_page_menu",href:(0,I.UY)("guides.customizePageView")})})}}renderDraggablePageProperties(e,t,i,n){const o=this.getSchema(),s=this.props.store;return s instanceof Z.NW?a()(E.ZP,{direction:"vertical",keys:e,renderKey:e=>{var n;const r=null===(n=o[e])||void 0===n?void 0:n.type;if("collection"===this.props.type)return a()(H,"relation"===r?{schema:o,visibility:t[e],property:e,format:i,store:s,locked:this.props.locked,showAsSectionMenu:!0,handlePageSectionClick:this.handleShowAsSectionMenuClick}:{schema:o,visibility:t[e],property:e,format:i,store:s,locked:this.props.locked})},onDrop:n}):null}getSchema(){return this.props.type,this.props.store.getSchema()}getNormalizedFormat(){const{store:e}=this.props,t=e.getFormat(),i=this.getSchema();if(!i)return{};return S.iB(t,i,void 0,S.j5.Collection)}getCollectionPageProperties(){if("collection"!==this.props.type)return[];return this.getNormalizedFormat().collection_page_properties||[]}getCollectionPageSections(){if("collection"!==this.props.type)return[];return this.getNormalizedFormat().collection_page_sections||[]}getPageCustomization(e){return{propertyVisibility:e.property_visibility,pageSectionVisibility:e.page_section_visibility}}isWikiPage(){const e=this.props.store.getParentStore();return!!(e&&e instanceof Z.G)&&e.isAssociatedCollectionAPageTree()}}j.displayName="CustomizePageMenu";const Q=j;class Y extends s.Z{constructor(){super(...arguments),this.renderModal=()=>{if(!u.Z.state.isOpen)return;const e=d.$0(),{mainEditorCurrentBlockStore:t}=c.default.state,i=m.default.state.open&&m.default.state.target||t;return e?a()(Q,{store:e,type:"collection",intl:this.props.intl,locked:d.p1()}):i?a()(Q,{store:i,type:"page",intl:this.props.intl,locked:!1}):void 0}}renderComponent(){const{device:e}=this.environment,t=u.Z.state;return a()(p.ZP,{popupType:e.isMobile?p.ZP.PopupType.SlideUp:p.ZP.PopupType.Popup,alignmentToOrigin:p.ZP.Alignment.Center,open:t.isOpen,render:this.renderModal,originRect:t.isOpen?t.rect:void 0,onDismiss:()=>l.xv()})}}Y.displayName="CustomizePageMenuRenderer";const $=(0,r.injectIntl)(Y)},43700:(e,t,i)=>{i.d(t,{Z:()=>y});var n=i(23174),a=i.n(n),o=i(10434),s=i.n(o),r=i(67294),l=i(83355),d=i(53397),c=i(5366),u=i(61766),m=i(31194),p=i(31945),g=i(89728),h=i(6318);const f=(0,c.defineMessages)({hideSimpleLabel:{id:"customizePageMenuVisibilitySelect.hideSimple.label",defaultMessage:"Hide"},hideLabel:{id:"customizePageMenuVisibilitySelect.hide.label",defaultMessage:"Always hide"},hidePageLabel:{id:"customizePageMenuVisibilitySelect.off.label",defaultMessage:"Off"},showLabel:{id:"customizePageMenuVisibilitySelect.show.label",defaultMessage:"Always show"},showPageLabel:{id:"customizePageMenuVisibilitySelect.expanded.label",defaultMessage:"Expanded"},hideIfEmptyLabel:{id:"customizePageMenuVisibilitySelect.hideIfEmpty.label",defaultMessage:"Hide when empty"},collapsedLabel:{id:"customizePageMenuVisibilitySelect.collapsed.label",defaultMessage:"Show in popover"},defaultLabel:{id:"customizePageMenuVisibilitySelect.default.label",defaultMessage:"Default"},minimalLabel:{id:"customizePageMenuVisibilitySelect.minimal.label",defaultMessage:"Minimal"},sectionLabel:{id:"customizePageMenuVisibilitySelect.section.label",defaultMessage:"As page section"},propertyLabel:{id:"customizePageMenuVisibilitySelect.property.label",defaultMessage:"As property"}});class v extends l.Z{constructor(){super(...arguments),this.storeTypes={buttonPopupStore:u.Z}}renderComponent(){const{device:e}=this.environment;return a()(p.ZP,{popupType:e.isMobile?p.Z4.SlideUp:p.Z4.Popup,buttonPopupStore:this.stores.buttonPopupStore,renderOrigin:e=>r.createElement(g.Z,s()({style:{color:this.theme.mediumTextColor,paddingRight:0,height:this.environment.device.isMobile?32:22},disabled:this.props.locked},e),v.getVisibilityLabel(this.props.visibility,this.props.showAsMenu),d.Z.chevronDown({width:10,marginLeft:4,marginRight:4,fill:this.theme.lightIconColor})),placementToOrigin:m.Iw.Bottom,onClose:this.props.onClose,render:e=>r.createElement(h.Z,s()({},this.props,{onClose:e.close}))})}static getVisibilityLabel(e,t){switch(e){case"hide":return r.createElement(c.FormattedMessage,f.hideLabel);case"show":return r.createElement(c.FormattedMessage,f.showLabel);case"hide_if_empty":return r.createElement(c.FormattedMessage,f.hideIfEmptyLabel);case"section_hide":return t?r.createElement(c.FormattedMessage,f.propertyLabel):r.createElement(c.FormattedMessage,f.hidePageLabel);case"section_show":return r.createElement(c.FormattedMessage,f.showPageLabel);case"section_collapsed":return r.createElement(c.FormattedMessage,f.collapsedLabel);case"inline":return t?r.createElement(c.FormattedMessage,f.sectionLabel):r.createElement(c.FormattedMessage,f.defaultLabel);case"minimal":return r.createElement(c.FormattedMessage,f.minimalLabel)}}}v.displayName="CustomizePageMenuVisibilitySelect";const y=v},6318:(e,t,i)=>{i.d(t,{Z:()=>b});var n=i(10434),a=i.n(n),o=i(23174),s=i.n(o),r=i(67294),l=i(83355),d=i(6695),c=i(53397),u=i(5366),m=i(11599),p=i(87279),g=i(52275),h=i(78140),f=i(32163),v=i(72495),y=i(43700);class S extends l.Z{constructor(){super(...arguments),this.renderMenuItem=e=>{const{device:t}=this.environment;return{key:e,render:i=>r.createElement(g.Z,a()({},i,{textWrapperStyle:{marginRight:0},title:s()("div",{style:{display:"flex",alignItems:"center",width:150}},void 0,s()("div",{},void 0,y.Z.getVisibilityLabel(e,this.props.showAsMenu))),right:this.props.visibility===e?s()("div",{style:{width:t.isMobile?16:14}},void 0,c.Z.check()):void 0})),action:()=>{if("page"===this.props.type){const t=e;this.props.onSelect(t)}if("relation_property"===this.props.type){const t=e;this.props.onSelect(t)}else if("property"===this.props.type){const t=e;this.props.onSelect(t)}this.props.onClose&&this.props.onClose()}}}}renderComponent(){const{device:e}=this.environment,t=[{key:"visibilityLevels",render:e=>r.createElement(v.Z,a()({},e,{topBorder:0!==e.index})),items:"page"===this.props.type||"relation_property"===this.props.type?this.getPageOrPropertyVisibilityLevels().map((e=>this.renderMenuItem(e))):this.getPropertyVisibilityLevels().filter((e=>"property"!==this.props.type||"hide_if_empty"!==e||m.kq({propertySchema:this.props.propertySchema}))).map((e=>this.renderMenuItem(e)))}];let i;return i=e.isMobile?{menuType:p.og.Modal,title:s()(u.FormattedMessage,{id:"customizePageMenuVisibilitySelect.mobile.title",defaultMessage:"Select visibility"}),right:s()(u.FormattedMessage,{id:"customizePageMenuVisibilitySelect.mobile.doneButton.label",defaultMessage:"Done"}),onClickRight:()=>this.props.onClose&&this.props.onClose()}:{menuType:p.og.Popup,width:"auto",maxWidth:360},r.createElement(h.Z,i,s()(f.Z,{type:f.i.Vertical,initialFocus:void 0,sections:t}))}getPageOrPropertyVisibilityLevels(){return"page"!==this.props.type&&"relation_property"!==this.props.type?[]:this.props.visibilityLevels?this.props.visibilityLevels:d.Sn}getPropertyVisibilityLevels(){return d.AX}}S.displayName="CustomizePageMenuVisibilitySelectMenuItem";const b=S},60043:(e,t,i)=>{i.r(t),i.d(t,{default:()=>Y});var n=i(10434),a=i.n(n),o=i(23174),s=i.n(o),r=i(96486),l=i.n(r),d=i(17126),c=i(67294),u=i(83355),m=i(13991),p=i(49085),g=i(8848),h=i(41797),f=i(5366),v=i(40506);const y=(0,f.defineMessages)({none:{defaultMessage:"None",id:"dateFormatHelpers.reminderMenuItems.none"},onTheDay:{defaultMessage:"On day of event {formattedTimeText}",id:"dateFormatHelpers.reminderMenuItems.onTheDayOfEvent"},hoursBefore:{defaultMessage:"{numberOfHours, plural, one {{numberOfHours} hour before} other {{numberOfHours} hours before}}",id:"dateFormatHelpers.reminderMenuItems.hoursBefore"},minutesBefore:{defaultMessage:"{numberOfMinutes, plural, one {{numberOfMinutes} minute before} other {{numberOfMinutes} minutes before}}",id:"dateFormatHelpers.reminderMenuItems.minutesBefore"},yearsBefore:{defaultMessage:"{numberOfYears, plural, one {{numberOfYears} year before {formattedTimeText}} other {{numberOfYears} years before {formattedTimeText}}}",id:"dateFormatHelpers.reminderMenuItems.yearsBefore"},daysBefore:{defaultMessage:"{numberOfDays, plural, one {{numberOfDays} day before {formattedTimeText}} other {{numberOfDays} days before {formattedTimeText}}}",id:"dateFormatHelpers.reminderMenuItems.daysBefore"},monthsBefore:{defaultMessage:"{numberOfMonths, plural, one {{numberOfMonths} month before {formattedTimeText}} other {{numberOfMonths} months before {formattedTimeText}}}",id:"dateFormatHelpers.reminderMenuItems.monthsBefore"},weeksBefore:{defaultMessage:"{numberOfWeeks, plural, one {{numberOfWeeks} week before {formattedTimeText}} other {{numberOfWeeks} weeks before {formattedTimeText}}}",id:"dateFormatHelpers.reminderMenuItems.weeksBefore"},atTimeOf:{defaultMessage:"At time of event",id:"dateFormatHelpers.reminderMenuItems.atTimeOfEvent"}});function S(e){const{reminder:t,shouldShowTime:i,intl:n,formatTime:a}=e;if(!t)return n.formatMessage(y.none);if(v.vJ(t)){const{unit:e,value:o,time:s}=t,r=a({start_time:s,time_format:"LT",humanReadable:!0,intl:n}),l=i?`(${r})`:"";return 0===o?n.formatMessage(y.onTheDay,{formattedTimeText:l}):"day"===e?n.formatMessage(y.daysBefore,{formattedTimeText:l,numberOfDays:o}):"year"===e?n.formatMessage(y.yearsBefore,{formattedTimeText:l,numberOfYears:o}):"month"===e?n.formatMessage(y.monthsBefore,{formattedTimeText:l,numberOfMonths:o}):n.formatMessage(y.weeksBefore,{formattedTimeText:l,numberOfWeeks:o})}{const{unit:e,value:i}=t;return 0===i?n.formatMessage(y.atTimeOf):"hour"===e?n.formatMessage(y.hoursBefore,{numberOfHours:i}):n.formatMessage(y.minutesBefore,{numberOfMinutes:i})}}var b=i(7057),M=i(53877),w=i(84795),C=i(42875),_=i(11843),k=i(53397),T=i(97880),I=i(63143),P=i(50906),Z=i(87279),x=i(33665),F=i(77907),A=i(76150),E=i(52275),B=i(31945),D=i(37601),R=i(88359),L=i(1743),N=i(74194),O=i(78140),V=i(32163),U=i(72495),W=i(14871),K=i(24006),z=i(58032),G=i(64369),q=i(83182),H=i(46247),j=i(62069);class Q extends u.Z{constructor(){super(...arguments),this.storeTypes={store:A.ZP,timezoneQuery:p.default.createClass("")},this.handleWindowKeyDown=e=>{"Escape"===e.key&&this.maybePreEmptivelyBlurInput()},this.handleWindowMouseDown=e=>{e.target instanceof HTMLInputElement&&e.target===document.activeElement||this.maybePreEmptivelyBlurInput()},this.handleDateFormatChange=e=>{var t,i;null===(t=(i=this.props).onChangeDateFormat)||void 0===t||t.call(i,e)},this.handleTimeFormatChange=e=>{var t,i;const n=this.getTimeFormatOptions()[e];null===(t=(i=this.props).onChangeTimeFormat)||void 0===t||t.call(i,n)},this.handleChangeReminder=e=>{const t=this.getDateValue();var i,n;if(e){if(v.vJ(e)){var a,o;null===(a=(o=this.props).onChangeValue)||void 0===a||a.call(o,{...t,reminder:{...e,defaultTimeZone:(0,C.r)()}})}else if("datetime"===t.type||"datetimerange"===t.type){var s,r;null===(s=(r=this.props).onChangeValue)||void 0===s||s.call(r,{...t,reminder:e})}}else null===(i=(n=this.props).onChangeValue)||void 0===i||i.call(n,{...t,reminder:e});P.IMD(this.environment,{date:t,reminder:e})},this.handleInputChange=e=>{const{device:t}=this.environment,{store:i}=this.stores;i.setState({...i.state,inputTemporaryValue:{...i.state.inputTemporaryValue,[i.state.focus]:e.target.value||""}}),t.isAndroid&&this.handleInputBlur()},this.handleStartDateInputChange=()=>{const{inputTemporaryValue:e}=this.stores.store.state,t=e.startDate;if(!t)return;const i=this.parseInputDateValue(t);if(!i)return A.pd.InvalidDate;const n={...this.getDateValue(),start_date:i},a=M.XI(n);if(!a)return A.pd.InvalidRange;this.applyValidDateState({newDate:n,currentMonth:a.start,resetField:A.Hv.StartDate})},this.handleStartTimeInputChange=()=>{const{inputTemporaryValue:e}=this.stores.store.state,t=e.startTime;if(!t)return;const i=this.parseInputTimeValue(t);if(!i)return A.pd.InvalidTime;const n=this.getDateValue();if(v.qg(n)){const{newDate:e,currentMonth:t}=M.vz({previous:n,updatedStartTime:i});this.applyValidDateState({newDate:e,currentMonth:t,resetField:A.Hv.StartTime}),this.resetInputState(A.Hv.EndDate),this.resetInputState(A.Hv.EndTime)}else{const e={...n,start_time:i},t=M.XI(e);this.applyValidDateState({newDate:e,currentMonth:t.start,resetField:A.Hv.StartTime})}},this.handleEndDateInputChange=()=>{const{inputTemporaryValue:e}=this.stores.store.state,t=e.endDate;if(!t)return;const i=this.parseInputDateValue(t);if(!i)return A.pd.InvalidDate;const n={...this.getDateValue(),end_date:i},a=M.XI(n);if(!a)return A.pd.InvalidRange;this.applyValidDateState({newDate:n,currentMonth:a.end,resetField:A.Hv.EndDate})},this.handleEndTimeInputChange=()=>{const{inputTemporaryValue:e}=this.stores.store.state,t=e.endTime;if(!t)return;const i=this.parseInputTimeValue(t);if(!i)return A.pd.InvalidTime;const n={...this.getDateValue(),end_time:i},a=M.XI(n);if(!a)return A.pd.InvalidRange;this.applyValidDateState({newDate:n,currentMonth:a.end,resetField:A.Hv.EndTime})},this.handleInputBlur=e=>{const{focus:t}=this.stores.store.state;let i;t===A.Hv.StartDate?i=this.handleStartDateInputChange():t===A.Hv.StartTime?i=this.handleStartTimeInputChange():t===A.Hv.EndDate?i=this.handleEndDateInputChange():t===A.Hv.EndTime&&(i=this.handleEndTimeInputChange()),i?this.stores.store.setState({...this.stores.store.state,error:{...this.stores.store.state.error,[t]:i}}):this.stores.store.setState({...this.stores.store.state,inputTemporaryValue:{startDate:void 0,startTime:void 0,endDate:void 0,endTime:void 0},inputIsFocused:!1,error:{startDate:void 0,startTime:void 0,endDate:void 0,endTime:void 0}})},this.handleInputSubmit=()=>{const{focus:e}=this.stores.store.state;let t;e===A.Hv.StartDate?t=this.handleStartDateInputChange():e===A.Hv.StartTime?t=this.handleStartTimeInputChange():e===A.Hv.EndDate?t=this.handleEndDateInputChange():e===A.Hv.EndTime&&(t=this.handleEndTimeInputChange()),t?this.stores.store.setState({...this.stores.store.state,error:{...this.stores.store.state.error,[e]:t}}):this.stores.store.setState({...this.stores.store.state,inputTemporaryValue:{startDate:void 0,startTime:void 0,endDate:void 0,endTime:void 0},error:{startDate:void 0,startTime:void 0,endDate:void 0,endTime:void 0}})},this.handleDayPickerDayClick=(e,t,i)=>{if(this.props.disabled)return;let n=l().cloneDeep(this.getDateValue());const{focus:a}=this.stores.store.state,o=d.ou.fromJSDate(e).setLocale(v.ah).toFormat(M.Iq);if(!i.shiftKey||"date"!==n.type&&"datetime"!==n.type)if("daterange"===n.type||"datetimerange"===n.type){var s,r;a===A.Hv.StartDate||a===A.Hv.StartTime?n={...n,start_date:o}:a!==A.Hv.EndDate&&a!==A.Hv.EndTime||(n={...n,end_date:o});const e=M.NK(n,(0,C.r)());if(e.end&&e.end<e.start){if("datetimerange"===n.type){const{start_date:e,start_time:t,end_date:i,end_time:a}=n;n={...n,start_date:i,start_time:a,end_date:e,end_time:t}}else{const{start_date:e,end_date:t}=n;n={...n,start_date:t,end_date:e}}this.stores.store.setState({...this.stores.store.state,focus:a===A.Hv.StartDate||a===A.Hv.StartTime?A.Hv.EndDate:A.Hv.StartDate})}null===(s=(r=this.props).onChangeValue)||void 0===s||s.call(r,n),this.resetInputState(a);const t=a===A.Hv.StartDate||a===A.Hv.StartTime?A.Hv.EndDate:A.Hv.StartDate;this.stores.store.setState({...this.stores.store.state,focus:t})}else{var c,u;const e={...n,start_date:o};null===(c=(u=this.props).onChangeValue)||void 0===c||c.call(u,e),this.resetInputState(a)}else this.enableEndDate({dateValue:n,endDate:o})},this.handleDayPickerMonthChange=e=>{this.stores.store.setState({...this.stores.store.state,currentMonth:d.ou.fromJSDate(e)})},this.handleEndDateControlChange=()=>{const e=this.getDateValue();if("datetimerange"===e.type){var t,i;const n={type:"datetime",start_date:e.start_date,start_time:e.start_time,time_zone:e.time_zone,reminder:e.reminder};null===(t=(i=this.props).onChangeValue)||void 0===t||t.call(i,n)}else if("daterange"===e.type){var n,a;const t={type:"date",start_date:e.start_date,reminder:e.reminder};null===(n=(a=this.props).onChangeValue)||void 0===n||n.call(a,t)}else this.enableEndDate({dateValue:e})},this.handleAllDayChange=()=>{const e=this.getDateValue();if("date"===e.type){var t,i;const n={type:"datetime",start_date:e.start_date,start_time:"00:00",time_zone:(0,C.r)(),reminder:e.reminder&&v.AE(e.reminder)};null===(t=(i=this.props).onChangeValue)||void 0===t||t.call(i,n)}else if("daterange"===e.type){var n,a;const t={type:"datetimerange",start_date:e.start_date,start_time:"00:00",end_date:e.end_date,end_time:"00:00",time_zone:(0,C.r)(),reminder:e.reminder&&v.AE(e.reminder)};null===(n=(a=this.props).onChangeValue)||void 0===n||n.call(a,t)}else if("datetime"===e.type){var o,s;const t={type:"date",start_date:e.start_date,reminder:e.reminder&&v.wg(e.reminder,(0,C.r)())};null===(o=(s=this.props).onChangeValue)||void 0===o||o.call(s,t)}else{var r,l;const t={type:"daterange",start_date:e.start_date,end_date:e.end_date,reminder:e.reminder&&v.wg(e.reminder,(0,C.r)())};null===(r=(l=this.props).onChangeValue)||void 0===r||r.call(l,t)}},this.handleTimeZoneChange=e=>{const t=this.getDateValue();if("datetime"===t.type||"datetimerange"===t.type){var i,n;const a={...t,time_zone:e};null===(i=(n=this.props).onChangeValue)||void 0===i||i.call(n,a)}},this.handleStartInputDateFocus=()=>{const e=this.getDateValue(),t=M.NK(e,(0,C.r)());this.stores.store.setState({...this.stores.store.state,focus:A.Hv.StartDate,inputIsFocused:!0,currentMonth:t.start})},this.handleStartInputTimeFocus=()=>{const e=this.getDateValue(),t=M.NK(e,(0,C.r)());this.stores.store.setState({...this.stores.store.state,focus:A.Hv.StartTime,inputIsFocused:!0,currentMonth:t.start})},this.handleEndInputDateFocus=()=>{const e=this.getDateValue(),t=M.NK(e,(0,C.r)());t.end&&this.stores.store.setState({...this.stores.store.state,focus:A.Hv.EndDate,inputIsFocused:!0,currentMonth:t.end})},this.handleEndInputTimeFocus=()=>{const e=this.getDateValue(),t=M.NK(e,(0,C.r)());t.end&&this.stores.store.setState({...this.stores.store.state,focus:A.Hv.EndTime,inputIsFocused:!0,currentMonth:t.end})},this.handleClearClick=()=>{var e,t;null===(e=(t=this.props).onChangeValue)||void 0===e||e.call(t,void 0)},this.getTimeFormatOptions=()=>(0,_.E)(m.SP).time,this.getSelectedTimeFormatType=()=>{const e=this.getTimeDisplayFormat(),t=this.getTimeFormatOptions();for(const i in t)if(t[i]===e)return i;return"12h"},this.tooltipOriginGap=12}willMount(e){super.willMount(e),this.openTimeFormat=M.Lg((0,C.r)()),window.addEventListener("mousedown",this.handleWindowMouseDown),window.addEventListener("keydown",this.handleWindowKeyDown,!0)}willUnmount(){super.willUnmount(),window.removeEventListener("mousedown",this.handleWindowMouseDown),window.removeEventListener("keydown",this.handleWindowKeyDown,!0)}maybePreEmptivelyBlurInput(){const{inputIsFocused:e}=this.stores.store.state;e&&this.handleInputBlur()}renderComponent(){const{device:e,WindowSizeStore:t}=this.environment,{disabled:i,canConfigureCollection:n,shouldShowReminder:a,header:o}=this.props,{inputIsFocused:r}=this.stores.store.state,l=this.getDateValue(),d="datetime"===l.type||"datetimerange"===l.type,u="daterange"===l.type||"datetimerange"===l.type,m=s()("div",{style:{paddingTop:e.isMobile?16:8,paddingBottom:e.isMobile?16:8,paddingLeft:e.isMobile?t.getSafePaddingLeftCSS(16):14,paddingRight:e.isMobile?t.getSafePaddingRightCSS(16):14,display:d?"block":"flex",...e.isMobile&&{boxShadow:`\n\t\t\t\t\t\t\t0 1px 0 ${this.theme.regularDividerColor}\n\t\t\t\t\t\t`,position:"relative",zIndex:2},background:e.isMobile?this.theme.popoverBackground:void 0}},void 0,this.renderStartInput(),u&&s()("div",{style:{width:12,height:8}}),this.renderEndInput(),this.renderTimeZone());let p;return p=e.isMobile?{menuType:Z.og.Modal,title:s()(f.FormattedMessage,{defaultMessage:"Date",id:"LuxonDatePropertyMenu.mobileDate.title"}),right:s()(f.FormattedMessage,{defaultMessage:"Done",id:"LuxonDatePropertyMenu.mobileDoneButton.label"}),left:a?this.renderRemindersHelp():void 0,onClickRight:this.props.onDismiss,header:m}:{menuType:Z.og.Popup,maxHeight:"none",width:270,header:o},s()(L.Z,{capture:r,allowEsc:!0},void 0,s()(L.Z,{capture:!0,allowUndo:!0,allowEsc:!0},void 0,c.createElement(O.Z,p,s()(D.Z,{show:r}),s()(U.Z,{},void 0,!e.isMobile&&m,s()("div",{style:{padding:e.isMobile?"16px 14px 16px":"4px 0 4px",textAlign:"center",...e.isMobile&&{borderBottom:`1px solid ${this.theme.regularDividerColor}`,background:this.theme.popoverBackground}}},void 0,this.renderCalendar())),!i&&this.renderControls(),!i&&n&&s()(U.Z,{topBorder:!0},void 0,this.renderFormatPopup()),!i&&s()(U.Z,{topBorder:!0},void 0,this.renderClearButton()),!i&&!e.isMobile&&a&&s()(U.Z,{topBorder:!0},void 0,this.renderRemindersHelp()))))}getLocale(){return this.props.locale||this.props.intl.locale}renderStartInput(){const{device:e}=this.environment,{disabled:t}=this.props,{focus:i,inputTemporaryValue:n,error:a}=this.stores.store.state,o=this.getDateValue(),r=M.NK(o,(0,C.r)(),this.getLocale()),l=Boolean(a.startDate||a.startTime),d="datetime"===o.type||"datetimerange"===o.type,c="daterange"===o.type||"datetimerange"===o.type,u=i===A.Hv.StartDate||i===A.Hv.StartTime,m=(0,I.z4)(n.startDate)?r.start.toFormat(this.getDateDisplayFormat()):n.startDate,p=(0,I.z4)(n.startTime)?r.start.toFormat(this.getTimeDisplayFormat()):n.startTime,g=(0,I.z4)(n.startDate)?r.start.toFormat(M.Iq):n.startDate,h=(0,I.z4)(n.startTime)?r.start.toFormat(v.jK):n.startTime;return s()("div",{style:{...l?this.getInputWrapErrorStyle():u&&c?this.getInputWrapActiveStyle():this.getInputWrapInactiveStyle(),fontSize:e.isMobile?16:14}},void 0,s()(z.Z,{renderTooltip:()=>this.getInputErrorMessage(a.startDate),originGap:this.tooltipOriginGap,forceVisibleState:Boolean(a.startDate),placement:z.Z.Placement.Left,render:()=>e.isMobile?s()(N.Z,{type:"date",format:N.B.Transparent,value:g,onChange:this.handleInputChange,onFocus:this.handleStartInputDateFocus,onBlur:this.handleInputBlur,onSubmit:this.handleInputSubmit,disabled:t,size:1}):s()(N.Z,{selectAll:!0,format:N.B.Transparent,value:m,focusInitial:i===A.Hv.StartDate,onChange:this.handleInputChange,onFocus:this.handleStartInputDateFocus,onBlur:this.handleInputBlur,onSubmit:this.handleInputSubmit,disabled:t,size:1})}),d&&this.getInputSeparator(),d&&s()(z.Z,{renderTooltip:()=>this.getInputErrorMessage(a.startTime),originGap:this.tooltipOriginGap,forceVisibleState:Boolean(a.startTime),placement:z.Z.Placement.Right,render:()=>e.isMobile?s()(N.Z,{type:"time",format:N.B.Transparent,value:h,onChange:this.handleInputChange,onFocus:this.handleStartInputTimeFocus,onBlur:this.handleInputBlur,onSubmit:this.handleInputSubmit,size:1,disabled:t}):s()(N.Z,{format:N.B.Transparent,value:p,focusInitial:i===A.Hv.StartTime,onChange:this.handleInputChange,onFocus:this.handleStartInputTimeFocus,onBlur:this.handleInputBlur,onSubmit:this.handleInputSubmit,size:1,disabled:t})}))}renderEndInput(){const{device:e}=this.environment,{disabled:t}=this.props,i=this.getDateValue(),n=M.NK(i,(0,C.r)(),this.getLocale()),a="datetime"===i.type||"datetimerange"===i.type;if(n.end){const{focus:i,error:o,inputTemporaryValue:r}=this.stores.store.state,l=Boolean(o.endDate||o.endTime),d=i===A.Hv.EndDate||i===A.Hv.EndTime,c=(0,I.z4)(r.endDate)?n.end.toFormat(this.getDateDisplayFormat()):r.endDate,u=(0,I.z4)(r.endTime)?n.end.toFormat(this.getTimeDisplayFormat()):r.endTime,m=(0,I.z4)(r.endDate)?n.end.toFormat(M.Iq):r.endDate,p=(0,I.z4)(r.endTime)?n.end.toFormat(v.jK):r.endTime,g=this.getDateRangeBounds(),h=g&&g.earliestValidEnd;return s()("div",{style:{...l?this.getInputWrapErrorStyle():d?this.getInputWrapActiveStyle():this.getInputWrapInactiveStyle(),fontSize:e.isMobile?16:14}},void 0,s()(z.Z,{renderTooltip:()=>this.getInputErrorMessage(o.endDate),originGap:this.tooltipOriginGap,forceVisibleState:Boolean(o.endDate),placement:z.Z.Placement.Left,render:()=>e.isMobile?s()(N.Z,{type:"date",format:N.B.Transparent,value:m,onChange:this.handleInputChange,onFocus:this.handleEndInputDateFocus,onBlur:this.handleInputBlur,onSubmit:this.handleInputSubmit,size:1,disabled:t,inputElementAttributes:{min:h}}):s()(N.Z,{format:N.B.Transparent,value:c,focusInitial:i===A.Hv.EndDate,onChange:this.handleInputChange,onFocus:this.handleEndInputDateFocus,onBlur:this.handleInputBlur,onSubmit:this.handleInputSubmit,size:1,disabled:t})}),a&&this.getInputSeparator(),a&&s()(z.Z,{renderTooltip:()=>this.getInputErrorMessage(o.endTime),originGap:this.tooltipOriginGap,forceVisibleState:Boolean(o.endTime),placement:z.Z.Placement.Right,render:()=>e.isMobile?s()(N.Z,{type:"time",format:N.B.Transparent,value:p,onChange:this.handleInputChange,onFocus:this.handleEndInputTimeFocus,onBlur:this.handleInputBlur,onSubmit:this.handleInputSubmit,size:1,disabled:t}):s()(N.Z,{format:N.B.Transparent,value:u,focusInitial:i===A.Hv.EndTime,onChange:this.handleInputChange,onFocus:this.handleEndInputTimeFocus,onBlur:this.handleInputBlur,onSubmit:this.handleInputSubmit,size:1,disabled:t})}))}}renderTimeZone(){const{device:e}=this.environment,{intl:t}=this.props,i=this.getDateValue();if(("datetime"===i.type||"datetimerange"===i.type)&&i.time_zone!==(0,C.r)())return s()(G.Z,{isSmall:!0,isMobile:e.isMobile,style:{marginTop:8}},void 0,(0,h.E)(t)[i.time_zone])}renderCalendar(){const{firstDayOfWeek:e}=this.props,t=this.getDateValueForceCurrentTimeZone(),i=M.NK(t,(0,C.r)()),n=this.stores.store.state.currentMonth||i.start,{focus:a}=this.stores.store.state;if(i.end){const t=i.start.toJSDate(),o=i.end.toJSDate(),r=a===A.Hv.StartDate||a===A.Hv.StartTime;return s()(F.LazyDayPicker,{className:"notion-date-property-menu notranslate",weekStartsOn:e,numberOfMonths:1,defaultMonth:n.toJSDate(),month:n.toJSDate(),locale:m.SP,modifiers:{range:{from:t,to:o},...r?{end:o,start:t}:{start:t,end:o}},modifiersStyles:{range:Q.dayPickerRangeDayStyle,start:r?this.getDayPickerActiveDayStyle():this.getDayPickerInactiveDayStyle(),end:r?this.getDayPickerInactiveDayStyle():this.getDayPickerActiveDayStyle()},showOutsideDays:!0,fixedWeeks:!0,onDayClick:this.handleDayPickerDayClick,onMonthSelected:this.handleDayPickerMonthChange})}{const t=i.start.toJSDate();return s()(F.LazyDayPicker,{className:"notion-date-property-menu notranslate",numberOfMonths:1,weekStartsOn:e,defaultMonth:n.toJSDate(),month:n.toJSDate(),locale:m.SP,selected:[t],modifiers:{start:t},modifiersStyles:{start:this.getDayPickerActiveDayStyle()},showOutsideDays:!0,fixedWeeks:!0,onDayClick:this.handleDayPickerDayClick,onMonthSelected:this.handleDayPickerMonthChange})}}renderControls(){const{device:e}=this.environment,{shouldShowReminder:t}=this.props;return e.isMobile?s()(U.Z,{topBorder:!0},void 0,t&&this.renderReminderControl(),this.renderEndDateControl(),this.renderAllDayControl()):s()(c.Fragment,{},void 0,t&&s()(U.Z,{topBorder:!0},void 0,this.renderReminderControl()),s()(U.Z,{topBorder:!0},void 0,this.renderEndDateControl(),this.renderAllDayControl()))}renderEndDateControl(){const e=this.getDateValue();return s()(E.Z,{focused:!1,onClick:this.handleEndDateControlChange,title:s()(f.FormattedMessage,{defaultMessage:"End date",id:"LuxonDatePropertyMenu.menuItem.endDate.label"}),right:s()(K.Z,{on:"daterange"===e.type||"datetimerange"===e.type,onClick:this.handleEndDateControlChange})})}renderAllDayControl(){const e=this.getDateValue();return s()(E.Z,{focused:!1,onClick:this.handleAllDayChange,title:s()(f.FormattedMessage,{defaultMessage:"Include time",id:"LuxonDatePropertyMenu.menuItem.includeTime.label"}),right:s()(K.Z,{on:"date"!==e.type&&"daterange"!==e.type,onClick:this.handleAllDayChange})})}renderReminderControl(){const{device:e}=this.environment,{intl:t}=this.props,i=this.getDateValue();return s()(B.ZP,{popupType:e.isMobile?B.Z4.SlideUp:B.Z4.Popup,placementToOrigin:B.pO.Right,renderOrigin:n=>c.createElement(R.Z,a()({},n,{icon:k.Z.alarmClock({width:14}),title:s()(f.FormattedMessage,{defaultMessage:"Remind",id:"LuxonDatePropertyMenu.menuItem.remind.label"}),focused:!1,showExtensionArrow:e.isMobile,right:S({reminder:i.reminder,intl:t,formatTime:b.mr})})),render:n=>{let o;o=e.isMobile?{menuType:Z.og.Modal,title:s()(f.FormattedMessage,{defaultMessage:"Remind",id:"LuxonDatePropertyMenu.mobileRemindModal.title"}),right:s()(f.FormattedMessage,{defaultMessage:"Done",id:"LuxonDatePropertyMenu.mobileDoneReminderButton.label"}),onClickRight:n.close}:{menuType:Z.og.Popup,width:250};const r=("date"===i.type||"daterange"===i.type?v.PI:v.dG).map((e=>{const i=S({reminder:e,shouldShowTime:!0,intl:t,formatTime:b.mr});return{key:i,action:t=>{this.handleChangeReminder(e),n.close()},render:(e,t)=>c.createElement(E.Z,a()({},e,{title:i}))}}));return c.createElement(O.Z,o,s()(V.Z,{type:V.i.Vertical,sections:[{key:"reminder section",render:e=>c.createElement(U.Z,e),items:r}],initialFocus:void 0}))}})}renderFormatPopup(){const{device:e}=this.environment;return s()(B.ZP,{popupType:e.isMobile?B.Z4.SlideUp:B.Z4.Popup,placementToOrigin:B.pO.Right,renderOrigin:t=>c.createElement(E.Z,a()({},t,{icon:k.Z.sidebarSettings({width:14}),title:s()(f.FormattedMessage,{defaultMessage:"Date format & timezone",id:"LuxonDatePropertyMenu.menuItem.formatAndTimezone.label"}),focused:!1,showExtensionArrow:e.isMobile})),render:t=>{let i;return i=e.isMobile?{menuType:Z.og.Modal,title:s()(f.FormattedMessage,{defaultMessage:"Date format",id:"LuxonDatePropertyMenu.mobileDateFormatModal.title"}),right:s()(f.FormattedMessage,{defaultMessage:"Done",id:"LuxonDatePropertyMenu.mobileDoneButton.label"}),onClickRight:t.close}:{menuType:Z.og.Popup,width:250},c.createElement(O.Z,i,s()(U.Z,{},void 0,this.renderDateFormatControl(),this.showTimeFormatControl()&&this.renderTimeFormatControl(),this.renderTimeZoneControl()))}})}renderDateFormatControl(){const e=this.props.dateFormat||v.sF,{intl:t}=this.props,i={menuTitle:t.formatMessage({defaultMessage:"Date format",id:"LuxonDatePropertyMenu.dateFormatDropdownButton.label"}),items:v.Zy,getKey:e=>e,selectedItem:e,onSelect:this.handleDateFormatChange,renderItem:e=>c.createElement(E.Z,a()({},e,{title:t.formatMessage(v.fy[e.value])})),renderOrigin:i=>c.createElement(R.Z,a()({focused:!1,title:s()(f.FormattedMessage,{defaultMessage:"Date format",id:"LuxonDatePropertyMenu.menuItem.format.label"}),right:e?t.formatMessage(v.fy[e]):s()(f.FormattedMessage,{defaultMessage:"Empty",id:"LuxonDatePropertyMenu.formatMenu.emptyButton.label"})},i))};return c.createElement(W.Z,i)}renderTimeFormatControl(){const e=this.getDateValue(),t="date"===e.type||"daterange"===e.type,i=this.getTimeDisplayFormat(),{intl:n}=this.props,o=this.getSelectedTimeFormatType(),r={menuTitle:n.formatMessage({defaultMessage:"Time format",id:"LuxonDatePropertyMenu.timeFormatMenu.title"}),items:v.L7,getKey:e=>e,selectedItem:o,onSelect:this.handleTimeFormatChange,renderItem:e=>c.createElement(E.Z,a()({},e,{title:n.formatMessage(v.Fi[e.value])})),disabled:t,renderOrigin:e=>c.createElement(R.Z,a()({focused:!1,title:s()(f.FormattedMessage,{defaultMessage:"Time format",id:"LuxonDatePropertyMenu.menuItem.timeFormat.label"}),disabled:t,right:!t&&(i?n.formatMessage(v.Fi[o]):s()(f.FormattedMessage,{defaultMessage:"Empty",id:"LuxonDatePropertyMenu.timeFormatMenu.emptyButton.label"}))},e))};return c.createElement(W.Z,r)}renderTimeZoneControl(){const e=this.getDateValue(),t="date"===e.type||"daterange"===e.type,i=this.getTimeZone();return s()(j.Z,{renderOrigin:e=>c.createElement(R.Z,a()({},e,{focused:!1,title:s()(f.FormattedMessage,{defaultMessage:"Timezone",id:"datePropertyMenu.menuItem.time.label"}),disabled:t,right:!t&&M.er(i)})),onSelect:e=>this.handleTimeZoneChange(e)})}renderClearButton(){return s()(E.Z,{focused:!1,onClick:this.handleClearClick,title:s()(f.FormattedMessage,{defaultMessage:"Clear",id:"LuxonDatePropertyMenu.clearButton.label"})})}renderRemindersHelp(){const{device:e}=this.environment;return e.isMobile?s()(H.Z,{href:(0,x.UY)("guides.reminders"),analyticsFrom:"date_selector"}):s()(q.Z,{title:s()(f.FormattedMessage,{defaultMessage:"Learn about reminders",id:"LuxonDatePropertyMenu.learnMore.helpButton.label"}),href:(0,x.UY)("guides.reminders"),analyticsFrom:"date_selector"})}enableEndDate(e){const{dateValue:t,endDate:i,endTime:n}=e;if("datetime"===t.type){var a,o;const e={type:"datetimerange",start_date:t.start_date,start_time:t.start_time,end_date:i||t.start_date,end_time:n||t.start_time,time_zone:t.time_zone,reminder:t.reminder};null===(a=(o=this.props).onChangeValue)||void 0===a||a.call(o,e),this.stores.store.setState({...this.stores.store.state,focus:A.Hv.EndDate})}else if("date"===t.type){var s,r;const e={type:"daterange",start_date:t.start_date,end_date:i||t.start_date,reminder:t.reminder};null===(s=(r=this.props).onChangeValue)||void 0===s||s.call(r,e),this.stores.store.setState({...this.stores.store.state,focus:A.Hv.EndDate})}else(0,T.t1)(t)}getDateValue(){const{value:e}=this.props;return e&&!l().isNaN(e)?e:this.openTimeFormat}getDateRangeBounds(){const e=this.getDateValue();if(v.h(e)||v.qg(e)){const t=M.NK(e,(0,C.r)());return{earliestValidEnd:t.start.toFormat(M.Iq),latestValidStart:t.end.toFormat(M.Iq)}}}getDateValueForceCurrentTimeZone(){const{value:e}=this.props;return e&&!l().isNaN(e)?"datetime"===e.type||"datetimerange"===e.type?{...e,time_zone:(0,C.r)()}:e:this.openTimeFormat}getDateDisplayFormat(){const{dateFormat:e}=this.props;return void 0===e||"relative"===e||"ll"===e?v.oq(this.getLocale()):v.jG(e)}getTimeDisplayFormat(){const{timeFormat:e}=this.props;return e?v._F(e):v.Sc}showTimeFormatControl(){return!_.S.includes(m.SP)}getTimeZone(){const e=this.getDateValue();return"datetime"===e.type||"datetimerange"===e.type?e.time_zone:(0,C.r)()}parseInputDateValue(e){const{intl:t}=this.props;return this.environment.device.isMobile?(0,w.parseDateValueWithInputFormat)(e,M.Iq,t):(0,w.parseDateValueWithInputFormat)(e,this.getDateDisplayFormat(),t)}parseInputTimeValue(e){return(0,w.parseTimeValueWithInputFormat)(e,this.getTimeDisplayFormat(),this.props.intl)}applyValidDateState(e){var t,i;const{newDate:n,currentMonth:a,resetField:o}=e;null===(t=(i=this.props).onChangeValue)||void 0===t||t.call(i,n),this.stores.store.setState({...this.stores.store.state,currentMonth:a}),this.resetInputState(o)}resetInputState(e){const{state:t}=this.stores.store;this.stores.store.setState({...t,error:{...t.error,[t.focus]:void 0},inputTemporaryValue:{...t.inputTemporaryValue,[t.focus]:void 0}})}getInputErrorMessage(e){const{intl:t}=this.props;switch(e){case A.pd.InvalidDate:return t.formatMessage({id:"LuxonDatePropertyMenu.invalidDateError.tooltip",defaultMessage:"Invalid date"});case A.pd.InvalidRange:return t.formatMessage({id:"LuxonDatePropertyMenu.invalidDateOrTimeRangeError.tooltip",defaultMessage:"Invalid range"});case A.pd.InvalidTime:return t.formatMessage({id:"LuxonDatePropertyMenu.invalidTimeError.tooltip",defaultMessage:"Invalid time"});default:return}}getInputSeparator(){return s()("div",{style:{height:14,width:1,background:this.theme.regularDividerColor,marginLeft:6,marginRight:12,flexShrink:0}})}getInputWrapStyle(){return{display:"flex",alignItems:"center",borderRadius:3,height:28,lineHeight:1.2,background:this.theme.inputBackground,paddingLeft:8,paddingRight:8,flexBasis:"50%"}}getInputWrapInactiveStyle(){return{...this.getInputWrapStyle(),boxShadow:this.theme.inputBoxShadow,flexGrow:1}}getInputWrapErrorStyle(){return{...this.getInputWrapStyle(),boxShadow:`inset 0 0 0 2px ${g.ZP.red}`,background:g.ZP.redWithAlpha(.15),flexGrow:1}}getInputWrapActiveStyle(){return{...this.getInputWrapStyle(),boxShadow:`inset 0 0 0 2px ${g.ZP.blue}`,background:g.ZP.blueWithAlpha(.15),flexGrow:1}}getDayPickerActiveDayStyle(){return{backgroundColor:g.ZP.blue,color:g.ZP.white}}getDayPickerInactiveDayStyle(){return{backgroundColor:g.ZP.blueWithAlpha(.43)}}}Q.displayName="DatePropertyMenu",Q.dayPickerRangeDayStyle={backgroundColor:g.ZP.blueWithAlpha(.15)};const Y=(0,f.injectIntl)(Q)},13992:(e,t,i)=>{i.r(t),i.d(t,{default:()=>J});var n=i(10434),a=i.n(n),o=i(23174),s=i.n(o),r=i(96486),l=i.n(r),d=i(67294),c=i(83355),u=i(41892),m=i(43593),p=i(32056),g=i(98459),h=i(90468),f=i(5366),v=i(70630),y=i(1865),S=i(10161);var b=i(33929),M=i(87279),w=i(98742),C=i(61766),_=i(88632),k=i(71071),T=i(42922),I=i(52275),P=i(1743),Z=i(74194),x=i(78140),F=i(32163),A=i(89728),E=i(72495),B=i(20223),D=i(24006),R=i(24405),L=i(64369);const N=e=>{let{title:t,subtitle:i,on:n,onChange:a,disabled:o,style:r}=e;window.__c={n:"SwitcherRow"};const l=(0,R.yK)((()=>({container:{display:"flex",alignItems:"center",width:"100%"},title:{fontSize:14,marginRight:8,flexGrow:1}})),[]);return s()("div",{style:{...l.container,...r}},void 0,s()("div",{style:l.title},void 0,t,s()(L.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"95%"}},void 0,i)),s()(D.Z,{on:n,disabled:o,onClick:a}))};N.defaultProps={disabled:!1,style:{}};const O=N;var V=i(33411),U=i(58032),W=i(92660),K=i(6202),z=i(60442),G=i(42115);const q=["pdf","html","markdown"],H=["currentView","all"],j=e=>e>.1&&e<2,Q=["everything","no_files"],Y=(0,f.defineMessages)({dialogLabel:{id:"exportModal.dialogLabel",defaultMessage:"Export"}});class $ extends c.Z{constructor(){super(...arguments),this.storeTypes={includeContentsPopupStore:C.Z,exportTypePopupStore:C.Z,pdfFormatPopupStore:C.Z,collectionViewExportTypePopupStore:C.Z},this.renderMenu=()=>{const{device:e}=this.environment;if(!_.Z.state.online)return this.renderOffline();const t=k.ZP.state;return t.open&&e.isMobile?this.renderMobileModal(t):t.open?this.renderDesktopModal(t):void 0},this.handleSelectExportType=(e,t)=>{const i=k.ZP.state;if(!i.open)return;const{exportOptions:n}=i;if(e===n.exportType)return;let a;a="pdf"===e?{...n,exportType:"pdf",pdfFormat:v.GI(t)}:{...n,exportType:e},v.BO(this.environment,{...i,exportOptions:a})},this.handleSelectPaperFormat=e=>{const t=k.ZP.state;t.open&&k.Sw(t)&&v.BO(this.environment,{...t,exportOptions:{...t.exportOptions,pdfFormat:e}})},this.handleSelectIncludeContents=e=>{const t=k.ZP.state;t.open&&v.BO(this.environment,{...t,exportOptions:{...t.exportOptions,includeContents:e}})},this.handleSelectCollectionExportType=e=>{const t=k.ZP.state;t.open&&v.BO(this.environment,{...t,exportOptions:{...t.exportOptions,collectionViewExportType:e}})},this.handleToggleFlattenExportFiletree=()=>{const e=k.ZP.state;e.open&&v.BO(this.environment,{...e,exportOptions:{...e.exportOptions,flattenExportFiletree:!e.exportOptions.flattenExportFiletree}})},this.handleToggleRecursive=()=>{const e=k.ZP.state;if(e.open){if(k.Sw(e)&&!v.y1(this.environment))return y.y(this.environment,{from:"export_modal",for:"enterprise"}),void this.handleUpgrade();v.BO(this.environment,{...e,recursive:!e.recursive})}},this.handleSetScalePercent=e=>{const t=k.ZP.state;t.open&&k.Sw(t)&&v.BO(this.environment,{...t,exportOptions:{...t.exportOptions,scale:e}})},this.handleCancel=()=>{v.Qr()},this.handleSubmit=()=>{if(!this.canSubmit())return;const e=k.ZP.state;e.open&&(v.Qr(),e.root.table===h.bx?v.AW(this.environment,{spaceId:e.root.id,exportOptions:e.exportOptions}):v.ZO(this.environment,{block:{id:e.root.id,spaceId:(0,g.CG)(e.root.spaceId)},recursive:e.recursive,exportOptions:e.exportOptions}))},this.handleUpgrade=()=>{v.Qr()}}renderComponent(){return s()(W.Z,{ariaLabel:b.default.formatMessage(Y.dialogLabel),onDismiss:this.handleCancel,render:this.renderMenu,requireOnline:!0,modalStore:k.ZP})}renderOffline(){return s()("div",{style:this.getOfflineStyle()},void 0,s()(f.FormattedMessage,{defaultMessage:"Please go online to export.",id:"exportModal.offlineMessage.description"}))}renderMobileModal(e){const t={menuType:M.og.Modal,title:s()(f.FormattedMessage,{id:"exportModal.title",defaultMessage:"Export"}),right:s()(f.FormattedMessage,{id:"exportModal.closeButton.label",defaultMessage:"Close"}),onClickRight:this.handleCancel};return d.createElement(x.Z,t,s()(F.Z,{type:F.i.Vertical,initialFocus:void 0,sections:[{key:"exportOptions",render:e=>d.createElement(E.Z,e),items:this.getMobileExportOptionsMenuItems(e)},{key:"actions",render:e=>{let{children:t,...i}=e;return d.createElement(E.Z,a()({isSubmitButton:!0},i),t)},items:[{key:"submit",render:e=>{const{onClick:t,...i}=e;return d.createElement(K.Z,a()({},i,{onClick:t||this.handleSubmit,disabled:!this.canSubmit(),title:s()(f.FormattedMessage,{id:"exportModal.exportButton.label",defaultMessage:"Export"})}))},action:this.handleSubmit}]}]}))}renderDesktopModal(e){const{device:t,currentUser:i}=this.environment,n=k.Sw(e)&&!v.y1(this.environment)&&"business",o=this.environment.device.isWindows;return s()("div",{style:this.getModalWrapStyle()},void 0,s()(B.Z,{isMenuItem:t.isMobile,buttonPopupStore:this.stores.exportTypePopupStore,label:s()(f.FormattedMessage,{id:"exportModal.exportFormat.description",defaultMessage:"Export format"}),selectedTitle:this.getBlockExportTypeTitle(e.exportOptions.exportType),renderMenuSections:e=>[{key:"exportType",render:e=>d.createElement(E.Z,e),items:q.map((t=>this.getBlockExportTypeMenuListItem(t,e,i.id)))}]}),e.exportOptions.collectionViewExportType&&s()(B.Z,{isMenuItem:t.isMobile,buttonPopupStore:this.stores.collectionViewExportTypePopupStore,label:s()(f.FormattedMessage,{id:"exportModal.includeDatabases.description",defaultMessage:"Include databases"}),selectedTitle:this.getCollectionViewExportTypeTitle(e.exportOptions.collectionViewExportType||"currentView"),renderMenuSections:e=>[{key:"exportCollection",render:e=>d.createElement(E.Z,e),items:H.map((t=>this.getCollectionViewExportTypeMenuListItem(t,e)))}]}),s()(B.Z,{isMenuItem:t.isMobile,buttonPopupStore:this.stores.includeContentsPopupStore,label:s()(f.FormattedMessage,{id:"exportModal.includeContents.description",defaultMessage:"Include content"}),selectedTitle:this.getBlockIncludeContentsTitle(e.exportOptions.includeContents||"everything"),renderMenuSections:e=>[{key:"includeContents",render:e=>d.createElement(E.Z,e),items:Q.map((t=>this.getIncludeContentsMenuListItem(t,e)))}]}),k.Sw(e)&&d.createElement(d.Fragment,null,s()(B.Z,{isMenuItem:t.isMobile,buttonPopupStore:this.stores.pdfFormatPopupStore,label:s()(f.FormattedMessage,{id:"exportModal.pageFormat.description",defaultMessage:"Page format"}),selectedTitle:this.getPDFFormatTitle(e.exportOptions.pdfFormat),renderMenuSections:e=>[{key:"isoPaperFormats",render:e=>d.createElement(E.Z,e),items:m.lJ.map((t=>this.getPaperFormatMenuListItem(t,e)))},{key:"otherPaperFormats",render:e=>d.createElement(E.Z,a()({topBorder:!0},e)),items:m.bY.map((t=>this.getPaperFormatMenuListItem(t,e)))}]}),this.renderScalePercent()),"space"!==e.root.table&&s()(G.Z,{requireUpgradeToTier:n,analyticsName:"export_modal",onClick:this.handleToggleRecursive,render:(t,i)=>d.createElement("div",a()({},t,{style:{display:"flex",alignItems:"center",height:32}}),s()("div",{style:{display:"flex",alignItems:"center",marginRight:"auto",color:this.theme.lightTextColor,fontSize:14}},void 0,s()(f.FormattedMessage,{defaultMessage:"Include subpages",id:"exportModal.includeSubpages.label"})," ",i&&s()("div",{style:{marginLeft:8}},void 0,i)),s()(D.Z,{on:e.recursive,disabled:Boolean(n)})),renderUpgradeTooltip:()=>s()(z.Z,{imageURL:u.Z.images.tooltips.upsells.exportPdfSubpagesPng,imageWidth:240,imageHeight:100,title:s()(f.FormattedMessage,{defaultMessage:"Upgrade to include subpages in PDF exports",id:"exportModal.pdfSubpageUpgradeTooltip.title"}),caption:s()(f.FormattedMessage,{defaultMessage:"Creates a zip file containing all the pages nested inside the current page as PDF files.",id:"exportModal.pdfSubpageUpgradeTooltip.caption"})}),tooltipPlacement:U.Z.Placement.Left,upgradeButtonDesktopStyle:{marginTop:2},onUpgradeClick:this.handleUpgrade}),s()(O,{title:s()(f.FormattedMessage,{id:"exportModal.flattenExportFiletree.description",defaultMessage:"Create folders for subpages"}),subtitle:"",style:{color:this.theme.lightTextColor,fontSize:14,display:"flex",alignItems:"center",marginRight:"auto",height:32},on:void 0===e.exportOptions.flattenExportFiletree?!o:!e.exportOptions.flattenExportFiletree,disabled:!e.recursive,onChange:()=>this.handleToggleFlattenExportFiletree()}),s()("div",{style:{display:"flex",alignItems:"center",marginTop:16}},void 0,s()(A.Z,{isGray:!0,style:{marginLeft:"auto",marginRight:8},onClick:this.handleCancel},void 0,s()(f.FormattedMessage,{defaultMessage:"Cancel",id:"exportModal.cancelButton.label"})),s()(T.Z,{onClick:this.handleSubmit,disabled:!this.canSubmit()},void 0,s()(f.FormattedMessage,{defaultMessage:"Export",id:"exportModal.exportButton.label"}))))}renderScalePercent(){const e=this.getScalePercent();return d.createElement(d.Fragment,null,s()("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",height:32}},void 0,s()(L.Z,{style:{color:this.theme.lightTextColor}},void 0,s()(f.FormattedMessage,{id:"exportModal.pageScale.description",defaultMessage:"Scale percent"})),s()(X,{value:e,onChange:this.handleSetScalePercent})),!j(e)&&s()(V.Z,{show:!0,showDelay:500,showHold:100,render:e=>e&&s()("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",minHeight:32,padding:"4px 0"}},void 0,s()(L.Z,{isSmall:!0,isMultiline:!0,style:{color:this.theme.errorText}},void 0,s()(f.FormattedMessage,{id:"exportModal.pageScale.invalidScaleError",defaultMessage:"Scale percent must be a number between 10 and 200"})))}))}getMobileExportOptionsMenuItems(e){const{currentUser:t,device:i}=this.environment;return l().compact([{key:"export type",render:n=>d.createElement(B.Z,a()({},n,{isMenuItem:i.isMobile,buttonPopupStore:this.stores.exportTypePopupStore,label:s()(f.FormattedMessage,{defaultMessage:"Export format",id:"exportModal.exportFormat.description"}),selectedTitle:this.getBlockExportTypeTitle(e.exportOptions.exportType),renderMenuSections:e=>[{key:"exportType",render:e=>d.createElement(E.Z,e),items:q.map((i=>this.getBlockExportTypeMenuListItem(i,e,t.id)))}]})),action:()=>{this.stores.exportTypePopupStore.setState({open:!0})}},k.Sw(e)&&{key:"pdf format",render:t=>d.createElement(B.Z,a()({},t,{isMenuItem:i.isMobile,buttonPopupStore:this.stores.pdfFormatPopupStore,label:s()(f.FormattedMessage,{defaultMessage:"Page format",id:"exportModal.pageFormat.description"}),selectedTitle:this.getPDFFormatTitle(e.exportOptions.pdfFormat),renderMenuSections:e=>[{key:"isoPaperFormats",render:e=>d.createElement(E.Z,e),items:m.lJ.map((t=>this.getPaperFormatMenuListItem(t,e)))},{key:"otherPaperFormats",render:e=>d.createElement(E.Z,a()({topBorder:!0},e)),items:m.bY.map((t=>this.getPaperFormatMenuListItem(t,e)))}]})),action:()=>{this.stores.pdfFormatPopupStore.setState({open:!0})}},"space"!==e.root.table&&{key:"recursive",render:t=>{let{onClick:i,key:n,...o}=t;const r=k.Sw(e)&&!v.y1(this.environment)&&"business";return s()(G.Z,{requireUpgradeToTier:r,analyticsName:"export_modal",onClick:i,render:(t,i)=>{const n=(0,w.Z)(o,t);return d.createElement(I.Z,a()({},n,{title:s()("div",{style:{display:"flex",alignItems:"center"}},void 0,s()(f.FormattedMessage,{defaultMessage:"Include subpages",id:"exportModal.includeSubpages.label"})," ",i&&s()("div",{style:{marginLeft:8}},void 0,i)),right:d.createElement(D.Z,a()({},n,{on:e.recursive,disabled:Boolean(r)}))}))},renderUpgradeTooltip:()=>s()(z.Z,{imageURL:u.Z.images.tooltips.upsells.exportPdfSubpagesPng,imageWidth:240,imageHeight:100,title:s()(f.FormattedMessage,{defaultMessage:"Upgrade to include subpages in PDF exports",id:"exportModal.pdfSubpageUpgradeTooltip.title"}),caption:s()(f.FormattedMessage,{defaultMessage:"Creates a zip file containing all the pages nested inside the current page as PDF files.",id:"exportModal.pdfSubpageUpgradeTooltip.caption"})}),tooltipPlacement:U.Z.Placement.Left,upgradeButtonDesktopStyle:{marginTop:2},onUpgradeClick:this.handleUpgrade},n)},action:this.handleToggleRecursive}])}getBlockExportTypeTitle(e){switch(e){case"pdf":return s()(f.FormattedMessage,{id:"exportModal.exportFormatButton.pdf.label",defaultMessage:"PDF"});case"markdown":return s()(f.FormattedMessage,{id:"exportModal.exportFormatButton.markdownAndCSV.label",defaultMessage:"Markdown & CSV"});case"html":return s()(f.FormattedMessage,{id:"exportModal.exportFormatButton.html.label",defaultMessage:"HTML"})}}getBlockIncludeContentsTitle(e){switch(e){case"everything":return s()(f.FormattedMessage,{id:"exportModal.includeContentTypes.everything.label",defaultMessage:"Everything"});case"no_files":return s()(f.FormattedMessage,{id:"exportModal.includeContentTypes.no_files.label",defaultMessage:"No files or images"})}}getCollectionViewExportTypeTitle(e){switch(e){case"all":return S.default.checkGate("export_collections_v1")?s()(f.FormattedMessage,{id:"exportModal.includeDatabases.all.label.defaultView",defaultMessage:"Default View"}):s()(f.FormattedMessage,{id:"exportModal.includeDatabases.all.label.everything",defaultMessage:"Everything"});case"currentView":return s()(f.FormattedMessage,{id:"exportModal.includeDatabases.currentView.label",defaultMessage:"Current view"})}}getPDFFormatTitle(e){switch(e){case"Letter":return s()(f.FormattedMessage,{id:"exportModal.pageFormatButton.letter.label",defaultMessage:"Letter"});case"A3":return s()(f.FormattedMessage,{id:"exportModal.pageFormatButton.a3.label",defaultMessage:"A3"});case"A4":return s()(f.FormattedMessage,{id:"exportModal.pageFormatButton.a4.label",defaultMessage:"A4"});case"Legal":return s()(f.FormattedMessage,{id:"exportModal.pageFormatButton.legal.label",defaultMessage:"Legal"});case"Tabloid":return s()(f.FormattedMessage,{id:"exportModal.pageFormatButton.tabloid.label",defaultMessage:"Tabloid"})}}getBlockExportTypeMenuListItem(e,t,i){const n=k.ZP.state,o=n.open&&"pdf"===e&&"space"===n.root.table&&!v.y1(this.environment)&&"business";return{key:e,action:()=>{if(t.close(),o)return y.y(this.environment,{from:"export_modal",for:o}),void this.handleUpgrade();this.handleSelectExportType(e,i)},render:i=>{let{onClick:n,key:r,...l}=i;return s()(G.Z,{requireUpgradeToTier:o,analyticsName:"export_modal",onClick:n,onUpgradeClick:()=>{t.close(),this.handleUpgrade()},render:(t,i)=>d.createElement(I.Z,a()({},(0,w.Z)(l,t),{title:this.getBlockExportTypeTitle(e),right:i})),renderUpgradeTooltip:()=>s()(z.Z,{imageURL:u.Z.images.tooltips.upsells.exportPdfSubpagesPng,imageWidth:240,imageHeight:100,title:s()(f.FormattedMessage,{defaultMessage:"Upgrade to export the workspace as PDFs",id:"exportModal.workspacePdfUpgradeTooltip.title"}),caption:s()(f.FormattedMessage,{defaultMessage:"Creates a zip file containing all pages in the workspace as PDF files.",id:"exportModal.workspacePdfUpgradeTooltip.caption"})}),tooltipPlacement:U.Z.Placement.Left,upgradeButtonDesktopStyle:{marginTop:2}},r)}}}getIncludeContentsMenuListItem(e,t){return{key:e,action:()=>{t.close(),this.handleSelectIncludeContents(e)},render:t=>d.createElement(I.Z,a()({},t,{title:this.getBlockIncludeContentsTitle(e)}))}}getCollectionViewExportTypeMenuListItem(e,t){return{key:e,action:()=>{t.close(),this.handleSelectCollectionExportType(e)},render:t=>d.createElement(I.Z,a()({},t,{title:this.getCollectionViewExportTypeTitle(e)}))}}getPaperFormatMenuListItem(e,t){return{key:e,action:()=>{t.close(),this.handleSelectPaperFormat(e)},render:t=>d.createElement(I.Z,a()({},t,{title:this.getPDFFormatTitle(e)}))}}getScalePercent(){const e=k.ZP.state;return e.open&&k.Sw(e)?void 0===e.exportOptions.scale?1:e.exportOptions.scale:1}canSubmit(){return j(this.getScalePercent())}getModalWrapStyle(){return{width:320,padding:24,fontSize:14}}getOfflineStyle(){return{...this.getModalWrapStyle(),color:this.theme.mediumTextColor}}}function X(e){let{value:t,onChange:i}=e;window.__c={n:"PercentInput"};const n=(0,f.useIntl)(),a=d.useCallback((e=>{const t=e.target.value,n=(0,p._g)(t)||(0,p.p3)(t);let a;"object"==typeof n?a="percent"===n.format?n.value:n.value/100:"number"==typeof n&&(a=n/100),void 0!==a&&i(a)}),[i]),[o,r]=d.useState(!1),l=d.useMemo((()=>(0,p.uf)(Math.round(100*t),"number",n)),[t,n]);return s()(P.Z,{capture:o},void 0,s()(Z.Z,{value:l,onChange:a,onFocus:()=>r(!0),onBlur:()=>r(!1),style:{width:60},inputStyle:{textAlign:"right"}}))}$.displayName="ExportModal";const J=$},79027:(e,t,i)=>{i.r(t),i.d(t,{default:()=>y});var n=i(23174),a=i.n(n),o=i(67294),s=i(480),r=i(81954),l=i(24405),d=i(41892),c=i(82990),u=i(5366),m=i(91376),p=i(17311),g=i(7844),h=i(42922),f=i(53953),v=i(62385);function y(){window.__c={n:"GoogleAuthPromptModal"};const e=(0,s.Fy)(),t=(0,r.VK)((()=>g.Z.state.open),[]),i=()=>{g.Z.state.open&&g.Z.state.onDecline&&g.Z.state.onDecline(),g.Z.setState({open:!1})},n=()=>{g.Z.state.open&&g.Z.state.onConfirm(),g.Z.setState({open:!1})},y=()=>{i(),m.r({currentTab:"connected_apps"})},S=(0,l.yK)((e=>({wrap:{padding:"24px 36px 24px",minWidth:300,maxWidth:400},modalHeaderWrap:{textAlign:"center",marginTop:8,marginBottom:18,justifyContent:"space-between"},modalMessage:{fontSize:16,lineHeight:1.5,fontWeight:c.Z.fontWeight.medium,marginTop:15,marginBottom:20,color:e.mediumTextColor}})),[]);return a()(f.Z,{open:t,innerStyle:S.wrap,preventHideChildrenWhileOpening:!0,render:()=>a()(o.Fragment,{},void 0,a()("div",{style:S.modalHeaderWrap},void 0,a()("img",{src:d.Z.images.googleDriveLogoPng,style:{width:50,display:"inline-block"}}),a()("div",{style:S.modalMessage},void 0,a()(u.FormattedMessage,{defaultMessage:"Notion cannot access the Google Drive file you are trying to embed.",id:"googleAuthPromptModal.noAccessFile.errorMessage"})),e.isMobileNative?a()("div",{style:S.modalMessage},void 0,a()(u.FormattedMessage,{defaultMessage:"Please use Notion on desktop to connect a new account.",id:"googleAuthPromptModal.mobileUseDesktopPrompt.errorMessage"})):a()(h.Z,{isLarge:!0,onClick:n},void 0,a()(u.FormattedMessage,{defaultMessage:"Connect to Google",id:"googleAuthPromptModal.connectToGoogleButton.label"})),!e.isMobile&&a()("div",{style:{display:"block",marginTop:p.Z.vertical.tiny}},void 0,a()(v.Z,{underlined:!0,onClick:y},void 0,a()(u.FormattedMessage,{defaultMessage:"See my connected accounts",id:"googleAuthPromptModal.seeConnectedAccountsButton.label"}))))),onDismiss:i})}},24326:(e,t,i)=>{i.r(t),i.d(t,{default:()=>k});var n=i(10434),a=i.n(n),o=i(23174),s=i.n(o),r=i(67294),l=i(480),d=i(81954),c=i(24405),u=i(53397),m=i(82990),p=i(51454),g=i(5366),h=i(79315),f=i(93278);var v=i(37190),y=i(92639),S=i(10161),b=i(42922),M=i(64921),w=i(28451);const C=(0,g.defineMessages)({title:{id:"guidedTutorialPopup.title",defaultMessage:"Learn Notion in 3 steps"},subtitle:{id:"guidedTutorialPopup.subtitle",defaultMessage:"We'll show you how to quickly customize {workspacename}."},cta:{id:"guidedTutorialPopup.cta",defaultMessage:"Get started"}}),_={display:"flex",alignItems:"center",flexDirection:"column"};function k(){window.__c={n:"GuidedTutorialPopup"};const e=(0,c.Fg)(),t=(0,l.O7)(),i=(0,d.VK)((()=>h.default.state.currentUserSettingsStore),[]),n=(0,d.VK)((()=>h.default.state.guidedTutorialStore),[]),o=(0,d.VK)((()=>{var e;return null===(e=h.default.state.currentSpaceStore)||void 0===e?void 0:e.getName()}),[]),k=(0,c.yK)((e=>({container:{background:e.popoverBackground,borderRadius:5,boxShadow:e.mediumBoxShadow,position:"absolute",bottom:65,right:16,zIndex:p.hT},cancel:{position:"absolute",top:"10px",right:"10px",background:e.buttonHoveredBackground,borderRadius:"100%",width:20,height:20,display:"flex",alignItems:"center",justifyContent:"center",zIndex:10},content:{..._,width:299,height:204,overflow:"hidden",position:"relative",padding:12,cursor:"default",justifyContent:"center"},contentTextFlex:{display:"flex",flexDirection:"column",gap:8,padding:8},subtitle:{fontSize:14,color:e.mediumTextColor,paddingBottom:8,textAlign:"center"}})),[]),T=(0,d.VK)((()=>f.default.state.open&&h.default.state.inAppCalloutStore.canShow("guided_tutorial_popup")&&(0,y.TL)(t)),[t]),I=(0,r.useCallback)((e=>{if(!i)return;const a={x:window.innerWidth/2,y:window.innerHeight/2};switch(S.default.getEligibleGroup({experimentId:"tooltip_vs_shadow_cursor",defaultGroup:"control"})){case"shadow_cursor":v.startShadowCursorTutorial(t,{position:a,userSettingsStore:i,guidedTutorialStore:n});break;case"tooltip":!function(){f.default.setState({open:!1});const{guidedTutorialStore:e}=h.default.state;e.setState({...h.default.state.guidedTutorialStore.state,currentCursorElement:"new-page-sidebar",type:"tooltip"})}()}}),[t,i,n]),P=(0,r.useCallback)((e=>{v.updateShadowCursorSubpagePhase({environment:t,userSettingsStore:i,phase:"dismissed_modal"})}),[t,i]);return T?s()(w.P,{calloutId:"guided_tutorial_popup"},void 0,s()("div",{style:k.container},void 0,s()(M.Z,{onClick:P,style:k.cancel},void 0,u.Z.closeSmall({width:14,fill:e.mediumTextColor})),s()("div",{style:k.content},void 0,s()("div",{style:k.contentTextFlex},void 0,u.Z.graduationCapInvert({width:24,height:24,fill:e.blueColor,alignSelf:"center"}),s()("div",{style:{fontWeight:m.Z.fontWeight.medium,fontSize:16,alignSelf:"center"}},void 0,r.createElement(g.FormattedMessage,C.title)),s()("div",{style:k.subtitle},void 0,r.createElement(g.FormattedMessage,a()({},C.subtitle,{values:{workspacename:o}}))),s()(b.Z,{isLarge:!0,style:{width:"calc(100% -30px)"},onClick:I},void 0,r.createElement(g.FormattedMessage,C.cta)))))):null}},7523:(e,t,i)=>{i.r(t),i.d(t,{default:()=>M});var n=i(23174),a=i.n(n),o=i(67294),s=i(83355),r=i(15145),l=i(53397),d=i(82990),c=i(5366),u=i(50906),m=i(5978),p=i(33665),g=i(79315),h=i(47593),f=i(16354),v=i(53953),y=i(89728),S=i(15684);class b extends s.Z{constructor(){super(...arguments),this.handleModalDismiss=()=>{h.Z.setState({open:!1})},this.handleImportComplete=e=>{h.Z.setState({open:!1}),m.navigateToBlock({environment:this.environment,store:e,pageVisitSource:r.tY.Import})}}renderComponent(){const e=h.Z.state;return a()(v.Z,{open:e.open,innerStyle:b.wrapStyle,preventHideChildrenWhileOpening:!0,render:()=>a()(o.Fragment,{},void 0,a()("div",{style:b.modalTopbarWrapStyle},void 0,a()("div",{style:b.modalTopbarHeaderStyle},void 0,a()(c.FormattedMessage,{id:"importModal.importButton.label",defaultMessage:"Import"})),this.renderHelpButton()),a()("div",{},void 0,this.renderImportOptions(e))),onDismiss:this.handleModalDismiss})}renderHelpButton(){return a()(f.Z,{href:(0,p.UY)("guides.import"),onClick:()=>u.Fsx(this.environment,{from:"import"}),external:!0},void 0,a()(y.Z,{isSmall:!0,icon:l.Z.help,isGray:!0},void 0,a()(c.FormattedMessage,{id:"importModal.helpButton.label",defaultMessage:"Learn about importing"})))}renderImportOptions(e){const{mainEditorCurrentBlockStore:t,currentSpaceStore:i,currentSpaceViewStore:n,currentUserSettingsStore:o}=g.default.state;if(t&&i&&n&&o)return a()(S.Z,{pageStore:e.open&&e.pageStore?e.pageStore:t,spaceStore:i,spaceViewStore:n,userSettingsStore:o,analyticsFrom:"modal",onComplete:this.handleImportComplete,readOnlyCreditButton:!1})}}b.displayName="ImportModal",b.wrapStyle={padding:"24px 36px 24px",minWidth:300},b.modalTopbarWrapStyle={display:"flex",alignItems:"center",marginTop:8,marginBottom:18},b.modalTopbarHeaderStyle={fontSize:24,lineHeight:1.2,marginBottom:6,fontWeight:d.Z.fontWeight.bold,marginRight:"auto"};const M=b},15684:(e,t,i)=>{i.d(t,{Z:()=>nt});var n=i(10434),a=i.n(n),o=i(23174),s=i.n(o),r=i(67294),l=i(83355),d=i(41892),c=i(53397),u=i(4615),m=i(5366),p=i(50906),g=i(47307),h=i(49085);class f extends h.default{getInitialState(){return{spacesResult:void 0,showLoader:!1,isLoadingSpaces:!0}}}const v=new f;var y=i(54642),S=i(92625);async function b(e){const{environment:t,spaceId:i,requestStore:n}=e;if(!t.currentUser.id)return g.showMessage({message:"Invalid details"}),void S.x();v.setState({...v.state,showLoader:!0,isLoadingSpaces:!1});const a=await y.getConfluenceSpaces(t,{spaceId:i});if(await(null==n?void 0:n.refresh()),v.setState({...v.state,showLoader:!1,isLoadingSpaces:!1}),"failed"!==a.type)return v.setState({...v.state,spacesResult:a.data}),a.data;console.error(a.error),g.showError(a),S.x()}var M=i(30738),w=i(68821),C=i(72340),_=i(8989),k=i(22756);async function T(e){const t=await y.getTrelloAccount(e,{});return"success"===t.type?t.data:(console.error(t.error),{})}async function I(e){k.Z.setState({...k.Z.state,isFetchingAsanaAccount:!0});const t=await y.getAsanaAccount(e,{});if("success"===t.type){const{account:e}=t.data;return k.Z.setState({...k.Z.state,account:e,isFetchingAsanaAccount:!1}),e?t.data:{}}return console.error(t.error),k.Z.setState({...k.Z.state,isFetchingAsanaAccount:!1}),{}}async function P(e){try{const t=await y.getEvernoteAccount(e,{});if("success"===t.type){const{userInfo:e}=t.data;return{userInfo:e}}return console.error(t.error),{userInfo:void 0}}catch(t){return console.error(t),{userInfo:void 0}}}var Z=i(87279),x=i(10161);var F=i(33665),A=i(88632),E=i(67940),B=i(72087),D=i(480),R=i(81954),L=i(8848),N=i(41311),O=i(79315);const V=new(i(61766).Z);var U=i(93405),W=i(31945),K=i(73063),z=i(16354),G=i(68785),q=i(78140),H=i(32163),j=i(44532),Q=i(72495),Y=i(58032),$=i(64369),X=i(82990),J=i(64921);class ee extends l.Z{renderComponent(){const{title:e,actionButton:t,onClick:i,tooltipEvents:n}=this.props;return r.createElement(J.Z,a()({},n,{onClick:i,style:this.getButtonStyle()}),this.renderIcon(),s()("div",{style:{minWidth:0,width:"100%"}},void 0,s()("div",{style:{display:"flex"}},void 0,s()("div",{style:ee.titleStyle},void 0,e),s()("div",{style:{marginLeft:"auto"}},void 0,t)),this.renderCaption()))}renderIcon(){const{icon:e,logo:t}=this.props;return t?s()("img",{style:ee.imageIconStyle,src:t}):e?s()("div",{style:this.getIconWrapStyle()},void 0,e(this.getIconStyle())):void 0}renderCaption(){const{caption:e}=this.props;if(e)return s()("div",{style:this.getCaptionStyle()},void 0,e)}getButtonStyle(){return{display:"flex",alignItems:"center",padding:10,paddingRight:8,borderRadius:3,marginBottom:12,cursor:"pointer",boxShadow:this.theme.lightBoxShadow,transition:"background 200ms ease-out",background:this.theme.importOptionsButtonBackground}}getIconWrapStyle(){return{display:"flex",alignItems:"center",justifyContent:"center",width:ee.iconSize,height:ee.iconSize,borderRadius:3,marginRight:8,color:this.theme.mediumTextColor,background:this.theme.importOptionsIconWrapBackground}}getIconStyle(){return{flexShrink:0,width:ee.iconSize,height:ee.iconSize}}getCaptionStyle(){return{fontSize:12,color:this.theme.mediumTextColor,wordBreak:"keep-all",...!this.props.shouldWrapCaption&&{...X.Z.textOverflowStyle}}}}ee.displayName="ImportOptionsItem",ee.iconSize=28,ee.imageIconStyle={flexShrink:0,width:ee.iconSize,height:ee.iconSize,borderRadius:3,marginRight:10,background:L.ZP.white},ee.titleStyle={fontSize:16,fontWeight:X.Z.fontWeight.medium};const te=ee,ie={whiteSpace:"pre-wrap"};function ne(e,t){return s()(Y.Z,{renderTooltip:()=>s()($.Z,{style:{color:L.ZP.white},isSmall:!0},void 0,s()(m.FormattedMessage,{id:"AsanaImportOption.helpButton.tooltip",defaultMessage:"Learn about how to import"})),render:i=>r.createElement(z.Z,a()({},i,{external:!0,href:e,style:{marginLeft:"auto"}}),s()(K.Z,{icon:c.Z.help,ariaLabel:t.formatMessage({id:"AsanaImportOption.helpButton.ariaLabel",defaultMessage:"Learn about how to asana import help icon"})}))})}const ae=function(){window.__c={n:"AsanaV2ImportOption"};const e=(0,R.VK)((()=>k.Z.state),[]),t=(0,R.VK)((()=>E.Z.state),[]),{account:i,isLoadingAsanaWorkspaces:n,isAccountDelinkingInProgress:o,isAccountLinkingInProgress:l}=e,g=(0,D.O7)(),h=(0,m.useIntl)(),{device:f}=g,v=t.flowId||(0,u.ZP)();t.flowId||E.Z.setState({flowId:v});const y={title:h.formatMessage({id:"asanaImportOption.asanaButton.title",defaultMessage:"Asana"}),logo:d.Z.images.import.asanaPng,caption:l?h.formatMessage({id:"asanaImportOption.asanaButton.accountLinkingInProgress",defaultMessage:"Authenticating..."}):o?h.formatMessage({id:"asanaImportOption.asanaButton.accountDelinkingInProgress",defaultMessage:"Removing account..."}):i,actionButton:i?(S=[{name:h.formatMessage({id:"asanaImportOption.actionsMenu.connectAnotherAccount",defaultMessage:"Connect another account"}),captionText:h.formatMessage({id:"asanaImportOption.connectAnotherAccount.captionText",defaultMessage:"Ensure you are logged into the new Asana account in your browser"}),action:()=>N.w1({environment:g,flowId:v}).catch((()=>{}))},{name:h.formatMessage({id:"asanaImportOption.actionsMenu.removeIntegration",defaultMessage:"Remove"}),action:()=>N.XP({environment:g})}],s()(W.ZP,{popupType:j.kQ.Popup,renderOrigin:e=>n?s()(G.Z,{}):r.createElement(K.Z,a()({ariaLabel:h.formatMessage({id:"asanaImportOption.asanaButton.ariaLabel",defaultMessage:"Import from Asana button"}),icon:c.Z.dots},e)),render:e=>{const t={key:"section",render:e=>r.createElement(Q.Z,e),items:S.map((t=>{let{name:i,captionText:n,action:o}=t;return{key:i,render:e=>r.createElement(U.Z,a()({},e,{title:i,caption:n,captionStyle:n?ie:void 0})),action:()=>{o(),e.close()}}}))};return s()(q.Z,{menuType:Z.og.Popup,width:200},void 0,s()(H.Z,{type:H.i.Vertical,initialFocus:void 0,sections:[t]}))}})):ne((0,F.UY)("guides.importAsana"),h),onClick:()=>{}};var S;return s()(W.ZP,{onClick:async()=>{var e;k.Z.resetImport(),n||l||o||(i?(p.ays(g,{import_source:"asana",from:"settings_modal",userId:g.currentUser.id,spaceId:null===(e=O.default.state.currentSpaceStore)||void 0===e?void 0:e.id,flowId:v}),await N.bA({environment:g}),N.h7()):N.w1({environment:g,flowId:v}).catch((()=>{})))},popupType:f.isMobile?W.Z4.SlideUp:W.Z4.Popup,buttonPopupStore:V,renderOrigin:e=>{let{onClick:t}=e;return r.createElement(te,a()({},y,{onClick:t}))},render:()=>{}})};var oe=i(24405),se=i(22711),re=i(78900),le=i(42922),de=i(52275),ce=i(61519),ue=i(1743),me=i(74194),pe=i(53953),ge=i(63296),he=i(89728),fe=i(74523),ve=i(58573);class ye extends h.default{getInitialState(){return{searchQuery:"",selection:new Set}}}const Se=ye;var be=i(68894),Me=i(43765),we=i(29551);class Ce extends l.Z{constructor(){super(...arguments),this.storeTypes={store:Se},this.handleToggleItem=e=>{this.props.onComplete(e)}}willMount(e){const t=this.stores.store.state.selection,[i]=e.sections;if(i){const[e]=i.items;e&&t.add(e.key)}this.stores.store.emit()}renderComponent(){return s()(q.Z,{menuType:Z.og.Popup,header:this.renderMenuHeader(),width:280,maxHeight:350},void 0,this.renderMenuList())}renderMenuHeader(){const{searchInputPlaceholder:e}=this.props,{searchQuery:t}=this.stores.store.state;return s()(Q.Z,{isInput:!0,desktopStyle:{paddingBottom:2}},void 0,s()(be.ZP,{focus:!0,focusAfterAnimation:!0,value:t,onChange:e=>{const{store:t}=this.stores;t.setState({...t.state,searchQuery:e.target.value})},placeholder:e}))}renderMenuList(){const{sections:e,noSearchResultsPlaceholder:t}=this.props,{store:i}=this.stores,{searchQuery:n}=i.state,o=e.map((e=>{const t=(0,ve.ZP)(n,e.items,(t=>`${t.key} ${t.name} ${e.name}`));return{...e,items:t}})).filter((e=>e.items.length>0));if(0===o.length)return s()(Q.Z,{},void 0,s()(Me.Z,{title:t}));const l=o.map((t=>{const i=t.items.map((e=>e.name)),n={};return i.forEach((e=>{n[e]=n[e]?n[e]+1:1})),{key:t.name,render:i=>r.createElement(Q.Z,a()({},i,{title:e.length>1?t.name:void 0})),items:t.items.map((e=>({key:e.key,render:t=>r.createElement(de.Z,a()({},t,{title:s()(we.gq,{gap:2,alignItems:"center"},void 0,e.name,n[e.name]>1&&s()(Y.Z,{placement:Y.Z.Placement.Right,renderTooltip:()=>e.key,render:t=>r.createElement(K.Z,a()({ariaLabel:`Associated space key is ${e.key}`,disableBackground:!0,icon:c.Z.info},t))})),right:void 0!==e.count&&s()($.Z,{isSmall:!0},void 0,e.count)})),action:()=>{this.props.handleClickImportConfluenceWorkspace(e.key,e.name),this.handleToggleItem(e)}})))}}));return s()(H.Z,{type:H.i.Vertical,initialFocus:void 0,sections:l})}}Ce.displayName="IntegrationConfluenceImportPopup";const _e=Ce,ke={whiteSpace:"pre-wrap"};function Te(e){var t;window.__c={n:"Dropdown"};const{onSelectOption:i,options:n,currentOption:o}=e,l=null===(t=n.find((e=>{let{key:t}=e;return t===o})))||void 0===t?void 0:t.label,d=(0,oe.yK)((e=>({icon:{width:10,marginLeft:4,fill:e.lightIconColor}})),[]);return s()(W.ZP,{popupType:W.Z4.Popup,placementToOrigin:W.pO.Left,renderOrigin:e=>r.createElement(he.Z,a()({},e,{isLarge:!0,style:{opacity:1},disabled:!1}),l,c.Z.chevronDown(d.icon)),render:e=>{const t={menuType:Z.og.Popup,width:250,left:50},o=[{key:"settings-item-section",render:e=>r.createElement(Q.Z,e),items:n.map((t=>{let{key:n,label:o}=t;return{key:n,action:()=>{i(n),e.close()},render:e=>r.createElement(de.Z,a()({},e,{title:o,shouldWrapCaption:!0,right:l===o?s()("div",{style:{width:14}},void 0,c.Z.check()):void 0}))}}))}];return r.createElement(q.Z,t,s()(H.Z,{type:H.i.Vertical,sections:o,initialFocus:void 0,style:{position:"relative",alignItems:"flex-end"}}))}})}async function Ie(e){await async function(e){const{environment:t,requestStore:i,userEmail:n,site:a,access_token:o,instance:s,spaceId:r,username:l,password:d,flowId:c}=e;if(!t.currentUser.id)return g.showMessage({message:"Invalid details"}),void S.x();const u=await y.authenticateConfluenceUser(t,{userEmail:n,site:a,access_token:o,instance:s,userId:t.currentUser.id,spaceId:r,username:l,password:d});await i.refresh(),"failed"===u.type?(p.a1y(t,{import_source:"confluence",data:{import_type:"api",status:"failure",error:u.error},flowId:c}),console.error(u.error),g.showError(u)):(p.a1y(t,{import_source:"confluence",data:{import_type:"api",status:"success"},flowId:c}),g.showMessage({message:"Successfully connected confluence instance."}),await b({environment:t,requestStore:i,spaceId:r})),S.x()}(e)}function Pe(e){let{environment:t,title:i,email:n,accountType:a,site:o,APIToken:l,personalAccessToken:d,confluenceVersion:c,username:u,password:p,hidePopup:g,spaceId:h,flowId:f,requestStore:v}=e;window.__c={n:"ModalContent"};const[y,S]=(0,r.useState)(""),[b,M]=(0,r.useState)("Cloud"),[w,C]=(0,r.useState)(""),[_,k]=(0,r.useState)(""),[T,I]=(0,r.useState)("OAuth2.0"),[P,Z]=(0,r.useState)(""),[x,F]=(0,r.useState)(""),A=(0,oe.yK)((e=>({title:{fontWeight:X.Z.fontWeight.semibold},inputLabels:{fontSize:"14px",fontWeight:"400"},helpText:{textAlign:"center",marginTop:"5px",lineHeight:"15px",fontSize:12,color:e.lightTextColor}})),[]);return s()(ue.Z,{capture:!0},void 0,s()("div",{style:{display:"flex",flexDirection:"column",justifyContent:"space-between",height:"100%",padding:20,width:"100%"}},void 0,s()("div",{style:{overflowY:"scroll"}},void 0,s()("div",{style:{marginBottom:24}},void 0,s()("div",{style:A.title},void 0,i),s()(fe.Z,{title:s()(m.FormattedMessage,{id:"confluenceAuthentication.helpButton.caption",defaultMessage:"Learn more about importing from Confluence"}),href:"https://www.notion.so/help/import-from-confluence",analyticsFrom:"import",style:{marginTop:8}})),s()("div",{},void 0,s()("div",{style:{display:"flex",justifyContent:"space-between",flexDirection:"row"}},void 0,s()("label",{htmlFor:"accountType",style:{...A.inputLabels}},void 0,a),s()(Te,{onSelectOption:M,options:[{key:"Cloud",label:s()(m.FormattedMessage,{id:"confluenceAuthentication.accountTypeDropdownCloudOption.label",defaultMessage:"Cloud"})},{key:"Server",label:s()(m.FormattedMessage,{id:"confluenceAuthentication.accountTypeDropdownServerOption.label",defaultMessage:"Server/On-Premise"})}],currentOption:b})),s()(ce.Z,{size:12,isHidden:!0}),s()("div",{},void 0,"Server"===b?s()("div",{},void 0,s()("div",{style:{display:"flex",justifyContent:"space-between",flexDirection:"row",alignItems:"center"}},void 0,s()("label",{htmlFor:"confluenceVersion",style:{...A.inputLabels}},void 0,c),s()(Te,{onSelectOption:I,options:[{key:"OAuth2.0",label:s()(m.FormattedMessage,{id:"confluenceAuthentication.confluenceVersionDropdownNewVersionOption.label",defaultMessage:"7.9 or later"})},{key:"Basic",label:s()(m.FormattedMessage,{id:"confluenceAuthentication.confluenceVersionDropdownOlderVersionOption.label",defaultMessage:"Prior to 7.9"})}],currentOption:T})),s()(ce.Z,{size:12,isHidden:!0})):void 0),s()("label",{htmlFor:"email",style:{...A.inputLabels}},void 0,n),s()(me.Z,{id:"email",value:y,autoComplete:"off",autoCapitalize:"off",onChange:e=>{S(e.target.value)},showClearButton:!0,placeholder:"sample@gmail.com",inputElementAttributes:{minLength:4}}),s()(ce.Z,{size:12,isHidden:!0}),s()("div",{},void 0,s()("label",{htmlFor:"site",style:{...A.inputLabels}},void 0,o),s()(me.Z,{id:"site",value:w,onChange:e=>C(e.target.value),showClearButton:!0,placeholder:"Cloud"===b?"https://confluence.atlassian.net":"https://domain.com",inputElementAttributes:{minLength:4}}),s()(ce.Z,{size:12,isHidden:!0}),"Cloud"===b?s()("div",{},void 0,s()("label",{htmlFor:"APIToken",style:{...A.inputLabels}},void 0,l),s()(me.Z,{id:"AccessToken",type:"password",value:_,onChange:e=>{k(e.target.value)},showClearButton:!0,placeholder:"ABC0NDU4NTE0MzUzOooUABCoUOct72zybAxEsiABC7h",inputElementAttributes:{minLength:4}})):s()("div",{},void 0,s()("div",{},void 0,"Basic"===T?s()("div",{},void 0,s()("label",{htmlFor:"username",style:{...A.inputLabels}},void 0,u),s()(me.Z,{id:"username",value:P,onChange:e=>{Z(e.target.value)},showClearButton:!0,placeholder:"confluenceUser",inputElementAttributes:{minLength:1}}),s()(ce.Z,{size:12,isHidden:!0}),s()("label",{htmlFor:"password",style:{...A.inputLabels}},void 0,p),s()(me.Z,{type:"password",id:"password",value:x,onChange:e=>{F(e.target.value)},showClearButton:!0,placeholder:"P@S$w0rd",inputElementAttributes:{minLength:1}})):s()("div",{},void 0,s()("label",{htmlFor:"AccessToken",style:{fontSize:"14px",fontWeight:"400"}},void 0,d),s()(me.Z,{id:"AccessToken",type:"password",value:_,onChange:e=>{k(e.target.value)},showClearButton:!0,placeholder:"ABC0NDU4NTE0MzUzOooUABCoUOct72zybAxEsiABCi7h",inputElementAttributes:{minLength:4}}))))))),s()("div",{style:{flexGrow:0,flexShrink:0}},void 0,s()(ce.Z,{size:24}),s()(le.Z,{isLarge:!0,onClick:async()=>{await Ie({environment:t,userEmail:y,site:w,access_token:"Server"===b&&"Basic"===T?void 0:_,instance:b,username:"Basic"===T?P:void 0,password:"Basic"===T?x:void 0,spaceId:h,flowId:f,requestStore:v}),g()}},void 0,s()(m.FormattedMessage,{id:"confluenceAuthentication.authenticateButton.label",defaultMessage:"Authenticate"})),s()(ge.Z,{isLarge:!0,style:{marginLeft:12},onClick:()=>{g()}},void 0,s()(m.FormattedMessage,{id:"confluenceAuthentication.cancelButton.label",defaultMessage:"Cancel"})))))}const Ze=(0,m.injectIntl)((function(e){var t;window.__c={n:"ConfluenceImportOption"};const[i,n]=(0,r.useState)(!1),o=(0,R.VK)((()=>v.getState()),[]),{spaceStore:l,flowId:g}=e,h=[{name:e.intl.formatMessage({id:"confluenceImportOption.actionsMenu.importViaApi",defaultMessage:"Import via API"}),captionText:e.intl.formatMessage({id:"confluenceImportOption.actionsMenu.importViaApi.message",defaultMessage:"Recommended for the best import experience"}),action:()=>{e.handleApiImportClick("confluence",g),n(!0)}},{name:e.intl.formatMessage({id:"confluenceImportOption.actionsMenu.importViaFile",defaultMessage:"Import via file"}),captionText:e.intl.formatMessage({id:"confluenceImportOption.actionsMenu.importViaFile.message",defaultMessage:"Best for importing partial workspace content"}),action:()=>e.handleFileUploadClick("confluence",g)}],f=(0,D.O7)(),{device:y}=f,{confluenceResult:S,onComplete:w,intl:C,requestStore:_,spaceViewStore:k}=e,{account:T}=S,{showLoader:I,isLoadingSpaces:P}=o;function x(e,t){p.qyQ(f,{import_source:"confluence",data:{spaceKey:e,spaceName:t},flowId:g})}function F(e){return s()("div",{},void 0,s()("label",{style:{fontSize:"12px",color:"rgba(55, 53, 47, 0.65)",paddingLeft:"12px"}},void 0,s()(m.FormattedMessage,{id:"confluenceImportOption.search.title",defaultMessage:"Select a space to import"})),s()(_e,{searchInputPlaceholder:C.formatMessage({id:"confluenceImportOption.search.placeholder",defaultMessage:"Search for a Space"}),noSearchResultsPlaceholder:C.formatMessage({id:"confluenceImportOption.search.noResultsPlaceholder",defaultMessage:"No Spaces"}),sections:[e],onComplete:async e=>{await async function(e){const{environment:t,onComplete:i,selectedSpace:n,spaceStore:a,spaceViewStore:o,flowId:s}=e,r=await M.A1({environment:t,spaceStore:a,spaceViewStore:o,space:n,flowId:s||(0,u.ZP)()});i(r)}({environment:f,onComplete:w,selectedSpace:e,spaceStore:l,spaceViewStore:k,flowId:g})},handleClickImportConfluenceWorkspace:x}))}const A={title:"Confluence",logo:d.Z.images.import.confluencePng,caption:T,actionButton:T&&I?s()(G.Z,{}):T&&e.renderItemActionsButton([{name:C.formatMessage({id:"confluenceImportOption.actionsMenu.importViaFile",defaultMessage:"Import via file"}),action:()=>e.handleFileUploadClick("confluence",g)},{name:C.formatMessage({id:"confluenceImportOption.actionsMenu.connectAnotherAccount",defaultMessage:"Connect another instance"}),action:()=>{e.handleApiImportClick("confluence",g),n(!0)}},{name:C.formatMessage({id:"confluenceImportOption.actionsMenu.removeIntegration",defaultMessage:"Remove"}),action:()=>async function(e){const{environment:t,spaceId:i,requestStore:n}=e;v.setState({...v.state,showLoader:!1,isLoadingSpaces:!0}),await se.DP(t,n,i)}({environment:f,spaceId:l.id,requestStore:_})}]),onClick:()=>{}},E=(null===(t=o.spacesResult)||void 0===t?void 0:t.spaces)||[],B={key:"default",name:C.formatMessage({id:"confluenceImportOption.spacesProperty.defaultName",defaultMessage:"Spaces"}),items:E.map((e=>({key:e.key,name:e.name})))},L={key:"section",render:e=>r.createElement(Q.Z,e),items:h.map((e=>{let{name:t,captionText:i,action:n}=e;return{key:t,render:e=>r.createElement(U.Z,a()({},e,{title:t,caption:i,captionStyle:i?ke:void 0})),action:n}}))};return r.createElement(r.Fragment,null,s()(W.ZP,{popupType:y.isMobile?W.Z4.SlideUp:W.Z4.Popup,buttonPopupStore:re.Z,render:e=>T?function(e){return P&&b({environment:f,requestStore:_,spaceId:l.id}).catch((()=>{})),I?r.createElement(r.Fragment,null):F(e)}(B):s()(q.Z,{menuType:Z.og.Popup,width:200},void 0,s()(H.Z,{onAccept:e.close,type:H.i.Vertical,initialFocus:void 0,sections:[L]})),renderOrigin:e=>{let{onClick:t}=e;return r.createElement(te,a()({},A,{onClick:t}))}}),s()(pe.Z,{open:i,innerStyle:{width:600,maxWidth:"calc(100vw - 100px)",overflow:"hidden",borderRadius:5,maxHeight:"90vh"},onDismiss:()=>{n(!1)},render:()=>s()(Pe,{hidePopup:()=>{n(!1)},environment:f,title:s()(m.FormattedMessage,{id:"confluenceAuthentication.titleMessage",defaultMessage:"Authentication details"}),email:s()(we.gq,{style:{alignItems:"center",gap:2}},void 0,s()(m.FormattedMessage,{id:"confluenceAuthentication.emailMessage",defaultMessage:"Email"}),s()(Y.Z,{placement:Y.Z.Placement.Right,renderTooltip:()=>s()(m.FormattedMessage,{id:"confluenceAuthentication.emailHelpText",defaultMessage:"Email address of the Confluence user importing the data"}),render:e=>r.createElement(K.Z,a()({ariaLabel:"Email help text button",disableBackground:!0,icon:c.Z.info},e))})),accountType:s()(we.gq,{style:{alignItems:"center",gap:2}},void 0,s()(m.FormattedMessage,{id:"confluenceAuthentication.instanceMessage",defaultMessage:"Confluence instance"}),s()(Y.Z,{style:{width:300,whiteSpace:"normal"},placement:Y.Z.Placement.Right,renderTooltip:()=>s()(m.FormattedMessage,{id:"confluenceAuthentication.instanceHelperText",defaultMessage:"On Confluence, click 'Help', the (?) next to your profile, then click on 'About Confluence' this will tell you if it is a Server, Cloud or Data Center"}),render:e=>r.createElement(K.Z,a()({ariaLabel:"Confluence instance type help text button",disableBackground:!0,icon:c.Z.info},e))})),site:s()(we.gq,{style:{alignItems:"center",gap:2}},void 0,s()(m.FormattedMessage,{id:"confluenceAuthentication.siteMessage",defaultMessage:"Site"}),s()(Y.Z,{style:{width:300,whiteSpace:"normal"},placement:Y.Z.Placement.Right,renderTooltip:()=>s()(m.FormattedMessage,{id:"confluenceAuthentication.siteHelperText",defaultMessage:"The base URL that is used to access Confluence. If you are running on a non-standard port, please provide the input in host:port format"}),render:e=>r.createElement(K.Z,a()({ariaLabel:"Confluence site help text button",disableBackground:!0,icon:c.Z.info},e))})),APIToken:s()(we.gq,{style:{alignItems:"center",gap:2}},void 0,s()(m.FormattedMessage,{id:"confluenceAuthentication.apiTokenMessage",defaultMessage:"API token"}),s()(Y.Z,{placement:Y.Z.Placement.Right,renderTooltip:()=>s()(m.FormattedMessage,{id:"confluenceAuthentication.stepsToGetConfluenceAccessToken.captions",defaultMessage:"Click to learn how to get access token from Confluence cloud"}),render:e=>r.createElement(K.Z,a()({ariaLabel:"Confluence access token help text button",onClick:()=>{window.open("https://support.atlassian.com/atlassian-account/docs/manage-api-tokens-for-your-atlassian-account","_blank")},icon:c.Z.info},e))})),personalAccessToken:s()(we.gq,{style:{alignItems:"center",gap:2}},void 0,s()(m.FormattedMessage,{id:"confluenceAuthentication.personalAccessTokenMessage",defaultMessage:"Personal Access Token"}),s()(Y.Z,{placement:Y.Z.Placement.Right,style:{width:300,whiteSpace:"normal"},renderTooltip:()=>s()(m.FormattedMessage,{id:"confluenceAuthentication.stepsToGetConfluencePAT.caption",defaultMessage:"Click to learn how to get personal authentication token from Confluence server"}),render:e=>r.createElement(K.Z,a()({ariaLabel:"Confluence personal access token help text button",onClick:()=>{window.open("https://confluence.atlassian.com/enterprise/using-personal-access-tokens-1026032365.html","_blank")},icon:c.Z.info},e))})),confluenceVersion:s()(we.gq,{style:{alignItems:"center",gap:2}},void 0,s()(m.FormattedMessage,{id:"confluenceAuthentication.confluenceVersion",defaultMessage:"Confluence version"}),s()(Y.Z,{style:{width:300,whiteSpace:"normal"},placement:Y.Z.Placement.Right,renderTooltip:()=>s()(m.FormattedMessage,{id:"confluenceAuthentication.stepsToGetConfluenceVersion.captions",defaultMessage:"Click to learn how to know the version of Confluence you are running"}),render:e=>r.createElement(K.Z,a()({ariaLabel:"Confluence version help text button",onClick:()=>{window.open("https://confluence.atlassian.com/confkb/how-do-i-know-what-version-of-confluence-is-running-179441565.html","_blank")},icon:c.Z.info},e))})),username:s()(we.gq,{style:{alignItems:"center",gap:2}},void 0,s()(m.FormattedMessage,{id:"confluenceAuthentication.username",defaultMessage:"Username"}),s()(Y.Z,{placement:Y.Z.Placement.Right,renderTooltip:()=>s()(m.FormattedMessage,{id:"confluenceAuthentication.usernameHelpText",defaultMessage:"Username of the Confluence user importing the data"}),render:e=>r.createElement(K.Z,a()({ariaLabel:"Confluence user's username help text button",disableBackground:!0,icon:c.Z.info},e))})),password:s()(we.gq,{style:{alignItems:"center",gap:2}},void 0,s()(m.FormattedMessage,{id:"confluenceAuthentication.password",defaultMessage:"Password"}),s()(Y.Z,{placement:Y.Z.Placement.Right,renderTooltip:()=>s()(m.FormattedMessage,{id:"confluenceAuthentication.passwordHelpText",defaultMessage:"Password of the Confluence user importing the data"}),render:e=>r.createElement(K.Z,a()({ariaLabel:"Confluence user's password help text button",disableBackground:!0,icon:c.Z.info},e))})),spaceId:l.id,flowId:g,requestStore:_})}))}));var xe=i(77137),Fe=i(96486),Ae=i.n(Fe),Ee=i(98459),Be=i(83805),De=i(5978),Re=i(53833),Le=i(90365),Ne=(i(57658),i(12508)),Oe=i(28992),Ve=i(62385);class Ue extends l.Z{renderComponent(){return s()("div",{style:this.getStyle()},void 0,"·")}getStyle(){return{display:"inline-block",textAlign:"center",color:this.props.disabled?this.theme.lightTextColor:this.theme.mediumTextColor,userSelect:"none",WebkitUserSelect:"none",width:8}}}Ue.displayName="DotSeparator";const We=Ue;class Ke extends l.Z{constructor(){super(...arguments),this.storeTypes={store:Se},this.handleSelectAllClick=()=>{const{sections:e,analyticsName:t}=this.props,{store:i}=this.stores,{selection:n}=i.state;for(const a of e)for(const e of a.items)n.add(e.key);i.emit(),p.VfZ(this.environment,{integration_name:t})},this.handleDeselectAllClick=()=>{const{analyticsName:e}=this.props,{store:t}=this.stores,{selection:i}=t.state;i.clear(),t.emit(),p.FIS(this.environment,{integration_name:e})},this.handleToggleItem=e=>{const{analyticsName:t}=this.props,{store:i}=this.stores,{selection:n}=i.state;n.has(e.key)?(n.delete(e.key),p.Z36(this.environment,{integration_name:t})):(n.add(e.key),p.Glf(this.environment,{integration_name:t})),i.emit()},this.handleImport=()=>{const{sections:e}=this.props,{selection:t}=this.stores.store.state,i=Ae().flatten(e.map((e=>e.items))),n=[];t.forEach((e=>{const t=i.find((t=>t.key===e));t&&n.push(t)})),this.props.onComplete(n)}}willMount(e){const t=this.stores.store.state.selection,[i]=e.sections;if(i){const[e]=i.items;e&&t.add(e.key)}this.stores.store.emit()}renderComponent(){return s()(q.Z,{menuType:Z.og.Popup,header:this.renderMenuHeader(),footer:this.renderMenuFooter(),width:280,maxHeight:350},void 0,this.renderMenuList())}renderMenuHeader(){const{searchInputPlaceholder:e}=this.props,{searchQuery:t}=this.stores.store.state,i=Boolean(t);return s()(Q.Z,{isInput:!0,desktopStyle:{paddingBottom:2}},void 0,s()(be.ZP,{focus:!0,focusAfterAnimation:!0,value:t,onChange:e=>{const{store:t}=this.stores;t.setState({...t.state,searchQuery:e.target.value})},placeholder:e}),s()(Oe.Z,{isTokenTitle:!0,style:{marginTop:2},title:s()("div",{style:{marginLeft:-3}},void 0,s()(Ve.Z,{onClick:this.handleSelectAllClick,disabled:i,disabledFeedback:!0},void 0,s()(m.FormattedMessage,{id:"importPopup.selectAll",defaultMessage:"Select all"})),s()(We,{disabled:i}),s()(Ve.Z,{onClick:this.handleDeselectAllClick,disabled:i,disabledFeedback:!0},void 0,s()(m.FormattedMessage,{id:"importPopup.deselectAll",defaultMessage:"Deselect all"})))}))}renderMenuFooter(){const e=0===this.stores.store.state.selection.size;return s()(Q.Z,{topBorder:!0,desktopStyle:{paddingTop:8,paddingBottom:8}},void 0,s()(Oe.Z,{title:s()(le.Z,{disabled:e,onClick:this.handleImport},void 0,s()(m.FormattedMessage,{id:"integrationImportPopup.importButton.label",defaultMessage:"Import"}))}))}renderMenuList(){const{sections:e,noSearchResultsPlaceholder:t}=this.props,{store:i}=this.stores,{searchQuery:n,selection:o}=i.state,l=e.map((e=>{const t=(0,ve.ZP)(n,e.items,(t=>`${t.name} ${e.name}`));return{...e,items:t}})).filter((e=>e.items.length>0));if(0===l.length)return s()(Q.Z,{},void 0,s()(Me.Z,{title:t}));const d=l.map((t=>({key:t.name,render:i=>r.createElement(Q.Z,a()({},i,{title:e.length>1?t.name:void 0})),items:t.items.map((e=>{const t=()=>this.handleToggleItem(e);return{key:e.key,render:i=>r.createElement(de.Z,a()({},i,{title:e.name,icon:s()(Ne.Z,{checked:o.has(e.key),size:16,onClick:t}),right:void 0!==e.count&&s()($.Z,{isSmall:!0},void 0,e.count)})),action:t}}))})));return s()(H.Z,{type:H.i.Vertical,initialFocus:void 0,sections:d})}}Ke.displayName="IntegrationImportPopup";const ze=Ke;class Ge extends l.Z{constructor(){super(...arguments),this.evernoteStoreState=this.createComputedStore((()=>Re.Z.getState())),this.handleClickImportEvernote=async()=>{var e;const{isFetchingNotebooks:t}=this.evernoteStoreState.state;t&&await Be.B({environment:this.environment,requestStore:this.props.requestStore});const i=E.Z.getOrCreateFlowId();p.ays(this.environment,{import_source:"evernote",from:this.props.analyticsFrom,flowId:i,userId:this.environment.currentUser.id,spaceId:null===(e=O.default.state.currentSpaceStore)||void 0===e?void 0:e.id})},this.handleRemoveEvernote=async()=>{await y.disconnectEvernote(this.environment,{}),Re.Z.setState({notebooksResponse:{notebooks:[]},isFetchingNotebooks:!0,showLoader:!1}),await this.props.requestStore.refresh(),p.qJZ(this.environment,{integration_name:"evernote"})},this.handleEvernoteAuth=async()=>{await Be.e({environment:this.environment,requestStore:this.props.requestStore})},this.handleImportEvernoteComplete=async(e,t)=>{const{notebooks:i}=e,n=i.filter((e=>Boolean(t.find((t=>t.key===e.guid)))));p.G7t(this.environment,{integration_name:"evernote",count:t.length});const a=await M.am({environment:this.environment,spaceStore:this.props.spaceStore,spaceViewStore:this.props.spaceViewStore,userSettingsStore:this.props.userSettingsStore,notebooks:n});p.qyQ(this.environment,{import_source:"evernote",data:{notebooks:n.map((e=>e.guid)),userId:this.environment.currentUser.id,spaceId:(0,Ee.CG)(this.props.spaceStore.id)},flowId:E.Z.getOrCreateFlowId()}),this.props.onComplete(a)},this.handleEvernoteHelpClick=()=>{De.navigateToExternalURL({environment:this.environment,url:(0,F.UY)("guides.importEvernote")})}}renderComponent(){const{device:e}=this.environment,{evernoteResult:t,intl:i}=this.props,{userInfo:n}=t,{notebooksResponse:o,showLoader:l}=this.evernoteStoreState.state,c=(null==o?void 0:o.notebooks)||[],u=Ae().groupBy(c,(e=>e.stack||"")),m=Object.keys(u).map((e=>{const t=e||"Top-Level";return{key:t,name:t,items:(u[e]||[]).map((e=>({key:e.guid,name:e.title,count:e.noteCount})))}})),p={title:"Evernote",logo:d.Z.images.import.evernotePng,shouldWrapCaption:!n,caption:n?n.name||n.username||n.email:void 0,actionButton:n&&l?s()(G.Z,{}):n?this.props.renderItemActionsButton([{name:i.formatMessage({id:"evernoteImportOption.actionsMenu.learnMore",defaultMessage:"Learn more"}),action:this.handleEvernoteHelpClick},{name:i.formatMessage({id:"evernoteImportOption.actionsMenu.import",defaultMessage:"Import"}),action:()=>Le.Z.setState({open:!0})},{name:i.formatMessage({id:"evernoteImportOption.actionsMenu.connectAnotherAccount",defaultMessage:"Connect another account"}),action:this.handleEvernoteAuth},{name:i.formatMessage({id:"evernoteImportOption.actionsMenu.removeIntegration",defaultMessage:"Remove"}),action:this.handleRemoveEvernote}]):this.props.defaultActionButton,onClick:()=>{}};return s()(W.ZP,{popupType:e.isMobile?W.Z4.SlideUp:W.Z4.Popup,buttonPopupStore:Le.Z,onClick:this.handleClickImportEvernote,render:()=>l?r.createElement(r.Fragment,null):s()(ze,{searchInputPlaceholder:i.formatMessage({id:"evernoteImportOption.search.placeholder",defaultMessage:"Search for a notebook…"}),noSearchResultsPlaceholder:i.formatMessage({id:"evernoteImportOption.search.noResultsPlaceholder",defaultMessage:"No notebooks"}),analyticsName:"evernote",sections:m,onComplete:e=>this.handleImportEvernoteComplete(o,e)}),renderOrigin:e=>{let{onClick:t}=e;return r.createElement(te,a()({},p,{onClick:n?t:this.handleEvernoteAuth}))}})}}Ge.displayName="EvernoteImportOption";const qe=(0,m.injectIntl)(Ge);var He=i(33929);const je=(0,m.defineMessages)({successfullyConnected:{id:"mondayActions.successfullyConnected.message",defaultMessage:"Successfully connected monday.com instance."}});function Qe(e){let{environment:t,title:i,email:n,APIToken:a,hidePopup:o,flowId:l,requestStore:d,spaceStore:c}=e;window.__c={n:"ModalContent"};const[u,h]=(0,r.useState)(""),[f,v]=(0,r.useState)(""),b=(0,oe.yK)((e=>({title:{fontWeight:X.Z.fontWeight.semibold},inputLabels:{fontSize:"14px",fontWeight:"400"},helpText:{textAlign:"center",marginTop:"5px",lineHeight:"15px",fontSize:12,color:e.lightTextColor}})),[]);return s()(ue.Z,{capture:!0},void 0,s()("div",{style:{display:"flex",flexDirection:"column",justifyContent:"space-between",height:"100%",padding:20,width:"100%"}},void 0,s()("div",{style:{overflowY:"scroll"}},void 0,s()("div",{style:{marginBottom:24}},void 0,s()("div",{style:b.title},void 0,i),s()(fe.Z,{title:s()(m.FormattedMessage,{id:"mondayAuthentication.helpButton.caption",defaultMessage:"Learn more about importing from Monday.com"}),href:"",analyticsFrom:"import",style:{marginTop:8}})),s()("div",{},void 0,s()("label",{htmlFor:"email",style:{...b.inputLabels}},void 0,n),s()(me.Z,{id:"email",value:u,autoComplete:"off",autoCapitalize:"off",onChange:e=>{h(e.target.value)},showClearButton:!0,placeholder:"sample@gmail.com",inputElementAttributes:{minLength:4}}),s()(ce.Z,{size:12,isHidden:!0}),s()("div",{},void 0,s()("label",{htmlFor:"APIToken",style:{...b.inputLabels}},void 0,a),s()(me.Z,{id:"AccessToken",type:"password",value:f,onChange:e=>{v(e.target.value)},showClearButton:!0,placeholder:"ABC0NDU4NTE0MzUzOooUABCoUOct72zybAxEsiABC7h",inputElementAttributes:{minLength:4}})))),s()("div",{style:{flexGrow:0,flexShrink:0}},void 0,s()(ce.Z,{size:24}),s()(le.Z,{isLarge:!0,onClick:async()=>{await async function(e){const{environment:t,requestStore:i,userEmail:n,APIToken:a,flowId:o,spaceId:s}=e;if(!t.currentUser.id)return g.showMessage({message:"Invalid details"}),void S.x();const r=await y.authenticateMondayUser(t,{userId:t.currentUser.id,spaceId:s,userEmail:n,APIToken:a});await i.refresh(),"failed"===r.type?(p.a1y(t,{import_source:"monday.com",data:{import_type:"api",status:"failure",error:r.error},flowId:o}),console.error(r.error),g.showError(r)):(p.a1y(t,{import_source:"monday.com",data:{import_type:"api",status:"success"},flowId:o}),g.showMessage({message:He.default.formatMessage(je.successfullyConnected)})),S.x()}({environment:t,requestStore:d,userEmail:u,APIToken:f,flowId:l,spaceId:c.id}),o()}},void 0,s()(m.FormattedMessage,{id:"mondayAuthentication.authenticateButton.label",defaultMessage:"Authenticate"})),s()(ge.Z,{isLarge:!0,style:{marginLeft:12},onClick:()=>{o()}},void 0,s()(m.FormattedMessage,{id:"mondayAuthentication.cancelButton.label",defaultMessage:"Cancel"})))))}const Ye=(0,m.injectIntl)((function(e){window.__c={n:"MondayImportOption"};const[t,i]=(0,r.useState)(!1),{mondayResult:n,flowId:o,intl:l,requestStore:d,spaceStore:u}=e,{user:p}=n,g=(0,D.O7)(),h={title:"Monday",logo:"",caption:null==p?void 0:p.email,actionButton:p&&e.renderItemActionsButton([{name:l.formatMessage({id:"mondayImportOption.actionsMenu.connectAnotherAccount",defaultMessage:"Connect another account"}),action:()=>{i(!0)}},{name:l.formatMessage({id:"mondayImportOption.actionsMenu.removeIntegration",defaultMessage:"Remove"}),action:async()=>{await se.dt(g,d,u.id)}}]),onClick:()=>{}};return r.createElement(r.Fragment,null,s()(W.ZP,{popupType:g.device.isMobile?W.Z4.SlideUp:W.Z4.Popup,onClick:()=>{i(!0)},renderOrigin:e=>{let{onClick:t}=e;return r.createElement(te,a()({},h,{onClick:p?async()=>{await async function(e){const{environment:t,spaceStore:i}=e,n=y.parallelMondayImport(t,{importParams:[],loggerPageId:"",spaceId:i.id});for await(const a of n)return a}({environment:g,spaceStore:u})}:t}))},render:()=>{}}),s()(pe.Z,{open:t,innerStyle:{width:600,maxWidth:"calc(100vw - 100px)",overflow:"hidden",borderRadius:5,maxHeight:"90vh"},onDismiss:()=>{i(!1)},render:()=>s()(Qe,{hidePopup:()=>{i(!1)},environment:g,title:s()(m.FormattedMessage,{id:"mondayAuthentication.titleMessage",defaultMessage:"Authentication details"}),email:s()(we.gq,{style:{alignItems:"center",gap:2}},void 0,s()(m.FormattedMessage,{id:"mondayAuthentication.emailMessage",defaultMessage:"Email"}),s()(Y.Z,{placement:Y.Z.Placement.Right,renderTooltip:()=>s()(m.FormattedMessage,{id:"mondayAuthentication.emailHelpText",defaultMessage:"Email address of the Monday.com user importing the data"}),render:e=>r.createElement(K.Z,a()({},e,{ariaLabel:"Email help text button",disableBackground:!0,icon:c.Z.info}))})),APIToken:s()(we.gq,{style:{alignItems:"center",gap:2}},void 0,s()(m.FormattedMessage,{id:"mondayAuthentication.apiTokenMessage",defaultMessage:"API token"}),s()(Y.Z,{placement:Y.Z.Placement.Right,renderTooltip:()=>s()(m.FormattedMessage,{id:"mondayAuthentication.stepsToGetMondayAPIToken.captions",defaultMessage:"Click to learn how to get API token from Monday.com"}),render:e=>r.createElement(K.Z,a()({},e,{ariaLabel:"Monday.com API token help text button",onClick:()=>{window.open("https://developer.monday.com/api-reference/docs/authentication#accessing-api-tokens","_blank")},icon:c.Z.info}))})),flowId:o,requestStore:d,spaceStore:u})}))}));var $e=i(52192),Xe=i(82066),Je=i(81676);class et extends l.Z{constructor(){super(...arguments),this.trelloStoreState=this.createComputedStore((()=>Je.Z.getState())),this.handleClickImportTrello=async()=>{this.trelloStoreState.state.isFetchingBoards&&await $e.u(this.environment,this.props.requestStore),p.ays(this.environment,{import_source:"trello",from:this.props.analyticsFrom})},this.handleTrelloAuth=async()=>{await $e.M({environment:this.environment,requestStore:this.props.requestStore})},this.handleRemoveTrello=async()=>{await y.disconnectTrello(this.environment,{}),Je.Z.setState({boardsResponse:{boards:[]},isFetchingBoards:!0,showLoader:!1}),await this.props.requestStore.refresh(),p.qJZ(this.environment,{integration_name:"trello"})},this.handleImportTrelloComplete=async(e,t)=>{const{boards:i}=e,n=i.filter((e=>Boolean(t.find((t=>t.key===e.id)))));p.G7t(this.environment,{integration_name:"trello",count:t.length});const a=await M.su({environment:this.environment,spaceStore:this.props.spaceStore,spaceViewStore:this.props.spaceViewStore,boards:n});this.props.onComplete(a)}}renderComponent(){const{device:e}=this.environment,{trelloResult:t,intl:i}=this.props,{account:n}=t,{boardsResponse:o,showLoader:l}=this.trelloStoreState.state,c=o.boards,u={key:"default",name:i.formatMessage({id:"trelloImportOption.boardProperty.defaultName",defaultMessage:"Boards"}),items:c.map((e=>({key:e.id,name:e.name})))},m={title:"Trello",logo:d.Z.images.import.trelloPng,actionButton:n&&l?s()(G.Z,{}):n&&this.props.renderItemActionsButton([{name:i.formatMessage({id:"trelloImportOption.actionsMenu.import",defaultMessage:"Import"}),action:()=>Xe.Z.setState({open:!0})},{name:i.formatMessage({id:"trelloImportOption.actionsMenu.connectAnotherAccount",defaultMessage:"Connect another account"}),action:this.handleTrelloAuth},{name:i.formatMessage({id:"trelloImportOption.actionsMenu.removeIntegration",defaultMessage:"Remove"}),action:this.handleRemoveTrello}]),onClick:()=>{}};return s()(W.ZP,{popupType:e.isMobile?W.Z4.SlideUp:W.Z4.Popup,buttonPopupStore:Xe.Z,onClick:this.handleClickImportTrello,render:()=>l?r.createElement(r.Fragment,null):s()(ze,{searchInputPlaceholder:i.formatMessage({id:"trelloImportOption.search.placeholder",defaultMessage:"Search for a board…"}),noSearchResultsPlaceholder:i.formatMessage({id:"trelloImportOption.search.noResultsPlaceholder",defaultMessage:"No boards found."}),analyticsName:"trello",sections:[u],onComplete:e=>this.handleImportTrelloComplete(o,e)}),renderOrigin:e=>{let{onClick:t}=e;return r.createElement(te,a()({},m,{onClick:n?t:this.handleTrelloAuth}))}})}}et.displayName="TrelloImportOption";const tt=(0,m.injectIntl)(et);class it extends l.Z{constructor(){super(...arguments),this.storeTypes={trelloRequestStore:B.Z,asanaRequestStore:B.Z,evernoteRequestStore:B.Z,confluenceRequestStore:B.Z,mondayRequestStore:B.Z},this.handleFileUploadClick=async(e,t)=>{p.ays(this.environment,{import_source:e,from:this.props.analyticsFrom,import_type:"file",flowId:t});const i=await M.ro({environment:this.environment,pageStore:this.props.pageStore,spaceStore:this.props.spaceStore,spaceViewStore:this.props.spaceViewStore,uploadType:e,flowId:t});i&&this.props.onComplete(i)},this.handleApiImportClick=(e,t)=>{b({environment:this.environment,requestStore:this.props.confluenceRequestStore,spaceId:this.props.spaceStore.id}).catch((()=>{})),p.ays(this.environment,{import_source:e,from:this.props.analyticsFrom,import_type:"api",flowId:t})},this.getAnalyticsFlowId=()=>E.Z.state.flowId||(0,u.ZP)()}renderComponent(){if(!A.Z.state.online)return s()("div",{style:{...it.wrapStyle,fontSize:14,color:this.theme.mediumTextColor}},void 0,s()(m.FormattedMessage,{id:"importOptions.offlineErrorMessage",defaultMessage:"Please go online to import."}));const{analyticsFrom:e,isLoadingNewConnections:t}=this.props;return this.renderRequests((i=>!i||t?s()("div",{style:"onboarding"===e?{}:it.wrapStyle},void 0,s()(G.Z,{})):s()("div",{style:it.wrapStyle},void 0,this.renderOptions(i))))}renderOptions(e){const t=this.getAnalyticsFlowId();return s()("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gridAutoRows:"1fr",gap:"4px 16px",width:"100%"}},void 0,this.renderAsanaImportOption(e.asanaResult),(0,C.Tc)(this.environment)?this.renderConfluenceImportViaAPIOption(e.confluenceResult,t):this.renderConfluenceImportViaFileOption(t),s()(te,{title:"Google Docs",logo:d.Z.images.import.googleDocsPng,actionButton:this.renderHelpButtonToURL((0,F.UY)("guides.importGoogleDocs")),onClick:()=>this.handleFileUploadClick("gdocs")}),this.renderCsvImportWithTooltip(),s()(te,{title:s()(m.FormattedMessage,{id:"importOptions.textMarkdown.title",defaultMessage:"Text & Markdown"}),icon:c.Z.importText,onClick:()=>this.handleFileUploadClick("markdown")}),(0,_.t)()&&s()(te,{title:s()(m.FormattedMessage,{id:"importOptions.genericImporter.title",defaultMessage:"Generic Importer"}),icon:c.Z.import,onClick:()=>this.handleFileUploadClick("genericImporter",t)}),s()(te,{title:"HTML",icon:c.Z.importHTML,onClick:()=>this.handleFileUploadClick("html")}),s()(te,{title:"Word",logo:d.Z.images.import.wordPng,onClick:()=>this.handleFileUploadClick("docx")}),s()(te,{title:"Dropbox Paper",logo:d.Z.images.import.dropboxPaperPng,actionButton:this.renderHelpButtonToURL((0,F.UY)("guides.importDropboxPaper")),onClick:()=>this.handleFileUploadClick("dropbox")}),this.renderTrelloImportOption(e.trelloResult),this.renderEvernoteImportOption(e.evernoteResult),"on"===x.default.getEligibleGroup({experimentId:"monday_importer",defaultGroup:"control"})&&this.renderMondayImportOption(e.mondayResult),s()(te,{title:"Quip",logo:d.Z.images.import.quipPng,actionButton:this.renderHelpButtonToURL((0,F.UY)("guides.importQuip")),onClick:()=>this.handleFileUploadClick("quip")}),s()(te,{title:"Workflowy",logo:d.Z.images.import.workflowyPng,actionButton:this.renderHelpButtonToURL((0,F.UY)("guides.importWorkflowy")),onClick:()=>this.handleFileUploadClick("workflowy")}))}renderRequests(e){return s()(xe.Z,{request:this.environment,performRequest:T,requestStore:this.stores.trelloRequestStore,render:(t,i)=>s()(xe.Z,{request:this.environment,performRequest:I,requestStore:this.stores.asanaRequestStore,render:(t,n)=>s()(xe.Z,{request:this.environment,performRequest:P,requestStore:this.stores.evernoteRequestStore,render:(t,a)=>s()(xe.Z,{request:this.environment,performRequest:()=>async function(e,t){const i=await y.getConfluenceAccount(e,{spaceId:t});return"success"===i.type?i.data:(console.error(i.error),{})}(this.environment,this.props.spaceStore.id),requestStore:this.stores.confluenceRequestStore,render:(t,o)=>s()(xe.Z,{request:this.environment,performRequest:()=>async function(e,t){const i=await y.getMondayUser(e,{spaceId:t});if("success"===i.type)return i.data;console.error(i.error)}(this.environment,this.props.spaceStore.id),requestStore:this.stores.mondayRequestStore,render:(t,s)=>e(i&&n&&a&&o&&s?{trelloResult:i,asanaResult:n,evernoteResult:a,confluenceResult:o,mondayResult:s}:void 0)})})})})})}renderTrelloImportOption(e){return s()(tt,{trelloResult:e,analyticsFrom:this.props.analyticsFrom,renderItemActionsButton:this.renderItemActionsButton,onComplete:this.props.onComplete,requestStore:this.stores.trelloRequestStore,spaceStore:this.props.spaceStore,spaceViewStore:this.props.spaceViewStore,userSettingsStore:this.props.userSettingsStore})}renderAsanaImportOption(e){return(0,w.c)()?s()(ae,{}):r.createElement(r.Fragment,null)}renderMondayImportOption(e){return s()(Ye,{mondayResult:e,analyticsFrom:"onboarding",flowId:"",renderItemActionsButton:this.renderItemActionsButton,onComplete:this.props.onComplete,requestStore:this.stores.mondayRequestStore,spaceStore:this.props.spaceStore,spaceViewStore:this.props.spaceViewStore,userSettingsStore:this.props.userSettingsStore})}renderConfluenceImportViaAPIOption(e,t){const{analyticsFrom:i,onComplete:n,spaceStore:a,spaceViewStore:o,userSettingsStore:r}=this.props;return s()(Ze,{confluenceResult:e,analyticsFrom:i,flowId:t,renderItemActionsButton:this.renderItemActionsButton,onComplete:n,spaceStore:a,requestStore:this.stores.confluenceRequestStore,spaceViewStore:o,userSettingsStore:r,handleFileUploadClick:this.handleFileUploadClick,handleApiImportClick:this.handleApiImportClick})}renderConfluenceImportViaFileOption(e){return s()(te,{title:"Confluence",logo:d.Z.images.import.confluencePng,onClick:()=>this.handleFileUploadClick("confluence",e),actionButton:this.renderHelpButtonToURL((0,F.UY)("guides.importConfluence"))})}renderEvernoteImportOption(e){return s()(qe,{evernoteResult:e,analyticsFrom:"onboarding",renderItemActionsButton:this.renderItemActionsButton,defaultActionButton:this.renderHelpButtonToURL((0,F.UY)("guides.importEvernote")),onComplete:this.props.onComplete,requestStore:this.stores.evernoteRequestStore,spaceStore:this.props.spaceStore,spaceViewStore:this.props.spaceViewStore,userSettingsStore:this.props.userSettingsStore})}renderCsvImportWithTooltip(){return s()(Y.Z,{placement:Y.Z.Placement.Bottom,render:e=>s()(te,{tooltipEvents:e,title:"CSV",icon:c.Z.importCSV,onClick:()=>this.handleFileUploadClick("csv")}),renderTooltip:()=>s()(m.FormattedMessage,{id:"importOptions.csvImport.tooltip",defaultMessage:"Ensure first row in the CSV is the header"})})}renderHelpButtonToURL(e){return s()(Y.Z,{renderTooltip:()=>s()(m.FormattedMessage,{id:"importOptions.helpButton.tooltip",defaultMessage:"Learn about how to import"}),render:t=>r.createElement(z.Z,a()({external:!0,href:e,style:{marginLeft:"auto"}},t),s()(K.Z,{icon:c.Z.help}))})}renderItemActionsButton(e){return s()(W.ZP,{popupType:j.kQ.Popup,renderOrigin:e=>r.createElement(K.Z,a()({icon:c.Z.dots},e)),render:t=>{const i={key:"section",render:e=>r.createElement(Q.Z,e),items:e.map((e=>{let{name:i,action:n}=e;return{key:i,render:e=>r.createElement(de.Z,a()({},e,{title:i})),action:()=>{n(),t.close()}}}))};return s()(q.Z,{menuType:Z.og.Popup,width:200},void 0,s()(H.Z,{type:H.i.Vertical,initialFocus:void 0,sections:[i]}))}})}}it.displayName="ImportOptions",it.wrapStyle={display:"flex",alignItems:"center",justifyContent:"center",width:752,minHeight:240},it.optionsColumnStyle={width:240};const nt=it},15474:(e,t,i)=>{i.r(t),i.d(t,{IntegrationGalleryModal:()=>A});var n=i(10434),a=i.n(n),o=i(23174),s=i.n(o),r=(i(57658),i(96486)),l=i.n(r),d=i(67294),c=i(480),u=i(81954),m=i(24405),p=i(58573),g=i(53397),h=i(74181),f=i(5366),v=i(77719),y=i(761),S=i(79315),b=i(30874),M=i(49900),w=i(3444),C=i(42922),_=i(52275),k=i(73063),T=i(74194),I=i(3386),P=i(32163),Z=i(53953),x=i(74136),F=i(72495);function A(){window.__c={n:"IntegrationGalleryModal"};const e=(0,u.VK)((()=>M.d.state.open),[]),t=(0,c.Fy)(),i=(0,m.yK)((e=>({modal:{width:t.isMobile?"auto":"90vw",height:t.isMobile?"auto":"90vh",borderRadius:8}})),[t.isMobile]);return s()(Z.Z,{open:e,innerStyle:i.modal,onDismiss:()=>{M.d.setState({open:!1})},render:()=>s()("div",{style:{height:"100%",display:"flex",flexDirection:"row",borderRadius:8,overflow:"hidden"}},void 0,s()(D,{}),s()(E,{}))})}function E(){window.__c={n:"GalleryModalDetail"};const e=(0,c.O7)(),t=(0,m.yK)((e=>({container:{width:"100%",height:"100%",overflow:"auto",flex:1,display:"flex",flexDirection:"column",alignItems:"stretch",background:e.contentBackground,color:e.regularTextColor,padding:20},text:{color:e.darkTextColor}})),[]),i=(0,u.VK)((()=>{const{currentSpaceStore:e}=S.default.state;return null==e?void 0:e.id}),[]),n=(0,u.VK)((()=>{if(M.d.state.open)return M.d.state.selectedIntegration}),[]),a=(0,u.VK)((()=>n?b.Z.externalAuthentications.state.filter((e=>e.integration_id===n.id)):[]),[n]);if(!n||!i)return null;const o=n.info.icon,r=n.name,l=n.info.developer_name,p=n.info.description,g=[];(0,h.mo)(n)&&g.push("linkPreview"),(0,h.zc)(n)&&g.push("databaseSync");const _=n.info.screenshots,k=_?s()(B,{imageUrls:_},n.id):null;return d.createElement(d.Fragment,null,s()("div",{style:t.container},void 0,k,s()("div",{style:{display:"flex",justifyContent:"space-between",paddingBottom:20}},void 0,s()("div",{style:{display:"flex"}},void 0,s()("img",{src:o,style:{width:50,marginRight:10}}),s()("div",{style:{display:"flex",flexDirection:"column"}},void 0,s()("span",{},void 0,s()("b",{style:{fontSize:18}},void 0,r)),s()("span",{style:t.text},void 0,s()(f.FormattedMessage,{id:"integrationGalleryModalDetail.madeBy.name",defaultMessage:"By {name}",values:{name:l}})))),s()(C.Z,{style:{width:120},onClick:()=>(async t=>{await v.hM({environment:e,integration:t,spaceId:i,from:"integration_gallery"}),y.pJ({environment:e})})(n)},void 0,a.length>0?s()(f.FormattedMessage,{id:"integrationGalleryModalDetail.button.installAnother",defaultMessage:"Install another"}):s()(f.FormattedMessage,{id:"integrationGalleryModalDetail.button.install",defaultMessage:"Install"}))),s()("span",{style:{...t.text,fontSize:14}},void 0,p),s()("div",{style:{display:"flex",marginTop:10}},void 0,g.map((e=>e&&s()(x.Z,{desktopStyle:{marginLeft:4},innerStyle:{fontSize:12}},void 0,w.a_[e]))))))}function B(e){window.__c={n:"ImageCarousel"};const{imageUrls:t}=e,[i,n]=(0,d.useState)(0),a=(0,m.yK)((e=>({heroImg:{width:"100%",objectFit:"contain",objectPosition:"top",paddingBottom:30},arrows:{fill:"#000"}})),[]),o=e=>{let a="right"===e?i+1:i-1;a<0&&(a=t.length-1),a>t.length-1&&(a=0),n(a)},r=t.length>0;return s()("div",{style:{width:"100%",position:"relative"}},void 0,r&&s()(k.Z,{style:{position:"absolute",top:"50%",left:10},iconStyle:a.arrows,icon:g.Z.chevronLeft,onClick:()=>o("left")}),s()("img",{style:a.heroImg,src:t[i]}),r&&s()(k.Z,{style:{position:"absolute",top:"50%",right:10},iconStyle:a.arrows,icon:g.Z.chevronRight,onClick:()=>o("right")}))}function D(){window.__c={n:"GalleryModalSidebar"};const e=(0,f.useIntl)(),t=(0,m.yK)((e=>({sidebar:{height:"100%",width:275,background:e.sidebarBackground,alignContent:"center",display:"flex",flexDirection:"column",alignItems:"stretch",boxShadow:e.sidebarBoxShadow},header:{padding:"12px 12px 0 12px"},searchIcon:{width:14,height:14,marginRight:6,flexGrow:0,flexShrink:0,fill:e.mediumIconColor},searchBar:{height:32,borderRadius:5,fontSize:14,marginTop:0,marginBottom:8,padding:"16px 10px"},selectedItem:{background:"dark"===e.mode?e.popoverHoveredBackground:e.sidebarItemSelectedBackground,fontWeight:500}})),[]),[i,n]=(0,d.useState)(""),o=(0,u.VK)((()=>b.Z.integrations.state),[]),r=(0,u.VK)((()=>l().groupBy(b.Z.externalAuthentications.state,(e=>e.integration_id))),[]),c=(0,u.VK)((()=>{if(M.d.state.open)return M.d.state.selectedIntegration}),[]),h=(0,p.ZP)(i,o,(e=>e.name)),v=h.filter((e=>{var t;return null===(t=r[e.id])||void 0===t?void 0:t.length})),y=h.filter((e=>{var t;return!(null!==(t=r[e.id])&&void 0!==t&&t.length)})),S=[{key:"installed",render:e=>d.createElement(F.Z,a()({},e,{title:"Installed"})),items:v.map((e=>({key:e.id,action:()=>{M.d.state.open&&M.d.setState({...M.d.state,selectedIntegration:e})},render:i=>d.createElement(_.Z,a()({},i,{title:e.name,icon:s()("img",{src:e.info.icon,style:{width:12}}),buttonStyle:{...e.id===(null==c?void 0:c.id)?t.selectedItem:void 0}}))})))},{key:"not_installed",render:e=>d.createElement(F.Z,a()({},e,{title:"Not Installed"})),items:y.map((e=>({key:e.id,action:()=>{M.d.state.open&&M.d.setState({...M.d.state,selectedIntegration:e})},render:i=>d.createElement(_.Z,a()({},i,{title:e.name,icon:s()("img",{src:e.info.icon,style:{width:12}}),buttonStyle:{...e.id===(null==c?void 0:c.id)?t.selectedItem:void 0}}))})))}];return s()("div",{style:t.sidebar},void 0,s()("div",{style:t.header},void 0,s()(I.Z,{capture:!0,onBackspace:l().identity,onLeft:l().identity,onRight:l().identity,onSelectAll:l().identity,onRedo:l().identity,onUndo:l().identity,onCut:l().identity,onCopy:l().identity,onPaste:l().identity,onKeypress:l().identity,onDelete:l().identity,onTab:l().identity},void 0,s()(T.Z,{placeholder:e.formatMessage({id:"integrationGallery.sidebar.searchbar.placeholder",defaultMessage:"Search integrations"}),left:g.Z.search(t.searchIcon),showClearButton:!0,format:T.Z.Format.Small,value:i,style:t.searchBar,onChange:e=>{n(e.target.value)}}))),s()(P.Z,{type:P.i.Vertical,initialFocus:0,sections:S}))}},74661:(e,t,i)=>{i.r(t),i.d(t,{default:()=>P});var n=i(23174),a=i.n(n),o=i(67294),s=i(480),r=i(81954),l=i(24405),d=i(66673),c=i(53397),u=i(51859),m=i(89101),p=i(82990),g=i(5366),h=i(50906),f=i(54642),v=i(5978),y=i(21969),S=i(25464),b=i(42389),M=i(42922),w=i(12508),C=i(73063),_=i(16354),k=i(44532),T=i(62385),I=i(64369);function P(){window.__c={n:"OpenInDesktopAppPopup"};const e=(0,s.O7)(),t=(0,g.useIntl)(),[i,n]=(0,o.useState)(!0),{isDesktopBrowser:P,os:Z}=(0,s.Fy)(),x=(0,r.VK)((()=>e.RouterStore.state.route.name in u.c$),[e]),F=e.currentUser.isLoggedIn(),A=(0,r.VK)((()=>b.Z.state),[]),[E,B]=(0,o.useState)(!1),D=!E&&F&&void 0===A&&P&&("mac"===Z||"windows"===Z)&&x&&b.Z.canPersistToLocalStorage(),[R,L]=(0,o.useState)(!1),N=D&&R,O=(0,o.useRef)(!1);(0,o.useEffect)((()=>{D&&!O.current&&(async function(e,t){const i=await f.getDesktopAppRegistration(e,{os:t});return"data"in i&&i.data.isRegistered}(e,Z).then((e=>{L(e)})),O.current=!0)}),[D,L,e,Z]);const V=(0,d.D9)(N);(0,o.useEffect)((()=>{N&&!V&&h.wWx(e)}),[N,V,e]);const U=(0,l.yK)((()=>({origin:{position:"fixed",left:"50%",top:"100%"},container:{bottom:20,padding:"8px 12px 12px",width:300},header:{display:"flex",justifyContent:"space-between",alignItems:"center"},headerText:{fontSize:14,fontWeight:p.Z.fontWeight.medium},appDownloadButton:{fontSize:14,marginLeft:-5},appDownloadIcon:{width:14,height:14,marginRight:6},actions:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:8},alwaysOpenLinks:{display:"flex",alignItems:"center"},alwaysOpenLinksLabel:{marginLeft:6},alwaysOpenLinksButton:{paddingLeft:12,paddingRight:12,height:34}})),[]);return a()(k.ZP,{popupType:k.kQ.Popup,placementToOrigin:S.u.Bottom,origin:a()("div",{style:U.origin}),disableMouseCapture:!0,open:N,style:U.container,render:()=>o.createElement(o.Fragment,null,a()("div",{style:U.header},void 0,a()(I.Z,{style:U.headerText},void 0,a()(g.FormattedMessage,{id:"openInDesktopAppPopup.header",defaultMessage:"Open in Notion's desktop app?"})),a()(C.Z,{ariaLabel:t.formatMessage({id:"openInDesktopAppPopup.closeButton",defaultMessage:"Dismiss"}),icon:c.Z.closeSmall,onClick:()=>{b.Z.setState("never"),B(!0),h.ZyU(e)}})),a()(_.Z,{href:m.AR.desktop,external:!0,onClick:()=>{h.iDe(e)}},void 0,a()(T.Z,{style:U.appDownloadButton},void 0,c.Z.appDownload(U.appDownloadIcon),a()("span",{},void 0,a()(g.FormattedMessage,{id:"openInDesktopAppPopup.appDownloadButton",defaultMessage:"Don't have the app? Download"})))),a()("div",{style:U.actions},void 0,a()("div",{style:U.alwaysOpenLinks},void 0,a()(w.Z,{checked:i,size:16,onClick:()=>{n(!i)}}),a()(I.Z,{isInline:!0,style:U.alwaysOpenLinksLabel},void 0,a()(g.FormattedMessage,{id:"openInDesktopAppPopup.alwaysOpenLinksLabel",defaultMessage:"Always open in app",values:{strongtext:e=>a()("strong",{},void 0,e)}}))),a()(M.Z,{style:U.alwaysOpenLinksButton,onClick:()=>{b.Z.setState(i?"always":"never"),B(!0),v.openInNativeApp({url:(0,y.W)(window.location.href),environment:e}),h.LC7(e,{always_open_in_app:i})}},void 0,a()(g.FormattedMessage,{id:"openInDesktopAppPopup.openInAppButton",defaultMessage:"Open in app",values:{strongtext:e=>a()("strong",{},void 0,e)}}))))})}},18326:(e,t,i)=>{i.r(t),i.d(t,{default:()=>M});var n=i(23174),a=i.n(n),o=(i(67294),i(83355)),s=i(82990),r=i(5366),l=i(54564),d=i(47307),c=i(70442),u=i(12359),m=i(79315),p=i(56638),g=i(88923),h=i(50795),f=i(68785),v=i(40721),y=i(44532),S=i(89302);class b extends o.Z{constructor(){super(...arguments),this.storeTypes={templateRecordCacheStore:h.$},this.renderMobilePopup=()=>{const e=p.Z.state;if(e.open)return a()(v.default,{title:a()(r.FormattedMessage,{defaultMessage:"Try this template",id:"pageTemplateModal.mobileModal.title"}),left:a()(v.CancelMenuText,{}),onClickLeft:this.handleDismiss,right:e.isLoading?a()(f.Z,{}):a()(r.FormattedMessage,{defaultMessage:"Use",id:"pageTemplateModal.mobileModal.useButton.label"}),onClickRight:this.handleUseTemplateClick,forceFullScreenSlideUp:!0},void 0,this.renderPreview(e))},this.handleDismiss=async()=>{const{inMemoryRecordCache:e}=this.stores.templateRecordCacheStore.state;if(e.appliedTransaction){await this.showEditConfirmDialog()?this.accept(!0):this.close()}else this.close()},this.handleUseTemplateClick=async()=>{const{inMemoryRecordCache:e}=this.stores.templateRecordCacheStore.state;if(e.appliedTransaction){await this.showEditConfirmDialog()?this.accept(!0):this.accept(!1)}else this.accept(!1)}}willMountOrUpdate(){const e=p.Z.state,{currentSpaceViewStore:t}=m.default.state;e.open&&t&&u.createAndCommit({userAction:"PageTemplateModal.willMountOrUpdate",environment:this.environment,perform:i=>{c.GF({item:e.item,spaceViewStore:t,transaction:i})}})}renderComponent(){const{device:e}=this.environment,t=p.Z.state;if(e.isMobile)return a()(y.GI,{open:t.open,render:this.renderMobilePopup,forceFullScreenSlideUp:!0,onDismiss:this.handleDismiss,popupType:y.GI.PopupType.SlideUp})}renderPreview(e){return a()(S.Z,{previewRootId:e.item.previewRootId,isFrontPage:!1,style:b.previewMobileStyle,templateRecordCacheStore:this.stores.templateRecordCacheStore,disabled:!0},e.item.previewRootId)}accept(e){const{inMemoryRecordCache:t}=this.stores.templateRecordCacheStore.state,i=p.Z.state,{currentSpaceViewStore:n,currentSpaceStore:a,mainEditorCurrentBlockStore:o}=m.default.state;if(i.open&&n&&a){const s=o&&o.isEmptyPage()?o:void 0,r=g.default.state.open&&g.default.state.target&&g.default.state.target.isEmptyPage()?g.default.state.target:void 0;c.RL({environment:this.environment,item:i.item,spaceStore:a,spaceViewStore:n,useRecordCache:e?t:void 0,initializeStore:i.createNewPage?void 0:s||r,isPrivate:i.isPrivate,from:i.createNewPage?"sidebar":"newPage"})}}close(){c.xv(this.environment),l.LZ()}setCurrentItem(e){p.Z.state.open&&c.zO({templateItem:e,currentUserId:this.environment.currentUser.id})}showEditConfirmDialog(){return new Promise(((e,t)=>{d.showDialog({message:a()(r.FormattedMessage,{id:"pageTemplateModal.modifiedTemplateDialog.prompt",defaultMessage:"It looks like you've modified the template. Would you like to save your edits?"}),showCancel:!1,keepFocus:!0,items:[{label:a()(r.FormattedMessage,{id:"pageTemplateModal.modifiedTemplateDialog.saveButton.label",defaultMessage:"Save edits"}),onAccept:()=>{e(!0)}},{label:a()(r.FormattedMessage,{id:"pageTemplateModal.modifiedTemplateDialog.discardEditsButton.label",defaultMessage:"Discard"}),color:"red",onAccept:()=>{e(!1)}}]})}))}getIconWrapStyle(){return{color:this.theme.regularTextColor,position:"relative"}}hoveredButtonStyle(){return{color:this.theme.regularTextColor,fontWeight:s.Z.fontWeight.medium}}fixedLinkStyle(){return{padding:12,color:this.theme.mediumTextColor,background:"dark"===this.theme.mode?this.theme.popoverBackground:this.theme.sidebarBackground,fontSize:13,fontWeight:s.Z.fontWeight.medium,display:"flex",alignItems:"center",position:"absolute",bottom:0,right:0,height:45,width:b.sidebarWidth,borderTop:`1px solid ${this.theme.regularDividerColor}`}}fixedLinkIconStyle(){return{width:12,height:12,marginLeft:8,marginRight:10,marginBottom:0,fill:this.theme.regularIconColor,fontWeight:s.Z.fontWeight.medium}}}b.displayName="PageTemplateModal",b.sidebarWidth=240,b.previewMobileStyle={width:"100%",flexGrow:1,flexShrink:1,display:"flex",flexDirection:"column",overflow:"hidden"},b.scrollerStyle={flexGrow:1,flexShrink:1,paddingBottom:44};const M=(0,r.injectIntl)(b)},57806:(e,t,i)=>{i.r(t),i.d(t,{PermissionsInviteBase:()=>L,default:()=>N});var n=i(10434),a=i.n(n),o=i(23174),s=i.n(o),r=i(96486),l=i.n(r),d=i(67294),c=i(83355),u=i(8848),m=i(94044),p=i(5366),g=i(50906),h=i(95209),f=i(21325),v=i(43250),y=i(87279),S=i(75472),b=i(65598),M=i(33665),w=i(8323),C=i(23537),_=i(29987),k=i(85834),T=i(1903),I=i(29677),P=i(68216),Z=i(78140),x=i(40721),F=i(72495),A=i(83182),E=i(7567),B=i(44385),D=i(24145),R=i(43579);class L extends c.Z{constructor(){super(...arguments),this.renderInShareMenu=this.createComputedStore((()=>Boolean(this.props.renderInShareMenu&&!this.environment.device.isMobile))),this.inviteOrigin=this.createComputedStore((()=>this.props.store instanceof P.G?this.renderInShareMenu.state?"page_share_modal":"page_permission_modal":"space_share_modal")),this.defaultRoleForSpaceBot=this.createComputedStore((()=>"editor")),this.defaultRoleForNonBot=this.createComputedStore((()=>{const{store:e,isSubscribed:t}=this.props;return S.xT({environment:this.environment,store:e,isSubscribed:t})})),this.inputDebounce=void 0,this.storeTypes={permissionsInviteStore:T.Z,contextualInviteStore:k.ZP},this.handleUpgradeClick=()=>{h.Vu({environment:this.environment,upgradeButtonName:this.props.upgradeButtonName,onUpgradeButtonClick:this.props.onUpgradeButtonClick})},this.handleModalDismiss=async()=>{await h.kL({environment:this.environment,permissionsInviteStore:this.stores.permissionsInviteStore,from:"share_menu"})},this.handleInputChange=async e=>{var t;null===(t=this.inputDebounce)||void 0===t||t.cancel(),this.inputDebounce=l().debounce((()=>{g.UWw(this.environment,{invite_flow_id:this.stores.permissionsInviteStore.state.flowId,subscription_tier:(0,w.zt)(),invite_origin:this.inviteOrigin.state})}),1e3),this.inputDebounce(),await h.jC({environment:this.environment,event:e,permissionsInviteStore:this.stores.permissionsInviteStore})},this.handleClickRemoveToken=e=>{h.PV({targetToRemove:e,permissionsInviteStore:this.stores.permissionsInviteStore,defaultRoleForNonBot:this.defaultRoleForNonBot.state})}}async willMount(){await f.bi(this.environment)}willUnmount(){var e;null===(e=this.inputDebounce)||void 0===e||e.flush()}renderComponent(){if(this.renderInShareMenu.state)return this.renderComponentInShareMenu();const e=this.renderHeader(),t=this.renderSearchRequest();return this.renderComponentOriginal(e,t)}renderHeader(){const{permissionsInviteStore:e}=this.stores,{device:t}=this.environment;return s()(D.Z,{permissionsInviteStore:e,store:this.props.store,handleClickRemoveToken:e=>{this.handleClickRemoveToken(e)},handleInputChange:async e=>{await this.handleInputChange(e)},handleInputSubmit:async()=>{await this.handleInviteInputSubmit()},origin:Boolean(this.renderInShareMenu.state)?"share_menu":"share_modal",defaultRoleForNonBot:this.defaultRoleForNonBot.state,isTeamsEnabled:(0,C.bq)(),right:!t.isMobile&&this.renderDesktopInputRightInner(),focus:"invitee"===e.state.inputFocus||"invitee-popup-closed"===e.state.inputFocus,handleFocus:()=>{t.isMobile||e.setState({...e.state,inputFocus:"invitee"})}})}renderSearchRequest(){const{permissionsInviteStore:e}=this.stores,t=(0,b.NZ)(this.props.store),i=(0,b.NZ)(this.props.store);return s()(R.Z,{permissionsInviteStore:e,store:this.props.store,defaultRoleForSpaceBot:this.defaultRoleForSpaceBot.state,shouldShowBots:t,shouldShowGroups:i,sectionRenderLimit:this.renderInShareMenu.state?5:10,membersOnly:this.props.membersOnly})}renderComponentOriginal(e,t){const{device:i}=this.environment;let n;return n=i.isMobile?{menuType:y.og.Modal,title:(0,b.Mm)(this.props.store)?s()(p.FormattedMessage,{id:"inviteUserModal.addMemberMenu.title",defaultMessage:"Add members"}):s()(p.FormattedMessage,{id:"inviteUserModal.invitePersonMenu.title",defaultMessage:"Invite a person"}),right:s()("div",{style:{color:u.ZP.blue}},void 0,s()(p.FormattedMessage,{id:"inviteUserModal.mobile.inviteButton.label",defaultMessage:"Invite"})),left:s()(x.CancelMenuText,{}),onClickLeft:this.handleModalDismiss,onClickRight:async()=>{await this.handleInviteClick()},header:e}:{menuType:y.og.Popup,width:480,height:"60vh",header:e,tokenInputHeader:!0,footer:this.renderHelpButton(),disableScroller:!1},d.createElement(Z.Z,a()({},n,{className:v.FJA}),i.isMobile&&s()(F.Z,{title:s()(p.FormattedMessage,{id:"inviteUserModal.permissionLevel.title",defaultMessage:"Permission level"})},void 0,this.renderDesktopInputRightInnerSelect()),s()("div",{},void 0,t),i.isMobile&&this.renderHelpButton())}renderHelpButton(){return this.renderInShareMenu.state?null:s()(F.Z,{topBorder:!0,disableDesktopPadding:!0},void 0,s()(A.Z,{title:s()(p.FormattedMessage,{id:"inviteUserModal.helpButton.caption",defaultMessage:"Learn how to invite people and set permissions"}),href:(0,M.UY)("guides.invitePerson"),analyticsFrom:"invite_person"}))}renderDesktopInputRightInner(){return s()("div",{style:{marginLeft:m.p_,display:"flex",alignItems:"center"}},void 0,this.renderDesktopInputRightInnerSelect(),!this.renderInShareMenu.state&&this.renderDesktopInputRightInnerButton({isLarge:!0}))}renderDesktopInputRightInnerButton(e){const{isLarge:t}=e;return s()(B.Z,{store:this.props.store,permissionsInviteStore:this.stores.permissionsInviteStore,handleUpgradeClick:()=>this.handleUpgradeClick(),handleInviteClick:()=>this.handleInviteClick(),disabled:this.props.disabled,isLarge:t})}renderDesktopInputRightInnerSelect(){const{device:e}=this.environment,{store:t}=this.props,{permissionsInviteStore:i}=this.stores;if(i.state.isInviteTargetsEmpty||!(0,I.ow)(i.state))return s()(E.ZP,{disabled:(0,b.Mm)(t)&&!t.canAdmin(),role:i.state.inviteRole,table:i.state.table,type:"user_permission",blockType:(0,b.NZ)(t)?t.getType():void 0,isInvite:!0,onUpgradeButtonClick:this.props.onUpgradeButtonClick,upgradeButtonName:this.props.upgradeButtonName,buttonStyle:{display:"flex",whiteSpace:"nowrap",height:26,color:u.ZP.uiGray,...this.renderInShareMenu.state&&{marginTop:e.isMobile?4:i.state.isInviteTargetsEmpty?1:6,marginBottom:e.isMobile?4:i.state.isInviteTargetsEmpty?1:6,marginRight:0}},isMenuItem:e.isMobile,onChange:e=>{h.XC({environment:this.environment,newRole:e,permissionsInviteStore:this.stores.permissionsInviteStore})}})}renderComponentInShareMenu(){const e={menuType:y.og.Popup,header:s()("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"top",marginLeft:12,marginRight:12,gap:10}},void 0,this.renderHeader(),this.renderDesktopInputRightInnerButton({isLarge:!0})),footer:this.renderHelpButton(),disableScroller:!1};return s()("div",{style:{paddingTop:14,paddingBottom:14,paddingLeft:2,paddingRight:2}},void 0,d.createElement(Z.Z,e,this.renderSearchRequest()))}async handleInviteInputSubmit(){await this.handleInviteClick()}async handleInviteClick(){const e=_.default.mark("share_menu.invite_user_lag");await h.qg({environment:this.environment,store:this.props.store,sudoModeStore:this.props.sudoModeStore,permissionsInviteStore:this.stores.permissionsInviteStore,contextualInviteStore:this.stores.contextualInviteStore,onInviteClick:this.props.onInviteClick,onInviteComplete:this.props.onInviteComplete,inviteOrigin:this.inviteOrigin.state,intl:this.props.intl}),_.default.measure(e,{environment:this.environment})}}L.displayName="PermissionsInviteBase";const N=(0,p.injectIntl)(L)},44385:(e,t,i)=>{i.d(t,{e:()=>b,Z:()=>M});var n=i(10434),a=i.n(n),o=i(23174),s=i.n(o),r=i(67294),l=i(480),d=i(81954),c=i(5366),u=i(94044),m=i(47425),p=i(67669),g=i(75472),h=i(8323),f=i(26781),v=i(25464),y=i(42922),S=i(58032);function b(){window.__c={n:"GuestLimitTooltip"};const e=(0,d.VK)((()=>(0,m.tP)((0,h.zt)())),[]);return r.createElement(r.Fragment,null,s()("div",{},void 0,s()(c.FormattedMessage,{id:"inviteUserButton.modalTooltip.guestLimitLine1",defaultMessage:"Your plan allows up to {guestLimit} unique guests.",values:{guestLimit:e}})),s()("div",{},void 0,s()(c.FormattedMessage,{id:"inviteUserButton.modalTooltip.guestLimitLine2",defaultMessage:"Upgrade to go unlimited."})))}const M=function(e){window.__c={n:"PermissionsInviteButton"};const{store:t,permissionsInviteStore:i,handleUpgradeClick:n,handleInviteClick:o,isLarge:m}=e,h=(0,l.O7)(),[M]=(0,d.AF)(i),w=(0,d.VK)((()=>M.inviteTargets.some((e=>g.OA(e)))),[M]),C=(0,f.i)(t),_=(0,d.VK)((()=>{const e=M.inviteTargets,t=e.filter((e=>{let{type:t}=e;return"newUser"===t})).map((e=>{let{value:t}=e;return t.email})),i=e.filter((e=>{let{type:t}=e;return"existingUser"===t})).map((e=>{let{value:t}=e;return t.id}));return p.dA(h,[...t,...i])}),[h,M]),k=w?C:void 0;return s()(S.Z,{alignment:v.v.Center,disableTooltip:!(_||k),renderTooltip:()=>_?s()(b,{}):k,render:e=>r.createElement(y.Z,a()({isLarge:m,style:{minWidth:u.UF},disabled:Boolean(k),onClick:_?n:o},e),s()(c.FormattedMessage,_?{id:"inviteUserModal.inviteButton.upgradeLabel",defaultMessage:"Upgrade"}:{id:"inviteUserModal.inviteButton.label",defaultMessage:"Invite"}))})}},7378:(e,t,i)=>{i.r(t),i.d(t,{default:()=>_});var n=i(23174),a=i.n(n),o=i(10434),s=i.n(o),r=i(67294),l=i(83355),d=i(41892),c=i(5366),u=i(21325),m=i(1865),p=i(75472),g=i(65598),h=i(8323),f=i(1903),v=i(78291),y=i(42922),S=i(9019),b=i(58032),M=i(57806),w=i(60442);class C extends l.Z{constructor(){super(...arguments),this.storeTypes={permissionsInviteStore:f.Z},this.renderOverlay=()=>r.createElement(M.default,s()({},this.props,{permissionsInviteStore:this.stores.permissionsInviteStore})),this.handleUpgradeClick=()=>{m.y(this.environment,{from:this.props.upgradeButtonName,for:"plus"}),this.props.onUpgradeButtonClick&&this.props.onUpgradeButtonClick()},this.handleButtonClick=()=>{(0,p.z5)({environment:this.environment,permissionsInviteStore:this.stores.permissionsInviteStore,store:this.props.store,renderInShareModal:!1,isSubscribed:this.props.isSubscribed})},this.handleModalDismiss=async()=>{const{permissionsInviteStore:e}=this.stores;await(0,p.Aw)({environment:this.environment,permissionsInviteStoreState:e.state,from:(0,g.Mm)(this.props.store)?"space_share_modal":"page_share_modal"})||e.reset()}}async willMount(){await u.bi(this.environment)}renderComponent(){const{store:e}=this.props,{modalOpen:t}=this.stores.permissionsInviteStore.state;let i,n,o=!1;return e.canEditMembership()?e.canEditMembership()&&(0,g.Mm)(e)&&v.default.state.data&&!h.Mk()?(i=!1,o=!0,n=a()(w.Z,{imageURL:d.Z.images.tooltips.upsells.spaceReadAndWritePng,imageWidth:240,imageHeight:100,caption:a()(c.FormattedMessage,{defaultMessage:"Members are teammates you invite to your workspace. They can access and add pages for all members to see, or be added to pages with permissions for private collaboration.",id:"permissionsInvite.spaceAddMemberUpgradeTooltip.caption"}),title:a()(c.FormattedMessage,{defaultMessage:"Upgrade to add members",id:"permissionsInvite.spaceAddMemberUpgradeTooltip.title"})})):i=!0:(i=!1,n=(0,g.Mm)(e)?a()(c.FormattedMessage,{id:"inviteUserButton.tooltip.adminsOnlyMessage",defaultMessage:"Only admins can add members."}):a()(c.FormattedMessage,{id:"inviteUserButton.tooltip.fullAccessOnlyMessage",defaultMessage:"Only those with full access can add people."})),a()("div",{},void 0,(0,g.Mm)(e)?a()(S.Z,{open:t,onDismiss:this.handleModalDismiss,renderContent:this.renderOverlay,origin:a()(b.Z,{renderTooltip:()=>n,disableTooltip:i,render:e=>r.createElement(y.Z,s()({isLarge:!0,onClick:o?this.handleUpgradeClick:this.handleButtonClick,disabled:!i&&!o,style:{flex:this.props.shouldGrow?1:0,...this.props.buttonStyle}},e),a()(c.FormattedMessage,{id:"inviteUserButton.addMemberLabel",defaultMessage:"Add members"}))})}):a()(S.Z,{open:t,onDismiss:this.handleModalDismiss,renderContent:this.renderOverlay,origin:null}))}}C.displayName="PermissionsInviteWithModal";const _=(0,c.injectIntl)(C)},79627:(e,t,i)=>{i.r(t),i.d(t,{default:()=>z});var n=i(23174),a=i.n(n),o=i(96486),s=i.n(o),r=i(67294),l=i(83355),d=i(480),c=i(81954),u=i(24405),m=i(41892),p=i(8848),g=i(53397),h=i(89101),f=i(60949),v=i(82990),y=i(5366),S=i(50906),b=i(29974),M=i(97627),w=i(12359),C=i(37181),_=i(36867),k=i(79315),T=i(4926),I=i(10161),P=i(5188),Z=i(49085);class x extends Z.default{getInitialState(){return{open:!1,step:"prompt"}}}const F=new x;var A=i(12768),E=i(23063),B=i(42922),D=i(64921),R=i(28451),L=i(3386),N=i(89728),O=i(44532),V=i(42402),U=i(29551),W=i(38294);class K extends l.Z{constructor(){super(...arguments),this.hasSeenInitial=!1,this.renderMenu=()=>a()(R.P,{calloutId:"persona_collection"},void 0,a()("div",{style:this.getContainerStyle()},void 0,this.renderCancel(),a()(U.gq,{style:this.getInnerContainerStyle(),alignItems:"center",alignContent:"center"},void 0,this.renderStep()))),this.renderInitial=()=>{const e=this.environment.currentUser.id;if(!F.state.open||!e)return;this.hasSeenInitial||(S.q5U(this.environment,{user_id:e,event:"initial"}),this.hasSeenInitial=!0);const{invalidField:t}=F.state;return a()("div",{style:{...this.getSlideUpStyle(),padding:8}},void 0,a()("img",{style:{width:40,height:32},src:m.Z.images.chatButtonSmallPng}),a()("div",{style:{fontSize:14,fontWeight:v.Z.fontWeight.semibold,paddingTop:0,paddingBottom:8}},void 0,a()(y.FormattedMessage,{id:"PersonaCollectionModal.initial.header",defaultMessage:"Tell us more about yourself"})),a()("div",{style:{fontSize:12,color:this.theme.mediumTextColor,width:270,margin:"0 auto"}},void 0,a()(y.FormattedMessage,{id:"PersonaCollectionModal.initial.caption",defaultMessage:"We would love to learn more about you so we can make our product better serve you"})),a()("div",{style:{...this.getLabelStyle(),marginTop:10}},void 0,a()(y.FormattedMessage,{id:"PersonaCollectionModal.initial.roleLabel",defaultMessage:"What is your role?"})),a()(W.Z,{questionType:"role",title:a()(y.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.question.roleLabel",defaultMessage:"Role"}),question:F.state.role,invalid:"role"===t,onSelect:e=>{F.state.open&&F.setState({...F.state,role:e,step:"initial"})}}),a()("div",{style:this.getLabelStyle()},void 0,a()(y.FormattedMessage,{id:"PersonaCollectionModal.initial.workLabel",defaultMessage:"What kind of work do you do?"})),a()(W.Z,{questionType:"work",title:a()(y.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.question.workLabel",defaultMessage:"Work"}),question:F.state.work,invalid:"work"===t,onSelect:e=>{F.state.open&&F.setState({...F.state,work:e,step:"initial"})}}),a()("div",{style:this.getLabelStyle()},void 0,a()(y.FormattedMessage,{id:"PersonaCollectionModal.initial.questionLabel",defaultMessage:"What are you planning to use Notion for?"})),a()(W.Z,{questionType:"use",title:a()(y.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.question.useLabel",defaultMessage:"Use"}),question:F.state.use,invalid:"use"===t,onSelect:e=>{F.state.open&&F.setState({...F.state,use:e,step:"initial"})}}),a()("div",{style:this.getLabelStyle()},void 0,a()(y.FormattedMessage,{id:"PersonaCollectionModal.initial.companySizeLabel",defaultMessage:"Company size"})),a()(U.gq,{},void 0,this.getCompanySizeButtonData().map((e=>{let{type:t,message:i,style:n}=e;return a()(N.Z,{isLightGray:!0,isLarge:!0,style:{...this.getBaseButtonStyle(),...F.state.open&&F.state.companySize===t&&this.getSelectedButtonStyle(),...n},onClick:()=>{F.state.open&&F.setState({...F.state,companySize:t,step:"initial"})}},void 0,i)}))))},this.renderCancel=()=>a()(D.Z,{onClick:this.handleCancel,style:this.getCancelStyle(),hoveredStyle:{background:this.theme.buttonPressedBackground}},void 0,g.Z.closeSmall({width:14,fill:this.theme.mediumTextColor})),this.renderThanks=()=>{const e=this.environment.currentUser.id;if(e)return a()(q,{userId:e})},this.renderPrompt=()=>{const e=this.environment.currentUser.id;if(e)return a()(G,{userId:e})},this.handleCancel=()=>{const{currentUserSettingsStore:e}=k.default.state,t=this.environment.currentUser.id;e&&t&&(S.jPN(this.environment,{user_id:t,event:"cancel"}),w.createAndCommit({userAction:"PersonaCollectionModal.handleCancel",environment:this.environment,perform:t=>{C.d2({userSettingsStore:e,data:{seen_persona_collection:!0},transaction:t})}}),F.reset())}}willMountOrUpdate(){var e;if(F.state.open)return;const t=this.environment,i=t.currentUser.id,n=(0,_.g)(i),{currentUserSettingsStore:a,inAppCalloutStore:o}=k.default.state;if(!a||t.device.isMobile)return;if(n<3)return;const s=a.getSettings();if(!s)return;if(Boolean(s.seen_persona_collection||(null===(e=s.persona_version)||void 0===e?void 0:e.version)))return;const r="on"===I.default.getEligibleGroup({experimentId:"persona_collection",defaultGroup:"unassigned"});!A.default.state.isOnboarding&&"closed"!==F.state.step&&!1===P.Z.state.open&&o.canShow("persona_collection")&&r&&F.setState({...F.state,open:!0})}renderComponent(){return a()(O.GI,{keepFocus:!1,open:F.state.open,render:this.renderMenu,onDismiss:this.handleCancel,popupType:O.kQ.Popup,disableDarkOverlayBackground:!0,disableMouseCapture:!0})}renderStep(){if(!1===F.state.open)return;const{step:e}=F.state;return r.createElement(r.Fragment,null,a()(E.Z,{isVisible:"initial"===e,enterAnimationStyle:{opacity:1},exitAnimationStyle:{opacity:0},render:()=>a()(L.Z,{capture:!0,onBackspace:s().identity,onLeft:s().identity,onRight:s().identity,onSelectAll:s().identity,onRedo:s().identity,onUndo:s().identity,onCut:s().identity,onCopy:s().identity,onPaste:s().identity,onKeypress:s().identity,onDelete:s().identity,onTab:s().identity},void 0,this.renderInitial())}),a()(E.Z,{isVisible:"prompt"===e,animationStyle:this.getAnimationStyle("prompt"===e),enterAnimationStyle:this.getEnterExitAnimationStyle(),exitAnimationStyle:this.getEnterExitAnimationStyle(),render:this.renderPrompt}),a()(E.Z,{isVisible:"thanks"===e,animationStyle:this.getAnimationStyle("thanks"===e),enterAnimationStyle:this.getEnterExitAnimationStyle(),exitAnimationStyle:this.getEnterExitAnimationStyle(),render:this.renderThanks}),a()(E.Z,{isVisible:"initial"===e,enterAnimationStyle:{opacity:1},exitAnimationStyle:{opacity:0},render:()=>a()(B.Z,{isLarge:!0,style:{marginTop:17,width:270,position:"absolute",bottom:20},onClick:()=>this.handleSubmitClick()},void 0,a()(y.FormattedMessage,{id:"PersonaCollectionModal.initial.sendLabel",defaultMessage:"Submit"}))}))}getInvalidField(){if(!F.state.open)return"closed";const{use:e,role:t,work:i,companySize:n}=F.state;return n?e?t?i?void 0:"work":"role":"use":"company_size"}getCompanySizeButtonData(){return[{type:"1_100",message:a()(y.FormattedMessage,{id:"PersonaCollectionModal.initial.1_100Label",defaultMessage:"1-100"})},{type:"101_1000",message:a()(y.FormattedMessage,{id:"PersonaCollectionModal.initial.101_1000Label",defaultMessage:"101-1,000"}),style:{marginLeft:8,marginRight:8}},{type:"1001+",message:a()(y.FormattedMessage,{id:"PersonaCollectionModal.initial.1000PlusLabel",defaultMessage:"1,001+"})}]}handleSubmitClick(){const e=this.environment.currentUser.id;if(!F.state.open||!e)return;const t=this.getInvalidField();if(t)return void F.setState({...F.state,step:"initial",invalidField:t});S.jPN(this.environment,{user_id:e,event:"submit"});const{currentUserSettingsStore:i}=k.default.state;if(i&&F.state.open){const e=F.state;if(w.createAndCommit({userAction:"PersonaCollectionModal.handleSubmitClick",environment:this.environment,perform:t=>{C.d2({userSettingsStore:i,data:{seen_persona_collection:!0,persona:e.work,team_role:e.role,use_case:e.use,source:"persona_collection",persona_version:{version:"V3",timestamp:(new Date).getTime()}},transaction:t})}}),I.default.checkGate("survey_data_writes")){const t=(new Date).getTime(),i=f.Dh({maybeFunction:e.work,guessedFunctionVersion:4,maybeRole:e.role,guessedRoleVersion:2,collectedFrom:"inapp_modal",collectedAt:t});void 0!==i&&M.Q1(this.environment,i);const n=f.K0({maybeCompanySize:e.companySize,guessedCompanySizeVersion:1,maybeUseCases:[e.use],guessedUseCasesVersion:3,collectedFrom:"inapp_modal",collectedAt:t});void 0!==n&&b.wg(this.environment,n)}}F.setState({...F.state,invalidField:void 0,step:"thanks"}),s().delay((()=>{F.reset()}),6e3)}getContainerStyle(){return{background:this.theme.popoverBackground,borderRadius:5,boxShadow:this.theme.mediumBoxShadow,position:"fixed",bottom:65+T.Z.state,right:16+T.Z.state}}getBackgroundStyle(){return{backgroundColor:"transparent",pointerEvents:"none"}}getCancelStyle(){return{position:"absolute",top:"10px",right:"10px",background:this.theme.buttonHoveredBackground,borderRadius:"100%",width:20,height:20,display:"flex",alignItems:"center",justifyContent:"center",zIndex:10}}getInnerContainerStyle(){return{width:320,height:"prompt"===F.state.step||"thanks"===F.state.step?200:450,overflow:"hidden",position:"relative",right:"auto",padding:30,paddingTop:0,cursor:"default",textAlign:"center",justifyContent:"center"}}getLabelStyle(){return{marginTop:10,fontSize:12,color:this.theme.mediumTextColor,fontWeight:v.Z.fontWeight.medium,lineHeight:"135%",marginBottom:4,textAlign:"left"}}getAnimationStyle(e){return{opacity:e?1:0,scale:e?1:.96}}getEnterExitAnimationStyle(){return{opacity:0,scale:.96}}getBaseButtonStyle(){return{border:"1px solid #E7E6E5",flexGrow:1,justifyContent:"center"}}getSelectedButtonStyle(){return{color:p.ZP.blue,border:`1px solid ${p.ZP.blue}`}}getSlideUpStyle(){if(!F.state.open)return{};const{step:e}=F.state;return{position:"absolute",transition:"transform 200ms ease",transform:"initial"===e?"translateY(0px)":"translateY(-180px)"}}}K.displayName="PersonaCollectionModal";const z=K;function G(e){window.__c={n:"PersonaCollectionPrompt"};const[t,i]=(0,c.AF)(F),n=(0,u.yK)((e=>({promptHeaderStyle:{color:e.regularTextColor,fontWeight:v.Z.fontWeight.semibold,fontSize:14},promptTextStyle:{fontSize:12,color:e.mediumTextColor,width:270,margin:"0 auto"}})),[]),o=(0,d.O7)();return(0,r.useEffect)((()=>{S.q5U(o,{user_id:e.userId,event:"prompt"})}),[o,e.userId]),a()("div",{style:{paddingTop:24}},void 0,a()("img",{style:{width:40,height:56,paddingTop:24},src:m.Z.images.chatButtonSmallPng}),a()("div",{style:n.promptHeaderStyle},void 0,a()(y.FormattedMessage,{id:"PersonaCollectionModal.prompt.header",defaultMessage:"Tell us more about yourself"})),a()("div",{style:n.promptTextStyle},void 0,a()(y.FormattedMessage,{id:"PersonaCollectionModal.prompt.caption",defaultMessage:"We would love to learn more about you so we can make our product better serve you"})),a()(B.Z,{isLarge:!0,style:{marginTop:6,width:260,bottom:20},onClick:()=>{!0===t.open&&i({...t,step:"initial"});const{currentUserSettingsStore:e}=k.default.state;e&&w.createAndCommit({userAction:"PersonaCollectionModal.PersonaCollectionPrompt",environment:o,perform:t=>{C.d2({userSettingsStore:e,data:{seen_persona_collection:!0},transaction:t})}})}},void 0,a()(y.FormattedMessage,{id:"PersonaCollectionModal.prompt.survey",defaultMessage:"Take the 20 second survey"})),a()(N.Z,{isLightGray:!0,isLarge:!0,onClick:()=>{const{currentUserSettingsStore:t}=k.default.state;t&&e.userId&&(w.createAndCommit({userAction:"PersonaCollectionModal.PersonaCollectionPrompt",environment:o,perform:e=>{C.d2({userSettingsStore:t,data:{seen_persona_collection:!0},transaction:e})}}),S.jPN(o,{user_id:e.userId,event:"skip"}),F.setState({open:!1,step:"closed"}))}},void 0,a()(y.FormattedMessage,{id:"PersonaCollectionModal.prompt.skipLabel",defaultMessage:"Skip"})))}function q(e){window.__c={n:"PersonaCollectionThanks"};const t=(0,u.yK)((e=>({thanksHeaderStyle:{color:e.regularTextColor,fontWeight:v.Z.fontWeight.semibold,fontSize:14}})),[]),i=(0,d.O7)();return(0,r.useEffect)((()=>{S.q5U(i,{user_id:e.userId,event:"thanks"})}),[i,e.userId]),a()("div",{},void 0,a()("img",{style:{width:208,height:89,paddingTop:30},src:m.Z.images.heroIllustrationPng}),a()("div",{style:t.thanksHeaderStyle},void 0,a()(y.FormattedMessage,{id:"PersonaCollectionModal.thanks.caption",defaultMessage:"Thank you! Discover new ways to use Notion in the <textlink>Template Gallery</textlink>",values:{textlink:t=>a()(V.Z,{disableUnderline:!0,disableHover:!0,href:h._j.templates,external:!0,style:{color:p.ZP.blue,fontSize:v.Z.fontSize.UIRegular.desktop,fontWeight:500},onClick:()=>{e.userId&&S.jPN(i,{user_id:e.userId,event:"template_gallery"})}},void 0,t)}})))}},38294:(e,t,i)=>{i.d(t,{J:()=>S,Z:()=>_});var n=i(10434),a=i.n(n),o=i(23174),s=i.n(o),r=i(67294),l=i(83355),d=i(8848),c=i(53397),u=i(29091),m=i(5366),p=i(52275),g=i(63296),h=i(14871),f=i(64369);const v="other",y={exec:s()(m.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.roleQuestion.exec",defaultMessage:"Executive (C-level / VP)"}),dept_lead:s()(m.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.roleQuestion.dept_lead",defaultMessage:"Department lead"}),team_manager:s()(m.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.roleQuestion.team_manager",defaultMessage:"Team manager"}),member:s()(m.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.roleQuestion.member",defaultMessage:"Team member"}),solo:s()(m.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.roleQuestion.solo",defaultMessage:"Solo-preneur / Freelancer"}),personal:s()(m.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.roleQuestion.personal",defaultMessage:"Using Notion just for myself"})},S={creative:s()(m.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.workQuestion.creative",defaultMessage:"Creative"}),founderCeo:s()(m.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.workQuestion.founderCeo",defaultMessage:"Founder / CEO"}),internalCommunication:s()(m.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.workQuestion.internalCommunication",defaultMessage:"Internal Communication"}),eng:s()(m.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.workQuestion.eng",defaultMessage:"Engineering"}),productDesign:s()(m.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.workQuestion.productDesign",defaultMessage:"Product Design"}),projectProgramMgmt:s()(m.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.workQuestion.projectProgramMgmt",defaultMessage:"Project / Program Management"}),product:s()(m.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.question.product",defaultMessage:"Product Management"}),marketing:s()(m.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.workQuestion.marketing",defaultMessage:"Marketing"}),sales:s()(m.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.workQuestion.sales",defaultMessage:"Sales"}),support:s()(m.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.workQuestion.support",defaultMessage:"Customer Service"}),finance:s()(m.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.workQuestion.finance",defaultMessage:"Finance"}),hr:s()(m.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.workQuestion.hr",defaultMessage:"Human Resources"}),itAdmin:s()(m.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.workQuestion.itAdmin",defaultMessage:"IT Admin"}),knowledgeManagement:s()(m.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.workQuestion.knowledgeManagement",defaultMessage:"Knowledge Management"}),operations:s()(m.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.workQuestion.operations",defaultMessage:"Operations"}),educator:s()(m.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.workQuestion.educator",defaultMessage:"Educator"}),other:s()(m.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.workQuestion.other",defaultMessage:"Other"}),student:s()(m.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.workQuestion.student",defaultMessage:"Student"})},b={student:s()(m.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.schoolQuestion.student",defaultMessage:"Student"}),educator:s()(m.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.schoolQuestion.educator",defaultMessage:"Educator"}),other:s()(m.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.schoolQuestion.other",defaultMessage:"Other"})},M={docs:s()(m.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.useQuestion.docs",defaultMessage:"Collaborate with others in docs"}),wikis:s()(m.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.useQuestion.wikis",defaultMessage:"Create a knowledge base / wiki"}),notes:s()(m.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.useQuestion.notes",defaultMessage:"Write notes"}),project:s()(m.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.useQuestion.project",defaultMessage:"Manage projects"}),goals:s()(m.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.useQuestion.goals",defaultMessage:"Track company goals and OKRs"}),ai:s()(m.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.useQuestion.question.ai",defaultMessage:"Write with AI"}),other:s()(m.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.useQuestion.other",defaultMessage:"Other"})},w={"1_49":s()(m.FormattedMessage,{id:"OnboardingSurvey.companySize.question.1_49",defaultMessage:"1-49"}),"50_99":s()(m.FormattedMessage,{id:"OnboardingSurvey.companySize.question.50_99",defaultMessage:"50-99"}),"100_299":s()(m.FormattedMessage,{id:"OnboardingSurvey.companySize.question.100_299",defaultMessage:"100-299"}),"300_999":s()(m.FormattedMessage,{id:"OnboardingSurvey.companySize.question.300_999",defaultMessage:"300-999"}),"1000_5000":s()(m.FormattedMessage,{id:"OnboardingSurvey.companySize.question.1000_5000",defaultMessage:"1000-5000"}),"5000+":s()(m.FormattedMessage,{id:"OnboardingSurvey.companySize.question.5000+",defaultMessage:"5000+"})};class C extends l.Z{renderComponent(){const{question:e,questionType:t,title:i,randomizeSelectionOrder:n,className:o,width:l,placeholder:u}=this.props,{device:v}=this.environment;let C={};"role"===t&&(C=y),"school"===t&&(C=b),"work"===t&&(C=S),"use"===t&&(C=M),"companySize"===t&&(C=w);const _={menuTitle:i,items:this.getPersonaSelectionMessages(C,n,this.environment.currentUser.id),width:l||280,disabled:this.props.disabled||!1,getKey:e=>e,selectedItem:t,originGap:4,onSelect:e=>{this.props.onSelect(e)},renderItem:e=>r.createElement(p.Z,a()({title:C[e.key]},e,{className:`${o}-${e.key}`})),renderOrigin:t=>r.createElement(g.Z,a()({},t,{isLarge:!0,style:{...this.getInputStyle(),...this.props.invalid&&{border:`1px solid ${d.ZP.red}`},...this.props.styles},className:o,focused:this.props.focus}),s()("div",{style:{display:"flex",alignItems:"center"}},void 0,s()(f.Z,{isMobile:v.isMobile,isSecondaryColor:!Boolean(e)},void 0,e?C[e]:u||s()(m.FormattedMessage,{defaultMessage:"Select response",id:"PersonaCollectionModal.selectQuestion.label"}))),c.Z.expand({width:10,fill:this.theme.lightIconColor}))};return r.createElement(h.Z,a()({key:"persona"},_))}getInputStyle(){const{device:e}=this.environment;return{backgroundColor:this.theme.whiteButtonBackground,height:e.isMobile?44:32,padding:"2px 10px",display:"flex",alignItems:"center",justifyContent:"space-between",borderRadius:3,border:0,transition:"box-shadow 0.3s ease",boxShadow:`0 0 0 1px ${this.theme.outlineButtonBorder}`,background:this.theme.buttonBackground}}getPersonaSelectionMessages(e,t,i){const n=Object.keys(e);if(!t)return n;const a=(0,u.yH)(i);return n.filter((e=>e!==v)).sort((()=>a()-.5)).concat(n.filter((e=>e===v)))}}C.displayName="PersonaCollectionModalQuestionSelect";const _=(0,m.injectIntl)(C)},95482:(e,t,i)=>{i.r(t),i.d(t,{default:()=>U});var n=i(10434),a=i.n(n),o=i(23174),s=i.n(o),r=i(67294),l=i(83355),d=i(8848),c=i(53397),u=i(5366);const m=(0,u.defineMessages)({phishing_or_spam:{id:"reportPage.reportReasons.phishing_or_spam",defaultMessage:"Phishing or spam"},inappropriate_content:{id:"reportPage.reportReasons.inappropriate_content",defaultMessage:"Inappropriate content"},other_content_policy_violation:{id:"reportPage.reportReasons.other_content_policy_violation",defaultMessage:"Other"}});var p=i(7250),g=i(82990),h=i(54642),f=i(47307),v=i(360),y=i(28020),S=i(33929),b=i(87279),M=i(33665),w=i(88632),C=i(25399),_=i(36488),k=i(74194),T=i(78140),I=i(28992),P=i(32163),Z=i(480),x=i(6740),F=i(24405),A=i(46978);function E(e){let{name:t,title:i,caption:n,isSelected:a,onClick:o,disabled:l}=e;window.__c={n:"OptionButton"};const[d,c]=(0,x.Z)(),u=(0,Z.Fy)(),m=(0,F.yK)((e=>({root:{position:"relative",display:"flex",alignItems:"center",flex:1,fontSize:14,marginBottom:8,cursor:"pointer",opacity:l?.4:1,...c&&{boxShadow:e.outlineBlueInputBoxShadow}},caption:{color:e.mediumTextColor,marginLeft:8},input:{position:"absolute",top:0,left:0,width:"100%",height:"100%",opacity:0}})),[l,c]),p=(0,r.useCallback)((()=>{l||o()}),[l,o]);return u.isMobile?s()(I.Z,{title:i,right:s()(A.Z,{isSelected:a}),onClick:p}):s()("label",{style:m.root},void 0,s()(A.Z,{isSelected:a}),s()("div",{},void 0,i),n&&s()("div",{style:m.caption},void 0,n),r.createElement("input",{type:"radio",checked:a,disabled:l,name:t,onClick:p,style:m.input,ref:d}))}var B=i(63296),D=i(72495),R=i(92660),L=i(74523),N=i(6202);const O=(0,u.defineMessages)({additionalInformationPlaceholder:{id:"reportPage.additionalInformation.placeholder",defaultMessage:"Add additional information (optional)"},dialogLabel:{id:"reportPage.dialogLabel",defaultMessage:"Report page"}});class V extends l.Z{constructor(e){super(e),this.handleCancel=()=>{v.q()},this.renderContent=()=>{const{device:e}=this.environment;if(!w.Z.state.online)return this.renderOffline();const t=C.Z.state;return t.open?e.isMobile?this.renderMobileModal(t):this.renderDesktopModal(t):void 0},this.onSubmit=async()=>{const e=this.environment,t=C.Z.getState();if(!t.open)return;const{additionalInformation:i,reason:n}=t,a=(0,y.Fv)();if(!n||null==a||!a.id)return void f.showErrorMessage(s()(u.FormattedMessage,{defaultMessage:"Something went wrong.",id:"reportPageModal.somethingWentWrong.label"}));const o=await(l=(0,p.OP)(),h.reportPage(e,{reason:n,page:a,intercomVisitorId:l,additionalInformation:i}));var l;"failed"===o.type?f.showError(o):(C.Z.setState({open:!1}),f.showMessage({message:r.createElement(r.Fragment,null,s()("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"}},void 0,c.Z.thanksShield({width:40}),s()("div",{style:{paddingTop:12,paddingBottom:8,fontSize:"large",textAlign:"center"}},void 0,s()(u.FormattedMessage,{id:"reportPageModal.thanksForReporting",defaultMessage:"Thanks for reporting this page, our team will take a look."}))))}))},this.modalTitleStyle={fontSize:16,marginBottom:12,fontWeight:g.Z.fontWeight.medium}}renderComponent(){return s()(R.Z,{ariaLabel:S.default.formatMessage(O.dialogLabel),onDismiss:this.handleCancel,render:this.renderContent,requireOnline:!0,modalStore:C.Z})}renderOptionButtons(e){const{reason:t}=e;return r.createElement(r.Fragment,null,s()(E,{title:s()(u.FormattedMessage,{id:"reportPageModal.reportReasons.phishing_or_spam",defaultMessage:"Phishing or spam"}),isSelected:"phishing_or_spam"===t,onClick:()=>C.Z.setState({...e,reason:"phishing_or_spam"}),name:"report-page-modal"},"phishing_or_spam"),s()(E,{title:S.default.formatMessage(m.inappropriate_content),isSelected:"inappropriate_content"===t,onClick:()=>C.Z.setState({...e,reason:"inappropriate_content"}),name:"report-page-modal"},"inappropriate_content"),s()(E,{title:s()(u.FormattedMessage,{id:"reportPageModal.reportReasons.other_content_policy_violation",defaultMessage:"Other"}),isSelected:"other_content_policy_violation"===t,onClick:()=>C.Z.setState({...e,reason:"other_content_policy_violation"}),name:"report-page-modal"},"other_content_policy_violation"))}renderMobileModal(e){if(!e.open)return;const{reason:t}=e,i={menuType:b.og.Modal,title:s()(u.FormattedMessage,{id:"reportPageModal.mobile.title",defaultMessage:"Report page"}),right:s()(u.FormattedMessage,{id:"reportPageModal.closeButton.label",defaultMessage:"Close"}),onClickRight:this.handleCancel};return r.createElement(T.Z,i,s()(P.Z,{type:P.i.Vertical,initialFocus:void 0,sections:[{key:"help",render:e=>{let{children:t,...i}=e;return r.createElement(D.Z,i,t)},items:[{key:"help",render:()=>s()(I.Z,{title:s()(L.Z,{title:s()(u.FormattedMessage,{id:"reportPage.helpButton.caption",defaultMessage:"Notion's content policy"}),href:(0,M.UY)("contentPolicy"),analyticsFrom:"report_page"}),right:r.createElement(r.Fragment,null),onClick:()=>{}}),action:()=>{}}]},{key:"reportOptions",render:e=>{let{children:t,...i}=e;return r.createElement(D.Z,i,t)},items:[{key:"options",render:()=>this.renderOptionButtons(e),action:()=>{}},{key:"additionalInfo",render:()=>t&&s()(k.Z,{textarea:!0,style:this.getTextAreaStyle(),focus:Boolean(e.reason),value:e.additionalInformation,placeholder:S.default.formatMessage(O.additionalInformationPlaceholder),onChange:t=>{C.Z.setState({...e,additionalInformation:t.target.value})}}),action:()=>{}}]},{key:"actions",render:e=>{let{children:t,...i}=e;return r.createElement(D.Z,a()({isSubmitButton:!0},i),t)},items:[{key:"submit",render:e=>{const{onClick:t,...i}=e;return r.createElement(N.Z,a()({},i,{disabled:!this.canSubmit(),title:s()("div",{style:{color:d.ZP.red}},void 0,s()(u.FormattedMessage,{id:"reportPageModal.reportButton.label",defaultMessage:"Report"})),onClick:t||this.onSubmit}))},action:this.onSubmit}]}]},"main list"))}canSubmit(){const{state:e}=C.Z;if(e.open){const{reason:t}=e;return void 0!==t}return!1}renderDesktopModal(e){if(!e.open)return;const{reason:t}=e;return s()(_.Z,{capture:!0,allowUndo:!0,allowEsc:!0,allowTabUntab:!1,render:()=>s()("div",{style:this.getModalWrapStyle()},void 0,s()("div",{style:this.modalTitleStyle},void 0,s()(u.FormattedMessage,{id:"reportPageModal.title",defaultMessage:"Why are you reporting this page?"})),s()("div",{style:{paddingBottom:12}},void 0,s()(L.Z,{title:s()(u.FormattedMessage,{id:"reportPage.helpButton.caption",defaultMessage:"Notion's content policy"}),href:(0,M.UY)("contentPolicy"),analyticsFrom:"report_page"})),s()("div",{},void 0,this.renderOptionButtons(e)),t&&s()(k.Z,{textarea:!0,style:this.getTextAreaStyle(),focus:Boolean(e.reason),value:e.additionalInformation,placeholder:S.default.formatMessage(O.additionalInformationPlaceholder),onChange:t=>{C.Z.setState({...e,additionalInformation:t.target.value})}}),s()("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:18}},void 0,s()(B.Z,{isLarge:!0,onClick:this.handleCancel,style:{marginRight:12}},void 0,s()(u.FormattedMessage,{id:"reportPageModal.cancelButton.label",defaultMessage:"Cancel"})),s()(B.Z,{isRed:!0,isLarge:!0,onClick:this.onSubmit,disabled:!this.canSubmit(),disabledFeedback:!0},void 0,s()(u.FormattedMessage,{id:"reportPageModal.reportButton.label",defaultMessage:"Report"}))))})}renderOffline(){return s()("div",{style:this.getOfflineStyle()},void 0,s()(u.FormattedMessage,{defaultMessage:"Please go online to make a report.",id:"reportPageModal.offlineMessage.description"}))}getModalWrapStyle(){return{width:360,padding:24,fontSize:14}}getOfflineStyle(){return{...this.getModalWrapStyle(),color:this.theme.mediumTextColor}}getTextAreaStyle(){const{device:e}=this.environment;return{width:"100%",background:this.theme.popoverBackground,display:"block",padding:e.isMobile?16:"10px 12px",height:e.isMobile?150:130,marginTop:17,marginBottom:17,fontSize:e.isMobile?16:14}}}V.displayName="ReportPageModal";const U=V},77376:(e,t,i)=>{i.r(t),i.d(t,{default:()=>I});var n=i(10434),a=i.n(n),o=i(23174),s=i.n(o),r=i(67294),l=i(480),d=i(81954),c=i(5366),u=i(93286),m=i(50906),p=i(75079),g=i(78316),h=i(87279),f=i(33665),v=i(35328),y=i(27724),S=i(13713),b=i(80209),M=i(48019),w=i(68894),C=i(78140),_=i(72495),k=i(83182);const T=(0,c.defineMessages)({filterActions:{defaultMessage:"Search actions…",id:"selectableHoverMenu.filterActions.placeholder"}});function I(e){window.__c={n:"SelectableHoverMenuPopup"};const{hasEditorPermissions:t,isWorkspaceAdmin:i,store:n,onDismiss:a,containerRef:o,query:c,setQuery:f}=e,w=(0,l.O7)(),_=(0,l.MO)(),k=(0,d.VK)((()=>{var e;return{environment:w,blocks:y.default.state.stores.length?y.default.state.stores:[n],originRect:null===(e=o.current)||void 0===e?void 0:e.getBoundingClientRect(),publicEditMode:void 0}}),[w,n,o]),T=(0,d.VK)((()=>n.isNavigableAncestorLocked()),[n]),[I,x]=(0,r.useState)(void 0),F=(0,r.useCallback)((e=>{const t=y.default.state.stores[0],i=t.getType();if(i){const n=(0,g.fm)(t),a=(0,p.Pn)(n)||{};m.dhV(w,{analyticsName:e.analyticsName,from:"selection_menu",block_id:t.id,block_type:i,is_toggleable:(0,v._A)(i,t.getFormat()),...a})}e.closeParentMenu&&a()}),[w,a]),A=(0,d.VK)((()=>n.isCollectionView()),[n]),E=!_&&t&&!T&&s()(P,{filter:c,setQuery:f,comboboxAriaProps:I});let B;return B=_?{menuType:h.og.ActionSheet,header:E}:{menuType:h.og.Popup,width:265,header:E},r.createElement(C.Z,B,s()(M.Z,{filter:c,initialFocus:c?0:void 0,sections:u.Qi,context:k,onAccept:F,setComboboxAriaProps:x}),!c&&(t||i)&&s()(S.Z,{store:n,isPageMoreButton:!1,hideTopBorder:!1}),!c&&s()(b.Z,{store:n}),!c&&A&&s()(Z,{}))}function P(e){window.__c={n:"SelectableHoverMenuHeader"};const{filter:t,setQuery:i,comboboxAriaProps:n}=e,o=(0,l.Fy)(),d=(0,c.useIntl)();return s()(_.Z,{isInput:!0},void 0,r.createElement(w.ZP,a()({value:t,onChange:e=>i(e.target.value),focus:!o.isMobile||void 0,focusAfterAnimation:!0,placeholder:d.formatMessage(T.filterActions),preventCaptureDeleteWhenEmpty:!0,preventCaptureClipboardShortcuts:!0},n)))}function Z(){return s()(_.Z,{topBorder:!0},void 0,s()(k.Z,{title:s()(c.FormattedMessage,{defaultMessage:"Learn about databases",id:"blocks.hoverBlockMenu.collectionHelpButton"}),href:(0,f.UY)("guides.database"),analyticsFrom:"selectable_hover_menu"}))}},30761:(e,t,i)=>{i.r(t),i.d(t,{default:()=>d});var n=i(23174),a=i.n(n),o=(i(67294),i(480)),s=i(24405),r=i(53953),l=i(47292);function d(e){window.__c={n:"SidebarConnectionsModal"};const t=(0,o.Fy)(),i=(0,s.yK)((e=>({modal:{width:t.isMobile?"auto":890,height:t.isMobile?"auto":606,borderRadius:8}})),[t.isMobile]);return a()(r.Z,{open:e.modalOpened,innerStyle:i.modal,onDismiss:e.onModalClose,render:()=>a()("div",{style:{height:"100%",display:"flex",flexDirection:"row",borderRadius:8,overflow:"hidden"}},void 0,a()(l.Z,{location:"sidebar-modal"}))})}},72373:(e,t,i)=>{i.r(t),i.d(t,{MembersTabTitle:()=>ii,PeopleRow:()=>ei,SettingToggle:()=>ni,SidebarTeamModal:()=>ti});var n=i(23174),a=i.n(n),o=i(96486),s=i.n(o),r=i(67294),l=i(480),d=i(81954),c=i(24405),u=i(97880),m=i(82990),p=i(5366),g=i(50906),h=i(1865),f=i(43250),v=i(23537),y=i(92350),S=i(79315),b=i(68216),M=i(48690),w=i(3386),C=i(53953),_=i(76798),k=i(18647),T=i(24006),I=i(58032),P=i(64369),Z=i(29302),x=i(13490),F=i(66957),A=i(30040),E=i(58260),B=i(10434),D=i.n(B),R=(i(57658),i(8848)),L=i(53397),N=i(64964),O=i(57688),V=i(12359),U=i(33929),W=i(78122),K=i(63409),z=i(35901),G=i(25464),q=i(42922),H=i(36488),j=i(74194),Q=i(56664),Y=i(51923),$=i(93686),X=i(37708),J=i(38755),ee=i(65426);const te=(0,p.defineMessages)({editor:{id:"TeamSettingsGeneral.generalSettings.teamPermissionsFull",defaultMessage:"Teamspace members have full access"},read_and_write:{id:"TeamSettingsGeneral.generalSettings.teamPermissionsEdit",defaultMessage:"Teamspace members can edit"},comment_only:{id:"TeamSettingsGeneral.generalSettings.teamPermissionsComment",defaultMessage:"Teamspace members can comment"},reader:{id:"TeamSettingsGeneral.generalSettings.teamPermissionsView",defaultMessage:"Teamspace members can view"}}),ie=(0,p.defineMessages)({editor:{id:"TeamSettingsGeneral.generalSettings.spacePermissionsFull",defaultMessage:"{showTeam, select, true {Everyone else} other {Everyone at {spaceName}}} has full access"},read_and_write:{id:"TeamSettingsGeneral.generalSettings.spacePermissionsEdit",defaultMessage:"{showTeam, select, true {Everyone else} other {Everyone at {spaceName}}} can edit"},comment_only:{id:"TeamSettingsGeneral.generalSettings.spacePermissionsComment",defaultMessage:"{showTeam, select, true {Everyone else} other {Everyone at {spaceName}}} can comment"},reader:{id:"TeamSettingsGeneral.generalSettings.spacePermissionsView",defaultMessage:"{showTeam, select, true {Everyone else} other {Everyone at {spaceName}}} can view"},none:{id:"TeamSettingsGeneral.generalSettings.spacePermissionsNone",defaultMessage:"{showTeam, select, true {Everyone else} other {Everyone at {spaceName}}} does not have access"}});function ne(e){let{teamStore:t}=e;window.__c={n:"TeamSettingsPermissionCard"};const i=(0,c.yK)((()=>({listItem:{padding:0,margin:0},spacer:{height:20,width:"100%"},accessLevelButton:{border:"none"}})),[]),[n,o]=(0,d.AF)(M.Z),s=M.a.Members,l=(0,d.VK)((()=>t.getTeamAccessLevel()),[t]);return r.createElement(r.Fragment,null,a()("div",{style:i.spacer}),a()(X.Ph,{title:a()(p.FormattedMessage,{id:"TeamSettingsGeneral.generalSettings.permissions",defaultMessage:"Permissions"}),rows:[a()(ee._,{currentAccessLevel:l,teamStore:t,disabledWithRightChevron:!0,style:i.accessLevelButton},"visibility"),a()(ae,{teamStore:t},"permissions")],onClick:()=>{n.open&&o({...n,tab:s})},itemStyle:i.listItem}))}function ae(e){let{teamStore:t}=e;window.__c={n:"PermissionsRow"};const i=(0,d.VK)((()=>S.default.state.currentSpaceStore),[]),n=(0,l.O7)(),o=(0,c.yK)((e=>({label:{color:e.regularTextColor,whiteSpace:"normal"},row:{display:"inline-flex",alignItems:"center",marginTop:12,marginBottom:12,paddingRight:15,paddingLeft:15},icon:{marginRight:15}})),[]),s=(0,d.VK)((()=>t.getTeamPermission()||{type:"team_permission",role:"none"}),[t]),u=(0,d.VK)((()=>t.getSpacePermission()||{type:"space_permission",role:"none"}),[t]),{spaceIcon:m,spaceName:p}=(0,d.VK)((()=>{if(!i)return{spaceIcon:void 0,spaceName:void 0};const e=(0,J.rn)(n,i);return{spaceIcon:a()($.p,{disabled:!0,store:i,size:20,style:o.icon}),spaceName:e}}),[i,n,o.icon]),g=(0,d.VK)((()=>a()($.p,{disabled:!0,store:t,size:20,style:o.icon})),[t,o.icon]),h=!(s.role===u.role),f=h?g:m,v=U.default.formatMessage(ie[u.role],{showTeam:h,spaceName:p}),y=U.default.formatMessage(te[s.role]);return a()("div",{style:o.row},void 0,f,a()(P.Z,{isSmall:!0,style:o.label},void 0,h&&r.createElement(r.Fragment,null,y,a()("span",{style:{marginLeft:5,marginRight:5}},void 0,"•")),v))}var oe=i(45660),se=i(89728),re=i(91718),le=i(27006),de=(i(59730),i(26825));const ce=["none","reader","comment_only","read_and_write","editor"],ue=["reader","comment_only","read_and_write"],me=["reader","comment_only","read_and_write","editor"],pe=["editor"];function ge(e){const t=function(e){var t,i;let{teamId:n,permissions:a}=e;const o=(null===(t=a.find((e=>(0,le.ix)(e))))||void 0===t?void 0:t.role)??"none",s=(null===(i=a.find((e=>(0,le.zU)(e)&&e.team_id===n)))||void 0===i?void 0:i.role)??o,r=a.find((e=>(0,le.bm)(e)));return{spacePermission:{type:"space_permission",role:o},teamMemberPermission:{type:"explicit_team_permission",team_id:n,role:s},teamOwnerPermission:{type:"explicit_team_owner_permission",team_id:n,role:"editor"},...r&&{teamGuestPermission:{type:"explicit_team_guest_permission",team_id:n,role:r.role}}}}({teamId:e.id,permissions:e.permissions??[]}),{spacePermission:i,teamMemberPermission:n}=t,a={visibility:["team_members","space_members"],space_member_join_access:["invite_only","self_join"],invite_access:["team_members","team_owners"]},o={spacePermission:fe({roles:ce,currentRole:n.role}),teamGuestPermission:ue,teamMemberPermission:he({roles:me,currentRole:i.role}),teamOwnerPermission:pe},{visibility:s,space_member_join_access:r}=e.settings;return"team_members"===s&&(a.space_member_join_access=["invite_only"],o.spacePermission=["none"]),"self_join"===r&&(a.visibility=["space_members"],a.invite_access=["team_members"],o.spacePermission=o.spacePermission.filter((e=>"none"!==e))),e.is_default&&(o.teamMemberPermission=[n.role],o.spacePermission=[n.role]),{settingsOptions:a,permissionItemRoleOptions:o,currentTeamPermissionItems:t}}function he(e){let{roles:t,currentRole:i}=e;return t.filter((e=>(0,de.IF)(e,i)))}function fe(e){let{roles:t,currentRole:i}=e;return t.filter((e=>(0,de.SL)(e,i)))}var ve=i(4708),ye=i(87279),Se=i(98742),be=i(52275),Me=i(31945),we=i(78140),Ce=i(32163),_e=i(72495);function ke(e){let{teamStore:t}=e;window.__c={n:"TeamSecuritySection"};const{teamSettings:i,isInviteToggleVisible:n}=(0,d.VK)((()=>({teamSettings:t.getSettingsStore().getValue(),isInviteToggleVisible:(0,ve.s$)()})),[t]),o=(0,d.VK)((()=>{const e=t.getSettingsStore().getValue();if(e)return ge({id:t.id,permissions:t.getPermissionItems(),settings:e,is_default:t.isDefault()})}),[t]);if(!i||!o)return null;const s=[a()(Ie,{teamStore:t,hasMultiInviteAccessOptions:1===o.settingsOptions.invite_access.length,inviteAccess:i.invite_access},"invite"),a()(Te,{teamStore:t,disablePageEdits:i.disable_team_page_edits},"editSidebar")];return n&&s.push(a()(Pe,{teamStore:t},"toggleInviteLink")),a()(X.Ph,{title:a()(p.FormattedMessage,{id:"TeamSettingsSecurity.teamspaceSettingsTitle",defaultMessage:"Teamspace Security"}),rows:s,hideDividers:!0})}function Te(e){window.__c={n:"EditSidebarPermissionRow"};const{teamStore:t,disablePageEdits:i}=e,n=(0,l.O7)(),o=(0,y.TE)(t),s=(0,d.VK)((()=>{var e;return(null===(e=t.getTeamPermission())||void 0===e?void 0:e.role)??"none"}),[t]),c=(0,r.useCallback)((e=>{V.createAndCommit({userAction:"teamsHelpers.changeTeamSetting",environment:n,perform:i=>{O.$x({environment:n,store:t,update:{disable_team_page_edits:e},transaction:i})}})}),[n,t]),u=(0,le.J5)(s),m=[{option:!0,label:a()(p.FormattedMessage,{id:"TeamSettingsPermissions.whoCanEditTeamPages.teamOwners.title",defaultMessage:"Only teamspace owners"}),action:()=>c(!0)}];return u&&m.push({option:!1,label:a()(p.FormattedMessage,{id:"TeamSettingsPermissions.whoCanEditTeamPages.teamMembersAndOwners.title",defaultMessage:"Any teamspace member"}),action:()=>c(!1)}),a()(Ze,{title:a()(p.FormattedMessage,{id:"TeamSettingsPermissions.whoCanEditTeamPages.title",defaultMessage:"Who can edit teamspace sidebar"}),caption:a()(p.FormattedMessage,{id:"TeamSettingsPermissions.whoCanEditTeamPages.caption",defaultMessage:"Adding, removing, or re-ordering sidebar pages"}),disabled:o||!u,currentOption:!u||Boolean(i),allOptions:m,optionTooltip:u?void 0:a()(p.FormattedMessage,{id:"TeamSettingsPermissions.settingSelect.whoCanEditTeamPages.teamMemberPermissionTooltip",defaultMessage:"Change member permissions to Can edit or Full access to allow teamspace members to edit the sidebar"})})}function Ie(e){window.__c={n:"InvitePermissionRow"};const{teamStore:t,hasMultiInviteAccessOptions:i,inviteAccess:n}=e,o=(0,y.ql)(t),s=(0,l.O7)(),d=(0,r.useCallback)((e=>{V.createAndCommit({userAction:"team.setInviteAccess",environment:s,perform:i=>{O.$x({environment:s,store:t,update:{invite_access:e},transaction:i})}})}),[s,t]),c=!o||i;return a()(Ze,{title:a()(p.FormattedMessage,{id:"TeamSettingsPermissions.whoCanInviteTeamMembers.title",defaultMessage:"Who can invite teamspace members"}),disabled:c,optionTooltip:c&&o&&a()(p.FormattedMessage,{id:"TeamSettingsPermissions.whoCanInviteTeamMembersDisabled.caption",defaultMessage:"Change access level to Closed or Private to restrict who can invite teamspace members"}),currentOption:n,allOptions:[{option:"team_members",label:a()(p.FormattedMessage,{id:"TeamSettingsPermissions.whoCanInviteTeamspaceMembers.teamMembersAndOwners.title",defaultMessage:"Any teamspace member"}),action:()=>d("team_members")},{option:"team_owners",label:a()(p.FormattedMessage,{id:"TeamSettingsPermissions.whoCanInviteTeamMembers.teamOwners.title",defaultMessage:"Only teamspace owners"}),action:()=>d("team_owners")}]})}function Pe(e){window.__c={n:"ToggleInviteLinkRow"};const{teamStore:t}=e,i=(0,l.O7)(),n=(0,d.VK)((()=>v.U2(t)),[t]),o=(0,y.TE)(t),s=(0,c.yK)((()=>({container:{display:"flex",justifyContent:"space-between"},subtitle:{marginBottom:5},switcher:{marginTop:5}})),[]);return a()("div",{style:s.container},void 0,a()("div",{},void 0,a()(P.Z,{},void 0,a()(p.FormattedMessage,{id:"TeamsecuritySection.inviteLink.label",defaultMessage:"Invite Link"})),a()(P.Z,{isSmall:!0,style:s.subtitle},void 0,a()(p.FormattedMessage,{id:"TeamsecuritySection.inviteLink.description",defaultMessage:"Only users who can invite members can see the invite link"}))),a()("div",{style:s.switcher},void 0,a()(T.Z,{disabled:o,on:!n,onClick:()=>{V.createAndCommit({userAction:"team.setInviteAccess",environment:i,perform:e=>{O.$x({environment:i,store:t,update:{disable_invite_link:!n},transaction:e})}})}})))}function Ze(e){window.__c={n:"SettingSelect"};const{title:t,caption:i,currentOption:n,allOptions:o,disabled:s,optionTooltip:d}=e,u=(0,l.Fy)(),m=(0,c.yK)((e=>({root:{display:"flex",alignItems:"center",width:"100%"},title:{fontSize:14,marginRight:8,flexGrow:1},divider:{marginTop:14,marginBottom:14},chevron:{width:10,marginLeft:4,fill:e.lightIconColor},buttonStyle:{fontSize:12.5,color:e.mediumTextColor},tooltipWidth:{width:300}})),[]),p=o.find((e=>e.option===n));return p?a()("div",{style:m.root},void 0,a()("div",{style:m.title},void 0,t,i&&a()(P.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:1,width:"95%",marginBottom:5}},void 0,i)),a()(I.Z,{style:m.tooltipWidth,placement:G.u.Top,alignment:I.Z.Alignment.Start,textWrap:!0,disableTooltip:!d,renderTooltip:()=>d,render:e=>r.createElement(Me.ZP,D()({},e,{disablePopup:s,popupType:u.isMobile?Me.Z4.SlideUp:Me.Z4.Popup,alignmentToOrigin:Me.vR.End,renderOrigin:t=>r.createElement(se.Z,D()({style:m.buttonStyle,disabled:s},(0,Se.Z)(e,t)),p.label,!s&&L.Z.chevronDown(m.chevron)),render:e=>{let t;t=u.isMobile?{menuType:ye.og.ActionSheet}:{menuType:ye.og.Popup,minWidth:150};const i=[{key:"options",render:e=>r.createElement(_e.Z,e),items:o.map((t=>({key:t.option.toString(),render:e=>r.createElement(be.Z,D()({},e,{title:t.label,caption:t.caption,checkState:n===t.option})),action:()=>{t.action(),e.close()}})))}];return r.createElement(we.Z,t,a()(Ce.Z,{type:Ce.i.Vertical,initialFocus:void 0,sections:i}))}}))})):null}function xe(e){let{teamStore:t}=e;window.__c={n:"TeamSettingsSecurity"};const{currentSpaceStore:i}=(0,d.Kw)(S.default),n=(0,l.O7)(),o=(0,oe.D)(),s="business",c=n.currentUser.id,u=(0,d.VK)((()=>({disable_public_access:{spaceIsDisabled:(null==i?void 0:i.getDisablePublicAccess())??!1,teamIsDisabled:t.getDisablePublicAccess()},disable_export:{spaceIsDisabled:(null==i?void 0:i.getDisableExport())??!1,teamIsDisabled:t.getDisableExport()},disable_guests:{spaceIsDisabled:(null==i?void 0:i.getDisableGuests())??!1,teamIsDisabled:t.getDisableGuests()},disable_team_page_edits:{spaceIsDisabled:void 0,teamIsDisabled:t.getDisableTeamPageEdits()}})),[i,t]),m=(0,y.ql)(t),g=(0,d.VK)((()=>(null==i?void 0:i.canAdmin())??!1),[i]);if(!i)return null;if(!c)return null;const h=e=>o&&!u[e].teamIsDisabled,f=e=>{if(h(e))return!1;if(!m)return!1;return!(e=>u[e].spaceIsDisabled&&u[e].teamIsDisabled)(e)||g},v=e=>h(e)&&g,b=e=>{const{teamIsDisabled:i,spaceIsDisabled:a}=u[e],o=!i;O.d({environment:n,store:t,settingName:e,newTeamSettingValue:Be(o),spaceSettingValue:void 0===a?void 0:Be(a)})},M=e=>{if((e=>u[e].spaceIsDisabled)(e))return(e=>u[e].teamIsDisabled)(e)?a()(p.FormattedMessage,{id:"teamSettingsSecurity.basedOnWorkspaceSettings",defaultMessage:"Based on <underline>workspace settings</underline>",values:{underline:e=>a()("span",{style:{textDecoration:"underline"}},void 0,e)}}):a()(p.FormattedMessage,{id:"teamSettingsSecurity.overridesWorkspaceSettings",defaultMessage:"Overriding <underline>workspace setting</underline>",values:{underline:e=>a()("span",{style:{textDecoration:"underline"}},void 0,e)}})},w=a()(re.Z,{subscriptionTier:s,analyticsName:"team_security_settings",desktopStyle:{display:"inline-block",marginLeft:8,marginTop:-3}}),C=a()(p.FormattedMessage,{id:"teamSettingsSecurity.setting.businessGateToggleTooltip",defaultMessage:"Upgrade to Business Plan to change security settings"}),_=[a()(ni,{on:u.disable_public_access.teamIsDisabled,disabled:!f("disable_public_access"),onChange:()=>b("disable_public_access"),shouldTriggerUpsell:v("disable_public_access"),secondCaption:M("disable_public_access"),title:r.createElement(r.Fragment,null,a()(p.FormattedMessage,{id:"teamSettingsSecurity.setting.shareTitle",defaultMessage:"Disable public page sharing"}),h("disable_public_access")&&w),tooltip:h("disable_public_access")&&C}),a()(ni,{on:u.disable_guests.teamIsDisabled,disabled:!f("disable_guests"),onChange:()=>b("disable_guests"),shouldTriggerUpsell:v("disable_guests"),secondCaption:M("disable_guests"),title:r.createElement(r.Fragment,null,a()(p.FormattedMessage,{id:"teamSettingsSecurity.setting.guestTitle",defaultMessage:"Disable guests"}),h("disable_guests")&&w),tooltip:h("disable_guests")&&C}),a()(ni,{on:u.disable_export.teamIsDisabled,disabled:!f("disable_export"),onChange:()=>b("disable_export"),shouldTriggerUpsell:v("disable_export"),secondCaption:M("disable_export"),title:r.createElement(r.Fragment,null,a()(p.FormattedMessage,{id:"teamSettingsSecurity.setting.exportTitle",defaultMessage:"Disable export"}),h("disable_export")&&w),tooltip:h("disable_export")&&C})];return a()(Fe,{teamStore:t,toggles:_})}function Fe(e){let{teamStore:t,toggles:i}=e;window.__c={n:"TeamsSettingsSecurity"};const n=(0,c.yK)((e=>({learnMoreLinkContainer:{marginTop:15,marginBottom:15},spacer:{height:20,width:"100%"}})),[]),o=a()(p.FormattedMessage,{id:"TeamSettingsSecurity.pageSettingsTitle",defaultMessage:"Page Security"});return r.createElement(r.Fragment,null,a()(ke,{teamStore:t}),a()("div",{style:n.spacer}),a()(X.Ph,{title:o,rows:i,hideDividers:!0}),a()(Y.Z,{helpCenterLocation:"settingsAndPermissions",analyticsFrom:"teams_learn_more_team_settings_security",containerStyle:n.learnMoreLinkContainer,message:a()(p.FormattedMessage,{id:"teamSettingsSecurity.learnMore",defaultMessage:"Learn about teamspace security"})}))}function Ae(e){window.__c={n:"RestoreTeamButton"};const t=(0,l.O7)();return r.createElement(r.Fragment,null,a()(se.Z,{style:e.style,icon:e=>L.Z.archive({...e,margin:"2px 17px 2px 2px",width:16,height:16}),onClick:()=>(e=>{let{teamStore:i,teamName:n}=e;return O.YH({environment:t,teamStore:i,teamName:n,from:"sidebar_team_modal"})})({teamName:e.teamName,teamStore:e.teamStoreInstance})},void 0,a()("div",{},void 0,a()(P.Z,{},void 0,a()(p.FormattedMessage,{id:"sidebarTeamModalSettingsScreen.dangerZone.restoreTeamButton",defaultMessage:"Restore teamspace"})),a()(P.Z,{isSmall:!0,style:{whiteSpace:"normal"}},void 0,a()(p.FormattedMessage,{id:"sidebarTeamModalSettingsScreen.dangerZone.restoreTeamCaption",defaultMessage:"Restoring this teamspace will add it to the sidebar for all teamspace members that were previously added."})))))}function Ee(e){window.__c={n:"ArchiveTeamButton"};const t=(0,l.O7)(),i=(0,c.yK)((()=>({archiveLabel:{color:R.ZP.red}})),[]);return r.createElement(se.Z,D()({style:e.style,isRed:!0,icon:e=>L.Z.archive({...e,margin:"2px 17px 2px 2px",width:16,height:16}),disabled:e.disabled,disabledFeedback:e.disabled,onClick:()=>e.disabled?void 0:async function(e){let{teamStore:t,environment:i}=e;await O.aQ({environment:i,teamStore:t,from:"sidebar_team_modal"})}({environment:t,teamStore:e.teamStoreInstance})},e.tooltipEvents),a()("div",{},void 0,a()(P.Z,{style:i.archiveLabel},void 0,a()(p.FormattedMessage,{id:"teamSettingsSecurity.dangerZone.archiveTeamButton",defaultMessage:"Archive teamspace"})),a()(P.Z,{isSmall:!0,style:{whiteSpace:"normal"}},void 0,a()(p.FormattedMessage,{id:"sidebarTeamModalSettingsScreen.dangerZone.archiveTeamDescription",defaultMessage:"Removes teamspace from the sidebar for all members"}))))}function Be(e){return e?"disable":"allow"}const De=(0,p.defineMessages)({noDescription:{id:"TeamSettingsGeneral.generalSettings.noDescription",defaultMessage:"No description"}});function Re(e){let{teamStore:t}=e;window.__c={n:"TeamSettingsGeneral"};const i=(0,l.O7)(),n=(0,d.VK)((()=>S.default.state.currentSpaceStore),[]),o=(0,y.TE)(t),[s,u]=(0,r.useState)(void 0),[m,g]=(0,r.useState)(void 0),h=(0,c.yK)((()=>({container:{maxWidth:"none",marginLeft:4},nameAndIconWrap:{display:"flex",alignItems:"center",marginBottom:0,marginTop:4},icon:{marginRight:7},name:{height:20,background:"none",boxShadow:"none",padding:"0 8px"},description:{minHeight:20,background:"none",boxShadow:"none",padding:"0 8px",margin:"0 -8px"},updateButton:{marginTop:14},learnMoreLinkContainer:{marginTop:15,marginBottom:15}})),[20]),[f,v]=(0,d.VK)((()=>[t.getName(),t.getDescription()]),[t]);if(void 0===f)return null;const b=f||"",M=v??"",w=M.length>0,C=null==s?void 0:s.trim(),_=null==m?void 0:m.trim(),k=""===C||(void 0===m||_===M.trim())&&(void 0===s||C===b.trim()),T=a()(p.FormattedMessage,{id:"TeamSettingsGeneral.generalSettings.iconAndName.title",defaultMessage:"Icon and name"}),I=a()("div",{style:h.nameAndIconWrap},void 0,a()($.p,{disabled:o,store:t,style:h.icon,size:20,onChange:e=>{V.createAndCommit({userAction:"TeamSettingsGeneral.updateIcon",environment:i,perform:i=>{O.fs({store:t,update:{icon:e},transaction:i})}})}}),o?a()(P.Z,{},void 0,b):a()(Le,{value:s??b,style:h.name,onBlur:e=>{u(e)},onChange:e=>{u(e)},disabled:o,placeholder:"Acme Labs"})),Z=a()(p.FormattedMessage,{id:"TeamSettingsGeneral.generalSettings.description.title",defaultMessage:"Description"}),x=U.default.formatMessage(De.noDescription),F=o?a()(P.Z,{isMultiline:!0,isSecondaryColor:!w},void 0,w?M:x):a()(Le,{value:void 0===m?M:m,onBlur:e=>{g(e)},onChange:e=>{g(e)},disabled:o,textarea:!0,autosize:!0,placeholder:x,style:h.description}),A=[r.createElement(r.Fragment,null,a()(P.Z,{isSmall:!0},void 0,T),I),r.createElement(r.Fragment,null,a()(P.Z,{isSmall:!0},void 0,Z),F)];return a()("div",{style:h.container},void 0,a()(X.Ph,{title:a()(p.FormattedMessage,{id:"TeamSettingsGeneral.generalSettings.details",defaultMessage:"Details"}),rows:A}),!o&&a()(q.Z,{style:h.updateButton,disabled:k,isLarge:!0,onClick:async()=>{if(k)return;if(C&&C!==b.trim()){if(!(await(0,W.Xg)({environment:i,spaceStore:n,teamName:C})))return}const{performResult:e,serverCommitResult:o}=V.createAndCommit({userAction:"TeamSettingsGeneral.updateNameAndDescription",environment:i,perform:e=>{O.fs({store:t,update:{name:C??b,description:_??M},transaction:e})}});try{await Promise.all([e,o])}catch(s){return}N.oV({label:a()(p.FormattedMessage,{id:"TeamSettingsGeneral.settingsChanged",defaultMessage:"Updated teamspace details"})})}},void 0,a()(p.FormattedMessage,{id:"teamsWorkspaceSettings.updateButton.label",defaultMessage:"Update"})),a()("br",{}),a()(ne,{teamStore:t}),a()(Ne,{teamStore:t}),a()(Y.Z,{helpCenterLocation:"bestPractices",analyticsFrom:"teams_learn_more_team_settings_general",containerStyle:h.learnMoreLinkContainer}))}function Le(e){window.__c={n:"EditableInput"};const{value:t,style:i,onBlur:n,onChange:o,placeholder:s,disabled:l}=e,[d,c]=(0,r.useState)(!1),u=(0,r.useRef)(null);return a()(H.Z,{capture:d,render:a=>r.createElement(j.Z,D()({textarea:e.textarea,autosize:e.autosize,ref:u,onFocus:e=>{c(!0)},onBlur:e=>{c(!1),n(e.target.value)},onChange:e=>{c(!1),o&&o(e.target.value)},onSubmit:e=>{e.target.blur()},placeholder:s,disabled:l,value:t,style:i},a))})}function Ne(e){let{teamStore:t}=e;window.__c={n:"MaybeDangerZone"};const i=(0,c.yK)((()=>({buttonStyle:{alignItems:"center",height:"auto",width:"100%",paddingTop:X.MQ,paddingBottom:X.MQ,paddingLeft:X.oM,paddingRight:X.oM}})),[]),[n,o]=(0,d.VK)((()=>[t.getName(),t.isArchived()]),[t]),s=(0,d.VK)((()=>S.default.state.currentSpaceStore),[]),l=(0,y.ql)(t),u=(0,y.e4)(t),m=(0,z.y)(t.id),g=(0,K.n)(s),h=m&&!g;if(void 0===n||!u)return null;const f=[],v=a()(Q.Z,{buttonInternals:a()(Oe,{isTeamOwner:l}),teamStore:t,placement:G.u.Bottom,alignment:G.v.Start,from:"sidebar_team_modal",style:i.buttonStyle,icon:e=>L.Z.leaveArrow({...e,margin:"2px 17px 2px 2px",width:16,height:16}),isRed:!l});if(f.push(v),l)if(o)f.push(a()(Ae,{teamStoreInstance:t,teamName:n,style:i.buttonStyle}));else{const e=a()(I.Z,{disableTooltip:!h,placement:G.u.Bottom,alignment:G.v.Start,renderTooltip:()=>a()(p.FormattedMessage,{id:"sidebarTeamModalSettingsScreen.dangerZone.cannotArchive",defaultMessage:"Cannot archive this teamspace because it is the only default teamspace in this workspace."}),render:e=>a()(Ee,{disabled:h,teamStoreInstance:t,tooltipEvents:e,style:i.buttonStyle})});f.push(e)}return r.createElement(r.Fragment,null,a()("div",{style:{height:20,width:"100%"}}),a()(X.Ph,{title:a()(p.FormattedMessage,{id:"sidebarTeamModalSettingsScreen.dangerZone.title",defaultMessage:"Danger zone"}),rows:f,itemStyle:{padding:0,margin:0}}))}function Oe(e){let{isTeamOwner:t}=e;window.__c={n:"LeaveTeamButton"};const i=(0,c.yK)((()=>({label:{color:t?"inherit":R.ZP.red}})),[t]);return a()("div",{},void 0,a()(P.Z,{style:i.label},void 0,a()(p.FormattedMessage,{id:"teamBrowser.teamCard.button.leaveTeam",defaultMessage:"Leave teamspace"})),a()(P.Z,{isSmall:!0,style:{whiteSpace:"normal"}},void 0,a()(p.FormattedMessage,{id:"teamBrowser.teamCard.button.leaveTeamDescription",defaultMessage:"Removes teamspace from your sidebar"})))}var Ve=i(77907),Ue=i(33052),We=i(30688);function Ke(e){let{teamStore:t}=e;window.__c={n:"TeamFilterAndAddMemberRow"};const i=(0,c.yK)((e=>({container:{display:"flex",justifyContent:"space-between",alignItems:"center",position:"sticky",top:0,background:e.modalBackground,zIndex:10,paddingBottom:8},input:{boxShadow:e.inputBoxShadow,borderRadius:100,fontSize:12,width:"45%",maxWidth:260,marginRight:2},searchIcon:{width:14,height:14,marginRight:6,flexGrow:0,flexShrink:0,fill:e.mediumIconColor}})),[]),n=(0,p.useIntl)(),[o,s]=(0,d.AF)(M.Z),[l,u,m]=(0,d.AF)(void 0,Ue.Z),g=(0,y.ef)(t),h=(0,d.VK)((()=>(0,ve.s$)()&&!v.U2(t)),[t]);return a()("div",{style:i.container},void 0,a()("div",{},void 0,a()(Ve.LazyTeamPermissionsInviteWithModal,{store:t,permissionsInviteStore:m,origin:a()(I.Z,{placement:I.Z.Placement.Left,alignment:I.Z.Alignment.Start,textWrap:!0,renderTooltip:()=>g?a()("div",{style:{width:"max-content",maxWidth:150}},void 0,a()(p.FormattedMessage,{id:"teamPermissionsInviteWithModal.addMembers.tooltip",defaultMessage:"Add members and groups"})):a()("div",{style:{width:220}},void 0,a()(p.FormattedMessage,{id:"teamPermissionsInviteWithModal.addMembersNoPermissions.tooltip",defaultMessage:"You do not have permissions to add members to this teamspace"})),render:e=>r.createElement(q.Z,D()({disabled:!g,isLarge:!0,onClick:()=>{u({...l,modalOpen:!0})}},e),a()(p.FormattedMessage,{id:"teamPermissionsInviteWithModal.openModal",defaultMessage:"Add members"}))})}),h&&a()(We.u,{store:t,isSmall:!0})),a()(j.Z,{placeholder:n.formatMessage({id:"teamPermissionsInviteWithModal.filterGroupsAndMembersInput.placeholder",defaultMessage:"Search for members or groups…"}),style:i.input,value:o.memberFilterQuery,onChange:e=>{s({...o,memberFilterQuery:e.target.value,limitMembers:!0})},left:L.Z.search(i.searchIcon),showClearButton:!0,format:j.Z.Format.Small}))}var ze=i(58573),Ge=i(59054),qe=i(31299),He=i(62385),je=i(90468),Qe=i(64684),Ye=i(7928),$e=i(67669),Xe=i(86125),Je=i(12793),et=i(31278),tt=i(45653),it=i(25735),nt=(i(21703),i(47307)),at=i(61766),ot=i(31194),st=i(61519),rt=i(29369),lt=i(7567);function dt(e){window.__c={n:"TeamMemberPermissionRoleSelect"};const{teamStore:t,memberInfo:i,permissionItem:n,memberName:o,style:s,onMenuItemClicked:u,isPermissionOverridden:m}=e,g=(0,l.O7)(),h=(0,p.useIntl)(),f=(0,c.Fg)(),v=(0,r.useMemo)((()=>new at.Z),[]),y=(0,c.yK)((e=>({header:{display:"flex",flexDirection:"column",backgroundColor:e.sidebarSecondaryBackground,fontSize:12,color:e.mediumTextColor,alignItems:"flex-start",paddingTop:10,paddingLeft:12,paddingRight:12,paddingBottom:10},overrideTitle:{display:"flex",alignItems:"center",justifyContent:"space-between",height:28},overrideLabel:{paddingLeft:8,color:e.mediumTextColor}})),[]),b=(0,d.VK)((()=>t.getTeamPermission()),[t]),M=(0,d.VK)((()=>{if(null==t||!t.isDefined())return;const e=h.formatMessage({id:"teamMemberPermissionRoleSelect.member.permissionitem.description",defaultMessage:"You can't give less access than the teamspace default. Lower teamspace members‘ access to enable this option."}),i=a()(p.FormattedMessage,{id:"teamMemberPermissionRoleSelect.permissionItem.defaultTag",defaultMessage:"default"});function n(i){return(0,Qe.bk)({teamValue:{id:t.id,permissions:t.getPermissionItems()},permissionRole:i})?{isDisabled:!0,disabledMessage:e}:void 0}return["editor","read_and_write","comment_only","reader"].map((e=>({role:e,disabledInfo:n(e),tag:(null==b?void 0:b.role)===e?i:void 0})))}),[b,h,t]);const w=(0,d.VK)((()=>S.default.state.currentSpaceStore),[]),C=(0,d.VK)((()=>!("enterprise"===(null==w?void 0:w.getSubscriptionTier()))&&!m),[w,m]),_=a()("div",{style:y.overrideTitle},void 0,a()(p.FormattedMessage,{id:"TeamMemberOwnerSelect.permissionsOverride",defaultMessage:"Custom permissions"}),C?a()(re.Z,{subscriptionTier:"enterprise",analyticsName:"team_member_permission_override",desktopStyle:{marginLeft:8,marginRight:12}}):a()(lt.ZP,{role:"owner"===i.type?"none":n.role,table:rt.e0,type:"user"===i.entity_type?"user_permission":"group_permission",upgradeButtonName:"user"===i.entity_type?"user_permission_item":"group_permission_item",buttonStyle:{marginRight:0,fontSize:12,color:f.mediumTextColor,visibility:m?void 0:"hidden"},availableRoleItems:M,header:a()(P.Z,{isSmall:!0,isSecondaryColor:!0,style:{fontWeight:600,marginLeft:16,marginTop:8}},void 0,a()(p.FormattedMessage,{id:"teamMemberPermissionRoleSelect.permissionOverride.menuHeader",defaultMessage:"Select custom role"})),onChange:e=>{"none"!==e&&(!function(e){nt.showDialog({message:a()(p.FormattedMessage,{id:"teamMemberPermissionSettings.permissionSwitcher.confirmation.message",defaultMessage:"Are you sure you want to change {name}'s role to {role}?",values:{name:o,role:(0,$e.r_)(e).toLowerCase()}}),description:a()(p.FormattedMessage,{id:"teamMemberPermissionSettings.permissionSwitcher.confirmation.description",defaultMessage:"This change won't apply to any restricted pages in the teamspace."}),showCancel:!0,keepFocus:!1,handleCancel:nt.dismissDialog,items:[{label:a()(p.FormattedMessage,{id:"teamMemberPermissionSettings.permissionSwitcher.accept",defaultMessage:"Change access"}),color:"red",onAccept:async()=>{const{serverCommitResult:n}=V.createAndCommit({userAction:"TeamMemberPermissionRoleSelect.handleRoleSelect",environment:g,perform:n=>{O.jg({memberInfo:i,teamStore:t,transaction:n,environment:g,permissionRole:e})}});await n,t.isDefault()&&(t.getMembershipDefinedOnTeam().some((e=>(0,Qe.ah)(e,i)))||await O.Uj({environment:g,teamStore:t,teamMemberInfos:[i],isSettingDefaultTeam:!0,createNewTeamFlowId:void 0}))}}]})}(e),u&&u())},buttonPopupStore:v,placementToOrigin:ot.Iw.Right,alignmentToOrigin:ot.lU.End}));return a()(I.Z,{placement:I.Z.Placement.Left,textWrap:!0,renderTooltip:()=>a()(p.FormattedMessage,{id:"teamMemberPermissionRoleSelect.permissionOverride.buttonTooltip",defaultMessage:"Set a custom permission level for all pages in this teamspace"}),render:e=>r.createElement(be.Z,D()({},e,{focused:!1,style:s,textWrapperStyle:{marginRight:0},disabled:C,onClick:()=>v.setState({open:!0}),title:_,icon:m?a()("div",{style:{marginTop:8}},void 0,L.Z.check({width:14})):void 0}))})}function ct(e){let{teamStore:t,memberInfo:i,permissionItem:n,memberName:o,isPermissionOverridden:s,disabled:c}=e;window.__c={n:"TeamMemberOwnerSelect"};const m=(0,d.qz)(void 0,at.Z),[g,h]=(0,d.AF)(m),f=(0,l.O7)(),y=(0,d.VK)((()=>S.default.state.currentSpaceStore),[]),b=(0,d.VK)((()=>S.default.state.currentUserStore),[]),M=(0,d.VK)((()=>{const e=null==b?void 0:b.userId;return"user"===i.entity_type&&i.user_id===e}),[null==b?void 0:b.userId,i]),w=()=>h({...g,open:!1}),C=async e=>{w();const n=a()(p.FormattedMessage,"owner"===e?{defaultMessage:"owner",id:"teamMemberPermissionSettings.upgradeGuestConfirmation.roleLabelOwner"}:{defaultMessage:"member",id:"teamMemberPermissionSettings.upgradeGuestConfirmation.roleLabelMember"});if("team_level_guest"!==i.type||"owner"!==e&&"member"!==e)if("owner"===e){if("user"===i.entity_type){const{serverCommitResult:e}=V.createAndCommit({userAction:"TeamMemberOwnerSelect.handleOwnerMenuItemClicked",environment:f,perform:e=>{O.W8({environment:f,userId:i.user_id,teamStore:t,transaction:e})}});await e}}else M?nt.showDialog({message:a()(p.FormattedMessage,{id:"teamMemberPermissionSettings.removeSelfTeamOwner.confirmation.message",defaultMessage:"Are you sure you want to remove yourself as a teamspace owner? You'll no longer be able to edit teamspace settings and permissions."}),showCancel:!0,keepFocus:!1,handleCancel:nt.dismissDialog,items:[{label:a()(p.FormattedMessage,{id:"teamMemberPermissionSettings.permissionSwitcher.accept",defaultMessage:"Change access"}),color:"red",onAccept:_}]}):await _();else{const o=(0,v.Mf)(i.user_id).length;nt.showDialog({message:r.createElement(r.Fragment,null,a()(p.FormattedMessage,o>1?{id:"teamMemberPermissionSettings.upgradeGuestConfirmationWithOtherTeamspaces.message",defaultMessage:"Are you sure you want to upgrade this user to a teamspace {memberOrOwner}? They will also be added to the workspace as a member, and they will become a member in {numberOfOtherTeams, plural, one {{numberOfOtherTeams} other teamspace} other {{numberOfOtherTeams} other teamspaces}}.",values:{memberOrOwner:n,numberOfOtherTeams:o-1}}:{id:"teamMemberPermissionSettings.upgradeGuestConfirmation.message",defaultMessage:"Are you sure you want to upgrade this user to a teamspace {memberOrOwner}? They will also be added to the workspace as a member.",values:{memberOrOwner:n}})),showCancel:!0,keepFocus:!1,handleCancel:nt.dismissDialog,items:[{label:a()(p.FormattedMessage,{id:"teamMemberPermissionSettings.upgradeGuestConfirmation.accept",defaultMessage:"Add to workspace"}),color:"blue",onAccept:async()=>{if(y){const{serverCommitResult:n}=V.createAndCommit({userAction:"TeamMemberOwnerSelect.handleOwnerMenuItemClicked",environment:f,perform:n=>{O.Ce({environment:f,userId:i.user_id,teamStore:t,transaction:n,spaceStore:y,newTeamRole:e})}});await n}}}]})}},_=async()=>{if("owner"===i.type&&"user"===i.entity_type){const{serverCommitResult:e}=V.createAndCommit({userAction:"TeamMemberOwnerSelect.handleSetMemberAccept",environment:f,perform:e=>{O.mX({userId:i.user_id,teamStore:t,transaction:e,environment:f})}});await e}else if("member"===i.type){const{serverCommitResult:e}=V.createAndCommit({userAction:"TeamMemberOwnerSelect.handleSetMemberAccept",environment:f,perform:e=>{O.X0({environment:f,memberInfo:i,teamStore:t,transaction:e})}});await e}},k=async()=>{const{entity_type:e}=i;switch(w(),e){case"group":const n=(0,J.TC)({spaceStore:y,groupId:i.group_id});if(!n)throw new Error("Permission group not found in space.");O.mN({environment:f,teamStore:t,group:n});break;case"user":await O.WO({environment:f,teamStore:t,currentSpaceStore:y,userId:i.user_id,from:"team_settings_member_table"});break;default:(0,u.t1)(e)}};return a()(Me.ZP,{buttonPopupStore:m,placementToOrigin:ot.Iw.Bottom,renderOrigin:e=>a()(mt,{buttonPopupEvents:e,isPermissionOverridden:s,permissionItem:n,memberInfo:i,disabled:c}),render:()=>a()(ut,{teamStore:t,isPermissionOverridden:s,memberInfo:i,permissionItem:n,memberName:o,onMenuItemClicked:C,onRemoveClicked:k,onSubMenuItemClicked:w}),popupType:Me.Z4.Popup})}function ut(e){let{teamStore:t,isPermissionOverridden:i,memberInfo:n,permissionItem:o,memberName:l,onRemoveClicked:u,onMenuItemClicked:g,onSubMenuItemClicked:h}=e;window.__c={n:"OwnerMemberMenuList"};const y=(0,d.VK)((()=>{const{currentSpaceStore:e}=S.default.state;return!Boolean(null==e?void 0:e.getSettingsStore().getKeyStore("disable_team_guests").getValue())&&(0,ve.F$)()}),[]),b=(0,d.VK)((()=>t.isDefault()),[t]),M=(0,d.VK)((()=>(0,v.Hu)({membership:t.getKeyStore("membership").getValue()})),[t]),w=(0,d.VK)((()=>1===t.getMembers().filter((e=>"owner"===e.type)).length),[t]),C=(0,c.yK)((e=>{const t={paddingTop:5,paddingBottom:5},i={...t,width:280,alignItems:"flex-start"};return{actionMenu:{marginTop:-4},removeButton:{...t,color:e.errorText},menuItem:i,indentedMenuItem:{...i,paddingLeft:20},overrideLabel:{paddingLeft:10,color:e.mediumTextColor,fontSize:12,fontWeight:m.Z.fontWeight.regular}}}),[]),_=(e,t)=>{const n=("owner"===e||"team_level_guest"===e)&&"group"===t.entity_type,s="member"===e&&"owner"===t.type&&w,l="team_level_guest"===e&&("owner"===t.type||"member"===t.type),d=n||s||l;return{key:e,action:()=>g(e),render:c=>{const u=!i&&t.type===e;return a()(I.Z,{disableTooltip:!d,placement:I.Z.Placement.Right,textWrap:!0,renderTooltip:()=>n?a()(p.FormattedMessage,"owner"===e?{id:"TeamMemberOwnerSelect.memberItem.disableOwnerForGroupsTooltip",defaultMessage:"Groups can't be teamspace owners"}:{id:"TeamMemberOwnerSelect.memberItem.disableTeamGuestForGroupsTooltip",defaultMessage:"Groups can't be teamspace guests"}):s?a()(p.FormattedMessage,{id:"TeamMemberOwnerSelect.memberItem.disableWithOnlyOneOwnerTooltip",defaultMessage:"Add another teamspace owner to downgrade yourself to member"}):l?a()(p.FormattedMessage,{id:"TeamMemberOwnerSelect.memberItem.disableDowngradeToGuestTooltip",defaultMessage:"To change this user to a teamspace guest, first remove them from the workspace."}):void 0,render:t=>r.createElement("span",t,r.createElement(be.Z,D()({},c,{style:u?C.menuItem:C.indentedMenuItem,disabled:d,disabledFeedback:d,title:a()(pt,{isPermissionOverridden:i,type:e,permissionItem:o}),caption:ht(e),shouldWrapCaption:!0,icon:u?L.Z.check({width:14}):void 0})))})}}},k=b&&"user"===n.entity_type,T="group"!==n.entity_type,P="group"!==n.entity_type&&y,Z=[{key:"teamRoles",items:s().compact([T?_("owner",n):void 0,_("member",n),P?_("team_level_guest",n):void 0,ft({onRemoveClicked:u,styles:C,isMemberInDefaultTeam:k}),..."owner"===n.type||M?[]:[{key:"divider",action:()=>{},render:()=>a()(st.Z,{size:10})},{key:"permissions_override",action:()=>{},render:e=>r.createElement("span",e,a()(dt,{teamStore:t,memberInfo:n,permissionItem:o,memberName:l,onMenuItemClicked:h,isPermissionOverridden:i,style:i?C.menuItem:C.indentedMenuItem}))}]]),render:e=>r.createElement(_e.Z,D()({},e,{topBorder:0!==e.index}))}];return a()(we.Z,{className:f.a6i,menuType:ye.og.Popup},void 0,a()(Ce.Z,{type:Ce.i.Vertical,initialFocus:void 0,sections:Z}))}function mt(e){let{buttonPopupEvents:t,disabled:i,isPermissionOverridden:n,permissionItem:o,memberInfo:s}=e;window.__c={n:"SelectButton"};const l=(0,c.yK)((e=>({label:{color:e.regularTextColor,fontSize:12.5,fontWeight:m.Z.fontWeight.regular},overrideLabel:{color:e.mediumTextColor,fontSize:12,fontWeight:m.Z.fontWeight.regular},chevron:{width:10,marginLeft:4,fill:e.lightIconColor}})),[]),d=function(e,t,i){if(t&&i)return function(e){switch(e){case"none":return a()(p.FormattedMessage,{id:"TeamMemberOwnerSelect.roleName.none",defaultMessage:"No access"});case"reader":return a()(p.FormattedMessage,{id:"TeamMemberOwnerSelect.roleName.reader",defaultMessage:"Can view"});case"comment_only":return a()(p.FormattedMessage,{id:"TeamMemberOwnerSelect.roleName.comment_only",defaultMessage:"Can comment"});case"content_only_editor":return a()(p.FormattedMessage,{id:"TeamMemberOwnerSelect.roleName.content_only_editor",defaultMessage:"Can edit content"});case"membership_admin":case"read_and_write":return a()(p.FormattedMessage,{id:"TeamMemberOwnerSelect.roleName.read_and_write",defaultMessage:"Can edit"});case"editor":return a()(p.FormattedMessage,{id:"TeamMemberOwnerSelect.roleName.editor",defaultMessage:"Full access"});default:(0,u.t1)(e)}}(i);return gt(e)}(s.type,n,o.role);return r.createElement(se.Z,D()({disabled:i},t),n&&a()("span",{style:l.overrideLabel},void 0,a()(p.FormattedMessage,{id:"TeamMemberOwnerSelect.roleName.custom",defaultMessage:"Custom"}),a()("span",{style:{marginLeft:5,marginRight:5}},void 0,"•")),a()("span",{style:l.label},void 0,d),!i&&L.Z.chevronDown(l.chevron))}function pt(e){let{isPermissionOverridden:t,permissionItem:i,type:n}=e;const o=gt(n);return a()("div",{},void 0,a()("span",{},void 0,o))}function gt(e){switch(e){case"owner":case"member":case"team_level_guest":return r.createElement(p.FormattedMessage,v.q9[e].label);case"none":return;default:(0,u.t1)(e)}}function ht(e){switch(e){case"owner":case"member":case"team_level_guest":return r.createElement(p.FormattedMessage,v.q9[e].caption);case"none":return;default:(0,u.t1)(e)}}function ft(e){let{styles:t,onRemoveClicked:i,isMemberInDefaultTeam:n}=e;const o=n?a()(p.FormattedMessage,{id:"TeamMemberOwnerSelect.remove.disabledTooltip.cannotRemoveFromDefault",defaultMessage:"Members cannot be removed from a default teamspace."}):void 0;return{key:"remove",action:i,render:e=>a()(I.Z,{disableTooltip:!o,placement:I.Z.Placement.Right,textWrap:!1,renderTooltip:()=>o,render:i=>r.createElement("span",i,r.createElement(be.Z,D()({},e,{style:{...t.removeButton,...t.indentedMenuItem},disabled:Boolean(o),disabledFeedback:!0,title:a()(p.FormattedMessage,{id:"TeamMemberOwnerSelect.remove",defaultMessage:"Remove"})})))})}}var vt=i(13380);function yt(e){window.__c={n:"TeamPermissionRowAvatar"};const{icon:t,label:i,name:n,tag:o,style:s}=e,r=(0,c.yK)((e=>({container:{display:"flex",flexDirection:"row",alignItems:"center",gap:10,...s},labelContainer:{display:"flex",flexDirection:"column",...m.Z.textOverflowStyle,marginLeft:5},name:{minWidth:30},nameContainer:{display:"flex",flexDirection:"row",alignItems:"center"}})),[s]);return a()("div",{style:r.container},void 0,t,a()("div",{style:r.labelContainer},void 0,a()("div",{style:r.nameContainer},void 0,a()(vt.s,{style:r.name},void 0,n),o),i&&a()(P.Z,{isSmall:!0,isSecondaryColor:!1,isMultiline:!0},void 0,a()(vt.s,{},void 0,i))))}function St(e){window.__c={n:"TeamPermissionRowItem"};const{iconComponent:t,label:i,name:n,permissionRoleSelectComponent:o,tag:s,tooltip:l,style:d}=e,u=(0,c.yK)((e=>({permissionRow:{display:"flex",flexDirection:"row",lineHeight:1.2,fontSize:14,width:"100%",minHeight:36,justifyContent:"space-between",alignItems:"center",...d}})),[d]);return a()("div",{style:u.permissionRow},void 0,a()(yt,{icon:t,name:n,tag:s,label:i,style:{minWidth:200,marginRight:6}}),a()(I.Z,{textWrap:!0,style:{width:210},disableTooltip:!l,placement:I.Z.Placement.Left,renderTooltip:()=>l,render:e=>r.createElement("span",e,o)}))}function bt(e){window.__c={n:"SpecificTeamMemberPermissionRow"};const{type:t,store:i,permissionItem:n,memberInfo:o}=e,s=(0,d.VK)((()=>S.default.state.currentSpaceStore),[]),r=(0,p.useIntl)(),m=(0,d.VK)((()=>{switch(t){case"group":return"none";case"user":return null!=s&&s.isDefined()?(0,$e.su)(null==s?void 0:s.getPermissionItems(),e.memberInfo.user_id):"none";default:(0,u.t1)(t)}}),[s,t,e]),g=(0,y.ql)(i),h=(0,d.VK)((()=>{const{currentSpaceStore:e}=S.default.state;return null==e?void 0:e.canEditMembership()}),[]),f=(0,l.O7)(),v=(0,d.VK)((()=>{const e=f.currentUser.id,t=i.getSettingsStore().getValue();return!!(null!=s&&s.isDefined()&&i.isDefined()&&t&&e)&&(0,Qe.W9)({membership:i.getMembers(),settings:t,is_default:i.isDefault()},e,{permissions:s.getPermissionItems(),subscription_tier:s.getSubscriptionTier(),permission_groups:s.getPermissionGroups()})}),[f.currentUser.id,s,i]),b=(0,d.VK)((()=>{const e=i.getPermissionItems()||[];switch(o.entity_type){case"group":return!!e.find((e=>(0,le.hV)(e)&&e.group_id===o.group_id));case"user":return!!e.find((e=>(0,le.jg)(e)&&e.user_id===o.user_id));default:return!1}}),[o,i]),{name:M,label:w,icon:C}=(0,d.VK)((()=>{switch(t){case"group":return wt({permissionGroup:e.permissionGroup,spaceId:null==s?void 0:s.id});case"user":return function(e){let{intl:t,userStore:i}=e;return{name:(0,Ye.Nz)(t,null==i?void 0:i.getModel()),label:null==i?void 0:i.getEmail(),icon:a()(tt.Z,{avatarShouldShowShadow:!0,userStore:i,size:32})}}({intl:r,userStore:e.userStore});default:(0,u.t1)(t)}}),[t,e,r,null==s?void 0:s.id]),_=a()("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"}},void 0,a()(ct,{teamStore:i,memberInfo:o,memberName:M,permissionItem:n,isPermissionOverridden:b,disabled:!g&&!v||"team_level_guest"===o.type&&!h})),k=(0,c.yK)((e=>({row:{minHeight:52},pill:{marginLeft:6,height:17}})),[]);return a()(St,{style:k.row,tag:(0,le.Bc)(m)?a()(Xe.Z,{desktopStyle:k.pill,mobileStyle:k.pill,role:Mt(m)}):"group"===t?a()("div",{style:k.pill},void 0,C):void 0,permissionRoleSelectComponent:_,iconComponent:"group"===t?a()(Je.Z,{size:32}):C,name:M,label:w})}function Mt(e){switch(e){case"editor":return"admin";case"membership_admin":return"membership_admin";default:(0,u.t1)(e)}}function wt(e){let{spaceId:t,permissionGroup:i}=e;const{name:n,user_ids:o,icon:s}=i,l=(null==o?void 0:o.length)??0;return{name:n??a()(p.FormattedMessage,{id:"teamPermissionSettings.unknownGroup",defaultMessage:"Unknown Group"}),label:a()(I.Z,{placement:I.Z.Placement.Bottom,alignment:I.Z.Alignment.Start,disableTooltip:0===l,renderTooltip:()=>a()(it.Y,{group:i,limit:10,noMembersMessage:void 0}),render:e=>r.createElement("div",e,a()(p.FormattedMessage,{id:"teamPermissionSettings.group",defaultMessage:"Group"})," • ",a()(p.FormattedMessage,{id:"teamPermissionSettings.numberOfMembers",defaultMessage:"{groupSize, plural, one {{groupSize} member} other {{groupSize} members}}",values:{groupSize:l}}))}),icon:s&&a()(et.Z,{bucket:"public",disabled:!0,onChange:()=>{},isEmptyPage:!1,title:n,size:18,icon:s&&t?{icon:s,pointer:{table:je.bx,id:t}}:void 0})}}var Ct=i(21325);function _t(e){let{teamStore:t,...i}=e;window.__c={n:"SpecificTeamMemberToAddRow"};const n=(0,l.O7)(),o=(0,d.VK)((()=>{var e;return null===(e=S.default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]),s=(0,p.useIntl)(),u=(0,c.yK)((()=>({container:{display:"flex",flexDirection:"row",lineHeight:1.2,fontSize:14,width:"100%",minHeight:52,justifyContent:"space-between",alignItems:"center"},pill:{marginLeft:6,height:17}})),[]),m=(0,r.useCallback)((e=>{N.oV({label:a()(p.FormattedMessage,{id:"SpecificTeamMemberToAddRow.team_invite_failure",defaultMessage:"Failed to add {userOrGroupName}",values:{userOrGroupName:e}})})}),[]),g=(0,r.useCallback)((async(e,i)=>{await O.Uj({environment:n,teamMemberInfos:[e],teamStore:t,isSettingDefaultTeam:!1,createNewTeamFlowId:void 0})?await Ct.bi(n):m(i)}),[n,m,t]),h=(0,r.useCallback)(((e,t)=>g({type:"member",entity_type:"user",user_id:e.id},t)),[g]),f=(0,r.useCallback)(((e,t)=>g({type:"member",entity_type:"group",group_id:e.id},t)),[g]);if("memberToAdd"in i){const{memberToAdd:e}=i,t=(0,Ye.Nz)(s,e);return a()("div",{style:u.container},void 0,a()(yt,{icon:a()(tt.Z,{userValue:e,size:32}),name:t,label:e.email}),kt((()=>{h(e,t)})))}{if(!o)return r.createElement(r.Fragment,null);const{groupToAdd:e}=i,t=wt({spaceId:o,permissionGroup:e});return a()("div",{style:u.container},void 0,a()(yt,{icon:a()(Je.Z,{size:32}),name:t.name,label:t.label,tag:a()("div",{style:u.pill},void 0,t.icon)}),kt((()=>{f(e,t.name)})))}}const kt=e=>a()(se.Z,{isBlue:!0,onClick:e,icon:L.Z.plus},void 0,a()(p.FormattedMessage,{id:"SpecificTeamMemberToAddRow.addMemberButton.text",defaultMessage:"Add"}));function Tt(e){let{sortType:t,onChangeSortType:i}=e;window.__c={n:"TeamPermissionsListHeader"};const n=(0,c.yK)((e=>({container:{width:"100%",display:"flex",justifyContent:"space-between",borderBottom:`1px solid ${e.regularDividerColor}`}})),[]),o=e=>e===t.column?t.sortedAscending?"ascending":"descending":"none",s=e=>{const n=e===t.column&&!t.sortedAscending;i({column:e,sortedAscending:n})};return r.createElement(r.Fragment,null,a()("div",{style:n.container},void 0,a()(It,{title:a()(p.FormattedMessage,{id:"TeamPermissionsListHeader.nameColumn",defaultMessage:"Name"}),sortedType:o("name"),onClick:()=>s("name")}),a()(It,{title:a()(p.FormattedMessage,{id:"TeamPermissionsListHeader.roleColumn",defaultMessage:"Role"}),sortedType:o("role"),onClick:()=>s("role")})))}function It(e){let{sortedType:t,title:i,onClick:n}=e;window.__c={n:"HeaderLabel"};const o=(0,c.yK)((e=>({button:{color:e.mediumTextColor,fontSize:12,padding:0},buttonHover:{background:"unset"},sortIcon:{width:14,height:14,marginRight:5,fill:e.mediumIconColor}})),[]);return a()(se.Z,{style:o.button,hoveredStyle:o.buttonHover,onClick:n},void 0,"ascending"===t&&L.Z.arrowUp(o.sortIcon),"descending"===t&&L.Z.arrowDown(o.sortIcon),i)}function Pt(e){var t;let{store:i}=e;window.__c={n:"TeamPermissionsList"};const n=(0,l.O7)(),o=(0,c.yK)((e=>({container:{display:"block",overflow:"hidden"},membersHeader:{marginBottom:8},noResult:{fontSize:m.Z.fontSize.UIRegular.desktop,color:e.mediumTextColor,marginTop:8},showMore:{marginBottom:24,width:"max-content"}})),[]),s=(0,p.useIntl)(),[g,h]=(0,r.useState)({column:"role",sortedAscending:!1}),[f]=(0,d.AF)(M.Z),b=(0,y.ef)(i),w=(0,d.VK)((()=>i.getMembers()),[i]),C=(0,d.VK)((()=>S.default.state.currentSpaceStore),[]),_=(0,d.VK)((()=>S.default.state.currentUserStore),[]),{permissionRowInfos:k,numNotShown:T}=(0,d.VK)((()=>{const e=function(e){let{permissionRowInfos:t,memberFilterQuery:i,intl:n}=e;if(""===i)return t;return(0,ze.ZP)(i,t,(e=>{const{type:t}=e;switch(t){case"group":return e.permissionGroup.name??"";case"user":const{userStore:i}=e;return i.getSearchName(n);default:(0,u.t1)(t)}}))}({permissionRowInfos:(0,v.tu)({currentUserStore:_,currentSpaceStore:C,teamStore:i,members:w}),memberFilterQuery:f.memberFilterQuery,intl:s}),t=function(e){let{permissionRowInfos:t,sortType:i,intl:n}=e;const{column:a,sortedAscending:o}=i,s={permissionRowInfos:t,sortedAscending:o};if("role"===a)return function(e){let{permissionRowInfos:t,sortedAscending:i}=e;const n=["owner","member","team_level_guest"],a=["group","user"];return[...t].sort(((e,t)=>{const i=e.memberInfo.entity_type,n=t.memberInfo.entity_type;return a.indexOf(i)-a.indexOf(n)})).sort(((e,t)=>{const a=e.memberInfo.type,o=t.memberInfo.type,s=n.indexOf(a)-n.indexOf(o);return i?-s:s}))}(s);if("name"===a)return function(e){let{permissionRowInfos:t,sortedAscending:i,intl:n}=e;return[...t].sort(((e,t)=>{const a=Zt(e,n)??"",o=Zt(t,n)??"";if(a===o)return 0;const s=a<o?-1:1;return i?-s:s}))}({...s,intl:n});(0,u.t1)(a)}({permissionRowInfos:e,sortType:g,intl:s}),n=f.limitMembers?t.slice(0,50):t;return{permissionRowInfos:n,numNotShown:e.length-n.length}}),[C,_,w,i,g,f.memberFilterQuery,f.limitMembers,s]),[I]=(0,Ge.r5)((async()=>{var e;if(!b||null===(e=f.memberFilterQuery)||void 0===e||!e.trim().length)return[];const t=(await qe.Yu({environment:n,query:f.memberFilterQuery,membersOnly:!0})).map((e=>({type:"user",value:e}))),i=qe.$w({query:f.memberFilterQuery,intl:s}).map((e=>({type:"group",value:e}))),a=new Set(k.map(Ft));return[...t,...i].filter((e=>!a.has(e.value.id))).slice(0,5)}),[b,f.memberFilterQuery,n,s,k]),P=Boolean(null===(t=f.memberFilterQuery)||void 0===t?void 0:t.trim().length),Z=k.length>0,x="resolved"===I.status?I.value:[];return a()("div",{style:o.container},void 0,a()(xt,{title:P?a()(p.FormattedMessage,{id:"TeamPermissionsList.search.inThisTeam",defaultMessage:"In this team"}):a()(Tt,{sortType:g,onChangeSortType:h}),rows:k,renderRow:e=>r.createElement(bt,D()({store:i},e))}),T>0&&a()(He.Z,{style:o.showMore,onClick:()=>{M.Z.setState({...f,limitMembers:!1})}},void 0,a()(p.FormattedMessage,{defaultMessage:"Show {numNotShown} more",id:"teamPermissionSettings.member.showMore",values:{numNotShown:T}})),x.length>0&&a()(xt,{title:a()(p.FormattedMessage,{id:"TeamPermissionsList.search.notInTeam",defaultMessage:"Not in team"}),rows:x,renderRow:e=>"user"===e.type?a()(_t,{teamStore:i,memberToAdd:e.value}):a()(_t,{teamStore:i,groupToAdd:e.value})}),!Z&&0===x.length&&a()("div",{style:o.noResult},void 0,a()(p.FormattedMessage,{id:"TeamPermissionsList.search.zeroState",defaultMessage:"No members or groups found"})))}function Zt(e,t){const{type:i}=e;if("user"===i){const{userStore:i}=e;return i.getDisplayName(t)}if("group"===i){const{permissionGroup:t}=e;return t.name}(0,u.t1)(i)}function xt(e){let{rows:t,renderRow:i,title:n}=e;window.__c={n:"TeamPermissionListInner"};const o=(0,c.yK)((e=>({membersList:{flexGrow:1,flexShrink:1,display:"flex",flexDirection:"column",width:"100%",marginBottom:12},memberDivider:{borderBottom:`1px solid ${e.regularDividerColor}`}})),[]);return t.length?r.createElement(r.Fragment,null,n&&a()(P.Z,{isSmall:!0},void 0,n),a()("div",{style:o.membersList},void 0,t.map(((e,t)=>r.createElement(r.Fragment,null,t>0&&a()("div",{style:o.memberDivider}),i(e)))))):null}function Ft(e){switch(e.type){case"user":return e.memberInfo.user_id;case"group":return e.memberInfo.group_id;default:(0,u.t1)(e)}}function At(e){let{teamStore:t}=e;window.__c={n:"TeamMembersListSection"};const i=(0,c.yK)((()=>({content:{display:"grid",gridAutoFlow:"row",rowGap:6}})),[]);return a()("div",{style:i.content},void 0,a()(Ke,{teamStore:t}),a()(Pt,{store:t}))}var Et=i(79362);function Bt(e){window.__c={n:"TeamGuestsPermissionRow"};const{teamStore:t}=e,i=(0,l.O7)(),n=(0,p.useIntl)(),{teamGuestPermissionItem:o,teamPermissions:s}=(0,d.VK)((()=>({teamGuestPermissionItem:t.getTeamGuestsPermission(),teamPermissions:t.getPermissionItems()||[]})),[t]),r=(0,y.TE)(t),u=(0,d.VK)((()=>[{role:"editor",disabledInfo:{isDisabled:!0,disabledMessage:n.formatMessage({id:"teamPermissionsSettings.teamspace.guest.disabledPermissionitem.description",defaultMessage:"Teamspace guests can't have full access."})}},{role:"read_and_write",disabledInfo:void 0},{role:"comment_only",disabledInfo:void 0},{role:"reader",disabledInfo:void 0}]),[n]),m=(0,c.yK)((e=>({button:{fontSize:12.5,marginRight:0,color:e.mediumTextColor}})),[]),g=o&&a()(lt.ZP,{role:o.role,table:rt.e0,type:"explicit_team_guest_permission",upgradeButtonName:"team_permission_item",disabled:r,buttonStyle:m.button,availableRoleItems:u,onChange:async e=>{if(s.filter((t=>((0,le.jg)(t)||(0,le.hV)(t))&&(0,de.xO)(e,t.role))).length>0){if(!(await(0,W.Bt)()))return}V.createAndCommit({userAction:"TeamGuestsPermissionRow.permissionComponent",environment:i,perform:n=>{O.$J({environment:i,teamStore:t,newRole:e,transaction:n,permissionsToClear:[]})}})}}),h=(0,d.VK)((()=>t.getName()),[t]),f=(0,d.VK)((()=>t.getIcon()),[t]),v=f&&Et.V2(f.icon)?Et.mk(f.icon):"gray",S=f?{...f,icon:`/icons/user-circle_${v}.svg`}:void 0,b=a()($.p,{disabled:!0,store:t,size:X.Kt,icon:S});return g?a()(St,{permissionRoleSelectComponent:g,iconComponent:b,name:Dt(h)}):null}function Dt(e){return a()(p.FormattedMessage,e?{defaultMessage:"Teamspace guests",id:"TeamMembersTopSection.permissionItem.guest.defaultAccessTeamSpaceName",values:{teamName:e}}:{defaultMessage:"Teamspace guests",id:"TeamMembersTopSection.permissionItem.guest.defaultAccessWithoutTeamspaceName"})}function Rt(e){window.__c={n:"TeamMembersPermissionRow"};const{teamStore:t}=e,i=(0,l.O7)(),n=(0,c.Fg)(),o=(0,p.useIntl)(),{teamPermissionItem:s,teamPermissions:r}=(0,d.VK)((()=>({teamPermissionItem:t.getTeamPermission(),teamPermissions:t.getPermissionItems()||[]})),[t]),u=(0,y.TE)(t),m=(0,d.VK)((()=>{var e;const i=null===(e=t.getPermissionItems())||void 0===e?void 0:e.find((e=>"space_permission"===e.type)),n=o.formatMessage({id:"teamPermissionsSettings.teamspace.disabledPermissionitem.description",defaultMessage:"Teamspace members can't have lower permissions than workspace members"});function a(e){return i&&e!==i.role&&(0,de.nl)(e,i.role)===i.role&&!t.isDefault()?{isDisabled:!0,disabledMessage:n}:void 0}return[{role:"editor",disabledInfo:a("editor")},{role:"read_and_write",disabledInfo:a("read_and_write")},{role:"comment_only",disabledInfo:a("comment_only")},{role:"reader",disabledInfo:a("reader")}]}),[o,t]),g=s&&a()(lt.ZP,{role:s.role,table:rt.e0,type:(0,le.zU)(s)?"explicit_team_permission":"team_permission",upgradeButtonName:"team_permission_item",disabled:u,buttonStyle:{fontSize:12.5,marginRight:0,color:n.mediumTextColor},availableRoleItems:m,onChange:async e=>{const n=r.filter((t=>((0,le.jg)(t)||(0,le.hV)(t))&&(0,de.xO)(e,t.role)));if(n.length>0){if(!(await(0,W.Bt)()))return}V.createAndCommit({userAction:"TeamMembersPermissionRow.permissionComponent",environment:i,perform:a=>{O.xI({environment:i,teamStore:t,newRole:e,transaction:a,permissionsToClear:n})}})}}),{teamName:h}=(0,d.VK)((()=>({teamName:t.getName()})),[t]),f=a()($.p,{disabled:!0,store:t,size:X.Kt});return a()(St,{permissionRoleSelectComponent:g,iconComponent:f,name:Lt(h)})}function Lt(e){return a()(p.FormattedMessage,e?{defaultMessage:"Teamspace members",id:"TeamMembersTopSection.permissionItem.defaultAccessTeamSpaceName",values:{teamName:e}}:{defaultMessage:"Teamspace members",id:"TeamMembersTopSection.permissionItem.defaultAccessWithoutTeamspaceName"})}var Nt=i(19889),Ot=i(62512);function Vt(e){window.__c={n:"TeamOwnersPermissionRow"};const{teamStore:t,teamOwnerIds:i}=e,n=(0,c.Fg)(),o=(0,d.VK)((()=>t.getName()),[t]),s=(0,d.VK)((()=>t.getTeamOwnerPermission()),[t]),r=(0,d.VK)((()=>S.default.state.currentUserStore),[]),l=(0,d.VK)((()=>r?i.map((e=>b.U6.createChildStore(r,{table:Nt.KJ,id:e}))):[]),[r,i]);return a()(St,{tooltip:a()(p.FormattedMessage,{id:"TeamOwnersPermissionRow.teamspaceOwnersRowTooltip",defaultMessage:"Teamspace owners have full access to teamspace pages by default"}),permissionRoleSelectComponent:a()(lt.ZP,{role:"editor",table:rt.e0,type:s&&(0,le.LW)(s)?"explicit_team_owner_permission":"team_owner_permission",upgradeButtonName:"team_owner_permission_item",disabled:!0,buttonStyle:{fontSize:12.5,color:n.mediumTextColor,marginRight:0},availableRoleItems:[]}),iconComponent:a()(Ot.n,{teamStore:t,ownerStores:l,isSmall:!0}),name:Ut(o)})}function Ut(e){return a()(p.FormattedMessage,e?{defaultMessage:"Teamspace owners",id:"TeamOwnersPermissionRow.permissionItem.teamspaceOwnersAccessToggleName",values:{teamName:e}}:{defaultMessage:"Teamspace owners",id:"TeamOwnersPermissionRow.permissionItem.teamspaceOwnersAccessToggleNameWithoutTeamName"})}var Wt=i(76464);function Kt(e){window.__c={n:"TeamSpacePermissionRow"};const{teamStore:t}=e,i=(0,l.O7)(),n=(0,d.VK)((()=>S.default.state.currentSpaceStore),[]),{iconComponent:o,spaceName:s}=(0,d.VK)((()=>{if(!n)return{iconComponent:void 0,spaceName:void 0};const e=(0,J.rn)(i,n);return{iconComponent:a()($.p,{disabled:!0,store:n,size:X.Kt}),spaceName:e}}),[n,i]);return a()(St,{permissionRoleSelectComponent:a()("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center"}},void 0,a()(Gt,{teamStore:t})),iconComponent:o,name:zt(s)})}function zt(e){return a()(p.FormattedMessage,e?{defaultMessage:"Everyone else in {spaceName}",id:"TeamMembersTopSection.permissionItem.defaultAccessSpaceName",values:{spaceName:e}}:{defaultMessage:"Everyone else in the workspace",id:"TeamMembersTopSection.permissionItem.defaultAccessWithoutSpaceName"})}function Gt(e){window.__c={n:"TeamPermissionRoleSelect"};const{teamStore:t}=e,i=(0,l.O7)(),n=(0,c.Fg)(),o=(0,d.VK)((()=>t.getSpacePermission()||{type:"space_permission",role:"none"}),[t]),u=(0,y.TE)(t),m=(0,d.VK)((()=>{const e=t.getSettingsStore().getValue();if(e)return ge({id:t.id,permissions:t.getPermissionItems(),settings:e,is_default:t.isDefault()})}),[t],{useDeepEqual:!0});if(!m)return null;const g=m.permissionItemRoleOptions.spacePermission;if(1===g.length&&"none"===g[0])return a()(I.Z,{renderTooltip:()=>a()(p.FormattedMessage,{id:"teamPermissionsSettings.privateTeam.noAccessTooltip",defaultMessage:"Private teamspaces can only be accessed or joined by invitation"}),render:e=>r.createElement("div",D()({style:{display:"flex",alignItems:"center",maxWidth:170}},e),L.Z.lockedFilled({width:14,height:14,fill:n.timelineRed,marginRight:4}),a()("div",{style:{fontSize:12.5,color:n.timelineRed,marginRight:8}},void 0,a()(p.FormattedMessage,{id:"teamPermissionsSettings.privateTeam.noAccessLabel",defaultMessage:"No access • Invite only"})))});{const e=s().sortBy(g,(e=>-le.xm[e])).map((e=>({role:e})));return a()(lt.ZP,{role:o.role,table:rt.e0,type:"space_permission",upgradeButtonName:"space_permission_item",disabled:u||1===g.length,buttonStyle:{fontSize:12.5,marginRight:0,color:n.mediumTextColor},availableRoleItems:e,onChange:e=>{const n={...o,role:e};V.createAndCommit({userAction:"TeamSpacePermissionRow.permissionComponent",environment:i,perform:e=>{Wt.ep({environment:i,store:t,permissionItems:[n],transaction:e})}})}})}}function qt(e){let{teamStore:t}=e;window.__c={n:"TeamPermissionRowsSection"};const i=(0,d.VK)((()=>t.isDefault()),[t]),n=(0,d.VK)((()=>(0,Qe.XO)({membership:t.getMembers()})),[t]),o=(0,d.VK)((()=>{const e=S.default.state.currentSpaceStore;if(!e)return!1;return!(null==e?void 0:e.getDisableTeamGuests())&&(!i&&(0,ve.F$)())}),[i]),s=(0,c.yK)((()=>({container:{marginLeft:15,marginRight:7,paddingBottom:4,paddingTop:4}})),[]);return a()("div",{style:s.container},void 0,a()(Vt,{teamStore:t,teamOwnerIds:n},"0"),a()(Rt,{teamStore:t},"1"),o&&a()(Bt,{teamStore:t},"2"),!i&&a()(Kt,{teamStore:t},"3"))}var Ht=i(49469);function jt(e){let{teamStore:t}=e;window.__c={n:"TeamSettingsMembers"};const i=(0,c.yK)((()=>({spacer:{width:"100%",height:20},heading:{marginBottom:10}})),[]);return r.createElement(r.Fragment,null,a()(Qt,{teamStore:t}),a()("div",{style:i.spacer}),a()(Ht.z,{title:a()(p.FormattedMessage,{id:"TeamSettingsMembers.memberSettings.membersTitle",defaultMessage:"Members"}),style:i.heading}),a()(At,{teamStore:t}))}function Qt(e){let{teamStore:t}=e;window.__c={n:"PermissionsCard"};const i=(0,l.O7)(),n=(0,d.VK)((()=>t.getName()),[t]),o=(0,c.yK)((()=>({learnMoreLinkContainer:{marginTop:15,marginBottom:15},teamSettingsListItems:{padding:0,margin:0},accessButton:{border:"none"}})),[]),s=(0,r.useCallback)(((e,a)=>{O.Ju({environment:i,accessLevel:e,isDefault:a,store:t,teamName:n,from:"sidebar_team_modal"})}),[i,t,n]),u=(0,d.VK)((()=>t.getTeamAccessLevel()),[t]),m=[a()(ee._,{teamStore:t,currentAccessLevel:u,onChange:s,style:o.accessButton},"visibility"),a()(qt,{teamStore:t},"permissions")];return r.createElement(r.Fragment,null,a()(X.Ph,{title:a()(p.FormattedMessage,{id:"TeamSettingsMembers.memberSettings.permissionsTitle",defaultMessage:"Permissions"}),rows:m,itemStyle:o.teamSettingsListItems}),a()(Y.Z,{helpCenterLocation:"settingsAndPermissions",analyticsFrom:"teams_learn_more_team_settings_permissions",message:a()(p.FormattedMessage,{id:"teamSettingsPermissions.learnMore",defaultMessage:"Learn about teamspace permissions"}),containerStyle:o.learnMoreLinkContainer}))}var Yt=i(74136);function $t(e){return r.createElement(Yt.Z,e,a()(p.FormattedMessage,{id:"sidebarTeamModalTab.unownedBadge",defaultMessage:"Unowned"}))}function Xt(e){window.__c={n:"ModalContent"};const{teamStore:t}=e,i=(0,d.VK)((()=>M.Z.state.tab),[]);if(void 0===i)return null;switch(i){case M.a.General:return a()(Re,{teamStore:t});case M.a.Members:return a()(jt,{teamStore:t});case M.a.Security:return a()(xe,{teamStore:t});default:(0,u.t1)(i)}}function Jt(e){window.__c={n:"UserWithAvatar"};const{userId:t,currentSpaceStore:i}=e,{userStore:n,isDefined:o}=(0,d.VK)((()=>{const e=b.U6.createChildStore(i,{table:"notion_user",id:t,spaceId:i.id});return{userStore:e,isDefined:e.isDefined()}}),[i,t]);return o?a()(Z.Z,{avatarShouldShowShadow:!0,userStore:n,style:{paddingRight:6,minHeight:34,lineHeight:1.2,fontSize:14,width:"100%"},avatarSize:24}):null}function ei(e){window.__c={n:"PeopleRow"};const{userIds:t,label:i,hasMarginTop:n}=e,o=(0,d.VK)((()=>S.default.state.currentSpaceStore),[]);return o?r.createElement(r.Fragment,null,a()(x.Z,{hasMarginTop:n},void 0,i),t.map((e=>a()(Jt,{userId:e,currentSpaceStore:o},e)))):null}function ti(){window.__c={n:"SidebarTeamModal"};const e=(0,l.O7)(),t=(0,d.VK)((()=>S.default.state.currentSpaceStore),[]),i=(0,d.VK)((()=>S.default.state.currentSpaceViewStore),[]),n=(0,l.Fy)(),o=(0,c.yK)((e=>({modal:{width:n.isMobile?"auto":630,height:n.isMobile?"auto":640,maxWidth:"calc(100vw - 100px)",maxHeight:"calc(100vh - 100px)",borderRadius:5,overflow:"auto"},modalWrap:{userSelect:"none",WebkitUserSelect:"none",height:"100%"},innerWrap:{width:"100%",height:"100%",display:"flex",flexDirection:"column",paddingTop:20},header:{display:"flex",alignItems:"center",flexGrow:0,flexShrink:0,margin:"0px 36px"},tabBar:{display:"flex",width:void 0,flexGrow:0,flexShrink:0,margin:"0px 36px 20px"},scroller:{flexGrow:1},contentWrap:{margin:"0px 36px"},lockIcon:{width:16,marginLeft:6,marginBottom:1,fill:e.mediumIconColor},icon:{marginRight:8,fontWeight:m.Z.fontWeight.medium},unownedPill:{marginLeft:6,height:17},unownedPillInner:{display:"flex",height:"100%",alignItems:"center",color:e.regularTextColor,fontWeight:m.Z.fontWeight.regular,textTransform:"unset",fontSize:11}})),[n.isMobile]),{open:r,tab:h,teamStore:b}=(0,d.VK)((()=>{const{open:e,tab:t}=M.Z.state;return{open:e,tab:t,teamStore:M.Z.getTeamStore()}}),[]),T=(0,d.VK)((()=>null==b?void 0:b.getSettings()),[b]),I=(0,y.ql)(b);if(!t||!i||!b)return null;const P=[M.a.General,M.a.Members,M.a.Security];return a()(C.Z,{open:r,innerStyle:o.modal,onDismiss:()=>{M.Z.reset()},render:()=>r?a()("div",{className:f.rIj,style:{height:"100%"}},void 0,a()("div",{style:o.modalWrap},void 0,a()(w.Z,{capture:!0,onBackspace:s().identity,onLeft:s().identity,onRight:s().identity,onSelectAll:s().identity,onRedo:s().identity,onUndo:s().identity,onCut:s().identity,onCopy:s().identity,onPaste:s().identity,onKeypress:s().identity,onDelete:s().identity,onTab:s().identity},void 0,a()("div",{style:o.innerWrap},void 0,a()("div",{style:o.header},void 0,a()($.p,{disabled:!0,store:b,size:24,style:o.icon}),a()(_.Z,{store:b,style:{fontSize:16,fontWeight:m.Z.fontWeight.semibold}}),(0,v.C2)(T)&&a()(E.Z,{iconStyle:o.lockIcon}),(0,v.Hu)({membership:b.getRawMembership()})&&a()("div",{style:{gap:5,display:"flex"}},void 0,a()($t,{desktopStyle:o.unownedPill,mobileStyle:o.unownedPill,innerStyle:o.unownedPillInner})),a()("div",{style:{flexGrow:1}}),a()(A.M,{teamStore:b,onLeavingTeam:()=>M.Z.reset(),from:"sidebar_team_modal",navigateToTeamHomeOnJoin:!1})),a()(F.Z,{tabs:P.map((e=>function(e,t){switch(e){case M.a.General:return a()(p.FormattedMessage,{id:"sidebarTeamModalTab.option.general",defaultMessage:"General"});case M.a.Members:return a()(ii,{teamStore:t});case M.a.Security:return a()(p.FormattedMessage,{id:"sidebarTeamModalTab.option.security",defaultMessage:"Security"});default:(0,u.t1)(e)}}(e,b))),selectedIndex:(0,u.$K)(h)?P.indexOf(h):1,onChange:t=>{r&&(g.rFP(e,{store:b,tab_old_value:h??M.a.General,tab_new_value:P[t]}),M.Z.update((e=>e.open?{...e,tab:P[t]}:e)))},tabStyle:{marginLeft:-8},style:o.tabBar,tabTitleStyle:{marginLeft:8,marginRight:8}}),a()(k.Z,{type:k.Z.OverflowType.Y,style:o.scroller},void 0,a()("div",{style:o.contentWrap},void 0,a()(Xt,{currentSpaceStore:t,teamStore:b,userIsTeamOwner:I}))))))):null})}function ii(e){let{teamStore:t}=e;window.__c={n:"MembersTabTitle"};const i=(0,y.KR)(t),n=(0,c.Fg)();return r.createElement(r.Fragment,null,a()(p.FormattedMessage,{id:"sidebarTeamModalTab.option.members",defaultMessage:"Members"}),a()("span",{},void 0," "),a()("div",{style:{color:n.lightTextColor}},void 0,i))}function ni(e){let{title:t,caption:i,secondCaption:n,on:o,disabled:s,tooltip:d,style:u,onChange:m,shouldTriggerUpsell:p}=e;window.__c={n:"SettingToggle"};const g=(0,l.O7)(),f=(0,c.yK)((()=>({root:{display:"flex",alignItems:"center",width:"100%",marginTop:0,marginBottom:0,cursor:p?"pointer":void 0,...u},title:{fontSize:14,marginRight:8,flexGrow:1},switcherWrap:{marginTop:5,marginRight:18}})),[u,p]);return r.createElement(r.Fragment,null,a()("div",{style:f.root,onClick:()=>{if(p)return h.y(g,{from:"team_security_settings",for:"business",dontOpenPlansOnCancel:!0})}},void 0,a()("div",{style:f.title},void 0,t,i&&a()(P.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"95%"}},void 0,i),n&&a()(P.Z,{isSmall:!0},void 0,n)),a()("div",{style:f.switcherWrap},void 0,a()(I.Z,{disableTooltip:!d,renderTooltip:()=>d,render:e=>r.createElement("div",e,a()(T.Z,{on:o,disabled:s,onClick:m}))}))))}},42182:(e,t,i)=>{i.r(t),i.d(t,{default:()=>vv});var n=i(23174),a=i.n(n),o=i(10434),s=i.n(o),r=(i(21703),i(96486)),l=i.n(r),d=i(67294),c=i(83355),u=i(5220),m=i(53397),p=i(4615),g=i(90965),h=i(3791),f=i(82990),v=i(5366),y=i(48298),S=i(7512),b=i(50906),M=i(47307),w=i(5978),C=i(29974),_=i(71119),k=i(10161),T=i(54642);async function I(e,t){if(k.default.checkGate("enable_managed_users_disabled_profile_edits")){const i=await T.getEmailDomainSettings(e,{});"success"===i.type&&t.setState({...t.state,emailDomainSettings:i.data})}try{const i=await(0,_.pu)(e);t.setState({...t.state,accountSettings:{...i,error:void 0}})}catch(i){t.setState({...t.state,accountSettings:{...t.state.accountSettings,error:i}})}}var P=i(97627),Z=i(21325),x=i(97880),F=i(23537),A=i(79315),E=i(74716),B=i(49085);class D extends B.default{getInitialState(){return{loadingState:"uninitialized"}}}const R=new D;async function L(e){let{environment:t,messageStoreEmitValue:i}=e;if(!function(e){const t=R.state;if("loading"===t.loadingState)return!1;if(("uninitialized"===t.loadingState?void 0:t.messageStoreEmitValue)===e)return!1;return!0}(i))return!1;const{currentSpaceStore:n,currentUserStore:a}=A.default.state;if(!n||!a)return!1;"uninitialized"===R.state.loadingState&&R.setState({loadingState:"loading"});const o=await async function(e){let{environment:t,currentSpaceStore:i,currentUserStore:n}=e;const a=i.getModel();if(!a)return;if((0,u.H)({userId:n.id,spaceModel:a})){return await(0,F.sj)({environment:t,spaceStore:i,includeArchived:!0,currentUserId:n.id,minRoleOnTeamStores:"reader"})}return await(0,F.qX)({environment:t,spaceStore:i,includeArchived:!0,currentUserId:n.id})}({environment:t,currentSpaceStore:n,currentUserStore:a});if(!(0,x.$K)(o))return R.setState({loadingState:"uninitialized"}),!1;const{archivedTeams:s,unarchivedTeams:r}=(0,F.tV)(o);return R.setState({loadingState:"loaded",archivedTeamIds:s.map((e=>e.id)),unarchivedTeamIds:r.map((e=>e.id)),messageStoreEmitValue:i}),!0}var N=i(12359),O=i(37181),V=i(28020),U=i(68821),W=i(43250),K=i(4708),z=i(33929),G=i(17652),q=i(67669),H=i(33665),j=i(21115),Q=i(8323),Y=i(53877);const $=["page_viewed","page_created","page_deleted","page_restored","page_exported","page_moved","page_permission_updated","page_shared_to_web","file_uploaded","file_downloaded","private_content_transferred","automation_created","automation_edited","member_invited","member_joined","member_role_updated","member_removed","guest_removed","invite_link_toggled","workspace_name_changed","invite_link_reset","page_access_requests_toggled","public_page_sharing_toggled","workspace_sidebar_editing_toggled","disable_team_guests_toggled","disable_guests_toggled","pages_to_other_workspaces_toggled","export_toggled","workspace_exported","workspace_icon_changed","workspace_domain_changed","workspace_integration_restriction_changed","allowed_email_domain_added","allowed_email_domain_removed","public_page_cleared","public_page_set","scim_token_generated","scim_token_revoked","idp_metadata_url_updated","idp_metadata_xml_updated","idp_metadata_xml_removed","saml_toggled","saml_enforce_toggled","automatic_account_creation_toggled","workspace_creation_set_for_email_domain","member_added_to_group","member_removed_from_group","space_transfer_status_changed","space_claim_and_upgrade_status_changed","space_claim_deletion_status_changed","membership_requests_toggled","membership_request_resolved","guest_membership_requests_toggled","audit_log_exported","user_analytics_exported","content_analytics_exported","admin_content_search_queried","workspace_analytics_toggled","login","logout","mfa_sms_toggled","mfa_totp_toggled","mfa_backup_code_toggled","password_set","password_cleared","password_changed","email_changed","preferred_name_changed","picture_changed","user_deleted","allowed_support_access","revoked_support_access","team_created","team_archived","team_restored","team_privacy_type_changed","team_default_toggled","team_public_page_sharing_toggled","team_export_toggled","team_sidebar_editing_toggled","team_name_changed","team_description_changed","team_icon_changed","team_creation_admins_setting_toggled","team_guests_toggled","member_added_to_team","group_added_to_team","member_removed_from_team","group_removed_from_team","member_left_team","member_joined_team","member_team_role_updated","team_user_permission_updated","team_group_permission_updated","team_member_default_permission_updated","team_guest_default_permission_updated","team_workspace_default_permission_updated","team_invite_access_changed","teams_enabled_for_space","ai_admin_legal_acceptance_toggled","space_consolidation_started","space_consolidation_completed","space_consolidation_failed"],X=["page_edited","page.discussion.comment.created","page.discussion.comment.updated","page.discussion.comment.deleted","page.permanently_deleted","page.properties_edited","workspace.settings.custom_session_duration_updated","workspace.settings.external_workspace_access_updated","workspace.settings.prevent_profile_edits_updated","workspace.settings.prevent_granting_support_access_updated","admin_content_search_exported","admin_managed_users_log_out_all","admin_managed_users_log_out_one","admin_managed_users_password_cleared","admin_managed_users_password_cleared_one","user_suspended","user_unsuspended",...$],J={page_edited:"page","page.properties_edited":"page",page_viewed:"page",page_created:"page",page_deleted:"page","page.permanently_deleted":"page",page_restored:"page",page_exported:"page",page_moved:"page",page_permission_updated:"page",page_shared_to_web:"page",file_uploaded:"page",file_downloaded:"page",private_content_transferred:"page",automation_created:"page",automation_edited:"page","page.discussion.comment.created":"page","page.discussion.comment.updated":"page","page.discussion.comment.deleted":"page",member_invited:"space",member_joined:"space",member_role_updated:"space",member_removed:"space",guest_removed:"space",workspace_name_changed:"space",workspace_icon_changed:"space",workspace_domain_changed:"space",invite_link_toggled:"space",invite_link_reset:"space",page_access_requests_toggled:"space",public_page_sharing_toggled:"space",workspace_sidebar_editing_toggled:"space",disable_team_guests_toggled:"space",disable_guests_toggled:"space",pages_to_other_workspaces_toggled:"space",export_toggled:"space",workspace_exported:"space",workspace_integration_restriction_changed:"space",allowed_email_domain_added:"space",allowed_email_domain_removed:"space",public_page_cleared:"space",public_page_set:"space",scim_token_generated:"space",scim_token_revoked:"space",idp_metadata_url_updated:"space",idp_metadata_xml_updated:"space",idp_metadata_xml_removed:"space",saml_toggled:"space",saml_enforce_toggled:"space",automatic_account_creation_toggled:"space",workspace_creation_set_for_email_domain:"space","workspace.settings.custom_session_duration_updated":"space","workspace.settings.external_workspace_access_updated":"space","workspace.settings.prevent_profile_edits_updated":"space","workspace.settings.prevent_granting_support_access_updated":"space",member_added_to_group:"space",member_removed_from_group:"space",space_transfer_status_changed:"space",space_claim_and_upgrade_status_changed:"space",space_claim_deletion_status_changed:"space",membership_requests_toggled:"space",membership_request_resolved:"space",guest_membership_requests_toggled:"space",audit_log_exported:"space",user_analytics_exported:"space",content_analytics_exported:"space",workspace_analytics_toggled:"space",ai_admin_legal_acceptance_toggled:"space",space_consolidation_started:"space",space_consolidation_completed:"space",space_consolidation_failed:"space",admin_content_search_queried:"space",admin_content_search_exported:"space",admin_managed_users_log_out_all:"space",admin_managed_users_log_out_one:"space",admin_managed_users_password_cleared:"space",admin_managed_users_password_cleared_one:"space",login:"account",logout:"account",password_set:"account",password_cleared:"account",password_changed:"account",mfa_sms_toggled:"account",mfa_totp_toggled:"account",mfa_backup_code_toggled:"account",email_changed:"account",preferred_name_changed:"account",picture_changed:"account",user_deleted:"account",allowed_support_access:"account",revoked_support_access:"account",user_suspended:"account",user_unsuspended:"account",member_added_to_team:"team",member_removed_from_team:"team",group_added_to_team:"team",group_removed_from_team:"team",member_joined_team:"team",member_left_team:"team",team_created:"team",team_archived:"team",team_restored:"team",team_name_changed:"team",team_description_changed:"team",team_icon_changed:"team",team_privacy_type_changed:"team",team_default_toggled:"team",team_creation_admins_setting_toggled:"team",team_member_default_permission_updated:"team",team_workspace_default_permission_updated:"team",team_guest_default_permission_updated:"team",member_team_role_updated:"team",team_user_permission_updated:"team",team_group_permission_updated:"team",team_invite_access_changed:"team",team_guests_toggled:"team",team_export_toggled:"team",team_public_page_sharing_toggled:"team",team_sidebar_editing_toggled:"team",teams_enabled_for_space:"team"},ee=l().groupBy((0,x.Yd)(J),(e=>J[e]));function te(e){switch(e.actionName){case"page.properties_edited":case"page_edited":case"page_viewed":case"page_created":case"page_deleted":case"page.permanently_deleted":case"page_restored":case"page_exported":case"page_moved":case"page_permission_updated":case"page_shared_to_web":case"file_uploaded":case"file_downloaded":case"private_content_transferred":case"automation_created":case"automation_edited":case"page.discussion.comment.created":case"page.discussion.comment.deleted":case"page.discussion.comment.updated":return e.target.page;case"member_invited":case"member_joined":case"member_role_updated":case"member_removed":case"guest_removed":case"workspace_name_changed":case"workspace_icon_changed":case"workspace_domain_changed":case"allowed_email_domain_added":case"allowed_email_domain_removed":case"workspace_exported":case"audit_log_exported":case"user_analytics_exported":case"content_analytics_exported":case"workspace_integration_restriction_changed":case"public_page_cleared":case"public_page_set":case"scim_token_generated":case"scim_token_revoked":case"saml_toggled":case"saml_enforce_toggled":case"automatic_account_creation_toggled":case"workspace_creation_set_for_email_domain":case"workspace.settings.external_workspace_access_updated":case"workspace.settings.custom_session_duration_updated":case"workspace.settings.prevent_profile_edits_updated":case"workspace.settings.prevent_granting_support_access_updated":case"login":case"logout":case"mfa_sms_toggled":case"mfa_totp_toggled":case"mfa_backup_code_toggled":case"password_set":case"password_cleared":case"password_changed":case"email_changed":case"preferred_name_changed":case"picture_changed":case"user_deleted":case"allowed_support_access":case"revoked_support_access":case"user_suspended":case"user_unsuspended":case"invite_link_toggled":case"invite_link_reset":case"page_access_requests_toggled":case"public_page_sharing_toggled":case"workspace_sidebar_editing_toggled":case"disable_team_guests_toggled":case"disable_guests_toggled":case"pages_to_other_workspaces_toggled":case"workspace_analytics_toggled":case"export_toggled":case"idp_metadata_url_updated":case"idp_metadata_xml_updated":case"idp_metadata_xml_removed":case"member_added_to_group":case"member_removed_from_group":case"space_transfer_status_changed":case"space_claim_and_upgrade_status_changed":case"space_claim_deletion_status_changed":case"membership_requests_toggled":case"membership_request_resolved":case"guest_membership_requests_toggled":case"team_created":case"team_archived":case"team_restored":case"team_default_toggled":case"team_public_page_sharing_toggled":case"team_export_toggled":case"team_sidebar_editing_toggled":case"team_name_changed":case"team_description_changed":case"team_icon_changed":case"team_creation_admins_setting_toggled":case"team_guests_toggled":case"member_added_to_team":case"group_added_to_team":case"member_removed_from_team":case"group_removed_from_team":case"member_joined_team":case"member_left_team":case"member_team_role_updated":case"team_user_permission_updated":case"team_group_permission_updated":case"team_member_default_permission_updated":case"team_guest_default_permission_updated":case"team_workspace_default_permission_updated":case"team_privacy_type_changed":case"team_invite_access_changed":case"teams_enabled_for_space":case"admin_content_search_queried":case"admin_content_search_exported":case"admin_managed_users_log_out_all":case"admin_managed_users_log_out_one":case"admin_managed_users_password_cleared":case"admin_managed_users_password_cleared_one":case"ai_admin_legal_acceptance_toggled":case"space_consolidation_started":case"space_consolidation_completed":case"space_consolidation_failed":return;default:(0,x.t1)(e)}}let ie=function(e){return e.CreatedNewest="CreatedNewest",e.CreatedOldest="CreatedOldest",e}({});var ne=i(30546);class ae extends B.default{getInitialState(){return{pageNum:1,pageSize:10,timeRange:{},actors:[],actions:[],sortOrder:ie.CreatedNewest}}}const oe=new ae,se=e=>{const{timeRange:t,actors:i,actions:n,sortOrder:a}=e,o=new URLSearchParams;return t.starting&&o.append("starting",`${Y.OQ.toUnixMs(t.starting)}`),t.ending&&o.append("ending",`${Y.OQ.toUnixMs(t.ending)}`),(null==i?void 0:i.length)>0&&o.append("actors",i.map(ne.eW).join(",")),(null==n?void 0:n.length)>0&&o.append("actions",n.join(",")),o.append("sort",`${a||ie.CreatedNewest}`),o.toString()};class re extends B.default{getInitialState(){return{cachedResponses:{}}}getCursor(e,t,i){if(i<=1||this.state.spaceId!==e)return;const n=se(t);if(this.state.filterStr!==n)return;const a=this.state.cachedResponses[i-1];return"success"===a.status?null==a?void 0:a.nextCursor:void 0}startLoading(e,t){this.updateResultHelper(e,t,{status:"loading"})}updateLoadedResult(e,t,i){this.updateResultHelper(e,t,{...i,status:"success",loadedAt:Date.now()})}updateError(e,t){this.updateResultHelper(e,t,{status:"error"})}updateResultHelper(e,t,i){const n=se(t);1!==t.pageNum&&this.state.spaceId===e&&this.state.filterStr===n?this.setState({spaceId:e,filterStr:n,cachedResponses:{...this.state.cachedResponses,[t.pageNum]:{...i}}}):this.setState({spaceId:e,filterStr:n,cachedResponses:{[t.pageNum||1]:{...i}}})}}const le=new re;var de=i(67940);class ce extends B.default{getInitialState(){return{status:"unconfigured",emailDomains:[],domainVerifications:[],spaceIds:[],createAccount:!1,useMetadataUrl:!0}}}const ue=ce;var me=i(53680);class pe extends B.default{getInitialState(){return{displaySummary:!0,openDropdown:!1,query:""}}}const ge=new pe;let he=function(e){return e.Overview="overview",e.Users="users",e.Content="content",e.Search="search",e}({});class fe extends B.default{getInitialState(){return{}}shouldRefreshState(e){const t=this.getState();return e!==t.currentSpaceId||!(t.currentTab!==he.Users||t.usersTabData&&t.usersTabData.usersAndStats)}}const ve=new fe;class ye extends B.default{getInitialState(){return{name:"",domain:"",domainState:"current-space",emailDomains:[],publicHomePage:void 0}}getValueForSpace(e){const t=e.getPublicContentDomain(),i=e.getPublicHomePage();if(e.isDefined())return{name:e.getName()||"",domain:t||"",emailDomains:e.getEmailDomains(),domainState:"current-space",publicHomePage:i}}}const Se=ye;class be extends B.default{getInitialState(){return{emailDomains:[],spaceCreation:"admins_only",settings:{}}}async updateValueForSpace(e){const{environment:t,spaceId:i,store:n}=e,a=await T.getEmailDomainsForSpace(t,{spaceId:i});if("failed"===a.type)return void M.showError(a);const{data:o}=a,s=Object.keys(o);return 0!==s.length?n.setState({emailDomains:s,spaceCreation:o[s[0]].spaceCreationEnum,settings:o[s[0]].settings}):n.setState(this.getInitialState()),n.state}}const Me=be;class we extends B.default{getInitialState(){return{uploadingProfilePhoto:!1,givenName:"",familyName:"",name:"",startDayOfWeek:(0,Y.aN)(),accountSettings:{hasPassword:!1,canConfigurePassword:!1,isSamlEnforced:!1,mfaStatus:"loading",numMfaSettings:0,regenerateBackupCodes:!1,error:void 0}}}getValueForUser(e,t,i){if(e.isDefined()){const n=e.getFullName(i),a=e.getProfilePhoto(),o=t.getSettings();return{...this.state,uploadingProfilePhoto:!1,profilePhoto:a,name:n||"",startDayOfWeek:void 0===(null==o?void 0:o.start_day_of_week)?(0,Y.aN)():null==o?void 0:o.start_day_of_week}}}}const Ce=we;var _e=i(92083),ke=i(78291),Te=i(98905),Ie=i(85703),Pe=i(480),Ze=i(81954),xe=i(24405),Fe=i(88632),Ae=i(64369),Ee=i(27386),Be=i(23189),De=i(70630),Re=i(63296);function Le(e){let{spaceId:t,filters:i,disabled:n}=e;window.__c={n:"AdminContentSearchExportButton"};const[o,s]=(0,d.useState)(!1),r=(0,Pe.O7)(),l=n||o,c=(0,xe.yK)((e=>({button:{opacity:l?.5:1}})),[l]);return a()(Re.Z,{style:c.button,disabled:l,onClick:async function(){s(!0),b.j_p(r,{filters:i}),await De.gJ(r,{spaceId:t,filters:i}),s(!1)}},void 0,a()(v.FormattedMessage,{id:"adminContentSearchTab.export",defaultMessage:"Export results"}))}var Ne=i(98165),Oe=i(40394),Ve=i(68785),Ue=i(16402),We=i(58032),Ke=i(69219);function ze(e){let{dateTs:t,includeTime:i}=e;return a()(We.Z,{render:e=>d.createElement("div",e,a()(Ke.i,{useThinTitle:!0,title:i?(0,Ue.uy)(t,!0):(0,Ue.gs)(t)})),renderTooltip:()=>(0,Ue.uy)(t)})}function Ge(){window.__c={n:"LoadingDateCell"};const e=(0,xe.yK)((()=>({title:{width:"50%"}})),[]);return a()(Ke.H,{titleStyles:e.title})}var qe=i(42875),He=i(68216),je=i(31278);const Qe=(0,v.defineMessages)({privateTeamspace:{id:"baseTable.pageCell.privateTeamspace",defaultMessage:"Private teamspace"},untitledPath:{id:"baseTable.pageCell.untitledPath",defaultMessage:"Untitled"}});function Ye(e){let{blockStore:t,rightIcon:i}=e;window.__c={n:"PageCell"};const n=(0,v.useIntl)(),o=(0,Ze.VK)((()=>{var e;return null===(e=A.default.state.currentSpaceStore)||void 0===e?void 0:e.getName()}),[]),s=(0,Ze.VK)((()=>{const e=null==t?void 0:t.getModel();if(e&&t)return e.getRenderIcon({getRecordModel:t.getRecordModel})}),[t]),r=(0,Ze.VK)((()=>{const e=null==t?void 0:t.getModel();if(e&&t)return e.getRenderTitle({getRecordModel:t.getRecordModel,userTimeZone:(0,qe.r)(),intl:z.default.getIntl()})}),[t]),l=(0,xe.yK)((e=>({container:{display:"flex",flexDirection:"row",justifyContent:"flex-start",alignItems:"center",padding:"8px 0",width:"100%",position:"relative"},summaryContainer:{flex:1,overflow:"hidden"},iconContainer:{height:20,width:20,flexGrow:0,flexShrink:0,flexBasis:20,marginRight:12,display:"flex",justifyContent:"center",alignItems:"center",borderRadius:6},name:{fontSize:14,fontWeight:500},nameUntitled:{fontSize:14,fontWeight:500,opacity:.25},byline:{lineHeight:1.3,fontSize:12,opacity:.5}})),[]),d=(0,Ze.VK)((()=>{if(!t)return[];return(0,Ne.uJ)(t).filter((e=>e.id!==t.id)).map((e=>{if(e instanceof He.zX)return e.getName()||n.formatMessage(Qe.privateTeamspace);const t=e.getModel();return(null==t?void 0:t.getRenderTitle({getRecordModel:e.getRecordModel,userTimeZone:(0,qe.r)(),intl:z.default.getIntl()}))||n.formatMessage(Qe.untitledPath)})).reverse()}),[t,n]);return a()("div",{style:l.container},void 0,a()("div",{style:l.iconContainer},void 0,a()(je.Z,{icon:s,size:20,isEmptyPage:!1,disabled:!0})),a()("div",{style:l.summaryContainer},void 0,a()(Ae.Z,{showTooltipWhenTruncated:!0,style:r?l.name:l.nameUntitled},void 0,r||a()(v.FormattedMessage,{id:"baseTable.pageCell.untitledPage",defaultMessage:"Untitled"})),a()(Ae.Z,{showTooltipWhenTruncated:!0,style:l.byline},void 0,d.length>0?d.join("/"):o)),i)}var $e=i(42922),Xe=i(89728);function Je(e){window.__c={n:"AdminContentSearchAcknowledgement"};const t=(0,Pe.O7)(),i=(0,xe.yK)((e=>({container:{marginTop:48,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},headerIcon:{width:36,height:36,color:e.lightTextColor,fill:"currentColor"},disclaimerTitle:{margin:"12px auto",fontWeight:f.Z.fontWeight.medium,fontSize:16},disclaimer:{fontWeight:f.Z.fontWeight.regular,fontSize:14,color:e.lightTextColor,textAlign:"center",width:432,margin:"0 auto 16px"},acknowledgeButton:{width:195,margin:"8px auto 0"},learnMoreButton:{width:195,margin:"8px auto 0",justifyContent:"center",color:e.lightTextColor},learnMoreButtonIcon:{width:12,height:12,marginRight:4}})),[]),n=(0,d.useCallback)((()=>{b.vN5(t),P.NY(t)}),[t]);return a()("div",{style:i.container},void 0,m.Z.lockedFilled(i.headerIcon),a()("h1",{style:i.disclaimerTitle},void 0,a()(v.FormattedMessage,{id:"adminContentSearchTab.pagesTable.acknowledgement.disclaimerTitle",defaultMessage:"Before using this feature"})),a()("p",{style:i.disclaimer},void 0,a()(v.FormattedMessage,{id:"adminContentSearchTab.pagesTable.acknowledgement.disclaimer",defaultMessage:"As a workspace owner, you can use content search to find pages that you don't have access to, including the private pages of other workspace members. Consult with your organization's legal department on how to use this feature. Actions taken here will be recorded in the audit log."})),a()($e.Z,{style:i.acknowledgeButton,onClick:n},void 0,a()(v.FormattedMessage,{id:"adminContentSearchTab.pagesTable.acknowledgement.confirm",defaultMessage:"Acknowledge"})),a()(Xe.Z,{style:i.learnMoreButton,onClick:()=>{const e=(0,H.UY)("adminContentSearch");w.navigateToExternalURL({environment:t,url:e})}},void 0,m.Z.info(i.learnMoreButtonIcon),a()(v.FormattedMessage,{id:"adminContentSearchTab.pagesTable.acknowledgement.learnMore",defaultMessage:"Learn more"})))}var et=i(95477);function tt(e){let{runNewSearch:t,error:i}=e;window.__c={n:"AdminContentSearchError"};const n=(0,xe.yK)((e=>({container:{marginTop:48,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},headerIcon:{width:28,height:28,color:e.redBadgeBackground,fill:"currentColor"},title:{margin:"8px auto",fontWeight:f.Z.fontWeight.medium,fontSize:16},description:{fontWeight:f.Z.fontWeight.regular,fontSize:14,lineHeight:1.3,color:e.lightTextColor,textAlign:"center",width:328,margin:"0 auto 16px"},errorMessage:{borderRadius:4,background:e.cardBackground,fontFamily:f.Z.baseFontFamily.mono,fontSize:12,color:e.lightTextColor,padding:"18px 24px",margin:"0 auto 12px"},errorButton:{width:195,margin:"8px auto 0",textAlign:"center"}})),[]);return a()("div",{style:n.container},void 0,m.Z.genericError(n.headerIcon),a()("h1",{style:n.title},void 0,a()(v.FormattedMessage,{id:"adminContentSearchTab.pagesTable.error.title",defaultMessage:"Something went wrong"})),a()("p",{style:n.description},void 0,a()(v.FormattedMessage,{id:"adminContentSearchTab.pagesTable.error.description",defaultMessage:"Something went wrong when we were loading the results. Try to run your search again."})),null,a()(Re.Z,{style:n.errorButton,onClick:()=>t(!0)},void 0,a()(v.FormattedMessage,{id:"adminContentSearchTab.pagesTable.error.confirm",defaultMessage:"Retry"})))}var it=i(87279),nt=i(29798),at=i(33338),ot=i(52275),st=i(12508),rt=i(78140),lt=i(32163),dt=i(44532),ct=i(72495),ut=i(91642);function mt(e){let{selectedAudience:t,setSelectedAudience:i,onMenuClose:n,setPillTitleToActiveSelection:o}=e;window.__c={n:"AudienceFilter"};const r=(0,Ze.qz)(void 0,nt.Z),l=(0,xe.yK)((e=>({optionContainer:{display:"flex",flexDirection:"row",alignItems:"center"},optionAvatar:{marginRight:4},container:{padding:"6px 0 6px"},input:{margin:"4px auto",width:"95%"},footer:{padding:"8px 8px 2px 8px",justifyContent:"space-between",display:"flex"},icon:{width:16,marginRight:4,fill:"currentColor"},teamIcon:{marginRight:8}})),[]),[c,u]=(0,d.useState)(!1),p=["private","shared_internally","shared_externally","shared_to_web"];function g(){u(!1),n&&n()}function h(){i&&i([])}function f(e){const n=t.includes(e)?[...t.filter((t=>t!==e))]:[...t,e];i&&i(n)}const y=a()(at.Z,{on:t.length>0,icon:m.Z.typesPerson(l.icon),title:o&&t[0]?pt(t[0]):a()(v.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.audience.title",defaultMessage:"Audience"}),onClick:()=>u(!0),disabled:!i,hideChevron:!i});return i?a()(ut.Z,{},void 0,a()(dt.ZP,{popupType:dt.ZP.PopupType.Popup,placementToOrigin:dt.ZP.Placement.Bottom,alignmentToOrigin:dt.ZP.Alignment.Start,open:c,render:function(){const e={key:"teamOptions",items:p.map((e=>({key:e,action:()=>f(e),render:i=>d.createElement(ot.Z,s()({},i,{icon:a()(st.Z,{checked:t.includes(e),onClick:()=>f(e),size:16}),focused:!1,title:pt(e),caption:gt(e),shouldWrapCaption:!0}))}))),render:e=>d.createElement(ct.Z,s()({},e,{title:null,loading:!1}))};return a()("div",{style:l.container},void 0,a()(rt.Z,{menuType:it.og.Popup,header:null,maxHeight:250,width:300},void 0,a()(lt.Z,{type:lt.i.Vertical,store:r,initialFocus:0,sections:[e]})),a()(ct.Z,{topBorder:!0,style:l.footer},void 0,a()(Xe.Z,{onClick:h},void 0,a()(v.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.audience.clearButton",defaultMessage:"Clear"})),a()($e.Z,{onClick:g},void 0,a()(v.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.audience.doneButton",defaultMessage:"Done"}))))},onDismiss:g,keepFocus:!0,origin:y,preventScaleTransition:!0})):y}function pt(e){switch(e){case"private":return a()(v.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.audience.label.private",defaultMessage:"Private"});case"shared_externally":return a()(v.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.audience.label.external",defaultMessage:"Shared externally"});case"shared_internally":return a()(v.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.audience.label.internal",defaultMessage:"Shared internally"});case"shared_to_web":return a()(v.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.audience.label.publishedToWeb",defaultMessage:"Shared to web"});default:(0,x.t1)(e)}}function gt(e){switch(e){case"private":return a()(v.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.audience.caption.private",defaultMessage:"Pages that only a single workspace member has access to."});case"shared_externally":return a()(v.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.audience.caption.external",defaultMessage:"Pages that are shared with guests or connections."});case"shared_internally":return a()(v.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.audience.caption.internal",defaultMessage:"Pages that are shared with other workspace members."});case"shared_to_web":return a()(v.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.audience.caption.publishedToWeb",defaultMessage:"Pages that are available for anyone to see on the web."});default:(0,x.t1)(e)}}function ht(e){let{filters:t,setFilters:i}=e;window.__c={n:"AdminContentSearchSuggestions"};const n=(0,xe.yK)((e=>({container:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},title:{margin:"12px auto",fontWeight:f.Z.fontWeight.medium,fontSize:16},description:{fontWeight:f.Z.fontWeight.regular,fontSize:14,color:e.lightTextColor,textAlign:"center",width:386,margin:"0 auto 16px"},suggestion:{position:"relative",height:38,width:440,margin:"12px auto 0",justifyContent:"center",color:e.darkTextColor,boxShadow:e.borderBoxShadow},filterContainer:{margin:"0 8px",display:"flex",alignItems:"center",justifyContent:"center"},arrowIconContainer:{position:"absolute",right:12,transform:"rotate(180deg)"},arrowIcon:{width:18,height:18,opacity:.5,color:e.lightTextColor,fill:"currentColor"}})),[]);return a()("div",{style:n.container},void 0,a()("h1",{style:n.title},void 0,a()(v.FormattedMessage,{id:"adminContentSearchTab.pagesTable.suggestions.title",defaultMessage:"Search pages in your workspace"})),a()("p",{style:n.description},void 0,a()(v.FormattedMessage,{id:"adminContentSearchTab.pagesTable.suggestions.description",defaultMessage:"Use filters to find pages with specific sharing and permissions settings, such as:"})),a()(Xe.Z,{style:n.suggestion,onClick:function(){i({query:"",lastEditedTime:{starting:void 0,ending:void 0},createdTime:{starting:void 0,ending:void 0},audience:["shared_externally"],teamIds:[]},{runSearchAfter:!0})}},void 0,a()(v.FormattedMessage,{id:"adminContentSearchTab.pagesTable.suggestions.sharedToWeb",defaultMessage:"Search for pages <filter></filter>",values:{filter:()=>a()("div",{style:n.filterContainer},void 0,a()(mt,{setPillTitleToActiveSelection:!0,selectedAudience:["shared_externally"]}))}}),a()("div",{style:n.arrowIconContainer},void 0,m.Z.arrowLeftThick(n.arrowIcon))),a()(Xe.Z,{style:n.suggestion,onClick:function(){i({query:"",lastEditedTime:{starting:void 0,ending:void 0},createdTime:{starting:void 0,ending:void 0},audience:["shared_to_web"],teamIds:[]},{runSearchAfter:!0})}},void 0,a()(v.FormattedMessage,{id:"adminContentSearchTab.pagesTable.suggestions.sharedToWeb",defaultMessage:"Search for pages <filter></filter>",values:{filter:()=>a()("div",{style:n.filterContainer},void 0,a()(mt,{setPillTitleToActiveSelection:!0,selectedAudience:["shared_to_web"]}))}}),a()("div",{style:n.arrowIconContainer},void 0,m.Z.arrowLeftThick(n.arrowIcon))))}var ft=i(26825),vt=i(27006),yt=i(29369);function St(e){let{blockStore:t}=e;window.__c={n:"AudienceCell"};const[i,n]=(0,d.useState)();(0,d.useEffect)((()=>{!async function(){const{currentSpaceStore:e}=A.default.state,i=Ne.fJ(t),a=ft.Wo(i),o=null==e?void 0:e.getPermissionItems().filter(vt.jg),s=await ft.uq({permissionItems:a,hasTeamLevelGuests:function(t){return!!e&&He.zX.createChildStore(e,{table:yt.e0,id:t}).getMembers().some((e=>"team_level_guest"===e.type))},spaceUserPermissions:o});n(s)}()}),[t]);const o=(0,d.useMemo)((()=>{if(i)return bt(i)}),[i]);return a()(Ke.i,{useThinTitle:!0,title:o})}function bt(e){switch(e){case"private":return a()(v.FormattedMessage,{id:"adminContentSearchTab.pagesTable.audienceCell.private",defaultMessage:"Private"});case"shared_internally":return a()(v.FormattedMessage,{id:"adminContentSearchTab.pagesTable.audienceCell.sharedInternally",defaultMessage:"Shared internally"});case"shared_externally":return a()(v.FormattedMessage,{id:"adminContentSearchTab.pagesTable.audienceCell.sharedExternally",defaultMessage:"Shared externally"});case"shared_to_web":return a()(v.FormattedMessage,{id:"adminContentSearchTab.pagesTable.audienceCell.publishedToWeb",defaultMessage:"Published to web"});default:(0,x.t1)(e)}}var Mt=i(93686);function wt(e){let{teamStore:t,useThinTitle:i}=e;window.__c={n:"TeamCell"};const n=(0,xe.yK)((e=>({icon:{height:20,width:20,color:e.lightIconColor,fill:"currentColor"},hiddenTeamName:{color:e.lightTextColor}})),[]),o=(0,Ze.VK)((()=>null==t?void 0:t.getName()),[t]);return a()(Ke.i,o?{useThinTitle:i,icon:t?a()(Mt.p,{disabled:!0,store:t,size:24}):void 0,title:o}:{useThinTitle:i,icon:m.Z.eyeHide(n.icon),title:a()("span",{style:n.hiddenTeamName},void 0,a()(v.FormattedMessage,{id:"baseTable.teamCell.hiddenTeam",defaultMessage:"Hidden"}))})}var Ct=function(e){return e.Shared="shared",e.Private="private",e.Hidden="hidden",e}(Ct||{});function _t(e){let{blockStore:t,teamStore:i}=e;window.__c={n:"LocationCell"};const n=(0,xe.yK)((e=>({icon:{height:18,width:18,color:e.lightIconColor,fill:"currentColor"}})),[]),o=(0,Ze.VK)((()=>{const e=(0,Ne.fJ)(t),i=(0,ft.Wo)(e),n=i.filter((e=>!(0,vt.Le)(e)));return 1===n.length&&(0,vt.jg)(n[0])?Ct.Private:i.length>0?Ct.Shared:Ct.Hidden}),[t]);return i?a()(wt,{useThinTitle:!0,teamStore:i}):function(){switch(o){case Ct.Shared:return a()(Ke.i,{useThinTitle:!0,icon:m.Z.typesPerson(n.icon),title:a()(v.FormattedMessage,{id:"adminContentSearchTab.pagesTable.locationCell.shared",defaultMessage:"Shared"})});case Ct.Hidden:case Ct.Private:return a()(Ke.i,{useThinTitle:!0,icon:m.Z.lockedFilled(n.icon),title:a()(v.FormattedMessage,{id:"adminContentSearchTab.pagesTable.locationCell.private",defaultMessage:"Private"})})}}()}var kt=i(15145),Tt=i(43132),It=i(84210),Pt=i(77907),Zt=i(61766),xt=i(55899),Ft=i(97238),At=i(8675),Et=i(31945),Bt=i(73063);function Dt(e){let{blockStore:t}=e;window.__c={n:"PageCellActions"};const i=(0,Pe.O7)(),n=(0,Ze.qz)(void 0,Zt.Z),o=(0,Ze.qz)(void 0,At.Z),r=(0,Ze.qz)(void 0,xt.ZP),l=(0,xe.yK)((e=>({changePermissionsIcon:{height:18,width:18,color:e.regularIconColor,fill:"currentColor"},copyLinkIcon:{height:15,width:15,color:e.regularIconColor,fill:"currentColor"}})),[]),[c,u]=(0,d.useState)(!1);(0,d.useEffect)((()=>{o.setState({...o.state,privatePageStore:t,changePermissionsEnabled:!0,loading:!1,error:void 0})}),[t,o]);const p={key:"actions",render:e=>d.createElement(ct.Z,e),items:[{key:"change-permissions",render:e=>d.createElement(ot.Z,s()({},e,{icon:m.Z.settingsSecurity(l.changePermissionsIcon),title:a()(v.FormattedMessage,{id:"adminContentSearchTab.pagesTable.page.actions.changePermissions",defaultMessage:"Change permissions"})})),action:function(){u(!0)}},{key:"copy-link",render:e=>d.createElement(ot.Z,s()({},e,{icon:m.Z.link(l.copyLinkIcon),title:a()(v.FormattedMessage,{id:"adminContentSearchTab.pagesTable.page.actions.copyLink",defaultMessage:"Copy link to page"})})),action:async function(){const e=(0,It.ZP)({store:t,pageVisitSource:kt.tY.CopyLink});await Tt.RD({environment:i,stringValue:e,copiedMessage:Tt.tq.copiedLinkToClipboard}),n.setState({open:!1})}}]};return a()(Et.ZP,{popupType:dt.kQ.Popup,alignmentToOrigin:dt.ZP.Alignment.Center,placementToOrigin:dt.ZP.Placement.Right,style:{width:c?450:248},render:()=>c?a()(Pt.LazyShareMenuContainer,{store:t,sudoModeStore:o,inviteTargetsStore:r,location:"admin_content_search"}):a()(rt.Z,{menuType:it.og.Popup,width:248},void 0,a()(lt.Z,{type:lt.i.Vertical,initialFocus:void 0,sections:[p]})),onClose:()=>{u(!1),Ft.ZP.reset()},buttonPopupStore:n,renderOrigin:e=>d.createElement(Bt.Z,s()({icon:m.Z.dots},e))})}i(57658);var Rt=i(53695),Lt=i(77420),Nt=i(36596),Ot=i(28992),Vt=i(70301);function Ut(e){let{botId:t}=e;window.__c={n:"BotMenuItem"};const i=(0,v.useIntl)(),n=(0,Pe.O7)(),o=(0,Ze.VK)((()=>He.t1.createUniqueRootStore(n,{table:Lt.cZ,id:t})),[t,n]),s=(0,Ze.VK)((()=>o.getDisplayName(i)),[o,i]),r=(0,Ze.VK)((()=>o.getParentStore()),[o]),l=(0,Ze.VK)((()=>{if(r){if(r instanceof He.U6)return r.getDisplayName(i);if(r instanceof He.H2)return r.getName()}}),[r,i]),d=(0,xe.yK)((()=>({desktopIconStyle:{alignSelf:"center",width:24,fontSize:18}})),[]);return s?a()(Ot.Z,{desktopIconStyle:d.desktopIconStyle,icon:a()(Vt.Z,{botStore:o,size:24}),title:s,caption:a()(v.FormattedMessage,{id:"adminContentSearchTab.pagesTable.sharedWithCell.botMenuItem.createdBy",defaultMessage:"Created by {creatorName}",values:{creatorName:l}})}):a()(Wt,{})}function Wt(){window.__c={n:"ShimmerLoader"};const e=(0,xe.yK)((e=>({container:{userSelect:"none",minHeight:45,fontSize:14,padding:"4px 8px",display:"flex",flexDirection:"row",justifyContent:"flex-start",alignItems:"center"},textContainer:{display:"flex",flexDirection:"column",justifyContent:"flex-start",alignItems:"flex-start",gap:6},icon:{flexGrow:0,flexShrink:0,width:24,height:24,borderRadius:"0.25em",marginRight:4,marginTop:1},title:{flexGrow:0,flexShrink:0,width:80,height:14,borderRadius:"0.25em",marginLeft:4},byline:{flexGrow:0,flexShrink:0,width:150,height:10,borderRadius:"0.25em",marginLeft:4}})),[]);return a()("div",{style:e.container},void 0,a()(Nt.Z,{style:e.icon}),a()("div",{style:e.textContainer},void 0,a()(Nt.Z,{emphasized:!1,style:e.title}),a()(Nt.Z,{emphasized:!1,style:e.byline})))}const Kt=(0,v.defineMessages)({editor:{id:"adminContentSearchTab.sharedWith.permissions.editor",defaultMessage:"Full access"},readAndWrite:{id:"adminContentSearchTab.sharedWith.permissions.readAndWrite",defaultMessage:"Can edit"},commentOnly:{id:"adminContentSearchTab.sharedWith.permissions.commentOnly",defaultMessage:"Can comment"},reader:{id:"adminContentSearchTab.sharedWith.permissions.reader",defaultMessage:"Can view"},none:{id:"adminContentSearchTab.sharedWith.permissions.none",defaultMessage:"None"}});function zt(e,t){switch(t){case"editor":return e.formatMessage(Kt.editor);case"read_and_write":return e.formatMessage(Kt.readAndWrite);case"comment_only":return e.formatMessage(Kt.commentOnly);case"reader":return e.formatMessage(Kt.reader);case"none":return e.formatMessage(Kt.none)}}function Gt(e){let{name:t,icon:i,role:n}=e;window.__c={n:"GroupMenuItem"};const o=(0,v.useIntl)(),s=(0,Ze.VK)((()=>A.default.state.currentSpaceStore),[]),r=zt(o,n),l=(0,xe.yK)((e=>({defaultIcon:{height:18,width:18,color:e.lightTextColor,fill:"currentColor"},defaultGroupIcon:{height:20,width:20,color:e.lightTextColor,fill:"currentColor"}})),[]);return a()(Ot.Z,{desktopIconStyle:{alignSelf:"center",width:24,fontSize:18},icon:a()(je.Z,{disabled:!0,icon:i&&s?{pointer:s.pointer,icon:i}:void 0,size:20,isEmptyPage:!1,title:t,defaultIcon:m.Z.typesPerson(l.defaultGroupIcon)}),title:t||a()(v.FormattedMessage,{id:"adminContentSearchTab.pagesTable.sharedWithCell.untitledPage",defaultMessage:"Untitled{maybeRoleString}",values:{maybeRoleString:r?` · ${r}`:""}}),caption:a()(v.FormattedMessage,{id:"adminContentSearchTab.pagesTable.sharedWithCell.group",defaultMessage:"Group{maybeRoleString}",values:{maybeRoleString:r?` · ${r}`:""}})})}function qt(e){let{permissionItem:t}=e;window.__c={n:"SpaceMenuItem"};const i=(0,v.useIntl)(),n=(0,Ze.VK)((()=>A.default.state.currentSpaceStore),[]),o=(0,Ze.VK)((()=>{var e;return null===(e=A.default.state.currentSpaceStore)||void 0===e?void 0:e.getName()}),[]),s=null==t?void 0:t.role,r=(0,vt.iC)(s)?zt(i,s):void 0;return a()(Ot.Z,{desktopIconStyle:{alignSelf:"center",width:24},icon:n?a()(Mt.p,{disabled:!0,store:n,size:24}):void 0,title:o,caption:a()(v.FormattedMessage,{id:"adminContentSearchTab.pagesTable.sharedWithCell.spaceMembers",defaultMessage:"Members{maybeRoleString}",values:{maybeRoleString:r?` · ${r}`:""}})})}function Ht(e){let{teamId:t,role:i,onlyOwners:n}=e;window.__c={n:"TeamMenuItem"};const o=(0,Pe.O7)(),s=(0,v.useIntl)(),r=(0,Ze.VK)((()=>new He.zX(o,{table:yt.e0,id:t})),[o,t]),l=zt(s,i),d=(0,Ze.VK)((()=>r.getName()),[r]),c=d||a()(v.FormattedMessage,{id:"adminContentSearchTab.pagesTable.sharedWithCell.unknownTeamName",defaultMessage:"Private teamspace"});return a()(Ot.Z,{desktopIconStyle:{alignSelf:"center",width:24},icon:d?a()(Mt.p,{disabled:!0,store:r,size:24}):m.Z.privateTeam(),title:c,caption:a()(v.FormattedMessage,n?{id:"adminContentSearchTab.pagesTable.sharedWithCell.teamOwners",defaultMessage:"Owners{maybeRoleString}",values:{maybeRoleString:l?` · ${l}`:""}}:{id:"adminContentSearchTab.pagesTable.sharedWithCell.teamMembers",defaultMessage:"Members{maybeRoleString}",values:{maybeRoleString:l?` · ${l}`:""}})})}var jt=i(64684);var Qt=i(19889),Yt=i(7928),$t=i(45653);function Xt(e){let{userId:t,role:i,isGuest:n}=e;window.__c={n:"UserMenuItem"};const o=(0,v.useIntl)(),s=(0,Pe.O7)(),{userStore:r,userName:l}=(0,Ze.VK)((()=>{const e=new He.U6(s,{table:Qt.KJ,id:t}),i=(0,Yt.Nz)(o,e.getModel());return{userStore:e,userName:i}}),[s,t,o]),d=zt(o,i);return a()(Ot.Z,{desktopIconStyle:{alignSelf:"center",width:24},icon:a()($t.Z,{userStore:r,size:24}),title:l,caption:a()(v.FormattedMessage,n?{id:"adminContentSearchTab.pagesTable.sharedWithCell.guest",defaultMessage:"Guest{maybeRoleString}",values:{maybeRoleString:d?` · ${d}`:""}}:{id:"adminContentSearchTab.pagesTable.sharedWithCell.member",defaultMessage:"Member{maybeRoleString}",values:{maybeRoleString:d?` · ${d}`:""}})})}const Jt=(0,v.defineMessages)({sharedWithWorkspaceMembers:{id:"adminContentSearchTab.pagesTable.sharedWithCell.sharedWithWorkspaceMembers",defaultMessage:"Workspace members"},sharedWithTeamOwners:{id:"adminContentSearchTab.pagesTable.sharedWithCell.sharedWithTeamOwners",defaultMessage:"Teamspace owners"},sharedWithTeamMembers:{id:"adminContentSearchTab.pagesTable.sharedWithCell.sharedWithTeamMembers",defaultMessage:"Teamspace members"},sharedWithMembers:{id:"adminContentSearchTab.pagesTable.sharedWithCell.sharedWithMembers",defaultMessage:"{numMembers, plural, one {# member} other {# members}}"},sharedWithGroups:{id:"adminContentSearchTab.pagesTable.sharedWithCell.sharedWithGroups",defaultMessage:"{numGroups, plural, one {# group} other {# groups}}"},sharedWithGuests:{id:"adminContentSearchTab.pagesTable.sharedWithCell.sharedWithGuests",defaultMessage:"{numGuests, plural, one {# guest} other {# guests}}"},sharedWithBots:{id:"adminContentSearchTab.pagesTable.sharedWithCell.sharedWithBots",defaultMessage:"{numBots, plural, one {# connection} other {# connections}}"},separator:{defaultMessage:", ",id:"adminContentSearchTab.pagesTable.sharedWithCell.separator"}});function ei(e){let{blockStore:t}=e;window.__c={n:"SharedWithCellImpl"};const i=function(e){return(0,Ze.VK)((()=>{const{data:t}=ke.default.state,i=t?(0,j.CM)(t):[],n=A.default.state.currentSpaceStore,a=(0,q.YO)(e),o=(null==n?void 0:n.getPermissionGroups())||[],s=(0,Ne.VP)(e),r=a.find((e=>{let{permissionItem:t}=e;return vt.$D(t)})),l=a.find((e=>{let{permissionItem:t}=e;return vt.ix(t)})),d=s?a.find((e=>{let{permissionItem:t}=e;return(0,jt.J2)(t,s.id)})):void 0,c=a.map((e=>{let{permissionItem:t}=e;return t})).filter(vt.zU),u=a.map((e=>{let{permissionItem:t}=e;return t})).filter(vt.LW),m=a.map((e=>{let{permissionItem:t}=e;return t})).filter(vt.hV).reduce(((e,t)=>{const i=t.group_id,n=t.role,a=o.find((e=>e.id===i));if(a){const t={...a,role:n};e.push(t)}return e}),[]),[p,g]=a.map((e=>{let{permissionItem:t}=e;return t})).filter(vt.jg).reduce(((e,t)=>{const n=i.find((e=>e.userId===t.user_id));return Boolean(n&&!vt.zz(n.role)&&!vt.J5(n.role))?[e[0].concat(t),e[1]]:[e[0],e[1].concat(t)]}),[[],[]]);return{groupPermissions:m,mostPermissivePublicItem:r,spacePermission:l,teamPermission:d,teamSharePermissions:c,teamOwnerSharePermissions:u,guestUserPermissions:p,memberUserPermissions:g,botPermissions:a.map((e=>{let{permissionItem:t}=e;return t})).filter((e=>(0,vt.FB)(e)))}}),[e])}(t),n=(0,v.useIntl)(),o=function(e,t){const{mostPermissivePublicItem:i,spacePermission:n,groupPermissions:o,guestUserPermissions:s,memberUserPermissions:r,teamSharePermissions:l,teamOwnerSharePermissions:c,botPermissions:u}=e,p=n&&"none"!==n.permissionItem.role;if(i&&"none"!==i.permissionItem.role)return a()(v.FormattedMessage,{id:"adminContentSearchTab.pagesTable.sharedWithCell.sharedWithWeb",defaultMessage:"Shared to web"});if(!p&&0===o.length&&0===s.length&&0===r.length&&0===l.length&&0===c.length&&0===u.length)return a()("div",{style:{display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center"}},void 0,a()(v.FormattedMessage,{id:"adminContentSearchTab.pagesTable.sharedWithCell.orphanedPage",defaultMessage:"Nobody"}),a()(We.Z,{render:e=>d.createElement("div",e,m.Z.info({marginLeft:4,height:14,width:14,opacity:.5})),renderTooltip:()=>a()(v.FormattedMessage,{id:"adminContentSearchTab.pagesTable.sharedWithCell.orphanedPage.tooltip",defaultMessage:"No person, group, or teamspace has any access to this page."})}));const g=[];p?g.push(t.formatMessage(Jt.sharedWithWorkspaceMembers)):(c.length>0&&0===l.length?g.push(t.formatMessage(Jt.sharedWithTeamOwners)):l.length>0&&g.push(t.formatMessage(Jt.sharedWithTeamMembers)),r.length>0&&g.push(t.formatMessage(Jt.sharedWithMembers,{numMembers:r.length})),o.length>0&&g.push(t.formatMessage(Jt.sharedWithGroups,{numGroups:o.length})));s.length>0&&g.push(t.formatMessage(Jt.sharedWithGuests,{numGuests:s.length}));u.length>0&&g.push(t.formatMessage(Jt.sharedWithBots,{numBots:u.length}));return g.join(t.formatMessage(Jt.separator))}(i,n),r=[...i.spacePermission?[{key:"space-permission",render:e=>{var t;return d.createElement(qt,s()({},e,{permissionItem:null===(t=i.spacePermission)||void 0===t?void 0:t.permissionItem}))},action:()=>{}}]:[],...i.teamOwnerSharePermissions.map((e=>({key:`${e.team_id}-owners`,render:t=>d.createElement(Ht,s()({},t,{onlyOwners:!0,teamId:e.team_id,role:e.role})),action:()=>{}}))),...i.teamSharePermissions.map((e=>({key:`${e.team_id}-members`,render:t=>d.createElement(Ht,s()({},t,{teamId:e.team_id,role:e.role})),action:()=>{}}))),...i.groupPermissions.map((e=>({key:e.id,render:t=>d.createElement(Gt,s()({},t,{name:e.name,icon:e.icon,role:e.role})),action:()=>{}}))),...i.memberUserPermissions.map((e=>({key:e.user_id,render:t=>d.createElement(Xt,s()({},t,{userId:e.user_id,role:e.role})),action:()=>{}}))),...i.guestUserPermissions.map((e=>({key:e.user_id,render:t=>d.createElement(Xt,s()({},t,{isGuest:!0,userId:e.user_id,role:e.role})),action:()=>{}}))),...i.botPermissions.map((e=>({key:e.bot_id,render:t=>d.createElement(Ut,s()({},t,{botId:e.bot_id})),action:()=>{}})))];return a()(Rt.N,{title:o,items:r,disabled:0===r.length})}const ti=d.memo(ei);function ii(e){let{userStores:t,isClickable:i}=e;window.__c={n:"UsersCell"};const n=(0,v.useIntl)(),o=(0,Pe.O7)(),r=(0,xe.yK)((e=>({container:{display:"flex",flexDirection:"row",justifyContent:"flex-start",alignItems:"center",height:"auto",paddingTop:8,paddingBottom:8},avatar:{marginRight:4},plusMore:{opacity:.5,marginLeft:4,display:"inline-block"},tooltip:{color:e.regularInvertedTextColor,fontSize:12}})),[]),l=t[0],c=(0,Ze.VK)((()=>{if(l)return l.computeWithRecordValues((e=>{let{getRecordValueAndSubscribe:t}=e;return t(l)}))}),[l]),u=a()("div",{style:r.container},void 0,a()($t.Z,{style:r.avatar,userValue:c,size:20}),a()(v.FormattedMessage,{id:"baseTable.usersCell.userName",defaultMessage:"{remainingCount, plural, =0 {{firstUser}} one {{firstUser}<gray>+{remainingCount}</gray>} other {{firstUser}<gray>+{remainingCount}</gray>}}",values:{firstUser:(0,Yt.Nz)(n,c),remainingCount:t.length-1,gray:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return a()(Ae.Z,{style:r.plusMore},void 0,t)}}}));if(!i)return a()(We.Z,{disableTooltip:t.length<=1,render:e=>d.createElement("div",e,u),renderTooltip:()=>d.createElement(d.Fragment,null,t.map(((e,t)=>a()(Ae.Z,{style:r.tooltip},e?e.id:t,a()(ai,{userStore:e})))))});const m=t.map(((e,t)=>({key:null!=e&&e.id?null==e?void 0:e.id:t,render:t=>d.createElement(ni,s()({userStore:e},t)),action:()=>null!=e&&e.getEmail?w.navigateToExternalURL({environment:o,url:`mailto:${null==e?void 0:e.getEmail()}`}):void 0})));return a()(Rt.N,{hideDropdownIcon:!0,title:u,items:m})}function ni(e){let{userStore:t,...i}=e;window.__c={n:"EmailableUserSummary"};const n=(0,Ze.VK)((()=>null==t?void 0:t.computeWithRecordValues((e=>{let{getRecordValueAndSubscribe:i}=e;return i(t)}))),[t]),o=(0,xe.yK)((e=>({container:{display:"flex",flexDirection:"row",justifyContent:"flex-start",alignItems:"center",height:"auto",paddingTop:8,paddingBottom:8},avatarContainer:{display:"flex",justifyContent:"center",alignItems:"center"},copyContainer:{display:"flex",justifyContent:"center",alignItems:"center",marginLeft:"auto",opacity:.5},nameContainer:{marginLeft:8,marginRight:8},name:{fontSize:14,lineHeight:1.2,maxWidth:300},email:{fontSize:12,lineHeight:1.2,opacity:.5,maxWidth:300}})),[]);return d.createElement(Xe.Z,s()({style:o.container},i),a()("div",{style:o.avatarContainer},void 0,a()($t.Z,{userValue:n,size:24})),a()("div",{style:o.nameContainer},void 0,a()(Ae.Z,{style:o.name},void 0,a()(ai,{userStore:t})),n?a()(Ae.Z,{style:o.email},void 0,n.email):null),a()("div",{style:o.copyContainer},void 0,m.Z.mail({height:18,width:18})))}function ai(e){window.__c={n:"UserFullDisplayName"};const t=(0,v.useIntl)(),{userStore:i}=e,n=(0,Ze.VK)((()=>null==i?void 0:i.computeWithRecordValues((e=>{let{getRecordValueAndSubscribe:t}=e;return t(i)}))),[i]);return d.createElement(d.Fragment,null,(0,Yt.Nz)(t,n))}function oi(e){let{blockStore:t,userIds:i,isClickable:n}=e;window.__c={n:"UsersFromIdsCell"};const o=(0,Ze.VK)((()=>i.map((e=>He.U6.createChildStore(t,{table:Qt.KJ,id:e})))),[t,i]);return a()(ii,{userStores:o,isClickable:n})}const si={id:"page",headerTitle:a()(v.FormattedMessage,{id:"adminContentSearchTab.pagesTable.page.name",defaultMessage:"Page"}),renderCell:e=>a()(Ye,{blockStore:e.pageStore,rightIcon:a()(Dt,{blockStore:e.pageStore})}),widthData:{width:320,maxWidth:320},sortable:!1},ri={id:"location",headerTitle:a()(v.FormattedMessage,{id:"adminContentSearchTab.pagesTable.location.name",defaultMessage:"Location"}),renderCell:e=>a()(_t,{blockStore:e.pageStore,teamStore:e.teamStore}),widthData:{width:140},sortable:!1},li={id:"createdTime",headerTitle:a()(v.FormattedMessage,{id:"adminContentSearchTab.pagesTable.createdTime.name",defaultMessage:"Created on"}),renderCell:e=>a()(ze,{dateTs:e.createdTime}),widthData:{width:140},sortable:!1},di={id:"lastEditedTime",headerTitle:a()(v.FormattedMessage,{id:"adminContentSearchTab.pagesTable.lastEditedTime.name",defaultMessage:"Last edited on"}),renderCell:e=>a()(ze,{dateTs:e.lastEditedTime}),widthData:{width:140},sortable:!1},ci={id:"createdBy",headerTitle:a()(v.FormattedMessage,{id:"adminContentSearchTab.pagesTable.createdBy.name",defaultMessage:"Created by"}),renderCell:e=>e.createdById?a()(oi,{blockStore:e.pageStore,userIds:[e.createdById]}):null,widthData:{width:140},sortable:!1},ui={id:"lastEditedBy",headerTitle:a()(v.FormattedMessage,{id:"adminContentSearchTab.pagesTable.lastEditedBy.name",defaultMessage:"Last edited by"}),renderCell:e=>e.lastEditedById?a()(oi,{blockStore:e.pageStore,userIds:[e.lastEditedById]}):null,widthData:{width:140},sortable:!1},mi=[si,ri,{id:"audience",headerTitle:a()(v.FormattedMessage,{id:"adminContentSearchTab.pagesTable.audience.name",defaultMessage:"Audience"}),renderCell:e=>a()(St,{blockStore:e.pageStore}),widthData:{width:140},sortable:!1},{id:"sharedWith",headerTitle:a()(v.FormattedMessage,{id:"adminContentSearchTab.pagesTable.sharedWith.name",defaultMessage:"Shared with"}),renderCell:e=>a()(ti,{blockStore:e.pageStore}),widthData:{width:140},sortable:!1},ui,di,ci,li];function pi(e){let{loading:t,error:i,loadNextPage:n,filters:o,setFilters:s,pageStores:r,showSuggestions:l,runNewSearch:c}=e;window.__c={n:"AdminContentSearchTable"};const u=(0,Ze.VK)((()=>{const e=A.default.state.currentSpaceViewStore,t=null==e?void 0:e.getSettings();return null==t?void 0:t.admin_content_search_acknowledgement}),[]),m=u&&!t&&!l,p=u&&!l,g=(0,Ze.VK)((()=>r.map((e=>({id:e.id,isClickable:!1,pageStore:e,teamStore:(0,Ne.VP)(e),createdTime:e.getCreatedTime(),lastEditedTime:e.getLastEditedTime(),createdById:e.getCreatedById(),lastEditedById:e.getLastEditedById()})))),[r]),h=(0,xe.yK)((e=>(0,Oe.b)({columnRenderInfo:mi,theme:e,containerMarginTop:0})),[]);return i?a()(tt,{runNewSearch:c,error:i}):u?l&&0===g.length?a()(ht,{filters:o,setFilters:s}):d.createElement(d.Fragment,null,a()(Oe.D,{hideHeaderRowPadding:!0,allowHorizontalScroll:!0,setStickyHeaderRow:!0,maxHeight:400,columnRenderInfo:mi,rows:g,onScrollBottom:p?n:void 0,renderNoRowsComponent:()=>a()(Ae.Z,{isSmall:!0,style:{marginTop:15,marginBottom:40,textAlign:"center"}},void 0,m&&a()(v.FormattedMessage,{id:"adminContentSearchTab.pagesTable.empty",defaultMessage:"No pages found with your query."})),styles:h}),t?a()(Ve.Z,{style:{margin:"24px auto 24px"}}):null):a()(Je,{})}var gi=i(2438);function hi(e){let{spaceStore:t}=e;return(0,Ze.VK)((()=>{const{data:e}=ke.default.state;if(!e)return{loading:!0};const i=j.CM(e);if(!i.every((e=>He.U6.createChildStore(t,{table:Qt.KJ,id:e.userId}).isReady())))return{loading:!0};const n=i.filter(gi.CF),a=i.filter(gi.du);return{loading:!1,members:n.map((e=>{let{userId:i}=e;return He.U6.createChildStore(t,{table:Qt.KJ,id:i})})),guests:a.map((e=>{let{userId:i}=e;return He.U6.createChildStore(t,{table:Qt.KJ,id:i})}))}}),[t])}var fi=i(84619),vi=i(16639),yi=i(43145),Si=i(46978),bi=i(85567),Mi=i(719);const wi=(0,v.defineMessages)({usersPlaceholder:{id:"adminContentSearchTab.pagesTable.filters.users.usersPlaceholder",defaultMessage:"Search for users..."},usersAndGroupsPlaceholder:{id:"adminContentSearchTab.pagesTable.filters.users.usersAndGroupsPlaceholder",defaultMessage:"Search for users and groups..."}});function Ci(e){let{userStores:t,title:i,selectedItems:n,setSelectedItems:o,onMenuClose:r,isMultiSelect:l,includePermissionGroups:c,guestUserIdSet:u}=e;window.__c={n:"UsersFilter"};const p=(0,v.useIntl)(),g=(0,Ze.qz)(void 0,nt.Z),h=(0,xe.yK)((e=>({optionContainer:{display:"flex",flexDirection:"row",alignItems:"center"},optionAvatar:{marginRight:8},container:{padding:"6px 0 6px"},input:{margin:"4px auto",width:"95%",maxHeight:200,overflowY:"auto"},footer:{padding:"8px 8px 2px 8px",justifyContent:"space-between",display:"flex"},icon:{width:16,marginRight:4,fill:"currentColor"},defaultGroupIcon:{height:22,width:22,color:e.mediumTextColor,fill:"currentColor"},defaultGroupIconPill:{height:14,width:14,color:e.mediumTextColor,fill:"currentColor"},groupIconSpacing:{marginRight:8},pillContainer:{margin:"0px 6px 6px 0px",background:e.legacyDefaultSelectColor,height:20},guestPillContainer:{margin:"0px 6px 6px 0px",background:e.guestTokenBackground,height:20},guestIcon:{height:16,width:16,color:e.guestIconColor},pillContents:{display:"inline-flex",flexDirection:"row",justifyContent:"center",alignItems:"center"},pillText:{marginLeft:4},noResultsMessage:{width:"100%",margin:"8px 12px"},optionTitle:{display:"block"},optionCaption:{display:"block",color:e.mediumTextColor,fontSize:12,lineHeight:"15px"}})),[]),[f,y]=(0,d.useState)(10),[S,b]=(0,d.useState)(!1),[M,w]=(0,d.useState)(""),C=t.length,_=(0,Ze.VK)((()=>A.default.state.currentSpaceStore),[]),k=(0,d.useMemo)((()=>n.map((e=>{let{id:t}=e;return t}))),[n]),T=(0,Ze.VK)((()=>{const e=A.default.state.currentSpaceStore;return c&&e?e.getPermissionGroups():[]}),[c]),I=(0,Ze.VK)((()=>k.map((e=>t.find((t=>t.id===e)))).filter(x.$K)),[k,t]),P=(0,Ze.VK)((()=>k.map((e=>T.find((t=>t.id===e)))).filter(x.$K)),[k,T]);function Z(){y(10),b(!1),w(""),r()}function F(){w(""),o([])}function E(e){e<5&&f<C&&y(f+10)}function B(e){if(l){return k.includes(e.id)?[...n.filter((t=>{let{id:i}=t;return i!==e.id}))]:[...n,e]}return k.includes(e.id)?[]:[e]}function D(e){const t=B({id:e,type:"user"});o(t),w("")}function R(e){const t=B({id:e,type:"permission_group"});o(t),w("")}const L=(0,d.useCallback)((e=>{w(e.target.value)}),[]),N=(0,Ze.VK)((()=>I.map((e=>{const t=(0,Yt.Nz)(p,e.getModel()),i=!!u&&u.has(e.id);return a()(bi.Z,{isSingle:!0,format:fi.l.Inline,showRemoveButton:!0,onClickRemove:()=>{const t=k.filter((t=>t!==e.id)).map((e=>({id:e,type:"user"})));o(t)},style:i?h.guestPillContainer:h.pillContainer,value:a()("div",{style:h.pillContents},void 0,i?m.Z.globe2(h.guestIcon):a()($t.Z,{userStore:e,size:16}),a()(Ae.Z,{style:h.pillText},void 0,t))},e.id)}))),[k,I,o,u,h,p]),O=(0,Ze.VK)((()=>P.map((e=>{const t=vi.kF({intl:p,group:e});return a()(bi.Z,{isSingle:!0,format:fi.l.Inline,showRemoveButton:!0,onClickRemove:()=>{const t=k.filter((t=>t!==e.id)).map((e=>({id:e,type:"permission_group"})));o(t)},style:h.pillContainer,value:a()("div",{style:h.pillContents},void 0,a()(je.Z,{disabled:!0,icon:e.icon&&_?{pointer:_.pointer,icon:e.icon}:void 0,size:14,isEmptyPage:!1,title:t,defaultIcon:m.Z.typesPerson(h.defaultGroupIconPill),style:h.groupIconSpacing}),a()(Ae.Z,{style:h.pillText},void 0,t))},e.id)}))),[k,P,o,h,_,p]);const V=a()(at.Z,{on:k.length>0,icon:m.Z.person(h.icon),title:i,onClick:()=>b(!0)});return a()(ut.Z,{},void 0,a()(dt.ZP,{popupType:dt.ZP.PopupType.Popup,placementToOrigin:dt.ZP.Placement.Bottom,alignmentToOrigin:dt.ZP.Alignment.Start,open:S,render:function(){const e=[];for(const n of t){var i;const t=(0,Yt.Nz)(p,n.getModel()),o=!!u&&u.has(n.id);(t.toLocaleLowerCase().includes(M)||null!==(i=n.getEmail())&&void 0!==i&&i.toLocaleLowerCase().includes(M))&&e.push({key:n.id,action:()=>D(n.id),render:e=>d.createElement(ot.Z,s()({},e,{icon:l?a()(st.Z,{checked:k.includes(n.id),onClick:()=>D(n.id),size:16}):a()(Si.Z,{isSelected:k.includes(n.id)}),focused:!1,title:a()("div",{style:h.optionContainer},void 0,a()($t.Z,{userStore:n,size:24,style:h.optionAvatar}),a()("div",{style:{paddingTop:4,paddingBottom:4}},void 0,a()(Ae.Z,{style:h.optionTitle},void 0,t),a()(Ae.Z,{style:h.optionCaption},void 0,a()(v.FormattedMessage,o?{id:"adminContentSearchTab.pagesTable.filters.users.guestCaption",defaultMessage:"Guest"}:{id:"adminContentSearchTab.pagesTable.filters.users.memberCaption",defaultMessage:"Member"}))))}))})}const r=[];for(const t of T){const e=vi.kF({intl:p,group:t});e.toLocaleLowerCase().includes(M)&&r.push({key:t.id,action:()=>R(t.id),render:i=>d.createElement(ot.Z,s()({},i,{icon:l?a()(st.Z,{checked:k.includes(t.id),onClick:()=>R(t.id),size:16}):a()(Si.Z,{isSelected:k.includes(t.id)}),focused:!1,title:a()("div",{style:h.optionContainer},void 0,a()(je.Z,{disabled:!0,icon:t.icon&&_?{pointer:_.pointer,icon:t.icon}:void 0,size:22,isEmptyPage:!1,title:e,defaultIcon:m.Z.typesPerson(h.defaultGroupIcon),style:h.groupIconSpacing}),a()("div",{style:{paddingTop:4,paddingBottom:4}},void 0,a()(Ae.Z,{style:h.optionTitle},void 0,e),a()(Ae.Z,{style:h.optionCaption},void 0,a()(v.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.users.groupCaption",defaultMessage:"Group"}))))}))})}const y={key:"no-results",action:()=>{},render:e=>d.createElement(Ae.Z,s()({isSecondaryColor:!0,style:h.noResultsMessage},e),a()(v.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.users.noResultsMessage",defaultMessage:"No results found."}))},S=[...e,...r],b={key:"userOptions",items:S.length>0?S.slice(0,f):[y],render:e=>d.createElement(ct.Z,s()({},e,{title:null,loading:!1}))};return a()("div",{style:h.container},void 0,a()(Mi.Z,{focus:!0,value:M,style:h.input,placeholder:z.default.formatMessage(c?wi.usersAndGroupsPlaceholder:wi.usersPlaceholder),onChange:L,onRemoveLastToken:()=>{const e=n.slice(0,-1);o(e)},tokens:[...N,...O]}),a()(rt.Z,{menuType:it.og.Popup,header:null,maxHeight:250,width:300},void 0,a()(lt.Z,{type:lt.i.Vertical,store:g,initialFocus:0,sections:[b]}),a()(yi.Z,{onChange:E})),a()(ct.Z,{topBorder:!0,style:h.footer},void 0,a()(Xe.Z,{onClick:F},void 0,a()(v.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.users.clearButton",defaultMessage:"Clear"})),a()($e.Z,{onClick:Z},void 0,a()(v.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.users.doneButton",defaultMessage:"Done"}))))},onDismiss:Z,keepFocus:!0,origin:V,preventScaleTransition:!0}))}function _i(e){let{spaceStore:t,createdByFilterIds:i,setCreatedByFilter:n,runNewSearch:o,includeGuests:s}=e;window.__c={n:"CreatedByFilter"};const r=hi({spaceStore:t}),l=(0,d.useMemo)((()=>r.loading?[]:s?[...r.members,...r.guests]:r.members),[r,s]),c=(0,d.useMemo)((()=>r.loading?new Set:new Set(r.guests.map((e=>e.id)))),[r]);const u=(0,d.useMemo)((()=>i.map((e=>({id:e,type:"user"})))),[i]);return a()(Ci,{userStores:l,title:a()(v.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.createdBy.title",defaultMessage:"Created by"}),selectedItems:u,setSelectedItems:function(e){const t=e.map((e=>{let{id:t}=e;return t}));n(t)},onMenuClose:o,guestUserIdSet:c})}var ki=i(40506),Ti=i(80084),Ii=i(64921),Pi=i(14871),Zi=i(76150),xi=i(13854),Fi=i(41558),Ai=i(3386),Ei=i(67950),Bi=i(40721),Di=i(86825),Ri=i(46945),Li=i(84795);const Ni="Invalid date",Oi="Invalid range";class Vi extends B.default{getInitialState(){return{dateEdited:!1,timeEdited:!1,temporaryValue:{date:void 0,time:void 0},error:void 0}}}const Ui=Vi;var Wi=i(74194);class Ki extends c.Z{constructor(){super(...arguments),this.storeTypes={store:Ui},this.renderInput=()=>{const{device:e}=this.environment,{store:t,hideClearButton:i,focus:n,showTime:o,placeholder:r,...l}=this.props,c=e.isMobile?"date":"text",u=e.isMobile?"time":"text",m=Wi.Z.Format.Transparent,p=e.isMobile?void 0:n;return a()("div",{style:{display:"flex",alignItems:"center",borderRadius:3,lineHeight:2,background:this.theme.inputBackground,paddingLeft:8,paddingRight:8,flexBasis:"50%",...this.getInputStyles().inputOuterStyle}},void 0,d.createElement(Wi.Z,s()({},l,{type:c,format:m,placeholder:r,focus:"date"===p,onFocus:this.handleDateFocus,onChange:this.handleDateChange,onSubmit:e=>this.handleSubmit(e,"date"),onBlur:this.handleBlur,value:this.getDateInputValue(),size:1,style:{fontSize:e.isMobile?16:14},showClearButton:!o&&this.showClearButton(),onClearButtonClick:this.handleClear})),o&&d.createElement(d.Fragment,null,a()("div",{style:{height:14,width:1,background:this.theme.regularDividerColor,marginLeft:6,marginRight:12,flexShrink:0}}),d.createElement(Wi.Z,s()({},l,{placeholder:z.default.formatMessage(Gi.timePlaceholder),type:u,format:m,focus:"time"===p,onFocus:this.handleTimeFocus,onChange:this.handleTimeChange,onSubmit:e=>this.handleSubmit(e,"time"),onBlur:this.handleBlur,value:this.getTimeInputValue(),size:1,style:{fontSize:e.isMobile?16:14},showClearButton:this.showClearButton(),onClearButtonClick:this.handleClear}))))},this.handleDateFocus=e=>{const{onDateFocus:t}=this.props,{store:i}=this.stores;i.setState({...i.state,dateEdited:!1}),t&&t(e)},this.handleTimeFocus=e=>{const{onTimeFocus:t}=this.props,{store:i}=this.stores;i.setState({...i.state,timeEdited:!1}),t&&t(e)},this.handleClear=()=>{const{onClear:e,onUpdate:t}=this.props,{store:i}=this.stores;i.setState({...i.state,dateEdited:!0,timeEdited:!0,temporaryValue:{date:void 0,time:void 0},error:void 0});const n=this.validateCurrent();n&&t(n),i.setState({...i.state,dateEdited:!1,timeEdited:!1}),e&&e()},this.handleDateChange=e=>{const{device:t}=this.environment,{store:i}=this.stores;i.setState({...i.state,dateEdited:!0,temporaryValue:{...i.state.temporaryValue,date:e.target.value||""}}),t.isAndroid&&this.handleBlur()},this.handleTimeChange=e=>{const{device:t}=this.environment,{store:i}=this.stores;i.setState({...i.state,timeEdited:!0,temporaryValue:{...i.state.temporaryValue,time:e.target.value||""}}),t.isAndroid&&this.handleBlur()},this.handleSubmit=(e,t)=>{var i,n;const{onUpdate:a,onSubmit:o,showTime:s}=this.props,{store:r}=this.stores;let l;(!s||"date"===t&&null!==(i=this.props.value)&&void 0!==i&&i.start_time||"time"===t&&null!==(n=this.props.value)&&void 0!==n&&n.start_date)&&(l=this.validateCurrent(),l&&(a(l),l.error?r.setState({...r.state,dateEdited:!1,error:l.error}):r.reset())),o&&o(e,l)},this.handleBlur=e=>{const{onUpdate:t,onBlur:i}=this.props,{store:n}=this.stores,a=this.validateCurrent();a?(t(a),a.error?n.setState({...n.state,dateEdited:!1,timeEdited:!1,error:a.error}):n.reset()):n.setState({...n.state,dateEdited:!1,timeEdited:!1}),e&&i&&i(e)},this.styles={menuItem:{marginBottom:this.environment.device.isMobile?1:12},inputWrapper:{borderRadius:3,height:28,paddingRight:this.showClearButton()?6:0,position:"relative"},inputEditRegion:{width:this.showClearButton()?"calc(100% - 14px)":"100%"},inputEditRegionMobile:{padding:"2px 6px",position:"relative"},tooltipOriginGap:-8}}didUpdate(e){const{store:t}=this.stores;l().isEqual(e.value,this.props.value)||t.reset()}renderComponent(){const e=this.styles,t=this.getError();return t?a()(We.Z,{renderTooltip:()=>t,forceVisibleState:!0,placement:We.Z.Placement.Left,render:this.renderInput,originGap:e.tooltipOriginGap}):this.renderInput()}getDateInputValue(){const{device:e}=this.environment,{value:t,intl:i}=this.props,{store:n}=this.stores;return e.isMobile?t?ne.dd(t,i):"":n.state.temporaryValue.date?n.state.temporaryValue.date:n.state.dateEdited?n.state.temporaryValue.date||"":t?ne.dd(t,i):""}getTimeInputValue(){const{device:e}=this.environment,{value:t,intl:i}=this.props,{store:n}=this.stores;return e.isMobile?t?ne.KN(t,i):"":n.state.temporaryValue.time?n.state.temporaryValue.time:n.state.timeEdited?n.state.temporaryValue.time||"":t?ne.KN(t,i):""}getError(){const{store:e}=this.stores,{intl:t}=this.props;if(e.state.error)switch(e.state.error){case Ni:return t.formatMessage({id:"dateInputError.invalidDateError.tooltip",defaultMessage:"Invalid date"});case Oi:return t.formatMessage({id:"dateInputError.invalidDateRangeError.tooltip",defaultMessage:"Invalid range"});default:(0,x.t1)(e.state.error)}}validateCurrent(){const{validate:e}=this.props,t=this.parseCurrentDateTimeValue();if(t)return e?e(t):t}parseCurrentDateTimeValue(){const{store:e}=this.stores,{value:t,showTime:i,isEndingDate:n}=this.props;if(!e.state.dateEdited&&!e.state.timeEdited)return;if(!e.state.temporaryValue.date&&!e.state.temporaryValue.time)return{value:void 0};const a=(0,Li.parseDateValue)(e.state.temporaryValue.date||"",this.props.intl);if(a){let e="";return e=i?(null==t?void 0:t.start_time)||"00:00":n?"23:59":"00:00",{value:{type:"datetime",start_date:a,time_zone:(null==t?void 0:t.time_zone)||(0,qe.r)(),start_time:e}}}const o=(0,Li.parseTimeValue)(e.state.temporaryValue.time||"",this.props.intl);return(null!=t&&t.start_date||a)&&o?{value:{type:"datetime",start_date:(null==t?void 0:t.start_date)||a,start_time:o,time_zone:(null==t?void 0:t.time_zone)||(0,qe.r)()}}:{error:Ni}}showClearButton(){const{device:e}=this.environment,{hideClearButton:t}=this.props;return!!e.isMobile||!t}getInputStyles(){const{device:e}=this.environment,{inputStyle:t,inputOuterStyle:i,style:n}=this.props,a=this.styles;return{style:{...a.menuItem,...n},inputOuterStyle:{...a.inputWrapper,...i,...this.getInputBorders()},inputStyle:{...a.inputEditRegion,...e.isMobile&&a.inputEditRegionMobile,...t}}}getInputBorders(){const{disabled:e,focus:t}=this.props,i=this.getThemeColors(),n=this.getError();if(!e)return n?i.inputError:t?i.inputFocused:i.inputDefault}getThemeColors(){return{inputDefault:{background:this.theme.inputBackground,boxShadow:this.theme.inputBoxShadow},inputFocused:{boxShadow:this.theme.outlineBlueInputBoxShadow},inputError:{boxShadow:this.theme.outlineRedInputBoxShadow},placeholder:{color:this.theme.lightTextColor}}}}Ki.displayName="DateTimeInputMenuItem";const zi=(0,v.injectIntl)(Ki),Gi=(0,v.defineMessages)({startingDateMessage:{defaultMessage:"Starting",id:"auditLog.dateTimeRangeMenu.startingDatePlaceholder"},endingDateMessage:{defaultMessage:"Ending",id:"auditLog.dateTimeRangeMenu.endingDatePlaceholder"},timePlaceholder:{defaultMessage:"12:00 AM",id:"auditLog.dateTimeRangeMenu.timePlaceholderInNumber"}});class qi extends c.Z{constructor(){super(...arguments),this.storeTypes={store:xi.ZP,dayRangeStore:Fi.Z},this.renderInputs=()=>{const{device:e,WindowSizeStore:t}=this.environment,{value:i,disabled:n}=this.props,{store:o}=this.stores,s=o.getFocus();let r="date";s!==Zi.Hv.StartTime&&s!==Zi.Hv.EndTime||(r="time");const l=this.getRangeBounds();return a()("div",{style:{paddingTop:e.isMobile?16:12,paddingBottom:e.isMobile?16:8,paddingLeft:e.isMobile?t.getSafePaddingLeftCSS(16):14,paddingRight:e.isMobile?t.getSafePaddingRightCSS(16):14,display:o.state.showTime?"block":"flex",...e.isMobile&&{boxShadow:`\n\t\t\t\t\t\t\t0 1px 0 ${this.theme.regularDividerColor}\n\t\t\t\t\t\t`,position:"relative",zIndex:2},background:e.isMobile?this.theme.popoverBackground:void 0}},void 0,a()(zi,{disabled:n,placeholder:z.default.formatMessage(Gi.startingDateMessage),focus:s===Zi.Hv.StartDate||s===Zi.Hv.StartTime?r:void 0,value:i.starting,validate:this.validateStart,onUpdate:this.handleUpdateStart,onDateFocus:()=>this.handleDateFocus(Zi.Hv.StartDate),onTimeFocus:()=>this.handleTimeFocus(Zi.Hv.StartTime),onSubmit:(e,t)=>this.handleStartSubmit(e,t,s),inputElementAttributes:{max:l.latestValidStarting},showTime:o.state.showTime}),a()("div",{style:{width:12,height:8}}),a()(zi,{disabled:n,placeholder:z.default.formatMessage(Gi.endingDateMessage),focus:s===Zi.Hv.EndDate||s===Zi.Hv.EndTime?r:void 0,value:i.ending,validate:this.validateEnd,onUpdate:this.handleUpdateEnd,onDateFocus:()=>this.handleDateFocus(Zi.Hv.EndDate),onTimeFocus:()=>this.handleTimeFocus(Zi.Hv.EndTime),onSubmit:(e,t)=>this.handleEndSubmit(e,t,s),inputElementAttributes:{min:l.earliestValidEnding},showTime:o.state.showTime}))},this.renderCalendar=()=>{const{device:e}=this.environment,{value:t,onUpdate:i}=this.props,{store:n,dayRangeStore:o}=this.stores,s=this.styles,r=this.getThemeColors(),l={...s.pickerSection,...e.isMobile&&s.pickerSectionMobile,...e.isMobile&&r.pickerSectionMobile};return a()(ct.Z,{},void 0,a()("div",{style:l},void 0,a()(Ri.Z,{value:ne.Zy(t),dateTimeStore:n,store:o,onUpdate:e=>{if(e.error)return;const n=ne.PM(t,e.value);return i({error:e.error,value:n})},validate:this.validateDateRangeField})))},this.handleDateFocus=e=>{const{store:t,dayRangeStore:i}=this.stores;t.setState({...t.state,focus:e});const n=xi.QJ[e];i.setState({...i.state,focus:n})},this.handleTimeFocus=e=>{const{store:t}=this.stores;t.setState({...t.state,focus:e})},this.handleUpdateStart=e=>{const{onUpdate:t}=this.props;e.error||t({value:{...this.props.value,starting:e.value}})},this.handleUpdateEnd=e=>{const{onUpdate:t}=this.props;e.error||t({value:{...this.props.value,ending:e.value}})},this.handleStartSubmit=(e,t,i)=>{const{store:n,dayRangeStore:a}=this.stores;t&&t.error||(i===Zi.Hv.StartDate&&n.state.showTime?n.setState({...n.state,focus:Zi.Hv.StartTime}):(n.setState({...n.state,focus:Zi.Hv.EndDate}),a.setState({...a.state,focus:"ending"})))},this.handleEndSubmit=(e,t,i)=>{const{store:n}=this.stores;t&&t.error||i===Zi.Hv.EndDate&&n.state.showTime&&n.setState({...n.state,focus:Zi.Hv.EndTime})},this.validateStart=e=>{const t=this.validateField("starting",e);return t.error?t:{value:t.value.starting}},this.validateEnd=e=>{const t=this.validateField("ending",e);return t.error?t:{value:t.value.ending}},this.validateField=(e,t)=>{const{value:i}=this.props;return t.error?t:this.validateRange({...i,[e]:t.value})},this.validateRange=e=>{if(e.starting&&e.ending){const t=Y.OQ.notionDateTimeToLuxon(e.starting);return Y.OQ.notionDateTimeToLuxon(e.ending)>=t?{value:e}:{error:Ei.B.INVALID_RANGE}}return{value:e}},this.getMenuProps=()=>{const{device:e}=this.environment,{onDismiss:t,title:i}=this.props;if(e.isMobile){return{menuType:it.og.Modal,title:i,right:a()(Bi.DoneMenuText,{}),onClickRight:t,header:this.renderInputs()}}return{menuType:it.og.Popup,onClickOutside:t,footer:this.props.footer}},this.validateDateRangeField=(e,t)=>{const{value:i}=this.props;if(t.error)return t;const n=ne.Zy(i);return this.validateDateRange({...n,[e]:t.value})},this.validateDateRange=e=>{if(e.starting&&e.ending){const t=Y.OQ.notionDateToLuxon(e.starting);return Y.OQ.notionDateToLuxon(e.ending)>=t?{value:e}:{error:Ei.B.INVALID_RANGE}}return{value:e}},this.styles={pickerSection:{paddingLeft:16,paddingRight:16},pickerSectionMobile:{paddingTop:16,paddingBottom:8},sidebar:{paddingTop:12,paddingBottom:24,overflowY:"auto",overflowX:"hidden",flex:"0 0 220px",backgroundColor:this.theme.sidebarSecondaryBackground,borderLeft:`1px solid ${this.theme.regularDividerColor}`,maxWidth:"fit-content"},menuItem:{minHeight:void 0,paddingTop:this.environment.device.isMobile?12:4,paddingBottom:this.environment.device.isMobile?12:4,color:this.theme.mediumTextColor}}}didMount(){const{store:e}=this.stores;void 0!==this.props.showTime&&e.setState({...e.state,showTime:this.props.showTime})}renderComponent(){const{device:e}=this.environment;return d.createElement(rt.Z,this.getMenuProps(),a()("div",{style:{display:"flex",flexDirection:"row"}},void 0,a()("div",{},void 0,this.props.header,!e.isMobile&&this.renderInputs(),this.renderCalendar()),this.renderSidebar()))}renderSidebar(){const{store:e}=this.stores,{onUpdate:t,value:i,hideTime:n}=this.props;return a()("aside",{style:this.styles.sidebar},void 0,n?null:a()(Di.Z,{title:a()(v.FormattedMessage,{id:"auditlogDateFilter.timeToggle",defaultMessage:"Use time"}),on:e.state.showTime,onClick:()=>{if(e.toggleShowTime(),e.state.showTime){const e=i;e.starting&&(e.starting.start_time="00:00"),e.ending&&(e.ending.start_time="23:59"),t({value:e})}},focused:!1}),a()(ot.Z,{focused:!1,title:a()(v.FormattedMessage,{id:"auditlogDateFilter.quickFilters.today",defaultMessage:"Today"}),onClick:()=>{const e=Date.now(),t=Y.CQ(e,(0,qe.r)());this.setStoresTemporaryValue({starting:{...t,start_time:"00:00"},ending:t})},style:this.styles.menuItem}),a()(ot.Z,{focused:!1,title:a()(v.FormattedMessage,{id:"auditlogDateFilter.quickFilters.yesterday",defaultMessage:"Yesterday"}),onClick:()=>{const e=Y.Cv((0,qe.r)());this.setStoresTemporaryValue({starting:{type:"datetime",start_date:e.start_date,start_time:"00:00",time_zone:(0,qe.r)()},ending:{type:"datetime",start_date:e.start_date,start_time:"23:59",time_zone:(0,qe.r)()}})},style:this.styles.menuItem}),a()(ot.Z,{focused:!1,title:a()(v.FormattedMessage,{id:"auditlogDateFilter.quickFilters.lastWeek",defaultMessage:"Last 7 days"}),onClick:()=>{const e=Y.Oo((0,qe.r)()),t=Y.CQ(Date.now(),(0,qe.r)());this.setStoresTemporaryValue({starting:{type:"datetime",start_date:e.start_date,start_time:"00:00",time_zone:(0,qe.r)()},ending:t})},style:this.styles.menuItem}),a()(ot.Z,{focused:!1,title:a()(v.FormattedMessage,{id:"auditlogDateFilter.quickFilters.lastMonth",defaultMessage:"Last 30 days"}),onClick:()=>{const e=Y.dj((0,qe.r)()),t=Y.CQ(Date.now(),(0,qe.r)());this.setStoresTemporaryValue({starting:{type:"datetime",start_date:e.start_date,start_time:"00:00",time_zone:(0,qe.r)()},ending:t})},style:this.styles.menuItem}))}setStoresTemporaryValue(e){const{store:t,dayRangeStore:i}=this.stores;e.ending&&this.handleDateFocus(Zi.Hv.EndDate),t.setState({...t.state,temporaryDateRange:e}),i.setState({...i.state,displayMonth:e.starting||e.ending?Y.Sy(e.starting||e.ending):void 0,temporaryDateRange:{starting:ne.Qb(e.starting),ending:ne.Qb(e.ending)}})}getRangeBounds(){const{value:e,intl:t}=this.props;return{earliestValidEnding:e.starting&&ne.o0(e.starting,t),latestValidStarting:e.ending&&ne.o0(e.ending,t)}}getThemeColors(){return{pickerSectionMobile:{background:this.theme.popoverBackground,boxShadow:`0 1px 0 ${this.theme.regularDividerColor}`,marginBottom:1}}}}qi.displayName="DateTimeRangeMenu";const Hi=(0,v.injectIntl)(qi);var ji=i(255),Qi=i(98707),Yi=i(75689);class $i extends c.Z{constructor(){super(...arguments),this.storeTypes={store:xi.ZP,dayRangeStore:Fi.Z},this.renderActiveButtonOrigin=()=>{const{value:e,disabled:t,focused:i,intl:n}=this.props,o=this.styles,s=this.getThemeColors(),r={...o.menuItem,...s.activeMenuItem},l=Ti._Q(e,n),d=a()(ji.Z,{onClick:this.handleClear,disabled:t});return a()(ot.Z,{focused:i,disabled:t,icon:m.Z.calendar(o.iconActiveDesktop),title:l,right:d,isTokenTitle:!0,alignIconTop:!0,onClick:this.handleOriginActivate,desktopTitleStyle:o.menuItemTitleDesktop,desktopIconStyle:o.iconActiveDesktopWrapper,style:r})},this.renderInactiveButtonOrigin=()=>{const{title:e,icon:t,disabled:i,focused:n,mode:o}=this.props,s=this.styles,r=this.getThemeColors(),l={...s.menuItem,...r.buttonMenuItem,...o===Qi.Z.Mode.Pill?{width:"fit-content",border:"solid 1px",paddingLeft:0,paddingRight:0,borderRadius:20,fontSize:12}:{}};return a()(ot.Z,{focused:n,disabled:i,icon:t(s.icon),title:e,onClick:this.handleOriginActivate,style:l})},this.renderPillButtonOrigin=()=>{const{value:e,pillTitle:t}=this.props,i=a()(v.FormattedMessage,{id:"searchDateFilter.shortTitle",defaultMessage:"Date"});return a()(at.Z,{on:Boolean(e.starting||e.ending),icon:m.Z.calendar({width:16,marginRight:6,fill:"currentColor"}),title:a()("span",{},void 0,t||i),onClick:this.handleOriginActivate})},this.renderPopupContents=()=>{const{title:e,header:t,showButtons:i,sidebar:n,hideTime:o}=this.props,{store:s,dayRangeStore:r}=this.stores;return d.createElement(d.Fragment,null,a()(Hi,{title:e,value:this.getCurrentValue(),onUpdate:this.updateTemporary,store:s,dayRangeStore:r,onDismiss:this.handleMenuClose,footer:"footer"===i&&this.renderFooter(),sidebar:n,hideTime:o,header:t}),"side"===i&&a()("div",{style:{display:"flex",justifyContent:"space-between",width:"100%",padding:"0px 10px"}},void 0,a()(Xe.Z,{isGray:!0,style:{marginLeft:"auto",marginRight:8},onClick:this.handleMenuClose},void 0,a()(v.FormattedMessage,{defaultMessage:"Cancel",id:"searchDateFilter.cancelButton.label"})),a()($e.Z,{onClick:()=>this.props.onChange(this.stores.store.state.temporaryDateRange)},void 0,a()(v.FormattedMessage,{defaultMessage:"Accept",id:"searchDateFilter.acceptButton.label"}))))},this.renderFooter=()=>{const{store:e,dayRangeStore:t}=this.stores;return a()(ct.Z,{topBorder:!0,style:{padding:"8px 8px 2px 8px",justifyContent:"space-between",display:"flex"}},void 0,a()(Xe.Z,{onClick:()=>{e.clearTemporaryDateRange(),t.clearTemporaryDateRange(),this.props.onChange({starting:void 0,ending:void 0})}},void 0,a()(v.FormattedMessage,{id:"searchDateFilter.clearButton",defaultMessage:"Clear"})),a()($e.Z,{onClick:e=>{this.props.onChange(this.stores.store.state.temporaryDateRange),this.handleMenuClose(e)}},void 0,a()(v.FormattedMessage,{id:"searchDateFilter.applyButton",defaultMessage:"Apply"})))},this.handleOriginActivate=()=>{const{disabled:e}=this.props,{store:t,dayRangeStore:i}=this.stores;e||(t.setState({...t.state,isOpen:!0,focus:Zi.Hv.StartDate}),i.setState({...i.state,isOpen:!0,focus:"starting"}))},this.handleMenuClose=e=>{const{onChange:t,onMenuDismiss:i,showButtons:n}=this.props,{store:a,dayRangeStore:o}=this.stores,{temporaryDateRange:s}=a.state;Ti.zD(e)||(n||t(s),a.setState({...a.state,isOpen:!1,temporaryDateRange:{starting:void 0,ending:void 0}}),o.setState({...o.state,isOpen:!1,temporaryDateRange:{starting:void 0,ending:void 0}}),i&&i())},this.handleClear=()=>{const{onChange:e}=this.props;e({starting:void 0,ending:void 0})},this.handleMenuListKey=e=>{e.preventDefault&&e.preventDefault()},this.updateTemporary=e=>{const{store:t,dayRangeStore:i}=this.stores;if(e.error)return;const n={starting:(0,ne.Qb)(e.value.starting),ending:(0,ne.Qb)(e.value.ending)};return i.setState({...i.state,temporaryDateRange:{...i.state.temporaryDateRange,...n}}),t.setState({...t.state,temporaryDateRange:{...t.state.temporaryDateRange,...e.value}})},this.styles={menuItem:{minHeight:void 0,paddingTop:this.environment.device.isMobile?12:4,paddingBottom:this.environment.device.isMobile?12:4},icon:{height:16,width:16,marginRight:6},iconActiveDesktop:{height:14,width:14,fill:"currentColor",alignSelf:"flex-start",marginTop:2,marginRight:2},iconActiveDesktopWrapper:{marginTop:0},iconActiveMobile:{height:14,width:14,fill:"currentColor",marginTop:1,marginRight:6},popup:{paddingTop:0,paddingBottom:8},popupWithSidebar:{display:"flex"},menuItemTitleDesktop:{width:"100%"},summary:{display:"inline-flex"}}}didMount(){this.updateTemporary({value:this.props.value})}renderComponent(){const{device:e}=this.environment,{mode:t}=this.props;return e.isMobile?this.renderMobile(t):this.renderDesktop(t)}renderDesktop(e){const{title:t,sidebar:i}=this.props,{store:n}=this.stores,o=this.styles,s=e===Qi.z.Section,r=s?t:void 0,l=(()=>e===Qi.Z.Mode.Section?this.renderActiveButtonOrigin():e===Qi.Z.Mode.Button?this.renderInactiveButtonOrigin():e===Qi.Z.Mode.Pill?this.renderPillButtonOrigin():void(0,x.t1)(e))();return a()(ut.Z,{title:r,marginAfter:s},void 0,a()(Ai.Z,{capture:n.state.isOpen,onUp:this.handleMenuListKey,onDown:this.handleMenuListKey,onEnter:this.handleMenuListKey},void 0,a()(dt.ZP,{popupType:this.getPopupType(),open:n.state.isOpen,origin:l,render:this.renderPopupContents,onDismiss:this.handleMenuClose,placementToOrigin:dt.ZP.Placement.Bottom,alignmentToOrigin:dt.ZP.Alignment.Start,style:i?o.popupWithSidebar:o.popup})))}renderMobile(e){const{store:t}=this.stores,i=e===Qi.z.Section?this.renderMobileFilterSummary():this.renderMobileButtonOrigin();return a()(dt.ZP,{popupType:dt.ZP.PopupType.SlideUp,open:t.state.isOpen,origin:i,render:this.renderPopupContents,onDismiss:this.handleMenuClose,preventScaleTransition:!0})}renderMobileButtonOrigin(){const{icon:e,title:t,disabled:i}=this.props,n=this.styles;return a()(ot.Z,{disabled:i,focused:!1,icon:e(n.icon),title:t,onClick:this.handleOriginActivate})}renderMobileFilterSummary(){const{title:e,value:t,disabled:i,intl:n}=this.props,o=this.styles,s=a()("div",{style:o.summary},void 0,m.Z.calendar(o.iconActiveMobile),Ti._Q(t,n));return a()(Yi.Z,{disabled:i,onClick:this.handleOriginActivate,onClickClear:this.handleClear,label:e,title:s})}getCurrentValue(){const{value:e}=this.props,{store:t}=this.stores,{temporaryDateRange:i}=t.state;return{...e,...i}}getPopupType(){const{device:e}=this.environment;return e.isMobile?dt.ZP.PopupType.SlideUp:dt.ZP.PopupType.Popup}getThemeColors(){return{buttonMenuItem:{color:this.theme.mediumTextColor},activeMenuItem:{color:this.theme.regularTextColor}}}}$i.displayName="DateTimeFilter";const Xi=(0,v.injectIntl)($i);function Ji(e){let{lastEditedTime:t,createdTime:i,setLastEditedTime:n,setCreatedOnTime:o}=e;window.__c={n:"DateFilter"};const s=(0,v.useIntl)(),[r,l]=(0,d.useState)("createdTime"),c=(0,d.useMemo)((()=>{switch(r){case"createdTime":return i;case"lastEditedTime":return t;default:(0,x.t1)(r)}}),[t,i,r]),u=(0,d.useMemo)((()=>{switch(r){case"createdTime":return o;case"lastEditedTime":return n;default:(0,x.t1)(r)}}),[n,o,r]);const p=(0,Ze.VK)((()=>{if((0,ne.mK)(c))switch(r){case"createdTime":return a()(v.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.createdOn.title",defaultMessage:"Created on"});case"lastEditedTime":return a()(v.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.lastEditedOn.title",defaultMessage:"Last edited on"});default:(0,x.t1)(r)}const e=(0,ne.Hq)(c),t=Ti._Q(e,s,ki.sF);switch(r){case"createdTime":return a()(v.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.createdOn.titleWithDateRange",defaultMessage:"Created on: {dateRangeString}",values:{dateRangeString:t}});case"lastEditedTime":return a()(v.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.lastEditedOn.titleWithDateRange",defaultMessage:"Last edited on: {dateRangeString}",values:{dateRangeString:t}});default:(0,x.t1)(r)}}),[c,r,s]);return a()(Xi,{header:a()(en,{selectedItem:r,setSelectedItem:function(e){l(e)}}),mode:Qi.z.Pill,focused:!1,hideTime:!0,pillTitle:p,title:p,icon:m.Z.calendar,value:c,showButtons:"footer",onChange:e=>{u(e)}})}function en(e){let{selectedItem:t,setSelectedItem:i}=e;window.__c={n:"DateTimeFilterSelector"};const n=(0,xe.yK)((e=>({button:{margin:"14px 12px 4px",padding:"2px 8px",width:"fit-content",borderRadius:3},text:{display:"flex",alignItems:"center",color:e.mediumTextColor,fill:e.lightIconColor,fontWeight:500,fontSize:13},icon:{height:10,width:10,marginLeft:4}})),[]),o={width:190,items:["createdTime","lastEditedTime"],selectedItem:t,getKey:e=>e,onSelect:e=>i(e),renderItem:e=>d.createElement(ot.Z,s()({title:tn(e.value)},e)),renderOrigin:e=>d.createElement(Ii.Z,s()({},e,{style:n.button}),a()("div",{style:n.text},void 0,tn(t),m.Z.chevronDown(n.icon)))};return d.createElement(Pi.Z,s()({},o,{mobileActionSheet:!0}))}function tn(e){return{lastEditedTime:a()(v.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.lastEditedOn.option",defaultMessage:"Last edited on"}),createdTime:a()(v.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.createdOn.option",defaultMessage:"Created on"})}[e]}let nn=function(e){return e.OnChange="on-change",e.Button="button",e}({});const an=(0,v.defineMessages)({placeholder:{id:"adminContentSearchTab.pagesTable.filters.query.placeholder",defaultMessage:"Search by page ID, title or content"}});function on(e){let{mode:t,query:i,setQueryFilter:n,placeholderText:o}=e;window.__c={n:"QuerySearchInput"};const[s,l]=(0,d.useState)(i??""),c=(0,xe.yK)((e=>({searchIcon:{color:e.lightIconColor,width:14},input:{padding:"4px 4px 4px 10px",margin:"0 auto 8px",width:"100%",background:e.modalBackground}})),[]),u=(0,d.useMemo)((()=>(0,r.debounce)(n,500)),[n]),p=(0,d.useCallback)((e=>{l(e.target.value),t===nn.OnChange&&u(e.target.value)}),[u,t]);return a()(Wi.Z,{value:s,style:c.input,left:m.Z.collectionSearch(c.searchIcon),placeholder:o||z.default.formatMessage(an.placeholder),onChange:p,onSubmit:()=>n(s),right:t===nn.Button?a()($e.Z,{onClick:()=>n(s)},void 0,a()(v.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.query.searchButton",defaultMessage:"Search"})):null})}function sn(e){let{spaceStore:t,sharedWithFilterItems:i,setSharedWithFilter:n,runNewSearch:o,includeGroups:s,includeGuests:r}=e;window.__c={n:"SharedWithFilter"};const l=hi({spaceStore:t}),c=(0,d.useMemo)((()=>l.loading?[]:r?[...l.members,...l.guests]:l.members),[l,r]),u=(0,d.useMemo)((()=>l.loading?new Set:new Set(l.guests.map((e=>e.id)))),[l]);return a()(Ci,{isMultiSelect:!0,includePermissionGroups:s,userStores:c,title:a()(v.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.sharedWith.title",defaultMessage:"Shared with"}),selectedItems:i??[],setSelectedItems:function(e){const t=e.map((e=>{let{id:t,type:i}=e;return{type:i,id:t}}));n(t.length>0?t:void 0)},onMenuClose:o,guestUserIdSet:u})}const rn=(0,v.defineMessages)({placeholder:{id:"adminContentSearchTab.pagesTable.filters.teams.placeholder",defaultMessage:"Search for teamspaces..."}});function ln(e){let{selectedTeamIds:t,setSelectedTeamIds:i,onMenuClose:n,teamStores:o}=e;window.__c={n:"TeamsFilter"};const r=(0,Ze.qz)(void 0,nt.Z),l=(0,xe.yK)((e=>({optionContainer:{display:"flex",flexDirection:"row",alignItems:"center"},optionAvatar:{marginRight:4},pillContainer:{margin:"0px 6px 6px 0px",background:e.legacyDefaultSelectColor,height:20},pillContents:{display:"inline-flex",flexDirection:"row",justifyContent:"center",alignItems:"center",gap:4},pillText:{marginLeft:4},container:{padding:"6px 0 6px"},input:{margin:"4px auto",width:"95%"},footer:{padding:"8px 8px 2px 8px",justifyContent:"space-between",display:"flex"},icon:{width:16,marginRight:4,fill:"currentColor"},teamIcon:{marginRight:8},optionTitle:{display:"block"},noResultsMessage:{width:"100%",margin:"8px 12px"},optionCaption:{display:"block",color:e.mediumTextColor,fontSize:12,lineHeight:"15px"}})),[]),[c,u]=(0,d.useState)(!1),[p,g]=(0,d.useState)(""),h=(0,Ze.VK)((()=>[...o].sort(F.KP)),[o]),f=(0,Ze.VK)((()=>t.map((e=>o.find((t=>t.id===e)))).filter(x.$K)),[o,t]);function y(){u(!1),g(""),n()}function S(){g(""),i([])}function b(e){const n=t.includes(e)?[]:[e];i(n),g("")}const M=(0,d.useCallback)((e=>{g(e.target.value)}),[]),w=(0,Ze.VK)((()=>f.map((e=>{const n=e.getName();return a()(bi.Z,{isSingle:!0,format:fi.l.Inline,showRemoveButton:!0,onClickRemove:()=>{const n=t.filter((t=>t!==e.id));i(n)},style:l.pillContainer,value:a()("div",{style:l.pillContents},void 0,a()(Mt.p,{disabled:!0,store:e,size:16}),a()(Ae.Z,{style:l.pillText},void 0,n))},e.id)}))),[f,t,i,l]);const C=a()(at.Z,{on:t.length>0,icon:m.Z.typesPerson(l.icon),title:a()(v.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.teams.title",defaultMessage:"Teamspace"}),onClick:()=>u(!0)});return a()(ut.Z,{},void 0,a()(dt.ZP,{popupType:dt.ZP.PopupType.Popup,placementToOrigin:dt.ZP.Placement.Bottom,alignmentToOrigin:dt.ZP.Alignment.Start,open:c,render:function(){const e=[];for(const o of h){const i=o.getName(),n=o.getTeamAccessLevel(),r=o.isDefault();i&&i.toLocaleLowerCase().includes(p)&&e.push({key:o.id,action:()=>b(o.id),render:e=>d.createElement(ot.Z,s()({},e,{icon:a()(Si.Z,{isSelected:t.includes(o.id)}),focused:!1,title:a()("div",{style:l.optionContainer},void 0,a()(Mt.p,{disabled:!0,store:o,size:24,style:l.teamIcon}),a()("div",{style:{paddingTop:4,paddingBottom:4}},void 0,a()(Ae.Z,{style:l.optionTitle},void 0,i),a()(Ae.Z,{style:l.optionCaption},void 0,dn(n,r))))}))})}const i={key:"no-results",action:()=>{},render:e=>d.createElement(Ae.Z,s()({isSecondaryColor:!0,style:l.noResultsMessage},e),a()(v.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.teams.noResultsMessage",defaultMessage:"No results found."}))},n={key:"teamOptions",items:e.length>0?e:[i],render:e=>d.createElement(ct.Z,s()({},e,{title:null,loading:!1}))};return a()("div",{style:l.container},void 0,a()(Mi.Z,{focus:!0,value:p,style:l.input,placeholder:z.default.formatMessage(rn.placeholder),onChange:M,onRemoveLastToken:S,tokens:w}),a()(rt.Z,{menuType:it.og.Popup,header:null,maxHeight:250,width:300},void 0,a()(lt.Z,{type:lt.i.Vertical,store:r,initialFocus:0,sections:[n]})),a()(ct.Z,{topBorder:!0,style:l.footer},void 0,a()(Xe.Z,{onClick:S},void 0,a()(v.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.teams.clearButton",defaultMessage:"Clear"})),a()($e.Z,{onClick:y},void 0,a()(v.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.teams.doneButton",defaultMessage:"Done"}))))},onDismiss:y,keepFocus:!0,origin:C,preventScaleTransition:!0}))}function dn(e,t){if(t)return a()(v.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.teams.caption.default",defaultMessage:"Default"});switch(e){case"private":return a()(v.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.teams.caption.private",defaultMessage:"Private"});case"closed":return a()(v.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.teams.caption.closed",defaultMessage:"Closed"});case"open":return a()(v.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.teams.caption.open",defaultMessage:"Open"});default:(0,x.t1)(e)}}function cn(e){let{spaceStore:t,filters:i,runNewSearch:n,setFilters:o}=e;window.__c={n:"FiltersSection"};const s=function(){const[e,t]=(0,d.useState)([]),i=(0,Pe.O7)(),n=(0,Ze.VK)((()=>A.default.state.currentSpaceStore),[]),a=(0,Ze.VK)((()=>{var e;return null===(e=A.default.state.currentUserStore)||void 0===e?void 0:e.id}),[]);return(0,d.useEffect)((()=>{!async function(){const e=await(0,F.sj)({spaceStore:n,currentUserId:a,includeArchived:!1,minRoleOnTeamStores:"editor",environment:i});t(e)}()}),[n,a,i]),e}(),r=(0,xe.yK)((e=>({container:{margin:"0 auto 14px"},filterPillsContainer:{width:"100%",display:"flex",flexWrap:"wrap",rowGap:4,flexDirectionRow:"row",alignItemsCenter:"center"}})),[]);return a()("div",{style:r.container},void 0,a()(on,{mode:nn.Button,query:i.query,setQueryFilter:function(e){o({query:e},{runSearchAfter:!0})}}),a()("div",{style:r.filterPillsContainer},void 0,a()(Ji,{lastEditedTime:i.lastEditedTime,createdTime:i.createdTime,setLastEditedTime:function(e){o({lastEditedTime:e,createdTime:{starting:void 0,ending:void 0}},{runSearchAfter:!0})},setCreatedOnTime:function(e){o({createdTime:e,lastEditedTime:{starting:void 0,ending:void 0}},{runSearchAfter:!0})}}),a()(ln,{selectedTeamIds:i.teamIds,setSelectedTeamIds:function(e){o({teamIds:e})},onMenuClose:n,teamStores:s}),a()(sn,{spaceStore:t,sharedWithFilterItems:i.sharedWith,setSharedWithFilter:function(e){o({sharedWith:e})},runNewSearch:n,includeGroups:!0,includeGuests:!0}),a()(mt,{selectedAudience:i.audience,setSelectedAudience:function(e){o({audience:e})},onMenuClose:n}),a()(_i,{spaceStore:t,createdByFilterIds:i.createdBy,setCreatedByFilter:function(e){o({createdBy:e})},runNewSearch:n,includeGuests:!0})))}var un=i(26263),mn=i(7406),pn=i(55384),gn=i(45953),hn=i(21202),fn=i(66504);const vn={query:"",createdBy:[],sharedWith:void 0,audience:[],lastEditedTime:{starting:void 0,ending:void 0},createdTime:{starting:void 0,ending:void 0},teamIds:[]},yn={...vn,audience:["shared_externally","shared_internally","shared_to_web"]},Sn={filters:vn,pageStores:[],numPagesLoaded:0,hasNextPage:!0,paginationToken:void 0,loading:!1,error:void 0,shouldReRunSearch:!1,showSuggestions:!0},bn={...Sn,filters:yn};function Mn(e){let{spaceStore:t,userStore:i}=e;const n=(0,Ze.VK)((()=>k.default.checkGate("enabled_bev_default_audience_filter")),[])?bn:Sn,a=(0,Pe.O7)(),[o,s]=(0,d.useState)(n),r=(0,d.useRef)(n.filters),c=(0,d.useCallback)((async e=>{let{restartSearch:n,ignoreFilterComparison:d}=e;if(!d&&l().isEqual(o.filters,r.current))return;r.current=o.filters;let c=o.loading,u=o.error,m=o.hasNextPage,p=o.numPagesLoaded,g=o.paginationToken;if(n&&(s((e=>({...Sn,showSuggestions:e.showSuggestions,filters:e.filters}))),c=Sn.loading,u=Sn.error,m=Sn.hasNextPage,p=Sn.numPagesLoaded,g=Sn.paginationToken),m&&!c&&!u){s((e=>({...e,showSuggestions:!1,loading:!0})));try{const e=await T.adminContentSearch(a,{spaceId:t.id,sort:{field:"relevance",direction:"desc"},limit:20,paginationToken:g,query:o.filters.query,audience:o.filters.audience,lastEditedTime:(0,ne.Hq)(o.filters.lastEditedTime),createdTime:(0,ne.Hq)(o.filters.createdTime),createdBy:o.filters.createdBy,sharedWith:o.filters.sharedWith,teamspaceIds:o.filters.teamIds});if("failed"===e.type)throw e.error;b.jdc(a,{filters:o.filters,pageNumber:p});const n=e.data.paginationToken,r=e.data.recordIds,d=function(e){const{recordMapWithRoleJson:t}=e,i=gn.PF.create(t),n=gn.PF.create();for(const{pointer:a,model:o}of i)if(o){const e=pn.kk.fromValue(a.table,l().cloneDeep(o.__UNSAFE__getValue()));n.setModelAndRole(a,e,"editor")}return n}({recordMapWithRoleJson:e.data.recordMap}),c=new un.Z({name:"adminContentSearchSettings.useContentSearch",data:new fn.o({[i.id]:d})});c.addCacheFallback(a.defaultRecordCache.inMemoryRecordCache),s((e=>{const t=[],i=new Set(e.pageStores.map((e=>e.id)));for(const n of r)if(!i.has(n)){const e=new He.G(a,{table:hn.iU,id:n},{inMemoryRecordCache:c});t.push(e)}const o=[...e.pageStores,...t];return{...e,pageStores:o,loading:!1,error:void 0,numPagesLoaded:e.numPagesLoaded+1,paginationToken:n,hasNextPage:Boolean(n)}}))}catch(h){const e=(0,mn.tg)(h);s((t=>({...t,loading:!1,error:e})))}}}),[a,t,i,o.filters,o.loading,o.error,o.hasNextPage,o.numPagesLoaded,o.paginationToken]);(0,d.useEffect)((()=>{o.shouldReRunSearch&&(s((e=>({...e,shouldReRunSearch:!1}))),c({restartSearch:!0,ignoreFilterComparison:!1}))}),[o.shouldReRunSearch,c]);const u=(0,d.useCallback)((async()=>{o.shouldReRunSearch||await c({restartSearch:!1,ignoreFilterComparison:!0})}),[o.shouldReRunSearch,c]),m=(0,d.useCallback)((async e=>{await c({restartSearch:!0,ignoreFilterComparison:e||!1})}),[c]),p=(0,d.useCallback)(((e,t)=>{b.gL0(a,{newFilters:e}),s((i=>({...i,filters:{...i.filters,...e},...null!=t&&t.runSearchAfter?{shouldReRunSearch:null==t?void 0:t.runSearchAfter}:void 0})))}),[a]);return{showSuggestions:o.showSuggestions,filters:o.filters,pageStores:o.pageStores,loading:o.loading,error:o.error,hasNextPage:o.hasNextPage,loadNextPage:u,runNewSearch:m,setFilters:p}}const wn=function(e){let{spaceStore:t,userStore:i}=e;window.__c={n:"AdminContentSearchTab"};const n=(0,Pe.O7)(),o=(0,Ze.VK)((()=>Fe.Z.state.online),[]),s=(0,xe.yK)((e=>({})),[]),{showSuggestions:r,loadNextPage:l,pageStores:d,loading:c,error:u,runNewSearch:m,filters:p,setFilters:g}=Mn({spaceStore:t,userStore:i});return o?a()(Ee.Z,{},void 0,a()(Be.Z,{large:!n.device.isMobile||void 0,divider:n.device.isMobile?void 0:"full"},void 0,a()(v.FormattedMessage,{id:"adminContentSearchTab.title",defaultMessage:"Content Search"})),a()("div",{style:s.description},void 0,a()(Ae.Z,{isMultiline:!0,style:{marginBottom:20}},void 0,a()(v.FormattedMessage,{id:"adminContentSearchTab.description",defaultMessage:"Search and filter for any page in the workspace, including private pages. Only workspace owners can use content search."})),a()(Le,{spaceId:t.id,disabled:0===d.length,filters:p})),a()(cn,{spaceStore:t,runNewSearch:m,setFilters:g,filters:p}),a()(pi,{loading:c,error:u,pageStores:d,loadNextPage:l,filters:p,setFilters:g,showSuggestions:r,runNewSearch:m})):a()(Ee.Z,{},void 0,a()(Ae.Z,{isSmall:!0,isMultiline:!0,style:{textAlign:"center"}},void 0,a()(v.FormattedMessage,{defaultMessage:"Please go online to access content search.",id:"adminContentSearchTab.offline.message"})))};var Cn=i(59730),_n=i(31299),kn=i(33954);class Tn extends B.default{getInitialState(){return{spaceId:void 0,allUserIds:new Set,allBotIds:new Set,removedUserIds:new Set,removedBotIds:new Set}}isUserOrBotRemoved(e){return Boolean(e&&(this.state.removedUserIds.has(e)||this.state.removedBotIds.has(e)))}}const In=new Tn,Pn=(0,v.defineMessages)({loadCurrentAuditLogError:{id:"auditlog.error.loadCurrentAuditLogError",defaultMessage:"Failed to load audit logs"}}),Zn=async e=>{const{environment:t,spaceId:i}=e,n=await T.getHistoricalAuditLogUsers(t,{spaceId:i});return"success"!==n.type?[]:n.data.results},xn=async e=>{const{environment:t,spaceId:i}=e;if(In.getState().spaceId!==i&&In.reset(),!i)return;const[n,a]=await Promise.all([_n.Te({environment:t,membersOnly:!1}),Zn({environment:t,spaceId:i})]),o={spaceId:i,allUserIds:new Set,allBotIds:new Set,removedUserIds:new Set,removedBotIds:new Set};n.userIds.forEach((e=>{o.allUserIds.add(e)})),n.botIds.forEach((e=>{o.allBotIds.add(e)})),a.forEach((e=>{var t;(t=e.actorId)!==Lt._H.id&&t!==Qt.s$.id&&t!==Qt.el.id||o.allUserIds.has(e.actorId)?e.actorType!==Qt.KJ||o.allUserIds.has(e.actorId)?e.actorType!==Lt.cZ||o.allBotIds.has(e.actorId)||(o.allBotIds.add(e.actorId),o.removedBotIds.add(e.actorId)):(o.allUserIds.add(e.actorId),o.removedUserIds.add(e.actorId)):o.allUserIds.add(e.actorId)})),In.setState(o)};class Fn extends B.default{getInitialState(){return{open:!1}}}const An=new Fn,En=(0,v.defineMessages)({30:{id:"auditLogCSV.menu.30days",defaultMessage:"Last 30 days"},60:{id:"auditLogCSV.menu.60days",defaultMessage:"Last 60 days"},90:{id:"auditLogCSV.menu.90days",defaultMessage:"Last 90 days"},365:{id:"auditLogCSV.menu.365days",defaultMessage:"Last 1 year"},Export:{id:"auditLogCSV.menu.export",defaultMessage:"Export"}});class Bn extends c.Z{constructor(){super(...arguments),this.renderCSVMenu=()=>{const e=[this.getCSVMenuItem(30),this.getCSVMenuItem(60),this.getCSVMenuItem(90),this.getCSVMenuItemWithConfirmation(365)];return a()(rt.Z,{menuType:it.og.Popup},void 0,a()(lt.Z,{type:lt.i.Vertical,sections:[{key:"results",render:e=>d.createElement(ct.Z,e),items:e}],initialFocus:0}))},this.getCSVMenuItem=e=>({key:e,render:()=>a()(ot.Z,{focused:!1,title:z.default.formatMessage(En[e]),onClick:()=>{this.handleDismiss(),Dn(this.environment,e)}}),action:()=>{}}),this.getCSVMenuItemWithConfirmation=e=>({key:e,render:()=>a()(ot.Z,{focused:!1,title:z.default.formatMessage(En[e]),onClick:()=>{M.showDialog({message:a()(v.FormattedMessage,{id:"auditLogCSV.menu.365days.prompt",defaultMessage:"Are you sure you want to export a one year CSV? You can't repeat this action while this is processing in the background."}),showCancel:!0,keepFocus:!0,items:[{label:a()(v.FormattedMessage,{id:"AuditLogCSV.exportConfirmationDialog.label",defaultMessage:"Export"}),color:"blue",onAccept:()=>{this.handleDismiss(),Dn(this.environment,e)}}]})}}),action:()=>{}}),this.handleDismiss=()=>{An.setState({open:!1})},this.popOpenOptions=e=>{An.setState({open:e})}}renderComponent(){const e=An.state;return a()(dt.ZP,{popupType:dt.ZP.PopupType.Popup,open:e.open,placementToOrigin:dt.ZP.Placement.Bottom,alignmentToOrigin:dt.ZP.Alignment.End,originGap:4,disableMouseCapture:!0,disableContentScroll:!0,keepFocus:!1,render:this.renderCSVMenu,onDismiss:this.handleDismiss,enableOutsideClickDismiss:!0,origin:a()(We.Z,{renderTooltip:()=>a()(v.FormattedMessage,{id:"auditLogCSV.popup.tooltip",defaultMessage:"Click for options to export the Audit Log in CSV form"}),render:t=>d.createElement($e.Z,s()({isLarge:!0,onClick:()=>this.popOpenOptions(!e.open)},t),z.default.formatMessage(En.Export))})})}}Bn.displayName="AuditLogCSV";const Dn=(e,t)=>{const{currentSpaceStore:i}=A.default.state;i&&De.PN(e,{spaceId:i.id,exportOptions:{duration:t}})},Rn=(0,v.injectIntl)(Bn);var Ln=i(66897),Nn=i(74136),On=i(97680);class Vn extends B.default{getInitialState(){return{tempSelections:new Set([])}}setTempSelections(e){this.setState({tempSelections:new Set(e)})}}class Un extends c.Z{constructor(){super(...arguments),this.storeTypes={localStore:Vn},this.renderResultMenuItem=(e,t)=>{var i;const{intl:n,auditLogHistoricalUserStore:o}=this.props,{localStore:r}=this.stores,l=this.getActor(e);return d.createElement(On.Z,s()({},t,{key:e,actor:l,useEmailAsTooltip:!0,checkState:r.state.tempSelections.has(e),userTitle:a()("div",{style:{display:"flex",gap:4}},void 0,(0,Ln.$4)(n,l),o.isUserOrBotRemoved(null===(i=l.asActor)||void 0===i?void 0:i.id)&&a()(Nn.Z,{},void 0,a()(v.FormattedMessage,{id:"auditlogActorFilter.removed_user",defaultMessage:"Removed"})))}))},this.performRequest=async e=>{let{query:t,current:i}=e;const{allUserIds:n,allBotIds:a}=this.props.auditLogHistoricalUserStore.getState(),o=await _n.ri({environment:this.environment,query:t,userIds:[...n],botIds:[...a]}),s=[...o.users.map((e=>`notion_user:${e.id}`)),...o.bots.map((e=>`bot:${e.id}`))];if(t.length>0)return s.slice(0,100);const r=this.props.selectedActors.map(ne.eW),l=new Set(r),d=s.filter((e=>!l.has(e)));return[...r,...d].slice(0,Math.max(r.length,100))},this.createUserValue=e=>He.U6.createChildStore(this.props.parentStore,{table:Qt.KJ,id:e}).getValue(),this.createBotValue=e=>(0,He.Kv)(this.props.parentStore,{table:Lt.cZ,id:e}).getValue()}didMount(){this.updateTempSelectionFromProps()}renderComponent(){const{selectedActors:e,intl:t}=this.props,{localStore:i}=this.stores,n=a()(v.FormattedMessage,{id:"auditlogActorFilter.title",defaultMessage:"User"});return a()(Qi.Z,{mode:Qi.z.Pill,title:n,icon:m.Z.person,iconStyles:{marginRight:2},items:Array.from(i.state.tempSelections),hasItemsSelected:(null==e?void 0:e.length)>0,onChange:e=>{i.setTempSelections(e)},renderFooter:!0,allowApplyBatchSelection:!0,keepInputOnItemConfirm:!0,onMenuDismiss:e=>{"applyButton"!==e?this.updateTempSelectionFromProps():this.updateOnChangeToParent()},labelText:{title:n,tokenInputPlaceholder:t.formatMessage({defaultMessage:"Search user...",id:"auditlogActorFilter.searchActor.placeholder"}),resultSectionTitle:t.formatMessage({defaultMessage:"Select users",id:"auditlogActorFilter.searchActor.resultsTitle"}),componentDebugName:"SearchActorFilter"},performRequest:this.performRequest,renderResultMenuItem:this.renderResultMenuItem,renderToken:()=>null,renderFilter:()=>null,renderItemForSummary:()=>null,addItemLabel:null,focused:!1})}updateOnChangeToParent(){const{onChange:e}=this.props,{localStore:t}=this.stores;e(Array.from(t.state.tempSelections).map(ne.Ij).filter((e=>Boolean(e))))}updateTempSelectionFromProps(){const{selectedActors:e}=this.props,{localStore:t}=this.stores,i=e.map(ne.eW);t.setTempSelections(i)}getActor(e){const t=(0,ne.Ij)(e);return t?"notion_user"===t.actorType?(0,Ln.m3)(this.createUserValue(t.actorId)):(0,Ln.ON)(this.createBotValue(t.actorId)):(0,Ln.m3)(void 0)}}Un.displayName="AuditLogActorFilter";const Wn=(0,v.injectIntl)(Un),Kn={audit_log_aes_event_read:[],audit_log_permanently_deleted_filter_enable:["page.permanently_deleted"],enable_suspend_managed_users:["user_suspended","user_unsuspended"],enable_prevent_granting_support_access:["workspace.settings.prevent_granting_support_access_updated"],enable_set_managed_users_profile_data:["workspace.settings.prevent_profile_edits_updated"],enable_custom_session_duration:["workspace.settings.custom_session_duration_updated"],enabled_reject_join_external_workspaces:["workspace.settings.external_workspace_access_updated"],enable_logout_managed_users:["admin_managed_users_log_out_all","admin_managed_users_log_out_one"],enable_password_reset_managed_users:["admin_managed_users_password_cleared","admin_managed_users_password_cleared_one"]};const zn={admin_content_search_exported:"workspace.content_search_exported",admin_content_search_queried:"workspace.content_search_queried",ai_admin_legal_acceptance_toggled:"workspace.settings.ai_legal_terms_setting_updated",allowed_email_domain_added:"workspace.settings.email_domain_added",allowed_email_domain_removed:"workspace.settings.email_domain_removed",allowed_support_access:"user.settings.support_access_granted",audit_log_exported:"workspace.audit_log_exported",automatic_account_creation_toggled:"workspace.settings.automatic_account_creation_setting_updated",automation_created:"page.automation_created",automation_edited:"page.automation_updated",content_analytics_exported:"workspace.content_analytics_exported",disable_guests_toggled:"workspace.settings.allow_guests_setting_updated",email_changed:"user.settings.email_updated",export_toggled:"workspace.settings.allow_content_export_setting_updated",file_downloaded:"page.file_downloaded",file_uploaded:"page.file_uploaded",group_added_to_team:"teamspace.permissions.group_added",group_removed_from_team:"teamspace.permissions.group_removed",guest_membership_requests_toggled:"workspace.settings.guest_membership_request_setting_updated",guest_removed:"workspace.permissions.guest_removed",idp_metadata_url_updated:"workspace.saml_sso_idp_metadata_url_updated",idp_metadata_xml_removed:"workspace.saml_sso_idp_metadata_xml_removed",invite_link_toggled:"workspace.settings.invite_link_setting_updated",invite_link_reset:"workspace.settings.invite_link_reset",login:"user.login",logout:"user.logout",mfa_backup_code_toggled:"user.settings.login_method.mfa_backup_code_updated",mfa_sms_toggled:"user.settings.login_method.mfa_sms_updated",mfa_totp_toggled:"user.settings.login_method.mfa_totp_updated",member_added_to_group:"workspace.group.permissions.member_added",member_added_to_team:"teamspace.permissions.member_added",member_invited:"workspace.permissions.member_invited",member_joined:"workspace.permissions.member_added",member_joined_team:"teamspace.permissions.member_added",member_left_team:"teamspace.permissions.member_removed",member_removed:"workspace.permissions.member_removed",member_removed_from_group:"workspace.group.permissions.member_removed",member_removed_from_team:"teamspace.permissions.member_removed",member_role_updated:"workspace.permissions.member_role_updated",member_team_role_updated:"teamspace.permissions.member_role_updated",membership_request_resolved:"workspace.membership_request_resolved",membership_requests_toggled:"workspace.settings.membership_request_setting_updated",page_access_requests_toggled:"workspace.settings.page_access_request_setting_updated",page_created:"page.created",page_deleted:"page.deleted","page.discussion.comment.created":"page.discussion.comment.created","page.discussion.comment.deleted":"page.discussion.comment.deleted","page.discussion.comment.updated":"page.discussion.comment.updated",page_edited:"page.content_edited",page_exported:"page.exported",page_moved:"page.moved","page.properties_edited":"page.properties_edited","page.permanently_deleted":"page.permanently_deleted",page_restored:"page.restored_from_trash",page_viewed:"page.viewed",pages_to_other_workspaces_toggled:"workspace.settings.duplicate_pages_to_workspaces_setting_updated",password_cleared:"user.settings.login_method.password_removed",password_changed:"user.settings.login_method.password_updated",password_set:"user.settings.login_method.password_added",picture_changed:"user.settings.profile_photo_updated",preferred_name_changed:"user.settings.preferred_name_updated",private_content_transferred:"workspace.private_content_transferred",public_page_cleared:"workspace.settings.public_homepage_removed",public_page_sharing_toggled:"teamspace.settings.allow_public_page_sharing_setting_updated",revoked_support_access:"user.settings.support_access_revoked",saml_enforce_toggled:"workspace.settings.enforce_saml_sso_config_updated",saml_toggled:"workspace.settings.enable_saml_sso_config_updated",scim_token_generated:"workspace.scim_token_generated",scim_token_revoked:"workspace.scim_token_revoked",space_claim_and_upgrade_status_changed:"workspace.domain_management.claim_request_status_updated",space_claim_deletion_status_changed:"workspace.domain_management.deletion_request_status_updated",space_transfer_status_changed:"workspace.domain_management.transfer_request_status_updated",team_archived:"teamspace.archived",team_created:"teamspace.created",team_creation_admins_setting_toggled:"workspace.settings.allow_teamspace_creation_setting_updated",team_default_toggled:"teamspace.settings.default_setting_updated",team_description_changed:"teamspace.settings.description_updated",team_export_toggled:"teamspace.settings.allow_content_export_setting_updated",team_guests_toggled:"teamspace.settings.allow_guests_setting_updated",team_icon_changed:"teamspace.settings.icon_updated",team_invite_access_changed:"teamspace.settings.member_invitation_setting_updated",team_member_default_permission_updated:"teamspace.settings.member_default_permission_updated",team_name_changed:"teamspace.settings.name_updated",team_privacy_type_changed:"teamspace.settings.privacy_type_updated",team_public_page_sharing_toggled:"teamspace.settings.allow_public_page_sharing_setting_updated",team_restored:"teamspace.restored",team_sidebar_editing_toggled:"teamspace.settings.allow_sidebar_editing_setting_updated",team_workspace_default_permission_updated:"workspace.settings.default_teamspace_page_permissions_updated",teams_enabled_for_space:"workspace.settings.teamspaces_enabled_updated",user_analytics_exported:"workspace.user_analytics_exported",user_deleted:"user.account_deleted",workspace_analytics_toggled:"workspace.settings.analytics_tracking_setting_updated",workspace_creation_set_for_email_domain:"workspace.settings.allow_workspace_creation_setting_updated",workspace_domain_changed:"workspace.settings.public_pages_domain_updated",workspace_exported:"workspace.content_exported",workspace_icon_changed:"workspace.settings.icon_updated",workspace_integration_restriction_changed:"workspace.settings.integration_restriction_settings_updated",workspace_name_changed:"workspace.settings.name_updated",workspace_sidebar_editing_toggled:"workspace.settings.sidebar_editing_setting_updated"},Gn=["admin_managed_users_log_out_all","admin_managed_users_log_out_one","admin_managed_users_password_cleared","admin_managed_users_password_cleared_one","disable_team_guests_toggled","space_consolidation_completed","space_consolidation_failed","space_consolidation_started","team_guest_default_permission_updated","team_group_permission_updated","team_user_permission_updated","user_suspended","user_unsuspended","workspace.settings.custom_session_duration_updated","workspace.settings.external_workspace_access_updated","workspace.settings.prevent_granting_support_access_updated","workspace.settings.prevent_profile_edits_updated"];(0,x.AO)((e=>{for(const t of X)if(t===e)return{true:e};return{false:e}})),(0,x.AO)((e=>{for(const t of $)if(t===e)return{true:e};return{false:e}}));var qn=i(8848),Hn=i(7057);const jn=(0,v.defineMessages)({adminLabel:{id:"auditLogSpaceRoleMessages.admin",defaultMessage:"admin"},workspaceOwnerLabel:{id:"auditLogSpaceRoleMessages.workspaceOwner",defaultMessage:"workspace owner"},membershipAdminLabel:{id:"auditLogSpaceRoleMessages.membershipAdmin",defaultMessage:"membership admin"},memberLabel:{id:"auditLogSpaceRoleMessages.member",defaultMessage:"member"},guestLabel:{id:"auditLogSpaceRoleMessages.guest",defaultMessage:"guest"},noAccessLabel:{id:"auditLogSpaceRoleMessages.noAccess",defaultMessage:"no access"},pageGuestLabel:{id:"auditLogSpaceRoleMessages.pageGuest",defaultMessage:"page guest"},teamGuestLabel:{id:"auditLogSpaceRoleMessages.teamGuest",defaultMessage:"teamspace guest"}}),Qn=(0,v.defineMessages)({missing:{defaultMessage:"MISSING",id:"csvExport.copiedText.missingField"},notApplicable:{defaultMessage:"N/A",id:"csvExport.copiedText.notApplicable"}});function Yn(e){return`"${e.replace(/"/g,'""')}"`}const $n={defaultMessage:"N/A",id:"auditLogPaginatedTable.copiedText.notAvailable",description:"Shown in the copied text when the value is not available. Means not applicable"},Xn=((0,x.AO)((e=>30===e||60===e||90===e||365===e?{true:e}:{false:e})),(0,v.defineMessages)({"page.properties_edited":{id:"auditlogEventFilter.actionName.page.properties_edited",defaultMessage:"Page properties edited"},"page.discussion.comment.created":{id:"auditlogEventFilter.actionName.page.discussion.comment.created",defaultMessage:"Comment added"},"page.discussion.comment.updated":{id:"auditlogEventFilter.actionName.page.discussion.comment.updated",defaultMessage:"Comment updated"},"page.discussion.comment.deleted":{id:"auditlogEventFilter.actionName.page.discussion.comment.deleted",defaultMessage:"Comment deleted"},page_edited:{id:"auditlogEventFilter.actionName.page_edited",defaultMessage:"Page edited"},page_viewed:{id:"auditlogEventFilter.actionName.page_viewed",defaultMessage:"Page viewed"},page_created:{id:"auditlogEventFilter.actionName.page_created",defaultMessage:"Page created"},page_deleted:{id:"auditlogEventFilter.actionName.page_deleted",defaultMessage:"Page deleted"},"page.permanently_deleted":{id:"auditlogEventFilter.actionName.page.permanently_deleted",defaultMessage:"Page permanently deleted"},page_restored:{id:"auditlogEventFilter.actionName.page_restored",defaultMessage:"Page restored"},page_exported:{id:"auditlogEventFilter.actionName.page_exported",defaultMessage:"Page exported"},page_moved:{id:"auditlogEventFilter.actionName.page_moved",defaultMessage:"Page moved"},page_permission_updated:{id:"auditlogEventFilter.actionName.page_permission_updated",defaultMessage:"Page permission updated"},page_shared_to_web:{id:"auditlogEventFilter.actionName.page_shared_to_web",defaultMessage:"Page shared to web"},password_set:{id:"auditlogEventFilter.actionName.password_set",defaultMessage:"Password set"},password_cleared:{id:"auditlogEventFilter.actionName.password_cleared",defaultMessage:"Password cleared"},password_changed:{id:"auditlogEventFilter.actionName.password_changed",defaultMessage:"Password changed"},login:{id:"auditlogEventFilter.actionName.login",defaultMessage:"Login"},logout:{id:"auditlogEventFilter.actionName.logout",defaultMessage:"Logout"},mfa_sms_toggled:{id:"auditlogEventFilter.actionName.mfa_sms_toggled",defaultMessage:"MFA SMS toggled"},mfa_totp_toggled:{id:"auditlogEventFilter.actionName.mfa_totp_toggled",defaultMessage:"MFA TOTP toggled"},mfa_backup_code_toggled:{id:"auditlogEventFilter.actionName.mfa_backup_code_toggled",defaultMessage:"MFA backup code toggled"},member_invited:{id:"auditlogEventFilter.actionName.member_invited",defaultMessage:"Member invited"},member_joined:{id:"auditlogEventFilter.actionName.member_joined",defaultMessage:"Member joined"},member_role_updated:{id:"auditlogEventFilter.actionName.member_role_updated",defaultMessage:"Member role updated"},member_removed:{id:"auditlogEventFilter.actionName.member_removed",defaultMessage:"Member removed"},guest_removed:{id:"auditlogEventFilter.actionName.guest_removed",defaultMessage:"Guest removed"},user_deleted:{id:"auditlogEventFilter.actionName.user_deleted",defaultMessage:"User deleted"},email_changed:{id:"auditlogEventFilter.actionName.email_changed",defaultMessage:"Email changed"},preferred_name_changed:{id:"auditlogEventFilter.actionName.preferred_name_changed",defaultMessage:"Name changed"},picture_changed:{id:"auditlogEventFilter.actionName.picture_changed",defaultMessage:"Picture changed"},file_uploaded:{id:"auditlogEventFilter.actionName.file_uploaded",defaultMessage:"File uploaded"},file_downloaded:{id:"auditlogEventFilter.actionName.file_downloaded",defaultMessage:"File downloaded"},invite_link_toggled:{id:"auditlogEventFilter.actionName.invite_link_toggled",defaultMessage:"Invite link toggled"},workspace_name_changed:{id:"auditlogEventFilter.actionNames.workspace_name_changed",defaultMessage:"Workspace name changed"},workspace_integration_restriction_changed:{id:"auditlogEventFilter.actionNames.workspace_integration_restriction_changed",defaultMessage:"Integration installation toggled"},invite_link_reset:{id:"auditlogEventFilter.actionNames.invite_link_reset",defaultMessage:"Invite link reset"},public_page_sharing_toggled:{id:"auditlogEventFilter.actionNames.public_page_sharing_toggled",defaultMessage:"Public page sharing toggled"},workspace_sidebar_editing_toggled:{id:"auditlogEventFilter.actionNames.workspace_sidebar_editing_toggled",defaultMessage:"Workspace sidebar editing toggled"},disable_team_guests_toggled:{id:"auditlogEventFilter.actionNames.disable_team_guests_toggled",defaultMessage:"Disable teamspace guests toggled"},disable_guests_toggled:{id:"auditlogEventFilter.actionNames.disable_guests_toggled",defaultMessage:"Disable guests toggled"},pages_to_other_workspaces_toggled:{id:"auditlogEventFilter.actionNames.pages_to_other_workspaces_toggled",defaultMessage:"Pages to other workspaces toggled"},export_toggled:{id:"auditlogEventFilter.actionNames.export_toggled",defaultMessage:"Export toggled"},page_access_requests_toggled:{id:"auditlogEventFilter.actionNames.page_access_requests_toggled",defaultMessage:"Page access requests toggled"},workspace_exported:{id:"auditlogEventFilter.actionNames.workspace_exported",defaultMessage:"Workspace content exported"},audit_log_exported:{id:"auditlogEventFilter.actionNames.audit_log_exported",defaultMessage:"Audit Log exported"},user_analytics_exported:{id:"auditlogEventFilter.actionNames.user_analytics_exported",defaultMessage:"User Analytics exported"},content_analytics_exported:{id:"auditlogEventFilter.actionNames.content_analytics_exported",defaultMessage:"Content Analytics exported"},workspace_icon_changed:{id:"auditlogEventFilter.actionNames.workspace_icon_changed",defaultMessage:"Workspace icon changed"},allowed_email_domain_added:{id:"auditlogEventFilter.actionNames.allowed_email_domain_added",defaultMessage:"Added allowed email domain"},allowed_email_domain_removed:{id:"auditlogEventFilter.actionNames.allowed_email_domain_removed",defaultMessage:"Removed allowed email domain"},workspace_domain_changed:{id:"auditlogEventFilter.actionNames.workspace_domain_changed",defaultMessage:"Workspace domain changed"},public_page_cleared:{id:"auditlogEventFilter.actionNames.public_page_cleared",defaultMessage:"Public home page link cleared"},public_page_set:{id:"auditlogEventFilter.actionNames.public_page_set",defaultMessage:"Public home page set"},scim_token_generated:{id:"auditlogEventFilter.actionNames.scim_token_generated",defaultMessage:"SCIM token generated"},scim_token_revoked:{id:"auditlogEventFilter.actionNames.scim_token_revoked",defaultMessage:"SCIM token revoked"},idp_metadata_url_updated:{id:"auditlogEventFilter.actionNames.idp_metadata_url_updated",defaultMessage:"IDP metadata URL updated"},idp_metadata_xml_updated:{id:"auditlogEventFilter.actionNames.idp_metadata_xml_updated",defaultMessage:"IDP metadata XML updated"},idp_metadata_xml_removed:{id:"auditlogEventFilter.actionNames.idp_metadata_xml_removed",defaultMessage:"IDP metadata XML removed"},saml_toggled:{id:"auditlogEventFilter.actionNames.saml_toggled",defaultMessage:"SAML enable setting toggled"},saml_enforce_toggled:{id:"auditlogEventFilter.actionNames.saml_enforce_toggled",defaultMessage:"SAML enforce setting toggled"},automatic_account_creation_toggled:{id:"auditlogEventFilter.actionNames.automatic_account_creation_toggled",defaultMessage:"Auto-create accounts on sign-in toggled"},workspace_creation_set_for_email_domain:{id:"auditlogEventFilter.actionNames.workspace_creation_set_for_email_domain",defaultMessage:"Workspace creation setting updated"},"workspace.settings.custom_session_duration_updated":{id:"auditlogEventFilter.actionNames.workspace_domain_settings_session_duration_updated",defaultMessage:"Session duration for managed users updated"},"workspace.settings.external_workspace_access_updated":{id:"auditlogEventFilter.actionNames.workspace_domain_settings_external_workspace_access_updated",defaultMessage:"Ability for managed users to join external workspaces updated"},"workspace.settings.prevent_profile_edits_updated":{id:"auditlogEventFilter.actionNames.workspace_domain_prevent_profile_edits_updated",defaultMessage:"Ability for managed users to edit their profile information updated"},"workspace.settings.prevent_granting_support_access_updated":{id:"auditlogEventFilter.actionNames.workspace_domain_prevent_granting_support_access_updated",defaultMessage:"Ability for managed users to grant support access updated"},member_added_to_group:{id:"auditlogEventFilter.actionNames.member_added_to_group",defaultMessage:"Member added to group"},member_removed_from_group:{id:"auditlogEventFilter.actionNames.member_removed_from_group",defaultMessage:"Member removed from group"},space_transfer_status_changed:{id:"auditlogEventFilter.actionNames.space_transfer_status_changed",defaultMessage:"Claimable workspace transfer status change"},space_claim_and_upgrade_status_changed:{id:"auditlogEventFilter.actionNames.space_claim_and_upgrade_status_changed",defaultMessage:"Claimable workspace upgrade status change"},space_claim_deletion_status_changed:{id:"auditlogEventFilter.actionNames.space_claim_deletion_status_changed",defaultMessage:"Claimable workspace deletion status change"},allowed_support_access:{id:"auditlogEventFilter.actionNames.allowed_support_access",defaultMessage:"Granted support access"},revoked_support_access:{id:"auditlogEventFilter.actionNames.revoked_support_access",defaultMessage:"Revoked support access"},membership_requests_toggled:{id:"auditlogEventFilter.actionNames.membership_requests_toggled",defaultMessage:"Membership requests toggled"},membership_request_resolved:{id:"auditlogEventFilter.actionNames.membership_request_resolved",defaultMessage:"Membership request resolved"},guest_membership_requests_toggled:{id:"auditlogEventFilter.actionNames.guest_membership_requests_toggled",defaultMessage:"Guest membership requests toggled"},team_created:{id:"auditlogEventFilter.actionNames.team_created",defaultMessage:"Teamspace created"},team_archived:{id:"auditlogEventFilter.actionNames.team_archived",defaultMessage:"Teamspace archived"},team_restored:{id:"auditlogEventFilter.actionNames.team_restored",defaultMessage:"Teamspace restored"},team_default_toggled:{id:"auditlogEventFilter.actionNames.team_default_toggled",defaultMessage:"Teamspace default toggled"},team_privacy_type_changed:{id:"auditlogEventFilter.actionNames.team_privacy_type_changed",defaultMessage:"Teamspace privacy type changed"},team_invite_access_changed:{id:"auditlogEventFilter.actionNames.team_invite_access_changed",defaultMessage:"Teamspace invite access changed"},team_public_page_sharing_toggled:{id:"auditlogEventFilter.actionNames.team_public_page_sharing_toggled",defaultMessage:"Teamspace public page sharing toggled"},team_export_toggled:{id:"auditlogEventFilter.actionNames.team_export_toggled",defaultMessage:"Teamspace export toggled"},team_sidebar_editing_toggled:{id:"auditlogEventFilter.actionNames.team_sidebar_editing_toggled",defaultMessage:"Teamspace sidebar editing toggled"},team_guests_toggled:{id:"auditlogEventFilter.actionNames.team_guests_toggled",defaultMessage:"Teamspace disable guests toggled"},team_name_changed:{id:"auditlogEventFilter.actionNames.team_name_changed",defaultMessage:"Teamspace name changed"},team_description_changed:{id:"auditlogEventFilter.actionNames.team_description_changed",defaultMessage:"Teamspace description changed"},team_icon_changed:{id:"auditlogEventFilter.actionNames.team_icon_changed",defaultMessage:"Teamspace icon changed"},team_creation_admins_setting_toggled:{id:"auditlogEventFilter.actionNames.team_creation_admins_setting_toggled",defaultMessage:"Teamspace creation setting toggled"},member_added_to_team:{id:"auditlogEventFilter.actionNames.member_added_to_team",defaultMessage:"Member added to teamspace"},member_removed_from_team:{id:"auditlogEventFilter.actionNames.member_removed_from_team",defaultMessage:"Member removed from teamspace"},group_added_to_team:{id:"auditlogEventFilter.actionNames.group_added_to_team",defaultMessage:"Group added to teamspace"},group_removed_from_team:{id:"auditlogEventFilter.actionNames.group_removed_from_team",defaultMessage:"Group removed from teamspace"},member_left_team:{id:"auditlogEventFilter.actionNames.member_left_team",defaultMessage:"Member left teamspace"},member_joined_team:{id:"auditlogEventFilter.actionNames.member_joined_team",defaultMessage:"Member joined teamspace"},member_team_role_updated:{id:"auditlogEventFilter.actionNames.member_team_role_updated",defaultMessage:"Member teamspace role updated"},team_user_permission_updated:{id:"auditlogEventFilter.actionNames.team_user_permission_updated",defaultMessage:"Custom permissions updated for a member in the teamspace"},team_group_permission_updated:{id:"auditlogEventFilter.actionNames.team_group_permission_updated",defaultMessage:"Custom permissions updated for a group in the teamspace"},team_member_default_permission_updated:{id:"auditlogEventFilter.actionNames.team_member_default_permission_updated",defaultMessage:"Teamspace Members default permission updated"},team_guest_default_permission_updated:{id:"auditlogEventFilter.actionNames.team_guest_default_permission_updated",defaultMessage:"Teamspace Guests default permission updated"},team_workspace_default_permission_updated:{id:"auditlogEventFilter.actionNames.team_workspace_default_permission_updated",defaultMessage:"Everyone in workspace default page permission updated"},teams_enabled_for_space:{id:"auditlogEventFilter.actionNames.teams_enabled_for_space",defaultMessage:"Enabled teamspaces"},private_content_transferred:{id:"auditLogEventFilter.actionNames.private_content_transferred",defaultMessage:"Private content transferred"},admin_content_search_queried:{id:"auditLogEventFilter.actionNames.admin_content_search_queried",defaultMessage:"Content search queried"},admin_content_search_exported:{id:"auditLogEventFilter.actionNames.admin_content_search_exported",defaultMessage:"Content search results exported"},admin_managed_users_log_out_all:{id:"auditLogEventFilter.actionNames.admin_managed_users_log_out_all",defaultMessage:"All managed users logged out"},admin_managed_users_log_out_one:{id:"auditLogEventFilter.actionNames.admin_managed_users_log_out_one",defaultMessage:"A managed user was logged out by an admin"},admin_managed_users_password_cleared:{id:"auditLogEventFilter.actionNames.password_cleared",defaultMessage:"All managed users' passwords cleared"},admin_managed_users_password_cleared_one:{id:"auditLogEventFilter.actionNames.admin_managed_users_password_cleared_one",defaultMessage:"A managed user's password was cleared by an admin"},automation_created:{id:"auditLogEventFilter.actionNames.automation_created",defaultMessage:"Automation created"},automation_edited:{id:"auditLogEventFilter.actionNames.automation_edited",defaultMessage:"Automation edited"},ai_admin_legal_acceptance_toggled:{id:"auditLogEventFilter.actionNames.ai_admin_legal_acceptance_toggled",defaultMessage:"Notion AI toggled for workspace."},workspace_analytics_toggled:{id:"auditLogEventFilter.actionNames.workspace_analytics_toggled",defaultMessage:"Workspace analytics tracking toggled"},space_consolidation_started:{id:"auditLogEventFilter.actionNames.space_consolidation_started",defaultMessage:"Workspace consolidation started"},space_consolidation_completed:{id:"auditLogEventFilter.actionNames.space_consolidation_completed",defaultMessage:"Workspace consolidation completed"},space_consolidation_failed:{id:"auditLogEventFilter.actionNames.space_consolidation_failed",defaultMessage:"Workspace consolidation failed"},user_suspended:{id:"auditLogEventFilter.actionNames.user_suspended",defaultMessage:"User suspended"},user_unsuspended:{id:"auditLogEventFilter.actionNames.user_unsuspended",defaultMessage:"User reactivated"}})),Jn=(0,v.defineMessages)({private:{id:"auditLogColumnEvent.tooltip.pageAudience.private",defaultMessage:"private"},shared_internally:{id:"auditLogColumnEvent.tooltip.pageAudience.sharedInternally",defaultMessage:"shared internally"},shared_externally:{id:"auditLogColumnEvent.tooltip.pageAudience.sharedExternally",defaultMessage:"shared externally"},shared_to_web:{id:"auditLogColumnEvent.tooltip.pageAudience.sharedToWeb",defaultMessage:"shared to web"}}),ea=["name","email","status","activityType","activity","audience","dateAndTime","platform","ipAddress","city","state","country","pageId"],ta=[...ea,"eventName"];(0,v.defineMessages)({name:{id:"exportAuditLog.header.name",defaultMessage:"Name"},email:{id:"exportAuditLog.header.email",defaultMessage:"Email"},status:{id:"exportAuditLog.header.status",defaultMessage:"Status"},activityType:{id:"exportAuditLog.header.activityType",defaultMessage:"Activity Type"},activity:{id:"exportAuditLog.header.activity",defaultMessage:"Activity"},dateAndTime:{id:"exportAuditLog.header.dateAndTime",defaultMessage:"Date and Time (UTC)"},platform:{id:"exportAuditLog.header.platform",defaultMessage:"Platform"},ipAddress:{id:"exportAuditLog.header.ipAddress",defaultMessage:"IP Address"},city:{id:"exportAuditLog.header.city",defaultMessage:"City"},state:{id:"exportAuditLog.header.state",defaultMessage:"State"},country:{id:"exportAuditLog.header.country",defaultMessage:"Country"},audience:{id:"exportAuditLog.header.audience",defaultMessage:"Audience"},pageId:{id:"exportAuditLog.header.pageId",defaultMessage:"Page Id"},eventName:{id:"exportAuditLog.header.eventName",defaultMessage:"Event Name"}});function ia(e,t,i){var n;return e.actor.actorId===Qt.s$.id||e.actor.actorId===Qt.el.id?t.formatMessage({defaultMessage:"notion_admin",id:"auditLogPaginatedTable.copiedText.notionAdmin"}):"notion_user"===e.actor.actorType?t.formatMessage(function(e,t){if(!e)return jn.noAccessLabel;if(t){if("guest"===e)return jn.pageGuestLabel;if("team_level_guest"===e)return jn.teamGuestLabel}switch(e){case"admin":return jn.workspaceOwnerLabel;case"membership_admin":return jn.membershipAdminLabel;case"member":return jn.memberLabel;case"guest":case"team_level_guest":return jn.guestLabel;case"no_access":return jn.noAccessLabel;default:(0,x.t1)(e)}}(null===(n=e.actor.meta)||void 0===n?void 0:n.spaceRole,i)):t.formatMessage({defaultMessage:"N/A",id:"auditLogPaginatedTable.copiedText.noRole"})}function na(e,t){var i,n,a,o,s,r,l,d,c,u;return null!==(i=e.actor.meta)&&void 0!==i&&i.countryCode?null!==(n=e.actor)&&void 0!==n&&null!==(n=n.meta)&&void 0!==n&&n.city?"US"===(null===(a=e.actor.meta)||void 0===a?void 0:a.countryCode)&&null!==(o=e.actor)&&void 0!==o&&null!==(o=o.meta)&&void 0!==o&&o.state?t.formatMessage({defaultMessage:"{city}, {state}, {countryCode}",id:"auditLogSettings.metadata.cityStateAndCountry"},{city:null===(d=e.actor)||void 0===d||null===(d=d.meta)||void 0===d?void 0:d.city,state:null===(c=e.actor)||void 0===c||null===(c=c.meta)||void 0===c?void 0:c.state,countryCode:null===(u=e.actor)||void 0===u||null===(u=u.meta)||void 0===u?void 0:u.countryCode}):t.formatMessage({defaultMessage:"{city}, {countryCode}",id:"auditLogSettings.metadata.cityAndCountry"},{city:null===(s=e.actor)||void 0===s||null===(s=s.meta)||void 0===s?void 0:s.city,countryCode:null===(r=e.actor)||void 0===r||null===(r=r.meta)||void 0===r?void 0:r.countryCode}):null===(l=e.actor)||void 0===l||null===(l=l.meta)||void 0===l?void 0:l.countryCode:""}function aa(e){const{auditLogEntry:t,intl:i,getAuditLogEventText:n,isTeamGuestsEnabled:a,csvColumnNames:o}=e,s=[],r=i.formatMessage(Qn.missing);return o.forEach((e=>{var o,l,d,c,u;switch(e){case"name":s.push(t.actor.name||r);break;case"email":s.push(function(e,t){return"notion_user"===e.actor.actorType?e.actor.email:t.formatMessage({defaultMessage:"N/A",id:"auditLogPaginatedTable.copiedText.noEmail"})}(t,i)||r);break;case"status":s.push(ia(t,i,a)||r);break;case"activityType":s.push(Xn[t.actionName]?i.formatMessage(Xn[t.actionName]):r);break;case"activity":s.push(n(t)||r);break;case"dateAndTime":s.push((0,Hn.$I)(t.serverTimestamp));break;case"platform":s.push((null===(o=t.actor.meta)||void 0===o?void 0:o.platform)||r);break;case"ipAddress":s.push((null===(l=t.actor.meta)||void 0===l?void 0:l.ipAddress)||r);break;case"city":s.push((null===(d=t.actor.meta)||void 0===d?void 0:d.city)||r);break;case"state":s.push((null===(c=t.actor.meta)||void 0===c?void 0:c.state)||r);break;case"country":s.push((null===(u=t.actor.meta)||void 0===u?void 0:u.countryCode)||r);break;case"audience":const m=function(e){return oa(e)??e.intl.formatMessage(Qn.notApplicable)}({auditLogEntry:t,intl:i});s.push(m||r);break;case"pageId":const p=te(t);p?s.push(p.id):s.push(i.formatMessage(Qn.notApplicable));break;case"eventName":s.push(function(e){let{auditLogEntry:t,intl:i}=e;const n=t.actionName;return zn[n]?zn[n]:((0,x.DE)(Gn,n),i.formatMessage($n))}({auditLogEntry:t,intl:i}));break;default:(0,x.t1)(e)}})),s.map(Yn).join(",")}function oa(e){var t;const{auditLogEntry:i,intl:n}=e,a=te(i);return null!=a&&null!==(t=a.meta)&&void 0!==t&&t.pageAudience?n.formatMessage(Jn[a.meta.pageAudience]):null}var sa=i(58573);let ra=function(e){return e.All="All",e.Partial="Partial",e.None="None",e}({});class la extends B.default{getInitialState(){return{categorySelections:{page:ra.All,space:ra.All,team:ra.All,account:ra.All},categoryToggleOpen:{page:!0,space:!0,team:!0,account:!0},searchQuery:void 0,actionSelections:{"page.properties_edited":!0,page_edited:!0,page_viewed:!0,page_created:!0,page_deleted:!0,"page.permanently_deleted":!0,page_restored:!0,page_exported:!0,page_moved:!0,page_permission_updated:!0,page_shared_to_web:!0,private_content_transferred:!0,automation_created:!0,automation_edited:!0,password_set:!0,password_cleared:!0,password_changed:!0,login:!0,logout:!0,member_invited:!0,member_role_updated:!0,member_removed:!0,guest_removed:!0,email_changed:!0,user_deleted:!0,member_joined:!0,preferred_name_changed:!0,picture_changed:!0,workspace_name_changed:!0,workspace_icon_changed:!0,allowed_email_domain_added:!0,allowed_email_domain_removed:!0,workspace_domain_changed:!0,workspace_exported:!0,audit_log_exported:!0,user_analytics_exported:!0,content_analytics_exported:!0,public_page_cleared:!0,public_page_set:!0,scim_token_generated:!0,scim_token_revoked:!0,saml_toggled:!0,saml_enforce_toggled:!0,mfa_sms_toggled:!0,mfa_totp_toggled:!0,mfa_backup_code_toggled:!0,automatic_account_creation_toggled:!0,workspace_creation_set_for_email_domain:!0,member_added_to_group:!0,member_removed_from_group:!0,space_transfer_status_changed:!0,space_claim_and_upgrade_status_changed:!0,space_claim_deletion_status_changed:!0,file_uploaded:!0,file_downloaded:!0,invite_link_toggled:!0,invite_link_reset:!0,page_access_requests_toggled:!0,public_page_sharing_toggled:!0,workspace_sidebar_editing_toggled:!0,disable_team_guests_toggled:!0,disable_guests_toggled:!0,pages_to_other_workspaces_toggled:!0,export_toggled:!0,workspace_integration_restriction_changed:!0,idp_metadata_url_updated:!0,idp_metadata_xml_updated:!0,idp_metadata_xml_removed:!0,allowed_support_access:!0,revoked_support_access:!0,membership_requests_toggled:!0,guest_membership_requests_toggled:!0,membership_request_resolved:!0,team_created:!0,team_archived:!0,team_restored:!0,team_default_toggled:!0,team_public_page_sharing_toggled:!0,team_guests_toggled:!0,team_export_toggled:!0,team_sidebar_editing_toggled:!0,team_name_changed:!0,team_description_changed:!0,team_icon_changed:!0,team_creation_admins_setting_toggled:!0,member_added_to_team:!0,group_added_to_team:!0,member_removed_from_team:!0,group_removed_from_team:!0,member_left_team:!0,member_joined_team:!0,member_team_role_updated:!0,team_user_permission_updated:!0,team_group_permission_updated:!0,team_guest_default_permission_updated:!0,team_member_default_permission_updated:!0,team_workspace_default_permission_updated:!0,team_privacy_type_changed:!0,team_invite_access_changed:!0,teams_enabled_for_space:!0,admin_content_search_queried:!0,admin_content_search_exported:!0,admin_managed_users_log_out_all:!0,admin_managed_users_log_out_one:!0,admin_managed_users_password_cleared:!0,admin_managed_users_password_cleared_one:!0,ai_admin_legal_acceptance_toggled:!0,workspace_analytics_toggled:!0,space_consolidation_started:!0,space_consolidation_completed:!0,space_consolidation_failed:!0,user_suspended:!0,user_unsuspended:!0,"workspace.settings.custom_session_duration_updated":!0,"workspace.settings.external_workspace_access_updated":!0,"workspace.settings.prevent_profile_edits_updated":!0,"workspace.settings.prevent_granting_support_access_updated":!0,"page.discussion.comment.created":!0,"page.discussion.comment.deleted":!0,"page.discussion.comment.updated":!0},isMenuOpen:!1,renderOrder:[{category:"page",orderedActions:ee.page},{category:"space",orderedActions:ee.space},{category:"account",orderedActions:ee.account},{category:"team",orderedActions:ee.team}]}}getAllActionNames(){return(0,x.Yd)(this.state.actionSelections)}getSelectedActionNames(){return this.getAllActionNames().filter((e=>this.state.actionSelections[e]))}hasActionNameSelected(){const e=this.getAllActionNames(),t=this.getSelectedActionNames();return t.length>0&&t.length!==e.length}updateSearchQuery(e){this.setState({...this.state,searchQuery:e})}toggleCategorySelection(e){const t=e.category;this.setState({...this.state,categoryToggleOpen:{...this.state.categoryToggleOpen,[t]:!this.state.categoryToggleOpen[t]}})}selectCategorySelection(e){const t=e.category,i=this.state.categorySelections[t],n=i===ra.None||i===ra.Partial?ra.All:ra.None,a=n===ra.All,o={...this.state.actionSelections},s=this.state.renderOrder.find((e=>e.category===t));s&&(s.orderedActions.forEach((e=>{o[e]=a})),this.setState({...this.state,actionSelections:o,categorySelections:{...this.state.categorySelections,[s.category]:n}}))}selectActionName(e,t){const i=this.state.actionSelections[e],n={...this.state.actionSelections,[e]:!i},a=t.orderedActions.filter((e=>n[e])).length,o=0===a?ra.None:a===t.orderedActions.length?ra.All:ra.Partial;this.setState({...this.state,actionSelections:n,categorySelections:{...this.state.categorySelections,[t.category]:o}})}clearAllSelections(){const e=this.getBulkUpdateNextActionSelectionState((0,x.Yd)(this.state.actionSelections),!1),t=this.getBulkUpdateNextCategorySelectionState((0,x.Yd)(this.state.categorySelections),ra.None);this.setState({...this.state,actionSelections:e,categorySelections:t})}getBulkUpdateNextCategorySelectionState(e,t){const i={...this.state.categorySelections};return e.forEach((e=>{i[e]=t})),i}getBulkUpdateNextActionSelectionState(e,t){const i={...this.state.actionSelections};return e.forEach((e=>{i[e]=t})),i}}var da=i(5210);const ca={page:a()(v.FormattedMessage,{id:"auditlogEventFilter.categoryName.page",defaultMessage:"Page"}),space:a()(v.FormattedMessage,{id:"auditlogEventFilter.categoryName.workspace",defaultMessage:"Workspace"}),team:a()(v.FormattedMessage,{id:"auditlogEventFilter.categoryName.team",defaultMessage:"Teamspace"}),account:a()(v.FormattedMessage,{id:"auditlogEventFilter.categoryName.account",defaultMessage:"Account"})};function ua(e){let{totalNumEventsForCategory:t,numSelectedForCategory:i,category:n,categoryOpen:o,shouldShowCount:r,onCategoryClick:l,onCategoryToggleClick:c,...u}=e;window.__c={n:"AuditLogCategoryMenuItem"};const m=(0,xe.yK)((e=>({textWrapperStyle:{margin:0},title:{margin:0,display:"flex",alignItems:"center"},categoryText:{marginLeft:8,fontWeight:600},categorySubHeader:{marginLeft:6},toggleButton:{marginLeft:2,marginRight:2}})),[]);let p,g;return p=r?a()(v.FormattedMessage,t===i?{id:"auditlogEventFilter.allEventsSelected",defaultMessage:"({totalNum} events)",values:{totalNum:t}}:{id:"auditlogEventFilter.numEventsSelected",defaultMessage:"({numSelected} of {totalNum} events selected)",values:{numSelected:i,totalNum:t}}):null,g=t===i||0!==i&&"partial",d.createElement(ot.Z,s()({},u,{className:"notranslate",textWrapperStyle:m.textWrapperStyle,focused:!1,title:a()("div",{style:m.title},void 0,a()(da.Z,{style:m.toggleButton,open:o,onClick:c,isSidebar:!1,fill:!1,icon:"chevron"}),a()(st.Z,{checked:g,size:14,checkSize:8,onClick:l}),a()(Ae.Z,{style:m.categoryText},void 0,ca[n]),a()(Ae.Z,{isSecondaryColor:!0,style:m.categorySubHeader},void 0,p))}))}class ma extends c.Z{constructor(){super(...arguments),this.storeTypes={componentStore:la,lastSelectionStore:la,menuListStore:nt.Z},this.renderMenu=()=>{const{componentStore:e,menuListStore:t}=this.stores,i=this.styles,n=[];let o=0,r=0;const l=e.state.searchQuery;for(const a of e.state.renderOrder){const t=a.category;if("team"===t&&!(0,F.bq)())return;const i=[];let s=0;for(const n of a.orderedActions)this.eventsToFilterOut.includes(n)||(i.push(this.renderActionNameMenu(n,a)),e.state.actionSelections[n]&&s++);if(o+=s,r+=i.length,n.push(this.renderCategoryMenu({renderGroup:a,shouldShowCount:!Boolean(l),totalNumEventsForCategory:i.length,numSelectedForCategory:s})),e.state.categoryToggleOpen[t])if(l){const e=(0,sa.ZP)(l,i,ga);n.push(...e)}else n.push(...i)}const c={key:"results",items:n,render:e=>d.createElement(ct.Z,s()({},e,{title:null,loading:!1}))};return a()("div",{style:i.container},void 0,a()(Wi.Z,{style:i.searchInput,placeholder:this.props.intl.formatMessage({id:"auditlogEventFilter.searchPlaceholder",defaultMessage:"Search for an event"}),onChange:this.handleUpdateSearchQuery,value:e.state.searchQuery,showClearButton:!0}),l&&a()(ha,{totalNumSelected:o,totalNumEvents:r}),a()(rt.Z,{menuType:it.og.Popup,header:null,maxHeight:356},void 0,a()(lt.Z,{type:lt.i.Vertical,store:t,initialFocus:0,sections:[c]})),a()(ct.Z,{topBorder:!0,style:{padding:"8px 8px 2px 8px",justifyContent:"space-between",display:"flex"}},void 0,a()(Xe.Z,{onClick:()=>{this.handleClear()}},void 0,a()(v.FormattedMessage,{id:"auditlogEventFilter.clearButton",defaultMessage:"Clear"})),a()($e.Z,{onClick:()=>{this.handleApply()}},void 0,a()(v.FormattedMessage,{id:"auditlogEventFilter.applyButton",defaultMessage:"Apply"}))))},this.renderPillButtonOrigin=e=>{const{componentStore:t}=this.stores,i=t.hasActionNameSelected();return a()(at.Z,{on:i,icon:m.Z.bot({width:16,marginRight:6,fill:"currentColor"}),title:a()("span",{},void 0,e),onClick:()=>{this.setMenuOpen(!0)}})},this.featureGatedEventsToFilterOut=(0,x.qP)(Kn).reduce(((e,t)=>{let[i,n]=t;return k.default.checkGate(i)?e:[...e,...n]}),[]),this.teamspaceGuestEventsToFilterOut=(0,K.F$)()?[]:["team_guest_default_permission_updated"],this.guestMembershipEventsToFilterOut=(0,K.Ye)()?[]:["guest_membership_requests_toggled"],this.eventsToFilterOut=[...this.featureGatedEventsToFilterOut,...this.teamspaceGuestEventsToFilterOut,...this.guestMembershipEventsToFilterOut],this.setMenuOpen=e=>{const{componentStore:t}=this.stores;t.setState({...t.state,isMenuOpen:e})},this.handleUpdateSearchQuery=e=>{this.stores.componentStore.updateSearchQuery(e.target.value)},this.styles={container:{minWidth:460},searchInput:{padding:8,borderBottomLeftRadius:0,borderBottomRightRadius:0,boxShadow:"none",borderBottomWidth:1,borderBottomStyle:"solid",borderBottomColor:this.theme.lightDividerColor},popup:{paddingBottom:8}}}renderComponent(){const{componentStore:e}=this.stores,t=this.styles,i=a()(v.FormattedMessage,{id:"auditlogEventFilter.title",defaultMessage:"Event"}),n=this.renderPillButtonOrigin(i);return a()(ut.Z,{marginAfter:!1},void 0,a()(dt.ZP,{popupType:dt.ZP.PopupType.Popup,placementToOrigin:dt.ZP.Placement.Bottom,alignmentToOrigin:dt.ZP.Alignment.Start,open:e.state.isMenuOpen,render:this.renderMenu,onDismiss:()=>{this.handleMenuCloseFromOutside()},keepFocus:!0,origin:n,preventScaleTransition:!0,style:t.popup}))}renderCategoryMenu(e){const{renderGroup:t,shouldShowCount:i,totalNumEventsForCategory:n,numSelectedForCategory:a}=e,{componentStore:o}=this.stores,r=t.category,l=()=>{o.toggleCategorySelection(t)},c=()=>{o.selectCategorySelection(t)};return{key:r,action:l,render:e=>d.createElement(ua,s()({totalNumEventsForCategory:n,numSelectedForCategory:a,category:r,categoryOpen:o.state.categoryToggleOpen[r],shouldShowCount:i,onCategoryToggleClick:l,onCategoryClick:c},e)),localizedActionName:null,actionName:null}}renderActionNameMenu(e,t){const{intl:i}=this.props,{componentStore:n}=this.stores,o=()=>{n.selectActionName(e,t)},r=i.formatMessage(Xn[e]);return{key:e,action:o,render:t=>d.createElement(ot.Z,s()({},t,{icon:a()(st.Z,{checked:n.state.actionSelections[e],size:14,checkSize:8,onClick:o}),focused:!1,title:r,className:"notranslate",style:{paddingLeft:32},textWrapperStyle:{marginLeft:4}})),actionName:e,localizedActionName:r}}handleMenuCloseFromOutside(){const{componentStore:e,lastSelectionStore:t}=this.stores;e.setState({...e.state,actionSelections:{...t.state.actionSelections}}),this.setMenuOpen(!1)}handleClear(){const{componentStore:e}=this.stores;e.clearAllSelections()}handleApply(){const{onChange:e}=this.props,{componentStore:t,lastSelectionStore:i}=this.stores,n=t.getAllActionNames(),a=t.getSelectedActionNames();e(n.length===a.length?[]:a),0===a.length&&t.reset(),i.setState({...i.state,actionSelections:{...t.state.actionSelections}}),this.setMenuOpen(!1)}}ma.displayName="AuditLogEventFilter";const pa=(0,v.injectIntl)(ma);function ga(e){var t;return l().compact([e.key,null===(t=e.localizedActionName)||void 0===t?void 0:t.toLowerCase()]).join(" ")}function ha(e){let{totalNumSelected:t,totalNumEvents:i}=e;window.__c={n:"SelectedEventsPill"};const n=(0,xe.yK)((e=>({container:{background:qn.ZP.diffBackground,color:qn.ZP.diffTextColor,paddingInline:6,margin:8,marginBottom:0,borderRadius:4,fontWeight:510,width:"fit-content"},textWrapperStyle:{marginLeft:8}})),[]);return a()(Ae.Z,{style:n.container},void 0,a()(v.FormattedMessage,{id:"auditLogEventFilter.selectedPill",defaultMessage:"{totalNumSelected} of {totalNumEvents} selected",values:{totalNumSelected:t,totalNumEvents:i}}))}const fa=(0,v.injectIntl)((function(e){window.__c={n:"AuditLogFilterContainer"};const{spaceStore:t}=e,[i,n]=(0,Ze.AF)(oe),[o,s,r]=(0,Ze.AF)(In);return a()("div",{style:{display:"flex",flexDirection:"row",gap:4}},void 0,a()(Xi,{mode:Qi.z.Pill,focused:!1,title:a()(v.FormattedMessage,{id:"auditlogDateFilter.title",defaultMessage:"Date"}),icon:m.Z.calendar,value:i.timeRange,showButtons:"footer",onChange:e=>{n({...i,timeRange:e,pageNum:1})}}),a()(Wn,{parentStore:t,auditLogHistoricalUserStore:r,selectedActors:i.actors,onChange:e=>{n({...i,actors:e,pageNum:1})}}),a()(pa,{parentStore:t,selectedEvents:i.actions,onChange:e=>{n({...i,actions:e,pageNum:1})}}))}));function va(){return a()(Be.Z,{large:!0,style:{marginBottom:0,paddingBottom:0,fontSize:16,fontWeight:f.Z.fontWeight.medium,display:"flex",justifyContent:"space-between"}},void 0,a()("div",{style:{gap:8,display:"flex"}},void 0,a()(v.FormattedMessage,{id:"auditlog.title",defaultMessage:"Audit log"})),a()(ya,{}))}function ya(){window.__c={n:"AuditLogFeedbackButton"};const e=(0,Pe.O7)();return et.default.isLocalhost?a()(Re.Z,{style:{marginLeft:10},isSmall:!0,onClick:()=>{w.navigateToExternalURL({environment:e,url:"https://dev.notion.so/notion/Audit-Log-Dev-feedback-e9048c4e7d544369b0b8413ec20f02cf",targetSelf:!0})}},void 0,"🎁 Feedback is a gift!"):null}var Sa=i(43568);const ba=function(){return a()("div",{style:{}},void 0,a()(Sa.Z,{paragraphs:[{lineHeight:45,lineMargin:20,sectionWidths:[100],repeat:1,sectionMargin:15},{lineHeight:40,lineMargin:5,sectionWidths:[100],repeat:8,sectionMargin:10}]}))};var Ma=i(21752);function wa(e){window.__c={n:"AuditLogColumnActor"};const{auditLogEntry:t,spaceStore:i,id:n}=e,o=(0,v.useIntl)(),r=(0,Ze.VK)((()=>{if(t.actor.actorType===Qt.KJ){const e=He.U6.createChildStore(i,{id:t.actor.actorId,table:Qt.KJ});if(e.isDefined()&&!e.getIsDeleted())return{actorStore:e};if(t.actor.email)return{avatar:{name:t.actor.name,email:t.actor.email}}}else if(t.actor.actorType===Lt.cZ){const e=He.Qx.createChildStore(i,{id:t.actor.actorId,table:Lt.cZ});return e.isDefined()?{actorStore:e}:{avatar:{name:t.actor.name,email:t.actor.actorId}}}return{actorStore:void 0}}),[i,t]),l=(0,Ze.VK)((()=>{var e,t;if(r)return(null===(e=r.actorStore)||void 0===e?void 0:e.getDisplayName(o))??(null===(t=r.avatar)||void 0===t?void 0:t.name)}),[r,o]),c=(0,Ze.VK)((()=>{var e,t;if(r)return(null===(e=r.actorStore)||void 0===e?void 0:e.getDetail())??(null===(t=r.avatar)||void 0===t?void 0:t.email)}),[r]),u=(0,d.useMemo)((()=>{var e;if(t.actor.actorType===Qt.KJ)return(0,Ma.K)(null===(e=t.actor.meta)||void 0===e?void 0:e.spaceRole)}),[t]),m=(0,xe.yK)((()=>({container:{display:"block",width:"100%",paddingBlock:6}})),[]),p=(0,d.createRef)();return a()(We.Z,{disableTooltip:Ca(p.current),renderTooltip:()=>d.createElement(d.Fragment,null,a()("div",{},void 0,l),a()("div",{},void 0,c)),placement:We.Z.Placement.Bottom,render:e=>d.createElement("div",s()({},e,{style:m.container}),d.createElement(Ma.Z,s()({id:n},r,{spaceRole:u})))})}function Ca(e){return!!e&&(e.scrollHeight>e.clientHeight||e.scrollWidth>e.clientWidth)}var _a=i(13991),ka=i(25464);function Ta(e){window.__c={n:"AuditLogColumnDateTime"};const{auditLogEntry:t,id:i}=e,n=(0,xe.yK)((()=>({container:{display:"block",width:"100%"}})),[]);return a()(We.Z,{renderTooltip:()=>a()("div",{style:{display:"flex",flexDirection:"column",fontVariantNumeric:"tabular-nums"}},void 0,a()("div",{},void 0,a()(v.FormattedMessage,{id:"auditLogSettings.timeTooltip.utcTime",defaultMessage:"UTC: {time}",values:{time:(0,Hn.$I)(t.serverTimestamp)}}))),render:e=>a()("div",{id:i,style:n.container},void 0,d.createElement(Ae.Z,s()({isSecondaryColor:!0},e),(0,Hn.Yx)(t.serverTimestamp,"medium_with_time",_a.SP))),placement:ka.u.Bottom})}var Ia=i(44317),Pa=i(65917),Za=i(19639),xa=i(90468),Fa=i(73123);function Aa(e){return"workspace"!==e}const Ea=(0,v.defineMessages)({password_cleared:{id:"auditlog.actionNames.eventColumn.password_cleared",defaultMessage:"Cleared login password"},password_set:{id:"auditlog.actionNames.eventColumn.password_set",defaultMessage:"Created a login password"},password_changed:{id:"auditlog.actionNames.eventColumn.password_changed",defaultMessage:"Changed login password"},logout:{id:"auditlog.actionNames.eventColumn.logout",defaultMessage:"Logged out"},user_deleted:{id:"auditlog.actionNames.eventColumn.user_deleted",defaultMessage:"User was deleted"},member_joined:{id:"auditlog.actionNames.eventColumn.member_joined",defaultMessage:"Joined the workspace"},file_uploaded:{id:"auditlog.actionNames.eventColumn.file_uploaded",defaultMessage:"Uploaded a file"},invite_link_reset:{id:"auditlog.actionNames.eventColumn.invite_link_reset",defaultMessage:"Reset invite link"},workspace_exported:{id:"auditlog.actionNames.eventColumn.workspace_exported",defaultMessage:"Exported all workspace content"},audit_log_exported:{id:"auditlogEventFilter.eventColumn.audit_log_exported",defaultMessage:"Exported audit log for last {duration} days"},user_analytics_exported:{id:"auditlogEventFilter.eventColumn.user_analytics_exported",defaultMessage:"Exported user analytics for {daysFilterString}"},content_analytics_exported:{id:"auditlogEventFilter.eventColumn.content_analytics_exported",defaultMessage:"Exported content analytics for {daysFilterString}"},workspace_icon_changed:{id:"auditlog.actionNames.eventColumn.workspace_icon_changed",defaultMessage:"Changed workspace icon"},public_page_cleared:{id:"auditlogEventFilter.actionNames.public_page_cleared",defaultMessage:"Public home page link cleared"},scim_token_generated:{id:"auditlog.actionNames.scim_token_generated",defaultMessage:"Generated API SCIM token"},scim_token_revoked:{id:"auditlog.actionNames.scim_token_revoked",defaultMessage:"Revoked API SCIM token"},page_access_requests_toggled:{id:"auditlog.actionNames.eventColumn.page_access_requests_toggled",defaultMessage:"page access requests from non-members"},public_page_sharing_toggled:{id:"auditlog.actionNames.eventColumn.public_page_sharing_toggled",defaultMessage:"members sharing pages publicly"},workspace_sidebar_editing_toggled:{id:"auditlog.actionNames.eventColumn.workspace_sidebar_editing_toggled",defaultMessage:"members changing the Workspace section"},disable_team_guests_toggled:{id:"auditlog.actionNames.eventColumn.disable_team_guests_toggled",defaultMessage:"teamspace guests"},disable_guests_toggled:{id:"auditlog.actionNames.eventColumn.disable_guests_toggled",defaultMessage:"guests"},pages_to_other_workspaces_toggled:{id:"auditlog.actionNames.eventColumn.pages_to_other_workspaces_toggled",defaultMessage:"moving or duplicating pages to other workspaces"},export_toggled:{id:"auditlog.actionNames.eventColumn.export_toggled",defaultMessage:"export"},idp_metadata_xml_updated:{id:"auditlog.actionNames.eventColumn.idp_metadata_xml_updated",defaultMessage:"Updated IDP metadata XML"},idp_metadata_xml_removed:{id:"auditlog.actionNames.eventColumn.idp_metadata_xml_removed",defaultMessage:"Removed IDP metadata XML"},saml_enabled:{id:"auditlog.actionNames.saml_enabled",defaultMessage:"Enabled SAML"},saml_disabled:{id:"auditlog.actionNames.saml_disabled",defaultMessage:"Disabled SAML"},saml_enforced:{id:"auditlog.actionNames.saml_enforced",defaultMessage:"Enabled enforcing SAML"},saml_unenforced:{id:"auditlog.actionNames.saml_unenforced",defaultMessage:"Disabled enforcing SAML"},automatic_account_creation_enabled:{id:"auditlog.actionNames.automatic_account_creation_enabled",defaultMessage:"Enabled automatically creating accounts on sign-in"},automatic_account_creation_disabled:{id:"auditlog.actionNames.automatic_account_creation_disabled",defaultMessage:"Disabled automatically creating accounts on sign-in"},workspace_analytics_enabled:{id:"auditlog.actionNames.workspace_analytics_enabled",defaultMessage:"Enabled page view tracking for workspace analytics"},workspace_analytics_disabled:{id:"auditlog.actionNames.workspace_analytics_disabled",defaultMessage:"Disabled page view tracking for workspace analytics"},a_private_page:{defaultMessage:"a private page",id:"auditlog.actionNames.eventColumn.private_page"},an_untitled_page:{defaultMessage:"an untitled page",id:"auditlog.actionNames.eventColumn.untitled_page"},thisWorkspace:{defaultMessage:"this workspace",id:"auditlog.actionNames.eventColumn.thisWorkspace"},otherWorkspace:{defaultMessage:"another workspace",id:"auditlog.actionNames.eventColumn.otherWorkspace"},workspaceLevel:{defaultMessage:"the workspace level",id:"auditlog.actionNames.eventColumn.workspaceLevel"},private:{defaultMessage:"private",id:"auditlog.actionNames.eventColumn.private"},a_file:{defaultMessage:"a file",id:"auditlog.actionNames.eventColumn.a_file"},a_file_with_extension:{defaultMessage:"a {extension} file",id:"auditlog.actionNames.eventColumn.a_file_with_extension"},team:{defaultMessage:"teamspace",id:"auditlog.actionNames.eventColumn.team"},for_a_private_team:{defaultMessage:"for a private teamspace",id:"auditlog.actionNames.eventColumn.for_private_team"},a_private_team:{defaultMessage:"a private teamspace",id:"auditlog.actionNames.eventColumn.private_team"},a_team_and_page:{defaultMessage:"a teamspace and page",id:"auditlog.actionNames.eventColumn.team_and_page"},team_member:{defaultMessage:"teamspace member",id:"auditlog.actionNames.eventColumn.team_member"},team_owner:{defaultMessage:"teamspace owner",id:"auditlog.actionNames.eventColumn.team_owner"},team_level_guest:{defaultMessage:"teamspace guest",id:"auditlog.actionNames.eventColumn.team_level_guest"},group:{defaultMessage:"group",id:"auditlog.actionNames.eventColumn.group"},user:{defaultMessage:"user",id:"auditLogEntry.user.noName"},adminContentSearchQuery:{defaultMessage:"query=“{query}“",id:"auditLogEntry.adminContentSearch.query"},adminContentSearchAudience:{defaultMessage:"audience=“{audience}“",id:"auditLogEntry.adminContentSearch.audience"},adminContentSearchCreatedBy:{defaultMessage:"created by=“{createdBy}“",id:"auditLogEntry.adminContentSearch.createdBy"},adminContentSearchSharedWith:{defaultMessage:"shared with=“{sharedWith}“",id:"auditLogEntry.adminContentSearch.sharedWith"},adminContentSearchTeamspaces:{defaultMessage:"{teamspaceCount, plural, one {teamspace=“{teamspaces}“} other {teamspaces=“{teamspaces}“}}",id:"auditLogEntry.adminContentSearch.teamspace"},adminContentSearchCreatedTime:{defaultMessage:"created time=“{createdTime}“",id:"auditLogEntry.adminContentSearch.createdTime"},adminContentSearchLastEditedTime:{defaultMessage:"last edited time=“{lastEditedTime}“",id:"auditLogEntry.adminContentSearch.lastEditedTime"},adminContentSearchPredicateSplit:{defaultMessage:", ",id:"auditLogEntry.adminContentSearch.predicateSplit"},from:{defaultMessage:"from",id:"auditLogEntry.spaceContentDuplication.from"},into:{defaultMessage:"into",id:"auditLogEntry.spaceContentDuplication.into"}});function Ba(e,t){if(t.target)return"user"in t.target&&t.target.user?Da(e,t.target.user):"bot"in t.target&&t.target.bot?t.target.bot.name?`“${t.target.bot.name}“`:"bot":"group"in t.target&&t.target.group?t.target.group.name?`“${t.target.group.name}“`:"group":void 0}function Da(e,t){return t?t.name&&t.email?`“${t.name}“ (${t.email})`:t.name?`“${t.name}“`:t.email?`“${t.email}“`:e.formatMessage(Ea.user):e.formatMessage(Ea.user)}const Ra=(0,v.defineMessages)({started:{id:"space.spaceContentDuplicationStatus.started",defaultMessage:"Started"},completed:{id:"space.spaceContentDuplicationStatus.completed",defaultMessage:"Completed"},failed:{id:"space.spaceContentDuplicationStatus.failed",defaultMessage:"Failed"}}),La=(0,v.defineMessages)({equallyRestrictive:{defaultMessage:". This is the same as the current workspace setting",id:"auditlog.actionNames.eventColumn.team_guests_toggled.team_space_equal"},moreRestrictive:{defaultMessage:". This is more restrictive than the current workspace setting",id:"auditlog.actionNames.eventColumn.team_guests_toggled.team_space_more_restrictive"},lessRestrictive:{defaultMessage:". This is less restrictive than the current workspace setting",id:"auditlog.actionNames.eventColumn.team_guests_toggled.team_space_less_restrictive"}});function Na(e,t){if(void 0!==e&&void 0!==t)return e===t?d.createElement(v.FormattedMessage,La.equallyRestrictive):!e&&t?d.createElement(v.FormattedMessage,La.moreRestrictive):e&&!t?d.createElement(v.FormattedMessage,La.lessRestrictive):void 0}function Oa(e){return e.name?`“${e.name}“ group`:d.createElement(v.FormattedMessage,Ea.group)}function Va(e){return e.changes.name.oldValue&&e.changes.name.newValue?a()(v.FormattedMessage,{defaultMessage:"from “{oldTeamName}“ to “{newTeamName}“",id:"auditlog.actionNames.eventColumn.from_old_team_name_to_new_team_name",values:{oldTeamName:e.changes.name.oldValue,newTeamName:e.changes.name.newValue}}):!e.changes.name.oldValue&&e.changes.name.newValue?a()(v.FormattedMessage,{defaultMessage:"from some teamspace name to “{newTeamName}“",id:"auditlog.actionNames.eventColumn.from_unknown_team_name_to_new_team_name",values:{newTeamName:e.changes.name.newValue}}):a()(v.FormattedMessage,{defaultMessage:"for {teamName}",id:"auditlog.actionNames.eventColumn.for_team_name",values:{teamName:Ua(e)}})}function Ua(e){return"team"in e.target?Wa(e.target.team):d.createElement(v.FormattedMessage,Ea.team)}function Wa(e){return e.name?`“${e.name}“ teamspace`:d.createElement(v.FormattedMessage,Ea.team)}function Ka(e){if(e)switch(e){case"owner":return d.createElement(v.FormattedMessage,Ea.team_owner);case"member":return d.createElement(v.FormattedMessage,Ea.team_member);case"team_level_guest":return d.createElement(v.FormattedMessage,Ea.team_level_guest)}return d.createElement(v.FormattedMessage,Ea.team_member)}function za(e){return d.createElement(v.FormattedMessage,function(e){if(!e)return ft.mq.noAccessLabel;switch(e){case"editor":return ft.mq.fullAccessLabel;case"membership_admin":case"read_and_write":return ft.mq.canEditLabel;case"content_only_editor":return ft.mq.canEditContentLabel;case"reader":return ft.mq.canReadLabel;case"comment_only":return ft.mq.canCommentLabel;case"none":return ft.mq.noAccessLabel;default:(0,x.t1)(e)}}(e))}function Ga(e){var t,i;return{oldRole:d.createElement(v.FormattedMessage,qa(null===(t=e.changes)||void 0===t||null===(t=t.permission)||void 0===t?void 0:t.oldValue)),newRole:d.createElement(v.FormattedMessage,qa(null===(i=e.changes)||void 0===i||null===(i=i.permission)||void 0===i?void 0:i.newValue))}}const qa=e=>{if(!e)return ft.mq.noAccessLabel;switch(e){case"editor":return ft.mq.workspaceOwnerLabel;case"membership_admin":return ft.mq.membershipAdminLabel;case"read_and_write":return ft.mq.memberLabel;default:return ft.mq.noAccessLabel}};function Ha(e){return e.target.page.title?`“${e.target.page.title}“`:d.createElement(v.FormattedMessage,Ea.an_untitled_page)}function ja(e){var t,i;return null!==(t=e.target)&&void 0!==t&&null!==(t=t.page)&&void 0!==t&&null!==(t=t.meta)&&void 0!==t&&t.parent&&"title"in(null===(i=e.target)||void 0===i||null===(i=i.page)||void 0===i||null===(i=i.meta)||void 0===i?void 0:i.parent)?`“${e.target.page.meta.parent.title}“`:d.createElement(v.FormattedMessage,Ea.an_untitled_page)}function Qa(e){var t;return null!==(t=e.actor.meta)&&void 0!==t&&t.platform?a()(v.FormattedMessage,{defaultMessage:"on {platform}",id:"auditlog.actionNames.eventColumn.logged_in_platform",values:{platform:e.actor.meta.platform}}):""}function Ya(e){switch(e){case"google":return a()(v.FormattedMessage,{defaultMessage:"Google",id:"auditlog.actionNames.eventColumn.logged_in_auth_type.google"});case"email":return a()(v.FormattedMessage,{defaultMessage:"temporary passcode",id:"auditlog.actionNames.eventColumn.logged_in_auth_type.email"});case"admin":return a()(v.FormattedMessage,{defaultMessage:"admin mode",id:"auditlog.actionNames.eventColumn.logged_in_auth_type.admin"});case"saml":return a()(v.FormattedMessage,{defaultMessage:"SAML SSO",id:"auditlog.actionNames.eventColumn.logged_in_auth_type.saml"});case"apple":return a()(v.FormattedMessage,{defaultMessage:"Apple ID",id:"auditlog.actionNames.eventColumn.logged_in_auth_type.apple"});case"password":case"password-no-mfa":case"password-sms":case"password-totp":case"password-backup-code":return a()(v.FormattedMessage,{defaultMessage:"password",id:"auditlog.actionNames.eventColumn.logged_in_auth_type.password"});default:(0,x.t1)(e)}}function $a(e){return e.changes.name.oldValue?a()(v.FormattedMessage,{defaultMessage:"from “{oldDomain}“",id:"auditlog.actionNames.eventColumn.old_domain",values:{oldDomain:e.changes.name.oldValue}}):""}function Xa(e,t){return"block"===e.table?a()(v.FormattedMessage,{defaultMessage:"{teamName} page {parentPage}",id:"auditlog.actionNames.eventColumn.team_parent_page",values:{teamName:Wa(t),parentPage:Ja(e)}}):"team"===e.table?Wa(t):void 0}function Ja(e){return"title"in e?`“${e.title}“`:d.createElement(v.FormattedMessage,Ea.an_untitled_page)}function eo(e,t){if(!t)return d.createElement(v.FormattedMessage,Ea.an_untitled_page);const i=t.table;return"space"===i?t.id!==e?d.createElement(v.FormattedMessage,Ea.otherWorkspace):Aa(t.permissionLevel)?d.createElement(v.FormattedMessage,Ea.private):d.createElement(v.FormattedMessage,Ea.thisWorkspace):"team"===i?Wa(t):"block"===i?t.title?`“${t.title}“`:d.createElement(v.FormattedMessage,Ea.an_untitled_page):void 0}const to=(0,v.defineMessages)({open:{defaultMessage:"Open",id:"auditlog.actionNames.eventColumn.team_privacy_types.open"},closed:{defaultMessage:"Closed",id:"auditlog.actionNames.eventColumn.team_privacy_types.closed"},private:{defaultMessage:"Private",id:"auditlog.actionNames.eventColumn.team_privacy_types.private"},default:{defaultMessage:"Default",id:"auditlog.actionNames.eventColumn.team_privacy_types.default"},unknown:{defaultMessage:"an unknown privacy state",id:"auditlog.actionNames.eventColumn.team_privacy_types.unknown"}});function io(e){return e?d.createElement(v.FormattedMessage,to[e]):d.createElement(v.FormattedMessage,to.unknown)}function no(e){return e.changes.enabled.newValue?a()(v.FormattedMessage,{defaultMessage:"Disabled",id:"auditlog.actionNames.eventColumn.membership_requests_toggled.disabled"}):a()(v.FormattedMessage,{defaultMessage:"Enabled",id:"auditlog.actionNames.eventColumn.membership_requests_toggled.enabled"})}function ao(e){return"approved"===e.changes.requestStatus.newValue?a()(v.FormattedMessage,{defaultMessage:"Approved",id:"auditlog.actionNames.eventColumn.membership_request_resolved.approved"}):a()(v.FormattedMessage,{defaultMessage:"Declined",id:"auditlog.actionNames.eventColumn.membership_request_resolved.declined"})}function oo(e){return e.changes.enabled.newValue?a()(v.FormattedMessage,{defaultMessage:"Disabled",id:"auditlog.actionNames.eventColumn.guest_membership_requests_toggled.disabled"}):a()(v.FormattedMessage,{defaultMessage:"Enabled",id:"auditlog.actionNames.eventColumn.guest_membership_requests_toggled.enabled"})}function so(e){return e.changes.enabled.newValue?a()(v.FormattedMessage,{defaultMessage:"Enabled",id:"auditlog.actionNames.eventColumn.ai_admin_legal_acceptance_toggled.disabled"}):a()(v.FormattedMessage,{defaultMessage:"Disabled",id:"auditlog.actionNames.eventColumn.ai_admin_legal_acceptance_toggled.enabled"})}const ro=(0,v.defineMessages)({team_members:{defaultMessage:"any teamspace member",id:"auditlog.actionNames.eventColumn.team_access_level_types.team_members"},team_owners:{defaultMessage:"only teamspace owners",id:"auditlog.actionNames.eventColumn.team_access_level_types.team_owners"},unknown:{defaultMessage:"unknown",id:"auditlog.actionNames.eventColumn.team_access_level_types.unknown"}});function lo(e){return a()(v.FormattedMessage,"recurrence"===e?{id:"auditlog.actionNames.eventColumn.automation_type.recurrence",defaultMessage:"a repeating automation"}:{id:"auditlog.actionNames.eventColumn.automation_type.automation",defaultMessage:"an automation"})}function co(e){return!!e.meta&&("inSudoMode"in e.meta&&e.meta.inSudoMode)}function uo(e,t,i){var n,o,s,r,c,u,m,p,g,h,f,y,S,b,M,w,C,_,k,T,I,P,Z,F,A;switch(e.actionName){case"page.properties_edited":{const t=e.meta.propertiesUpdated,i=e.meta.propertiesUpdated.map((e=>`"${e.propertyName}"`)).join(", ");return 1===t.length?a()(v.FormattedMessage,{defaultMessage:"Edited property {properties} on {pageName}",id:"auditlog.actionNames.eventColumn.page_properties_edited.single_property",values:{properties:i,pageName:Ha(e)}}):a()(v.FormattedMessage,{defaultMessage:"Edited properties {properties} on {pageName}",id:"auditlog.actionNames.eventColumn.page_properties_edited.multiple_properties",values:{properties:i,pageName:Ha(e)}})}case"page.discussion.comment.created":return a()(v.FormattedMessage,{defaultMessage:"Commented on {pageName}",id:"auditlog.actionNames.eventColumn.page.discussion.comment.created",values:{pageName:Ha(e)}});case"page.discussion.comment.deleted":return a()(v.FormattedMessage,{defaultMessage:"Deleted comment on {pageName}",id:"auditlog.actionNames.eventColumn.page.discussion.comment.deleted",values:{pageName:Ha(e)}});case"page.discussion.comment.updated":return a()(v.FormattedMessage,{defaultMessage:"Edited comment on {pageName}",id:"auditlog.actionNames.eventColumn.page.discussion.comment.updated",values:{pageName:Ha(e)}});case"page_edited":return a()(v.FormattedMessage,{defaultMessage:"Edited {pageName}",id:"auditlog.actionNames.eventColumn.page_edited",values:{pageName:Ha(e)}});case"page_viewed":return a()(v.FormattedMessage,{defaultMessage:"Viewed {pageName}",id:"auditlog.actionNames.eventColumn.page_viewed_under",values:{pageName:Ha(e)}});case"page_deleted":return e.target.page.meta.permanentDeletion?a()(v.FormattedMessage,{defaultMessage:"Permanently deleted {pageName}",id:"auditlog.actionNames.eventColumn.page_permanently_deleted",values:{pageName:Ha(e)}}):a()(v.FormattedMessage,{defaultMessage:"Deleted {pageName}",id:"auditlog.actionNames.eventColumn.page_deleted",values:{pageName:Ha(e)}});case"page.permanently_deleted":return a()(v.FormattedMessage,{defaultMessage:"Permanently deleted {pageName}",id:"auditlog.actionNames.eventColumn.page.permanently_deleted",values:{pageName:Ha(e)}});case"page_restored":return a()(v.FormattedMessage,{defaultMessage:"Restored {pageName}",id:"auditlog.actionNames.eventColumn.page_restored",values:{pageName:Ha(e)}});case"page_exported":return a()(v.FormattedMessage,{defaultMessage:"Exported {pageName}",id:"auditlog.actionNames.eventColumn.page_exported",values:{pageName:Ha(e)}});case"page_moved":{var E,B,D;const t=null===(E=e.changes)||void 0===E?void 0:E.team,n=e.changes.parent.oldValue,o=e.changes.parent.newValue;let s=eo(e.spaceId,e.changes.parent.oldValue),r=eo(e.spaceId,e.changes.parent.newValue);null!=t&&t.oldValue&&null!=t&&t.newValue&&n&&o&&("block"===n.table||"block"===o.table)?(s=Xa(n,null==t?void 0:t.oldValue),r=Xa(o,null==t?void 0:t.newValue)):"space"===(null===(B=e.changes.parent.oldValue)||void 0===B?void 0:B.table)&&"space"===(null===(D=e.changes.parent.newValue)||void 0===D?void 0:D.table)&&e.changes.parent.oldValue.id===e.changes.parent.newValue.id&&(Aa(e.changes.parent.oldValue.permissionLevel)||Aa(e.changes.parent.newValue.permissionLevel))&&(s=Aa(e.changes.parent.oldValue.permissionLevel)?d.createElement(v.FormattedMessage,Ea.private):d.createElement(v.FormattedMessage,Ea.workspaceLevel),r=Aa(e.changes.parent.newValue.permissionLevel)?d.createElement(v.FormattedMessage,Ea.private):d.createElement(v.FormattedMessage,Ea.workspaceLevel));const l=s?i.formatMessage({id:"auditLogEntry.changes.page_moved.old_parent",defaultMessage:" from {oldParentName}"},{oldParentName:s}):"",c=r?i.formatMessage({id:"auditLogEntry.changes.page_moved.new_parent",defaultMessage:" to {newParentName}"},{newParentName:r}):"";return a()(v.FormattedMessage,{defaultMessage:"Moved {pageName}{oldParentMessage}{newParentMessage}{inSudoMode, select, true { using administrator privileges} other {}}",id:"auditlog.actionNames.eventColumn.page_moved",values:{pageName:Ha(e),oldParentMessage:l,newParentMessage:c,inSudoMode:co(e)}})}case"page_permission_updated":return function(e,t){var i,n,o;const s="bot"in t.target,r="space"in t.target,l="team"in t.target,d="group"in t.target,c="user"in t.target&&"guest"===(null===(i=t.target.user.meta)||void 0===i?void 0:i.spaceRole);var u,m;if(s)return a()(v.FormattedMessage,{defaultMessage:"Updated permissions of {pageName} for bot {botName} from {oldRole} to {newRole}{inSudoMode, select, true { using administrator privileges} other {}}",id:"auditlog.actionNames.eventColumn.page_permissions_updated_workspace_bot",values:{botName:Ba(e,t),oldRole:za(null===(u=t.changes)||void 0===u||null===(u=u.permission)||void 0===u?void 0:u.oldValue),newRole:za(null===(m=t.changes)||void 0===m||null===(m=m.permission)||void 0===m?void 0:m.newValue),pageName:Ha(t),inSudoMode:co(t)}});var p,g,h,f,y,S;if(r)return a()(v.FormattedMessage,{defaultMessage:"Updated permissions of {pageName} for everyone in the workspace from {oldRole} to {newRole}{inSudoMode, select, true { using administrator privileges} other {}}",id:"auditlog.actionNames.eventColumn.page_permissions_updated_workspace_space",values:{oldRole:za(null===(p=t.changes)||void 0===p||null===(p=p.permission)||void 0===p?void 0:p.oldValue),newRole:za(null===(g=t.changes)||void 0===g||null===(g=g.permission)||void 0===g?void 0:g.newValue),pageName:Ha(t),inSudoMode:co(t)}});if(l)return a()(v.FormattedMessage,{defaultMessage:"Updated permissions of {pageName} for {teamName} from {oldRole} to {newRole}{inSudoMode, select, true { using administrator privileges} other {}}",id:"auditlog.actionNames.eventColumn.page_permissions_updated_team",values:{oldRole:za(null===(h=t.changes)||void 0===h||null===(h=h.permission)||void 0===h?void 0:h.oldValue),newRole:za(null===(f=t.changes)||void 0===f||null===(f=f.permission)||void 0===f?void 0:f.newValue),pageName:Ha(t),teamName:Ua(t),inSudoMode:co(t)}});if(c)return a()(v.FormattedMessage,{defaultMessage:"Updated permissions of {pageName} for guest {guestNameAndEmail} from {oldRole} to {newRole}{inSudoMode, select, true { using administrator privileges} other {}}",id:"auditlog.actionNames.eventColumn.page_permissions_updated_workspace_guest",values:{guestNameAndEmail:Ba(e,t),oldRole:za(null===(y=t.changes)||void 0===y||null===(y=y.permission)||void 0===y?void 0:y.oldValue),newRole:za(null===(S=t.changes)||void 0===S||null===(S=S.permission)||void 0===S?void 0:S.newValue),pageName:Ha(t),inSudoMode:co(t)}});if(d){var b,M;return a()(v.FormattedMessage,{defaultMessage:"Updated permissions of {pageName} for group {groupName} from {oldRole} to {newRole}{inSudoMode, select, true { using administrator privileges} other {}}",id:"auditlog.actionNames.eventColumn.page_permissions_updated_workspace_group",values:{groupName:Ba(e,t),oldRole:za(null===(b=t.changes)||void 0===b||null===(b=b.permission)||void 0===b?void 0:b.oldValue),newRole:za(null===(M=t.changes)||void 0===M||null===(M=M.permission)||void 0===M?void 0:M.newValue),pageName:Ha(t),inSudoMode:co(t)}})}return a()(v.FormattedMessage,{defaultMessage:"Updated permissions of {pageName} for {memberNameAndEmail} from {oldRole} to {newRole}{inSudoMode, select, true { using administrator privileges} other {}}",id:"auditlog.actionNames.eventColumn.page_permissions_updated_workspace_default",values:{memberNameAndEmail:Ba(e,t),oldRole:za(null===(n=t.changes)||void 0===n||null===(n=n.permission)||void 0===n?void 0:n.oldValue),newRole:za(null===(o=t.changes)||void 0===o||null===(o=o.permission)||void 0===o?void 0:o.newValue),pageName:Ha(t),inSudoMode:co(t)}})}(i,e);case"page_created":const V=te(e);if(null!=V&&null!==(n=V.meta)&&void 0!==n&&n.parent){var R,L,N,O;if(V.meta.parent.table===xa.bx)return"private"===(null===(N=V.meta)||void 0===N?void 0:N.permissionLevel)||"private"===(null===(O=V.meta)||void 0===O?void 0:O.pageAudience)?a()(v.FormattedMessage,{defaultMessage:"Created a private page",id:"auditlog.actionNames.eventColumn.page_created_private"}):a()(v.FormattedMessage,{defaultMessage:"Created a page in the workspace",id:"auditlog.actionNames.eventColumn.page_created_workspace"});if((null===(R=V.meta)||void 0===R?void 0:R.parent.table)===yt.e0)return a()(v.FormattedMessage,{defaultMessage:"Created a page under {teamName}",id:"auditlog.actionNames.eventColumn.page_created_team",values:{teamName:Wa(V.meta.parent)}});if((null===(L=V.meta)||void 0===L?void 0:L.parent.table)===hn.iU)return a()(v.FormattedMessage,{defaultMessage:"Created a page under {parentPageName}",id:"auditlog.actionNames.eventColumn.page_created_under",values:{parentPageName:ja(e)}})}return a()(v.FormattedMessage,{defaultMessage:"Created a page",id:"auditlog.actionNames.eventColumn.page_created_general"});case"page_shared_to_web":return function(e){if(void 0===e.changes.permission.newValue||"none"===e.changes.permission.newValue)return a()(v.FormattedMessage,{defaultMessage:"Disabled sharing {pageName} to web{inSudoMode, select, true { using administrator privileges} other {}}",id:"auditlog.actionNames.eventColumn.page_shared_to_web.disabled",values:{pageName:Ha(e),inSudoMode:co(e)}});return a()(v.FormattedMessage,{defaultMessage:"Enabled sharing {pageName} to web{inSudoMode, select, true { using administrator privileges} other {}}",id:"auditlog.actionNames.eventColumn.page_shared_to_web.enabled",values:{pageName:Ha(e),inSudoMode:co(e)}})}(e);case"login":return function(e,t){var i,n,o;const s=null===(i=e.meta)||void 0===i?void 0:i.authType;return null!==(n=e.actor.meta)&&void 0!==n&&n.countryCode&&s?a()(v.FormattedMessage,{id:"auditLog.actionNames.eventColumn.loginWithCityStateAndCountry.withAuthType",defaultMessage:"Logged in {platform} via {loginMethod} in {geolocation}",values:{platform:Qa(e),geolocation:na(e,t),loginMethod:Ya(s)}}):null!==(o=e.actor.meta)&&void 0!==o&&o.countryCode&&!s?a()(v.FormattedMessage,{id:"auditLog.actionNames.eventColumn.loginWithCityStateAndCountry",defaultMessage:"Logged in {platform} in {geolocation}",values:{platform:Qa(e),geolocation:na(e,t)}}):a()(v.FormattedMessage,s?{id:"auditLog.actionNames.eventColumn.loginWithPlatform.withAuthType",defaultMessage:"Logged in {platform} via {loginMethod}",values:{platform:Qa(e),loginMethod:Ya(s)}}:{id:"auditLog.actionNames.eventColumn.loginWithPlatform",defaultMessage:"Logged in {platform}",values:{platform:Qa(e)}})}(e,i);case"allowed_support_access":return a()(v.FormattedMessage,{defaultMessage:"Granted support access for {name} until {date}",id:"auditlog.actionNames.allowed_support_access",values:{date:i.formatDate(e.changes.expiresAt),name:e.target.user.name}});case"revoked_support_access":return a()(v.FormattedMessage,{defaultMessage:"Revoked support access for {name}",id:"auditlog.actionNames.revoked_support_access",values:{name:e.target.user.name}});case"preferred_name_changed":return function(e,t){var i;const n=!!e.target&&e.actor.actorId!==(null===(i=e.target)||void 0===i?void 0:i.user.id),o=e.changes.name.oldValue,s=e.changes.name.newValue;if(n){if(o&&s)return a()(v.FormattedMessage,{defaultMessage:'Changed {memberNameAndEmail} name from "{oldValue}" to "{newValue}"',id:"auditlog.actionNames.eventColumn.external_preferred_name_changed",values:{memberNameAndEmail:Ba(t,e),oldValue:o,newValue:s}});if(!o&&s)return a()(v.FormattedMessage,{defaultMessage:'Set {memberNameAndEmail} name to "{newValue}"',id:"auditlog.actionNames.eventColumn.external_preferred_name_changed_to_value",values:{memberNameAndEmail:Ba(t,e),newValue:s}});if(o&&!s)return a()(v.FormattedMessage,{defaultMessage:'Removed {memberNameAndEmail} name "{oldValue}"',id:"auditlog.actionNames.eventColumn.external_preferred_name_changed_from_value",values:{memberNameAndEmail:Ba(t,e),oldValue:o}})}if(o&&s)return a()(v.FormattedMessage,{defaultMessage:'Changed name from "{oldValue}" to "{newValue}"',id:"auditlog.actionNames.eventColumn.preferred_name_changed",values:{oldValue:o,newValue:s}});if(!o&&s)return a()(v.FormattedMessage,{defaultMessage:'Set name to "{newValue}"',id:"auditlog.actionNames.eventColumn.preferred_name_changed_to_value",values:{newValue:s}});if(o&&!s)return a()(v.FormattedMessage,{defaultMessage:'Removed name "{oldValue}"',id:"auditlog.actionNames.eventColumn.preferred_name_changed_from_value",values:{oldValue:o}});return a()(v.FormattedMessage,{defaultMessage:"Name was changed",id:"auditlog.actionNames.eventColumn.preferred_name_changed_generic"})}(e,i);case"email_changed":return function(e,t){var i;return e.target&&e.actor.actorId!==(null===(i=e.target)||void 0===i?void 0:i.user.id)?a()(v.FormattedMessage,{defaultMessage:"Changed {memberNameAndEmail} email from {oldEmail} to {newEmail}",id:"auditlog.actionNames.eventColumn.external_email_changed",values:{memberNameAndEmail:Ba(t,e),oldEmail:e.changes.email.oldValue,newEmail:e.changes.email.newValue}}):a()(v.FormattedMessage,{defaultMessage:"Changed email from {oldEmail} to {newEmail}",id:"auditlog.actionNames.eventColumn.email_changed",values:{oldEmail:e.changes.email.oldValue,newEmail:e.changes.email.newValue}})}(e,i);case"picture_changed":return function(e,t){var i;return e.target&&e.actor.actorId!==(null===(i=e.target)||void 0===i?void 0:i.user.id)?a()(v.FormattedMessage,{defaultMessage:"Changed {memberNameAndEmail} profile picture",id:"auditlog.actionNames.eventColumn.external_picture_changed",values:{memberNameAndEmail:Ba(t,e)}}):a()(v.FormattedMessage,{defaultMessage:"Changed profile picture",id:"auditlog.actionNames.eventColumn.picture_changed"})}(e,i);case"member_invited":{const t=Ga(e);return a()(v.FormattedMessage,{defaultMessage:"Invited {memberNameAndEmail} to the workspace as {newRole}",id:"auditlog.actionNames.eventColumn.member_invited",values:{memberNameAndEmail:Ba(i,e),newRole:t.newRole}})}case"member_role_updated":{const t=Ga(e);return a()(v.FormattedMessage,{defaultMessage:"Updated {memberNameAndEmail} from {oldRole} to {newRole}",id:"auditlog.actionNames.eventColumn.member_role_updated",values:{memberNameAndEmail:Ba(i,e),oldRole:t.oldRole,newRole:t.newRole}})}case"member_removed":return e.actor.actorId===e.target.user.id?a()(v.FormattedMessage,{defaultMessage:"Left the workspace",id:"auditlog.actionNames.eventColumn.member_left"}):a()(v.FormattedMessage,{defaultMessage:"Removed {memberNameAndEmail} from the workspace",id:"auditlog.actionNames.eventColumn.member_removed",values:{memberNameAndEmail:Ba(i,e)}});case"guest_removed":return a()(v.FormattedMessage,{defaultMessage:"Removed guest {guestNameAndEmail} from the workspace",id:"auditlog.actionNames.eventColumn.guest_removed",values:{guestNameAndEmail:Ba(i,e)}});case"file_uploaded":return a()(v.FormattedMessage,{defaultMessage:"Uploaded a file to {pageName}",id:"auditlog.actionNames.eventColumn.file_uploaded_public",values:{pageName:Ha(e)}});case"file_downloaded":return function(e){return a()(v.FormattedMessage,{defaultMessage:"Downloaded {fileName} from {pageName}",id:"auditlog.actionNames.eventColumn.file_downloaded",values:{fileName:mo(e),pageName:Ha(e)}})}(e);case"invite_link_toggled":return e.changes.enabled.newValue?a()(v.FormattedMessage,{id:"auditlog.actionNames.eventColumn.inviteLink.enabled",defaultMessage:"Enabled invite link"}):a()(v.FormattedMessage,{id:"auditlog.actionNames.eventColumn.inviteLink.disabled",defaultMessage:"Disabled invite link"});case"public_page_sharing_toggled":case"workspace_sidebar_editing_toggled":case"disable_team_guests_toggled":case"disable_guests_toggled":case"pages_to_other_workspaces_toggled":case"export_toggled":case"page_access_requests_toggled":return e.changes.enabled.newValue?a()(v.FormattedMessage,{id:"auditlog.actionNames.eventColumn.toggleEvent.disabled",defaultMessage:"Disabled {workspaceSetting}",values:{workspaceSetting:i.formatMessage(Ea[e.actionName])}}):a()(v.FormattedMessage,{id:"auditlog.actionNames.eventColumn.toggleEvent.enabled",defaultMessage:"Enabled {workspaceSetting}",values:{workspaceSetting:i.formatMessage(Ea[e.actionName])}});case"workspace_name_changed":return a()(v.FormattedMessage,{defaultMessage:"Changed workspace name from “{oldValue}“ to “{newValue}“",id:"auditlog.actionNames.eventColumn.workspace_name_changed",values:{oldValue:e.changes.name.oldValue,newValue:e.changes.name.newValue}});case"workspace_domain_changed":return a()(v.FormattedMessage,{defaultMessage:"Changed workspace domain {oldValue} to “{newValue}“",id:"auditlog.actionNames.eventColumn.workspace_domain_changed",values:{oldValue:$a(e),newValue:e.changes.name.newValue}});case"workspace_integration_restriction_changed":return function(e){const t=void 0,{oldValue:i,newValue:n}=e.changes.integration_restrictions;if(n===t)return a()(v.FormattedMessage,{defaultMessage:"Enabled members installing integrations",id:"auditlog.actionNames.eventColumn.workspace_integration_restriction_changed.no_restrictions"});if(i===t&&"approved_only"===n)return a()(v.FormattedMessage,{defaultMessage:"Disabled members installing integrations",id:"auditlog.actionNames.eventColumn.workspace_integration_restriction_changed.approved_only"});if("approved_or_built_by_notion"===i&&"approved_only"===n)return a()(v.FormattedMessage,{defaultMessage:"Disabled auto approval for built-by-Notion integrations",id:"auditlog.actionNames.eventColumn.workspace_integration_restriction_changed.disabled_built_by_notion.from_approved_or_built_by_notion"});if("approved_only"===i&&"approved_or_built_by_notion"===n)return a()(v.FormattedMessage,{defaultMessage:"Enabled auto approval for built-by-Notion integrations",id:"auditlog.actionNames.eventColumn.workspace_integration_restriction_changed.enabled_built_by_notion"});return a()(v.FormattedMessage,{defaultMessage:"Changed workspace integration restriction",id:"auditlog.actionNames.eventColumn.workspace_integration_restriction_changed.fallback_message"})}(e);case"allowed_email_domain_added":return a()(v.FormattedMessage,{defaultMessage:"Added “{addedValue}“ into allowable email domains",id:"auditlog.actionNames.eventColumn.allowed_email_domain_added",values:{addedValue:e.changes.domain}});case"allowed_email_domain_removed":return a()(v.FormattedMessage,{defaultMessage:"Removed “{removedValue}“ from allowable email domains",id:"auditlog.actionNames.eventColumn.allowed_email_domain_removed",values:{removedValue:e.changes.domain}});case"public_page_set":return e.changes.name.oldValue?a()(v.FormattedMessage,{defaultMessage:"Changed public home page from “{oldPage}“ to “{newPage}“",id:"auditlog.actionNames.eventColumn.public_page_changed",values:{oldPage:e.changes.name.oldValue,newPage:e.changes.name.newValue}}):a()(v.FormattedMessage,{defaultMessage:"Set “{newPage}“ as public home page",id:"auditlog.actionNames.eventColumn.public_page_set",values:{newPage:e.changes.name.newValue}});case"idp_metadata_url_updated":return e.changes.url.oldValue?a()(v.FormattedMessage,{defaultMessage:'Changed IDP metadata URL from "{oldValue}" to "{newValue}"',id:"auditlog.actionNames.eventColumn.idp_metadata_url_updated",values:{oldValue:e.changes.url.oldValue,newValue:e.changes.url.newValue}}):a()(v.FormattedMessage,{defaultMessage:'Set IDP metadata URL to "{newValue}"',id:"auditlog.actionNames.eventColumn.idp_metadata_url_set",values:{newValue:e.changes.url.newValue}});case"saml_toggled":return e.changes.enabled.newValue?d.createElement(v.FormattedMessage,Ea.saml_enabled):d.createElement(v.FormattedMessage,Ea.saml_disabled);case"saml_enforce_toggled":return e.changes.enabled.newValue?d.createElement(v.FormattedMessage,Ea.saml_enforced):d.createElement(v.FormattedMessage,Ea.saml_unenforced);case"automatic_account_creation_toggled":return e.changes.enabled.newValue?d.createElement(v.FormattedMessage,Ea.automatic_account_creation_enabled):d.createElement(v.FormattedMessage,Ea.automatic_account_creation_disabled);case"workspace_analytics_toggled":return e.changes.enabled.newValue?d.createElement(v.FormattedMessage,Ea.workspace_analytics_enabled):d.createElement(v.FormattedMessage,Ea.workspace_analytics_disabled);case"workspace_creation_set_for_email_domain":return function(e,t){const{oldValue:i,newValue:n}=e.changes.workspace_creation;if(!i&&!n)return a()(v.FormattedMessage,{defaultMessage:"Changed workspace creation setting",id:"auditlog.actionNames.eventColumn.workspace_creation_set_for_email_domain.fallback_message"});const o=e.changes.workspace_creation.oldValue?t.formatMessage({id:"auditLogEntry.changes.workspaceCreation.beforeSetting",defaultMessage:" from {prevWorkspaceCreationSetting}"},{prevWorkspaceCreationSetting:(0,Za.nJ)(e.changes.workspace_creation.oldValue,t)}):"",s=e.changes.workspace_creation.newValue?t.formatMessage({id:"auditLogEntry.changes.workspaceCreation.afterSetting",defaultMessage:" to {afterWorkspaceCreationSetting}"},{afterWorkspaceCreationSetting:(0,Za.nJ)(e.changes.workspace_creation.newValue,t)}):"";return a()(v.FormattedMessage,{defaultMessage:"Changed workspace creation setting{before}{after}.",id:"auditlog.actionNames.eventColumn.workspace_creation_set_for_email_domain",values:{before:o,after:s}})}(e,i);case"member_added_to_group":return a()(v.FormattedMessage,{defaultMessage:"Added {memberNameAndEmail} to {groupName}",id:"auditlog.actionNames.eventColumn.member_added_to_group",values:{memberNameAndEmail:Ba(i,e),groupName:Oa(e.target.group)}});case"member_removed_from_group":return a()(v.FormattedMessage,{defaultMessage:"Removed {memberNameAndEmail} from {groupName}",id:"auditlog.actionNames.eventColumn.member_removed_from_group",values:{memberNameAndEmail:Ba(i,e),groupName:Oa(e.target.group)}});case"space_transfer_status_changed":return function(e,t){const{oldValue:i,newValue:n}=e.changes.spaceTransferStatus,o=e.target.space.name?t.formatMessage({id:"auditLogEntry.changes.space_transfer_status_changed.space_name",defaultMessage:" for {spaceName}"},{spaceName:e.target.space.name}):"";if(!i&&!n)return a()(v.FormattedMessage,{defaultMessage:"Workspace transfer status changed{spaceNameMessage}",id:"auditlog.actionNames.eventColumn.space_transfer_status_changed.fallback_message",values:{spaceNameMessage:o}});if(!n)return a()(v.FormattedMessage,{defaultMessage:"Workspace transfer request cleared{spaceNameMessage} from prior status of {oldStatus}",id:"auditlog.actionNames.eventColumn.space_transfer_status_cleared",values:{spaceNameMessage:o,oldStatus:i}});return a()(v.FormattedMessage,{defaultMessage:"{newStatus, select, requested {Workspace transfer request initiated{spaceNameMessage}.} started {Workspace transfer started{spaceNameMessage}} completed {Workspace transfer completed{spaceNameMessage}} other {Workspace transfer status change to {newStatus}{spaceNameMessage}}}",id:"auditlog.actionNames.eventColumn.space_transfer_status_changed.newStatus",values:{spaceNameMessage:o,newStatus:n}})}(e,i);case"space_claim_and_upgrade_status_changed":return function(e){const{oldValue:t,newValue:i}=e.changes.claimAndUpgradeStatus,n=a()(v.FormattedMessage,{defaultMessage:"Status changed for workspace claim of {workspaceName}",id:"auditlog.actionNames.eventColumn.space_claim_upgrade_status_changed.fallback_message",values:{workspaceName:e.target.space.name}});if(!t&&!i)return n;if(!i&&"completed"!==t)return a()(v.FormattedMessage,{defaultMessage:"Pending workspace claim for {workspaceName} has been cleared from {oldStatus}",id:"auditlog.actionNames.eventColumn.space_claim_upgrade_status_cleared",values:{workspaceName:e.target.space.name,oldStatus:t}});if("completed"===i)return a()(v.FormattedMessage,{defaultMessage:"{workspaceName} has been claimed and upgraded to the Enterprise plan",id:"auditlog.actionNames.eventColumn.space_claim_upgrade_status_completed",values:{workspaceName:e.target.space.name}});if("requested"===i)return a()(v.FormattedMessage,{defaultMessage:"Request to claim and upgrade {workspaceName} has been sent.",id:"auditlog.actionNames.eventColumn.space_claim_upgrade_requested",values:{workspaceName:e.target.space.name}});return n}(e);case"space_claim_deletion_status_changed":return function(e){const{oldValue:t,newValue:i}=e.changes.claimDeletionStatus,n=a()(v.FormattedMessage,{defaultMessage:"Claimable workspace deletion status change for {spaceName}",id:"auditlog.actionNames.eventColumn.space_claim_deletion_status_changed.fallback_message",values:{spaceName:e.target.space.name}});if(!t&&!i)return n;if(!i||"canceled"===i)return a()(v.FormattedMessage,{defaultMessage:"Recovered workspace {spaceName} using Domain Management",id:"auditlog.actionNames.eventColumn.space_claim_deletion.status_cleared",values:{spaceName:e.target.space.name}});return a()(v.FormattedMessage,{defaultMessage:"Deleted workspace {spaceName} using Domain Management",id:"auditlog.actionNames.eventColumn.space_claim_deletion.deleted",values:{spaceName:e.target.space.name}})}(e);case"membership_requests_toggled":return a()(v.FormattedMessage,{defaultMessage:"{enabled} allowing members to request adding new members",id:"auditlog.actionNames.eventColumn.membership_requests_toggled",values:{enabled:no(e)}});case"membership_request_resolved":return a()(v.FormattedMessage,{defaultMessage:"{status} request to add {email} to the workspace as a member",id:"auditlog.actionNames.eventColumn.membership_request_resolved",values:{status:ao(e),email:Ba(i,e)}});case"guest_membership_requests_toggled":return a()(v.FormattedMessage,{defaultMessage:"{enabled} allowing page guests to request to be added to the workspace as members",id:"auditlog.actionNames.eventColumn.guest_membership_requests_toggled",values:{enabled:oo(e)}});case"team_created":return a()(v.FormattedMessage,{defaultMessage:"Created {teamName}",id:"auditlog.actionNames.eventColumn.team_created",values:{teamName:Ua(e)}});case"team_archived":return a()(v.FormattedMessage,{defaultMessage:"Archived {teamName}",id:"auditlog.actionNames.eventColumn.team_archived",values:{teamName:Ua(e)}});case"team_restored":return a()(v.FormattedMessage,{defaultMessage:"Restored {teamName}",id:"auditlog.actionNames.eventColumn.team_restored",values:{teamName:Ua(e)}});case"team_default_toggled":return e.changes.enabled.newValue?a()(v.FormattedMessage,{defaultMessage:"Added {teamName} to the default teamspace list. Workspace members will automatically be added to the teamspace",id:"auditlog.actionNames.eventColumn.team_default_enabled",values:{teamName:Ua(e)}}):a()(v.FormattedMessage,{defaultMessage:"Removed {teamName} from the default teamspace list. Workspace members will no longer be automatically added to the teamspace",id:"auditlog.actionNames.eventColumn.team_default_disabled",values:{teamName:Ua(e)}});case"team_public_page_sharing_toggled":return e.changes.enabled.newValue?d.createElement(d.Fragment,null,a()(v.FormattedMessage,{defaultMessage:"Disabled members sharing pages under {teamName} publicly",id:"auditlog.actionNames.eventColumn.team_public_page_sharing_disabled",values:{teamName:Ua(e)}}),Na((null===(o=e.meta)||void 0===o?void 0:o.spacePublicPageSharingDisabled)??(null==e?void 0:e.spacePublicPageSharingDisabled),e.changes.enabled.newValue)):d.createElement(d.Fragment,null,a()(v.FormattedMessage,{defaultMessage:"Enabled members sharing pages under {teamName} publicly",id:"auditlog.actionNames.eventColumn.team_public_page_sharing_enabled",values:{teamName:Ua(e)}}),Na((null===(s=e.meta)||void 0===s?void 0:s.spacePublicPageSharingDisabled)??(null==e?void 0:e.spacePublicPageSharingDisabled),e.changes.enabled.newValue));case"team_export_toggled":return e.changes.enabled.newValue?d.createElement(d.Fragment,null,a()(v.FormattedMessage,{defaultMessage:"Disabled export for {teamName}",id:"auditlog.actionNames.eventColumn.team_export_disabled",values:{teamName:Ua(e)}}),Na((null===(r=e.meta)||void 0===r?void 0:r.spaceExportDisabled)??(null==e?void 0:e.spaceExportDisabled),e.changes.enabled.newValue)):d.createElement(d.Fragment,null,a()(v.FormattedMessage,{defaultMessage:"Enabled export for {teamName}",id:"auditlog.actionNames.eventColumn.team_export_enabled",values:{teamName:Ua(e)}}),Na((null===(c=e.meta)||void 0===c?void 0:c.spaceExportDisabled)??(null==e?void 0:e.spaceExportDisabled),e.changes.enabled.newValue));case"team_sidebar_editing_toggled":return e.changes.enabled.newValue?a()(v.FormattedMessage,{defaultMessage:"Disabled members changing the sidebar section for {teamName}",id:"auditlog.actionNames.eventColumn.team_sidebar_editing_disabled",values:{teamName:Ua(e)}}):a()(v.FormattedMessage,{defaultMessage:"Enabled members changing the sidebar section for {teamName}",id:"auditlog.actionNames.eventColumn.team_sidebar_editing_enabled",values:{teamName:Ua(e)}});case"team_creation_admins_setting_toggled":return e.changes.enabled.newValue?a()(v.FormattedMessage,{defaultMessage:"Disabled members creating teamspaces",id:"auditlog.actionNames.eventColumn.team_creation_admins_setting_disabled",values:{teamName:Ua(e)}}):a()(v.FormattedMessage,{defaultMessage:"Enabled members creating teamspaces",id:"auditlog.actionNames.eventColumn.team_creation_admins_setting_enabled",values:{teamName:Ua(e)}});case"team_guests_toggled":return e.changes.enabled.newValue?d.createElement(d.Fragment,null,a()(v.FormattedMessage,{defaultMessage:"Disabled guests for {teamName}",id:"auditlog.actionNames.eventColumn.team_guests_toggled_disabled",values:{teamName:Ua(e)}}),Na((null===(u=e.meta)||void 0===u?void 0:u.spaceDisableGuests)??e.spaceDisableGuests,e.changes.enabled.newValue)):d.createElement(d.Fragment,null,a()(v.FormattedMessage,{defaultMessage:"Enabled guests for {teamName}",id:"auditlog.actionNames.eventColumn.team_guests_toggled_enabled",values:{teamName:Ua(e)}}),Na((null===(m=e.meta)||void 0===m?void 0:m.spaceDisableGuests)??e.spaceDisableGuests,e.changes.enabled.newValue));case"team_name_changed":return a()(v.FormattedMessage,{defaultMessage:"Changed teamspace name {oldTeamNameToNewTeamName}",id:"auditlog.actionNames.eventColumn.team_name_changed",values:{oldTeamNameToNewTeamName:Va(e)}});case"team_description_changed":return a()(v.FormattedMessage,{defaultMessage:"Changed description of {teamName}",id:"auditlog.actionNames.eventColumn.team_description_changed",values:{teamName:Ua(e)}});case"team_icon_changed":return a()(v.FormattedMessage,{defaultMessage:"Changed icon of {teamName}",id:"auditlog.actionNames.eventColumn.team_icon_changed",values:{teamName:Ua(e)}});case"member_added_to_team":return a()(v.FormattedMessage,{defaultMessage:"Invited {memberNameAndEmail} to {teamName} as {teamRole}",id:"auditlog.actionNames.eventColumn.member_added_to_team",values:{memberNameAndEmail:Ba(i,e),teamName:Ua(e),teamRole:Ka(e.changes.teamRole.newValue)}});case"group_added_to_team":return a()(v.FormattedMessage,{defaultMessage:"Invited {groupName} to {teamName} as teamspace member",id:"auditlog.actionNames.eventColumn.group_added_to_team",values:{groupName:Oa(e.target.group),teamName:Ua(e)}});case"member_removed_from_team":return a()(v.FormattedMessage,{defaultMessage:"Removed {memberNameAndEmail} from {teamName}",id:"auditlog.actionNames.eventColumn.member_removed_from_team",values:{memberNameAndEmail:Ba(i,e),teamName:Ua(e)}});case"group_removed_from_team":return a()(v.FormattedMessage,{defaultMessage:"Removed {groupName} from {teamName}",id:"auditlog.actionNames.eventColumn.group_removed_from_team",values:{groupName:Oa(e.target.group),teamName:Ua(e)}});case"member_joined_team":const U=Ua(e),W=Ka(e.changes.teamRole.newValue);return co(e)?a()(v.FormattedMessage,{defaultMessage:"Joined {teamName} as {teamRole} using administrator privileges",id:"auditlog.actionNames.eventColumn.member_joined_team_privileged",values:{teamName:U,teamRole:W}}):a()(v.FormattedMessage,{defaultMessage:"Joined {teamName} as {teamRole}",id:"auditlog.actionNames.eventColumn.member_joined_team",values:{teamName:U,teamRole:W}});case"member_left_team":return a()(v.FormattedMessage,{defaultMessage:"Left {teamName}",id:"auditlog.actionNames.eventColumn.member_left_team",values:{teamName:Ua(e)}});case"member_team_role_updated":const K=Ba(i,e),z=Ka(e.changes.teamRole.oldValue),G=Ka(e.changes.teamRole.newValue),q=Ua(e);return co(e)?a()(v.FormattedMessage,{defaultMessage:"Updated {memberNameAndEmail} from {oldTeamRole} to {newTeamRole} in {teamName} using administrator privileges",id:"auditlog.actionNames.eventColumn.member_team_role_updated_privileged",values:{memberNameAndEmail:K,oldTeamRole:z,newTeamRole:G,teamName:q}}):a()(v.FormattedMessage,{defaultMessage:"Updated {memberNameAndEmail} from {oldTeamRole} to {newTeamRole} in {teamName}",id:"auditlog.actionNames.eventColumn.member_team_role_updated",values:{memberNameAndEmail:K,oldTeamRole:z,newTeamRole:G,teamName:q}});case"team_user_permission_updated":return a()(v.FormattedMessage,{defaultMessage:"Updated {userNameOrEmail}’s custom permissions in {teamName} from {oldPermission} to {newPermission}.",id:"auditlog.actionNames.eventColumn.team_user_permission_updated",values:{userNameOrEmail:Ba(i,e),oldPermission:za(e.changes.permission.oldValue),newPermission:za(e.changes.permission.newValue),teamName:Ua(e)}});case"team_group_permission_updated":return a()(v.FormattedMessage,{defaultMessage:"Updated {groupName}’s custom permissions in {teamName} from {oldPermission} to {newPermission}.",id:"auditlog.actionNames.eventColumn.team_group_permission_updated",values:{groupName:Oa(e.target.group),oldPermission:za(e.changes.permission.oldValue),newPermission:za(e.changes.permission.newValue),teamName:Ua(e)}});case"team_member_default_permission_updated":return a()(v.FormattedMessage,{defaultMessage:"Updated default page permissions for teamspace members in {teamName} from {oldRole} to {newRole}",id:"auditlog.actionNames.eventColumn.team_member_default_permission_updated",values:{teamName:Ua(e),oldRole:za(null===(p=e.changes)||void 0===p||null===(p=p.permission)||void 0===p?void 0:p.oldValue),newRole:za(null===(g=e.changes)||void 0===g||null===(g=g.permission)||void 0===g?void 0:g.newValue)}});case"team_guest_default_permission_updated":return a()(v.FormattedMessage,{defaultMessage:"Updated default page permissions for teamspace guests in {teamName} from {oldRole} to {newRole}",id:"auditlog.actionNames.eventColumn.team_guest_default_permission_updated",values:{teamName:Ua(e),oldRole:za(null===(h=e.changes)||void 0===h||null===(h=h.permission)||void 0===h?void 0:h.oldValue),newRole:za(null===(f=e.changes)||void 0===f||null===(f=f.permission)||void 0===f?void 0:f.newValue)}});case"team_workspace_default_permission_updated":return a()(v.FormattedMessage,{defaultMessage:"Updated default page permissions for everyone else in the workspace for {teamName} from {oldRole} to {newRole}",id:"auditlog.actionNames.eventColumn.team_workspace_default_permission_updated",values:{teamName:Ua(e),oldRole:za(null===(y=e.changes)||void 0===y||null===(y=y.permission)||void 0===y?void 0:y.oldValue),newRole:za(null===(S=e.changes)||void 0===S||null===(S=S.permission)||void 0===S?void 0:S.newValue)}});case"team_privacy_type_changed":return a()(v.FormattedMessage,{defaultMessage:"Changed the teamspace privacy type for {teamName} from {oldType} to {newType}",id:"auditlog.actionNames.eventColumn.team_privacy_type_changed",values:{teamName:Ua(e),oldType:io(null===(b=e.changes)||void 0===b?void 0:b.teamAccessLevel.oldValue),newType:io(null===(M=e.changes)||void 0===M?void 0:M.teamAccessLevel.newValue)}});case"team_invite_access_changed":return a()(v.FormattedMessage,{defaultMessage:"Changed who can invite teamspace members to {newType} for {teamName}",id:"auditlog.actionNames.eventColumn.team_invite_access_changed",values:{teamName:Ua(e),newType:(A=null===(w=e.changes)||void 0===w||null===(w=w.teamInviteAccess)||void 0===w?void 0:w.newValue,A?d.createElement(v.FormattedMessage,ro[A]):d.createElement(v.FormattedMessage,ro.unknown))}});case"teams_enabled_for_space":return a()(v.FormattedMessage,{defaultMessage:"Enabled teamspaces for {workspaceName}",id:"auditlog.actionNames.eventColumn.teams_enabled_for_space",values:{workspaceName:e.target.space.name}});case"private_content_transferred":return a()(v.FormattedMessage,{defaultMessage:"Transferred private content from {fromUserName} to {toUserName}",id:"auditLog.actionNames.eventColumn.private_content_transferred",values:{fromUserName:Da(i,e.changes.userPermission.oldValue),toUserName:Da(i,e.changes.userPermission.newValue)}});case"audit_log_exported":return a()(v.FormattedMessage,{id:"auditlogEventFilter.eventColumn.audit_log_exported",defaultMessage:"Exported audit log for last {duration} days",values:{duration:e.meta.duration}});case"user_analytics_exported":return a()(v.FormattedMessage,{id:"auditlogEventFilter.eventColumn.user_analytics_exported",defaultMessage:"Exported user analytics for {daysFilterString}",values:{daysFilterString:i.formatMessage(Fa.Rh[(null===(C=e.meta)||void 0===C?void 0:C.daysFilter)||"last_90_days"]).toLowerCase()}});case"content_analytics_exported":return a()(v.FormattedMessage,{id:"auditlogEventFilter.eventColumn.content_analytics_exported",defaultMessage:"Exported content analytics for {daysFilterString}",values:{daysFilterString:i.formatMessage(Fa.Rh[(null===(_=e.meta)||void 0===_?void 0:_.daysFilter)||"last_90_days"]).toLowerCase()}});case"admin_content_search_queried":case"admin_content_search_exported":function H(e){return e.join(i.formatMessage(Ea.adminContentSearchPredicateSplit))}function j(e){return"starting"in e&&"ending"in e?`${e.starting} - ${e.ending}`:"starting"in e?`${e.starting} - `:"ending"in e?` - ${e.ending}`:void 0}const Q=e.searchParameters.query&&i.formatMessage(Ea.adminContentSearchQuery,{query:e.searchParameters.query}),Y=e.searchParameters.teamspaces&&e.searchParameters.teamspaces.length>0&&i.formatMessage(Ea.adminContentSearchTeamspaces,{teamspaceCount:e.searchParameters.teamspaces.length,teamspaces:H(e.searchParameters.teamspaces)}),$=e.searchParameters.createdBy&&e.searchParameters.createdBy.length>0&&i.formatMessage(Ea.adminContentSearchCreatedBy,{createdBy:H(e.searchParameters.createdBy)}),X=e.searchParameters.sharedWith&&e.searchParameters.sharedWith.length>0&&i.formatMessage(Ea.adminContentSearchSharedWith,{sharedWith:H(e.searchParameters.sharedWith)}),J=e.searchParameters.audience&&e.searchParameters.audience.length>0&&i.formatMessage(Ea.adminContentSearchAudience,{audience:H(e.searchParameters.audience)}),ee=e.searchParameters.createdTime&&i.formatMessage(Ea.adminContentSearchCreatedTime,{createdTime:j(e.searchParameters.createdTime)}),ie=e.searchParameters.lastEditedTime&&i.formatMessage(Ea.adminContentSearchLastEditedTime,{lastEditedTime:j(e.searchParameters.lastEditedTime)}),ne=l().compact([Q,Y,$,X,J,ee,ie]);if("admin_content_search_queried"===e.actionName){if(0===ne.length)return a()(v.FormattedMessage,{id:"auditlogEventFilter.eventColumn.admin_content_search_queried.no_filters",defaultMessage:"Ran a content search with no filters"});{const e=H(ne);return a()(v.FormattedMessage,{id:"auditlogEventFilter.eventColumn.admin_content_search_queried",defaultMessage:"Ran a content search with the following criteria: {searchCriteria}",values:{searchCriteria:e}})}}if(0===ne.length)return a()(v.FormattedMessage,{id:"auditlogEventFilter.eventColumn.admin_content_search_exported.no_filters",defaultMessage:"Exported a content search result with no filters"});{const e=H(ne);return a()(v.FormattedMessage,{id:"auditlogEventFilter.eventColumn.admin_content_search_exported",defaultMessage:"Exported a content search result with the following criteria: {searchCriteria}",values:{searchCriteria:e}})}case"admin_managed_users_log_out_all":{const t=i.formatList(e.meta.emailDomains,{type:"conjunction"});return a()(v.FormattedMessage,{id:"auditlogEventFilter.eventColumn.admin_managed_users_log_out_all",defaultMessage:"Logged out all managed users with the email domains {emailDomains}",values:{emailDomains:t}})}case"admin_managed_users_log_out_one":return a()(v.FormattedMessage,{defaultMessage:"Logged out {guestNameAndEmail} from all of their active sessions",id:"auditlog.actionNames.eventColumn.admin_managed_users_log_out_one",values:{guestNameAndEmail:Ba(i,e)}});case"admin_managed_users_password_cleared_one":return a()(v.FormattedMessage,{defaultMessage:"Reset the password and MFA settings for {guestNameAndEmail} and logged them out of their active sessions",id:"auditlog.actionNames.eventColumn.admin_managed_users_password_cleared_one",values:{guestNameAndEmail:Ba(i,e)}});case"admin_managed_users_password_cleared":{const t=i.formatList(e.meta.emailDomains,{type:"conjunction"});return a()(v.FormattedMessage,{id:"auditlogEventFilter.eventColumn.admin_managed_users_password_cleared",defaultMessage:"Cleared passwords for all users with the email domains {emailDomains}",values:{emailDomains:t}})}case"automation_created":return a()(v.FormattedMessage,{id:"auditlog.actionNames.eventColumn.automation_created",defaultMessage:"Created {automationType} on {pageTitle}",values:{automationType:lo(e.meta.automationType),pageTitle:Ha(e)}});case"automation_edited":return a()(v.FormattedMessage,{id:"auditlog.actionNames.eventColumn.automation_edited",defaultMessage:"Edited {automationType} on {pageTitle}",values:{automationType:lo(e.meta.automationType),pageTitle:Ha(e)}});case"ai_admin_legal_acceptance_toggled":return a()(v.FormattedMessage,{defaultMessage:"{enabled} Notion AI for the workspace.",id:"auditlog.actionNames.eventColumn.ai_admin_legal_acceptance_toggled",values:{enabled:so(e)}});case"space_consolidation_started":case"space_consolidation_completed":case"space_consolidation_failed":const ae=e.spaceId===e.meta.spaceConsolidationMetadata.source_space_id,oe=e.meta.spaceConsolidationMetadata.source_space_name??e.meta.spaceConsolidationMetadata.source_space_id,se=e.meta.spaceConsolidationMetadata.target_space_name??e.meta.spaceConsolidationMetadata.target_space_id,re=e.changes.spaceContentDuplicationStatus.newValue;return a()(v.FormattedMessage,{defaultMessage:"{status} workspace consolidation {direction} {spaceName}.",id:"auditlog.actionNames.eventColumn.space_consolidation_status_changed",values:{status:re?d.createElement(v.FormattedMessage,Ra[re]):"",spaceName:ae?se:oe,direction:d.createElement(v.FormattedMessage,ae?Ea.into:Ea.from)}});case"mfa_sms_toggled":return a()(v.FormattedMessage,{defaultMessage:'{enabled} SMS MFA on "{value}"',id:"auditlog.actionNames.eventColumn.mfa_sms_toggled",values:{value:null!==(k=e.changes)&&void 0!==k&&k.maskedPhoneNumber.oldValue?null===(T=e.changes)||void 0===T?void 0:T.maskedPhoneNumber.oldValue:null===(I=e.changes)||void 0===I?void 0:I.maskedPhoneNumber.newValue,enabled:null!==(P=e.changes)&&void 0!==P&&P.enabled.newValue?"Enabled":"Disabled"}});case"mfa_totp_toggled":return a()(v.FormattedMessage,{defaultMessage:"{enabled} TOTP MFA",id:"auditlog.actionNames.eventColumn.mfa_totp_toggled",values:{enabled:null!==(Z=e.changes)&&void 0!==Z&&Z.enabled.newValue?"Enabled":"Disabled"}});case"mfa_backup_code_toggled":return a()(v.FormattedMessage,{defaultMessage:"{enabled} backup codes for MFA",id:"auditlog.actionNames.eventColumn.mfa_backup_code_toggled",values:{enabled:null!==(F=e.changes)&&void 0!==F&&F.enabled.newValue?"Enabled":"Disabled"}});case"user_suspended":return a()(v.FormattedMessage,{defaultMessage:"Suspended {userNameAndEmail}",id:"auditLogEntry.user_suspended",values:{userNameAndEmail:Ba(i,e)}});case"user_unsuspended":return a()(v.FormattedMessage,{defaultMessage:"Reactivated {userNameAndEmail}",id:"auditLogEntry.user_unsuspended",values:{userNameAndEmail:Ba(i,e)}});case"user_deleted":return e.target?a()(v.FormattedMessage,{defaultMessage:"Deleted {userNameAndEmail}",id:"auditLogEntry.user_deleted",values:{userNameAndEmail:Da(i,e.target.user)}}):d.createElement(v.FormattedMessage,Ea.user_deleted);case"workspace.settings.prevent_granting_support_access_updated":return e.changes.enabled.newValue?a()(v.FormattedMessage,{defaultMessage:"Disabled managed user members' ability to grant support access for their account.",id:"auditLogEntry.workspace_domain_settings_prevent_granting_support_access_updated.enabled"}):a()(v.FormattedMessage,{defaultMessage:"Enabled managed user members' ability to grant support access for their account.",id:"auditLogEntry.workspace_domain_settings_prevent_granting_support_access_updated.disabled"});case"workspace.settings.prevent_profile_edits_updated":return e.changes.enabled.newValue?a()(v.FormattedMessage,{defaultMessage:"Disabled managed user members' ability to edit their profile information.",id:"auditLogEntry.workspace_domain_settings_prevent_profile_edits_updated.enabled"}):a()(v.FormattedMessage,{defaultMessage:"Enabled managed user members' ability to edit their profile information.",id:"auditLogEntry.workspace_domain_settings_prevent_profile_edits_updated.disabled"});case"workspace.settings.external_workspace_access_updated":return e.changes.enabled.newValue?a()(v.FormattedMessage,{defaultMessage:"Disabled managed user members' ability to join external workspaces.",id:"auditLogEntry.workspace_domain_settings_external_workspace_access_updated.enabled"}):a()(v.FormattedMessage,{defaultMessage:"Enabled managed user members' ability to join external workspaces.",id:"auditLogEntry.workspace_domain_settings_external_workspace_access_updated.disabled"});case"workspace.settings.custom_session_duration_updated":return void 0!==e.changes.valueMs.oldValue&&void 0!==e.changes.valueMs.newValue?a()(v.FormattedMessage,{defaultMessage:"Changed the session duration for all managed users from {oldDuration} to {newDuration}.",id:"auditLogEntry.workspace_domain_settings_session_duration_updated",values:{oldDuration:(0,Ia.Ct)(e.changes.valueMs.oldValue,i),newDuration:(0,Ia.Ct)(e.changes.valueMs.newValue,i)}}):a()(v.FormattedMessage,{defaultMessage:"Changed the session duration for all managed users.",id:"auditLogEntry.workspace_domain_settings_session_duration_updated.disabled"});case"workspace_exported":case"workspace_icon_changed":case"public_page_cleared":case"logout":case"password_changed":case"password_cleared":case"password_set":case"revoked_support_access":case"user_suspended":case"user_unsuspended":case"member_joined":case"invite_link_toggled":case"scim_token_generated":case"scim_token_revoked":case"invite_link_reset":case"idp_metadata_xml_removed":case"idp_metadata_xml_updated":return d.createElement(v.FormattedMessage,Ea[e.actionName]);default:if("local"!==t)return Pa.log({level:"error",from:"auditLogEvent",type:"AuditLogEvent",data:{miscDataToConvertToString:{data:e}}}),d.createElement(d.Fragment,null);(0,x.t1)(e)}}function mo(e){const{name:t,extension:i}=e.target.file;return t?`“${t}“`:i?d.createElement(v.FormattedMessage,s()({},Ea.a_file_with_extension,{values:{extension:i}})):d.createElement(v.FormattedMessage,Ea.a_file)}function po(e){window.__c={n:"AuditLogColumnEvent"};const{auditLogEntry:t,id:i}=e,[n,o]=(0,d.useState)(""),r=(0,v.useIntl)();return(0,d.useEffect)((()=>{const e=document.getElementById(i);o((null==e?void 0:e.textContent)||"")}),[i]),a()(We.Z,{style:{whiteSpace:"normal"},delayThreshold:80,renderTooltip:()=>a()(ho,{text:n,auditLogEntry:t}),placement:We.Z.Placement.Bottom,render:e=>d.createElement("div",s()({},e,{style:{fontSize:14,...f.Z.textOverflowStyle},id:i}),a()(go,{auditLogEntry:t,env:"production",intl:r}))})}function go(e){const{auditLogEntry:t,env:i,intl:n}=e;return uo(t,i,n)}function ho(e){var t,i;window.__c={n:"AuditLogEventTooltip"};const{auditLogEntry:n,text:o}=e,s=(0,v.useIntl)(),r=oa({auditLogEntry:n,intl:s});return a()("div",{},void 0,o,(null===(t=n.actor.meta)||void 0===t?void 0:t.ipAddress)&&a()("div",{},void 0,a()(v.FormattedMessage,{defaultMessage:"IP address: {ip}",values:{ip:null===(i=n.actor.meta)||void 0===i?void 0:i.ipAddress},id:"auditLogSettings.metadata.ipAddress"})),a()("div",{},void 0,na(n,s)),r&&a()(v.FormattedMessage,{id:"auditLogColumnEvent.tooltip.audienceMessage",defaultMessage:"Page audience: {audience}",values:{audience:r}}))}function fo(e){const{children:t,disabled:i,onClick:n}=e;return a()(Xe.Z,{onClick:n,disabled:i,style:{justifyContent:"center",marginLeft:6},isBlue:!i,isLightGray:i},void 0,t)}const vo={id:"actor",headerTitle:a()(v.FormattedMessage,{id:"auditlog.logTable.userColumn.header",defaultMessage:"User"}),renderCell:e=>{const t=`actor-${e.auditLogEntry.actionName}-${e.id}`;return a()(wa,{spaceStore:e.spaceStore,auditLogEntry:e.auditLogEntry,id:t})},widthData:{width:30},sortable:!1},yo={id:"event",headerTitle:a()(v.FormattedMessage,{id:"auditlog.logTable.eventColumn.header",defaultMessage:"Event"}),renderCell:e=>{const t=`event-${e.auditLogEntry.actionName}-${e.id}`;return a()(po,{auditLogEntry:e.auditLogEntry,id:t})},widthData:{width:40},sortable:!1},So={id:"dateTimeAndMenu",headerTitle:a()(v.FormattedMessage,{id:"auditlog.logTable.dateColumn.header",defaultMessage:"Date"}),renderCell:e=>{const t=`actor-${e.auditLogEntry.actionName}-${e.id}`,i=`event-${e.auditLogEntry.actionName}-${e.id}`,n=`datetime-${e.auditLogEntry.actionName}-${e.id}`;return d.createElement(d.Fragment,null,a()(Ta,{auditLogEntry:e.auditLogEntry,id:n}),a()(wo,{auditLogEntry:e.auditLogEntry,ids:{actorColumnId:t,eventColumnId:i,dateTimeColumnId:n}}))},widthData:{width:25},sortable:!0},bo=[vo,yo,So];function Mo(){return a()("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:"40vh",flexDirection:"column"}},void 0,a()("div",{},void 0,a()(Ae.Z,{isSecondaryColor:!0,style:{fontWeight:500}},void 0,a()(v.FormattedMessage,{id:"auditlog.logTable.noResults",defaultMessage:"No results"}))),a()(Ae.Z,{isSecondaryColor:!0},void 0,a()(v.FormattedMessage,{id:"auditlog.logTable.noResultsHelpText",defaultMessage:"Try different filters. Logs may take some time to show up."})))}function wo(e){window.__c={n:"AuditLogColumnMenu"};const{auditLogEntry:t,ids:i}=e,n=(0,Ze.VK)((()=>(0,K.F$)()),[]),o=(0,Ze.VK)((()=>k.default.checkGate("audit_log_event_name_column")?ta:ea),[]),r=(0,v.useIntl)(),l=(0,Pe.O7)(),c=(0,xe.Fg)(),u=(0,xe.yK)((e=>({container:{display:"flex",alignItems:"center",justifyContent:"flex-end",width:"100%"},button:{display:"flex",alignItems:"center",justifyContent:"center",width:32,height:28,borderRadius:3}})),[]);return a()(We.Z,{delayThreshold:80,placement:We.Z.Placement.Bottom,render:e=>d.createElement("div",s()({style:u.container},e),a()(Ii.Z,{style:u.button,onClick:()=>{var e;Tt.RD({environment:l,stringValue:aa({auditLogEntry:t,intl:r,getAuditLogEventText:(e=i.eventColumnId,t=>{var i;return null===(i=document.getElementById(e))||void 0===i?void 0:i.textContent}),isTeamGuestsEnabled:n,csvColumnNames:o}),copiedMessage:Tt.tq.copiedToClipboard})}},void 0,m.Z.copy({width:16,height:16,fill:c.mediumIconColor}))),renderTooltip:()=>a()(v.FormattedMessage,{id:"AuditLogSettings.copyAuditLogEvent",defaultMessage:"Copy row"})})}const Co=(0,v.injectIntl)((function(e){window.__c={n:"AuditLogPaginatedTable"};const{searchResponse:t,spaceStore:i}=e,[n,o]=(0,Ze.AF)(oe),s=t.results||[],r=t.hasMoreResults,l=Boolean(s.length),c=e=>{const t={...n,pageNum:e};o(t)},u=(0,xe.yK)((e=>(0,Oe.b)({columnRenderInfo:bo,theme:e,containerMarginTop:0})),[]),m=s.map(((e,t)=>({id:t.toString(),auditLogEntry:e,spaceStore:i,isClickable:!1}))),p=(0,d.useCallback)((()=>{const e=n.sortOrder===ie.CreatedOldest?ie.CreatedNewest:ie.CreatedOldest;o({...n,sortOrder:e,pageNum:1})}),[n,o]),g=(0,d.useMemo)((()=>({column:So,sortAscending:n.sortOrder===ie.CreatedOldest})),[n]);return d.createElement(d.Fragment,null,a()(Oe.D,{hideHeaderRowPadding:!0,showRowBorders:!0,columnRenderInfo:bo,rows:m,sortState:g,onSortStateChanged:p,renderNoRowsComponent:Mo,styles:u}),l?a()("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:10}},void 0,a()(fo,{onClick:()=>{c(n.pageNum-1)},disabled:1===n.pageNum},void 0,a()(v.FormattedMessage,{id:"auditlog.logTable.previousPage",defaultMessage:"Previous"})),a()(fo,{disabled:!r,onClick:()=>{c(n.pageNum+1)}},void 0,a()(v.FormattedMessage,{id:"auditlog.logTable.nextPage",defaultMessage:"Next"}))):null)}));const _o=(0,v.injectIntl)((function(e){window.__c={n:"AuditLogSettingsImpl"};const{spaceStore:t}=e,i=(0,Pe.O7)(),n=null==t?void 0:t.id,[o]=(0,Ze.AF)(le),[s]=(0,Ze.AF)(oe),r=se(s)!==o.filterStr?void 0:o.cachedResponses[s.pageNum];return(0,d.useEffect)((()=>{n&&(async e=>{var t,i;const{environment:n,spaceId:a}=e,o=oe.getState();le.startLoading(a,o);const{sortOrder:s,pageSize:r,pageNum:l}=o,d={spaceId:a,limit:r,cursor:le.getCursor(a,o,l),filters:{timeRange:{starting:o.timeRange.starting?Y.OQ.toUnixMs(o.timeRange.starting):void 0,ending:o.timeRange.ending?Y.OQ.toUnixMs(o.timeRange.ending):void 0},...(null===(t=o.actors)||void 0===t?void 0:t.length)>0?{actors:o.actors}:void 0,...(null===(i=o.actions)||void 0===i?void 0:i.length)>0?{actions:o.actions}:void 0},sort:s||ie.CreatedNewest},c=await T.searchAuditLog(n,d);if("success"!==c.type)if(le.updateError(a,o),(0,Cn.Jx)(c.body)){const e=(0,kn.wf)(z.default.getIntl(),c);M.showErrorMessage(e)}else M.showErrorMessage(z.default.formatMessage(Pn.loadCurrentAuditLogError));else le.updateLoadedResult(a,o,c.data)})({environment:i,spaceId:n})}),[i,n,s]),(0,d.useEffect)((()=>{xn({environment:i,spaceId:n})}),[i,n]),d.createElement(d.Fragment,null,a()(va,{}),a()("div",{style:{justifyContent:"space-between",display:"flex",paddingTop:12,paddingBottom:12}},void 0,a()(fa,{spaceStore:t}),a()(Rn,{})),"loading"===(null==r?void 0:r.status)&&a()(ba,{}),"success"===(null==r?void 0:r.status)&&a()(Co,{searchResponse:r,spaceStore:t}))}));var ko=i(98692),To=i(76463),Io=i(91376),Po=i(761),Zo=i(38755),xo=i(72087),Fo=i(74181),Ao=i(9038),Eo=i(9953),Bo=i(30874),Do=i(20454),Ro=i(9844),Lo=i(5500),No=i(74021),Oo=i(17549),Vo=i(77137),Uo=i(78948);function Wo(e){window.__c={n:"AdminIntegrationSettingsSearchResults"};const{query:t}=e,i=(0,Pe.O7)(),n=(0,Ze.VK)((()=>A.default.state.currentSpaceStore),[]),o=(0,Ze.VK)((()=>null==n?void 0:n.getBotSettingsStore().getValue()),[n]),r="approved_or_built_by_notion"===(null==o?void 0:o.integration_restrictions),l=(0,Ze.VK)((()=>null!=o&&o.integration_approval_statuses?Object.keys(o.integration_approval_statuses):[]),[o]),c=(0,Ze.VK)((()=>Object.values(Lo.iK).map((e=>{let{id:t}=e;const i=null==n?void 0:n.getRecordModel({id:t,table:Ro.K2});if("published"===(null==i?void 0:i.status))return t})).filter(x.$K)),[n]),u=(0,d.useMemo)((()=>c.some((e=>e===Lo.iK.google_drive.id))),[c]),m=(0,Ze.VK)((()=>c.filter((e=>!l.includes(e))).slice(0,5)),[l,c]);return a()(rt.Z,{menuType:it.og.Popup,width:255,header:Go(t,m,r)},void 0,a()(Vo.Z,{request:t,performRequest:e=>async function(e){const{query:t,integrationType:i,environment:n,spaceId:a,approvedIntegrationIds:o,popularIntegrationIds:s,autoApproveBuiltByNotion:r}=e;if(!Fe.Z.state.online||!a)return[];if((0,p.e)(t)||(0,p.qn)(t))return[t];if(""===t&&!r)return s;const l=await T.searchIntegrations(n,{query:t,type:i,spaceId:a});if("success"===l.type){const e=l.data.integrationIds.filter((e=>!o.includes(e))),t="production";if(!r){return e.sort(((e,i)=>(0,Lo.BP)({integrationId:e,env:t})===(0,Lo.BP)({integrationId:i,env:t})?0:(0,Lo.BP)({integrationId:e,env:t})?-1:1)).slice(0,5)}return e.filter((e=>!(0,Lo.BP)({integrationId:e,env:t}))).slice(0,5)}if("failed"===l.type)throw l.error;return(0,x.t1)(l)}({query:e,environment:i,spaceId:null==n?void 0:n.id,approvedIntegrationIds:l,popularIntegrationIds:m,autoApproveBuiltByNotion:r}),debounce:_n.vp,render:(r,c,m)=>{if(!c||!m)return a()(ct.Z,{},void 0,a()(Uo.Z,{}));const p=Fo.ns.filter((e=>t&&e.name.toLowerCase().includes(t.toLowerCase())&&!l.includes(e.id)&&(e.id!==Fo._o||!u))),g=[];if(0===c.length&&0===p.length)g.push({key:"no_results",render:()=>a()(Ae.Z,{isSmall:!0,style:{marginLeft:8}},void 0,a()(v.FormattedMessage,{id:"adminIntegrationSettings.search.label.noResults",defaultMessage:"No results"})),action:()=>{}});else{const t=c.map((t=>{var r;const l={table:Ro.K2,id:t};if(!n)return;const c=He.y2.createChildStore(n,l),u=null===(r=c.getInfo())||void 0===r?void 0:r.icon;return{key:`${t}`,render:e=>{var t;return d.createElement(ot.Z,s()({},e,{title:a()(Ae.Z,{style:{fontWeight:f.Z.fontWeight.semibold}},void 0,c.getName()),icon:u&&a()(je.Z,{disabled:!0,icon:{pointer:l,icon:u},isEmptyPage:!1,size:20}),style:u?{paddingBottom:12}:{paddingLeft:30,paddingBottom:12},shouldWrapCaption:!0,caption:a()(qo,{tagline:null===(t=c.getInfo())||void 0===t?void 0:t.tagline,isNotionIntegration:(0,Lo.BP)({integrationId:c.id,env:"production"})}),className:"notranslate"}))},action:()=>{e.closeDropdown(),zo({environment:i,currentSpaceStore:n,botSettings:o,integrationId:t})}}})).filter(x.$K),r=p.map((t=>({key:`${t.id}`,render:e=>d.createElement(ot.Z,s()({},e,{title:a()(Ae.Z,{style:{fontWeight:f.Z.fontWeight.semibold}},void 0,t.name),icon:a()("img",{src:t.info.icon,style:{height:20}}),caption:t.info.tagline,style:{paddingBottom:12},shouldWrapCaption:!0,className:"notranslate"})),action:()=>{e.closeDropdown(),zo({environment:i,currentSpaceStore:n,botSettings:o,integrationId:t.id})}}))).filter(x.$K);g.push(...t,...r)}return a()(lt.Z,{type:lt.i.Vertical,initialFocus:0,sections:[{key:"results",render:e=>d.createElement(ct.Z,e),items:g}]})}}))}function Ko(e){window.__c={n:"AdminComplianceIntegrationSettingsSearchResults"};const{query:t}=e,i=(0,Pe.O7)(),n=(0,Ze.VK)((()=>A.default.state.currentSpaceStore),[]);return n?a()(rt.Z,{menuType:it.og.Popup,width:255,header:Go(t,[],!1)},void 0,a()(Vo.Z,{request:t,performRequest:e=>async function(e){const{query:t,environment:i,spaceId:n}=e;if(!Fe.Z.state.online||!n)return[];if((0,p.e)(t)||(0,p.qn)(t))return[t];const a=await T.searchIntegrations(i,{query:t,type:"compliance",spaceId:n});if("success"===a.type)return a.data.integrationIds;if("failed"===a.type)throw a.error;return(0,x.t1)(a)}({query:e,environment:i,spaceId:null==n?void 0:n.id}),debounce:_n.vp,render:(t,i,o)=>{if(!i||!o)return a()(ct.Z,{},void 0,a()(Uo.Z,{}));const r=[];if(0===i.length)r.push({key:"no_results",render:()=>a()(Ae.Z,{isSmall:!0,style:{marginLeft:8}},void 0,a()(v.FormattedMessage,{id:"adminIntegrationSettings.search.label.noResults",defaultMessage:"No results"})),action:()=>{}});else{const t=Bo.Z.state.loaded?Bo.Z.state.webhookSubscriptions.map((e=>{var t;return null===(t=Bo.Z.getBotsAsRecordMap().getValue({table:Lt.cZ,id:e.bot_id}))||void 0===t?void 0:t.integration_id})):[],o=i.map((i=>{const o=He.y2.createChildStore(n,{id:i,table:Ro.K2});if(t.includes(i))return;const r={table:Ro.K2,id:i},l=He.y2.createChildStore(n,r),c=(0,Ao.RW)(l.id);return{key:`${i}`,render:e=>d.createElement(ot.Z,s()({},e,{title:a()(Ae.Z,{style:{fontWeight:f.Z.fontWeight.semibold}},void 0,l.getName()),icon:(null==c?void 0:c.info.icon)&&a()(je.Z,{disabled:!0,icon:{pointer:r,icon:c.info.icon},isEmptyPage:!1,size:20}),style:null!=c&&c.info.icon?{paddingBottom:12}:{paddingLeft:30,paddingBottom:12},shouldWrapCaption:!0,caption:a()(qo,{tagline:null!=c&&c.info.tagline?z.default.formatMessage(null==c?void 0:c.info.tagline):"A SIEM or DLP partner",isNotionIntegration:!1})})),action:()=>{var t;e.closeDropdown();o.getModel()&&(null!=c&&null!==(t=c.info.oauth)&&void 0!==t&&t.accountInfoPropertyNames||"dlp"===(null==c?void 0:c.info.type))?Oo.Z.setState({open:!0,integrationId:l.id}):No.Z.setState({open:!0,integrationId:l.id})}}})).filter(x.$K);r.push(...o)}return a()(lt.Z,{type:lt.i.Vertical,initialFocus:0,sections:[{key:"results",render:e=>d.createElement(ct.Z,e),items:r}]})}})):null}function zo(e){const{environment:t,currentSpaceStore:i,botSettings:n,integrationId:a}=e;if(i&&!(0,Ao.DB)(a)){const e={...null==n?void 0:n.integration_approval_statuses,[a]:{type:"integration",status:"approved"}};N.createAndCommit({userAction:"AdminIntegrationSettingsSearchResults.handleIntegrationSelection",environment:t,perform:t=>{Eo.sW({store:i,data:{bot_settings:{...n,integration_approval_statuses:e}},transaction:t})}})}}const Go=(e,t,i)=>!e&&!i&&t.length>0&&a()(Ot.Z,{title:a()(Ae.Z,{isSmall:!0,style:{marginTop:4,fontWeight:f.Z.fontWeight.medium}},void 0,a()(v.FormattedMessage,{defaultMessage:"Popular integrations",id:"adminIntegrationSettings.search.title.popularIntegrations"}))}),qo=e=>{window.__c={n:"IntegrationCaption"};const{tagline:t,isNotionIntegration:i}=e,n=(0,xe.Fg)(),o=i?{}:{maxHeight:48,overflow:"auto"};return t?a()("div",{style:o},void 0,t,i&&a()("div",{style:{display:"flex",alignItems:"center",marginTop:8}},void 0,a()(v.FormattedMessage,{defaultMessage:"Developed by Notion",id:"adminIntegrationSettings.search.subtitle.notionBuilt"}),m.Z.integrationSecurity({marginLeft:3,width:12,height:12,fill:n.invoiceGreen}))):null},Ho=(0,v.defineMessages)({searchInputPlaceholder:{id:"adminConnectionsSettings.search.input.placeholder",defaultMessage:"Add by name or integration ID"}});function jo(){window.__c={n:"AdminConnectionsSettingsAddMenu"};const e=(0,Pe.O7)(),t=(0,xe.Fg)(),[i,n]=(0,d.useState)(!0),[o,s]=(0,d.useState)(!1),[r,l]=(0,d.useState)(""),c=d.createRef();return i?a()(Ii.Z,{style:{display:"flex",alignItems:"center",height:28,fontWeight:f.Z.fontWeight.medium,fontSize:f.Z.fontSize.UIRegular.desktop,color:qn.ZP.blue,padding:"0px 6px"},onClick:()=>{n(!1)}},void 0,a()(v.FormattedMessage,{id:"adminConnectionsSettings.search.button.label",defaultMessage:"{plusIcon} Add approved connection",values:{plusIcon:m.Z.plus({fill:qn.ZP.blue,width:14,height:14,flexGrow:0,flexShrink:0})}})):a()(dt.ZP,{alignmentToOrigin:dt.ZP.Alignment.Start,keepFocus:e.device.isPhone,onDismiss:()=>{var e;null===(e=c.current)||void 0===e||e.handleBlur(),n(!0),s(!1)},origin:d.createElement(Wi.Z,{type:"text",style:{width:255},left:m.Z.plus({fill:t.lightIconColor,width:14,height:14,marginRight:8,flexGrow:0,flexShrink:0}),ref:c,value:r,onFocus:()=>{s(!0)},placeholder:z.default.formatMessage(Ho.searchInputPlaceholder),onChange:e=>l(e.target.value)}),open:o,popupType:dt.ZP.PopupType.Popup,style:{width:255},render:()=>a()(Wo,{query:r,closeDropdown:()=>s(!1)})})}function Qo(){window.__c={n:"AdminConnectionsSettingsAddComplianceMenu"};const e=(0,Pe.O7)(),t=(0,xe.Fg)(),[i,n]=(0,d.useState)(!0),[o,s]=(0,d.useState)(!1),[r,l]=(0,d.useState)(""),c=d.createRef();return i?a()(Xe.Z,{isBlue:!0,style:{display:"flex",alignItems:"center",height:28,fontWeight:f.Z.fontWeight.medium,fontSize:f.Z.fontSize.UIRegular.desktop,color:qn.ZP.blue,padding:"0px 6px"},onClick:()=>{var e;n(!1),null===(e=c.current)||void 0===e||e.focusInput()}},void 0,a()(v.FormattedMessage,{id:"adminConnectionsSettingsAddComplianceMenu.search.button.label",defaultMessage:"{plusIcon} Add connection",values:{plusIcon:m.Z.plus({fill:qn.ZP.blue,width:14,height:14,flexGrow:0,flexShrink:0})}})):a()(dt.ZP,{alignmentToOrigin:dt.ZP.Alignment.Start,keepFocus:e.device.isPhone,onDismiss:()=>{var e;null===(e=c.current)||void 0===e||e.handleBlur(),n(!0),s(!1)},origin:d.createElement(Wi.Z,{type:"text",style:{width:255},left:m.Z.plus({fill:t.lightIconColor,width:14,height:14,marginRight:8,flexGrow:0,flexShrink:0}),focus:!0,ref:c,value:r,onFocus:()=>{s(!0)},placeholder:z.default.formatMessage(Ho.searchInputPlaceholder),onChange:e=>l(e.target.value)}),open:o,popupType:dt.ZP.PopupType.Popup,style:{width:255},render:()=>a()(Ko,{query:r,closeDropdown:()=>{n(!0),s(!1)}})})}var Yo=i(3444),$o=i(70578),Xo=i(61519),Jo=i(42402),es=i(55422),ts=i(66957);const is=["member_connections","workspace_connections"];function ns(e){window.__c={n:"AdminConnectionsSettings"};const t=(0,Pe.O7)(),{isMobile:i}=t.device,{externalBotIds:n,guestBotIds:o}=e,s=(0,Ze.VK)((()=>A.default.state.currentSpaceStore),[]),r=(0,Ze.VK)((()=>Bo.Z.webhookSubscriptions.state.reduce(((e,t)=>{const i=t.bot_id;return i&&(e[i]=t),e}),{})),[]),l=(0,Ze.VK)((()=>(0,Q.wP)()&&k.default.checkGate("webhooks_beta")),[]),c=(0,Ze.VK)((()=>s?[...o,...n].map((e=>{const t=He.Qx.createChildStore(s,{table:Lt.cZ,id:e,spaceId:s.id});return t.getAlive()?t:void 0})).filter(x.$K):[]),[s,o,n]),u=(0,Ze.VK)((()=>function(e){return e.reduce(((e,t)=>{const i=t.getIntegrationId();if(!i)return e;return(0,Ao.oh)(i)?(i in e.compliance||(e.compliance[i]=[]),e.compliance[i].push(t.id)):(i in e.nonCompliance||(e.nonCompliance[i]=[]),e.nonCompliance[i].push(t.id)),e}),{compliance:{},nonCompliance:{}})}(c)),[c]),m=(0,Ze.VK)((()=>function(e){return e.filter((e=>!e.getIntegrationId())).map((e=>e.id))}(c)),[c]),p=(0,Ze.VK)((()=>function(e,t){if(!t)return{};return e.reduce(((e,i)=>{const n=Do.U.createChildStore(t,{table:Qt.KJ,id:i.getCreatedById()}),a=i.getIntegrationId();return a?e[a]=a in e?[...e[a],n]:[n]:e[i.id]=[n],e}),{})}(c,s)),[c,s]),g=(0,Ze.VK)((()=>null==s?void 0:s.getBotSettingsStore().getValue()),[s]),h=(0,Ze.VK)((()=>Object.keys(u.nonCompliance).length+m.length),[u.nonCompliance,m]),y=(0,Ze.VK)((()=>Bo.Z.webhookSubscriptions.state.length),[]),S=(0,Ze.VK)((()=>null!=g&&g.integration_approval_statuses?Object.keys(g.integration_approval_statuses).length+m.length:m.length),[g,m]),b={member_connections:a()(v.FormattedMessage,{id:"admin.connections.tabs.member_connections",defaultMessage:"Member{numberOfIntegrations}",values:{numberOfIntegrations:0!==h&&a()(Ae.Z,{isSecondaryColor:!0,style:{marginLeft:6}},void 0,h+Fo.T2.length)}}),workspace_connections:a()(v.FormattedMessage,{id:"admin.connections.tabs.workspace_connections",defaultMessage:"Workspace{numberOfIntegrations}",values:{numberOfIntegrations:0!==y&&a()(Ae.Z,{isSecondaryColor:!0,style:{marginLeft:6}},void 0,y)}})},M=is.map((e=>b[e])),w=(0,Ze.VK)((()=>"integrations"===_e.Z.state.currentTab?_e.Z.state.defaultSubtab:void 0),[]),[C,_]=(0,d.useState)(w||"member_connections"),T={member_connections:()=>d.createElement(d.Fragment,null,a()(as,{}),(null==g?void 0:g.integration_restrictions)&&a()("div",{style:{marginTop:"19px"}},void 0,a()(os,{})),a()(Xo.Z,{size:i?32:18,isHidden:!i}),Boolean(null==g?void 0:g.integration_restrictions)?a()("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:19}},void 0,a()(Ae.Z,{style:{fontWeight:f.Z.fontWeight.medium,display:"flex",alignItems:"center",height:28}},void 0,a()(v.FormattedMessage,{id:"adminConnectionsSettings.table.allowIntegrations.title",defaultMessage:"Approved connections{numberOfIntegrations}",values:{numberOfIntegrations:0!==S&&a()(Ae.Z,{isSecondaryColor:!0,style:{marginLeft:6}},void 0,S)}})),a()(jo,{})):a()(Ae.Z,{style:{fontWeight:f.Z.fontWeight.medium,display:"flex",height:28,alignItems:"center",marginBottom:"19px"}},void 0,a()(v.FormattedMessage,{id:"adminConnectionsSettings.table.default.title",defaultMessage:"All connections{numberOfIntegrations}",values:{numberOfIntegrations:0!==h&&a()(Ae.Z,{isSecondaryColor:!0,style:{marginLeft:6}},void 0,h+Fo.T2.length)}})),a()(Yo.ZP,{integrationIdToBotIds:u.nonCompliance,internalIntegrationIds:m,integrationIdToUsers:p}),a()("div",{style:{marginTop:16,marginBottom:32,display:"grid",gridTemplateColumns:"1fr",gap:4}},void 0,a()($o.Z,{}))),workspace_connections:()=>d.createElement(d.Fragment,null,l?d.createElement(d.Fragment,null,a()("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:19,marginTop:20}},void 0,a()("span",{style:{fontSize:14,marginRight:8}},void 0,a()(v.FormattedMessage,{id:"admin.connections.tab.workspace_connections.header",defaultMessage:"These integrations connect your workspace to external apps, or improve security and compliance. Only workspace owners can install them."})),a()(Qo,{})),a()(Yo.cP,{botIdToWebhookSubscription:r})):null)},I=e=>T[e];return l?d.createElement(d.Fragment,null,a()(ts.Z,{tabs:M,selectedIndex:is.findIndex((e=>e===C)),onChange:e=>(e=>{_(is[e])})(e),style:{paddingLeft:0,paddingRight:0,marginTop:-6,marginBottom:14},tabTitleStyle:{fontSize:16}}),I(C)()):I("member_connections")()}const as=()=>{window.__c={n:"RequireApprovalDropdown"};const e=(0,Pe.O7)(),t=(0,Ze.VK)((()=>A.default.state.currentSpaceStore),[]),{isMobile:i}=e.device,n=(0,Ze.VK)((()=>(0,Q.wP)()),[]),o=(0,Ze.VK)((()=>null==t?void 0:t.getBotSettingsStore().getValue()),[t]);return a()(es.Z,{isMobile:i,title:a()(v.FormattedMessage,{id:"adminConnectionsSettings.requireApprovalSetting.title",defaultMessage:"Restrict members from adding connections"}),caption:(0,g.CJ)(o)?a()(v.FormattedMessage,{id:"adminConnectionsSettings.requireApprovalSetting.allowList.workspaceOwner.caption",defaultMessage:"Workspace members can only install connections pre-approved by workspace owners."}):a()(v.FormattedMessage,{id:"adminConnectionsSettings.requireApprovalSetting.off.caption",defaultMessage:"Workspace members can install any new connection."}),upsellOptions:{shouldUpsell:!n,subscriptionTier:"enterprise",analyticsName:"integration_settings"},type:"dropdown",currentOption:(0,g.CJ)(o)?"allow_list":"any_integrations",options:[{key:"any_integrations",label:a()(v.FormattedMessage,{id:"adminIntegrationSettings.integrationRestrictions.off.title",defaultMessage:"No restrictions"}),caption:a()(v.FormattedMessage,{id:"adminConnectionsSettings.connectionRestrictions.off.caption",defaultMessage:"Workspace members can install any connection."})},{key:"allow_list",label:a()(v.FormattedMessage,{id:"adminIntegrationSettings.integrationRestrictions.allowList.title",defaultMessage:"Only from approved list"}),caption:a()(v.FormattedMessage,{id:"adminConnectionsSettings.connectionRestrictions.allowList.caption",defaultMessage:"Workspace members can only install connections pre-approved by a workspace owner."})}],onSelectOption:i=>{!function(e){const{environment:t,currentSpaceStore:i,botSettings:n,setting:a}=e;if(i){if("allow_list"===a&&(0,g.CJ)(n))return;const e="allow_list"===a?"approved_only":void 0;N.createAndCommit({userAction:"AdminIntegrationSettings.handleIntegrationRestrictionSelect",environment:t,perform:t=>{Eo.sW({store:i,data:{bot_settings:{...n,integration_restrictions:e}},transaction:t})}})}}({environment:e,currentSpaceStore:t,botSettings:o,setting:i})},info:[{key:"learn_more",label:a()(v.FormattedMessage,{id:"adminConnectionsSettings.connectionRestrictions.info.title",defaultMessage:"Workspace owners can always install and approve new connections."})}]})};const os=()=>{window.__c={n:"AutoApproveBuiltByNotionToggle"};const e=(0,Pe.O7)(),t=(0,xe.Fg)(),i=(0,Ze.VK)((()=>A.default.state.currentSpaceStore),[]),{isMobile:n}=e.device,o=(0,Ze.VK)((()=>(0,Q.wP)()),[]),s=(0,Ze.VK)((()=>null==i?void 0:i.getBotSettingsStore().getValue()),[i]);return a()(es.Z,{isMobile:n,title:a()(v.FormattedMessage,{id:"adminConnectionsSettings.autoApproveBuiltByNotion.title",defaultMessage:"Auto-approve <builtbynotion>Built by Notion</builtbynotion> connections",values:{builtbynotion:e=>a()("span",{style:{color:t.invoiceGreen,marginRight:4,marginLeft:4}},void 0,m.Z.integrationSecurity({width:14,display:"inline",verticalAlign:"bottom",marginRight:2}),e)}}),caption:a()(v.FormattedMessage,{defaultMessage:"Toggle this on to approve all workspace members to install connections <helpcenterlink>built by Notion</helpcenterlink>.",id:"adminConnectionsSettings.autoApproveBuiltByNotion.caption",values:{helpcenterlink:e=>a()(Jo.Z,{href:(0,H.UY)("guides.enterpriseIntegrationSettings")},void 0,e)}}),upsellOptions:{shouldUpsell:!o,subscriptionTier:"enterprise",analyticsName:"integration_settings"},type:"toggle",isOn:"approved_or_built_by_notion"===(null==s?void 0:s.integration_restrictions),onToggle:()=>function(e){const{environment:t,currentSpaceStore:i,botSettings:n}=e;if(i){const e="approved_or_built_by_notion"===(null==n?void 0:n.integration_restrictions)?"approved_only":"approved_or_built_by_notion";N.createAndCommit({userAction:"AdminIntegrationSettings.handleAutoApproveBuiltByNotionToggle",environment:t,perform:t=>{Eo.sW({store:i,data:{bot_settings:{...n,integration_restrictions:e}},transaction:t})}})}}({environment:e,currentSpaceStore:i,botSettings:s})})};var ss=i(59649);class rs extends c.Z{constructor(){super(...arguments),this.storeTypes={requestStore:xo.Z},this.renderResult=(e,t,i)=>{const{currentSpaceStore:n}=A.default.state;if(n)return a()(ss.Z,{loaded:i,spinnerSize:16,showSpinnerTimeout:600},void 0,e&&a()("div",{},void 0,a()(v.FormattedMessage,{id:"spaceIntegrationSettings.error",defaultMessage:"Something went wrong…"})),t&&d.createElement(ns,t))},this.fetchBotsInSpace=async e=>{let{spaceId:t}=e;const i=await Promise.all([To.Yw({environment:this.environment,table:xa.bx,id:t,type:"guest"}),To.Yw({environment:this.environment,table:xa.bx,id:t,type:"external"}),Po.pJ({environment:this.environment})]);return{guestBotIds:i[0].botIds,externalBotIds:i[1].botIds}}}renderComponent(){const{device:e}=this.environment;if((0,Zo.Fn)(this.environment))return a()(Ee.Z,{},void 0,a()(Be.Z,{large:!e.isMobile||void 0,divider:e.isMobile?void 0:"full",style:{paddingBottom:12}},void 0,a()(v.FormattedMessage,{id:"spaceConnectionsSettings.title",defaultMessage:"Connections"})),this.renderRequest());Io.r({currentTab:"members"})}renderRequest(){const{spaceStore:e,userStore:t}=this.props;return a()(Vo.Z,{requestStore:this.stores.requestStore,request:{spaceId:e.id,userId:t.id},performRequest:this.fetchBotsInSpace,render:this.renderResult})}}rs.displayName="IntegrationSettings";const ls=(0,v.injectIntl)(rs);var ds=i(36488),cs=i(56940),us=i(53953),ms=i(79603),ps=i(53770);const gs=[50,100,200,500,1e3];function hs(e){let{spaceStore:t,samlConfigStore:i,memberCountFilter:n,isPrimarySpace:a}=e;const o=(0,Pe.O7)(),s=(0,Ze.VK)((()=>i.state.emailDomains),[i]),[r,l]=(0,d.useState)({spaces:[],nextEarliestCreatedAt:Date.now(),numPagesLoaded:0,hasNextPage:!1,loading:!1,error:void 0}),c=(0,Ze.VK)((()=>(0,Q.wP)()),[]),u=(0,d.useCallback)((async e=>{if(c&&0!==s.length&&a&&r.nextEarliestCreatedAt&&!r.loading&&!(e&&r.numPagesLoaded>0||r.error)){l((e=>({...e,loading:!0})));try{const{spaces:e,earliestCreatedAt:i,hasMoreSpaces:a}=await(0,ps.XD)({fn:async()=>await async function(e,t,i,n,a){const o=await T.getSpacesCreatedByUserWithDomains(e,{spaceId:t,emailDomains:i,spacesLimit:10,memberCountFilter:a,spaceCreatedTimeUpperBound:n});if("failed"===o.type)throw o.error;return{spaces:o.data.results.map((e=>({id:e.id,name:e.spaceName,icon:e.spaceIcon,createdAt:e.spaceCreatedTime,memberCount:e.memberCount,subscriptionTier:e.subscriptionTier,creatorEmailDomain:e.spaceCreatedByDomain,creator:e.spaceCreator,admins:e.admins,spaceRequest:e.spaceRequest,isDelinquent:e.isDelinquent,isPendingBilling:e.isPendingBilling,isActorInSpace:e.isActorInSpace}))),earliestCreatedAt:o.data.hasMoreSpaces?o.data.earliestCreatedAt:void 0,hasMoreSpaces:o.data.hasMoreSpaces}}(o,t.id,s,r.nextEarliestCreatedAt?r.nextEarliestCreatedAt-1:Date.now(),n),handleError:(e,t)=>t?{status:"throw",error:e}:{status:"retry"},retryAttemptsMS:gs,retryAttemptRandomOffsetMS:50,initialInput:void 0});l((t=>{const n=[...t.spaces],o=new Set(t.spaces.map((e=>e.id)));for(const i of e)o.has(i.id)||n.push(i);return{spaces:n,nextEarliestCreatedAt:i,numPagesLoaded:t.numPagesLoaded+1,hasNextPage:a,loading:!1,error:void 0}}))}catch(i){const e=(0,mn.tg)(i);l((t=>({...t,loading:!1,error:e})))}}}),[o,c,n,a,t,s,r.nextEarliestCreatedAt,r.numPagesLoaded,r.loading,r.error]);const m=(0,d.useCallback)((async()=>{await u(!1)}),[u]),p=(0,d.useCallback)((async()=>{await u(!0)}),[u]),g=(0,d.useCallback)((async()=>{l({spaces:[],nextEarliestCreatedAt:Date.now(),numPagesLoaded:0,hasNextPage:!1,loading:!1,error:void 0}),await u(!0)}),[u]);return{claimableSpaces:r.spaces,loading:r.loading,error:r.error,hasNextPage:r.hasNextPage,loadFirstPage:p,loadNextPage:m,resetFirstPage:g,setSpaceRequest:function(e,t){l((i=>{const n=i.spaces.map((i=>i.id===e?{...i,spaceRequest:t}:i));return{...i,spaces:n}}))},removeClaimableSpace:function(e){l((t=>{const i=t.spaces.filter((t=>t.id!==e));return{...t,spaces:i}}))}}}var fs=i(59054);async function vs(e){const{environment:t,spaceId:i,store:n}=e;if(!(0,Q.Rs)())return n.reset(),{};const a=await T.getSamlConfigForSpace(t,{spaceId:i});if("failed"===a.type)M.showError(a);else if(a.data&&a.data.samlConfig){const e={...a.data.samlConfig,useMetadataUrl:!Boolean(a.data.samlConfig.idpMetadata)};return n.setState(e),a.data}return n.reset(),{}}const ys="settings-page",Ss="workspaces-page",bs="managed-users-page";let Ms=function(e){return e[e.Single=0]="Single",e[e.Multi=1]="Multi",e}({});const ws=(0,d.createContext)(null),Cs=e=>{let{spaceStore:t,samlConfigStore:i,domainSettingsStore:n,children:o}=e;window.__c={n:"PageProvider"};const s=(0,Pe.O7)(),[r,l]=(0,d.useState)(ys),[c,u]=(0,d.useState)(Ms.Single),m=(0,Ze.VK)((()=>i.state.emailDomains),[i]),p=(0,Ze.VK)((()=>Boolean(i.state.id)&&i.state.id===t.id),[i,t]),{loading:g,error:h,loaded:f}=function(e){let{spaceStore:t,samlConfigStore:i,domainSettingsStore:n}=e;const a=(0,Pe.O7)(),[{status:o,error:s}]=(0,fs.r5)((async()=>{var e;const o=await vs({environment:a,spaceId:t.id,store:i});if((0,Cn.Zw)(o))return o;const s=null===(e=o.samlConfig)||void 0===e?void 0:e.id;return s?{samlResponse:o,domainResponse:await n.updateValueForSpace({environment:a,spaceId:s,store:n})}:{samlResponse:o,domainResponse:void 0}}),[a,i,t,n]);return{loading:"pending"===o,loaded:"resolved"===o,error:s}}({spaceStore:t,samlConfigStore:i,domainSettingsStore:n}),{loading:v,error:y,claimableSpaces:S,setSpaceRequest:M,removeClaimableSpace:w,hasNextPage:C,loadNextPage:_,loadFirstPage:k,resetFirstPage:I}=hs({spaceStore:t,samlConfigStore:i,isPrimarySpace:p,memberCountFilter:"single"}),{loading:P,error:Z,claimableSpaces:x,setSpaceRequest:F,removeClaimableSpace:A,hasNextPage:E,loadNextPage:B,loadFirstPage:D,resetFirstPage:R}=hs({spaceStore:t,samlConfigStore:i,isPrimarySpace:p,memberCountFilter:"multi"}),L=S.length+x.length>0,[N,O,V,U,W,K,z,G]=c===Ms.Single?[v,y,S,M,w,C,_,k,I]:[P,Z,x,F,A,E,B,D,R],{loading:q,error:H,domainVerifications:j}=function(e){let{spaceStore:t}=e;const i=(0,Pe.O7)(),[n,a]=(0,d.useState)([]),[{status:o,error:s}]=(0,fs.r5)((async()=>{const e=await T.getDomainVerificationCodesForSpace(i,{spaceId:t.id,verifiedOnly:!0});"success"===e.type?a(e.data.domainVerifications):a([])}),[i,t]);return{loading:"pending"===o,domainVerifications:"resolved"===o?n:[],error:s}}({spaceStore:t,emailDomains:m});(0,d.useEffect)((()=>{k(),D()}),[V,k,D]);const Q={page:r,navigateTo:function(e){l(e),0===S.length&&x.length>0&&u(Ms.Multi),"workspaces-page"===e&&b.Cez(s,{verifiedDomains:m,tab:c===Ms.Single?"single":"multi"})},loadingSaml:g,loadingSpaces:N,loadingVerifications:q,errorSaml:h,errorClaimableSpaces:O,errorVerifications:H,loadedSaml:f,domainVerifications:j,hasBrowsableSpaces:L,claimableSpaces:V,setSpaceRequest:U,removeClaimableSpace:W,resetInitialClaimableSpaces:G,hasMoreClaimableSpaces:K,loadMoreClaimableSpaces:z,tab:c,setSelectedTab:function(e){u(e),"workspaces-page"===r&&b.Cez(s,{verifiedDomains:m,tab:e===Ms.Single?"single":"multi"})},verifiedDomains:m};return a()(ws.Provider,{value:Q},void 0,o)};var _s=i(81236);let ks=function(e){return e.User="user",e.Domains="domains",e}({});var Ts=i(64964);const Is={managedUsers:[],filters:{query:"",multiFactorStatus:void 0,workspaceId:void 0},numPagesLoaded:0,hasNextPage:!0,paginationToken:void 0,loading:!1,error:void 0};function Ps(e){let{spaceStore:t,samlConfigStore:i,userStatus:n}=e;const a=(0,Pe.O7)(),[o,s]=(0,d.useState)(Is),r=(0,d.useRef)(o.filters),c=(0,Ze.VK)((()=>Boolean(i.state.id)&&i.state.id===t.id),[i,t]),u=(0,Ze.VK)((()=>i.state.emailDomains),[i]),m=(0,Ze.VK)((()=>k.default.checkGate("enable_managed_users_dashboard")),[]),p=(0,d.useCallback)((async e=>{if(!m)return;if(0===u.length)return;if(!c)return;let i=o.loading,l=o.error,d=o.hasNextPage,p=o.paginationToken;if(e.restartSearch&&(s((e=>({...Is,filters:e.filters}))),i=Is.loading,l=Is.error,d=Is.hasNextPage,p=Is.paginationToken),d&&!i&&!l){s((e=>({...e,loading:!0}))),r.current=o.filters;try{var g;const e=await T.getManagedUsers(a,{spaceId:t.id,emailDomains:u,query:o.filters.query,multiFactorStatus:o.filters.multiFactorStatus,workspaceId:o.filters.workspaceId,paginationToken:p,userStatus:n});if(b.HH5(a,{filters:{multiFactorStatus:o.filters.multiFactorStatus,workspaceId:o.filters.workspaceId},query_length:(null===(g=o.filters.query)||void 0===g?void 0:g.length)??0,current_page:p,user_status:n}),"failed"===e.type)throw e.error;const i=e.data.nextPaginationToken,r=e.data.results;s((e=>{const t=[...e.managedUsers],n=new Set(e.managedUsers.map((e=>e.userId)));for(const i of r)n.has(i.userId)||t.push(i);return{...e,managedUsers:t,loading:!1,error:void 0,numPagesLoaded:e.numPagesLoaded+1,paginationToken:i,hasNextPage:Boolean(i)}}))}catch(h){const e=(0,mn.tg)(h);s((t=>({...t,loading:!1,error:e})))}}}),[a,t,m,u,c,o.loading,o.error,o.hasNextPage,o.paginationToken,o.filters,n]);(0,d.useEffect)((()=>{l().isEqual(r.current,o.filters)||p({restartSearch:!0})}),[o.filters,p]);const g=(0,d.useCallback)((()=>p({restartSearch:!1})),[p]),h=(0,d.useCallback)((e=>{s((t=>({...t,filters:{...t.filters,...e}})))}),[]),f=(0,d.useCallback)(((e,t)=>{s((i=>({...i,managedUsers:i.managedUsers.map((i=>i.userId===e?{...i,workspaces:i.workspaces.filter((e=>e.id!==t))}:i))})))}),[]),v=(0,d.useCallback)((e=>{s((t=>({...t,managedUsers:[...t.managedUsers,e]})))}),[]),y=(0,d.useCallback)((e=>{s((t=>({...t,managedUsers:t.managedUsers.filter((t=>t.userId!==e))})))}),[]);return{managedUsers:o.managedUsers,filters:o.filters,loading:o.loading,error:o.error,removeWorkspaceFromUser:f,addUserToManagedUsers:v,removeUserFromManagedUsers:y,setFilters:h,hasNextPage:o.hasNextPage,loadNextPage:g}}let Zs=function(e){return e[e.NotSuspended=0]="NotSuspended",e[e.Suspended=1]="Suspended",e}({});function xs(e){switch(e){case Zs.Suspended:return"suspended";case Zs.NotSuspended:return"notSuspended";default:(0,x.t1)(e)}}function Fs(e){let{lastActiveAt:t}=e;window.__c={n:"LastActiveDate"};const i=(0,xe.yK)((e=>({container:{opacity:.5}})),[]);return a()("div",{style:i.container},void 0,t?a()(ze,{dateTs:t}):a()(Ae.Z,{},void 0,a()(v.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.lastActive.unknown",defaultMessage:"No activity"})))}const As={defaultMessage:"External workspace",id:"managedUsers.externalWorkspaceName",description:"A generic name to replace the real name of an external workspace."};function Es(e){return e.formatMessage(As)}function Bs(e){if(!e)return;const t=Object.entries(Za.nb).find((t=>{let[i,n]=t;return n===e}));if(t){return t[0]}}function Ds(e){let{workspace:t}=e;window.__c={n:"WorkspaceSummaryName"};const i=(0,v.useIntl)(),n=(0,xe.yK)((e=>({container:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-start"}})),[]);return a()("div",{style:n.container},void 0,t.name??Es(i),t.isExternal?a()(Rs,{}):null)}function Rs(){window.__c={n:"ExternalWorkspaceInfoIcon"};const e=(0,xe.yK)((e=>({icon:{marginLeft:4,height:14,width:14,opacity:.5}})),[]);return a()(We.Z,{render:t=>d.createElement("div",t,m.Z.info(e.icon)),renderTooltip:()=>a()(v.FormattedMessage,{id:"identityAndProvisioning.managedUsers.userAccess.externalSpaceNameTooltipText",defaultMessage:"This is an external workspace that does not belong to this user."})})}function Ls(e){let{workspaceSummaries:t}=e;window.__c={n:"UserAccess"};const i=(0,v.useIntl)(),n=(0,xe.yK)((e=>({title:{marginRight:8},noWorkspaces:{paddingInline:8,opacity:.5},workspaceName:{maxWidth:"80%"},plusMore:{opacity:.5,marginLeft:4},titleContainer:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-start",width:"100%",marginLeft:4}})),[]);if(t.length<=0)return a()(Ae.Z,{style:n.noWorkspaces},void 0,a()(v.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.userAccess.noWorkspaces",defaultMessage:"No workspaces"}));const o=t.find((e=>e.name)),s=o?o.name:Es(i),r=t.length-1;return a()("div",{style:n.titleContainer},void 0,a()(Ae.Z,{isInline:!0,style:n.workspaceName},void 0,s),!o||o.isExternal?a()(Rs,{}):null,r>0?a()(Ae.Z,{isInline:!0,style:n.plusMore},void 0,a()(v.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.userAccess.additionalCount",defaultMessage:"+{numRemainingWorkspaces}",values:{numRemainingWorkspaces:r}}),""):null)}var Ns=i(93405),Os=i(83182);const Vs=(0,v.defineMessages)({menuAriaLabel:{defaultMessage:"Open action menu for this user.",id:"identityAndProvisioning.managedUsers.table.menu.ariaLabel"}});function Us(e){let{managedUser:t,managedUserActionSections:i}=e;window.__c={n:"UserActionsMenu"};const n=(0,Ze.qz)(void 0,Zt.Z),o=(0,v.useIntl)(),r=(0,xe.yK)((()=>({container:{minWidth:265}})),[]);return a()(Et.ZP,{popupType:dt.kQ.Popup,style:r.container,buttonPopupStore:n,renderOrigin:e=>d.createElement(Bt.Z,s()({ariaLabel:o.formatMessage(Vs.menuAriaLabel),icon:m.Z.dots},e)),render:()=>a()(Ws,{managedUser:t,popupStore:n,managedUserActionSections:i})})}function Ws(e){let{managedUser:t,popupStore:i,managedUserActionSections:n}=e;window.__c={n:"ActionsMenu"};const o=[],r=(0,xe.yK)((()=>({destructiveIcon:{fill:qn.ZP.red,color:qn.ZP.red}})),[]);for(const[a,l]of n.entries()){const e=l.map(((e,i)=>({key:i,render:i=>{var n,a;return d.createElement(Ns.Z,s()({},i,{shouldWrapCaption:!0,svg:t=>e.icon(e.isDestructive?{...t,...r.destructiveIcon}:t),title:e.title,style:{paddingTop:8,paddingBottom:8,...e.isDestructive?r.destructiveIcon:{}},disabled:null===(n=e.getDisabledState)||void 0===n?void 0:n.call(e,t),disabledFeedback:null===(a=e.getDisabledState)||void 0===a?void 0:a.call(e,t)}))},action:()=>e.onClick(t)}))),i={key:`section-${a}`,render:e=>d.createElement(ct.Z,s()({topBorder:a>0},e)),items:e};o.push(i)}return a()(rt.Z,{menuType:it.og.Popup},void 0,a()(lt.Z,{type:lt.i.Vertical,initialFocus:void 0,sections:o,onAccept:()=>{i.setState({open:!1})}}),a()(ct.Z,{topBorder:!0},void 0,a()(Os.Z,{title:a()(v.FormattedMessage,{defaultMessage:"Learn about user suspension",id:"managedUsersDashboard.userActionsMenu.helpButton"}),href:(0,H.UY)("guides.managedUsers"),analyticsFrom:"managed_users_dashboard_user_actions_menu"})))}function Ks(e){let{userId:t}=e;window.__c={n:"UserSummary"};const i=(0,v.useIntl)(),n=(0,Ze.VK)((()=>{const e=A.default.state.currentSpaceStore;if(!e)return;const n=He.U6.createChildStore(e,{table:Qt.KJ,id:t});return{userStore:n,userName:n.getDisplayName(i),userEmail:n.getEmail()}}),[t,i]),o=(0,xe.yK)((e=>({iconStyle:{border:`1px solid ${e.tableDividerColor}`,color:e.lightTextColor,fontWeight:500}})),[]);return n?a()(Ke.i,{useThinTitle:!0,title:n.userName,byline:n.userEmail,icon:a()($t.Z,{size:28,userStore:n.userStore,iconStyle:o.iconStyle})}):null}var zs=function(e){return e.ManagedUser="managed-user",e.Loading="loading",e}(zs||{});const Gs={borderRadius:"100%",height:28,width:28,marginLeft:-4},qs={marginLeft:4,height:14,width:14,opacity:.5},Hs=[{id:"user",headerTitle:a()(v.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.user",defaultMessage:"Users"}),renderCell:e=>e.type===zs.ManagedUser?a()(Ks,{userId:e.managedUser.userId}):a()(Ke.H,{includeByline:!0,includeIcon:!0,iconStyles:Gs}),widthData:{width:70},sortable:!1},{id:"access",headerTitle:a()("span",{style:{paddingInline:8}},void 0,a()(v.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.access",defaultMessage:"Workspaces"})),renderCell:e=>e.type===zs.ManagedUser?a()(Ls,{workspaceSummaries:e.managedUser.workspaces}):a()(Rt.z,{}),widthData:{width:60},sortable:!1},{id:"lastActive",headerTitle:a()("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-start"}},void 0,a()(v.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.lastActive",defaultMessage:"Last active"}),a()(We.Z,{render:e=>d.createElement("div",e,m.Z.info(qs)),renderTooltip:()=>a()(v.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.lastActive.tooltip",defaultMessage:"This may be delayed by several hours."})})),renderCell:e=>e.type===zs.ManagedUser?a()(Fs,{lastActiveAt:e.managedUser.lastActiveAt}):a()(Ge,{}),widthData:{width:60},sortable:!1},{id:"menu",headerTitle:null,renderCell:e=>e.type===zs.ManagedUser?a()(Us,{managedUser:e.managedUser,managedUserActionSections:e.managedUserActionSections}):null,widthData:{width:15},sortable:!1,hasClickableContents:!0}],js=[{id:"1",isClickable:!1,type:zs.Loading},{id:"2",isClickable:!1,type:zs.Loading},{id:"3",isClickable:!1,type:zs.Loading}];function Qs(e){let{managedUsers:t,loadMoreManagedUsers:i,onEditDetails:n,loading:o,managedUserActionSections:s}=e;window.__c={n:"ManagedUsersTable"};const r=t.map((e=>({id:e.userId,type:zs.ManagedUser,managedUser:e,isClickable:!0,managedUserActionSections:s}))),l=(0,xe.yK)((e=>(0,Oe.b)({columnRenderInfo:Hs,theme:e,containerMarginTop:0})),[]);const c=o?[...r,...js]:r;return d.createElement(d.Fragment,null,a()(Oe.D,{hideHeaderRowPadding:!0,showRowBorders:!0,columnRenderInfo:Hs,rows:c,onRowClick:function(e){e.type===zs.ManagedUser&&n(e.managedUser)},renderNoRowsComponent:()=>a()(Ys,{loading:o}),styles:l,onScrollBottom:i}))}function Ys(e){window.__c={n:"EmptyState"};const t=(0,xe.yK)((()=>({text:{marginTop:15,marginBottom:40,textAlign:"center"}})),[]);return a()(Ae.Z,{isSmall:!0,style:t.text},void 0,!e.loading&&a()(v.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.empty",defaultMessage:"No users found."}))}function $s(e){let{pillIcon:t,pillTitle:i,selectedItem:n,setSelectedItem:o,items:r}=e;window.__c={n:"BaseFilterPill"};const l=(0,Ze.qz)(void 0,nt.Z),c=(0,xe.yK)((e=>({container:{padding:"6px 0 6px"},footer:{padding:"8px 8px 2px 8px",justifyContent:"space-between",display:"flex"},icon:{width:12,marginRight:6,fill:"currentColor"}})),[]),[u,m]=(0,d.useState)(!1),[p,g]=(0,d.useState)(n);function h(){o(void 0),g(void 0),m(!1)}function f(){o(p),m(!1)}const y=a()(at.Z,{on:void 0!==n,icon:t?t(c.icon):void 0,title:i,onClick:()=>m(!0)});return a()(ut.Z,{},void 0,a()(dt.ZP,{popupType:dt.ZP.PopupType.Popup,placementToOrigin:dt.ZP.Placement.Bottom,alignmentToOrigin:dt.ZP.Alignment.Start,open:u,render:function(){const e={key:"menuOptions",items:r.map((e=>({key:e.key,action:()=>function(e){g(p===e?void 0:e)}(e.value),render:t=>d.createElement(ot.Z,s()({},t,{icon:a()(Si.Z,{isSelected:p===e.value}),focused:!1,title:e.title,caption:e.caption,shouldWrapCaption:e.wrapCaption}))}))),render:e=>d.createElement(ct.Z,s()({},e,{title:null,loading:!1}))};return a()("div",{style:c.container},void 0,a()(rt.Z,{menuType:it.og.Popup,header:null,maxHeight:250,width:300},void 0,a()(lt.Z,{type:lt.i.Vertical,store:l,initialFocus:0,sections:[e]})),a()(ct.Z,{topBorder:!0,style:c.footer},void 0,a()(Xe.Z,{onClick:h},void 0,a()(v.FormattedMessage,{id:"core.baseFilterPill.clearButton",defaultMessage:"Clear"})),a()($e.Z,{onClick:f},void 0,a()(v.FormattedMessage,{id:"core.baseFilterPill.doneButton",defaultMessage:"Apply"}))))},onDismiss:function(){m(!1),g(n)},keepFocus:!0,origin:y,preventScaleTransition:!0}))}function Xs(e){let{selectedMfaMethod:t,setSelectedMfaMethod:i}=e;return a()($s,{pillTitle:a()(v.FormattedMessage,{id:"managedUsersTab.table.filters.mfaMethod.title",defaultMessage:"2-step verification method"}),pillIcon:m.Z.lockShield,selectedItem:t,setSelectedItem:i,items:Js})}const Js=[{key:"totp",value:"totp",title:a()(v.FormattedMessage,{id:"managedUsersTab.table.filters.mfaMethod.totp",defaultMessage:"Authenticator"}),caption:a()(v.FormattedMessage,{id:"managedUsersTab.table.filters.mfaMethod.totp.caption",defaultMessage:"Users who have enabled 2-step verification through an authenticator app"}),wrapCaption:!0},{key:"sms",value:"sms",title:a()(v.FormattedMessage,{id:"managedUsersTab.table.filters.mfaMethod.sms",defaultMessage:"Phone number"}),caption:a()(v.FormattedMessage,{id:"managedUsersTab.table.filters.mfaMethod.sms.caption",defaultMessage:"Users who have enabled 2-step verification through their phone number"}),wrapCaption:!0},{key:"backup_code",value:"backup_code",title:a()(v.FormattedMessage,{id:"managedUsersTab.table.filters.mfaMethod.backupCode",defaultMessage:"Backup code"}),caption:a()(v.FormattedMessage,{id:"managedUsersTab.table.filters.mfaMethod.backup_code.caption",defaultMessage:"Users who have enabled 2-step verification with active backup codes."}),wrapCaption:!0}];var er=i(24211),tr=i(23063),ir=i(15095),nr=i(71669),ar=i(81865);function or(e){let{size:t,style:i,avatarType:n,isOffline:o,disabled:s,loading:r,disabledTooltipMessage:l,onUploadProfilePhoto:c,onRemoveProfilePhoto:u}=e;window.__c={n:"UIEditableUserAvatar"};const[p,g]=(0,d.useState)(!1),h=(0,xe.yK)((e=>{const i=(t??18)/2,n=Math.ceil(Math.sqrt(i/2)-8);return(0,xe.EM)({avatarButton:{position:"relative",padding:0,border:0,background:"none",borderRadius:"50%"},removeIconButton:{display:"flex",justifyContent:"center",alignItems:"center",position:"absolute",top:n+2,right:n+2,height:16,width:16,padding:0,borderRadius:"50%",border:"none",background:"light"===e.mode?e.contentBackground:e.tooltipBackground,boxShadow:e.lightBoxShadow,transition:"background 0.2s ease"},removeIcon:{fill:"light"===e.mode?qn.FN.light.gray[400]:qn.FN.dark.gray[800],height:10,width:10},buttonPressed:{borderRadius:"50%",background:"light"===e.mode?qn.FN.light.gray[200]:qn.FN.dark.gray[600]},buttonHovered:{borderRadius:"50%",background:"light"===e.mode?qn.FN.light.gray[100]:qn.FN.dark.gray[500]}})}),[t]),f=(0,d.useCallback)((()=>p?a()(v.FormattedMessage,{id:"editableUserAvatar.profilePhoto.remove",defaultMessage:"Remove photo"}):"photo"===n.type?a()(v.FormattedMessage,{id:"editableUserAvatar.profilePhoto.replace",defaultMessage:"Replace photo"}):a()(v.FormattedMessage,{id:"editableUserAvatar.profilePhoto.upload",defaultMessage:"Upload photo"})),[n.type,p]);return r?a()(sr,{size:t??18,isOffline:o,avatarType:n,loading:r}):a()(We.Z,s?{disableTooltip:!l,renderTooltip:()=>l,placement:We.Z.Placement.Bottom,alignment:We.Z.Alignment.Center,render:e=>d.createElement("div",e,a()(sr,{size:t??18,isOffline:o,avatarType:n}))}:{renderTooltip:f,placement:We.Z.Placement.Bottom,alignment:We.Z.Alignment.Center,render:(e,s)=>a()(Ii.Z,{style:{...h.avatarButton,...i},pressedStyle:h.buttonPressed,hoveredStyle:h.buttonHovered,onMouseEnter:e.onMouseEnter,onMouseLeave:e.onMouseLeave,onClick:c},void 0,a()(sr,{size:t??18,isOffline:o,avatarType:n}),s&&"photo"===n.type&&a()(Ii.Z,{style:h.removeIconButton,pressedStyle:h.buttonPressed,hoveredStyle:h.buttonHovered,onClick:e=>{u(),e.stopPropagation()},onMouseEnter:()=>g(!0),onMouseLeave:()=>g(!1)},void 0,m.Z.closeSmall(h.removeIcon)))})}function sr(e){let{size:t,isOffline:i,loading:n,avatarType:o}=e;window.__c={n:"UserAvatar"};const s=(0,xe.yK)((e=>(0,xe.EM)({avatarWrapStyle:{background:e.buttonHoveredBackground,borderRadius:"100%",boxShadow:"none",..."light"===e.mode?{border:`1px solid ${qn.FN.light.gray[100]}`}:{}},avatarStyle:{borderRadius:"100%",width:t,height:t,maxWidth:"100%",maxHeight:"100%",display:"flex",alignItems:"center",justifyContent:"center",userSelect:"none",WebkitUserSelect:"none",opacity:i?.3:1},avatarIcon:{width:Math.ceil(.6*t),height:Math.ceil(.6*t),color:e.mediumIconColor},imageBox:{width:"100%",height:"100%",borderRadius:"100%"},initialStyle:{boxSizing:"content-box",border:"none",borderRadius:"100%",width:t-2,height:t-2,lineHeight:t-2+"px",overflow:"hidden",textAlign:"center",fontSize:Math.max(t*(14/32),10),userSelect:"none",WebkitUserSelect:"none",color:e.regularIconColor,opacity:i?.3:1},suspendedUserStyle:{boxSizing:"content-box",borderRadius:"100%",width:t-2,height:t-2,overflow:"hidden",background:e.suspendedUIUserAvatarBackground,userSelect:"none",WebkitUserSelect:"none",color:e.regularTextColor,opacity:i?.3:1,display:"flex",justifyContent:"center",alignItems:"center"},suspendedUserIconStyle:{width:t-2,height:t-2,color:e.lightIconColor}})),[t,i]),r=(0,d.useMemo)((()=>n?a()(Ve.Z,{}):"photo"===o.type?a()(ar.Z,{stripGoogleIconQuery:!0,url:o.profilePhoto,isAuthenticated:!1,width:t||18,render:(e,t)=>a()(nr.Z,{src:t,style:s.imageBox})}):"initial"===o.type?a()("div",{style:s.initialStyle},void 0,o.firstUpperCasedGrapheme):"icon"===o.type?m.Z.plus(s.avatarIcon):"suspended"===o.type?a()("div",{style:s.suspendedUserStyle},void 0,m.Z.personCrossedOut(s.suspendedUserIconStyle)):void 0),[o,t,n,s]);return a()("div",{style:s.avatarWrapStyle},void 0,a()("div",{style:s.avatarStyle},void 0,r))}function rr(e){const{profilePhoto:t,name:i,email:n}=e;if(t)return{type:"photo",profilePhoto:t};const a=ir.p4(i)[0]||ir.p4(n)[0];return a?{type:"initial",firstUpperCasedGrapheme:a.toUpperCase()}:{type:"icon"}}var lr=i(13490),dr=i(24006);function cr(e){let{title:t,byline:i,settingItem:n}=e;window.__c={n:"GenericSetting"};const o=(0,xe.yK)((e=>({settingContainer:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%"},settingLeft:{width:"60%"},settingTitle:{fontWeight:f.Z.fontWeight.regular},settingByline:{marginBottom:4}})),[]);return a()("div",{style:o.settingContainer},void 0,a()("div",{style:o.settingLeft},void 0,a()(Be.Z,{smallMarginBottom:!0,style:o.settingTitle},void 0,t),a()(Ae.Z,{isSmall:!0,isMultiline:!0,style:o.settingByline},void 0,i)),n)}function ur(e){let{title:t,byline:i,isOn:n,onToggle:o,disabled:s,tooltipForDisabled:r}=e;function l(){s||o()}return a()(We.Z,{placement:We.Z.Placement.Top,alignment:We.Z.Alignment.End,disableTooltip:!r||!s,renderTooltip:()=>r,render:e=>d.createElement("div",e,a()(cr,{title:t,byline:i,settingItem:a()(dr.Z,{on:n,disabled:s,onClick:l})}))})}var mr=i(53471);const pr=(0,v.defineMessages)({uploadFailed:{defaultMessage:"Upload failed.",id:"identityAndProvisioning.managedUsers.modal.failedUpload"}});var gr=i(50501);const hr=(0,v.defineMessages)({getSupportAccessFailed:{defaultMessage:"Failed to load user's support access status.",id:"identityAndProvisioning.managedUsers.table.userAccess.getSupportAccessFailed"},setSupportAccessFailed:{defaultMessage:"Failed to update user's support access status.",id:"identityAndProvisioning.managedUsers.table.userAccess.setSupportAccessFailed"},toastDisabled:{id:"managedUsers.toastMessage.supportAccessDisabled",defaultMessage:"Successfully disabled user's support access status"},toastEnabled:{id:"managedUsers.toastMessage.supportAccessEnabled",defaultMessage:"Successfully disabled user's support access status"}});function fr(e){const{spaceId:t,userId:i}=e,n=(0,v.useIntl)(),a=(0,Pe.O7)(),[o,s]=(0,d.useState)({loading:!1,error:void 0}),[r,l]=(0,d.useState)(void 0),c=(0,Ze.VK)((()=>k.default.checkGate("enable_prevent_granting_support_access")),[]);(0,d.useEffect)((()=>{c&&async function(){const e=await async function(){s({loading:!0,error:void 0});const e=await T.getDataAccessConsentForManagedUser(a,{spaceId:t,userId:i});return"failed"===e.type?(s({loading:!1,error:e.error}),void M.showErrorMessage(n.formatMessage(hr.getSupportAccessFailed))):(s({loading:!1,error:void 0}),e.data.expiryTime)}();l(e)}()}),[a,n,t,i,c]);const u=(0,d.useMemo)((()=>Boolean(r&&Number(r)>Date.now())),[r]),m=(0,d.useCallback)((async()=>{s({loading:!0,error:void 0});const e=u?void 0:Date.now()+gr.g,o=await T.setDataAccessConsentForManagedUser(a,{spaceId:t,userId:i,expiryTime:e});if(b.EfR(a,{new_value:Boolean(e)}),"failed"===o.type)return s({loading:!1,error:o.error}),void M.showErrorMessage(n.formatMessage(hr.setSupportAccessFailed));l(e),e?Ts.oV({label:n.formatMessage(hr.toastEnabled)}):Ts.oV({label:n.formatMessage(hr.toastDisabled)}),s({loading:!1,error:void 0})}),[a,n,t,i,u]);return{isAccessGranted:u,toggleDataAccessConsent:m,loading:o.loading,error:o.error}}function vr(e){window.__c={n:"WorkspacesOverview"};const{userId:t,workspaces:i,spaceStore:n,removeWorkspaceFromUser:o}=e,s=(0,xe.yK)((()=>({container:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",width:"100%",gap:8,marginTop:12}})),[]);return a()("div",{style:s.container},void 0,i.map(((e,s)=>a()(d.Fragment,{},e.id,a()(yr,{userId:t,spaceStore:n,workspace:e,removeWorkspaceFromUser:o}),s<i.length-1?a()(Xo.Z,{size:8}):null))))}function yr(e){window.__c={n:"WorkspaceOverview"};const{userId:t,spaceStore:i,workspace:n,removeWorkspaceFromUser:o}=e,s=(0,v.useIntl)(),r=(0,Pe.O7)(),l=(0,xe.yK)((()=>({container:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between",width:"100%",gap:12,overflow:"hidden"},workspaceContainer:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-start",width:"100%",gap:12,overflow:"hidden"},iconContainer:{alignSelf:"center"},textContainer:{display:"flex",flexDirection:"column",alignItems:"flex-start",justifyContent:"center",width:"100%"},name:{fontSize:14,fontWeight:500},nameUntitled:{fontSize:14,fontWeight:500,opacity:.25},byline:{lineHeight:1.3,fontSize:12,opacity:.5}})),[]),d=(0,Ze.VK)((()=>k.default.checkGate("enable_remove_managed_user_from_space")),[]);const c=n.icon?{pointer:{table:xa.bx,id:n.id,spaceId:n.id},icon:n.icon}:void 0;return a()("div",{style:l.container},void 0,a()("div",{style:l.workspaceContainer},void 0,a()("div",{style:l.iconContainer},void 0,a()(je.Z,{disabled:!0,icon:c,isEmptyPage:!1,size:28,title:n.name,isLarge:!0,emojiSize:24,isRaw:!1})),a()("div",{style:l.textContainer},void 0,a()(Ae.Z,{style:l.name,isMultiline:!0},void 0,a()(Ds,{workspace:n})),a()(Ae.Z,{style:l.byline},void 0,Array.isArray(n.membersCount)?1===n.membersCount.length?a()(v.FormattedMessage,{defaultMessage:"{plan} · {lowerEnd}+ members",id:"identityAndProvisioning.managedUsers.table.userAccess.numMembersLowerEndRange",values:{plan:(0,j.t1)(n.plan,s),lowerEnd:n.membersCount[0]}}):a()(v.FormattedMessage,{defaultMessage:"{plan} · {lowerEnd} - {higherEnd} members",id:"identityAndProvisioning.managedUsers.table.userAccess.numMembersRange",values:{plan:(0,j.t1)(n.plan,s),lowerEnd:n.membersCount[0],higherEnd:n.membersCount[1]}}):a()(v.FormattedMessage,{defaultMessage:"{plan} · {numMembers} {numMembers, plural, one {member} other {members}}",id:"identityAndProvisioning.managedUsers.table.userAccess.numMembers",values:{plan:(0,j.t1)(n.plan,s),numMembers:n.membersCount}}))),a()("div",{},void 0,d?a()(Xe.Z,{isRed:!0,onClick:async function(){b.wVl(r,{external_space_id:n.id});const{accept:e}=await M.confirmUserActionV2({message:a()(Ae.Z,{style:M.dialogStyles.title},void 0,a()(v.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.removeFromWorkspace.confirmation.message",defaultMessage:"Remove user from workspace?"})),description:a()(Ae.Z,{isMultiline:!0,isSecondaryColor:!0},void 0,n.membersCount>1?a()(v.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.removeFromWorkspace.confirmation.description",defaultMessage:"This user will no longer have access to the workspace you are removing them from. This action is not reversible."}):a()(v.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.removeFromWorkspace.confirmation.descriptionWithDeletion",defaultMessage:"This user will no longer have access to the workspace you are removing them from. <b>The workspace will be deleted</b> since this user is the only member. This action is not reversible.",values:{b:e=>a()("b",{},void 0,e)}})),acceptLabel:a()(v.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.removeFromWorkspace.confirmation.acceptLabel",defaultMessage:"Remove"}),cancelLabel:a()(v.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.removeFromWorkspace.confirmation.cancelLabel",defaultMessage:"Go back"})});if(!e)return;const s=await T.removeManagedUserFromSpace(r,{userId:t,targetSpaceId:n.id,requestingSpaceId:i.id});b.dwr(r,{external_space_id:n.id}),"success"===s.type?(o(t,n.id),Ts.oV({label:a()(v.FormattedMessage,{defaultMessage:"Successfully removed user from {workspaceName}",id:"identityAndProvisioning.managedUsers.table.userAccess.removeFromWorkspaceConfirmation",values:{workspaceName:n.name}})})):Ts.oV({label:a()(v.FormattedMessage,{defaultMessage:"Failed to remove user from {workspaceName}",id:"identityAndProvisioning.managedUsers.table.userAccess.removeFromWorkspaceFailure",values:{workspaceName:n.name}})})}},void 0,a()(v.FormattedMessage,{defaultMessage:"Remove",id:"identityAndProvisioning.managedUsers.table.userAccess.removeFromWorkspace"})):null)))}const Sr=(0,v.defineMessages)({namePlaceholder:{defaultMessage:"Display name",id:"identityAndProvisioning.managedUsers.table.userAccess.namePlaceholder"},emailPlaceholder:{defaultMessage:"Email",id:"identityAndProvisioning.managedUsers.table.userAccess.emailPlaceholder"},supportAccessFailed:{defaultMessage:"Failed to load user's support access status.",id:"identityAndProvisioning.managedUsers.table.userAccess.supportAccessFailed"}});function br(e){let{spaceStore:t,managedUser:i,onClose:n,removeWorkspaceFromUser:o}=e;const s=Boolean(i);return a()(us.Z,{open:s,onDismiss:n,preventHideChildrenWhileOpening:!0,render:()=>i?a()(Mr,{spaceStore:t,managedUser:i,removeWorkspaceFromUser:o}):null})}function Mr(e){let{spaceStore:t,managedUser:i,removeWorkspaceFromUser:n}=e;window.__c={n:"ManagedUserDetailsScene"};const o=(0,v.useIntl)(),s=(0,Pe.O7)(),r=(0,Ze.VK)((()=>new He.U6(s,{id:i.userId,table:Qt.KJ})),[i,s]),l=(0,Ze.VK)((()=>t.id),[t]),c=(0,Ze.VK)((()=>k.default.checkGate("enable_prevent_granting_support_access")),[]),{hasStagedChanges:u,resetState:p,saveChanges:g,loading:h,profilePhoto:f,name:y,email:S}=function(e){const{userStore:t}=e,i=(0,v.useIntl)(),n=(0,Pe.O7)(),{userProfilePhoto:o,userName:s,userEmail:r,isSuspended:l}=(0,Ze.VK)((()=>({userProfilePhoto:t.getProfilePhoto(),userName:t.getFullName(i),userEmail:t.getEmail(),isSuspended:t.getIsSuspended()})),[t,i]),[c,u]=(0,d.useState)({loading:!1,error:void 0}),[m,p]=(0,d.useState)({value:o,loading:!1}),[g,h]=(0,d.useState)(s),[f,y]=(0,d.useState)(r);return{hasStagedChanges:m.value!==o||g!==s||f!==r,saveChanges:async function(){var e;const i=null===(e=A.default.state.currentSpaceStore)||void 0===e?void 0:e.id;if(!i)return;const d=[];m.value!==o&&d.push("profile_photo"),g!==s&&d.push("name"),f!==r&&d.push("email"),b.amv(n,{user_status:l?"suspended":"notSuspended",edited_fields:d});const{accept:c}=await M.confirmUserActionV2({message:a()(Ae.Z,{style:M.dialogStyles.title},void 0,a()(v.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.saveProfileChanges.confirmation.message",defaultMessage:"Confirm changes"})),description:a()(Ae.Z,{isMultiline:!0,isSecondaryColor:!0},void 0,a()(v.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.saveProfileChanges.confirmation.description",defaultMessage:"Changes made to this user's account will be reflected across all workspaces they have access to."}),a()("br",{}),a()("br",{}),a()(v.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.saveProfileChanges.confirmation.descriptionForScim",defaultMessage:"If this user is being provisioned through SCIM, your changes be later overwritten by the next SCIM sync."})),acceptLabel:a()(v.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.saveProfileChanges.confirmation.acceptLabel",defaultMessage:"Save changes"}),cancelLabel:a()(v.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.saveProfileChanges.confirmation.cancelLabel",defaultMessage:"Go back"})});if(!c)return;u({loading:!0,error:void 0});const p=await T.updateUserProfile(n,{userId:t.id,spaceId:i,name:g,email:f,profilePhoto:m.value});if(b.$B1(n,{user_status:l?"suspended":"notSuspended",edited_fields:d}),"failed"===p.type)return M.showErrorMessage(p.error.message),void u({loading:!1,error:p.error});Ts.oV({label:a()(v.FormattedMessage,{id:"managedUsers.toastMessage.updateProfileData.success",defaultMessage:"Successfully updated user's profile"})}),setTimeout((()=>{u({loading:!1,error:void 0})}),500)},resetState:function(){p({value:o,loading:!1}),h(s),y(r)},loading:c.loading,error:c.error,profilePhoto:{value:m.value,loading:m.loading,set:function(){mr.cR({environment:n,onStart:()=>{p((e=>({...e,loading:!0})))},bucket:"public",onError:()=>{p((e=>({...e,loading:!1}))),M.showErrorMessage(i.formatMessage(pr.uploadFailed))},onComplete:e=>{const t=e[0];p({value:t,loading:!1})},accept:"image/*"})},remove:function(){p({value:"",loading:!1})}},name:{value:g,set:h},email:{value:f,set:y}}}({userStore:r}),{isAccessGranted:w,toggleDataAccessConsent:C,loading:I}=fr({userId:i.userId,spaceId:l}),P=(0,Ze.VK)((()=>r.getIsSuspended()?{type:"suspended"}:rr({profilePhoto:f.value,name:y.value,email:S.value})),[r,f.value,y.value,S.value]),Z=function(e){const{loadingSupportAccess:t}=e;return(0,xe.yK)((e=>({container:{position:"relative",display:"flex",flexDirection:"column",background:e.popoverBackground,width:420,maxHeight:520,overflow:"hidden",borderRadius:8},innerContainer:{position:"relative",display:"flex",flexDirection:"column",width:"100%",height:"100%",overflowY:"auto",padding:"36px 24px",gap:16},label:{color:e.mediumTextColor},horizontalLabel:{color:e.mediumTextColor,display:"flex",flexDirection:"row",justifyContent:"flex-start",alignItems:"center",gap:4},value:{color:e.regularTextColor},input:{padding:"4px 4px 4px 10px",margin:"0 auto 8px",width:"100%",background:e.modalBackground},avatarContainer:{display:"flex",alignItems:"center",justifyContent:"center",width:"100%"},iconStyle:{border:`1px solid ${e.tableDividerColor}`,color:e.lightTextColor,fontWeight:500},inputContainer:{display:"flex",flexDirection:"column",alignItems:"flex-start",justifyContent:"center",width:"100%",gap:8},inputRow:{display:"flex",flexDirection:"column",alignItems:"flex-start",justifyContent:"center",width:"100%"},icon:{color:e.lightIconColor,fill:"currentColor",width:14,height:14},supportAccessRow:{position:"relative",width:"100%",opacity:t?.5:1},infoContainer:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",width:"100%"},infoRow:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between",width:"100%"},footer:{position:"absolute",display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-end",paddingInline:4,boxShadow:e.borderBoxShadow,background:e.popoverBackground,left:0,right:0,bottom:0,height:48},button:{height:30,marginInline:4}})),[t])}({loadingSupportAccess:I}),x=(0,er.E2)(o),F=(0,Ze.VK)((()=>!Fe.Z.state.online),[]),E=i.mfaMethods.filter((e=>"backup_code"!==e)),B=o.formatList(E.map((e=>(0,_.cR)(e))),{type:"conjunction"});return a()("div",{style:Z.container},void 0,a()("div",{style:Z.innerContainer},void 0,a()("div",{style:Z.avatarContainer},void 0,a()(or,{size:56,avatarType:P,isOffline:F,loading:f.loading,onUploadProfilePhoto:f.set,onRemoveProfilePhoto:f.remove})),a()("div",{style:Z.inputContainer},void 0,a()("div",{style:Z.inputRow},void 0,a()(lr.Z,{},void 0,a()(v.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.details.nameLabel",defaultMessage:"Name"})),a()(Wi.Z,{style:Z.input,disabled:h,value:y.value,placeholder:o.formatMessage(Sr.namePlaceholder),onChange:e=>{y.set(e.target.value)}})),a()("div",{style:Z.inputRow},void 0,a()(lr.Z,{},void 0,a()(v.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.details.emailLabel",defaultMessage:"Email"})),a()(Wi.Z,{style:Z.input,disabled:h,value:S.value,placeholder:o.formatMessage(Sr.emailPlaceholder),onChange:e=>{S.set(e.target.value)}}))),a()("div",{style:Z.infoContainer},void 0,a()("div",{style:Z.infoRow},void 0,a()(Ae.Z,{style:Z.label,isSmall:!0},void 0,a()(v.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.details.accountCreatedLabel",defaultMessage:"Account created"})),i.accountCreatedAt?a()(Ae.Z,{isSmall:!0,style:Z.value},void 0,(0,Hn.Yx)(i.accountCreatedAt,"medium",x)):a()(Ae.Z,{isSecondaryColor:!0,isSmall:!0},void 0,a()(v.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.details.emptyAccountCreated",defaultMessage:"Incomplete"}))),a()(Xo.Z,{size:16}),a()("div",{style:Z.infoRow},void 0,a()(Ae.Z,{style:Z.label,isSmall:!0},void 0,a()(v.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.details.lastActiveLabel",defaultMessage:"Last active"})),i.lastActiveAt?a()(Ae.Z,{isSmall:!0,style:Z.value},void 0,(0,Ue.gs)(i.lastActiveAt)):a()(Ae.Z,{isSecondaryColor:!0,isSmall:!0},void 0,a()(v.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.details.emptyLastActive",defaultMessage:"No activity"}))),a()(Xo.Z,{size:16}),a()("div",{style:Z.infoRow},void 0,a()(Ae.Z,{style:Z.label,isSmall:!0},void 0,a()(v.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.details.mfaLabel",defaultMessage:"MFA"})),E.length>0?a()(Ae.Z,{isSmall:!0,style:Z.value},void 0,B):a()(Ae.Z,{isSecondaryColor:!0,isSmall:!0},void 0,a()(v.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.details.emptyMfa",defaultMessage:"Not configured"}))),c?d.createElement(d.Fragment,null,a()(Xo.Z,{size:16}),a()("div",{style:Z.supportAccessRow},void 0,a()(ur,{title:a()(Ae.Z,{style:Z.horizontalLabel,isSmall:!0},void 0,a()(v.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.details.supportAccessToggleMessage",defaultMessage:"Support access"}),a()(We.Z,{placement:We.Z.Placement.Bottom,render:e=>d.createElement("div",e,m.Z.help(Z.icon)),renderTooltip:()=>a()(v.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.details.supportAccessToggleMessage.tooltip",defaultMessage:"Grant Notion support temporary access to this account so we can troubleshoot problems or recover content on its behalf"})})),byline:null,isOn:w,onToggle:C,disabled:I}))):null),a()("div",{},void 0,i.workspaces.length>0?d.createElement(d.Fragment,null,a()(lr.Z,{},void 0,a()(v.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.details.workspacesLabel",defaultMessage:"Workspaces"})),a()(vr,{userId:i.userId,workspaces:i.workspaces,spaceStore:t,removeWorkspaceFromUser:n})):null)),a()(tr.Z,{isVisible:u||h,enterAnimationStyle:{translateY:48,opacity:0},animationStyle:{opacity:1,translateY:0},exitAnimationStyle:{translateY:48,opacity:0},render:()=>a()("div",{style:Z.footer},void 0,a()(Re.Z,{isRed:!0,disabled:h,style:Z.button,onClick:p},void 0,a()(v.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.details.cancelButton",defaultMessage:"Cancel"})),a()($e.Z,{disabled:h,style:Z.button,onClick:g},void 0,a()(v.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.details.saveButton",defaultMessage:"Save changes"})))}))}function wr(e){let{selectedSpaceId:t,setSelectedSpaceId:i,spaceData:n}=e;window.__c={n:"WorkspacesFilter"};const o=(0,v.useIntl)(),s=(0,xe.yK)((e=>({optionContainer:{display:"flex",flexDirection:"row",alignItems:"center",gap:8},optionTitle:{display:"block"},optionCaption:{display:"block",color:e.mediumTextColor,fontSize:12,lineHeight:"15px"},container:{padding:"6px 0 6px"},footer:{padding:"8px 8px 2px 8px",justifyContent:"space-between",display:"flex"},icon:{width:16,marginRight:6,fill:"currentColor"}})),[]),r=(0,Ze.VK)((()=>n.map((e=>{const t=e.name,i=e.icon?{pointer:{table:xa.bx,id:e.id,spaceId:e.id},icon:e.icon}:void 0;return{key:e.id,value:e.id,title:a()("div",{style:s.optionContainer},void 0,a()(je.Z,{disabled:!0,icon:i,isEmptyPage:!1,size:24,title:t,isLarge:!0,emojiSize:24,isRaw:!1}),a()("div",{style:{paddingTop:4,paddingBottom:4}},void 0,a()(Ae.Z,{style:s.optionTitle},void 0,t),"none"!==e.role?a()(Ae.Z,{style:s.optionCaption},void 0,(0,j.t1)(e.subscriptionTier,o)):null))}}))),[n,o,s]);return a()($s,{pillTitle:a()(v.FormattedMessage,{id:"managedUsersTab.table.filters.workspaces.title",defaultMessage:"Workspace"}),pillIcon:m.Z.settingsWorkspace,selectedItem:t,setSelectedItem:i,items:r})}const Cr=(0,v.defineMessages)({placeholder:{id:"identityProvisioningSettings.managedUsers.searchInput.placeholder",defaultMessage:"Search name, email, or user ID"}});function _r(e){let{spaceStore:t,samlConfigStore:i}=e;window.__c={n:"ManagedUsersPage"};const{navigateTo:n}=(0,d.useContext)(ws),o=(0,Pe.O7)(),s=(0,v.useIntl)(),r=(0,xe.yK)((e=>({link:{fontSize:14,fontWeight:400,color:e.mediumTextColor,textDecoration:"none"},title:{marginTop:21,fontWeight:f.Z.fontWeight.semibold,fontSize:17,display:"flex",justifyContent:"flex-start",alignItems:"center"},byline:{fontSize:14,fontWeight:f.Z.fontWeight.regular,color:e.mediumTextColor,paddingBottom:20},count:{marginLeft:4,opacity:.5,fontWeight:400},tabBarMenu:{margin:"12px 0 0",boxShadow:"none"},filters:{display:"flex",justifyContent:"flex-start",alignItems:"center",width:"100%",margin:"0 auto 12px"}})),[]),l=(0,Ze.VK)((()=>k.default.checkGate("enable_suspend_managed_users")),[]),c=(0,Ze.VK)((()=>i.state.spaceIds.map((e=>_s.Z.getPublicSpaceData(o,e)||void 0)).filter(x.$K)),[i,o]),{managedUsers:u,filters:p,loadNextPage:g,setFilters:h,removeWorkspaceFromUser:y,loading:S,selectedTab:C,setSelectedTab:_,onOpenDetailsModal:I,onCloseDetailsModal:P,selectedUser:Z,managedUserActionSections:F}=function(e){let{spaceStore:t,samlConfigStore:i}=e;const n=(0,Pe.O7)(),o=(0,v.useIntl)(),s=(0,Ze.VK)((()=>k.default.checkGate("enable_suspend_managed_users")),[]),r=(0,Ze.VK)((()=>k.default.checkGate("enable_logout_managed_users")),[]),l=(0,Ze.VK)((()=>k.default.checkGate("enable_password_reset_managed_users")),[]),c=(0,Ze.VK)((()=>k.default.checkGate("enable_delete_managed_users")),[]),[u,p]=(0,d.useState)(),[g,h]=(0,d.useState)(Zs.NotSuspended),f=(0,Ze.VK)((()=>n.currentUser.id),[n]),y=(0,d.useCallback)(((e,t)=>{b.JX1(n,{user_status:xs(g),from:t}),p(e.userId)}),[n,g]),S=Ps({userStatus:"notSuspended",spaceStore:t,samlConfigStore:i}),w=Ps({userStatus:"suspended",spaceStore:t,samlConfigStore:i});let C;C=g===Zs.NotSuspended?S:w;const _=(0,d.useCallback)((async e=>{b.rZG(n);const{accept:i}=await M.confirmUserActionV2({message:a()(Ae.Z,{style:M.dialogStyles.title},void 0,a()(v.FormattedMessage,{defaultMessage:"Suspend this user?",id:"identityAndProvisioning.managedUsers.table.menu.action.suspendUser.dialog.title"})),acceptLabel:a()(v.FormattedMessage,{defaultMessage:"Yes",id:"identityAndProvisioning.managedUsers.table.menu.action.suspendUser.dialog.acceptLabel"}),description:a()(Ae.Z,{isMultiline:!0,isSecondaryColor:!0},void 0,a()(v.FormattedMessage,{defaultMessage:"This user will not be able to log into Notion and their Notion integrations will stop working. They can be unsuspended at any time from the Managed Users dashboard.",id:"identityAndProvisioning.managedUsers.table.menu.action.suspendUser.dialog.description"}))});if(!i)return;const o=await T.updateUserSuspension(n,{userId:e.userId,spaceId:t.id,suspend:!0});b.rvR(n),"failed"===o.type&&M.showErrorMessage(o.error.message),w.addUserToManagedUsers(e),S.removeUserFromManagedUsers(e.userId)}),[n,t.id,w,S]),I=(0,d.useCallback)((async e=>{b.NFM(n);const{accept:i}=await M.confirmUserActionV2({message:a()(Ae.Z,{style:M.dialogStyles.title},void 0,a()(v.FormattedMessage,{defaultMessage:"Log out this user?",id:"identityAndProvisioning.managedUsers.table.menu.action.logoutUser.dialog.title"})),acceptLabel:a()(v.FormattedMessage,{defaultMessage:"Log out user",id:"identityAndProvisioning.managedUsers.table.menu.action.logoutUser.dialog.acceptLabel"}),description:a()(Ae.Z,{isMultiline:!0,isSecondaryColor:!0},void 0,a()(v.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.menu.action.logoutUser.dialog.description",defaultMessage:"You are about to log out this user from their current session. They will need to re-authenticate to log back into Notion."}))});if(!i)return;const o=await T.logoutManagedUsers(n,{spaceId:t.id,target:{type:ks.User,userId:e.userId}});if(b._mq(n),"failed"===o.type)return M.showErrorMessage(o.error.message),void Ts.oV({label:a()(v.FormattedMessage,{id:"managedUsers.toastMessage.logout.failed",defaultMessage:"Failed to logged out user"})});Ts.oV({label:a()(v.FormattedMessage,{id:"managedUsers.toastMessage.logout.success",defaultMessage:"Successfully logged out user"})})}),[n,t.id]),P=(0,d.useCallback)((async e=>{b.Zm$(n);const{accept:i}=await M.confirmUserActionV2({message:a()(Ae.Z,{style:M.dialogStyles.title},void 0,a()(v.FormattedMessage,{defaultMessage:"Reset password for this user?",id:"identityAndProvisioning.managedUsers.table.menu.action.forcePasswordReset.dialog.title"})),acceptLabel:a()(v.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.menu.action.forcePasswordReset.dialog.acceptLabel",defaultMessage:"Reset passwords for user"}),description:a()(Ae.Z,{isMultiline:!0,isSecondaryColor:!0},void 0,a()(v.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.menu.action.forcePasswordReset.dialog.description",defaultMessage:"You are about to reset the password for this user. This will also remove any 2-step verification settings they might have and they will be logged out of of their current session.{br}{br}This user will need to re-authenticate via their email the next time they attempt to log back into Notion, and they will be prompted to set a new password upon logging in.",values:{br:a()("br",{})}}))});if(!i)return;const s=await T.resetPasswordsForManagedUsers(n,{spaceId:t.id,target:{type:ks.User,userId:e.userId}});if(b.vCG(n),"failed"===s.type)return M.showErrorMessage((0,kn.wf)(o,s)),void Ts.oV({label:a()(v.FormattedMessage,{id:"managedUsers.toastMessage.forcePasswordReset.fail",defaultMessage:"Failed to reset password for user"})});Ts.oV({label:a()(v.FormattedMessage,{id:"managedUsers.toastMessage.forcePasswordReset.success",defaultMessage:"Successfully reset password for user"})})}),[n,o,t.id]),Z=(0,d.useCallback)((async e=>{const i=await T.updateUserSuspension(n,{userId:e.userId,spaceId:t.id,suspend:!1});b.Cis(n),"failed"===i.type&&M.showErrorMessage(i.error.message),w.removeUserFromManagedUsers(e.userId),S.addUserToManagedUsers(e)}),[n,t.id,w,S]),F=(0,d.useCallback)((async e=>{b.P1A(n,{user_status:xs(g)});const{accept:i}=await M.confirmUserActionV2({message:a()(Ae.Z,{style:M.dialogStyles.title},void 0,a()(v.FormattedMessage,{defaultMessage:"Delete this user?",id:"identityAndProvisioning.managedUsers.table.menu.action.deleteUser.dialog.title"})),acceptLabel:a()(v.FormattedMessage,{defaultMessage:"Yes",id:"identityAndProvisioning.managedUsers.table.menu.action.deleteUser.dialog.acceptLabel"}),description:a()(Ae.Z,{isMultiline:!0,isSecondaryColor:!0},void 0,a()(v.FormattedMessage,{defaultMessage:"This will delete the user's data. They can still be restored within 30 days by contacting Notion support.",id:"identityAndProvisioning.managedUsers.table.menu.action.deleteUser.dialog.description"}))});if(!i)return;const o=await T.deleteManagedUser(n,{userId:e.userId,spaceId:t.id});b.j72(n,{user_status:xs(g)}),"failed"===o.type&&M.showErrorMessage(o.error.message),w.removeUserFromManagedUsers(e.userId),S.removeUserFromManagedUsers(e.userId)}),[n,g,t.id,w,S]),A=(0,d.useMemo)((()=>C.managedUsers.find((e=>{let{userId:t}=e;return t===u}))),[u,C.managedUsers]),E=(0,d.useMemo)((()=>{let e;const t={onClick:e=>y(e,"dropdown_menu"),icon:m.Z.pencil,title:a()(v.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.menu.action.userDetails",defaultMessage:"Edit details"})},i={onClick:e=>F(e),icon:m.Z.trash,title:a()(v.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.menu.action.deleteUser",defaultMessage:"Delete user"}),isDestructive:!0};switch(g){case Zs.NotSuspended:e=[[t,...r?[{onClick:I,icon:m.Z.logout,title:a()(v.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.menu.action.logout",defaultMessage:"Log out"})}]:[],...l?[{onClick:P,icon:m.Z.setPassword,title:a()(v.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.menu.action.passwordReset",defaultMessage:"Reset password"})}]:[]],[...s?[{onClick:_,icon:m.Z.handWave,title:a()(v.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.menu.action.suspendUser",defaultMessage:"Suspend user"}),getDisabledState:e=>e.userId===f}]:[],...c?[i]:[]]];break;case Zs.Suspended:e=s?[[t],[{onClick:e=>Z(e),icon:m.Z.showDeletedPages,title:a()(v.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.menu.action.unSuspendUser",defaultMessage:"Reactivate user"})},...c?[i]:[]]]:[];break;default:(0,x.t1)(g)}return e.filter((e=>e.length>0))}),[y,f,l,r,s,c,g,F,_,Z,I,P]);return{...C,selectedTab:g,setSelectedTab:h,selectedUser:A,managedUserActionSections:E,onOpenDetailsModal:y,onCloseDetailsModal:function(){p(void 0)}}}({spaceStore:t,samlConfigStore:i}),A=(0,d.useCallback)((e=>I(e,"row_click")),[I]);return a()(Ee.Z,{},void 0,a()(Jo.Z,{style:r.link,onClick:()=>n(ys)},void 0,a()(v.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.breadcrumb",defaultMessage:"← Identity & Provisioning"})),a()(Be.Z,{large:!0,style:r.title},void 0,a()(v.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.title",defaultMessage:"User management"}),a()(Bt.Z,{icon:m.Z.help,ariaLabel:s.formatMessage({defaultMessage:"Managed users settings help button",id:"identityProvisioningSettings.managedUsers.helpButton.label"}),onClick:()=>w.navigateToExternalURL({environment:o,url:(0,H.UY)("guides.managedUsers")})})),a()(Ae.Z,{isSmall:!0,isMultiline:!0,style:r.byline},void 0,a()(v.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.byline",defaultMessage:"Manage and view users that are using your verified domains"})),l?a()(ts.Z,{tabs:[a()(v.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.table.notSuspendedTab.title",defaultMessage:"Active"},"notSuspended.title"),a()(v.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.table.suspendedTab.title",defaultMessage:"Suspended"},"suspended")],selectedIndex:C,onChange:e=>_(e),style:r.tabBarMenu}):null,a()(on,{mode:nn.Button,query:p.query,setQueryFilter:e=>{h({query:e})},placeholderText:z.default.formatMessage(Cr.placeholder)}),a()("div",{style:r.filters},void 0,a()(wr,{selectedSpaceId:p.workspaceId,setSelectedSpaceId:e=>{h({workspaceId:e})},spaceData:c}),a()(Xs,{selectedMfaMethod:p.multiFactorStatus,setSelectedMfaMethod:e=>{h({multiFactorStatus:e})}})),a()(Qs,{managedUsers:u,loading:S,loadMoreManagedUsers:g,onEditDetails:A,managedUserActionSections:F},C),a()(br,{spaceStore:t,managedUser:Z,onClose:P,removeWorkspaceFromUser:y}))}function kr(e){let{environment:t,samlConfigStore:i}=e;const n=i.state.emailDomains.length>0,a=(0,Q.zt)();return n||("business"===a||"enterprise"===a)}async function Tr(e){let{onRequest:t,onSuccess:i}=e;const n=await t();switch(n.type){case"success":i&&await i(n);break;case"failed":M.showErrorMessage(n.error.message);break;default:(0,x.t1)(n)}}function Ir(e){let{spaceStore:t,samlConfigStore:i,domainSettingsStore:n}=e;const a=(0,Pe.O7)(),o=(0,Ze.VK)((()=>i.state.emailDomains),[i]),s=(0,Ze.VK)((()=>"disabled"!==i.state.status&&"unconfigured"!==i.state.status),[i]),r=(0,Ze.VK)((()=>kr({environment:a,samlConfigStore:i})),[i,a]),l=(0,Ze.VK)((()=>r&&(!i.state.id||i.state.id===t.id)),[r,i,t]),c=(0,Ze.VK)((()=>n.state.emailDomains.length>0&&(0,Q.wP)()),[n]),u=(0,Ze.VK)((()=>o.length>0),[o]),m=(0,d.useCallback)((async()=>{if(i.state.emailDomains.length>0)return Tr({onRequest:()=>T.updateWorkspaceCreationForEmailDomains(a,{emailDomains:i.state.emailDomains,workspaceCreationEnum:n.state.spaceCreation,spaceId:t.id}),onSuccess:()=>{n.setState({...n.state,emailDomains:i.state.emailDomains})}})}),[a,t,n,i]),p=(0,d.useCallback)((async()=>{if(i.state.emailDomains.length>0)return Tr({onRequest:()=>T.updateEmailDomainSettings(a,{emailDomains:i.state.emailDomains,spaceId:t.id,preventProfileEdits:n.state.settings.prevent_profile_edits,preventMembersJoiningExternalWorkspace:n.state.settings.prevent_members_joining_external_workspace,customSessionDuration:Bs(n.state.settings.custom_session_duration),preventGrantingSupportAccess:n.state.settings.prevent_granting_support_access}),onSuccess:()=>{n.setState({...n.state,emailDomains:i.state.emailDomains})}})}),[a,t,n,i]),g=(0,Ze.VK)((()=>r&&(0,Q.wP)()),[r]);return{verifiedDomains:o,isSamlStatusEnabled:s,isSamlAvailable:r,isSamlEditable:l,isDomainSettingsAvailable:c,isClaimSpacesAvailable:g,canSaveWorkspaceCreationSetting:u,saveWorkspaceCreationSetting:m,saveEmailDomainSettings:p}}var Pr=i(1865),Zr=i(91718);function xr(e){let{title:t,byline:i,targetTier:n}=e;window.__c={n:"Upsell"};const o=(0,Pe.O7)(),s=(0,d.useCallback)((()=>Pr.y(o,{from:"space_saml",for:n})),[o,n]);return d.createElement(d.Fragment,null,a()(Be.Z,{smallMarginBottom:!0,style:{fontWeight:f.Z.fontWeight.regular,display:"flex",alignItems:"center"}},void 0,a()("span",{style:{marginRight:8}},void 0,t),a()(Zr.Z,{subscriptionTier:n,analyticsName:"space_saml",onClick:s})),a()(Ae.Z,{isSmall:!0,isMultiline:!0},void 0,i))}const Fr={browseWorkspaces:a()(v.FormattedMessage,{defaultMessage:"Browse workspaces",id:"identityAndProvisioning.claimWorkspaces.button"}),noWorkspaces:a()(v.FormattedMessage,{defaultMessage:"No workspaces",id:"identityAndProvisioning.claimWorkspaces.buttonEmpty"}),loadingError:a()(v.FormattedMessage,{defaultMessage:"Error loading workspaces.",id:"identityAndProvisioning.claimWorkspaces.errorByline"})};function Ar(e){let{promptUpgrade:t}=e;window.__c={n:"ClaimSpaces"};const{navigateTo:i,loadingSpaces:n,hasBrowsableSpaces:o,errorClaimableSpaces:r}=(0,d.useContext)(ws),l=Boolean(r),c=!o||n,u=!o&&!n,m=a()(v.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.title",defaultMessage:"Claim workspaces"}),p=a()(v.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.message",defaultMessage:"Claim workspaces created by users with a verified domain or require owners to use an external domain."}),g=(0,xe.yK)((e=>({settingContainer:{margin:"18px 0"},buttonAndErrorContainer:{display:"flex",flexDirection:"column",maxWidth:280},button:{opacity:c?.5:1,minWidth:160},settingErrorByline:{color:e.errorText,marginTop:8,fontSize:13}})),[c]);if(t)return a()(xr,{title:m,byline:p,targetTier:"enterprise"});let h;return h=n?a()(Ve.Z,{}):o?Fr.browseWorkspaces:Fr.noWorkspaces,a()("div",{style:g.settingContainer},void 0,a()(cr,{title:m,byline:p,settingItem:a()("div",{style:g.buttonAndErrorContainer},void 0,a()(We.Z,{placement:We.Z.Placement.Top,alignment:We.Z.Alignment.End,render:e=>d.createElement(Re.Z,s()({disabled:c,isLarge:!0,style:g.button,onClick:()=>i(Ss)},e),h),disableTooltip:!u,renderTooltip:()=>a()(v.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.tooltip",defaultMessage:"There are no available workspaces to claim"})}),l?a()(Ae.Z,{isSmall:!0,isMultiline:!0,style:g.settingErrorByline},void 0,Fr.loadingError):null)}))}var Er=i(52507),Br=i(47478);function Dr(e){let{spaceStore:t,samlConfigStore:i,promptUpgrade:n,disabled:o,saveWorkspaceCreationSetting:s}=e;window.__c={n:"EmailDomains"};const r=(0,Pe.O7)(),l=(0,Ze.qz)(void 0,Er.ZP),c=(0,xe.yK)((()=>({flex:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",margin:"18px 0px"},button:{position:"relative",marginLeft:"auto",marginRight:0,opacity:o?.5:1},plusIcon:{width:14,height:14,fill:"inherit",marginRight:"6px"}})),[o]),u=a()(v.FormattedMessage,{id:"identityAndProvisioning.emailDomainsSection.title",defaultMessage:"Verified domains"}),p=a()(v.FormattedMessage,{id:"identityAndProvisioning.emailDomainsSection.byline",defaultMessage:"Verify ownership of an email domain to access advanced security features including single-sign on."}),g=[...(0,Ze.VK)((()=>i.state.emailDomains.map(Br.f4)),[i]),...(0,Ze.VK)((()=>i.state.domainVerifications.filter((e=>!i.state.emailDomains.includes(e.domain))).sort(((e,t)=>e.createdAt-t.createdAt)).map(Br.UV)),[i])],h=(0,d.useCallback)((async()=>{await vs({environment:r,spaceId:t.id,store:i})}),[r,t,i]),{resetInitialClaimableSpaces:y}=(0,d.useContext)(ws),S=(0,d.useCallback)((async e=>{switch(e.type){case"verified":return Tr({onRequest:()=>T.setSamlConfig(r,{spaceId:t.id,removedEmailDomains:[e.domain]}),onSuccess:async()=>{await h(),y()}});case"unverified":case"invalid":return Tr({onRequest:()=>T.deleteDomainVerificationCode(r,{id:e.id}),onSuccess:()=>h()})}}),[r,t,h,y]),b=(0,d.useCallback)((()=>Tr({onRequest:()=>T.setSamlConfig(r,{spaceId:t.id}),onSuccess:()=>h()})),[r,h,t]),M=(0,d.useCallback)((async()=>{await h(),await s()}),[s,h]);return n?a()(xr,{title:u,byline:p,targetTier:"business"}):a()(Br.ZP,{disabled:o,domains:g,onRemoveDomain:S,domainVerificationStore:l,verificationType:"saml_config",verificationTargetId:t.id,refreshDomains:M,onClickAddDomain:b,renderOverrideAddDomainButton:e=>a()("div",{style:c.flex},void 0,a()("div",{},void 0,a()(Be.Z,{smallMarginBottom:!0,style:{fontWeight:f.Z.fontWeight.medium}},void 0,u),a()(Ae.Z,{isSmall:!0,isMultiline:!0,style:{marginBottom:4}},void 0,p)),a()("div",{},void 0,a()(Xe.Z,{isBlue:!0,style:c.button,icon:e=>m.Z.plus({...e,...c.plusIcon}),disabled:o,onClick:e},void 0,a()(v.FormattedMessage,{defaultMessage:"Add domain",id:"securitySAMLSettings.emailDomainsSection.addDomain"}))))})}function Rr(e){let{domainSettingsStore:t,samlConfigStore:i,disabled:n,promptUpgrade:o,verifiedDomains:r,tooltip:l,saveWorkspaceCreationSetting:c}=e;window.__c={n:"WorkspaceCreation"};const u=(0,Pe.O7)(),m=(0,xe.yK)((()=>({settingContainer:{margin:"18px 0"}})),[]),p=(0,Ze.VK)((()=>{const e=i.state.id;if(!e)return;return new He.H2(u,{table:xa.bx,id:e}).getName()}),[u,i]),g=(0,d.useCallback)((async e=>{t.setState({...t.state,spaceCreation:e}),await c(),b.tir(u,{workspace_creation:e})}),[t,c,u]),h=(0,Ze.VK)((()=>r.length>0?t.state.spaceCreation:"admins_only"),[t,r]),f=a()(v.FormattedMessage,{id:"domainSettings.workspaceCreation.title",defaultMessage:"Workspace creation"}),y=a()(v.FormattedMessage,{id:"domainSettings.workspaceCreation.byline",defaultMessage:"Customize who can create new workspaces."}),S=a()(v.FormattedMessage,{id:"domainSettings.workspaceCreation.workspaceOwnersOnly.titleWithSpaceName",defaultMessage:"{primaryWorkspaceName} workspace owners",values:{primaryWorkspaceName:p}}),M=a()(v.FormattedMessage,{id:"domainSettings.workspaceCreation.workspaceOwnersOnly.title",defaultMessage:"Only workspace owners"});return o?a()("div",{style:m.settingContainer},void 0,a()(xr,{title:f,byline:y,targetTier:"enterprise"})):a()(We.Z,{placement:We.Z.Placement.Top,alignment:We.Z.Alignment.End,render:e=>d.createElement("div",s()({},e,{style:m.settingContainer}),a()(es.Z,{isMobile:u.device.isMobile,disabled:n,title:f,caption:y,type:"dropdown",currentOption:h,options:[{key:"unrestricted",label:a()(v.FormattedMessage,{id:"domainSettings.workspaceCreation.unrestricted.title",defaultMessage:"Anyone"}),caption:a()(v.FormattedMessage,{id:"domainSettings.workspaceCreation.unrestricted.caption",defaultMessage:"Any user can create new workspaces."})},{key:"admins_only",label:p?S:M,caption:a()(v.FormattedMessage,{id:"domainSettings.workspaceCreation.workspaceOwnersOnly.captionWithSpaceName",defaultMessage:"Only workspace owners of this workspace can create new workspaces."})}],onSelectOption:g})),disableTooltip:!l,renderTooltip:()=>l})}function Lr(e){let{spaceStore:t,samlConfigStore:i,domainSettingsStore:n,isCurrentSpaceEnterprise:o}=e;window.__c={n:"DomainSection"};const{verifiedDomains:s,isSamlAvailable:r,saveWorkspaceCreationSetting:l,isSamlEditable:c,isDomainSettingsAvailable:u,canSaveWorkspaceCreationSetting:m,isClaimSpacesAvailable:p}=Ir({spaceStore:t,samlConfigStore:i,domainSettingsStore:n}),g=u&&c;return d.createElement(d.Fragment,null,a()(Dr,{disabled:!c,promptUpgrade:!r,spaceStore:t,samlConfigStore:i,saveWorkspaceCreationSetting:l}),a()(Rr,{disabled:!g||!m,promptUpgrade:!o,verifiedDomains:s,samlConfigStore:i,domainSettingsStore:n,tooltip:0===s.length?a()(v.FormattedMessage,{id:"domainSettings.workspaceCreation.disabledTooltip",defaultMessage:"There must be at least one verified domain to configure the workspace creation setting."}):void 0,saveWorkspaceCreationSetting:l}),a()(Ar,{promptUpgrade:!p}))}var Nr=i(74523);function Or(e){let{domainSettingsStore:t,saveEmailDomainSettings:i,promptUpgrade:n,disabled:o}=e;window.__c={n:"CustomSessionDurationSetting"};const s=(0,Pe.O7)(),r=(0,xe.yK)((()=>({settingContainer:{margin:"18px 0"},settingsTitle:{display:"inline-flex",alignItems:"center"}})),[]),l=(0,d.useMemo)((()=>Object.entries(Za.nb).map((e=>{let[t,i]=e;return{key:t,label:a()(Ae.Z,{},void 0,(0,Ue.hH)(0,i))}}))),[]),c=(0,Ze.VK)((()=>Bs(t.state.settings.custom_session_duration)??Za.gl),[t]),u=a()(v.FormattedMessage,{id:"identityAndProvisioning.managedUsers.customSessionDuration.title",defaultMessage:"Session duration"}),m=a()(v.FormattedMessage,{id:"identityAndProvisioning.managedUsers.customSessionDuration.message",defaultMessage:"Control how long your managed users can be logged in for before they must re-authenticate."});return a()("div",{style:r.settingContainer},void 0,n?a()(xr,{title:u,byline:m,targetTier:"enterprise"}):a()(es.Z,{isMobile:s.device.isMobile,disabled:o,title:u,caption:m,type:"dropdown",currentOption:c,options:l,onSelectOption:async function(e){const n=t.state.settings.custom_session_duration??Za.nb[Za.gl],o=Za.nb[e];if(void 0===o)return;b.LOF(s,{custom_session_duration_ms:n});const{accept:r}=await M.confirmUserActionV2({message:a()(Ae.Z,{style:M.dialogStyles.title},void 0,a()(v.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.customSessionDuration.confirmation.message",defaultMessage:"Confirm change"})),description:a()(Ae.Z,{isMultiline:!0,isSecondaryColor:!0},void 0,a()(v.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.customSessionDuration.confirmation.description",defaultMessage:"You are about to change the session duration for all of your managed users from <b>{oldDuration}</b> to <b>{newDuration}.</b>",values:{oldDuration:(0,Ue.hH)(0,n),newDuration:(0,Ue.hH)(0,o),b:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return a()("b",{},void 0,t)}}}),a()("br",{}),a()("br",{}),a()(v.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.customSessionDuration.confirmation.secondDescription",defaultMessage:"This may log some users out of their current session, including you. The affected users will need to re-authenticate to log back into Notion."})),acceptLabel:a()(v.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.customSessionDuration.confirmation.acceptLabel",defaultMessage:"Confirm change"}),cancelLabel:a()(v.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.customSessionDuration.confirmation.cancelLabel",defaultMessage:"Cancel"})});r&&(t.setState({...t.state,settings:{...t.state.settings,custom_session_duration:o}}),b.l0P(s,{new_session_duration_ms:o}),await i())}}))}function Vr(e){let{spaceId:t,domainSettingsStore:i,promptUpgrade:n,verifiedDomains:o,disabled:r}=e;window.__c={n:"ForcePasswordResetSetting"};const l=o.length>0,c=(0,Pe.O7)(),u=(0,xe.yK)((()=>({settingContainer:{margin:"18px 0"},buttonAndErrorContainer:{display:"flex",flexDirection:"column",maxWidth:280},button:{opacity:!r&&l?1:.5}})),[r,l]),m=a()(v.FormattedMessage,{id:"identityAndProvisioning.managedUsers.forcePasswordReset.title",defaultMessage:"Reset passwords for all users"}),p=a()(v.FormattedMessage,{id:"identityAndProvisioning.managedUsers.forcePasswordReset.message",defaultMessage:"Force reset the passwords for all managed users and require them to a new one the next time they log in."});async function g(){b.JoV(c,{email_domains:o});const{accept:e}=await M.confirmUserActionV2({message:a()(Ae.Z,{style:M.dialogStyles.title},void 0,a()(v.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.forcePasswordReset.confirmation.message",defaultMessage:"Reset passwords for your managed users?"})),description:a()(Ae.Z,{isMultiline:!0,isSecondaryColor:!0},void 0,a()(v.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.forcePasswordReset.confirmation.description",defaultMessage:"You are about to reset the passwords for of your managed users, including you. This will also remove any 2-step verification settings they might have and they will be logged out of of their current session.{br}{br}The affected users will need to re-authenticate via their email the next time they attempt to log back into Notion, and they will be prompted to set a new password upon logging in.",values:{br:a()("br",{})}})),acceptLabel:a()(v.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.forcePasswordReset.confirmation.acceptLabel",defaultMessage:"Reset passwords for all managed users"}),cancelLabel:a()(v.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.forcePasswordReset.confirmation.cancelLabel",defaultMessage:"Cancel"})});if(!e)return;const n=i.state.emailDomains;await T.resetPasswordsForManagedUsers(c,{spaceId:t,target:{type:ks.Domains,emailDomains:n}}),Ts.oV({label:a()(v.FormattedMessage,{id:"managedUsers.toastMessage.forcePasswordReset.all.success",defaultMessage:"Successfully reset passwords for all managed users"})}),b.aT6(c,{email_domains:n})}return a()("div",{style:u.settingContainer},void 0,n?a()(xr,{title:m,byline:p,targetTier:"enterprise"}):a()(cr,{title:m,byline:p,settingItem:a()("div",{style:u.buttonAndErrorContainer},void 0,a()(We.Z,{placement:We.Z.Placement.Top,alignment:We.Z.Alignment.End,render:e=>d.createElement(Xe.Z,s()({isRed:!0,disabled:r||!l,style:u.button,onClick:g},e),a()(v.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.forcePasswordReset.logoutButton",defaultMessage:"Reset passwords for all users"})),disableTooltip:l,renderTooltip:()=>a()(v.FormattedMessage,{id:"identityAndProvisioning.managedUsers.tooltip",defaultMessage:"You must verify a domain to manage its users"})}))}))}function Ur(e){let{spaceId:t,domainSettingsStore:i,promptUpgrade:n,verifiedDomains:o,disabled:r}=e;window.__c={n:"LogoutUsersSetting"};const l=o.length>0,c=(0,Pe.O7)(),u=(0,xe.yK)((()=>({settingContainer:{margin:"18px 0"},buttonAndErrorContainer:{display:"flex",flexDirection:"column",maxWidth:280},button:{opacity:!r&&l?1:.5}})),[r,l]),m=a()(v.FormattedMessage,{id:"identityAndProvisioning.managedUsers.logoutAllUsers.title",defaultMessage:"Log out all users"}),p=a()(v.FormattedMessage,{id:"identityAndProvisioning.managedUsers.logoutAllUsers.message",defaultMessage:"Force log out all managed users and require them to re-authenticate."});async function g(){b.KFD(c,{email_domains:o});const{accept:e}=await M.confirmUserActionV2({message:a()(Ae.Z,{style:M.dialogStyles.title},void 0,a()(v.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.logoutAllUsers.confirmation.message",defaultMessage:"Log out all of your managed users?"})),description:a()(Ae.Z,{isMultiline:!0,isSecondaryColor:!0},void 0,a()(v.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.logoutAllUsers.confirmation.description",defaultMessage:"You are about to log all of your managed users out of their current session, including you. The affected users will need to re-authenticate to log back into Notion."})),acceptLabel:a()(v.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.logoutAllUsers.confirmation.acceptLabel",defaultMessage:"Log out all managed users"}),cancelLabel:a()(v.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.logoutAllUsers.confirmation.cancelLabel",defaultMessage:"Cancel"})});if(!e)return;const n=i.state.emailDomains;await T.logoutManagedUsers(c,{spaceId:t,target:{type:ks.Domains,emailDomains:n}}),Ts.oV({label:a()(v.FormattedMessage,{id:"managedUsers.toastMessage.logout.all.success",defaultMessage:"Successfully logged out all managed users"})}),b._6M(c,{email_domains:n})}return a()("div",{style:u.settingContainer},void 0,n?a()(xr,{title:m,byline:p,targetTier:"enterprise"}):a()(cr,{title:m,byline:p,settingItem:a()("div",{style:u.buttonAndErrorContainer},void 0,a()(We.Z,{placement:We.Z.Placement.Top,alignment:We.Z.Alignment.End,render:e=>d.createElement(Xe.Z,s()({isRed:!0,disabled:r||!l,style:u.button,onClick:g},e),a()(v.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.logoutAllUsers.logoutButton",defaultMessage:"Log out all users"})),disableTooltip:l,renderTooltip:()=>a()(v.FormattedMessage,{id:"identityAndProvisioning.managedUsers.tooltip",defaultMessage:"You must verify a domain to manage its users"})}))}))}function Wr(e){let{promptUpgrade:t,hasVerifiedDomains:i,disabled:n}=e;window.__c={n:"ManageUsersButton"};const{navigateTo:o}=(0,d.useContext)(ws),r=(0,Pe.O7)(),l=a()(v.FormattedMessage,{id:"identityAndProvisioning.managedUsers.title",defaultMessage:"Managed users dashboard"}),c=a()(v.FormattedMessage,{id:"identityAndProvisioning.managedUsers.message",defaultMessage:"Manage and view users that are using your verified domains"}),u=(0,xe.yK)((e=>({settingContainer:{margin:"18px 0"},buttonAndErrorContainer:{display:"flex",flexDirection:"column",maxWidth:280},button:{opacity:!n&&i?1:.5}})),[i,n]);return a()("div",{style:u.settingContainer},void 0,t?a()(xr,{title:l,byline:c,targetTier:"enterprise"}):a()(cr,{title:l,byline:c,settingItem:a()("div",{style:u.buttonAndErrorContainer},void 0,a()(We.Z,{placement:We.Z.Placement.Top,alignment:We.Z.Alignment.End,render:e=>d.createElement(Re.Z,s()({disabled:n||!i,isLarge:!0,style:u.button,onClick:()=>{b.pCf(r),o(bs)}},e),a()(v.FormattedMessage,{defaultMessage:"View dashboard",id:"identityAndProvisioning.managedUsers.button"})),disableTooltip:i,renderTooltip:()=>a()(v.FormattedMessage,{id:"identityAndProvisioning.managedUsers.tooltip",defaultMessage:"You must verify a domain to manage its users"})}))}))}function Kr(e){let{domainSettingsStore:t,saveEmailDomainSettings:i,promptUpgrade:n,verifiedDomains:o,disabled:s}=e;window.__c={n:"PreventGrantingSupportAccessSetting"};const r=(0,Pe.O7)(),l=(0,xe.yK)((()=>({settingContainer:{margin:"18px 0"},settingsTitle:{display:"inline-flex",alignItems:"center"}})),[]),d=o.length>0,c=(0,Ze.VK)((()=>k.default.checkGate("enable_prevent_granting_support_access")),[]),u=(0,Ze.VK)((()=>Boolean(t.state.settings.prevent_granting_support_access)),[t]),m=a()(v.FormattedMessage,{id:"identityAndProvisioning.managedUsers.preventGrantingSupportAccess.title",defaultMessage:"Prevent managed users from granting support access"}),p=a()(v.FormattedMessage,{id:"identityAndProvisioning.managedUsers.preventGrantingSupportAccess.message",defaultMessage:"Control if managed users can enable support access on their accounts."});return a()("div",{style:l.settingContainer},void 0,n?a()(xr,{title:m,byline:p,targetTier:"enterprise"}):c?a()(ur,{title:a()("div",{style:l.settingsTitle},void 0,m),byline:p,isOn:u,onToggle:async function(){const e=Boolean(!t.state.settings.prevent_granting_support_access);t.setState({...t.state,settings:{...t.state.settings,prevent_granting_support_access:e}}),b.DnI(r,{new_value:e}),await i()},disabled:s||!d}):null)}function zr(e){let{domainSettingsStore:t,saveEmailDomainSettings:i,promptUpgrade:n,disabled:o}=e;window.__c={n:"PreventMembersJoiningExternalSpaces"};const s=(0,Pe.O7)(),r=(0,xe.yK)((()=>({settingContainer:{margin:"18px 0"},settingsTitle:{display:"inline-flex",alignItems:"center"}})),[]),l=(0,Ze.VK)((()=>Boolean(t.state.settings.prevent_members_joining_external_workspace)),[t]),d=a()(v.FormattedMessage,{id:"identityAndProvisioning.managedUsers.preventMembersJoiningExternalSpaces.title",defaultMessage:"External workspace access"}),c=a()(v.FormattedMessage,{id:"identityAndProvisioning.managedUsers.preventMembersJoiningExternalSpaces.message",defaultMessage:"Control if managed users are able to join workspaces that not owned by your organization."});if(n)return a()("div",{style:r.settingContainer},void 0,a()(xr,{title:d,byline:c,targetTier:"enterprise"}));const u=l?"on":"off";return a()("div",{style:r.settingContainer},void 0,a()(es.Z,{isMobile:s.device.isMobile,disabled:o,title:d,caption:c,type:"dropdown",currentOption:u,options:[{key:"on",label:a()(v.FormattedMessage,{id:"identityAndProvisioning.managedUsers.externalSpacePrevention.enabled.titleGeneric",defaultMessage:"Only workspace owners"}),caption:a()(v.FormattedMessage,{id:"identityAndProvisioning.managedUsers.externalSpacePrevention.enabled.caption",defaultMessage:"Only workspace owners of your connected workspaces can join external workspaces."})},{key:"off",label:a()(v.FormattedMessage,{id:"identityAndProvisioning.managedUsers.externalSpacePrevention.disabled.titleWithSpaceName",defaultMessage:"Anyone"}),caption:a()(v.FormattedMessage,{id:"identityAndProvisioning.managedUsers.externalSpacePrevention.disabled.caption",defaultMessage:"All users can join any workspace."})}],onSelectOption:async function(){const e=Boolean(!t.state.settings.prevent_members_joining_external_workspace);t.setState({...t.state,settings:{...t.state.settings,prevent_members_joining_external_workspace:e}}),b.T4J(s,{new_value:e}),await i()}}))}function Gr(e){let{domainSettingsStore:t,saveEmailDomainSettings:i,promptUpgrade:n,hasVerifiedDomains:o,disabled:s}=e;window.__c={n:"PreventProfileEditsSetting"};const r=(0,Pe.O7)(),l=(0,xe.yK)((()=>({settingContainer:{margin:"18px 0"},settingsTitle:{display:"inline-flex",alignItems:"center"}})),[]),d=(0,Ze.VK)((()=>k.default.checkGate("enable_set_email_domain_settings")),[]),c=(0,Ze.VK)((()=>Boolean(t.state.settings.prevent_profile_edits)),[t]),u=a()(v.FormattedMessage,{id:"identityAndProvisioning.managedUsers.preventProfileEdits.title",defaultMessage:"Allow managed users to change profile information"}),m=a()(v.FormattedMessage,{id:"identityAndProvisioning.managedUsers.preventProfileEdits.message",defaultMessage:"Control if managed users can change their preferred name, email address, and profile photo."});return a()("div",{style:l.settingContainer},void 0,n?a()(xr,{title:u,byline:m,targetTier:"enterprise"}):d?a()(ur,{title:a()("div",{style:l.settingsTitle},void 0,u),byline:m,isOn:!c,onToggle:async function(){const e=Boolean(!t.state.settings.prevent_profile_edits);t.setState({...t.state,settings:{...t.state.settings,prevent_profile_edits:e}}),b.DnI(r,{new_value:e}),await i()},disabled:s||!o}):null)}function qr(e){let{spaceStore:t,samlConfigStore:i,domainSettingsStore:n}=e;window.__c={n:"ManagedUsersSection"};const{verifiedDomains:o,isDomainSettingsAvailable:s,isSamlEditable:r,saveEmailDomainSettings:l}=Ir({spaceStore:t,samlConfigStore:i,domainSettingsStore:n}),c=(0,xe.yK)((e=>({byline:{fontSize:14,fontWeight:f.Z.fontWeight.regular,color:e.mediumTextColor},helpButton:{marginTop:18,marginBottom:16}})),[]),u=s&&r,m=(0,Ze.VK)((()=>t.id),[t]),p=(0,Ze.VK)((()=>(0,Q.wP)()),[]),g=(0,Ze.VK)((()=>k.default.checkGate("enable_managed_users_dashboard")),[]),h=(0,Ze.VK)((()=>k.default.checkGate("enable_set_email_domain_settings")),[]),y=(0,Ze.VK)((()=>k.default.checkGate("enable_custom_session_duration")),[]),S=(0,Ze.VK)((()=>k.default.checkGate("enable_logout_managed_users")),[]),b=(0,Ze.VK)((()=>k.default.checkGate("enable_password_reset_managed_users")),[]),M=(0,Ze.VK)((()=>k.default.checkGate("enable_prevent_granting_support_access")),[]);return d.createElement(d.Fragment,null,a()("div",{},void 0,a()(Ae.Z,{isSmall:!0,isMultiline:!0,style:c.byline},void 0,a()(v.FormattedMessage,{id:"identityAndProvisioning.managedUsers.byline",defaultMessage:"These settings apply to all users with a verified domain, even if they are not a member of this workspace."}))),a()(Nr.Z,{title:a()(v.FormattedMessage,{id:"identityAndProvisioning.managedUsers.helpButton",defaultMessage:"Learn about managed users"}),href:(0,H.UY)("guides.managedUsers"),style:c.helpButton,analyticsFrom:"managed_users_section"}),g?a()(Wr,{promptUpgrade:!p,hasVerifiedDomains:o.length>0,disabled:!u}):null,h?d.createElement(d.Fragment,null,a()(Gr,{promptUpgrade:!p,hasVerifiedDomains:o.length>0,domainSettingsStore:n,saveEmailDomainSettings:l,disabled:!u}),a()(zr,{promptUpgrade:!p,domainSettingsStore:n,saveEmailDomainSettings:l,disabled:!u})):null,M?a()(Kr,{promptUpgrade:!p,verifiedDomains:o,domainSettingsStore:n,saveEmailDomainSettings:l,disabled:!u}):null,y?a()(Or,{promptUpgrade:!p,domainSettingsStore:n,saveEmailDomainSettings:l,disabled:!u}):null,S?a()(Ur,{spaceId:m,promptUpgrade:!p,domainSettingsStore:n,verifiedDomains:o,disabled:!u}):null,b?a()(Vr,{spaceId:m,promptUpgrade:!p,domainSettingsStore:n,verifiedDomains:o,disabled:!u}):null)}function Hr(e){let{spaceStore:t,samlConfigStore:i}=e;const n=(0,Pe.O7)();return{updateSamlIdpUrl:(0,d.useCallback)((async e=>{let a=!1;return await Tr({onRequest:()=>T.setSamlConfig(n,{spaceId:t.id,idpMetadataUrl:e}),onSuccess:()=>{a=!0,i.setState({...i.state,useMetadataUrl:!0,idpMetadataUrl:e,idpMetadata:void 0})}}),a}),[i,t,n]),updateSamlIdpXml:(0,d.useCallback)((async e=>{let a=!1;return await Tr({onRequest:()=>T.setSamlConfig(n,{spaceId:t.id,idpMetadata:e}),onSuccess:()=>{a=!0,i.setState({...i.state,useMetadataUrl:!1,idpMetadataUrl:void 0,idpMetadata:e})}}),a}),[i,t,n]),updateStatus:(0,d.useCallback)((e=>Tr({onRequest:()=>T.setSamlConfig(n,{spaceId:t.id,status:e}),onSuccess:()=>{i.setState({...i.state,status:e})}})),[i,t,n]),updateCreateAccount:(0,d.useCallback)((e=>Tr({onRequest:()=>T.setSamlConfig(n,{spaceId:t.id,createAccount:e}),onSuccess:()=>{i.setState({...i.state,createAccount:e})}})),[i,t,n])}}function jr(e){let{spaceStore:t,samlConfigStore:i,disabled:n}=e;window.__c={n:"CreateAccountSetting"};const{updateCreateAccount:o}=Hr({samlConfigStore:i,spaceStore:t}),s=(0,Pe.O7)(),r=(0,xe.yK)((()=>({settingContainer:{margin:"18px 0"},settingsTitle:{display:"inline-flex",alignItems:"center"}})),[]),l=(0,Ze.VK)((()=>i.state.createAccount),[i]);return a()("div",{style:r.settingContainer},void 0,a()(ur,{title:a()("div",{style:r.settingsTitle},void 0,a()(v.FormattedMessage,{id:"identityAndProvisioning.createAccount.title",defaultMessage:"Automatic account creation"}),a()(Bt.Z,{icon:m.Z.help,onClick:()=>w.navigateToExternalURL({environment:s,url:(0,H.UY)("guides.samlJIT")})})),byline:a()(v.FormattedMessage,{id:"identityAndProvisioning.createAccount.byline",defaultMessage:"Automatically create Notion accounts for new users who log in via SAML SSO."}),isOn:l,onToggle:async function(){await o(!i.state.createAccount)},disabled:n}))}function Qr(e){let{spaceStore:t,samlConfigStore:i,promptUpgrade:n,disabled:o}=e;window.__c={n:"SamlEnforceSetting"};const s=(0,Pe.O7)(),{updateStatus:r}=Hr({samlConfigStore:i,spaceStore:t}),l=(0,xe.yK)((()=>({settingContainer:{margin:"18px 0"}})),[]),d=a()(v.FormattedMessage,{id:"identityAndProvisioning.accountAuth.title",defaultMessage:"Login method"}),c=a()(v.FormattedMessage,{id:"identityAndProvisioning.accountAuth.byline",defaultMessage:"Customize how users access SAML SSO-enabled workspaces."}),u=(0,Ze.VK)((()=>"enforced"===i.state.status?"enforced":"not_enforced"),[i]);return a()("div",{style:l.settingContainer},void 0,n?a()(xr,{title:d,byline:c,targetTier:"business"}):a()(es.Z,{isMobile:s.device.isMobile,disabled:o,title:d,caption:c,type:"dropdown",currentOption:u,options:[{key:"enforced",label:a()(v.FormattedMessage,{id:"identityAndProvisioning.accountAuth.option.enforced",defaultMessage:"Only SAML SSO"})},{key:"not_enforced",label:a()(v.FormattedMessage,{id:"identityAndProvisioning.accountAuth.option.notEnforced",defaultMessage:"Any method"})}],onSelectOption:async function(){"enforced"===i.state.status?await r("configured"):await r("enforced")}}))}var Yr=i(5228);function $r(e){let{isOpen:t,...i}=e;window.__c={n:"SamlConfigModal"};const n=(0,Ze.VK)((()=>({active:i.samlConfigStore.state.useMetadataUrl?"url":"xml",url:i.samlConfigStore.state.idpMetadataUrl||"",xml:i.samlConfigStore.state.idpMetadata||""})),[i.samlConfigStore]);return a()(us.Z,{open:t,onDismiss:i.onClose,render:()=>d.createElement(Xr,s()({},i,{initialConfiguration:n}))})}function Xr(e){let{onSaveChanges:t,initialConfiguration:i,samlConfigStore:n,spaceStore:o,onClose:s}=e;window.__c={n:"SamlConfigSettings"};const[r,l]=(0,d.useState)(i),c=(0,Pe.O7)(),u=(0,xe.yK)((e=>({container:{background:e.popoverBackground,width:450,padding:24,borderRadius:3,transition:"all 500ms ease"},title:{fontFamily:f.Z.getCompositeFontFamily(_a.SP).sans,fontSize:17,fontWeight:500,lineHeight:"24px",textAlign:"center"},subtitle:{fontFamily:f.Z.getCompositeFontFamily(_a.SP).sans,fontSize:14,fontWeight:500,lineHeight:"19px",margin:"20px 0 0"},copyButton:{borderRadius:3,padding:"4px 8px",display:"flex",alignItems:"center",justifyContent:"center",color:e.lightTextColor,fontFamily:f.Z.getCompositeFontFamily(_a.SP).sans,fontSize:12,fontWeight:500,lineHeight:"14px"},copyIcon:{width:16,height:16,marginRight:4,fill:e.mediumIconColor},url:{width:"100%",color:e.mediumTextColor,fontFamily:f.Z.getCompositeFontFamily(_a.SP).sans,fontSize:14,fontWeight:400,lineHeight:"18px"},readonlyInput:{display:"flex",alignItems:"center",justifyContent:"center",border:`1px solid ${e.outlineButtonBorder}`,height:32,paddingLeft:12,paddingRight:12,borderRadius:3},divider:{margin:"20px auto 20px"},radioContainer:{display:"flex",justifyContent:"space-evenly",flexDirection:"column",height:60},radioOption:{display:"flex",alignItems:"center"},caption:{margin:"4px 0 8px"},centeredCaption:{margin:"4px 24px 8px",textAlign:"center"},buttonContainer:{display:"flex",alignItems:"center",justifyContent:"flex-end",marginTop:24},buttonSpacing:{marginRight:8},feedback:{color:"dark"===e.mode?e.accentColors.orange[500]:e.accentColors.orange[400],display:"flex",flexDirection:"row",alignItems:"center",fontSize:"14px",height:20}})),[]),p=(0,d.useMemo)((()=>el(r)),[r]),g=(0,Ze.VK)((()=>"unconfigured"===n.state.status),[n]),h=(0,Ze.VK)((()=>(0,Yr.v9)(o.id,et.default.domainBaseUrl)),[o]),y=(0,d.useCallback)((()=>{Tt.RD({environment:c,stringValue:h,copiedMessage:Tt.tq.copiedLinkToClipboard})}),[c,h]),S=(0,d.useCallback)((()=>{l((e=>({...e,active:"url"})))}),[]),b=(0,d.useCallback)((()=>{l((e=>({...e,active:"xml"})))}),[]),M=(0,xe.yK)((e=>({input:{transition:"all 200ms ease-in-out",boxShadow:"none",margin:"12px 0",width:"100%",background:e.popoverBackground,border:`1px solid ${e.outlineButtonBorder}`}})),[]),w=(0,d.useMemo)((()=>"url"===r.active?{placeholder:"https://...",value:r.url,onChange:e=>{const t=e.target.value;l((e=>({...e,url:t})))},style:{height:32,...M.input}}:{placeholder:'<md:EntityDescriptor entityID="...',value:r.xml,onChange:e=>{const t=e.target.value;l((e=>({...e,xml:t})))},textarea:!0,style:{height:118,...M.input},inputStyle:{width:"100%",height:"100%"}}),[r,M]),C=(0,d.useCallback)((()=>{t(r)}),[t,r]);return a()("div",{style:u.container},void 0,a()(Ae.Z,{style:u.title},void 0,a()(v.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.title",defaultMessage:"SAML SSO Configuration"})),a()(Ae.Z,{isSmall:!0,style:u.centeredCaption,isMultiline:!0},void 0,a()(v.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.byline",defaultMessage:"Configure SAML SSO for your Notion workspace with your Identity Provider (IDP). <guidelink>Learn more</guidelink>.",values:{guidelink:e=>a()(Jo.Z,{href:(0,H.UY)("guides.samlSettings"),external:!0},void 0,e)}})),a()(Ae.Z,{style:u.subtitle},void 0,a()(v.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.acsTitle",defaultMessage:"Assertion Consumer Service (ACS) URL"})),a()(Ae.Z,{isSmall:!0,style:u.caption,isMultiline:!0},void 0,a()(v.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.acsByline",defaultMessage:"Enter this in your IDP's SAML configuration."})),a()("div",{style:u.readonlyInput},void 0,a()(Ae.Z,{style:u.url},void 0,h),a()(Ii.Z,{onClick:y,style:u.copyButton},void 0,m.Z.copy(u.copyIcon),a()(v.FormattedMessage,{id:"verifyDomainModal.editSamlConfig.copy",defaultMessage:"Copy"}))),a()(Ae.Z,{style:u.subtitle},void 0,a()(v.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.idpTitle",defaultMessage:"Identity Provider Details"})),a()(Ae.Z,{isSmall:!0,style:u.caption},void 0,a()(v.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.idpUrlByline",defaultMessage:"Enter the value provided by your IDP."})),a()("div",{style:u.radioContainer},void 0,a()(Xe.Z,{style:u.radioOption,onClick:S},void 0,a()(Si.Z,{isSelected:"url"===r.active}),a()(Ae.Z,{},void 0,a()(v.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.idpUrl",defaultMessage:"Identity Provider URL"}))),a()(Xe.Z,{style:u.radioOption,onClick:b},void 0,a()(Si.Z,{isSelected:"xml"===r.active}),a()(Ae.Z,{},void 0,a()(v.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.idpXml",defaultMessage:"Identity Provider Metadata XML"})))),d.createElement(Wi.Z,w),a()("div",{style:u.feedback},void 0,a()(Jr,{validation:p})),a()("div",{style:u.buttonContainer},void 0,a()(Re.Z,{isLarge:!0,style:u.buttonSpacing,onClick:s},void 0,a()(v.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.cancel",defaultMessage:"Cancel"})),a()($e.Z,{isLarge:!0,disabled:"invalid"===p.type,onClick:C},void 0,a()(v.FormattedMessage,g?{id:"identityAndProvisioning.editSamlConfig.enableSaml",defaultMessage:"Enable SAML"}:{id:"identityAndProvisioning.editSamlConfig.saveChanges",defaultMessage:"Save changes"}))))}function Jr(e){let t,{validation:i}=e;if("valid"===i.type)return null;switch(i.reason){case"empty":t=a()(v.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.feedback.empty",defaultMessage:"You cannot leave this field blank"});break;case"signed_request":t=a()(v.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.feedback.signed_request",defaultMessage:"Requests cannot be signed"})}return d.createElement(d.Fragment,null,m.Z.warning({height:16,width:16,margin:"0 4px 0 8px"}),a()("span",{},void 0,t))}function el(e){return"url"===e.active?(0,Yr.jY)(e.url):"xml"===e.active?(0,Yr.a7)(e.xml):void(0,x.t1)(e.active)}function tl(e){let{spaceStore:t,samlConfigStore:i,domainSettingsStore:n,isSamlStatusEnabled:o,promptUpgrade:s,disabled:r}=e;window.__c={n:"SamlToggle"};const[l,c]=(0,d.useState)({isOpened:!1,enableSamlOnSave:!1}),{updateStatus:u,updateSamlIdpUrl:m,updateSamlIdpXml:p}=Hr({samlConfigStore:i,spaceStore:t}),{verifiedDomains:g}=Ir({spaceStore:t,samlConfigStore:i,domainSettingsStore:n}),h=(0,xe.yK)((()=>({settingContainer:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%",cursor:r?"default":"pointer"},settingTitle:{fontWeight:f.Z.fontWeight.medium},settingByline:{marginBottom:4},configButton:{marginTop:14}})),[r]),y=a()(v.FormattedMessage,{id:"identityAndProvisioning.samlToggle.title",defaultMessage:"Enable SAML SSO"}),S=a()(v.FormattedMessage,{id:"identityAndProvisioning.samlToggle.byline",defaultMessage:"Anyone using email addresses with a verified domain can log in via SAML SSO."});return s?a()(xr,{title:y,byline:S,targetTier:"business"}):d.createElement(d.Fragment,null,a()(ur,{title:y,byline:S,isOn:o,disabled:r,tooltipForDisabled:0===g.length?a()(v.FormattedMessage,{id:"identityAndProvisioning.samlToggle.disabledTooltipNoVerifiedDomains",defaultMessage:"Verify a domain to enable SAML."}):void 0,onToggle:function(){if(r)return;const{useMetadataUrl:e,idpMetadata:t,idpMetadataUrl:n}=i.state,a=e&&n||!e&&t;switch(i.state.status){case"disabled":a?u("configured"):c({isOpened:!0,enableSamlOnSave:!0});break;case"unconfigured":c({isOpened:!0,enableSamlOnSave:!0});break;case"configured":case"enforced":u("disabled")}}}),a()(Re.Z,{disabled:r,disabledFeedback:r,isLarge:!0,style:h.configButton,onClick:function(){r||c({isOpened:!0,enableSamlOnSave:!1})}},void 0,a()(v.FormattedMessage,{id:"identityAndProvisioning.samlToggle.configure",defaultMessage:"Edit SAML SSO configuration"})),a()($r,{isOpen:l.isOpened,onClose:()=>c({isOpened:!1,enableSamlOnSave:!1}),onSaveChanges:async function(e){if("invalid"===el(e).type)return;let t=!1;switch(e.active){case"url":t=await m(e.url);break;case"xml":t=await p(e.xml)}t&&(l.enableSamlOnSave&&await u("configured"),c({isOpened:!1,enableSamlOnSave:!1}))},spaceStore:t,samlConfigStore:i}))}var il=i(39634);const nl={id:"name",headerTitle:a()(v.FormattedMessage,{id:"identityAndProvisioning.secondaryWorkspaces.table.name",defaultMessage:"Name"}),renderCell:e=>a()(dl,{space:e.space,isCurrentSpace:e.isCurrentSpace}),widthData:{width:50},sortable:!0},al={id:"memberCount",headerTitle:a()(v.FormattedMessage,{id:"identityAndProvisioning.secondaryWorkspaces.table.memberCount",defaultMessage:"Members"}),renderCell:e=>a()(Ae.Z,{},void 0,a()(v.FormattedMessage,{id:"identityAndProvisioning.secondaryWorkspaces.table.members",defaultMessage:"{count} members",values:{count:(0,Zo.QS)(e.space)}})),widthData:{width:20},sortable:!0},ol={id:"createdAt",headerTitle:a()(v.FormattedMessage,{id:"identityAndProvisioning.secondaryWorkspaces.table.plan",defaultMessage:"Created at"}),renderCell:e=>{const t=(0,Zo.Ib)(e.space);return a()(Ae.Z,{},void 0,t&&(0,Hn.Yx)(t,"medium",_a.SP))},widthData:{width:20},sortable:!0},sl=[nl,al,ol];function rl(e){let{spaceStore:t,spaces:i}=e;window.__c={n:"WorkspacesTable"};const[n,o]=(0,d.useState)({column:nl,sortAscending:!1}),s=(0,Ze.VK)((()=>i.map((e=>({id:e.id,isClickable:!1,isCurrentSpace:t.id===e.id,space:e})))),[i,t]),r=(0,xe.yK)((e=>(0,Oe.b)({columnRenderInfo:sl,theme:e,containerMarginTop:12})),[]);return a()(Oe.D,{hideHeaderRowPadding:!0,showRowBorders:!0,columnRenderInfo:sl,rows:ll(s,n),sortState:n,onSortStateChanged:o,renderNoRowsComponent:()=>a()(Ae.Z,{isSmall:!0,style:{marginTop:15,marginBottom:40,textAlign:"center"}},void 0,a()(v.FormattedMessage,{id:"identityAndProvisioning.secondaryWorkspaces.empty",defaultMessage:"No linked workspaces."})),styles:r})}function ll(e,t){let{column:i,sortAscending:n}=t,a=[];switch(i.id){case"name":a=l().sortBy(e,(e=>e.space.name));break;case"createdAt":a=l().sortBy(e,(e=>(0,Zo.Ib)(e.space)));break;case"memberCount":a=l().sortBy(e,(e=>(0,Zo.QS)(e.space)))}return n?a:a.reverse()}function dl(e){window.__c={n:"WorkspaceNameCell"};const t=(0,xe.yK)((()=>({container:{display:"flex",justifyContent:"center",alignItems:"center",gap:4}})),[]);return a()(Ae.Z,{style:t.container},void 0,e.space.name,e.isCurrentSpace?a()(Nn.Z,{},void 0,a()(v.FormattedMessage,{id:"identityAndProvisioning.secondaryWorkspaces.table.name.currentBadge",defaultMessage:"Current"})):null)}function cl(e){let{spaceStore:t,spaceIds:i}=e;window.__c={n:"SecondaryWorkspaces"};const n=(0,Pe.O7)(),o=(0,xe.yK)((()=>({settingContainer:{margin:"18px 0"}})),[]),s=(0,Ze.VK)((()=>i.map((e=>_s.Z.getPublicSpaceData(n,e)||void 0)).filter(x.$K)),[i,n]),r=(0,d.useCallback)((()=>{il.j({environment:n,from:"saml_settings",prepopulatedContent:`Request to add or remove a workspace for SAML Single Sign-on on workspace ${t.id}.`})}),[t,n]);return a()("div",{style:o.settingContainer},void 0,a()(cr,{title:a()(v.FormattedMessage,{id:"identityAndProvisioning.secondaryWorkspaces.title",defaultMessage:"Linked workspaces"}),byline:a()(v.FormattedMessage,{id:"identityAndProvisioning.secondaryWorkspaces.message",defaultMessage:"This SAML SSO configuration applies to the following other workspaces. <contactlink>Contact support</contactlink> to add or remove a workspace.",values:{contactlink:e=>a()(Jo.Z,{onClick:r},void 0,e)}}),settingItem:null}),a()(rl,{spaceStore:t,spaces:s}))}function ul(e){let{spaceStore:t,samlConfigStore:i,domainSettingsStore:n}=e;window.__c={n:"SamlSection"};const{verifiedDomains:o,isSamlAvailable:s,isSamlEditable:r,isSamlStatusEnabled:l}=Ir({spaceStore:t,samlConfigStore:i,domainSettingsStore:n}),c=!r||!s||!l,u=(0,Ze.VK)((()=>i.state.spaceIds),[i]);return d.createElement(d.Fragment,null,a()(Nr.Z,{title:a()(v.FormattedMessage,{id:"identityAndProvisioning.samlToggle.learnMore",defaultMessage:"Learn about SAML SSO"}),href:(0,H.UY)("guides.samlSettings"),style:{marginTop:18,marginBottom:16},analyticsFrom:"saml_settings"}),a()(tl,{disabled:!r||0===o.length,promptUpgrade:!s,isSamlStatusEnabled:l,spaceStore:t,samlConfigStore:i,domainSettingsStore:n}),a()(Qr,{disabled:c,promptUpgrade:!s,spaceStore:t,samlConfigStore:i}),a()(jr,{disabled:c,spaceStore:t,samlConfigStore:i}),a()(cl,{spaceStore:t,spaceIds:u}))}const ml=(0,v.defineMessages)({failedCreatingNewScimToken:{id:"scimTokenSettings.error.failedCreatingNewScimToken",defaultMessage:"Failed to create a new SCIM token, please try again later."}});function pl(e){window.__c={n:"NewScimTokenButton"};const[t,i]=(0,d.useState)(!1),n=(0,Pe.O7)();const o=!t&&"Able"===e.tokenCreationAbility,r=t||"Able"!==e.tokenCreationAbility,l=a()(Xe.Z,{isBlue:o,isLightGray:r,disabled:r,style:{position:"relative",marginLeft:"auto",marginRight:0},icon:e=>m.Z.plus({...e,width:14,height:14,fill:"inherit",marginRight:"6px"}),onClick:async function(){i(!0);try{const t=await async function(e){let{environment:t,spaceStore:i,userStore:n}=e;const{botStore:a,transactionPromise:o}=To.lz({environment:t,spaceStore:i,name:"SCIM",userId:n.id,spaceRole:"editor",type:"scim"});return await o,a.id}({...e,environment:n});e.onNewScimToken(t)}catch(t){M.showErrorMessage(z.default.formatMessage(ml.failedCreatingNewScimToken))}i(!1)}},void 0,a()(v.FormattedMessage,{id:"scimTokenSettings.NewSCIMTokenButton.title",defaultMessage:"Add token"}));let c;switch(e.tokenCreationAbility){case"Able":return l;case"Undefined":c=a()(v.FormattedMessage,{defaultMessage:"Not able to create a new SCIM token right now. Please try again later.",id:"scimTokenSettings.NewSCIMTokenButton.unableToCreateTokenMessage.undefined"});break;case"SpaceHasExistingToken":c=a()(v.FormattedMessage,{defaultMessage:"To create a new SCIM token, please revoke the existing token.",id:"scimTokenSettings.NewSCIMTokenButton.unableToCreateTokenMessage.spaceHasLegacyToken"});break;case"UserHasExistingToken":c=a()(v.FormattedMessage,{defaultMessage:"You already have a registered SCIM token. To create a new one, please revoke the token created by you.",id:"scimTokenSettings.NewSCIMTokenButton.unableToCreateTokenMessage.userHasExistingToken"});break;default:(0,x.t1)(e.tokenCreationAbility)}return a()(We.Z,{textWrap:!1,renderTooltip:()=>c,placement:We.Z.Placement.Right,render:e=>d.createElement("div",s()({},e,{style:{paddingLeft:"4px"}}),l)})}var gl=i(15070);function hl(e){let{userId:t,currentSpaceStore:i}=e;return He.U6.createChildStore(i,{table:Qt.KJ,id:t})}var fl=i(62385);const vl={container:{display:"flex",alignItems:"center",fontSize:f.Z.fontSize.UIRegular.desktop,overflow:"hidden"},userAvatar:{paddingRight:6},userName:{flexShrink:1,...f.Z.textOverflowStyle}};function yl(e,t){const i=pn.kk.fromValue(Lt.cZ,e);return i.getCreatedByTable()===Qt.KJ&&i.getCreatedById()===t}const Sl={buttonStyle:{display:"flex",alignItems:"center",justifyContent:"center",borderRadius:3,height:20,width:20,marginRight:1},menuItemButton:{minWidth:200}};function bl(e){let{onRevokeToken:t}=e;window.__c={n:"RevokeTokenButton"};const i=(0,xe.Fg)();return d.createElement(d.Fragment,null,a()(We.Z,{textWrap:!1,renderTooltip:()=>d.createElement(d.Fragment,null,a()(v.FormattedMessage,{defaultMessage:"Revoke this token.",id:"revokeTokenButton.tooltip"})),placement:We.Z.Placement.Right,render:e=>a()(Et.ZP,{popupType:Et.Z4.Popup,placementToOrigin:Et.pO.Right,renderOrigin:t=>d.createElement(Ii.Z,s()({className:W.TAd,style:Sl.buttonStyle,mobileFeedback:!1},e,t),m.Z.trash({fill:i.mediumIconColor,width:12,height:12})),onClick:()=>{M.confirmUserAction({message:a()(v.FormattedMessage,{id:"manageSCIMTokenTable.ConfirmDeletingTokenModal.message",defaultMessage:"Are you sure you want to revoke this token?"}),description:a()(v.FormattedMessage,{id:"manageSCIMTokenTable.ConfirmDeletingTokenModal.description",defaultMessage:"Existing SCIM configurations that use this token will no longer work once the token is revoked, and you'll have to provide them with a new token."}),acceptLabel:a()(v.FormattedMessage,{id:"manageSCIMTokenTable.ConfirmDeletingTokenModal.acceptButton.label",defaultMessage:"Revoke token"}),cancelLabel:a()(v.FormattedMessage,{id:"manageSCIMTokenTable.ConfirmDeletingTokenModal.cancelButton.label",defaultMessage:"Cancel"})}).then((e=>e&&t()))},render:e=>(e.close(),d.createElement(d.Fragment,null))})}))}const Ml=()=>{window.__c={n:"OutdatedWarningIcon"};const e=(0,xe.Fg)();return a()(We.Z,{textWrap:!1,renderTooltip:()=>d.createElement(d.Fragment,null,a()(v.FormattedMessage,{defaultMessage:"Outdated token. Revoke this token and generate a new one to view its contents.",id:"manageScimTokenTable.OutdatedWarningIcon.tooltip"})),placement:We.Z.Placement.Right,render:t=>d.createElement("div",s()({},t,{style:{paddingLeft:"4px"}}),m.Z.warning({fill:(0,qn.fi)("orange",e).fill,width:12,height:12}))})};function wl(e){let{clipboardTextFn:t}=e;window.__c={n:"RenderCopyToClipboardButton"};const i=(0,Pe.O7)();const n=(0,xe.Fg)(),o={height:25,background:n.whiteButtonBackground,color:n.regularTextColor,fontWeight:f.Z.fontWeight.regular,padding:"4px 6px",fontSize:11.5};return a()(fl.Z,{onClick:async function(){const e=await t();void 0!==e&&Tt.RD({environment:i,stringValue:e,copiedMessage:Tt.tq.copiedTokenToClipboard,showCopyModal:!!i.device.isSafari||void 0})},style:o},void 0,m.Z.copy({height:16,width:16,paddingRight:4}),a()(v.FormattedMessage,{defaultMessage:"Copy",id:"codeBlock.copyToClipboard.button"}))}const Cl="•••••••••••";function _l(){return a()(We.Z,{textWrap:!1,renderTooltip:()=>a()(v.FormattedMessage,{defaultMessage:"This token can only be viewed by its creator.",id:"manageScimTokenTable.renderTokenThatCannotBeViewed.tooltip"}),placement:We.Z.Placement.Right,render:e=>d.createElement("div",e,Cl)})}function kl(e){let{row:t}=e;window.__c={n:"BotTokenCell"};const i=(0,Pe.O7)();return t.legacy?d.createElement(d.Fragment,null,Cl,a()(Ml,{})):t.ownedByCurrentUser?d.createElement(d.Fragment,null,Cl,a()(wl,{clipboardTextFn:()=>To.VG({environment:i,botId:t.id})})):a()(_l,{})}const Tl={id:"token",headerTitle:a()(v.FormattedMessage,{id:"manageScimTokenTable.columnTitle.token",defaultMessage:"Token"}),renderCell:e=>a()(kl,{row:e}),widthData:{width:40},sortable:!1,hasClickableContents:!0},Il=()=>{const e=vl;return a()(We.Z,{textWrap:!1,renderTooltip:()=>a()(v.FormattedMessage,{defaultMessage:"This token was created by a user who is no longer an admin in the workspace.",id:"scimTableLegacyUserCell.tooltip"}),placement:We.Z.Placement.Right,render:t=>d.createElement("div",t,a()("div",{style:e.container},void 0,a()($t.Z,{style:e.userAvatar,avatarShouldShowShadow:!0,size:20}),a()("div",{style:e.userName},void 0,a()("i",{},void 0,"Deactivated user"))))})},Pl={id:"addedBy",headerTitle:a()(v.FormattedMessage,{id:"manageScimTokenTable.columnTitle.addedBy",defaultMessage:"Added by"}),renderCell:e=>{if(e.legacy)return a()(Il,{});{const t=e.ownedByCurrentUser?a()(Ae.Z,{isSecondaryColor:!0,style:{marginLeft:4,textAlign:"center"}},void 0,a()(v.FormattedMessage,{id:"manageSCIMTokenTable.colums.addedBy.selfIndicator",defaultMessage:"(you)"})):d.createElement(d.Fragment,null);return d.createElement(d.Fragment,null,a()(ii,{isClickable:!1,userStores:[e.ownerUserStore]}),t)}},widthData:{width:40},sortable:!1,hasClickableContents:!1},Zl={id:"created",headerTitle:a()(v.FormattedMessage,{id:"manageScimTokenTable.columnTitle.created",defaultMessage:"Created"}),renderCell:e=>a()(ze,{includeTime:!0,dateTs:e.createdAt}),widthData:{width:40},sortable:!0,hasClickableContents:!1},xl=[Tl,Pl,Zl,{id:"revokeToken",headerTitle:void 0,renderCell:e=>a()(bl,{onRevokeToken:()=>{e.onRevokeToken()}}),widthData:{width:10},sortable:!1,hasClickableContents:!0}];function Fl(e,t){let{column:i,sortAscending:n}=t;const a=null==i?void 0:i.id;let o=e=>e.id;switch(a){case"name":o=e=>e.name;break;case"created":o=e=>e.createdAt;break;case"token":case"addedBy":case"revokeToken":case void 0:break;default:(0,x.t1)(a)}const s=l().sortBy(e,o);return n||s.reverse(),s}function Al(e){let{botStores:t,onRevokeToken:i}=e;window.__c={n:"ManageScimTokenTable"};const n=(0,Ze.VK)((()=>A.default.state.currentUserStore),[]),o=(0,Ze.VK)((()=>A.default.state.currentSpaceStore),[]),s=(0,v.useIntl)(),r=(0,Ze.VK)((()=>{if(!o)return[];const e=null==n?void 0:n.id;return l().compact(t.map((t=>{const n=t.getModel();if(!n||!(0,gl.xe)(n))return;const a={id:n.id,isClickable:!1,createdAt:n.getCreatedAt(),userLocale:s.locale,name:n.getName(),onRevokeToken:()=>{i(n.id)}},r=function(e){const t=pn.kk.fromValue(Lt.cZ,e);return"notion_user"===t.getCreatedByTable()&&t.getCreatedById()===Qt.s$.id}(n);return r?{...a,legacy:r}:{...a,legacy:r,ownedByCurrentUser:yl(n,e),ownerUserStore:"notion_user"===n.getCreatedByTable()?hl({userId:n.getCreatedById(),currentSpaceStore:o}):void 0}})))}),[t,o,n,s.locale,i]),[c,u]=(0,d.useState)({column:Zl,sortAscending:!1}),m=(0,xe.yK)((e=>(0,Oe.b)({columnRenderInfo:xl,theme:e,containerMarginTop:0})),[]);return a()(Oe.D,{columnRenderInfo:xl,rows:Fl(r,c),sortState:c,onSortStateChanged:u,onRowClick:()=>d.createElement(d.Fragment,null),renderNoRowsComponent:()=>a()(Ae.Z,{isSmall:!0,style:{marginTop:15,marginBottom:40,textAlign:"center"}},void 0,a()(v.FormattedMessage,{id:"manageSCIMTokenTable.noTokensFound.message",defaultMessage:"No active SCIM tokens."})),styles:m})}async function El(e){let{environment:t,spaceId:i}=e;return(await To.Yw({environment:t,table:xa.bx,id:i,type:"scim"})).botIds}const Bl=function(e){let{botIds:t,setBotIds:i,spaceStore:n}=e;window.__c={n:"ScimTokenSettings"};const o=(0,Pe.O7)(),s=n.id;if((0,d.useEffect)((()=>{void 0===t&&El({environment:o,spaceId:s}).then(i)}),[t,o,i,s]),t){const e=t.map((e=>He.t1.createChildStore(n,{table:Lt.cZ,id:e,spaceId:s})));return a()(Al,{botStores:e,onRevokeToken:e=>{To.P0({environment:o,botId:e,onSuccess:()=>{El({environment:o,spaceId:s}).then(i)}})}})}return a()(Ve.Z,{})};function Dl(e){let{userStore:t,spaceStore:i,promptUpgrade:n}=e;window.__c={n:"ScimTokens"};const[o,s]=(0,d.useState)(void 0),r=(0,Pe.O7)(),l=(0,Ze.VK)((()=>function(e){let{botIds:t,spaceStore:i,environment:n}=e;if(void 0===t)return"Undefined";const a=t.map((e=>He.t1.createChildStore(i,{table:Lt.cZ,id:e,spaceId:i.id}))).filter((e=>e.isDefined()));if(a.some((e=>e.getCreatedByTable()===Qt.KJ&&e.getCreatedById()===Qt.s$.id)))return"SpaceHasExistingToken";if(a.some((e=>e.getCreatedByTable()===Qt.KJ&&e.getCreatedById()===n.currentUser.id)))return"UserHasExistingToken";return"Able"}({botIds:o,spaceStore:i,environment:r})),[o,r,i]),c=a()(v.FormattedMessage,{id:"identityAndProvisioning.scim.title",defaultMessage:"SCIM tokens"}),u=a()(v.FormattedMessage,{id:"identityAndProvisioning.scim.byline",defaultMessage:"Generate a token to configure SCIM."});return n?a()(xr,{title:c,byline:u,targetTier:"enterprise"}):d.createElement(d.Fragment,null,a()(cr,{title:c,byline:u,settingItem:a()(pl,{onNewScimToken:e=>s((t=>[...t??[],e])),spaceStore:i,userStore:t,tokenCreationAbility:l})}),a()(Nr.Z,{title:a()(v.FormattedMessage,{id:"securitySAMLSettings.SCIMSection.helpButton.label",defaultMessage:"Learn about SCIM"}),style:{marginTop:18,marginBottom:24},href:(0,H.UY)("guides.scim"),analyticsFrom:"scim_settings"}),a()(Bl,{spaceStore:i,userStore:t,botIds:o,setBotIds:s}))}function Rl(e){let{userStore:t,spaceStore:i}=e;window.__c={n:"ScimSection"};const n=(0,Ze.VK)((()=>(0,Q.wP)()),[]);return a()(Dl,{promptUpgrade:!n,userStore:t,spaceStore:i})}function Ll(e){let{primarySpaceName:t}=e;window.__c={n:"SecondaryWorkspaceNotice"};const i=(0,xe.yK)((e=>({container:{background:e.accentColors.blue[100],padding:"18px 24px",borderRadius:4,margin:"0 0 24px"}})),[]);return a()("div",{style:i.container},void 0,a()(Ae.Z,{},void 0,a()(v.FormattedMessage,{id:"identityProvisioningSettings.secondaryWorkspace.uneditableTitle",defaultMessage:"The primary workspace is <bold>{primaryWorkspaceName}</bold>.",values:{primaryWorkspaceName:t,bold:e=>a()("span",{style:{fontWeight:f.Z.fontWeight.semibold}},void 0,e)}})),a()("br",{}),a()(Ae.Z,{isMultiline:!0},void 0,a()(v.FormattedMessage,{id:"identityProvisioningSettings.secondaryWorkspace.uneditableMessage",defaultMessage:"The domain management settings and SAML SSO configuration are being managed by the workspace <bold>{primaryWorkspaceName}</bold>. Please navigate there or contact an admin of that workspace to edit the verified domains or SSO configuration.",values:{primaryWorkspaceName:t,bold:e=>a()("span",{style:{fontWeight:f.Z.fontWeight.semibold}},void 0,e)}})))}var Nl=i(89101);function Ol(e){let{children:t,gap:i}=e;window.__c={n:"Grid"};const n=(0,xe.yK)((e=>({root:{display:"grid",gridAutoColumns:"minmax(0, 1fr)",gridAutoFlow:"column",gap:i}})),[i]);return a()("div",{style:n.root},void 0,t)}function Vl(e){let{children:t,row:i,rowEnd:n,col:o,colEnd:s}=e;window.__c={n:"GridCell"};const r=(0,xe.yK)((e=>({cell:{gridRowStart:i,gridRowEnd:n,gridColumnStart:o,gridColumnEnd:s}})),[i,n,o,s]);return a()("div",{style:r.cell},void 0,t)}function Ul(e){let{spaceStore:t,isEnterprise:i}=e;window.__c={n:"SetupInformation"};const n=(0,v.useIntl)(),o=(0,Ze.VK)((()=>t.id),[t]);return a()(Ol,{gap:8},void 0,a()(Vl,{row:1,col:1},void 0,a()(Ae.Z,{isSmall:!0,isMultiline:!0},void 0,a()(v.FormattedMessage,{id:"securitySAMLSettings.SetupInformationSection.workspaceId",defaultMessage:"Workspace ID"}))),a()(Vl,{row:1,col:2},void 0,a()(Ae.Z,{isSmall:!0,isMultiline:!0},void 0,a()(Wl,{text:o,tooltip:n.formatMessage({id:"securitySAMLSettings.SetupInformationSection.workspaceId.copyTooltip",defaultMessage:"Click to copy ID"})}))),i?d.createElement(d.Fragment,null,a()(Vl,{row:2,col:1},void 0,a()(Ae.Z,{isSmall:!0,isMultiline:!0},void 0,a()(v.FormattedMessage,{id:"securitySAMLSettings.SetupInformationSection.samlSSOEntityIDLink",defaultMessage:"SAML SSO/SAML Entity ID"}))),a()(Vl,{row:2,col:2},void 0,a()(Ae.Z,{isSmall:!0,isMultiline:!0},void 0,a()(Wl,{text:(0,Yr.AE)(et.default.domainBaseUrl),tooltip:n.formatMessage({id:"securitySAMLSettings.SetupInformationSection.samlSSOEntityID.copyTooltip",defaultMessage:"Click to copy link"})}))),a()(Vl,{row:3,col:1},void 0,a()(Ae.Z,{isSmall:!0,isMultiline:!0},void 0,a()(v.FormattedMessage,{id:"securitySAMLSettings.SetupInformationSection.scimBaseUrl",defaultMessage:"SCIM base URL"}))),a()(Vl,{row:3,col:2},void 0,a()(Ae.Z,{isSmall:!0,isMultiline:!0},void 0,a()(Wl,{text:et.default.domainBaseUrl+Nl._j.scimApiBasePath,tooltip:n.formatMessage({id:"securitySAMLSettings.SetupInformationSection.scimBaseUrl.copyTooltip",defaultMessage:"Click to copy link"})})))):null)}function Wl(e){let{tooltip:t,text:i}=e;window.__c={n:"CopyableText"};const n=(0,Pe.O7)();return a()(We.Z,{delayThreshold:0,renderTooltip:()=>t,render:e=>d.createElement(Jo.Z,s()({onClick:()=>{Tt.RD({environment:n,stringValue:i,copiedMessage:Tt.tq.copiedPropertyToClipboard})}},e),i)})}function Kl(e){let{userStore:t,spaceStore:i,samlConfigStore:n,domainSettingsStore:o}=e;window.__c={n:"SettingsPage"};const s=(0,Pe.O7)(),r=(0,Ze.VK)((()=>Fe.Z.state.online),[]),{loadingSaml:l,loadedSaml:c,errorSaml:u}=(0,d.useContext)(ws),m=(0,Ze.VK)((()=>function(e){let{environment:t,samlConfigStore:i,spaceStore:n}=e;const a=kr({environment:t,samlConfigStore:i}),o=!i.state.id||i.state.id===n.id;return a&&o}({environment:s,samlConfigStore:n,spaceStore:i})),[s,n,i]),p=(0,Ze.VK)((()=>n.state.id?_s.Z.getPublicSpaceData(s,n.state.id):void 0),[s,n]),g=(0,xe.yK)((()=>({header:{marginTop:48}})),[]),h=(0,Ze.VK)((()=>k.default.checkGate("enable_managed_users_dashboard")||k.default.checkGate("enable_set_email_domain_settings")),[]),f=(0,Ze.VK)((()=>(0,Q.wP)()),[]);return r?l?a()(Ee.Z,{},void 0,a()(Ve.Z,{style:{margin:"0 auto"}})):u?(M.showErrorMessage(u.message),null):c?a()(Ee.Z,{},void 0,!m&&p?a()(Ll,{primarySpaceName:p.name}):null,a()(Be.Z,{large:!0,divider:"full"},void 0,a()(v.FormattedMessage,{id:"identityProvisioningSettings.domain.title",defaultMessage:"Domain management"})),a()(Lr,{spaceStore:i,samlConfigStore:n,domainSettingsStore:o,isCurrentSpaceEnterprise:f}),h?d.createElement(d.Fragment,null,a()(Be.Z,{large:!0,divider:"full",style:g.header},void 0,a()(v.FormattedMessage,{id:"identityProvisioningSettings.userManagement.title",defaultMessage:"User management"})),a()(qr,{spaceStore:i,samlConfigStore:n,domainSettingsStore:o})):null,a()(Be.Z,{large:!0,divider:"full",style:g.header},void 0,a()(v.FormattedMessage,{id:"identityProvisioningSettings.saml.title",defaultMessage:"SAML Single sign-on (SSO)"})),a()(ul,{spaceStore:i,samlConfigStore:n,domainSettingsStore:o}),a()(Be.Z,{large:!0,divider:"full",style:g.header},void 0,a()(v.FormattedMessage,{id:"identityProvisioningSettings.scim.title",defaultMessage:"SCIM provisioning"})),a()(Rl,{userStore:t,spaceStore:i}),a()(Be.Z,{large:!0,divider:"full",style:g.header},void 0,a()(v.FormattedMessage,{id:"identityProvisioningSettings.setupInfo.title",defaultMessage:"Setup information"})),a()(Ul,{spaceStore:i,isEnterprise:f})):null:a()(Ee.Z,{},void 0,a()(Ae.Z,{isSmall:!0,isMultiline:!0,style:{textAlign:"center"}},void 0,a()(v.FormattedMessage,{defaultMessage:"Please go online to manage identity and provisioning settings.",id:"identityProvisioningSettings.offline.message"})))}function zl(e,t){return(void 0===e||!(0,g.XR)(e))&&(!(void 0===e||!(0,g.TZ)(e)||0!==t)||1===t)}var Gl=i(88108),ql=i(47425),Hl=i(63143),jl=i(27242),Ql=i(73420);function Yl(){return a()(We.Z,{renderTooltip:()=>a()(v.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.table.pendingWorkspaceClaim.Explanation",defaultMessage:"Workspace claim request is being processed."}),render:e=>d.createElement(Ae.Z,e,a()(v.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.table.pendingClaim",defaultMessage:"Pending"}))})}function $l(e){let{admin:t}=e;window.__c={n:"PendingSpaceTransferMessage"};const i=(0,v.useIntl)();return a()(We.Z,{renderTooltip:()=>a()(v.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.table.pendingWorkspaceTransferExplanation",defaultMessage:"Waiting for {name} to transfer the workspace to an external account.",values:{name:(0,Yt.Nz)(i,t)}}),render:e=>d.createElement(Ae.Z,e,a()(v.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.table.pendingTransfer",defaultMessage:"Pending"}))})}let Xl=function(e){return e.Single="single",e.Multi="multi",e}({});function Jl(e){window.__c={n:"SpaceActionsMenu"};const{space:t,mode:i}=e,n=(0,Ze.qz)(void 0,Zt.Z),o=(0,xe.yK)((()=>({container:{minWidth:325}})),[]);return i===Xl.Single?a()(td,{action:e.action,space:t}):a()(Et.ZP,{popupType:dt.kQ.Popup,style:o.container,buttonPopupStore:n,renderOrigin:e=>d.createElement(Bt.Z,s()({icon:m.Z.dots},e)),render:()=>a()(ed,{space:t,actions:e.actions,popupStore:n})})}function ed(e){let{space:t,actions:i,popupStore:n}=e;const o={key:"workspace-actions",render:e=>d.createElement(ct.Z,e),items:i.map((e=>{const i=!!e.getDisabledState&&e.getDisabledState(t),n=e.getTooltip?e.getTooltip(t):null;return{key:e.id,render:t=>a()(We.Z,{render:n=>d.createElement(Ns.Z,s()({},t,n,{shouldWrapCaption:!0,svg:t=>e.getIcon(t),title:e.name,caption:e.caption,style:{paddingTop:8,paddingBottom:8,opacity:i?.5:1},disabled:i})),renderTooltip:()=>n,disableTooltip:!Boolean(n),placement:We.Z.Placement.Left}),action:()=>e.onAction(t)}}))};return a()(rt.Z,{menuType:it.og.Popup},void 0,a()(lt.Z,{type:lt.i.Vertical,initialFocus:void 0,sections:[o],onAccept:()=>{n.setState({open:!1})}}))}function td(e){window.__c={n:"SingleSpaceActionButton"};const{action:t,space:i}=e,n=(0,xe.yK)((e=>({button:{paddingLeft:5,paddingRight:5}})),[]),o=d.useCallback((()=>{t.onAction(i)}),[t,i]);return a()(Xe.Z,{isSmall:!0,style:n.button,onClick:o},void 0,t.name)}var id=i(58877);function nd(e){let{id:t,name:i,icon:n,subscriptionTier:o,memberCount:s,highlightIconContainer:r}=e;window.__c={n:"SpaceSummary"};const l=(0,v.useIntl)(),d=n?{pointer:{table:xa.bx,id:t,spaceId:t},icon:n}:void 0,c=(0,xe.yK)((e=>({container:{display:"flex",flexDirection:"row",justifyContent:"flex-start",alignItems:"center",padding:"8px 0",width:"100%"},summaryContainer:{width:"calc(100% - 38px)"},iconContainer:{height:38,width:38,flexGrow:0,flexShrink:0,flexBasis:38,marginRight:12,display:"flex",justifyContent:"center",alignItems:"center",background:r?e.selectLightGray[50]:void 0,borderRadius:6},name:{fontSize:14,fontWeight:500},byline:{fontSize:12,opacity:.5}})),[r]);return a()("div",{style:c.container},void 0,a()("div",{style:c.iconContainer},void 0,a()(je.Z,{disabled:!0,icon:d,isEmptyPage:!1,size:32,title:i,isLarge:!0,emojiSize:28,isRaw:!1})),a()("div",{style:c.summaryContainer},void 0,a()(Ae.Z,{style:c.name,showTooltipWhenTruncated:!0},void 0,i),a()(Ae.Z,{style:c.byline},void 0,a()(v.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.summaryByline",defaultMessage:"{subscriptionTier} · {memberCount, plural, one {{memberCount} member} other {{memberCount} members}}",values:{subscriptionTier:ad(o,l),memberCount:s}}))))}function ad(e,t){switch(e){case"personal_free":case"team_free":case"free":return t.formatMessage(id.a.free);case"personal":return t.formatMessage(id.a.personal);case"plus":return t.formatMessage(id.a.plusPlan);case"business":return t.formatMessage(id.a.business);default:(0,x.t1)(e)}}function od(e){let{users:t,deletedUserEmailDomain:i}=e;window.__c={n:"SpaceUsers"};const n=(0,Ze.qz)(void 0,Zt.Z),o=(0,xe.yK)((()=>({container:{minWidth:275}})),[]);return a()(Et.ZP,{popupType:dt.kQ.Popup,style:o.container,buttonPopupStore:n,renderOrigin:e=>d.createElement(ld,s()({users:t,deletedUserEmailDomain:i},e)),render:()=>a()(sd,{users:t,popupStore:n})})}function sd(e){let{users:t,popupStore:i}=e;window.__c={n:"WorkspaceUsersMenu"};const n=(0,Pe.O7)(),o={key:"workspace-users-menu",render:e=>d.createElement(ct.Z,e),items:t.map((e=>({key:e.id,render:t=>d.createElement(rd,s()({user:e},t)),action:()=>w.navigateToExternalURL({environment:n,url:`mailto:${e.email}`})})))};return a()(rt.Z,{menuType:it.og.Popup},void 0,a()(lt.Z,{type:lt.i.Vertical,initialFocus:0,sections:[o],onAccept:()=>{i.setState({open:!1})}}))}function rd(e){let{user:t,...i}=e;window.__c={n:"EmailableUserSummary"};const n=(0,v.useIntl)(),o=(0,xe.yK)((e=>({container:{display:"flex",flexDirection:"row",justifyContent:"flex-start",alignItems:"center",height:"auto",paddingTop:8,paddingBottom:8,margin:"0 6px"},avatarContainer:{display:"flex",justifyContent:"center",alignItems:"center"},copyContainer:{display:"flex",justifyContent:"center",alignItems:"center",marginLeft:"auto",opacity:.5},nameContainer:{marginLeft:8,marginRight:8},name:{fontSize:14,lineHeight:1.2,maxWidth:300},email:{fontSize:12,lineHeight:1.2,opacity:.5,maxWidth:300}})),[]);return d.createElement(Xe.Z,s()({style:o.container},i),a()("div",{style:o.avatarContainer},void 0,a()($t.Z,{userValue:t,size:24})),a()("div",{style:o.nameContainer},void 0,a()(Ae.Z,{style:o.name},void 0,(0,Yt.Nz)(n,t)),a()(Ae.Z,{style:o.email},void 0,t.email)),a()("div",{style:o.copyContainer},void 0,m.Z.mail({height:18,width:18})))}function ld(e){let{users:t,deletedUserEmailDomain:i,...n}=e;window.__c={n:"MultiUsersDisplay"};const o=(0,v.useIntl)(),r=(0,xe.yK)((e=>({container:{display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center",marginLeft:"-8px",maxWidth:"100%"},empty:{fontSize:14,maxWidth:150,opacity:.5},name:{fontSize:14,maxWidth:150},plusMore:{opacity:.5,display:"inline"}})),[]);return 0===t.length?a()(We.Z,{render:e=>d.createElement(Xe.Z,s()({style:r.container,disabled:!0},n,e),a()(Ae.Z,{style:r.empty},void 0,a()(v.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.users.empty",defaultMessage:"Deleted user"}))),disableTooltip:!i,renderTooltip:()=>a()(v.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.users.emptyTooltip",defaultMessage:"Deleted user from {domain}",values:{domain:`@${i}`}})}):d.createElement(Xe.Z,s()({style:r.container},n),a()(Ae.Z,{},void 0,a()(v.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.users.name",defaultMessage:"{remainingCount, plural, =0 {{firstUser}} one {{firstUser} <gray>+{remainingCount}</gray>} other {{firstUser} <gray>+{remainingCount}</gray>}}",values:{firstUser:(0,Yt.Nz)(o,t[0]),remainingCount:t.length-1,gray:e=>a()(Ae.Z,{style:r.plusMore},void 0,e)}})))}const dd=[{id:"spaces",headerTitle:a()(v.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.table.name",defaultMessage:"Workspaces"}),renderCell:e=>a()(nd,{id:e.space.id,name:e.space.name,icon:e.space.icon,subscriptionTier:e.space.subscriptionTier,memberCount:e.space.memberCount}),widthData:{width:60},sortable:!1},{id:"admins",headerTitle:a()(v.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.table.admins",defaultMessage:"Workspace owners"}),renderCell:e=>a()(od,{users:e.space.admins}),widthData:{width:40},sortable:!1},{id:"createdBy",headerTitle:a()(v.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.table.createdBy",defaultMessage:"Created by"}),renderCell:e=>e.space.creator?a()(od,{users:[e.space.creator]}):a()(od,{users:[],deletedUserEmailDomain:e.space.creatorEmailDomain}),widthData:{width:40},sortable:!1},{id:"createdAt",headerTitle:a()(v.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.table.createdAt",defaultMessage:"Created date"}),renderCell:e=>a()(Ae.Z,{style:{opacity:.5}},void 0,(0,Ue.gs)(e.space.createdAt)),widthData:{width:30},sortable:!1},{id:"action",headerTitle:null,renderCell:e=>{if((0,g.DI)(e.space.spaceRequest))return a()($l,{admin:e.space.admins[0]});if((0,g.XR)(e.space.spaceRequest))return a()(Yl,{});if((0,g.TZ)(e.space.spaceRequest)){const t=e.actions.find((e=>"recover-space"===e.id));return t&&a()(Jl,{space:e.space,action:t,mode:Xl.Single})}return e.actions.length>0?a()(Jl,{space:e.space,actions:e.actions.filter((e=>"recover-space"!==e.id)),mode:Xl.Multi}):null},widthData:{width:15},sortable:!1}];function cd(e){let{claimableSpaces:t,spaceActions:i,loadMoreClaimableSpaces:n,loading:o}=e;window.__c={n:"ClaimableSpacesTable"};const s=t.map((e=>({id:e.id,isClickable:!1,space:e,actions:i}))),r=(0,xe.yK)((e=>(0,Oe.b)({columnRenderInfo:dd,theme:e,containerMarginTop:0})),[]);return d.createElement(d.Fragment,null,a()(Oe.D,{hideHeaderRowPadding:!0,showRowBorders:!0,columnRenderInfo:dd,rows:s,renderNoRowsComponent:()=>a()(Ae.Z,{isSmall:!0,style:{marginTop:15,marginBottom:40,textAlign:"center"}},void 0,!o&&a()(v.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.table.empty",defaultMessage:"No claimable workspaces."})),styles:r,getStyleForRow:function(e){if((0,g.DI)(e.space.spaceRequest)||(0,g.XR)(e.space.spaceRequest)||(0,g.TZ)(e.space.spaceRequest))return{opacity:.5}},onScrollBottom:n}),o&&a()(Ve.Z,{style:{margin:"24px auto 24px"}}))}var ud=i(33728),md=i(16354);const pd=(0,v.defineMessages)({emailPlaceholder:{id:"identityProvisioningSettings.transferWorkspaces.transferModal.contactEmail.placeholder",defaultMessage:"it@example.com"}}),gd=e=>{let{onDismiss:t,spaceQueuedForTransfer:i,currentSpaceId:n}=e;window.__c={n:"PersonalTransferSpaceConfirmationModal"};const[o,s]=(0,d.useState)(),[r,l]=(0,d.useState)(!1),{setSpaceRequest:c}=(0,d.useContext)(ws),u=(0,Pe.O7)(),p=(0,xe.yK)((e=>({modalInnerStyle:{width:406,padding:"24px 20px 16px 20px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},closeIconContainer:{position:"absolute",top:10,right:10,backgroundColor:e.accentColors.gray[75],borderRadius:"50%",height:22,width:22,display:"flex",justifyContent:"center",alignItems:"center"},closeIcon:{width:14,height:14,fill:e.mediumTextColor},modalIcon:{fill:e.mediumIconColor,height:24,width:24},title:{fontWeight:f.Z.fontWeight.medium,fontSize:16,display:"inline-flex",alignItems:"center",justifyContent:"center",marginTop:9},description:{fontWeight:f.Z.fontWeight.regular,textAlign:"center",fontSize:13,lineHeight:"16px",letterSpacing:"-0.08",marginTop:9},workspaceContainer:{position:"relative",borderRadius:6,border:`1px solid ${e.regularDividerColor}`,padding:"0 12px",boxSizing:"border-box",marginTop:30,width:"100%",height:60,justifyContent:"center",display:"flex",alignItems:"center"},checkContainer:{position:"absolute",right:12,display:"flex",alignItems:"center",justifyContent:"center",width:20,height:20},check:{fill:e.mediumIconColor,height:16,width:16},dividerContainer:{marginTop:20},dividerInner:{borderBottomColor:e.regularDividerColor},contactEmailContainer:{position:"relative",width:"100%",minHeight:56,marginTop:13},contactEmailTitle:{fontWeight:f.Z.fontWeight.medium,fontSize:14,marginBottom:8,letterSpacing:-.15,display:"inline-flex",alignItems:"center"},helpIcon:{fill:e.lightIconColor,marginLeft:4,height:16,width:16},primaryButton:{width:"100%",marginTop:32},buttonCaption:{color:e.mediumTextColor,marginTop:8,textAlign:"center",fontSize:12},secondaryButton:{margin:"8px auto 0",justifyContent:"center",fontWeight:f.Z.fontWeight.medium,color:e.lightTextColor},buttonCaptionError:{color:e.errorText,marginTop:8,fontSize:13}})),[]),g=Boolean(i);return a()(us.Z,{open:g,innerStyle:p.modalInnerStyle,preventHideChildrenWhileOpening:!0,onDismiss:t,render:()=>d.createElement(d.Fragment,null,a()("div",{style:p.closeIconContainer},void 0,a()(Xe.Z,{isSmall:!0,onClick:t,ignoreLocalHoverState:!0},void 0,m.Z.closeSmall(p.closeIcon))),a()("div",{},void 0,m.Z.personBadgeExclamationMark(p.modalIcon)),a()(Ae.Z,{style:p.title},void 0,a()(v.FormattedMessage,{id:"identityProvisioningSettings.transferWorkspaces.transferModal.selfServe.title",defaultMessage:"Require account change"}),a()(md.Z,{href:(0,H.UY)("guides.domainManagement")},void 0,a()(Bt.Z,{icon:m.Z.help}))),a()(Ae.Z,{isSmall:!0,isMultiline:!0,style:p.description},void 0,a()(v.FormattedMessage,{id:"identityProvisioningSettings.transferWorkspaces.transferModal.byline",defaultMessage:"You’re about to require the Workspace Owner of 1 workspace to use an external Notion accounts. They will be unable to use the workspace until the change is made."})),a()("div",{style:p.workspaceContainer},void 0,i?a()(nd,{id:i.id,name:i.name,icon:i.icon,subscriptionTier:i.subscriptionTier,memberCount:i.memberCount}):null,a()("div",{style:p.checkContainer},void 0,m.Z.thinCheck(p.check))),a()(Xo.Z,{size:"100%",innerStyle:p.dividerInner,style:p.dividerContainer}),a()("div",{style:p.contactEmailContainer},void 0,a()(Ae.Z,{style:p.contactEmailTitle},void 0,a()(v.FormattedMessage,{id:"identityProvisioningSettings.transferWorkspaces.transferModal.contactEmail.title",defaultMessage:"Send request from"}),a()(We.Z,{renderTooltip:()=>a()(v.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.table.pendingExplanation",defaultMessage:"The Workspace Owner can contact this email for inquiries"}),render:e=>d.createElement("span",e,m.Z.help(p.helpIcon))})),a()(Wi.Z,{value:o,placeholder:z.default.formatMessage(pd.emailPlaceholder),onChange:e=>{l(!1),s(e.target.value)}}),r&&a()(Ae.Z,{isSmall:!0,style:p.buttonCaptionError},void 0,a()(v.FormattedMessage,{id:"identityProvisioningSettings.transferWorkspaces.transferModal.contactEmail.error",defaultMessage:"Invalid email address"}))),a()($e.Z,{isLarge:!0,style:p.primaryButton,onClick:async()=>{const e=(0,ud.H3)(o);var s;if((0,ud.oH)(e)){if(i&&e){const o=await T.initiateWorkspaceTransfer(u,{requestingSpaceId:n,targetSpaceId:i.id,contactEmail:e});if("failed"===o.type)M.showErrorMessage(o.error.message);else{const n=o.data.workspaceTransfer;c(i.id,n),b.azK(u,{contactEmail:e,currentOwners:i.admins.map((e=>e.id)),targetSpaceId:i.id,verifiedDomain:i.creatorEmailDomain,subscriptionTier:i.subscriptionTier}),t(),s=i.name,Ts.oV({label:a()(v.FormattedMessage,{id:"identityProvisioningSettings.transferWorkspaces.transferModal.toast",defaultMessage:"Account change successfully requested for “{spaceName}“",values:{spaceName:s}})})}}}else l(!0)}},void 0,a()(v.FormattedMessage,{id:"identityProvisioningSettings.transferWorkspaces.transferModal.confirm",defaultMessage:"Confirm change"})),a()(Ae.Z,{isSmall:!0,isMultiline:!0,style:p.buttonCaption},void 0,a()(v.FormattedMessage,{id:"identityProvisioningSettings.transferWorkspaces.transferModal.buttonCaption",defaultMessage:"This cannot be undone"})),a()(Xe.Z,{style:p.secondaryButton,onClick:t},void 0,a()(v.FormattedMessage,{id:"identityProvisioningSettings.transferWorkspaces.transferModal.cancel",defaultMessage:"Cancel"})))})};const hd=e=>{let{onDismiss:t,spaceQueuedForClaiming:i,requestingSpaceId:n}=e;window.__c={n:"SalesAssistedClaimSpaceConfirmationModal"};const o=(0,Pe.O7)(),{setSpaceRequest:s}=(0,d.useContext)(ws),r=(0,xe.yK)((e=>({modalInnerStyle:{width:406,padding:"24px 20px 16px 20px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},closeIconContainer:{position:"absolute",top:10,right:10,backgroundColor:e.accentColors.gray[75],borderRadius:"50%",height:22,width:22,display:"flex",justifyContent:"center",alignItems:"center"},closeIcon:{width:14,height:14,fill:e.mediumTextColor},title:{fontWeight:f.Z.fontWeight.medium,fontSize:16,marginBottom:8,display:"inline-flex",alignItems:"center",justifyContent:"center"},helpIcon:{fill:e.lightIconColor,marginLeft:4,height:16,width:16},description:{fontWeight:f.Z.fontWeight.regular,textAlign:"center",fontSize:13,lineHeight:"16px",letterSpacing:"-0.08px",marginTop:9},workspaceContainer:{position:"relative",borderRadius:6,border:`1px solid ${e.regularDividerColor}`,padding:"0 12px",boxSizing:"border-box",marginTop:30,width:"100%",height:60,justifyContent:"center",display:"flex",alignItems:"center"},checkContainer:{position:"absolute",right:12,display:"flex",alignItems:"center",justifyContent:"center",width:20,height:20},check:{fill:e.mediumIconColor,height:16,width:16},primaryButton:{width:"100%",marginTop:32},secondaryButton:{margin:"8px auto 0",justifyContent:"center",fontWeight:f.Z.fontWeight.medium,color:e.lightTextColor},buttonCaption:{color:e.mediumTextColor,marginTop:8,textAlign:"center",fontSize:12}})),[]),l=Boolean(i),c=async()=>{if(!i)return;const e=await T.requestClaimAndUpgrade(o,{requestingSpaceId:n,targetSpaceId:i.id});var r;"failed"===e.type?M.showError(e):(b.eO1(o,{currentOwners:i.admins.map((e=>e.id)),targetSpaceId:i.id,verifiedDomain:i.creatorEmailDomain,memberCount:i.memberCount}),s(i.id,e.data.spaceRequest),r=i.name,Ts.oV({label:a()(v.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.claimModal.salesAssisted.toast",defaultMessage:"Workspace claim successfully requested for “{spaceName}“",values:{spaceName:r}})})),t()};return a()(us.Z,{open:l,innerStyle:r.modalInnerStyle,preventHideChildrenWhileOpening:!0,onDismiss:t,render:()=>d.createElement(d.Fragment,null,a()("div",{style:r.closeIconContainer},void 0,a()(Xe.Z,{isSmall:!0,onClick:t},void 0,m.Z.closeSmall(r.closeIcon))),a()(Ae.Z,{style:r.title},void 0,a()(v.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.claimModal.salesAssisted.title",defaultMessage:"Request workspace claim"}),a()(md.Z,{href:(0,H.UY)("guides.domainManagement")},void 0,a()(Bt.Z,{icon:m.Z.help}))),a()(Ae.Z,{isSmall:!0,isMultiline:!0,style:r.description},void 0,a()(v.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.claimModal.salesAssisted.byline",defaultMessage:"You’re about to take ownership of {currentWorkspaceName} and upgrade it to an Enterprise plan. You’ll become the Workspace owner and the existing owners will be downgraded to members.",values:{currentWorkspaceName:i?i.name:"the workspace below"}})),a()("div",{style:r.workspaceContainer},void 0,i?a()(nd,{id:i.id,name:i.name,icon:i.icon,subscriptionTier:i.subscriptionTier,memberCount:i.memberCount}):null,a()("div",{style:r.checkContainer},void 0,m.Z.thinCheck(r.check))),a()($e.Z,{isLarge:!0,style:r.primaryButton,onClick:c},void 0,a()(v.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.claimModal.salesAssisted.sendRequest",defaultMessage:"Send request"})),a()(Ae.Z,{isSmall:!0,isMultiline:!0,style:r.buttonCaption},void 0,a()(v.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.claimModal.salesAssisted.buttonCaption",defaultMessage:"This request may take a few days to process. For more information, contact your <accountmanageremail>Account Management team</accountmanageremail>.",values:{accountmanageremail:e=>a()(Jo.Z,{href:"mailto:am@makenotion.com"},void 0,e)}})),a()(Xe.Z,{style:r.secondaryButton,onClick:t},void 0,a()(v.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.claimModal.salesAssisted.cancel",defaultMessage:"Cancel"})))})};const fd=e=>{let{onDismiss:t,spaceQueuedForClaiming:i}=e;window.__c={n:"SelfServeClaimSpaceConfirmationModal"};const n=(0,xe.yK)((e=>({modalInnerStyle:{width:406,padding:"24px 20px 16px 20px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},closeIconContainer:{position:"absolute",top:10,right:10,backgroundColor:e.accentColors.gray[75],borderRadius:"50%",height:22,width:22,display:"flex",justifyContent:"center",alignItems:"center"},closeIcon:{width:14,height:14,fill:e.mediumTextColor},modalIcon:{fill:e.mediumIconColor,height:24,width:24},title:{fontWeight:f.Z.fontWeight.medium,fontSize:16,display:"inline-flex",alignItems:"center",justifyContent:"center",marginTop:9},helpIcon:{fill:e.lightIconColor,marginLeft:4,height:16,width:16},description:{fontWeight:f.Z.fontWeight.regular,textAlign:"center",fontSize:13,lineHeight:"16px",letterSpacing:"-0.08px",marginTop:9},workspaceContainer:{position:"relative",borderRadius:6,border:`1px solid ${e.regularDividerColor}`,padding:"0 12px",boxSizing:"border-box",marginTop:30,width:"100%",height:60,justifyContent:"center",display:"flex",alignItems:"center"},checkContainer:{position:"absolute",right:12,display:"flex",alignItems:"center",justifyContent:"center",width:20,height:20},check:{fill:e.mediumIconColor,height:16,width:16},primaryButton:{width:"100%",marginTop:32},secondaryButton:{margin:"8px auto 0",justifyContent:"center",fontWeight:f.Z.fontWeight.medium,color:e.lightTextColor}})),[]),o=Boolean(i);return a()(us.Z,{open:o,innerStyle:n.modalInnerStyle,preventHideChildrenWhileOpening:!0,onDismiss:t,render:()=>d.createElement(d.Fragment,null,a()("div",{style:n.closeIconContainer},void 0,a()(Xe.Z,{isSmall:!0,onClick:t,ignoreLocalHoverState:!0},void 0,m.Z.closeSmall(n.closeIcon))),a()("div",{},void 0,m.Z.arrowUpCircled(n.modalIcon)),a()(Ae.Z,{style:n.title},void 0,a()(v.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.claimModal.selfServe.title",defaultMessage:"Claim workspace"}),a()(md.Z,{href:(0,H.UY)("guides.domainManagement")},void 0,a()(Bt.Z,{icon:m.Z.help}))),a()(Ae.Z,{isSmall:!0,isMultiline:!0,style:n.description},void 0,a()(v.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.claimModal.selfServe.byline",defaultMessage:"You’re about to take ownership of {currentWorkspaceName} and upgrade it to an Enterprise plan. You’ll become the Workspace owner and the existing owners will be downgraded to members.",values:{currentWorkspaceName:i?i.name:"the workspace below"}})),a()("div",{style:n.workspaceContainer},void 0,i?a()(nd,{id:i.id,name:i.name,icon:i.icon,subscriptionTier:i.subscriptionTier,memberCount:i.memberCount}):null,a()("div",{style:n.checkContainer},void 0,m.Z.thinCheck(n.check))),a()($e.Z,{isLarge:!0,style:n.primaryButton,onClick:()=>{i&&Z.Xb(i)}},void 0,a()(v.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.claimModal.selfServe.reviewAndPay",defaultMessage:"Review and pay"})),a()(Xe.Z,{style:n.secondaryButton,onClick:t},void 0,a()(v.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.claimModal.selfServe.cancel",defaultMessage:"Cancel"})))})},vd=(0,v.defineMessages)({emailPlaceholder:{id:"identityProvisioningSettings.deleteWorkspaces.deletionModal.contactEmail.placeholder",defaultMessage:"it@example.com"}}),yd=e=>{let{onDismiss:t,spaceQueuedForDeletion:i,currentSpaceId:n}=e;window.__c={n:"SpaceDeletionConfirmationModal"};const[o,s]=(0,d.useState)({email:void 0,didError:!1}),[r,l]=(0,d.useState)(!1),[c,u]=(0,d.useState)(!1),{setSpaceRequest:p}=(0,d.useContext)(ws),g=(0,xe.yK)((e=>({modalInnerStyle:{width:406,padding:"24px 20px 16px 20px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},closeIconContainer:{position:"absolute",top:10,right:10,backgroundColor:e.accentColors.gray[75],borderRadius:"50%",height:22,width:22,display:"flex",justifyContent:"center",alignItems:"center"},closeIcon:{width:14,height:14,fill:e.mediumTextColor},modalIcon:{fill:"dark"===e.mode?e.accentColors.red[700]:e.accentColors.red[500],height:24,width:24},title:{fontWeight:f.Z.fontWeight.medium,fontSize:16,display:"inline-flex",alignItems:"center",justifyContent:"center",marginTop:9},description:{fontWeight:f.Z.fontWeight.regular,textAlign:"center",fontSize:13,lineHeight:"16px",letterSpacing:"-0.08px",marginTop:9},workspaceContainer:{position:"relative",borderRadius:6,border:`1px solid ${e.regularDividerColor}`,padding:"0 12px",boxSizing:"border-box",marginTop:30,width:"100%",height:60,justifyContent:"center",display:"flex",alignItems:"center"},checkContainer:{position:"absolute",right:12,display:"flex",alignItems:"center",justifyContent:"center",width:20,height:20},check:{fill:e.mediumIconColor,height:16,width:16},checkboxContainer:{display:"inline-flex",marginTop:8,alignItems:"center"},checkbox:{color:"dark"===e.mode?e.accentColors.gray[400]:e.accentColors.gray[200],marginRight:8},primaryButton:{width:"100%",marginTop:32,background:"dark"===e.mode?e.accentColors.red[700]:e.accentColors.red[500],justifyContent:"center",fontWeight:f.Z.fontWeight.medium,color:qn.ZP.white},primaryButtonHovered:{background:"dark"===e.mode?(0,qn._j)(e.accentColors.red[700],.3):(0,qn._j)(e.accentColors.red[500],.3)},secondaryButton:{margin:"8px auto 0",justifyContent:"center",fontWeight:f.Z.fontWeight.medium,color:e.lightTextColor},checkboxCaption:{color:e.mediumTextColor,textAlign:"center",fontSize:12},dividerContainer:{marginTop:18},divider:{borderBottomColor:e.regularDividerColor}})),[]),h=(0,Pe.O7)(),y=(0,d.useCallback)((()=>{s({email:void 0,didError:!1}),l(!1),u(!1),t()}),[t]),S=(0,d.useCallback)((e=>{s({didError:!1,email:e.target.value})}),[]),w=(0,d.useCallback)((()=>l((e=>!e))),[]),C=(0,d.useCallback)((async()=>{const e=(0,ud.H3)(o.email);if(!(0,ud.oH)(e))return void s({...o,didError:!0});if(!i)return;u(!0);const t=await T.deleteSpaceForDomain(h,{requestingSpaceId:n,targetSpaceId:i.id,contactEmail:e});if("failed"===t.type)u(!1),M.showErrorMessage(t.error.message);else{const n=t.data.spaceDeletion;p(i.id,n),b.QFO(h,{contactEmail:e,currentOwners:i.admins.map((e=>e.id)),targetSpaceId:i.id,verifiedDomain:i.creatorEmailDomain,targetSubscriptionTier:i.subscriptionTier}),y(),r=i.name,Ts.oV({label:a()(v.FormattedMessage,{id:"identityProvisioningSettings.deleteWorkspaces.deletionModal.toast",defaultMessage:"Successfully deleted “{spaceName}“",values:{spaceName:r}})})}var r}),[y,o,n,h,p,i]),_=Boolean(i);return a()(us.Z,{open:_,innerStyle:g.modalInnerStyle,preventHideChildrenWhileOpening:!0,onDismiss:y,render:()=>d.createElement(d.Fragment,null,a()("div",{style:g.closeIconContainer},void 0,a()(Xe.Z,{isSmall:!0,onClick:y,ignoreLocalHoverState:!0},void 0,m.Z.closeSmall(g.closeIcon))),a()("div",{},void 0,m.Z.trash(g.modalIcon)),a()(Ae.Z,{style:g.title},void 0,a()(v.FormattedMessage,{id:"identityProvisioningSettings.deleteWorkspaces.deletionModal.title",defaultMessage:"Delete workspace"}),a()(md.Z,{href:(0,H.UY)("guides.domainManagement")},void 0,a()(Bt.Z,{icon:m.Z.help}))),a()(Ae.Z,{isSmall:!0,isMultiline:!0,style:g.description},void 0,i?a()(v.FormattedMessage,{id:"identityProvisioningSettings.deleteWorkspaces.deletionModal.byline",defaultMessage:"You’re about to permanently delete {currentWorkspaceName} and all of its contents. The workspace owner will be notified.",values:{currentWorkspaceName:i.name}}):void 0),a()("div",{style:g.workspaceContainer},void 0,i?a()(nd,{id:i.id,name:i.name,icon:i.icon,subscriptionTier:i.subscriptionTier,memberCount:i.memberCount}):void 0,a()("div",{style:g.checkContainer},void 0,m.Z.thinCheck(g.check))),a()(Xo.Z,{size:0,style:g.dividerContainer,innerStyle:g.divider}),a()(Sd,{value:o.email,placeholder:z.default.formatMessage(vd.emailPlaceholder),onChange:S,labelMessage:a()(v.FormattedMessage,{id:"identityProvisioningSettings.deleteWorkspaces.deletionModal.contactEmail.title",defaultMessage:"Contact email"}),helpMessage:a()(v.FormattedMessage,{id:"identityAndProvisioning.deleteWorkspaces.deletionModal.tooltipExplanation",defaultMessage:"The Workspace Owner of the deleted workspace can contact this email for inquiries"}),errorMessage:o.didError?a()(v.FormattedMessage,{id:"identityProvisioningSettings.deleteWorkspaces.deletionModal.contactEmail.error",defaultMessage:"Invalid email address"}):void 0}),a()(Xe.Z,{disabled:!r||!o.email||c,disabledFeedback:!0,isLarge:!0,style:g.primaryButton,hoveredStyle:g.primaryButtonHovered,onClick:C},void 0,c?a()(Ve.Z,{}):a()(v.FormattedMessage,{id:"identityProvisioningSettings.deleteWorkspaces.deletionModal.deleteButton",defaultMessage:"Delete workspace"})),a()("div",{style:g.checkboxContainer},void 0,a()(st.Z,{style:g.checkbox,size:14,checked:r,onClick:w}),a()(Ae.Z,{isSmall:!0,style:g.checkboxCaption},void 0,a()(v.FormattedMessage,{id:"identityProvisioningSettings.deleteWorkspaces.deletionModal.checkboxLabel",defaultMessage:"I'm sure I want to delete this workspace"}))),a()(Xe.Z,{style:g.secondaryButton,onClick:y},void 0,a()(v.FormattedMessage,{id:"identityProvisioningSettings.deleteWorkspaces.deletionModal.cancel",defaultMessage:"Cancel"})))})};function Sd(e){window.__c={n:"EmailInput"};const t=(0,xe.yK)((e=>({emailInputTitle:{fontWeight:f.Z.fontWeight.medium,fontSize:14,marginBottom:8,letterSpacing:-.15,display:"inline-flex",alignItems:"center"},emailContainer:{position:"relative",width:"100%",minHeight:56,marginTop:13},inputCaptionError:{color:e.errorText,marginTop:8,fontSize:13},helpIcon:{fill:e.lightIconColor,marginLeft:4,height:16,width:16}})),[]);return a()("div",{style:t.emailContainer},void 0,a()(Ae.Z,{style:t.emailInputTitle},void 0,e.labelMessage,e.helpMessage&&a()(We.Z,{renderTooltip:()=>e.helpMessage,render:e=>d.createElement("span",e,m.Z.help(t.helpIcon))})),a()(Wi.Z,{value:e.value,placeholder:e.placeholder,onChange:e.onChange}),e.errorMessage&&a()(Ae.Z,{isSmall:!0,style:t.inputCaptionError},void 0,e.errorMessage))}const bd=e=>{let{onDismiss:t,onAccept:i,spaceQueued:n,descriptionMessage:o,divider:s,modalIcon:r,title:l,acceptMessage:c,isLoading:u}=e;window.__c={n:"ClaimableSpaceConfirmationModal"};const p=(0,xe.yK)((e=>({modalInnerStyle:{width:406,padding:"24px 20px 16px 20px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},closeIconContainer:{position:"absolute",top:10,right:10,backgroundColor:e.accentColors.gray[75],borderRadius:"50%",height:22,width:22,display:"flex",justifyContent:"center",alignItems:"center"},closeIcon:{width:14,height:14,fill:e.mediumTextColor},modalIcon:{height:24,width:24,fill:e.mediumIconColor},title:{fontWeight:f.Z.fontWeight.medium,fontSize:16,display:"inline-flex",alignItems:"center",justifyContent:"center",marginTop:9},description:{fontWeight:f.Z.fontWeight.regular,textAlign:"center",fontSize:13,lineHeight:"16px",letterSpacing:"-0.08px",marginTop:9},workspaceContainer:{position:"relative",borderRadius:6,border:`1px solid ${e.regularDividerColor}`,padding:"0 12px",boxSizing:"border-box",marginTop:30,width:"100%",height:60,justifyContent:"center",display:"flex",alignItems:"center"},checkContainer:{position:"absolute",right:12,display:"flex",alignItems:"center",justifyContent:"center",width:20,height:20},check:{fill:e.mediumIconColor,height:16,width:16},primaryButton:{width:"100%",marginTop:32,justifyContent:"center",fontWeight:f.Z.fontWeight.medium},secondaryButton:{margin:"8px auto 0",width:"100%",justifyContent:"center",fontWeight:f.Z.fontWeight.medium,color:e.lightTextColor},dividerContainer:{marginTop:18},divider:{borderBottomColor:e.regularDividerColor}})),[]),g=Boolean(n);return a()(us.Z,{open:g,innerStyle:p.modalInnerStyle,preventHideChildrenWhileOpening:!0,onDismiss:t,render:()=>d.createElement(d.Fragment,null,a()("div",{style:p.closeIconContainer},void 0,a()(Xe.Z,{isSmall:!0,onClick:t,ignoreLocalHoverState:!0},void 0,m.Z.closeSmall(p.closeIcon))),r&&a()("div",{},void 0,r(p.modalIcon)),a()(Ae.Z,{style:p.title},void 0,l,a()(md.Z,{href:(0,H.UY)("guides.domainManagement")},void 0,a()(Bt.Z,{icon:m.Z.help}))),a()(Ae.Z,{isSmall:!0,isMultiline:!0,style:p.description},void 0,o),a()("div",{style:p.workspaceContainer},void 0,n?a()(nd,{id:n.id,name:n.name,icon:n.icon,subscriptionTier:n.subscriptionTier,memberCount:n.memberCount}):void 0,a()("div",{style:p.checkContainer},void 0,m.Z.thinCheck(p.check))),s&&a()(Xo.Z,{size:0,style:p.dividerContainer,innerStyle:p.divider}),a()($e.Z,{isLarge:!0,style:p.primaryButton,onClick:i,disabled:u},void 0,u?a()(Ve.Z,{}):c),a()(Xe.Z,{style:p.secondaryButton,onClick:t},void 0,a()(v.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.claimableSpaceConfirmationModal.cancel",defaultMessage:"Cancel"})))})};const Md=e=>{let{onDismiss:t,spaceQueuedForRecovery:i,currentSpaceId:n}=e;window.__c={n:"SpaceRecoveryConfirmationModal"};const{setSpaceRequest:o}=(0,d.useContext)(ws),s=(0,Pe.O7)(),[r,l]=(0,d.useState)(!1),c=(0,d.useCallback)((()=>{l(!1),t()}),[t]),u=(0,d.useCallback)((async()=>{if(!n||!i)return;l(!0);const e=await T.cancelSpaceDeletionForDomain(s,{requestingSpaceId:n,targetSpaceId:i.id});if("failed"===e.type)return l(!1),void M.showErrorMessage(e.error.message);var t;o(i.id,void 0),b.JvT(s,{targetSpaceId:i.id,verifiedDomain:i.creatorEmailDomain}),c(),t=i.name,Ts.oV({label:a()(v.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.table.recoverSpace.toast",defaultMessage:"Successfully recovered “{spaceName}“",values:{spaceName:t}})})}),[o,n,s,i,c]);return a()(bd,{onDismiss:c,onAccept:u,spaceQueued:i,modalIcon:m.Z.showDeletedPages,title:a()(v.FormattedMessage,{id:"identityProvisioningSettings.recoverWorkspaces.confirmationModal.title",defaultMessage:"Recover workspace"}),descriptionMessage:i?a()(v.FormattedMessage,{id:"identityProvisioningSettings.recoverWorkspaces.confirmationModal.byline",defaultMessage:"Restore workspace content and the workspace owner's access.",values:{currentWorkspaceName:i.name}}):void 0,acceptMessage:a()(v.FormattedMessage,{id:"identityProvisioningSettings.recoverWorkspaces.confirmationModal.deleteButton",defaultMessage:"Recover"}),isLoading:r,divider:!1})};let wd=!1;function Cd(e){let{spaceStore:t}=e;window.__c={n:"WorkspacesPage"};const{claimableSpaces:i,domainVerifications:n,loadingSpaces:o,errorClaimableSpaces:s,errorVerifications:r,navigateTo:l,removeClaimableSpace:c,loadMoreClaimableSpaces:u,tab:p,setSelectedTab:g,verifiedDomains:h}=(0,d.useContext)(ws),y=(0,Pe.O7)(),S=(0,Ze.VK)((()=>!jl.Z.state.open&&Boolean(jl.Z.state.succeeded)),[]),[b,w]=(0,d.useState)(),[C,_]=(0,d.useState)(),[k,T]=(0,d.useState)(),[I,P]=(0,d.useState)(),Z=(0,Ze.VK)((()=>j.Q6(ke.default.state.data)),[]);function x(){w(void 0),_(void 0),T(void 0),P(void 0)}(0,d.useEffect)((()=>{S&&b&&(c(b.id),w(void 0),jl.Z.reset())}),[S,b,c,w]);const F=(0,xe.yK)((e=>({link:{fontSize:14,fontWeight:400,color:e.mediumTextColor,textDecoration:"none"},title:{marginTop:21,fontWeight:f.Z.fontWeight.semibold,fontSize:17},byline:{fontSize:14,fontWeight:f.Z.fontWeight.regular,color:e.mediumTextColor,marginRight:"auto",paddingRight:20},count:{marginLeft:4,opacity:.5,fontWeight:400},tabBarMenu:{margin:"12px 0 0",boxShadow:"none"}})),[]);if(s)return M.showErrorMessage(s.message),null;if(r)return M.showErrorMessage(r.message),null;const A=i.filter((e=>zl(e.spaceRequest,e.memberCount))),E=i.filter((e=>!zl(e.spaceRequest,e.memberCount))),B=[{id:"external-transfer",getIcon:e=>m.Z.arrowsDiverging({...e,height:14,width:14}),name:a()(v.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.actions.externalTransfer",defaultMessage:"Require account change"}),caption:a()(v.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.actions.externalTransferCaption",defaultMessage:"Owner will be prompted to change workspace ownership to a personal account."}),onAction:e=>_(e)},{id:"space-deletion",getIcon:e=>m.Z.trash({...e,height:14,width:14}),name:a()(v.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.actions.deleteSpace",defaultMessage:"Delete workspace"}),caption:a()(v.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.actions.deleteSpaceCaption",defaultMessage:"Owner will lose access to the workspace immediately."}),onAction:e=>T(e),getDisabledState:e=>{const{isEligible:t}=_d(n,e.creatorEmailDomain);return!t||e.isDelinquent||e.isPendingBilling||!(0,ql.QM)(e.subscriptionTier)},getTooltip:e=>{const t=_d(n,e.creatorEmailDomain);return t.isEligible?!(0,ql.QM)(e.subscriptionTier)||e.isDelinquent||e.isPendingBilling?a()(v.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.actions.deleteSpace.ineligibleTooltip",defaultMessage:"The workspace is ineligible for deletion."}):void 0:a()(v.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.actions.deleteSpace.disabledTooltip",defaultMessage:"You're in the 14-day notification period after verifying a domain.{br} This feature will be enabled in {numDays, plural, one {{numDays} day} other {{numDays} days}}.",values:{numDays:t.daysUntilEligible,br:a()("br",{})}})}},{id:"recover-space",getIcon:()=>{},name:a()(v.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.actions.recoverSpace",defaultMessage:"Recover"}),caption:void 0,onAction:e=>P(e)}],D=[{id:"claim-and-upgrade",getIcon:e=>m.Z.arrowUpCircled({...e,height:14,width:14}),name:a()(v.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.actions.claimAndUpgrade",defaultMessage:"Claim and upgrade"}),caption:a()(v.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.actions.claimAndUpgradeCaption",defaultMessage:"Take ownership of the workspace and upgrade it to an Enterprise plan"}),onAction:e=>w(e),getDisabledState:e=>{const{isEligible:t}=_d(n,e.creatorEmailDomain);return!t||e.isDelinquent||e.isPendingBilling},getTooltip:e=>{const t=_d(n,e.creatorEmailDomain);return e.isDelinquent||e.isPendingBilling?a()(v.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.actions.claimSpace.ineligibleTooltip",defaultMessage:"The workspace is ineligible for claiming."}):t.isEligible?void 0:a()(v.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.actions.disabledTooltip",defaultMessage:"You're in the 14-day notification period after verifying a domain.{br} This feature will be enabled in {numDays, plural, one {{numDays} day} other {{numDays} days}}.",values:{numDays:t.daysUntilEligible,br:a()("br",{})}})}}];return a()(Ee.Z,{},void 0,a()(Jo.Z,{style:F.link,onClick:()=>l(ys)},void 0,a()(v.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.breadcrumb",defaultMessage:"← Identity & Provisioning"})),a()(Be.Z,{large:!0,style:F.title},void 0,a()(v.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.title",defaultMessage:"Manage workspaces"})),a()(Ql.X2,{},void 0,a()(Ae.Z,{isSmall:!0,isMultiline:!0,style:F.byline},void 0,a()(v.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.byline",defaultMessage:"Claim verified-domain workspaces to your Enterprise plan or require Owners to use an external domain."})),a()(Re.Z,{isLarge:!0,onClick:()=>{De.g({environment:y,data:{spaceId:t.id,emailDomains:h}})}},void 0,a()(v.FormattedMessage,{id:"identityProvisioningSettings.exportClaimableWorkspaces.button",defaultMessage:"Export to CSV"}))),a()(ts.Z,{tabs:[a()(v.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.singleSpaces",defaultMessage:"Single-member"},"single"),a()(v.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.multiSpaces",defaultMessage:"Multi-member"},"multi")],selectedIndex:p,onChange:e=>g(e),style:F.tabBarMenu}),a()(gd,{onDismiss:x,spaceQueuedForTransfer:C,currentSpaceId:t.id}),p===Ms.Single?a()(cd,{claimableSpaces:A,spaceActions:B,loadMoreClaimableSpaces:u,loading:o},"single"):a()(cd,{claimableSpaces:E,spaceActions:D,loadMoreClaimableSpaces:u,loading:o},"multi"),Z?a()(hd,{onDismiss:x,spaceQueuedForClaiming:b,requestingSpaceId:t.id}):a()(fd,{onDismiss:x,spaceQueuedForClaiming:b}),a()(yd,{onDismiss:x,spaceQueuedForDeletion:k,currentSpaceId:t.id}),a()(Md,{onDismiss:x,spaceQueuedForRecovery:I,currentSpaceId:t.id}))}function _d(e,t){if(wd)return{isEligible:!0};const i=e.find((e=>{let{domain:i}=e;return t===i}));if(!i||!i.verified_at)return{isEligible:!0};const n=(Date.now()-i.verified_at)/Hl.A0;return n>=14?{isEligible:!0}:{isEligible:!1,daysUntilEligible:Math.ceil(14-n)}}function kd(e){let{userStore:t,spaceStore:i,samlConfigStore:n,domainSettingsStore:o}=e;window.__c={n:"PageRouter"};const{page:s}=(0,d.useContext)(ws),r=(0,Ze.VK)((()=>k.default.checkGate("enable_managed_users_dashboard")),[]);switch(s){case ys:return a()(Kl,{userStore:t,spaceStore:i,samlConfigStore:n,domainSettingsStore:o});case Ss:return a()(Cd,{spaceStore:i});case bs:return r?a()(_r,{spaceStore:i,samlConfigStore:n}):a()(Kl,{userStore:t,spaceStore:i,samlConfigStore:n,domainSettingsStore:o})}}["local","development","staging"].includes("production")&&(0,Gl.exposeDebugValue)("bypassDomainVerificationWaitingPeriod",(function(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];wd=e}));const Td=function(e){let{userStore:t,spaceStore:i,samlConfigStore:n,domainSettingsStore:o}=e;return a()(Cs,{spaceStore:i,samlConfigStore:n,domainSettingsStore:o},void 0,a()(kd,{userStore:t,spaceStore:i,samlConfigStore:n,domainSettingsStore:o}))};var Id=i(22756),Pd=i(1800),Zd=(i(40902),i(99036),i(41432),i(42613),i(23482),i(89789),i(74446));i(6287),i(18844),i(70279),i(91644);i(58129),i(70921),i(30842),i(39050),i(54368),i(88179),i(80926),i(98963),i(7470),i(60014),i(13493),i(75908),i(6359),i(7678),i(73409),i(60897),i(33709),i(44312),i(4986),i(52719),i(58912),i(73387),i(36077),i(97715),i(32161),i(82447),i(49953),i(14710),i(62643),i(57883),i(66726),i(30754),i(6946),i(25753),i(84683),i(38429),i(89488),i(65311),i(16427),i(70017),i(89470),i(49126),i(4137),i(80396),i(24836),i(86135),i(78929),i(84323),i(83200),i(67627),i(65963),i(14130),i(34406),i(42314),i(16663),i(19221),i(93646),i(63787),i(38952),i(40837),i(96740),i(55514),i(75990),i(57829),i(63188),i(56877),i(76413),i(47238),i(77858),i(37202),i(26195),i(60113),i(14718),i(14327),i(53412),i(65836),i(5505),i(66295),i(10354),i(19716),i(98897),i(46769),i(66079),i(58161),i(28182),i(35794),i(11045);i(38297),i(606),i(98459);const xd=gn.Ak.create();Date.now();Zd.mF.fromRecordMap(xd),Zd.zF.fromRecordMap(xd);const Fd=pn.om.fromRecordMap(xd);var Ad=i(41311),Ed=i(30397),Bd=i(29551),Dd=i(40235);const Rd=function(){window.__c={n:"AsanaImportStepConfirmTab"};const e=(0,Ze.VK)((()=>Id.Z.state),[]);return e.result?d.createElement(d.Fragment,null,a()(Ae.Z,{isMultiline:!0},void 0,a()(v.FormattedMessage,{id:"asanaImport.importsTab.confirm.subtitle",defaultMessage:"The following data has been successfully imported."})),a()("div",{style:{marginTop:32}},void 0,e.result.map((e=>a()(Ld,{importStatus:e},e.asanaTeamId))))):d.createElement(d.Fragment,null)};function Ld(e){let{importStatus:t}=e;window.__c={n:"CollapsibleAsanaProjectsTable"};const i=(0,xe.Fg)(),[n,o]=(0,d.useState)(!1),s=(0,Ze.VK)((()=>A.default.state.currentSpaceStore),[]),r=(0,Ze.VK)((()=>Id.Z.state.teamsAndProjects),[]),l=(0,Ze.VK)((()=>A.default.state.currentSpaceViewStore),[]),c=(0,Ze.VK)((()=>{if(!l)return;const e=l.getTeamsStores().map((e=>({id:e.id,name:e.getName(),icon:a()(Mt.p,{disabled:!0,store:e})})));return s?(e||[]).concat({id:l.id,name:"Private",icon:a()("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",width:18,height:18,borderRadius:"0.25em",backgroundColor:qn.FN.light.gray[75]}},void 0,m.Z.lockedFilled({color:i.mediumIconColor,width:12.5,height:12.5}))}):e}),[l,s,i]),{notionTeamspaceName:u,notionTeamspaceIcon:p}=(0,d.useMemo)((()=>{const e=null==c?void 0:c.find((e=>e.id===t.notionTeamSpaceId));return e?{notionTeamspaceName:e.name,notionTeamspaceIcon:e.icon}:{notionTeamspaceName:void 0,notionTeamspaceIcon:void 0}}),[c,t]),g=(0,d.useMemo)((()=>{const e=r.find((e=>e.gid===t.asanaTeamId));return null==e?void 0:e.name}),[r,t]);return a()(Bd.gq,{style:{marginTop:16}},void 0,a()(Bt.Z,{ariaLabel:"collapse toggle",icon:m.Z.triangle,onClick:()=>o((e=>!e)),style:{transform:n?"rotate(90deg)":"rotate(180deg)",marginRight:8,marginTop:4},iconStyle:{width:8,height:8}}),a()(Dd.Z,{tableStyle:{borderTop:0},cellStyle:{verticalAlign:"middle"},columns:[{key:"team",header:a()(Bd.gq,{alignItems:"center",gap:2},void 0,a()(Ae.Z,{isSmall:!0,style:{width:280,textOverflow:"ellipsis"}},void 0,g)),style:{width:300}},{key:"importedInto",header:a()(Bd.gq,{gap:4},void 0,a()(Bd.gq,{style:{alignItems:"center",gap:4}},void 0,a()(Ae.Z,{isSmall:!0},void 0,a()(v.FormattedMessage,{id:"asanaImport.importsTab.selectData.importedInto",defaultMessage:"Imported into"})),m.Z.arrowRight({width:12})),a()(Bd.gq,{style:{alignItems:"center",gap:4}},void 0,p,u)),style:{width:300}}],rows:function(e){let{collapsed:i}=e;return i?[]:t.numberOfTasksPerProject.map((e=>({key:e.projectId,columns:[a()(Bd.gq,{gap:8,alignItems:"center"},e.projectId,m.Z.circleCheckFilled({width:12,color:qn.FN.dark.green[600]}),a()(Ae.Z,{isMultiline:!0,style:{wordWrap:"break-word",width:300}},void 0,e.name)),a()(Ae.Z,{isSmall:!0},`${e.projectId}-tasks-count`,e.numberOfTasks,a()(v.FormattedMessage,{id:"asanaImport.importsTab.selectData.tasksHelperText",defaultMessage:" tasks"}))]})))}({collapsed:n})}))}var Nd=i(41892);const Od=function(){var e;window.__c={n:"AsanaImportStepImportingDataFailedTab"};const t=(0,Ze.VK)((()=>Id.Z.state),[]),i=(0,xe.yK)((e=>({iconStyle:{width:6,height:6,fill:e.lightIconColor},closeIconStyle:{width:16,height:16,fill:e.redBadgeBackground},lightText:{color:e.lightTextColor}})),[]);return a()("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100%"}},void 0,a()(Bd.gq,{style:{gap:8,marginTop:32,marginBottom:32,alignItems:"center"}},void 0,a()("img",{style:{width:32,height:32,marginRight:8},src:Nd.Z.images.import.asanaPng}),m.Z.dot(i.iconStyle),m.Z.dot(i.iconStyle),m.Z.dot(i.iconStyle),m.Z.clearInput(i.closeIconStyle),m.Z.dot(i.iconStyle),m.Z.dot(i.iconStyle),m.Z.dot(i.iconStyle),a()("img",{style:{width:32,height:32,marginLeft:8},src:Nd.Z.images.notionLogoPng})),a()(Ae.Z,{style:i.lightText},void 0,a()(v.FormattedMessage,{id:"asanaImport.importingData.failed.problemsOccured",defaultMessage:"Some problems occurred while importing data from your Asana workspace."})),a()(Ae.Z,{style:i.lightText},void 0,a()(v.FormattedMessage,{id:"asanaImport.importingData.failed.viewLoggerPage",defaultMessage:"Please try again or read the {link} to troubleshoot.",values:{link:a()("a",{style:{color:qn.ZP.black,cursor:"pointer"},href:`/${null===(e=t.loggerPageId)||void 0===e?void 0:e.replaceAll("-","")}`},void 0,a()(v.FormattedMessage,{id:"asanaImport.importingData.failed.linkText",defaultMessage:"import logs"}))}})))};const Vd=function(e){window.__c={n:"LoaderWithDots"};const{dotCount:t=6,speed:i=800}=e,[n,o]=(0,d.useState)(1),s=(0,xe.yK)((e=>({iconStyle:{width:6,height:6,fill:e.lightIconColor,opacity:.5},iconStyleBold:{width:6,height:6,fill:e.lightIconColor}})),[]);return(0,d.useEffect)((()=>{const e=setInterval((()=>o((e=>e<t?e+1:1))),i);return()=>clearInterval(e)}),[t,i]),a()(Bd.gq,{style:{gap:8,marginTop:32,marginBottom:32,alignItems:"center"}},void 0,Array.from({length:t},((e,t)=>t+1)).map((e=>a()("div",{},e,m.Z.dot(n===e?s.iconStyleBold:s.iconStyle)))))};const Ud=function(){window.__c={n:"AsanaImportStepImportingDataTab"};const e=(0,xe.yK)((e=>({iconStyle:{width:6,height:6,fill:e.lightIconColor},iconStyleBold:{width:8,height:8,fill:e.mediumIconColor},lightText:{color:e.lightTextColor}})),[]);return a()("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100%"}},void 0,a()(Bd.gq,{style:{gap:8,marginTop:32,marginBottom:32,alignItems:"center"}},void 0,a()("img",{style:{width:32,height:32,marginRight:8},src:Nd.Z.images.import.asanaPng}),a()(Vd,{}),a()("img",{style:{width:32,height:32,marginLeft:8},src:Nd.Z.images.notionLogoPng})),a()(Bd.gq,{},void 0,a()(Ae.Z,{style:e.lightText},void 0,a()(v.FormattedMessage,{id:"asanaImport.importingData.feelFreeToLeave",defaultMessage:"Data is being imported. Feel free to leave this window."}))),a()(Bd.gq,{},void 0,a()(Ae.Z,{style:e.lightText},void 0,a()(v.FormattedMessage,{id:"asanaImport.importingData.sendEmail",defaultMessage:"We will send you an email when the import is complete or if any problems occur."}))))};var Wd=i(57688),Kd=i(11066),zd=i(93963);const Gd=function(){window.__c={n:"AsanaImportStepSelectDataTab"};const e=(0,Pe.O7)(),t=(0,v.useIntl)(),i=(0,Ze.VK)((()=>Id.Z.getState()),[]),{workspaces:n,selectedWorkspace:o,teamsAndProjects:s}=i;return(0,d.useEffect)((()=>{o&&Ad.y2({selectedWorkspace:o,environment:e}).catch((()=>{}))}),[o,e]),d.createElement(d.Fragment,null,a()(Ae.Z,{isSmall:!0,style:{paddingTop:4,paddingBottom:4}},void 0,a()(v.FormattedMessage,{id:"asanaImport.importsTab.selectData.workspaceChoiceHelperText",defaultMessage:"Only one workspace can be imported at a time."})),a()(Hd,{onSelectOption:e=>{Id.Z.setState({...i,selectedProjectsAndTeamspaces:{},selectedWorkspace:e})},options:n.map((e=>({key:e.gid,label:e.name}))),currentOption:i.selectedWorkspace,placeHolder:t.formatMessage({id:"asanaImporter.selectData.selectWorkspacePlaceholder",defaultMessage:"Select a workspace"})}),i.selectedWorkspace?a()(Ae.Z,{style:{fontWeight:f.Z.fontWeight.semibold,marginTop:18}},void 0,a()(v.FormattedMessage,{id:"asanaImport.importsTab.selectData.selectProjects",defaultMessage:"Select projects"})):d.createElement(d.Fragment,null),i.isLoadingProjects?a()(Bd.gq,{style:{gap:8,marginTop:32,alignItems:"center"}},void 0,a()(Ve.Z,{style:{fontSize:12}}),a()(Ae.Z,{isSmall:!0,style:{color:qn.FN.light.gray[400]}},void 0,a()(v.FormattedMessage,{id:"asanaImport.importsTab.selectData.loadingProjectsHelperText",defaultMessage:"Loading projects in the workspace..."}))):s.filter((e=>0!==e.projects.length)).map((e=>a()(qd,{team:e,selectedWorkspace:o},`${e.gid}-table`))))};function qd(e){var t;let{team:i,selectedWorkspace:n}=e;window.__c={n:"CollapsibleAsanaProjectsTable"};const o=(0,Pe.O7)(),s=(0,v.useIntl)(),r=(0,xe.Fg)(),[l,c]=(0,d.useState)(!1),[u,p]=(0,d.useState)(!1),[g,h]=(0,d.useState)(),y=(0,Ze.VK)((()=>Id.Z.getState()),[]),S=(0,Ze.VK)((()=>A.default.state.currentSpaceViewStore),[]),b=(0,Ze.VK)((()=>{const e=null==S?void 0:S.getTeamsStores();return null==e?void 0:e.map((e=>({id:e.id,name:e.getName(),icon:a()(Mt.p,{disabled:!0,store:e})})))}),[S]);(0,d.useEffect)((()=>{if(!b||!S)return;if(!y.selectedProjectsAndTeamspaces[i.gid]){h("private"),Ad.B3({teamId:i.gid,spaceId:null==S?void 0:S.id});for(const n of b){var e,t;if((null===(e=n.name)||void 0===e?void 0:e.toLowerCase())===(null===(t=i.name)||void 0===t?void 0:t.toLowerCase())){h(n.id),Ad.B3({teamId:i.gid,spaceId:n.id});break}}}}),[b,i,S,y.selectedProjectsAndTeamspaces]);const M=(0,d.useCallback)((e=>{Ad.B3({teamId:i.gid,spaceId:e}),h(e)}),[i.gid]),w=(0,d.useCallback)((e=>{if("create"===e)return void Wd.lo("asana_importer",{onClose:M});let t;if("private"===e){if(null==S||!S.id)return;t=S.id}else t=e;Ad.B3({teamId:i.gid,spaceId:t}),h(e)}),[null==S?void 0:S.id,i.gid,M]),{importCompletedTasks:C}=y,_=[{key:"private",searchTerm:"private",label:a()(Bd.gq,{alignItems:"center",style:{gap:8}},void 0,a()("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",width:16,height:16,borderRadius:"0.25em",backgroundColor:qn.FN.light.gray[75]}},void 0,m.Z.lockedFilled({color:r.mediumIconColor,width:12.5,height:12.5})),a()(Ae.Z,{style:{fontWeight:f.Z.fontWeight.regular}},void 0,a()(v.FormattedMessage,{id:"asanaImport.importsTab.selectData.privateSpaceTitle",defaultMessage:"Private"})))}];return b&&_.push(...b.map((e=>({key:e.id,searchTerm:e.name,label:a()(Bd.gq,{alignItems:"center",style:{gap:8}},void 0,e.icon,e.name)})))),_.push({key:"create",searchTerm:"New teamspace",label:a()(Bd.gq,{alignItems:"center",style:{gap:4}},void 0,m.Z.plusThick({color:r.mediumIconColor,width:16,height:16}),a()(Ae.Z,{},void 0,a()(v.FormattedMessage,{id:"asanaImport.importsTab.selectData.newTeamspace",defaultMessage:"New teamspace"})))}),a()(Bd.gq,{style:{marginLeft:-18}},void 0,a()(Bt.Z,{ariaLabel:"collapse toggle",icon:m.Z.triangle,onClick:()=>c((e=>!e)),style:{transform:l?"rotate(90deg)":"rotate(180deg)",marginRight:8,marginTop:24,width:10,height:10},hoveredStyle:{background:"transparent"},pressedStyle:{background:"transparent"},iconStyle:{width:10,height:10}}),a()(Dd.Z,{tableStyle:{borderTop:0},cellStyle:{verticalAlign:"middle"},columns:[{key:"team",header:a()(Bd.gq,{alignItems:"center",gap:2},void 0,a()(jd,{onSelectOption:e=>{var t;Id.Z.setState({...y,selectedProjectsAndTeamspaces:{...y.selectedProjectsAndTeamspaces,[i.gid]:{notionTeamspaceId:null===(t=y.selectedProjectsAndTeamspaces[i.gid])||void 0===t?void 0:t.notionTeamspaceId,projects:e}}})},options:[{key:"in_complete",label:"Exclude completed projects"},{key:"all",label:"Select all projects"}],currentOption:(e=>{const t=null===(e=y.selectedProjectsAndTeamspaces[i.gid])||void 0===e?void 0:e.projects;return"string"==typeof t?t:null!=t&&t.length?"specific":void 0})()}),a()(Ae.Z,{style:{width:280,textOverflow:"ellipsis"}},void 0,i.name)),style:{width:300}},{key:"importInto",header:a()(Bd.gq,{style:{alignItems:"center"}},void 0,a()("div",{},void 0,a()(v.FormattedMessage,{id:"asanaImport.importsTab.selectData.importInto",defaultMessage:"Import into"})),a()("div",{style:{marginRight:16,marginLeft:8}},void 0,m.Z.arrowRight({width:12})),a()(Bd.gq,{style:{alignItems:"center",gap:8}},void 0,a()("img",{src:Nd.Z.emails.notionLogoBlackSmallPng,height:18}),a()(Hd,{options:_,onSelectOption:w,currentOption:null===(t=_.find((e=>e.key===g)))||void 0===t?void 0:t.key,narrow:!0,allowSearch:!0,placeHolder:s.formatMessage({id:"asanaImport.importsTab.selectData.selectATeamspace",defaultMessage:"Select a teamspace"})}))),style:{width:"50%"}}],rows:function(e){let{collapsed:t}=e;if(t)return[];const s=i.projects.map((e=>({key:e.gid,columns:[a()(Bd.gq,{alignItems:"center",gap:6,style:{marginLeft:20}},`${e.gid}-container`,a()(st.Z,{style:{marginRight:2},onClick:()=>{const t={...y.selectedProjectsAndTeamspaces[i.gid]||{projects:[],notionTeamspaceId:void 0}},{notionTeamspaceId:n,projects:a}=t;let o;o="all"===a||"in_complete"===a?[]:a.includes(e.gid)?a.filter((t=>t!==e.gid)):a.concat(e.gid),Id.Z.setState({...y,selectedProjectsAndTeamspaces:{...y.selectedProjectsAndTeamspaces,[i.gid]:{notionTeamspaceId:n,projects:o}}})},checked:(()=>{const t={...y.selectedProjectsAndTeamspaces[i.gid]||{projects:[],notionTeamspaceId:void 0}};return"all"===t.projects||"in_complete"===t.projects&&!1===e.completed||t.projects.includes(e.gid)})(),size:14,checkSize:8}),a()(zd.z,{color:e.color,size:6}),a()("div",{style:{width:240,wordWrap:"break-word"}},void 0,e.completed?a()(Ae.Z,{isMultiline:!0,style:{color:r.lightTextColor}},void 0,e.name,a()(v.FormattedMessage,{id:"asanaImport.importsTab.selectData.completedHelperText",defaultMessage:" (Completed)"})):a()(Ae.Z,{isMultiline:!0},void 0,e.name))),a()(Ae.Z,{isSmall:!0},`${i.gid}-tasks-count`,C?e.task_counts.num_tasks:e.task_counts.num_incomplete_tasks,a()(v.FormattedMessage,{id:"asanaImport.importsTab.selectData.tasksHelperText",defaultMessage:" tasks"}))]})));return i.nextPage&&s.push({key:"loadMore",columns:[a()(Kd.Z,{disabled:u,style:{marginLeft:20,color:qn.FN.light.gray[400]},hoveredStyle:{background:"transparent"},pressedStyle:{background:"transparent"},onClick:async()=>{if(!n)return;p(!0);const e=await T.getTeamsAndProjectsInAsanaWorkspace(o,{workspaceId:n,teamId:i.gid,size:5,nextPage:i.nextPage}),{teamsAndProjects:t}={...y},a=t.find((e=>e.gid===i.gid));if(a){if("success"===e.type){const n=e.data.find((e=>e.gid===i.gid));if(!n)return;a.projects.push(...n.projects),a.nextPage=n.nextPage,Id.Z.setState({...y,teamsAndProjects:t,loadMoreClicks:y.loadMoreClicks+1})}p(!1)}}},`${i.gid}-loadmore`,u?a()(Bd.gq,{alignItems:"center",gap:8},void 0,a()(Ve.Z,{style:{fontSize:12}}),a()(v.FormattedMessage,{id:"asanaImport.importsTab.selectData.loadingMoreProjects",defaultMessage:"Loading more projects..."})):a()(v.FormattedMessage,{id:"asanaImport.importsTab.selectData.loadMoreProjects",defaultMessage:"Load more projects..."}))]}),s}({collapsed:l})}))}function Hd(e){var t;window.__c={n:"Dropdown"};const{onSelectOption:i,options:n,currentOption:o,placeHolder:r,narrow:l,allowSearch:c}=e,u=(0,v.useIntl)(),[p,g]=(0,d.useState)(""),h=null===(t=n.find((e=>{let{key:t}=e;return t===o})))||void 0===t?void 0:t.label,y=(0,xe.yK)((e=>({icon:{width:12,height:12,marginLeft:4,fill:e.lightIconColor}})),[]);return a()(Et.ZP,{popupType:Et.Z4.Popup,placementToOrigin:Et.pO.Bottom,renderOrigin:e=>d.createElement(Xe.Z,s()({},e,{style:{paddingTop:l?2:8,paddingBottom:l?2:8,paddingLeft:8,paddingRight:8,opacity:1,width:250,border:`1px solid ${qn.FN.light.gray[100]}`,justifyContent:"space-between",marginTop:8,marginBottom:8,background:o?void 0:qn.FN.light.gray[50],color:o?void 0:qn.FN.light.gray[300]},disabled:!1}),a()(Ae.Z,{style:{textOverflow:"ellipsis"}},void 0,h||r),m.Z.chevronDown(y.icon)),render:e=>{const t={menuType:it.og.Popup,width:250,left:50},o=[{key:"asanaImport.dropdown.menuList",render:e=>d.createElement(ct.Z,e),items:(p.trim()?n.filter((e=>{var t;return null===(t=e.searchTerm)||void 0===t?void 0:t.toLowerCase().includes(p.toLowerCase())})):n).map((t=>{let{key:n,label:o}=t;return{key:n,action:()=>{i(n),e.close()},render:e=>d.createElement(ot.Z,s()({},e,{title:o,shouldWrapCaption:!0,right:h===o?a()("div",{style:{width:14}},void 0,m.Z.check()):void 0}))}}))}];return d.createElement(d.Fragment,null,c?a()("input",{style:{width:"100%",borderRadius:0,backgroundColor:qn.FN.light.gray[200],paddingTop:2,paddingBottom:2,paddingLeft:8,paddingRight:8,opacity:1,border:`1px solid ${qn.FN.light.gray[100]}`,justifyContent:"space-between",background:qn.FN.light.gray[50],fontSize:f.Z.fontSize.UIRegular.desktop,textOverflow:"ellipses"},placeholder:u.formatMessage({id:"asanaImport.importsTab.selectData.searchTeamspacePlaceholder",defaultMessage:"Search for a teamspace"}),onChange:e=>g(e.target.value),value:p}):d.createElement(d.Fragment,null),d.createElement(rt.Z,t,a()(lt.Z,{type:lt.i.Vertical,sections:o,initialFocus:void 0,style:{position:"relative",alignItems:"flex-end"}})))}})}function jd(e){var t;window.__c={n:"CheckboxDropdown"};const{onSelectOption:i,options:n,currentOption:o}=e,r=null===(t=n.find((e=>{let{key:t}=e;return t===o})))||void 0===t?void 0:t.label,l=(0,d.useMemo)((()=>void 0!==o&&"specific"!==o&&("all"===o||"partial")),[o]);return a()(Et.ZP,{popupType:Et.Z4.Popup,placementToOrigin:Et.pO.Bottom,alignmentToOrigin:Et.vR.Start,renderOrigin:e=>d.createElement(Xe.Z,s()({},e,{style:{padding:0,margin:0,marginRight:4,height:14},hoveredStyle:{}}),a()(st.Z,{checked:l,disabled:!0,size:14,checkSize:8})),render:e=>{const t={menuType:it.og.Popup,width:250,left:50},o=[{key:"asanaImport.checkboxDropdown.menuList",render:e=>d.createElement(ct.Z,e),items:n.map((t=>{let{key:n,label:o}=t;return{key:n,action:()=>{i(n),e.close()},render:e=>d.createElement(ot.Z,s()({},e,{title:o,shouldWrapCaption:!0,right:r===o?a()("div",{style:{width:14}},void 0,m.Z.check()):void 0}))}}))}];return d.createElement(rt.Z,t,a()(lt.Z,{type:lt.i.Vertical,sections:o,initialFocus:void 0,style:{position:"relative",alignItems:"flex-end"}}))}})}const Qd=function(e){let{tab:t,fetchActiveImportTasks:i}=e;window.__c={n:"AsanaImportStepTab"};const n=(0,Pe.O7)(),o=(0,Ze.VK)((()=>A.default.state.currentSpaceStore),[]),s=(0,Ze.VK)((()=>A.default.state.currentSpaceViewStore),[]),r=(0,Ze.VK)((()=>Ed.Z.state.teams),[]),l=(0,Ze.VK)((()=>Id.Z.state),[]),c=(0,Ze.VK)((()=>de.Z.state),[]).flowId||(0,p.ZP)(),{workspaces:u}=l,g=(0,d.useCallback)((()=>Object.values(l.selectedProjectsAndTeamspaces).some((e=>0!==e.projects.length))),[l.selectedProjectsAndTeamspaces]),h=(0,xe.yK)((e=>({closeButton:{zIndex:10,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"100%",background:e.buttonHoveredBackground,width:20,height:20,padding:4},closeButtonHover:{background:e.buttonPressedBackground},closeButtonIcon:{width:16,fill:e.mediumTextColor}})),[]);return a()(Ee.Z,{controlRow:(e=>"selectData"===e?a()("div",{style:{display:"flex",justifyContent:"space-between"}},void 0,a()(Re.Z,{style:{border:0},disabled:!u.length,onClick:()=>{i(),Id.Z.resetImport()}},void 0,a()(v.FormattedMessage,{id:"asanaImport.selectData.backButtonText",defaultMessage:"Back"})),a()(Bd.gq,{alignItems:"center",gap:8},void 0,l.selectedWorkspace?d.createElement(d.Fragment,null,a()(dr.Z,{on:l.importCompletedTasks,onClick:()=>Id.Z.setState({...l,importCompletedTasks:!l.importCompletedTasks})}),a()(Ae.Z,{},void 0,a()(v.FormattedMessage,{id:"importsTab.selectData.importCompletedTasks",defaultMessage:"Import completed tasks"}))):d.createElement(d.Fragment,null),a()($e.Z,{style:{marginLeft:16},disabled:!g()||l.templateCreationInProgress,onClick:()=>{o&&s&&Ad.T_({environment:n,currentSpaceViewStore:s,spaceStore:o,teamsStores:r,flowId:c}).catch((()=>{}))}},void 0,l.templateCreationInProgress?a()(Bd.gq,{alignItems:"center",gap:2},void 0,a()(Ve.Z,{isWhite:!0}),a()(v.FormattedMessage,{id:"importsTab.selectData.creatingTemplates",defaultMessage:"Creating templates"})):a()(v.FormattedMessage,{id:"importsTab.selectData.nextButtonText",defaultMessage:"Next"})))):"importingData"===e?a()("div",{style:{display:"flex",justifyContent:"right"}},void 0,a()(Re.Z,{disabled:!u.length,onClick:()=>{i(),Id.Z.resetImport()}},void 0,a()(v.FormattedMessage,{id:"importsTab.importingData.closeButtonText",defaultMessage:"Close"}))):"confirm"===e?a()("div",{style:{display:"flex",justifyContent:"right"}},void 0,a()($e.Z,{onClick:()=>{l.loggerPageId&&w.navigate({url:(0,Pd.Z)({pageId:l.loggerPageId,pageModel:Fd({table:hn.iU,id:l.loggerPageId}),baseUrl:et.default.domainBaseUrl,pageVisitSource:kt.tY.Import}),environment:n}),Id.Z.resetImport(),_e.Z.reset()}},void 0,a()(v.FormattedMessage,{id:"importsTab.confirm.doneText",defaultMessage:"Done"}))):"failure"===e?a()("div",{style:{display:"flex",justifyContent:"right"}},void 0,a()(Re.Z,{disabled:!u.length,onClick:()=>{i(),Id.Z.resetImport()}},void 0,a()(v.FormattedMessage,{id:"importsTab.importingData.closeButtonText",defaultMessage:"Close"}))):void 0)(t),controlRowPaddingTopBottom:20},void 0,a()("div",{style:{position:"absolute",top:12,right:12}},void 0,a()(Kd.Z,{onClick:()=>{i(),Id.Z.resetImport()},style:h.closeButton,hoveredStyle:h.closeButtonHover},void 0,m.Z.closeSmall(h.closeButtonIcon))),a()(Ae.Z,{style:{paddingBottom:8,fontSize:18,fontWeight:f.Z.fontWeight.medium,width:"100%"}},void 0,function(e){switch(e){case"selectData":return a()(Ae.Z,{style:{fontWeight:f.Z.fontWeight.semibold}},void 0,a()(v.FormattedMessage,{id:"asanaImport.importsTab.selectData.tabTitle",defaultMessage:"Select Asana workspace"}));default:return d.createElement(d.Fragment,null)}}(t)),(e=>"selectData"===e?a()(Gd,{}):"importingData"===e?a()(Ud,{}):"confirm"===e?a()(Rd,{}):"failure"===e?a()(Od,{}):void 0)(t))};const Yd=function(e){let{fetchActiveImportTasks:t}=e;window.__c={n:"AsanaImportModal"};const i=(0,Ze.VK)((()=>Id.Z.state),[]);return a()(us.Z,{open:i.isModalOpen,innerStyle:{width:800,height:"calc(100vh - 100px)",overflow:"hidden",borderRadius:5,maxHeight:675},render:()=>a()(ds.Z,{capture:!0,allowEsc:!0,render:()=>a()(cs.Z,{capture:!0,ignoreBlockSelection:!0,restoreSelection:!0,focusOffscreenInput:!1,render:()=>(()=>{const{currentTab:e}=i;return a()(Qd,{fetchActiveImportTasks:t,tab:e})})()})}),onDismiss:()=>{Id.Z.resetImport()}})};var $d=i(15684);const Xd=function(){window.__c={n:"ImportsTab"};const e=(0,Ze.VK)((()=>A.default.state),[]),t=(0,Ze.VK)((()=>Id.Z.state),[]),{currentSpaceStore:i,mainEditorCurrentBlockStore:n,currentSpaceViewStore:o,currentUserSettingsStore:s}=e,l=(0,Pe.O7)(),{device:c}=(0,Pe.O7)(),[u,m]=(0,d.useState)([]),p=(0,d.useCallback)((async()=>{if(null==i||!i.id)return;const e=await T.getActiveImportTasks(l,{spaceId:i.id});"success"===e.type&&m(e.data)}),[i,l]);return(0,d.useEffect)((()=>{p().catch((()=>{}));const e=setInterval(p,6e4);return()=>clearInterval(e)}),[i,l,p]),(0,d.useEffect)((()=>{let e;const i=async t=>{const a=await T.getAsanaWorkspacesNames(l,{});if(t+=1,"success"===a.type)if(null!=a&&a.data.account)Id.Z.setState({...Id.Z.state,account:a.data.account,workspaces:a.data.workspaces,isLoadingAsanaWorkspaces:!1,isAccountLinkingInProgress:!1,currentTab:"selectData",isModalOpen:!0});else{if(t>n)return;e=setTimeout((()=>i(t)),2e3)}},n=180;if(t.isAccountLinkingInProgress){i(0).catch((()=>{}))}return()=>{clearTimeout(e)}}),[t.isAccountLinkingInProgress,l]),i&&o&&o&&s?d.createElement(d.Fragment,null,a()(Be.Z,{large:!c.isMobile||void 0,divider:c.isMobile?void 0:"full"},void 0,a()(v.FormattedMessage,{id:"importsTab.title",defaultMessage:"Import data"})),a()(Ae.Z,{},void 0,a()(v.FormattedMessage,{id:"importsTab.subtitle",defaultMessage:"You can easily import data from any of the following sources."})),a()(Ae.Z,{isSmall:!0},void 0,a()(v.FormattedMessage,{id:"importsTab.unsupportedImportsHelperText",defaultMessage:"If your data is located somewhere we don't support yet, you can try importing it via CSV file."})),a()("div",{style:{marginTop:16,display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gridAutoRows:"1fr",gap:"4px 16px",width:"100%"}},void 0,a()($d.Z,{pageStore:n,spaceStore:i,spaceViewStore:o,userSettingsStore:s,analyticsFrom:"modal",onComplete:e=>{w.navigateToBlock({environment:l,store:e,pageVisitSource:kt.tY.Import}),_e.Z.reset()},readOnlyCreditButton:!1,isLoadingNewConnections:t.isFetchingAsanaAccount}),a()(Yd,{fetchActiveImportTasks:p})),a()("div",{style:{marginTop:32}},void 0,a()(Ae.Z,{isMultiline:!0},void 0,a()(v.FormattedMessage,{id:"importsTab.activeImports.title",defaultMessage:"Active Imports"})),a()(Dd.Z,{tableStyle:{borderTop:0},columns:[{key:"importTime",header:a()(v.FormattedMessage,{id:"importsTab.activeImports.importTime",defaultMessage:"Import time"})},{key:"importFrom",header:a()(v.FormattedMessage,{id:"importsTab.activeImports.importFrom",defaultMessage:"Import from"})},{key:"importStatus",header:a()(v.FormattedMessage,{id:"importsTab.activeImports.importStatus",defaultMessage:"Status"})}],rows:u.map((e=>({key:`table-${e.taskId}`,columns:[e.startedAt?`${(0,Hn.Yx)(e.startedAt,"long",z.default.getIntl().locale)} ${(0,Hn.Yx)(e.startedAt,"time",z.default.getIntl().locale)}`:"",(0,r.startCase)(e.source),a()(bi.Z,{isRound:!0,showRemoveButton:!1,value:a()(Ae.Z,{},void 0,a()(v.FormattedMessage,{id:"activeImports.status.inProgress",defaultMessage:"In progress"})),backgroundColor:qn.FN.light.blue[200],showColoredDot:"blue",format:fi.l.Small,isSingle:!0},`progress-${e.taskId}`)]})))}),u.length?d.createElement(d.Fragment,null):a()(Ae.Z,{isSmall:!0,style:{marginTop:16}},void 0,a()(v.FormattedMessage,{id:"importsTab.activeImportsTable.noActiveImports",defaultMessage:"There are no ongoing imports associated with your account."})))):d.createElement(d.Fragment,null)};var Jd=i(79092),ec=i(54153),tc=i(84908),ic=i(84075),nc=i(57222),ac=i(65680),oc=i(31194);class sc extends c.Z{constructor(){super(...arguments),this.storeTypes={buttonPopupStore:Zt.Z},this.handleSelectChange=e=>{const{label:t}=this.getItemLabelAndCaption(e);if(this.props.confirm){const i=()=>{this.props.onChange(e)};M.showDialog({showCancel:!0,keepFocus:!1,message:a()(v.FormattedMessage,{id:"languagePicker.changeLanguage.confirmationMessage",defaultMessage:"Are you sure you want to update the language to {language}?",values:{language:t}}),items:[{label:a()(v.FormattedMessage,{id:"languagePicker.changeLanguage.updateButton.label",defaultMessage:"Update"}),color:"red",onAccept:i}]})}else this.props.onChange(e)}}renderComponent(){const{device:e}=this.environment;if(e.isMobile)return;const t="ja-JP"===this.props.currentLocale&&k.default.checkGate("japan_full_launch");return a()(Et.ZP,{popupType:Et.Z4.Popup,buttonPopupStore:this.stores.buttonPopupStore,renderOrigin:e=>d.createElement(d.Fragment,null,d.createElement(Xe.Z,s()({style:{marginLeft:-8,paddingLeft:8,paddingRight:8}},e),this.props.pickerLabel?this.props.pickerLabel:this.getItemLabelAndCaption(this.props.currentLocale).label,(0,ac.ay)(this.props.currentLocale)&&!t&&a()(Nn.Z,{desktopStyle:{marginLeft:4}},void 0,a()(v.FormattedMessage,{id:"languagePicker.betaBadge",defaultMessage:"Beta"})),m.Z.chevronDown({width:10,marginLeft:4,fill:this.theme.lightIconColor}))),placementToOrigin:oc.Iw.Bottom,alignmentToOrigin:oc.lU.Start,render:e=>{let t;t=k.default.checkGate("polyglot")?[...ac.tp,...ac.is]:[...ac.tp];const i=[{key:"languages",render:e=>d.createElement(ct.Z,s()({},e,{topBorder:0!==e.index})),items:t.map((t=>({key:t,render:e=>this.getItem(t,e.focused,e),action:()=>{this.handleSelect(t),e.close()}})))}],n={menuType:it.og.Popup,width:240};return d.createElement(rt.Z,s()({className:W.hKO},n),a()(lt.Z,{type:lt.i.Vertical,initialFocus:void 0,sections:i}))}})}renderItem(e){const t="ja-JP"===e.locale&&k.default.checkGate("japan_full_launch");return d.createElement(ot.Z,s()({},e.props,{title:a()("div",{style:{display:"flex",alignItems:"center"}},void 0,a()("div",{style:{...e.style,marginRight:0}},void 0,e.label)),caption:e.caption&&a()("span",{style:{color:this.theme.mediumTextColor}},void 0,e.caption),shouldWrapCaption:!0,right:(0,ac.ay)(e.locale)&&!t&&a()(Nn.Z,{},void 0,a()(v.FormattedMessage,{id:"languagePicker.betaBadge",defaultMessage:"Beta"}))}))}handleSelect(e){this.props.currentLocale!==e&&this.handleSelectChange(e)}getItemLabelAndCaption(e){return(0,nc.t)(this.props.intl)[e]}getItem(e,t,i){return this.renderItem({...this.getItemLabelAndCaption(e),focused:t,props:i,locale:e})}}sc.displayName="LanguagePicker";const rc=(0,v.injectIntl)(sc);class lc extends c.Z{renderComponent(){return a()("div",{style:this.getSettingsOptionStyle()},void 0,a()("div",{style:{display:"flex",alignItems:"flex-start",width:"100%"}},void 0,a()("div",{style:{flex:1}},void 0,a()(Ae.Z,{},void 0,a()(v.FormattedMessage,{id:"languageRegionSettings.language.label",defaultMessage:"Language"})),a()(Ae.Z,{isSmall:!0,isMultiline:!0,style:{width:"80%"}},void 0,a()(v.FormattedMessage,{id:"languageSettings.languageSwitcher.subtitle",defaultMessage:"Change the language used in the user interface."}))),a()(rc,{confirm:!0,onChange:async e=>{b.A01(this.environment,{locale:e});const t=await T.setLocale(this.environment,{locale:e});"success"===t.type?(ec.Z.set("preferredLocale",e),await ic.transactionQueue.drain(),this.environment.device.isElectron?tc.refreshAll({includeFocusedWindow:!0}):window.location.reload()):M.showError(t)},currentLocale:this.props.locale})))}getSettingsOptionStyle(){const{device:e,WindowSizeStore:t}=this.environment;return{display:"flex",flexDirection:"column",alignItems:"flex-start",width:"100%",height:"auto",paddingLeft:e.isMobile?t.state.paddingLeftCSS:0,paddingRight:e.isMobile?t.state.paddingRightCSS:0}}}lc.displayName="LanguageSettings";const dc=lc;var cc=i(32056);function uc(e){var t;return(null==e||null===(t=e.getSettingsStore())||void 0===t||null===(t=t.getKeyStore("regional_format_settings"))||void 0===t?void 0:t.getKeyStore("region").getValue())||"US"}function mc(e,t){var i;const n=null==e||null===(i=e.getKeyStore("settings"))||void 0===i||null===(i=i.getKeyStore("regional_format_settings"))||void 0===i?void 0:i.getValue();return"full_date"===t?null!=n&&n.use_default_region_settings?pc(uc(e)):(null==n?void 0:n.full_date)||pc(uc(e)):"short_date"===t?null!=n&&n.use_default_region_settings?{type:"short"}:(null==n?void 0:n.short_date)||{type:"short"}:"number"===t?null!=n&&n.use_default_region_settings?"number":(null==n?void 0:n.number)||"number":"week_start_on"===t?null!=n&&n.use_default_region_settings?"sunday":(null==n?void 0:n.week_start_on)||"sunday":(0,x.t1)(t)}function pc(e){return"JP"===e?{type:"short"}:{type:"long"}}const gc={full_date:(0,v.defineMessages)({full:{defaultMessage:"Full date",id:"regionalFormatSettings.customSettingOption.fullDate.full"},long:{defaultMessage:"Long",id:"regionalFormatSettings.customSettingOption.fullDate.long"},medium:{defaultMessage:"Medium",id:"regionalFormatSettings.customSettingOption.fullDate.medium"},short:{defaultMessage:"Short",id:"regionalFormatSettings.customSettingOption.fullDate.short"},iso:{defaultMessage:"ISO",id:"regionalFormatSettings.customSettingOption.fullDate.iso"},custom:{defaultMessage:"Custom",id:"regionalFormatSettings.customSettingOption.fullDate.custom"}}),short_date:(0,v.defineMessages)({short:{defaultMessage:"Short",id:"regionalFormatSettings.customSettingOption.shortDate.short"},iso:{defaultMessage:"ISO",id:"regionalFormatSettings.customSettingOption.shortDate.iso"},custom:{defaultMessage:"Custom",id:"regionalFormatSettings.customSettingOption.shortDate.custom"}}),number:(0,v.defineMessages)({number:{defaultMessage:"Number",id:"regionalFormatSettings.customSettingOption.number.number"},number_with_commas:{defaultMessage:"Number with commas",id:"regionalFormatSettings.customSettingOption.number.withCommas"},percent:{defaultMessage:"Percent",id:"regionalFormatSettings.customSettingOption.number.percent"}}),week_start_on:(0,v.defineMessages)({sunday:{defaultMessage:"Sunday",id:"regionalFormatSettings.customSettingOption.weekStartOn.sunday"},monday:{defaultMessage:"Monday",id:"regionalFormatSettings.customSettingOption.weekStartOn.monday"}})},hc=(0,v.defineMessages)({full_date:{defaultMessage:"Full date",id:"regionalFormatSettings.defaultSetting.fullDate"},short_date:{defaultMessage:"Short date",id:"regionalFormatSettings.defaultSetting.shortDate"},number:{defaultMessage:"Numbers",id:"regionalFormatSettings.defaultSetting.numbers"},week_start_on:{defaultMessage:"Week starts",id:"regionalFormatSettings.defaultSetting.weekStart"}});function fc(e,t){if("full_date"===t){return gc[t][mc(e,t).type]}if("short_date"===t){return gc[t][mc(e,t).type]}if("number"===t){return gc[t][mc(e,t)]}if("week_start_on"===t){return gc[t][mc(e,t)]}return(0,x.t1)(t)}function vc(e,t){return(0,cc.uf)(1234567,e,t)}const yc=(0,v.defineMessages)({sunday:{id:"regionalFormatSettings.defaultRegionalSettings.startDayOfWeek.sunday",defaultMessage:"Sunday"},monday:{id:"regionalFormatSettings.defaultRegionalSettings.startDayOfWeek.monday",defaultMessage:"Monday"}});function Sc(e,t){const i=e.type;return"short"===i||"long"===i||"medium"===i?(0,Hn.Yx)(Date.now(),i,(0,er.E2)(t)):"iso"===i?(0,Hn.$6)(Date.now()):(0,Hn.Yx)(Date.now(),"long",(0,er.E2)(t))}function bc(e,t){const i=e.type;return"iso"===i?(0,Hn.$6)(Date.now()):"short"===i?(0,Hn.Yx)(Date.now(),i,(0,er.E2)(t)):(0,Hn.Yx)(Date.now(),"short",(0,er.E2)(t))}var Mc=i(68894),wc=i(95030);const Cc={full_date:(0,v.defineMessages)({full:{defaultMessage:"Full date",id:"regionalFormatSettings.customSettingOption.fullDate.full"},long:{defaultMessage:"Long",id:"regionalFormatSettings.customSettingOption.fullDate.long"},medium:{defaultMessage:"Medium",id:"regionalFormatSettings.customSettingOption.fullDate.medium"},short:{defaultMessage:"Short",id:"regionalFormatSettings.customSettingOption.fullDate.short"},iso:{defaultMessage:"ISO",id:"regionalFormatSettings.customSettingOption.fullDate.iso"},custom:{defaultMessage:"Custom",id:"regionalFormatSettings.customSettingOption.fullDate.custom"}}),short_date:(0,v.defineMessages)({short:{defaultMessage:"Short",id:"regionalFormatSettings.customSettingOption.shortDate.short"},iso:{defaultMessage:"ISO",id:"regionalFormatSettings.customSettingOption.shortDate.iso"},custom:{defaultMessage:"Custom",id:"regionalFormatSettings.customSettingOption.shortDate.custom"}}),number:(0,v.defineMessages)({number:{defaultMessage:"Number",id:"regionalFormatSettings.customSettingOption.number.number"},number_with_commas:{defaultMessage:"Number with commas",id:"regionalFormatSettings.customSettingOption.number.withCommas"},percent:{defaultMessage:"Percent",id:"regionalFormatSettings.customSettingOption.number.percent"}}),week_start_on:(0,v.defineMessages)({sunday:{defaultMessage:"Sunday",id:"regionalFormatSettings.customSettingOption.weekStartOn.sunday"},monday:{defaultMessage:"Monday",id:"regionalFormatSettings.customSettingOption.weekStartOn.monday"}})};function _c(e){window.__c={n:"CustomRegionalFormatSettingPicker"};const[,,t]=(0,Ze.AF)(void 0,Zt.Z),i=(0,xe.Fg)(),[n,o]=(0,Ze.VK)((()=>[e.userSettingsStore.isDefined(),fc(e.userSettingsStore,e.option)]),[e.option,e.userSettingsStore]);return n?a()(Et.ZP,{popupType:Et.Z4.Popup,buttonPopupStore:t,renderOrigin:e=>d.createElement(Xe.Z,e,z.default.formatMessage(o),m.Z.chevronDown({width:10,marginLeft:4,fill:i.lightIconColor})),placementToOrigin:oc.Iw.Bottom,alignmentToOrigin:oc.lU.Start,render:t=>"week_start_on"===e.option||"number"===e.option?a()(kc,{userSettingsStore:e.userSettingsStore,option:e.option,onAccept:()=>{t.close()}}):"full_date"===e.option||"short_date"===e.option?a()(Tc,{userSettingsStore:e.userSettingsStore,option:e.option,onAccept:()=>{t.close()}}):(0,x.t1)(e.option)}):a()(Ve.Z,{})}function kc(e){window.__c={n:"SimpleFormatPicker"};const t=(0,Pe.O7)(),i=(0,v.useIntl)();return a()(rt.Z,{menuType:it.og.Popup,width:216},void 0,a()(lt.Z,{type:lt.i.Vertical,initialFocus:void 0,sections:[{key:"options",render:e=>d.createElement(ct.Z,s()({},e,{topBorder:0!==e.index})),items:(0,x.Yd)(Cc[e.option]).map((n=>({key:n,render:t=>{const a="number"===e.option?vc(n,i):void 0;return d.createElement(ot.Z,s()({},t,{title:z.default.formatMessage(Cc[e.option][n]),caption:a}))},action:()=>{N.createAndCommit({userAction:"CustomRegionalFormatSettings.SimpleFormatPicker",environment:t,perform:t=>{O.d2({userSettingsStore:e.userSettingsStore,data:{regional_format_settings:{...e.userSettingsStore.getRegionalFormatSettings(),use_default_region_settings:!1,region:uc(e.userSettingsStore),[e.option]:n}},transaction:t})}}),e.onAccept()}})))}]}))}function Tc(e){window.__c={n:"CustomizableFormatPicker"};const t=(0,Pe.O7)(),[i,n]=(0,d.useState)((()=>{})),o=(0,v.useIntl)(),r=(0,x.Yd)(Cc[e.option]),l=n=>{const a="custom"===n?{type:n,format:i}:{type:n};N.createAndCommit({userAction:"CustomRegionalFormatSettings.onAction",environment:t,perform:t=>{O.d2({userSettingsStore:e.userSettingsStore,data:{regional_format_settings:{...e.userSettingsStore.getRegionalFormatSettings(),use_default_region_settings:!1,region:uc(e.userSettingsStore),[e.option]:a}},transaction:t})}}),e.onAccept()};return a()(rt.Z,{menuType:it.og.Popup,width:216},void 0,a()(lt.Z,{type:lt.i.Vertical,initialFocus:void 0,sections:[{key:"options",render:e=>d.createElement(ct.Z,s()({},e,{topBorder:0!==e.index})),items:r.map((t=>({key:t,render:r=>{if("custom"===t)return d.createElement(wc.Z,s()({},r,{renderOrigin:i=>d.createElement(ot.Z,s()({},i,{title:z.default.formatMessage(Cc[e.option][t])})),onFocus:()=>{},renderExtension:()=>a()(Ic,{customFormat:i,onChange:e=>{n(e)},onAccept:()=>{l(t)}}),title:z.default.formatMessage(Cc[e.option][t])}));{const i="full_date"===e.option?Sc({type:t},o):bc({type:t},o);return d.createElement(ot.Z,s()({},r,{title:z.default.formatMessage(Cc[e.option][t]),caption:i}))}},action:()=>{l(t)}})))}]}))}function Ic(e){window.__c={n:"CustomDateFormatExtension"};const t=(0,xe.yK)((e=>({container:{},label:{color:e.mediumTextColor,fontWeight:f.Z.fontWeight.semibold,paddingTop:6,paddingBottom:6,paddingLeft:14,paddingRight:14},actionButton:{marginTop:6}})),[]);return a()("div",{style:t.container},void 0,a()("div",{},void 0,a()(Ae.Z,{isSmall:!0,style:t.label},void 0,a()(v.FormattedMessage,{id:"regionalFormatSettings.customDateFormat.title",defaultMessage:"Custom format"}))),a()(Mc.ZP,{focus:!0,value:e.customFormat||"",onChange:t=>{e.onChange(t.target.value)}}),a()(ot.Z,{style:t.actionButton,focused:!1,onClick:e.onAccept,title:a()(v.FormattedMessage,{id:"regionalFormatSettings.customDateFormat.applyChanges",defaultMessage:"Apply changes"})}))}function Pc(e){window.__c={n:"RegionalFormatSettings"};const t=(0,xe.yK)((()=>({container:{flex:1,display:"flex",flexDirection:"column"},controlRow:{flex:1,display:"flex"},label:{flex:1},subtitle:{width:"80%"}})),[]),i=(0,Ze.VK)((()=>e.userSettingsStore.isReady()),[e.userSettingsStore]),n=(0,Ze.VK)((()=>e.userSettingsStore.shouldUseDefaultRegionalFormatting()),[e.userSettingsStore]),o=(0,Pe.O7)();return i?a()("div",{style:t.container},void 0,a()("div",{style:t.controlRow},void 0,a()("div",{style:t.label},void 0,a()(Ae.Z,{},void 0,a()(v.FormattedMessage,{id:"regionalFormatSettings.label.title",defaultMessage:"Use regional defaults"})),a()(Ae.Z,{isSmall:!0,isMultiline:!0,style:t.subtitle},void 0,a()(v.FormattedMessage,{id:"regionalFormatSettings.label.subtitle",defaultMessage:"Automatically apply standard formats of your region"}))),a()(dr.Z,{on:n,onClick:()=>{N.createAndCommit({userAction:"RegionalFormatSettings.RegionalFormatSettings",environment:o,perform:t=>{const i=n?{use_default_region_settings:!1,full_date:void 0,short_date:void 0,time:void 0,number:void 0,week_start_on:void 0}:{use_default_region_settings:!0};O.d2({userSettingsStore:e.userSettingsStore,data:{regional_format_settings:{region:uc(e.userSettingsStore),...i}},transaction:t})}})}})),a()("div",{},void 0,a()(n?Zc:Ec,{userSettingsStore:e.userSettingsStore}))):a()(Ve.Z,{})}function Zc(e){window.__c={n:"DefaultRegionalFormatSettings"};const t=(0,xe.yK)((()=>({container:{marginTop:12}})),[]);return a()("div",{style:t.container},void 0,Ac.map((t=>a()(xc,{userSettingsStore:e.userSettingsStore,option:t}))))}function xc(e){window.__c={n:"DefaultRegionalFormatSetting"};const t=(0,xe.yK)((e=>({container:{display:"flex"},option:{color:e.lightTextColor,fontSize:f.Z.fontSize.UIRegular.desktop,width:100},example:{color:e.mediumTextColor,fontSize:f.Z.fontSize.UIRegular.desktop}})),[]),i=(0,v.useIntl)(),[n,o]=(0,Ze.VK)((()=>[e.userSettingsStore.isDefined(),Fc(e.userSettingsStore,i,e.option)]),[i,e.option,e.userSettingsStore]);return n?a()("div",{style:t.container},void 0,a()("div",{style:t.option},void 0,z.default.formatMessage(hc[e.option])),a()("div",{style:t.example},void 0,o)):a()(Ve.Z,{})}function Fc(e,t,i){if("full_date"===i){return Sc(mc(e,i),t)}if("short_date"===i){return bc(mc(e,i),t)}if("number"===i){return vc(mc(e,i),t)}if("week_start_on"===i){return function(e){return"sunday"===e?z.default.formatMessage(yc.sunday):"monday"===e?z.default.formatMessage(yc.monday):(0,x.t1)(e)}(mc(e,i))}return(0,x.t1)(i)}const Ac=["full_date","short_date","number","week_start_on"];function Ec(e){return a()("div",{},void 0,Ac.map((t=>a()(Bc,{userSettingsStore:e.userSettingsStore,option:t}))))}function Bc(e){window.__c={n:"CustomRegionalFormatSetting"};const t=(0,v.useIntl)(),[i,n,o]=(0,Ze.VK)((()=>[e.userSettingsStore.isDefined(),uc(e.userSettingsStore),Fc(e.userSettingsStore,t,e.option)]),[t,e.option,e.userSettingsStore]),s=(0,xe.yK)(Dc,[]);return i?d.createElement(d.Fragment,null,a()(Xo.Z,{size:24}),a()("div",{style:s.container},void 0,a()("div",{style:s.controlRow},void 0,a()("div",{style:s.label},void 0,a()(Ae.Z,{},void 0,z.default.formatMessage(hc[e.option])),a()(Ae.Z,{isSmall:!0,isMultiline:!0,style:s.subtitle},void 0,o)),a()(_c,{userSettingsStore:e.userSettingsStore,region:n,option:e.option})))):a()(Ve.Z,{})}function Dc(){return{container:{flex:1,display:"flex",flexDirection:"column"},controlRow:{flex:1,display:"flex"},label:{flex:1},subtitle:{width:"80%"}}}var Rc=i(80994);function Lc(e){window.__c={n:"RegionSettings"};const t=(0,xe.yK)((()=>({container:{flex:1,display:"flex"},label:{flex:1},subtitle:{width:"80%"}})),[]);return a()("div",{style:t.container},void 0,a()("div",{style:t.label},void 0,a()(Ae.Z,{},void 0,a()(v.FormattedMessage,{id:"regionSettings.region.label",defaultMessage:"Region"})),a()(Ae.Z,{isSmall:!0,isMultiline:!0,style:t.subtitle},void 0,a()(v.FormattedMessage,{id:"regionSettings.region.subtitle",defaultMessage:"Affects the default formats for dates, numbers, and currencies"}))),a()(Nc,{userSettingsStore:e.userSettingsStore,onChange:e.onChange,pickerLabel:e.pickerLabel}))}function Nc(e){window.__c={n:"RegionPicker"};const t=(0,xe.Fg)(),[,,i]=(0,Ze.AF)(void 0,Zt.Z),n=(0,Ze.VK)((()=>uc(e.userSettingsStore)),[e.userSettingsStore]),[o,r]=d.useState("");return a()(Et.ZP,{popupType:Et.Z4.Popup,buttonPopupStore:i,renderOrigin:i=>d.createElement(Xe.Z,i,e.userSettingsStore?n:e.pickerLabel,m.Z.chevronDown({width:10,marginLeft:4,fill:t.lightIconColor})),placementToOrigin:oc.Iw.Bottom,alignmentToOrigin:oc.lU.Start,render:t=>a()(rt.Z,{menuType:it.og.Popup,width:216,header:a()(Vc,{value:o,onChange:e=>r(e)})},void 0,a()(lt.Z,{type:lt.i.Vertical,initialFocus:void 0,sections:[{key:"regions",render:e=>d.createElement(ct.Z,s()({},e,{topBorder:0!==e.index})),items:(0,sa.ZP)(o,Rc.hW,(e=>e.name)).map((i=>({key:i.countryCode,render:e=>d.createElement(ot.Z,s()({},e,{title:i.name})),action:()=>{e.onChange(i.countryCode),t.close(),r("")}})))}]}))})}const Oc=(0,v.defineMessages)({regionSearchPlaceholder:{defaultMessage:"Search for a region...",id:"settings.regionSettings.regionSearch"}});function Vc(e){return a()(ct.Z,{isInput:!0},void 0,a()(Mc.ZP,{value:e.value,onChange:t=>{e.onChange(t.target.value)},focus:!0,placeholder:z.default.formatMessage(Oc.regionSearchPlaceholder),focusAfterAnimation:!0}))}var Uc=i(758),Wc=i(2911);const Kc=function(e){window.__c={n:"SpellcheckerLanguagesPicker"};const[t,i]=d.useState([]),[n,o]=d.useState([]),r=(0,Pe.O7)(),l=(0,Ze.qz)(void 0,Zt.Z),c=(0,xe.yK)((e=>({span:{color:e.mediumTextColor},plainButton:{paddingLeft:8,paddingRight:8,marginLeft:-8},icon:{width:10,marginLeft:4,fill:e.lightIconColor}})),[]);function u(e){return n.some((t=>t.code===e.code))}(0,d.useEffect)((()=>{const e=r.SpellCheckStore;e&&!(0,Uc.x)(e)&&(e.getAvailableLanguages().then(i).catch((e=>{Pa.log({level:"error",from:"SpellcheckerLanguagesPicker",type:"getAvailableLanguages",error:(0,Wc.Ui)(e)})})),e.getLanguages().then(o).catch((e=>{Pa.log({level:"error",from:"SpellcheckerLanguagesPicker",type:"getLanguages",error:(0,Wc.Ui)(e)})})))}),[r]),(0,d.useEffect)((()=>{const e=r.SpellCheckStore;if(!e||(0,Uc.x)(e))return;const t=n.map((e=>{let{code:t}=e;return t}));e.setLanguages(t)}),[n,r.SpellCheckStore]);const p=n.length>0?n.slice(0,3).map((e=>{let{name:t}=e;return t})).join(", ")+(n.length>3?"…":""):a()(v.FormattedMessage,{id:"languageRegionSettings.spellchecker.picker.label",defaultMessage:"Select languages"});return a()(Et.ZP,{popupType:Et.Z4.Popup,buttonPopupStore:l,renderOrigin:e=>d.createElement(d.Fragment,null,d.createElement(Xe.Z,s()({style:c.plainButton},e),p,m.Z.chevronDown(c.icon))),placementToOrigin:oc.Iw.Bottom,alignmentToOrigin:oc.lU.Start,render:e=>{const i=[{key:"spellcheckerlanguages",render:e=>d.createElement(ct.Z,s()({},e,{topBorder:0!==e.index})),items:t.map((e=>({key:e.code,render:t=>function(e){const t=e.language.name||e.language.code;return d.createElement(ot.Z,s()({},e.props,{title:a()("div",{style:{display:"flex",alignItems:"center"}},void 0,a()("div",{style:{marginRight:0}},void 0,t)),shouldWrapCaption:!0,right:u(e.language)?m.Z.checkmark({width:12,height:12}):void 0}))}({language:e,props:t}),action:()=>{u(e)?o(n.filter((t=>t.code!==e.code))):o([...n,e])}})))}],r={menuType:it.og.Popup,width:240};return d.createElement(rt.Z,s()({className:W.hKO},r),a()(lt.Z,{type:lt.i.Vertical,initialFocus:void 0,sections:i}))}})};const zc=function(e){window.__c={n:"SpellcheckerSettings"};const t=(0,Pe.O7)();return t.device.isElectron&&t.device.isWindows&&!Uc.x(t.SpellCheckStore)?d.createElement(d.Fragment,null,a()(Xo.Z,{size:24,isHidden:!0}),a()("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",width:"100%",height:"auto"}},void 0,a()("div",{style:{display:"flex",alignItems:"flex-start",width:"100%"}},void 0,a()("div",{style:{flex:1}},void 0,a()(Ae.Z,{},void 0,a()(v.FormattedMessage,{id:"languageRegionSettings.spellchecker.label",defaultMessage:"Spellchecker languages"})),a()(Ae.Z,{isSmall:!0,isMultiline:!0,style:{width:"80%"}},void 0,a()(v.FormattedMessage,{id:"languageSettings.spellcheckerSwitcher.subtitle",defaultMessage:"Change the languages used by the spellchecker."}))),a()(Kc,{})))):null};class Gc extends c.Z{renderComponent(){return Fe.Z.state.online?this.renderSettings():this.renderOfflineMessage()}renderOfflineMessage(){return a()(Ee.Z,{},void 0,a()(Ae.Z,{isSmall:!0,style:{textAlign:"center"}},void 0,a()(v.FormattedMessage,{defaultMessage:"Please go online to manage your language and region.",id:"languageSettings.offline.message"})))}renderSettings(){var e;const{currentUserSettingsStore:t}=A.default.state;if(!t)return;const i=(null===(e=t.getSettings())||void 0===e?void 0:e.preferred_locale)||er.al,n="on"===k.default.getGroup("aloha");return a()(Ee.Z,{},void 0,a()(Be.Z,{large:!0,divider:"full"},void 0,a()(v.FormattedMessage,{id:"languageSettings.languageSection.title",defaultMessage:"Language & region"})),a()(dc,{locale:i,userSettingsStore:t}),a()(zc,{}),a()(Xo.Z,{size:24}),n?a()("div",{style:{marginTop:12}},void 0,a()(Lc,{locale:i,userSettingsStore:t,onChange:e=>{}}),a()(Xo.Z,{size:24}),a()(Be.Z,{large:!0,divider:"full"},void 0,a()(v.FormattedMessage,{id:"languageSettings.formatsSection.title",defaultMessage:"Formats"})),a()(Pc,{locale:i,userSettingsStore:t}),a()(Xo.Z,{size:24})):a()(Jd.Z,{}))}}Gc.displayName="LanguageRegionSettings";const qc=Gc;var Hc=i(15311),jc=i(28187),Qc=i(21291),Yc=i(51124),$c=i(73490);function Xc(){window.__c={n:"NotificationSettings"};const{isElectron:e,isMobile:t}=(0,Pe.Fy)(),i=(0,Pe.O7)(),n=(0,Ze.VK)((()=>Fe.Z.state.online),[]),o=(0,Ze.VK)((()=>{const i=(0,jc.kC)();return function(e){const{isMobile:t,isElectron:i,showSlackNotificationSetting:n}=e;return[{key:"notify_mobile",renderSettingsItem:()=>a()(Qc.A,{target:"notify_mobile"})},!t&&i?{key:"notify_desktop",renderSettingsItem:()=>a()(Qc.A,{target:"notify_desktop"})}:void 0,n?{key:"notify_slack",renderSettingsItem:()=>a()($c.O,{target:"notify_slack"})}:void 0].filter(x.$K)}({isMobile:t,isElectron:e,showSlackNotificationSetting:i})}),[t,e]),s=(0,Ze.VK)((()=>{var e;return function(e){const{showNotifyEmailAlwaysSetting:t}=e;return[{key:"notify_email",renderSettingsItem:()=>a()(Qc.A,{target:"notify_email"})},t?{key:"notify_email_always",renderSettingsItem:()=>a()(Qc.A,{target:"notify_email_always"})}:void 0,{key:"notify_email_digest",renderSettingsItem:()=>a()(Qc.A,{target:"notify_email_digest"})},{key:"marketing_emails",renderSettingsItem:()=>a()(Qc.A,{target:"marketing_emails"})}].filter(x.$K)}({showNotifyEmailAlwaysSetting:(null===(e=A.default.state.currentSpaceViewStore)||void 0===e?void 0:e.getNotifyEmail())||!1})}),[]),r=(0,Ze.VK)((()=>i.WindowSizeStore.state.paddingBottomCSS),[i.WindowSizeStore]);return n?a()(Ee.Z,{disableScroller:t},void 0,a()(Be.Z,{large:!t,divider:"full"},void 0,a()(v.FormattedMessage,{id:"notificationSettings.notificationsSection.title",defaultMessage:"My notifications"})),a()(Yc.O,{items:o}),a()(Xo.Z,{size:48,isHidden:!0}),a()(Be.Z,{large:!t,divider:"full"},void 0,a()(v.FormattedMessage,{id:"notificationSettings.emailNotificationsSection.title",defaultMessage:"Email notifications"})),a()(Yc.O,{items:s}),a()(Xo.Z,{size:48,isHidden:!0}),a()("div",{style:{marginTop:4,marginBottom:t?r:void 0}},void 0,a()(Nr.Z,{title:a()(v.FormattedMessage,{id:"myNotificationSettings.helpButton.caption",defaultMessage:"Learn about notifications"}),href:(0,H.UY)("guides.notificationSettings"),analyticsFrom:"notifications_settings"}))):a()(Ee.Z,{},void 0,a()(Ae.Z,{isSmall:!0,style:{textAlign:"center"}},void 0,a()(v.FormattedMessage,{defaultMessage:"Please go online to manage your notification settings.",id:"myNotificationsSettings.goOnline.prompt"})))}var Jc=i(5851),eu=i(33689),tu=i(69435);class iu extends c.Z{constructor(){super(...arguments),this.storeTypes={tokenOptionsButtonPopupStore:Zt.Z,domainVerificationStore:Er.ZP},this.handleDisablePublicAccessSwitcherClick=async()=>{const{securitySettingsStore:e}=this.props,t=e.state.disablePublicAccess;if(!t){if(!(await M.confirmUserAction({message:a()(v.FormattedMessage,{id:"securitySAMLSettings.preventPublicSharing.confirmationModal.message",defaultMessage:"Are you sure? This will remove access for anyone who is not a member or guest of the workspace from all pages in this workspace."}),acceptLabel:a()(v.FormattedMessage,{id:"securitySAMLSettings.preventPublicSharing.confirmationModal.confirmButton.label",defaultMessage:"Yes"})})))return}this.handleSave({disablePublicAccess:!t})},this.handleAllowDisableGuestsSwitcherClick=async()=>{const{securitySettingsStore:e}=this.props,t=e.state.disableGuests;if(!t){if(!(await M.confirmUserAction({message:a()(v.FormattedMessage,{id:"securitySAMLSettings.disableGuests.confirmationModal.message",defaultMessage:"Are you sure? All guests in this workspace will be removed."}),acceptLabel:a()(v.FormattedMessage,{id:"securitySAMLSettings.disableGuests.confirmationModal.confirmButton.label",defaultMessage:"Yes"})})))return}this.handleSave({disableGuests:!t})},this.handleToggleClick=(e,t)=>{if(!t)return this.handleUpgradeClick();const{securitySettingsStore:i}=this.props;this.handleSave({[e]:!i.state[e]})},this.handleUpgradeClick=()=>{Pr.y(this.environment,{from:"space_saml",for:"enterprise"})}}renderComponent(){return Fe.Z.state.online?a()(Ee.Z,{},void 0,this.renderSecuritySettings()):this.renderOfflineMessage()}renderUpsell(){if(!(0,eu.J)({environment:this.environment}))return a()("div",{style:{border:`1px solid ${this.theme.regularDividerColor}`,borderRadius:3,padding:16,marginTop:void 0,marginBottom:24}},void 0,!(0,Q.Rs)()&&a()(tu.Z,{for:"business",from:"space_saml",upgradeMessage:a()(v.FormattedMessage,{id:"securitySAMLSettings.upsell.button.business",defaultMessage:"Upgrade to Business"}),title:a()(v.FormattedMessage,{id:"securitySAMLSettings.upsell.title.business",defaultMessage:"Upgrade for SAML SSO & more admin tools"}),caption:a()(v.FormattedMessage,{id:"securitySAMLSettings.upsell.caption.business",defaultMessage:"The Business Plan includes single sign-on to manage employee access at scale, private teamspaces to collaborate on sensitive docs, and more."}),learnMoreRoute:"guides.securitySettings",style:{marginBottom:"20px"}}),a()(tu.Z,{for:"enterprise",from:"space_saml",upgradeMessage:a()(v.FormattedMessage,{id:"securitySAMLSettings.upsell.button.enterprise",defaultMessage:"Upgrade to Enterprise"}),title:a()(v.FormattedMessage,{id:"securitySAMLSettings.upsell.title.enterprise",defaultMessage:"Upgrade for SCIM, advanced security & more"}),caption:a()(v.FormattedMessage,{id:"securitySAMLSettings.upsell.caption.enterprise",defaultMessage:"The Enterprise Plan allows you to automatically provision users and groups, and gain more visibility and controls across the workspace."}),learnMoreRoute:"guides.securitySettings"}))}renderSecuritySettings(){const{securitySettingsStore:e}=this.props,t=.5,i=a()(Zr.Z,{subscriptionTier:"enterprise",analyticsName:"space_saml",onClick:this.handleUpgradeClick,desktopStyle:{display:"inline-block",marginLeft:8,marginTop:-3}}),n=n=>a()("div",{},void 0,a()("div",{style:{display:"flex",alignItems:"center",cursor:"pointer"},onClick:n?this.handleDisablePublicAccessSwitcherClick:this.handleUpgradeClick},void 0,a()("div",{style:this.getTitleStyle()},void 0,a()(v.FormattedMessage,{id:"securitySAMLSettings.securitySection.preventPublicSharing.label",defaultMessage:"Disable public page sharing"}),!n&&i,a()(Ae.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"80%"}},void 0,a()(v.FormattedMessage,{id:"securitySAMLSettings.securitySection.preventPublicSharing.caption",defaultMessage:"Disable the Share to web option in the Share menu on every page in this workspace."}))),a()("div",{style:{marginTop:5,opacity:n?void 0:t}},void 0,a()(dr.Z,{on:e.state.disablePublicAccess,disabled:!n}))),a()(Xo.Z,{size:24,style:{opacity:0}})),o=n=>{if(!(0,F.bq)())return a()("div",{},void 0,a()("div",{style:{display:"flex",alignItems:"center",cursor:"pointer"},onClick:()=>this.handleToggleClick("disableSpacePageEdits",n)},void 0,a()("div",{style:this.getTitleStyle()},void 0,a()(v.FormattedMessage,{id:"securitySAMLSettings.securitySection.disableSpacePageEdits.label",defaultMessage:"Prevent members from editing the Workspace section"}),!n&&i,a()(Ae.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"85%"}},void 0,a()(v.FormattedMessage,{id:"securitySAMLSettings.securitySection.disableSpacePageEdits.caption",defaultMessage:"Disable the ability for members to create, move, reorder, and delete top-level Workspace pages."}))),a()("div",{style:{marginTop:5,opacity:n?void 0:t}},void 0,a()(dr.Z,{on:e.state.disableSpacePageEdits,disabled:!n}))),a()(Xo.Z,{size:24,style:{opacity:0}}))},s=n=>a()("div",{},void 0,a()("div",{style:{display:"flex",alignItems:"center",cursor:"pointer"},onClick:n?this.handleAllowDisableGuestsSwitcherClick:this.handleUpgradeClick},void 0,a()("div",{style:this.getTitleStyle()},void 0,a()(v.FormattedMessage,{id:"securitySAMLSettings.securitySection.disableGuests.label",defaultMessage:"Disable guests"}),!n&&i,a()(Ae.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"80%"}},void 0,a()(v.FormattedMessage,{id:"securitySAMLSettings.securitySection.disableGuests.caption",defaultMessage:"Prevent anyone from inviting people outside the workspace to pages."}))),a()("div",{style:{marginTop:5,opacity:n?void 0:t}},void 0,a()(dr.Z,{on:e.state.disableGuests,disabled:!n}))),a()(Xo.Z,{size:24,style:{opacity:0}})),r=n=>a()("div",{},void 0,a()("div",{style:{display:"flex",alignItems:"center",cursor:"pointer"},onClick:()=>this.handleToggleClick("disableMoveToSpace",n)},void 0,a()("div",{style:this.getTitleStyle()},void 0,a()(v.FormattedMessage,{id:"securitySAMLSettings.securitySection.disableMovingPages.label",defaultMessage:"Disable duplicating pages to other workspaces"}),!n&&i,a()(Ae.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"80%"}},void 0,a()(v.FormattedMessage,{id:"securitySAMLSettings.securitySection.disableMovingPages.caption",defaultMessage:"Prevent anyone from duplicating pages to other workspaces via the Move To or Duplicate To actions."}))),a()("div",{style:{marginTop:5,opacity:n?void 0:t}},void 0,a()(dr.Z,{on:e.state.disableMoveToSpace,disabled:!n}))),a()(Xo.Z,{size:24,style:{opacity:0}})),{state:l}=e,c=n=>a()("div",{},void 0,a()("div",{style:{display:"flex",alignItems:"center",cursor:"pointer"},onClick:()=>this.handleToggleClick("disableExport",n)},void 0,a()("div",{style:this.getTitleStyle()},void 0,a()(v.FormattedMessage,{id:"securitySAMLSettings.securitySection.disableExport.label",defaultMessage:"Disable export"}),!n&&i,a()(Ae.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"80%"}},void 0,a()(v.FormattedMessage,{id:"securitySAMLSettings.securitySection.disableExport.caption",defaultMessage:"Prevent anyone from exporting as Markdown, CSV, or PDF."}))),a()("div",{style:{marginTop:5,opacity:n?void 0:t}},void 0,a()(dr.Z,{on:e.state.disableExport,disabled:!n}))),a()(Xo.Z,{size:24,style:{opacity:0}}));return(0,eu.J)({environment:this.environment})?a()(d.Fragment,{},void 0,a()(Be.Z,{large:!0,divider:"full"},void 0,a()(v.FormattedMessage,{id:"securitySAMLSettings.securitySection.title",defaultMessage:"Security"})),void 0,n(!0),o(!0),s(!0),r(!0),c(!0),a()("div",{style:{height:36}})):a()(d.Fragment,{},void 0,this.renderUpsell(),a()("div",{style:this.getHeaderStyle()},void 0,a()("span",{style:{marginRight:8}},void 0,a()(v.FormattedMessage,{id:"securitySAMLSettings.securitySection.title",defaultMessage:"Security"}))),void 0,n(l.disablePublicAccess),o(l.disableSpacePageEdits),s(l.disableGuests),r(l.disableMoveToSpace),c(l.disableExport),a()("div",{style:{height:32}}))}renderOfflineMessage(){return a()(Ee.Z,{},void 0,a()(Ae.Z,{isSmall:!0,isMultiline:!0,style:{textAlign:"center"}},void 0,a()(v.FormattedMessage,{defaultMessage:"Please go online to manage security settings.",id:"securitySAMLSettings.offline.message"})))}handleSave(e){const{securitySettingsStore:t,spaceStore:i}=this.props;Jc.y(this.environment,{spaceStore:i,securitySettingsStore:t,fields:e})}getHeaderStyle(){return{fontWeight:f.Z.fontWeight.medium,fontSize:18,borderBottom:`1px solid ${this.theme.regularDividerColor}`,paddingBottom:6,marginBottom:12,display:"flex",alignItems:"center"}}getTitleStyle(){return{fontSize:14,marginRight:8,flexGrow:1}}}iu.displayName="SecuritySettings";const nu=(0,v.injectIntl)(iu);var au=i(58047);function ou(e){window.__c={n:"SettingsPrompt"};const t=(0,Pe.O7)(),{onView:i}=e;return(0,d.useEffect)((()=>{i(t)}),[t,i]),a()("div",{},void 0,a()(Xo.Z,{size:0}),a()(au.N,{icon:e.icon,title:e.title,description:e.descriptionMessage,onDismiss:e.onDismiss,primaryAction:{text:e.buttonText,onClick:t=>(e.onDismiss(),e.onClick(t))},secondaryAction:{icon:e=>m.Z.help(e),text:a()(v.FormattedMessage,{id:"settingsPrompt.learnMore.button",defaultMessage:"Learn more"}),onClick:e.onClickLearnMore}}))}class su extends c.Z{renderComponent(){return a()("div",{style:this.getStyle(),onMouseDown:this.props.onMouseDown,onClick:this.props.onClick,onDoubleClick:this.props.onDoubleClick,onContextMenu:this.props.onContextMenu},void 0,a()("div",{style:this.getSidebarStyle()},void 0,this.props.sidebar),a()("div",{style:this.getChildrenStyle()},void 0,this.props.children))}getStyle(){return{display:"flex",height:"100%",flexDirection:this.props.isReversed?"row-reverse":"row"}}getSidebarStyle(){return{height:"100%",background:this.theme.cardSidebarBackground,flexGrow:0,flexShrink:0,width:240,overflowY:"auto"}}getChildrenStyle(){return{flexGrow:1,position:"relative",zIndex:1,height:"100%"}}}su.displayName="SidebarBox";const ru=su,lu="last_90_days",du={field:"last_active",direction:"desc"};async function cu(e){var t,i;const{environment:n,filter:a,spaceId:o,spaceAnalyticsStore:s}=e,r=null===(t=s.usersTabData)||void 0===t?void 0:t.dailyUsersData;if(!r||a!==(null===(i=s.usersTabData)||void 0===i?void 0:i.graphFilter)||s.currentSpaceId!==o){const e=await T.getDailyUsersAnalytics(n,{spaceId:o,activeWindow:"all_time"===a?"last_90_days":a});return"failed"===e.type?e.body:e.data}return r}async function uu(e){var t,i,n;const{environment:a,filter:o,sort:s,spaceStore:r,spaceAnalyticsStore:l}=e,d=null===(t=l.usersTabData)||void 0===t?void 0:t.tableFilter,c=null===(i=l.usersTabData)||void 0===i?void 0:i.userTableSort;if(null===(n=l.usersTabData)||void 0===n||!n.usersAndStats||d!==o||!c||c.direction!==s.direction||c.field!==s.field||l.currentSpaceId!==r.id){const e=await T.loadWorkspaceAnalyticsUsers(a,{spaceId:r.id,filters:{timeRange:o},sort:s});return"failed"===e.type?e.body:e.data.users.map((e=>({stats:e,userStore:He.U6.createChildStore(r,{table:Qt.KJ,id:e.userId})}))).filter((e=>{let{userStore:t}=e;return t.isDefined()}))}return l.usersTabData.usersAndStats}function mu(e,t){if((0,Cn.qC)(e)){const i=(0,kn.nX)(t,e);if(i)return i}return t.formatMessage({defaultMessage:"Failed to retrieve analytics. Try refreshing and reopening the settings.",id:"workspaceAnalytics.usersTab.refershUserAnalytics.defaultFailed"})}const pu={pageViews:0,uniquePageViews:0,pagesCreated:0,pageEdits:0,topPages:[]};const gu={activeMembersCount:0,previousActiveMembersCount:0,activeGuestsCount:0,previousActiveGuestsCount:0,topTeamspaces:[],topViewers:[],topEditors:[]};function hu(e){return a()(Et.ZP,{popupType:dt.kQ.Popup,alignmentToOrigin:ka.v.End,render:t=>{let{close:i}=t;return a()(fu,{closePopup:i,analyticsType:e.analyticsType})},renderOrigin:t=>{let{onClick:i}=t;return a()(Re.Z,{style:e.style,onClick:i},void 0,a()(v.FormattedMessage,{id:"spaceAnalytics.usersTab.export",defaultMessage:"Export as CSV"}))}})}function fu(e){window.__c={n:"ExportAnalyticsMenu"};const{analyticsType:t,closePopup:i}=e,n=(0,Pe.O7)(),o=(0,Ze.VK)((()=>{var e;return null===(e=A.default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]),s=(0,d.useCallback)((async e=>{if(o){switch(t){case he.Users:b.LbR(n,{daysFilter:e}),await De.Tp(n,{spaceId:o,daysFilter:e});break;case he.Content:b.ZaS(n,{daysFilter:e}),await De.hN(n,{spaceId:o,daysFilter:e});break;default:(0,x.t1)(t)}i()}}),[n,o,t,i]),r=Fa.Hz.map((e=>a()(ot.Z,{focused:!1,onClick:()=>s(e),title:z.default.formatMessage(Fa.Rh[e])},e)));return a()(rt.Z,{menuType:it.og.Popup},void 0,a()(ct.Z,{},void 0,r))}const vu=(0,v.defineMessages)({emptyAnalyticsHeading:{id:"workspaceAnalyticsTabs.empty.heading",defaultMessage:"No workspace analytics yet"},emptyAnalyticsDescription:{id:"workspaceAnalyticsTabs.empty.description",defaultMessage:"It may take some time for workspace analytics information to appear."},disabledAnalyticsHeading:{id:"workspaceAnalyticsTabs.disabled.heading",defaultMessage:"Analytics are disabled"},disabledAnalyticsDescription:{id:"workspaceAnalyticsTabs.disabled.description",defaultMessage:"A workspace owner has turned off page view recording for {name}.{br}This information will not be available in your workspace settings or on individual pages."},disabledAnalyticsDescriptionNoSpaceName:{id:"workspaceAnalyticsTabs.disabled.description.unnamed",defaultMessage:"A workspace owner has turned off page view recording for this space.{br}This information will not be available in your workspace settings or on individual pages."}});function yu(e){window.__c={n:"SpaceAnalyticsEmptyState"};const t=(0,xe.yK)((e=>({outerDiv:{display:"flex",flexDirection:"column",justifyContent:"center",height:"80%",gap:24},innerDiv:{display:"flex",flexDirection:"column",textAlign:"center",alignItems:"center",gap:4},header:{fontSize:16,fontWeight:500},analyticsIcon:{fill:e.mediumTextColor,padding:20,height:150,width:150},learnMoreIcon:{width:14,height:14},learnMore:{gap:4}})),[]),i=(0,Pe.O7)(),{type:n,spaceName:o}=e,r=function(e,t){switch(e){case"empty":return{heading:z.default.formatMessage(vu.emptyAnalyticsHeading),description:z.default.formatMessage(vu.emptyAnalyticsDescription)};case"disabled":const e=t?d.createElement(v.FormattedMessage,s()({},vu.disabledAnalyticsDescription,{values:{name:t,br:a()("br",{})}})):d.createElement(v.FormattedMessage,s()({},vu.disabledAnalyticsDescriptionNoSpaceName,{values:{br:a()("br",{})}}));return{heading:z.default.formatMessage(vu.disabledAnalyticsHeading),description:e}}}(n,o);return a()("div",{style:t.outerDiv},void 0,a()("div",{style:t.innerDiv},void 0,m.Z.analyticsSearch(t.analyticsIcon),a()(Ae.Z,{isSecondaryColor:!0,style:t.header},void 0,r.heading),a()(Ae.Z,{isSecondaryColor:!0},void 0,r.description),a()(Xe.Z,{onClick:()=>w.navigateToExternalURL({environment:i,url:(0,H.UY)("guides.workspaceAnalytics")}),style:t.learnMore},void 0,m.Z.help(t.learnMoreIcon),a()(Ae.Z,{isSmall:!0},void 0,a()(v.FormattedMessage,{id:"workspaceAnalyticsTabs.disabled.learnMore",defaultMessage:"Learn more"})))))}var Su=i(35314);function bu(e){let{num:t,abbreviateNumber:i}=e;window.__c={n:"NumberDisplay"};const n=(0,v.useIntl)(),o=(0,er.E2)(n),s=t.toLocaleString(o),r=Intl.NumberFormat(o,{notation:"compact",maximumFractionDigits:1}).format(t);return i?a()(We.Z,{placement:We.Z.Placement.Bottom,render:e=>d.createElement("span",e,r),renderTooltip:()=>s}):a()("span",{},void 0,s)}function Mu(e){let{icon:t,iconStyles:i,textStyles:n,style:o,title:s,byline:r,loading:l,error:d}=e;window.__c={n:"AnalyticsCardOverview"};const c=function(e,t,i){return(0,xe.yK)((n=>({title:{fontWeight:f.Z.fontWeight.medium,fontSize:16},byline:{fontSize:f.Z.fontSize.UISmall.desktop,marginTop:4},textContainer:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",width:"100%",...t},titleContainer:{display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center",gap:8},icon:{height:28,width:28,color:n.lightTextColor,fill:"currentcolor",...e},container:{height:"100%",flex:1,display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center",border:`1px solid ${n.outlineButtonBorder}`,borderRadius:4,padding:12,gap:8,...i},loadingTitle:{display:"block",width:"40%"},loadingByline:{display:"block",width:"60%",marginTop:8,marginBottom:6},errorTitle:{textAlign:"center",color:qn.ZP.red}})),[e,t,i])}(i,n,o);return l?a()("div",{style:c.container},void 0,a()("div",{style:c.textContainer},void 0,a()("div",{style:c.loadingTitle},void 0,a()(Sa.Z,{paragraphs:[{lineHeight:18,lineMargin:0,sectionWidths:[100],repeat:0,sectionMargin:0}]})),r?a()("div",{style:c.loadingByline},void 0,a()(Sa.Z,{paragraphs:[{lineHeight:14,lineMargin:0,sectionWidths:[100],repeat:0,sectionMargin:0}]})):null)):d?a()("div",{style:c.container},void 0,a()("div",{style:c.titleContainer},void 0,a()(Ae.Z,{style:c.errorTitle},void 0,(0,Cn.Jx)(d)?d.message:a()(v.FormattedMessage,{id:"spaceAnalytics.basicErrorMessage",defaultMessage:"Something went wrong.{br}Try refreshing the page.",values:{br:a()("br",{})}})))):a()("div",{style:c.container},void 0,t?t(c.icon):null,a()("div",{style:c.textContainer},void 0,a()(Ae.Z,{style:c.title},void 0,s),r?a()(Ae.Z,{style:c.byline},void 0,r):null))}var wu=i(67579);const Cu=640;function _u(e){let{data:t,loading:i,error:n,daysFilter:o,setDaysFilter:r}=e;window.__c={n:"ContentAnalyticsSummaries"};const[l,c]=(0,Su.e)(),u=(0,xe.yK)((e=>({title:{fontWeight:f.Z.fontWeight.medium,fontSize:16,marginBlock:"8px 4px",display:"flex",alignItems:"center",justifyContent:"center"},infoIcon:{marginLeft:4},container:{display:"flex",flexDirection:"column",gap:16},titleContainer:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",gap:16},cardContainer:{justifyContent:"flex-start",gap:18},cardTextContainer:{alignItems:"flex-start"}})),[]),{pageViews:p,uniquePageViews:g,pagesCreated:h,pageEdits:y}=t,S=(0,Pe.O7)(),M=(0,d.useCallback)((e=>{b.kyK(S,{daysFilter:e}),r(e)}),[S,r]);return d.createElement("div",{style:u.container,ref:l},a()("div",{style:u.titleContainer},void 0,a()(Ae.Z,{style:u.title},void 0,a()(v.FormattedMessage,{id:"workspaceAnalytics.content.contentEngagement.title",defaultMessage:"Content engagement"}),a()(We.Z,{placement:ka.u.Bottom,render:e=>d.createElement(Nr.Z,s()({},e,{href:(0,H.UY)("guides.workspaceAnalytics"),analyticsFrom:"workspace_analytics_faq",style:u.infoIcon})),renderTooltip:()=>a()(v.FormattedMessage,"all_time"!==o?{id:"settings.workspaceAnalytics.contentTab.contentEngagement.tooltip.lastDays",defaultMessage:"Activity on all workspace pages (includes private and shared) over the {dateRange}",values:{dateRange:z.default.formatMessage(Fa.xX[o])}}:{id:"settings.workspaceAnalytics.contentTab.contentEngagement.tooltip.allTime",defaultMessage:"All time activity on all pages in the workspace (includes private and shared)"})})),a()(wu.f,{currentFilter:o,onChangeFilter:M})),a()(Ol,{gap:16},void 0,a()(Vl,{row:1,col:1},void 0,a()(Mu,{style:u.cardContainer,textStyles:u.cardTextContainer,loading:i,error:n,icon:m.Z.eyePadded,iconStyles:{height:48,width:48},title:a()(v.FormattedMessage,{id:"workspaceAnalytics.content.contentEngagement.totalViews",defaultMessage:"{pageViews} total views",values:{pageViews:a()(bu,{abbreviateNumber:c<Cu,num:p})}}),byline:a()(Ae.Z,{isSecondaryColor:!0},void 0,a()(v.FormattedMessage,{id:"workspaceAnalytics.content.contentEngagement.uniqueViews",defaultMessage:"{uniquePageViews} unique page views",values:{uniquePageViews:a()(bu,{abbreviateNumber:c<Cu,num:g})}}))})),a()(Vl,{row:1,col:2},void 0,a()(Mu,{style:u.cardContainer,textStyles:u.cardTextContainer,loading:i,error:n,icon:m.Z.searchInPage,iconStyles:{height:36,width:36},title:a()(v.FormattedMessage,{id:"workspaceAnalytics.content.contentEngagement.pagesCreated",defaultMessage:"{pagesCreated} pages created",values:{pagesCreated:a()(bu,{abbreviateNumber:c<Cu,num:h})}}),byline:a()(Ae.Z,{isSecondaryColor:!0},void 0,a()(v.FormattedMessage,{id:"workspaceAnalytics.content.contentEngagement.pageEdits.byline",defaultMessage:"{pageEdits} edits",values:{pageEdits:a()(bu,{abbreviateNumber:c<Cu,num:y})}}))}))))}function ku(e){const{tooltipMessageDescriptor:t,columnHeader:i}=e;return a()(We.Z,{placement:We.Z.Placement.Top,renderTooltip:e=>d.createElement("div",e,d.createElement(v.FormattedMessage,t)),render:e=>d.createElement("div",e,z.default.formatMessage(i))})}function Tu(e){let{blockStore:t}=e;window.__c={n:"PageCellActions"};const i=(0,Pe.O7)(),n=(0,Ze.qz)(void 0,Zt.Z),o=(0,xe.yK)((e=>({changePermissionsIcon:{height:18,width:18,color:e.regularIconColor,fill:"currentColor"},copyLinkIcon:{height:15,width:15,color:e.regularIconColor,fill:"currentColor"},openLinkIcon:{height:15,width:15,color:e.regularIconColor,fill:"currentColor",transform:"rotate(-45deg)"}})),[]);const r={key:"actions",render:e=>d.createElement(ct.Z,e),items:[{key:"copy-link",render:e=>d.createElement(ot.Z,s()({},e,{icon:m.Z.link(o.copyLinkIcon),title:a()(v.FormattedMessage,{id:"adminContentSearchTab.pagesTable.page.actions.copyLink",defaultMessage:"Copy link to page"})})),action:async function(){const e=(0,It.ZP)({store:t,pageVisitSource:kt.tY.CopyLink});await Tt.RD({environment:i,stringValue:e,copiedMessage:Tt.tq.copiedLinkToClipboard}),n.setState({open:!1})}},{key:"open-page-in-new-tab",render:e=>d.createElement(ot.Z,s()({},e,{icon:m.Z.arrowRight(o.openLinkIcon),title:a()(v.FormattedMessage,{id:"adminContentSearchTab.pagesTable.page.actions.openLink",defaultMessage:"Open in new tab"})})),action:function(){const e=(0,It.ZP)({store:t,pageVisitSource:kt.tY.LinkInPage});w.navigateToExternalURL({environment:i,url:e}),n.setState({open:!1})}}]};return a()(Et.ZP,{popupType:dt.kQ.Popup,alignmentToOrigin:dt.ZP.Alignment.Center,placementToOrigin:dt.ZP.Placement.Right,style:{width:248},render:()=>a()(rt.Z,{menuType:it.og.Popup,width:248},void 0,a()(lt.Z,{type:lt.i.Vertical,initialFocus:void 0,sections:[r]})),buttonPopupStore:n,renderOrigin:e=>d.createElement(Bt.Z,s()({icon:m.Z.dots},e))})}const Iu=(0,v.defineMessages)({views:{id:"workspaceAnalytics.contentTab.contentTable.viewsColumn.tooltip",defaultMessage:"Number of times users have viewed the page"},uniqueViews:{id:"workspaceAnalytics.contentTab.contentTable.uniqueViewsColumn.tooltip",defaultMessage:"Total number of users that have viewed page in the selected period"}}),Pu={id:"page",headerTitle:a()(Lu,{message:Fa.y3.page}),renderCell:e=>a()(Ye,{blockStore:e.navigableBlockStore,rightIcon:a()(Tu,{blockStore:e.navigableBlockStore})}),widthData:{width:320,maxWidth:320},sortable:!1},Zu={id:"location",headerTitle:a()(v.FormattedMessage,{id:"settings.workspaceAnalytics.contentTab.allPages.table.location.name",defaultMessage:"Location"}),renderCell:e=>a()(_t,{blockStore:e.navigableBlockStore,teamStore:e.teamStore}),widthData:{width:140},sortable:!1},xu={id:"audience",headerTitle:a()(Lu,{message:Fa.y3.audience}),renderCell:e=>a()(Ae.Z,{},void 0,bt(e.audience)),widthData:{width:140},sortable:!1},Fu={id:"views",headerTitle:a()(ku,{tooltipMessageDescriptor:Iu.views,columnHeader:Fa.y3.allViews}),renderCell:e=>a()(Ae.Z,{},void 0,e.views.toLocaleString()),widthData:{width:100},sortable:!0},Au={id:"uniqueViews",headerTitle:a()(ku,{tooltipMessageDescriptor:Iu.uniqueViews,columnHeader:Fa.y3.uniqueViews}),renderCell:e=>a()(Ae.Z,{},void 0,e.uniqueViews.toLocaleString()),widthData:{width:100},sortable:!0},Eu={id:"createdBy",headerTitle:a()(Lu,{message:Fa.y3.createdBy}),renderCell:e=>e.createdById?a()(oi,{blockStore:e.navigableBlockStore,userIds:[e.createdById]}):null,widthData:{width:140},sortable:!1},Bu={id:"createdTime",headerTitle:a()(Lu,{message:Fa.y3.createdAt}),renderCell:e=>a()(ze,{dateTs:e.createdTime}),widthData:{width:100},sortable:!1},Du=[Pu,Fu,Au,Zu,xu,{id:"lastEditedBy",headerTitle:a()(Lu,{message:Fa.y3.lastEditedBy}),renderCell:e=>e.lastEditedById?a()(oi,{blockStore:e.navigableBlockStore,userIds:[e.lastEditedById]}):null,widthData:{width:140},sortable:!1},{id:"lastEditedTime",headerTitle:a()(Lu,{message:Fa.y3.lastEditedAt}),renderCell:e=>a()(ze,{dateTs:e.lastEditedTime}),widthData:{width:100},sortable:!1},Eu,Bu];function Ru(e){let{navigableBlockStores:t,analyticsByPageId:i,runNewSearch:n,sort:o,setSort:s,loadNextPage:r,loading:l,error:c}=e;window.__c={n:"ContentAnalyticsTable"};const u=(0,Ze.VK)((()=>t.map((e=>{var t,n,a;return{id:e.id,isClickable:!1,navigableBlockStore:e,teamStore:(0,Ne.VP)(e),views:(null===(t=i.get(e.id))||void 0===t?void 0:t.pageViews)||0,uniqueViews:(null===(n=i.get(e.id))||void 0===n?void 0:n.uniquePageViews)||0,createdTime:e.getCreatedTime(),lastEditedTime:e.getLastEditedTime(),createdById:e.getCreatedById(),lastEditedById:e.getLastEditedById(),audience:(null===(a=i.get(e.id))||void 0===a?void 0:a.audience)||"private"}}))),[t,i]),m=(0,d.useMemo)((()=>function(e){const t=Du.find((t=>"pageViews"===e.field&&"views"===t.id||"uniquePageViews"===e.field&&"uniqueViews"===t.id));return t?{column:t,sortAscending:"asc"===e.direction}:void 0}(o)),[o]),p=(0,xe.yK)((e=>(0,Oe.b)({columnRenderInfo:Du,theme:e,containerMarginTop:0})),[]),g=(0,xe.yK)((e=>({emptyQuery:{marginTop:15,marginBottom:40,textAlign:"center"},loadingSpinner:{margin:"24px auto 24px"}})),[]);return c?a()(tt,{error:c,runNewSearch:n}):d.createElement(d.Fragment,null,a()(Oe.D,{hideHeaderRowPadding:!0,allowHorizontalScroll:!0,setStickyHeaderRow:!0,maxHeight:500,columnRenderInfo:Du,rows:u,sortState:m,onSortStateChanged:e=>{s(function(e){const t="views"===e.column.id?"pageViews":"uniquePageViews",i=e.sortAscending?"asc":"desc";return{field:t,direction:i}}(e))},onScrollBottom:r,renderNoRowsComponent:()=>a()(Ae.Z,{isSmall:!0,style:g.emptyQuery},void 0,!l&&0===t.length&&a()(v.FormattedMessage,{id:"settings.workspaceAnalytics.contentTab.allPages.table.empty",defaultMessage:"No pages found with your query."})),styles:p}),l?a()(Ve.Z,{style:g.loadingSpinner}):null)}function Lu(e){let{message:t}=e;window.__c={n:"FormatDefinedMessage"};const i=(0,v.useIntl)();return d.createElement(d.Fragment,null,i.formatMessage(t))}const Nu={query:"",createdBy:[],lastEditedTime:{starting:void 0,ending:void 0},createdTime:{starting:void 0,ending:void 0},teamIds:[]},Ou={field:"pageViews",direction:"desc"},Vu=lu,Uu={filters:Nu,sort:Ou,timeRange:Vu,navigableBlockStores:[],analyticsByPageId:new Map,numPagesLoaded:0,paginationToken:void 0,hasNextPage:!0,loading:!1,error:void 0,shouldReRunSearch:!1};const Wu=(0,v.defineMessages)({placeholder:{id:"settings.workspaceAnalytics.contentTab.placeholder",defaultMessage:"Search by title"}});function Ku(e){let{spaceStore:t,timeRange:i,filters:n,runNewSearch:o,setFilters:s,setTimeRange:r}=e;window.__c={n:"SearchInputsSection"};const l=(0,Ze.VK)((()=>Ed.Z.state.teams),[]),d=(0,xe.yK)((e=>({container:{width:"100%",margin:"0 auto 14px"},filterPillsContainer:{width:"100%",display:"flex",flexWrap:"wrap",rowGap:4,flexDirectionRow:"row",alignItems:"center"},timeRangeContainer:{display:"flex",flexDirectionRow:"row",alignItems:"center",justifyContent:"center",gap:4,borderRight:`1px solid ${e.tableDividerColor}`,marginRight:12,paddingRight:6}})),[]);return a()("div",{style:d.container},void 0,a()(on,{mode:nn.OnChange,query:n.query,setQueryFilter:function(e){s({query:e},{runSearchAfter:!0})},placeholderText:z.default.formatMessage(Wu.placeholder)}),a()("div",{style:d.filterPillsContainer},void 0,a()("div",{style:d.timeRangeContainer},void 0,a()(Ae.Z,{isSecondaryColor:!0},void 0,a()(v.FormattedMessage,{id:"settings.workspaceAnalytics.contentTab.timeRange",defaultMessage:"Views from"})),a()(wu.f,{currentFilter:i,onChangeFilter:r})),a()(ln,{selectedTeamIds:n.teamIds,setSelectedTeamIds:function(e){s({teamIds:e})},onMenuClose:o,teamStores:l}),a()(_i,{spaceStore:t,createdByFilterIds:n.createdBy,setCreatedByFilter:function(e){s({createdBy:e})},runNewSearch:o,includeGuests:!1}),a()(Ji,{lastEditedTime:n.lastEditedTime,createdTime:n.createdTime,setLastEditedTime:function(e){s({lastEditedTime:e,createdTime:{starting:void 0,ending:void 0}},{runSearchAfter:!0})},setCreatedOnTime:function(e){s({createdTime:e,lastEditedTime:{starting:void 0,ending:void 0}},{runSearchAfter:!0})}})))}function zu(e){var t;let{spaceStore:i,contentEngagement:n}=e;window.__c={n:"SpaceAnalyticsContentTab"};const o=(0,d.useRef)(!1),{loadNextPage:s,navigableBlockStores:r,analyticsByPageId:c,runNewSearch:u,setFilters:m,setTimeRange:p,timeRange:g,filters:h,sort:f,setSort:v,loading:y,error:S}=function(e){let{spaceStore:t}=e;const i=(0,Pe.O7)(),[n,a]=(0,d.useState)(Uu),o=(0,d.useRef)(Nu),s=(0,d.useRef)(Ou),r=(0,d.useRef)(Vu),c=(0,d.useCallback)((async e=>{let{fetchFromFirstPage:d,ignoreSearchInputComparison:c}=e;const u=!l().isEqual(n.filters,o.current)||!l().isEqual(n.sort,s.current)||!l().isEqual(n.timeRange,r.current);if(!c&&!u)return;o.current=n.filters,s.current=n.sort,r.current=n.timeRange;let m=n.loading,p=n.error,g=n.hasNextPage,h=n.paginationToken;if(d&&(a((e=>({...Uu,filters:e.filters,timeRange:e.timeRange,sort:e.sort}))),m=Uu.loading,p=Uu.error,g=Uu.hasNextPage,h=Uu.paginationToken),!g||m)return;if(p)return;a((e=>({...e,loading:!0})));const f=await T.loadContentAnalytics(i,{spaceId:t.id,sort:n.sort,titleQuery:n.filters.query,filters:{inTeams:n.filters.teamIds,lastEditedTime:(0,ne.Hq)(n.filters.lastEditedTime),createdTime:(0,ne.Hq)(n.filters.createdTime),createdBy:n.filters.createdBy},timeRange:n.timeRange,startCursor:h});if("failed"===f.type)return void a((e=>({...e,loading:!1,error:f.error})));const v=f.data.results;a((e=>{const t=[],n=new Map(e.analyticsByPageId),a=new Set(e.navigableBlockStores.map((e=>e.id)));for(const s of v){const e=s.id,o=s.analytics;if(!a.has(e)){const a=new He.G(i,{table:hn.iU,id:e});t.push(a),n.set(e,o)}}const o=[...e.navigableBlockStores,...t];return{...e,navigableBlockStores:o,analyticsByPageId:n,loading:!1,error:void 0,numPagesLoaded:e.numPagesLoaded+1,paginationToken:f.data.nextCursor,hasNextPage:Boolean(f.data.nextCursor)}}))}),[i,t,n.filters,n.sort,n.timeRange,n.loading,n.error,n.hasNextPage,n.paginationToken]);(0,d.useEffect)((()=>{n.shouldReRunSearch&&(a((e=>({...e,shouldReRunSearch:!1}))),c({fetchFromFirstPage:!0,ignoreSearchInputComparison:!1}))}),[n.shouldReRunSearch,c]);const u=(0,d.useCallback)((async()=>{n.shouldReRunSearch||await c({fetchFromFirstPage:!1,ignoreSearchInputComparison:!0})}),[n.shouldReRunSearch,c]),m=(0,d.useCallback)((async e=>{await c({fetchFromFirstPage:!0,ignoreSearchInputComparison:e||!1})}),[c]),p=(0,d.useCallback)(((e,t)=>{a((i=>({...i,filters:{...i.filters,...e},...null!=t&&t.runSearchAfter?{shouldReRunSearch:null==t?void 0:t.runSearchAfter}:void 0})));for(const n of(0,x.Yd)(e))l().isEqual(e[n],Nu[n])||b.uSc(i,{filter:n,value:"createdBy"===n||"teamIds"===n?e[n]:void 0})}),[i]),g=(0,d.useCallback)((e=>{a((t=>({...t,timeRange:e,shouldReRunSearch:!0}))),b.e2(i,{daysFilter:e})}),[i]),h=(0,d.useCallback)((e=>{a((t=>({...t,sort:e,shouldReRunSearch:!0}))),b.jMN(i,{column:e.field,isAscending:"asc"===e.direction})}),[i]);return{...n,loadNextPage:u,runNewSearch:m,setFilters:p,setTimeRange:g,setSort:h}}({spaceStore:i}),M=(0,xe.yK)((e=>({container:{display:"flex",flexDirection:"column",gap:16}})),[]),w=(0,Ze.VK)((()=>Boolean(i.canAdmin())),[i]);(0,d.useEffect)((()=>{o.current||(u(!0),o.current=!0)}),[u]);const C=(0,Ze.VK)((()=>i.getName()),[i]);return"NotFoundError"===(null==n||null===(t=n.error)||void 0===t?void 0:t.name)?a()(yu,{type:"empty",spaceName:C}):a()("div",{style:M.container},void 0,a()(_u,{data:n.data,loading:n.loading,error:n.error,daysFilter:n.daysFilter,setDaysFilter:n.setDaysFilter}),a()(Gu,{canAdmin:w,daysFilter:g}),a()(Ku,{spaceStore:i,runNewSearch:u,setFilters:m,filters:h,timeRange:g,setTimeRange:p}),a()(Ru,{navigableBlockStores:r,analyticsByPageId:c,runNewSearch:u,sort:f,setSort:v,loadNextPage:s,loading:y,error:S}))}function Gu(e){window.__c={n:"ContentTableHeader"};const t=(0,xe.yK)((()=>({sectionTitle:{fontWeight:f.Z.fontWeight.semibold,fontSize:16},sectionTitleSection:{display:"flex",flexFlow:"row",alignItems:"center"},helpInfo:{marginLeft:4},wrapper:{display:"flex",flexDirection:"row",justifyContent:"space-between",marginTop:12},exportButton:{marginLeft:5}})),[]),{canAdmin:i,daysFilter:n}=e,o=a()("div",{style:t.sectionTitleSection},void 0,a()(Ae.Z,{style:t.sectionTitle},void 0,a()(v.FormattedMessage,{id:"settings.workspaceAnalytics.contentTab.allPages.title",defaultMessage:"Pages"})),a()(We.Z,{placement:We.Z.Placement.Bottom,render:e=>d.createElement(Nr.Z,s()({},e,{href:(0,H.UY)("guides.workspaceAnalytics"),analyticsFrom:"workspace_analytics_faq",style:t.helpInfo})),renderTooltip:()=>a()(v.FormattedMessage,"all_time"!==n?{id:"settings.workspaceAnalytics.contentTab.pages.tooltip.lastDays",defaultMessage:"Activity from the {dateRange} on pages you have access to",values:{dateRange:z.default.formatMessage(Fa.xX[n])}}:{id:"settings.workspaceAnalytics.contentTab.pages.tooltip.allTime",defaultMessage:"All time activity on pages you have access to in the workspace"})}));return a()("div",{style:t.wrapper},void 0,o,i&&a()(hu,{style:t.exportButton,analyticsType:he.Content}))}var qu=i(76798);function Hu(e){let{title:t,items:i,loading:n,error:o}=e;window.__c={n:"AnalyticsCardList"};const s=(0,xe.yK)((e=>({title:{fontWeight:f.Z.fontWeight.semibold,marginBottom:8},container:{flex:1,display:"flex",flexDirection:"column",justifyContent:"flex-start",alignItems:"flex-start",height:"100%",border:`1px solid ${e.outlineButtonBorder}`,borderRadius:4,padding:12}})),[]);return a()("div",{style:s.container},void 0,a()(Ae.Z,{style:s.title},void 0,t),n?d.createElement(d.Fragment,null,a()(Qu,{}),a()(Qu,{}),a()(Qu,{}),a()(Qu,{}),a()(Qu,{})):o?d.createElement(d.Fragment,null,a()(Yu,{})):i.map(((e,t)=>a()(ju,{item:e},t))))}function ju(e){let{item:t}=e;window.__c={n:"CardListItem"};const{store:i,caption:n}=t,o=(0,v.useIntl)(),s=$u(),r=(0,Ze.VK)((()=>{switch(i.table){case"block":return a()("div",{style:s.nameAndIconContainer},void 0,a()(je.Z,{icon:i.getIcon(),size:18,isEmptyPage:!1,disabled:!0}),a()(qu.Z,{store:i}));case"notion_user":return a()("div",{style:s.nameAndIconContainer},void 0,a()($t.Z,{userStore:i,size:18}),a()(Ae.Z,{},void 0,i.getDisplayName(o)));case"team":const e=i.getName();return a()("div",{style:s.nameAndIconContainer},void 0,a()(Mt.p,{disabled:!0,store:i,size:20}),a()(Ae.Z,{},void 0,e));default:(0,x.t1)(i)}}),[i,s.nameAndIconContainer,o]);return a()("div",{style:s.container},void 0,a()(Ae.Z,{style:s.label},void 0,r),a()("div",{style:s.caption},void 0,a()(Ae.Z,{isSecondaryColor:!0,isSmall:!0},void 0,n)))}function Qu(){window.__c={n:"LoadingCardListItem"};const e=$u();return a()("div",{style:e.container},void 0,a()(Ae.Z,{style:e.label},void 0,a()(Sa.Z,{paragraphs:[{lineHeight:14,lineMargin:3,sectionWidths:[80],repeat:0,sectionMargin:2}]})),a()("div",{style:e.loadingCaption},void 0,a()(Sa.Z,{paragraphs:[{lineHeight:14,lineMargin:3,sectionWidths:[80],repeat:0,sectionMargin:2}]})))}function Yu(){window.__c={n:"ErrorCardListItem"};const e=$u();return a()("div",{style:e.container},void 0,a()(Ae.Z,{style:e.errorLabel},void 0,a()(v.FormattedMessage,{id:"spaceAnalytics.basicErrorMessage",defaultMessage:"Something went wrong.{br}Try refreshing the page.",values:{br:a()("br",{})}})))}function $u(){return(0,xe.yK)((e=>({container:{width:"100%",display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingBlock:4,gap:4},nameAndIconContainer:{display:"flex",flexDirection:"row",justifyContent:"flex-start",gap:8,alignItems:"center",width:"100%"},label:{width:"100%"},caption:{display:"flex",justifyContent:"center",alignItems:"center"},loadingCaption:{display:"block",width:"50%"},errorLabel:{width:"100%",textAlign:"center",color:qn.ZP.red}})),[])}function Xu(e){let{data:t,loading:i,error:n,daysFilter:o,setDaysFilter:r}=e;window.__c={n:"ContentEngagement"};const l=(0,Pe.O7)(),c=(0,xe.yK)((e=>({title:{fontWeight:f.Z.fontWeight.medium,fontSize:16,marginBlock:"9px 4px",display:"flex",alignItems:"center"},helpInfo:{marginLeft:4},container:{display:"flex",flexDirection:"column",gap:16},titleContainer:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",gap:16},overviewCard:{width:"fit-content"}})),[]),[u,p]=(0,Su.e)(),{pageViews:g,uniquePageViews:h,pageEdits:y,topPages:S}=t,M=(0,Ze.VK)((()=>S.map((e=>{let{pageId:t,pageViews:i}=e;return{store:new He.G(l,{id:t,table:hn.iU}),caption:a()(v.FormattedMessage,{id:"workspaceAnalytics.overview.contentEngagement.caption.pageView",defaultMessage:"{pageViews} views",values:{pageViews:a()(bu,{abbreviateNumber:!1,num:i})}})}}))),[l,S]),w=(0,d.useCallback)((e=>{r(e),b.m0A(l,{filter:"content_engagement",daysFilter:e})}),[l,r]);return d.createElement("div",{style:c.container,ref:u},a()("div",{style:c.titleContainer},void 0,a()(Ae.Z,{style:c.title},void 0,a()(v.FormattedMessage,{id:"workspaceAnalytics.overview.contentEngagement.title",defaultMessage:"Content engagement"}),a()(We.Z,{placement:ka.u.Bottom,render:e=>d.createElement(Nr.Z,s()({},e,{href:(0,H.UY)("guides.workspaceAnalytics"),analyticsFrom:"workspace_analytics_faq",style:c.helpInfo})),renderTooltip:()=>a()(v.FormattedMessage,"all_time"!==o?{id:"settings.workspaceAnalytics.overviewTab.contentEngagement.tooltip.lastDays",defaultMessage:"Activity on all pages in the workspace over the {dateRange}",values:{dateRange:z.default.formatMessage(Fa.xX[o])}}:{id:"settings.workspaceAnalytics.overviewTab.contentEngagement.tooltip.allTime",defaultMessage:"All time activity on all pages in the workspace"})})),a()(wu.f,{currentFilter:o,onChangeFilter:w})),a()(Ol,{gap:16},void 0,a()(Vl,{row:1,col:1,colEnd:3},void 0,a()(Mu,{loading:i,error:n,icon:m.Z.eyePadded,textStyles:c.overviewCard,title:a()(v.FormattedMessage,{id:"workspaceAnalytics.overview.contentEngagement.views",defaultMessage:"{pageViews} total views",values:{pageViews:a()(bu,{abbreviateNumber:p<640,num:g})}})})),a()(Vl,{row:2,col:1,colEnd:3},void 0,a()(Mu,{loading:i,error:n,icon:m.Z.personCircle,textStyles:c.overviewCard,iconStyles:{height:18,width:18},title:a()(v.FormattedMessage,{id:"workspaceAnalytics.overview.contentEngagement.uniqueViews",defaultMessage:"{uniquePageViews} unique page views",values:{uniquePageViews:a()(bu,{abbreviateNumber:p<640,num:h})}})})),a()(Vl,{row:3,col:1,colEnd:3},void 0,a()(Mu,{loading:i,error:n,icon:m.Z.editPropertyType,textStyles:c.overviewCard,iconStyles:{height:18,width:18},title:a()(v.FormattedMessage,{id:"workspaceAnalytics.overview.contentEngagement.pageEdits",defaultMessage:"{pageEdits} edits",values:{pageEdits:a()(bu,{abbreviateNumber:p<640,num:y})}})})),a()(Vl,{row:1,rowEnd:4,col:3,colEnd:5},void 0,a()(Hu,{loading:i,error:n,title:a()(v.FormattedMessage,{id:"workspaceAnalytics.overview.contentEngagement.popularPages",defaultMessage:"Most popular pages"}),items:M}))))}function Ju(e){let{data:t,loading:i,error:n,daysFilter:o,setDaysFilter:r}=e;window.__c={n:"UserEngagement"};const l=(0,Pe.O7)(),{activeMembersCount:c,previousActiveMembersCount:u,activeGuestsCount:m,previousActiveGuestsCount:p,topTeamspaces:g,topViewers:h,topEditors:y}=t,S=(0,xe.yK)((e=>({title:{fontWeight:f.Z.fontWeight.medium,fontSize:16,marginBlock:"8px 4px",display:"flex",alignItems:"center"},helpInfo:{marginLeft:4},container:{display:"flex",flexDirection:"column",gap:16},summaryCard:{height:70},titleContainer:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",gap:16}})),[]),[M,w]=(0,Su.e)(),C=(0,d.useCallback)((e=>{b.m0A(l,{filter:"user_engagement",daysFilter:e}),r(e)}),[l,r]),_=(0,Ze.VK)((()=>g.map((e=>{let{teamspaceId:t,pageViews:i}=e;return{store:new He.zX(l,{id:t,table:yt.e0}),caption:a()(v.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.caption.pageViews",defaultMessage:"{pageViews} views",values:{pageViews:a()(bu,{abbreviateNumber:!0,num:i})}})}})).filter((e=>e.store.canRead())).slice(0,5)),[l,g]),k=(0,Ze.VK)((()=>h.map((e=>{let{userId:t,pageViews:i}=e;return{store:new He.U6(l,{id:t,table:Qt.KJ}),caption:a()(v.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.caption.pageView",defaultMessage:"{pageViews} views",values:{pageViews:a()(bu,{abbreviateNumber:!0,num:i})}})}})).slice(0,5)),[l,h]),T=(0,Ze.VK)((()=>y.map((e=>{let{userId:t,pageEdits:i}=e;return{store:new He.U6(l,{id:t,table:Qt.KJ}),caption:a()(v.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.caption.pageEdits",defaultMessage:"{pageEdits} edits",values:{pageEdits:a()(bu,{abbreviateNumber:!0,num:i})}})}})).slice(0,5)),[l,y]);return d.createElement("div",{style:S.container,ref:M},a()("div",{style:S.titleContainer},void 0,a()(Ae.Z,{style:S.title},void 0,a()(v.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.title",defaultMessage:"User engagement"}),a()(We.Z,{placement:ka.u.Bottom,render:e=>d.createElement(Nr.Z,s()({},e,{href:(0,H.UY)("guides.workspaceAnalytics"),analyticsFrom:"workspace_analytics_faq",style:S.helpInfo})),renderTooltip:()=>a()(v.FormattedMessage,"all_time"!==o?{id:"settings.workspaceAnalytics.overviewTab.userEngagement.tooltip.lastDays",defaultMessage:"Active members and guests have viewed at least one page within the {dateRange}",values:{dateRange:z.default.formatMessage(Fa.xX[o])}}:{id:"settings.workspaceAnalytics.overviewTab.userEngagement.tooltip.allTime",defaultMessage:"Active members and guests have viewed at least one page in the workspace"})})),a()(wu.f,{currentFilter:o,onChangeFilter:C})),a()(Ol,{gap:16},void 0,a()(Vl,{row:1,col:1},void 0,a()(Mu,{style:S.summaryCard,loading:i,error:n,title:a()(v.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.activeMembersCount",defaultMessage:"{activeMembersCount} active members",values:{activeMembersCount:a()(bu,{abbreviateNumber:w<640,num:c})}}),byline:void 0!==u?a()(em,{userType:"members",daysFilter:o,count:c,previousCount:u}):null})),a()(Vl,{row:1,col:2},void 0,a()(Mu,{style:S.summaryCard,loading:i,error:n,title:a()(v.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.activeGuestsCount",defaultMessage:"{activeGuestsCount} active guests",values:{activeGuestsCount:a()(bu,{abbreviateNumber:w<640,num:m})}}),byline:void 0!==p?a()(em,{userType:"guests",daysFilter:o,count:m,previousCount:p}):null}))),a()(Ol,{gap:16},void 0,a()(Vl,{row:1,col:1},void 0,a()(Hu,{loading:i,error:n,title:a()(v.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.activeTeamspaces",defaultMessage:"Most active teamspaces"}),items:_})),a()(Vl,{row:1,col:2},void 0,a()(Hu,{loading:i,error:n,title:a()(v.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.activeViewers",defaultMessage:"Most active viewers"}),items:k})),a()(Vl,{row:1,col:3},void 0,a()(Hu,{loading:i,error:n,title:a()(v.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.activeEditors",defaultMessage:"Most active editors"}),items:T}))))}function em(e){let{userType:t,daysFilter:i,count:n,previousCount:o}=e;window.__c={n:"MetricsChangeMessage"};const s=0===n&&0===o?0:Math.round((n-o)/o*100);let r;r=s===1/0?function(e,t,i){if("all_time"===i)return a()(v.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.summaryByline.allTime.none",defaultMessage:"No changes yet"});return a()(v.FormattedMessage,"guests"===e?{id:"workspaceAnalytics.overview.userEngagement.changeFromZero.summaryByline.guests.positive",defaultMessage:"{changeValue} more guests than previous {numberOfDays} days",values:{changeValue:t.toLocaleString(),numberOfDays:Fa.ez[i].toLocaleString()}}:{id:"workspaceAnalytics.overview.userEngagement.changeFromZero.summaryByline.members.positive",defaultMessage:"{changeValue} more members than previous {numberOfDays} days",values:{changeValue:t.toLocaleString(),numberOfDays:Fa.ez[i].toLocaleString()}})}(t,n,i):function(e,t){switch(t){case"all_time":return a()(v.FormattedMessage,0===e?{id:"workspaceAnalytics.overview.userEngagement.summaryByline.allTime.none",defaultMessage:"No changes yet"}:e>0?{id:"workspaceAnalytics.overview.userEngagement.summaryByline.allTime.positive",defaultMessage:"{changeInPercentage}% more since the start",values:{changeInPercentage:Math.abs(e)}}:{id:"workspaceAnalytics.overview.userEngagement.summaryByline.allTime.negative",defaultMessage:"{changeInPercentage}% less since the start",values:{changeInPercentage:Math.abs(e)}});case"last_90_days":return a()(v.FormattedMessage,0===e?{id:"workspaceAnalytics.overview.userEngagement.summaryByline.last_90_days.none",defaultMessage:"No changes in previous 90 days"}:e>0?{id:"workspaceAnalytics.overview.userEngagement.summaryByline.last_90_days.positive",defaultMessage:"{changeInPercentage}% more than previous 90 days",values:{changeInPercentage:Math.abs(e)}}:{id:"workspaceAnalytics.overview.userEngagement.summaryByline.last_90_days.negative",defaultMessage:"{changeInPercentage}% less than previous 90 days",values:{changeInPercentage:Math.abs(e)}});case"last_28_days":return a()(v.FormattedMessage,0===e?{id:"workspaceAnalytics.overview.userEngagement.summaryByline.last_28_days.none",defaultMessage:"No changes in previous 28 days"}:e>0?{id:"workspaceAnalytics.overview.userEngagement.summaryByline.last_28_days.positive",defaultMessage:"{changeInPercentage}% more than previous 28 days",values:{changeInPercentage:Math.abs(e)}}:{id:"workspaceAnalytics.overview.userEngagement.summaryByline.last_28_days.negative",defaultMessage:"{changeInPercentage}% less than previous 28 days",values:{changeInPercentage:Math.abs(e)}});case"last_7_days":return a()(v.FormattedMessage,0===e?{id:"workspaceAnalytics.overview.userEngagement.summaryByline.last_7_days.none",defaultMessage:"No changes in previous 7 days"}:e>0?{id:"workspaceAnalytics.overview.userEngagement.summaryByline.last_7_days.positive",defaultMessage:"{changeInPercentage}% more than previous 7 days",values:{changeInPercentage:Math.abs(e)}}:{id:"workspaceAnalytics.overview.userEngagement.summaryByline.last_7_days.negative",defaultMessage:"{changeInPercentage}% less than previous 7 days",values:{changeInPercentage:Math.abs(e)}});default:(0,x.t1)(t)}}(s,i);const l=s>0?m.Z.alias({height:12,width:12,fill:"currentColor"}):s<0?m.Z.alias({height:12,width:12,transform:"rotate(90deg)",fill:"currentColor"}):void 0,d=(0,xe.yK)((e=>({text:{color:s>0?e.accentColors.green[500]:s<0?e.accentColors.red[500]:e.lightTextColor,display:"flex",alignItems:"center",gap:4}})),[s]);return a()("span",{style:d.text},void 0,l,r)}function tm(e){var t,i;let{onUserTabFilterChange:n,spaceStore:o,contentEngagement:s,userEngagement:r}=e;window.__c={n:"SpaceAnalyticsOverviewTab"};const l=(0,xe.yK)((e=>({container:{display:"flex",flexDirection:"column",gap:24}})),[]),d=(0,Ze.VK)((()=>o.getName()),[o]);if("NotFoundError"===(null===(t=s.error)||void 0===t?void 0:t.name)||"NotFoundError"===(null===(i=r.error)||void 0===i?void 0:i.name))return a()(yu,{type:"empty",spaceName:d});return a()("div",{style:l.container},void 0,a()(Ju,{data:r.data,loading:r.loading,error:r.error,daysFilter:r.daysFilter,setDaysFilter:function(e){n({graphFilter:"all_time"===e?"last_90_days":e}),r.setDaysFilter(e)}}),a()(Xu,{data:s.data,loading:s.loading,error:s.error,daysFilter:s.daysFilter,setDaysFilter:s.setDaysFilter}))}const im={field:"num_searches",direction:"desc"},nm=lu,am={sort:im,timeRange:nm,searchAnalyticsDataList:[],numPagesLoaded:0,paginationToken:void 0,hasNextPage:!0,loading:!1,error:void 0,shouldReRunSearch:!1};const om=(0,v.defineMessages)({numSearches:{id:"workspaceAnalytics.searchTab.searchTable.searches.tooltip",defaultMessage:"Number of times users in the workspace have searched the query"},numUniqueUsers:{id:"workspaceAnalytics.searchTab.searchTable.uniqueSearches.tooltip",defaultMessage:"Total number of users that have searched the query"},ctr:{id:"workspaceAnalytics.searchTab.searchTable.ctr.tooltip",defaultMessage:"Percentage of times users have opened page from results of this query"}}),sm=(0,v.defineMessages)({queryText:{id:"spaceAnalyticsSearchTable.column.query",defaultMessage:"Query"},numSearches:{id:"spaceAnalyticsSearchTable.column.searches",defaultMessage:"Searches"},numUniqueUsers:{id:"spaceAnalyticsSearchTable.column.uniqueSearches",defaultMessage:"Unique searches"},ctr:{id:"spaceAnalyticsSearchTable.column.ctr",defaultMessage:"Click-through rate"}}),rm={queryText:{id:"queryText",headerTitle:z.default.formatMessage(sm.queryText),renderCell:e=>a()(Ae.Z,{},void 0,e.queryText),widthData:{width:200,maxWidth:300},sortable:!1},numSearches:{id:"numSearches",headerTitle:a()(ku,{tooltipMessageDescriptor:om.numSearches,columnHeader:sm.numSearches}),renderCell:e=>a()(cm,{value:e.numSearches}),widthData:{width:120,maxWidth:120},sortable:!0},numUniqueUsers:{id:"numUniqueUsers",headerTitle:a()(ku,{tooltipMessageDescriptor:om.numUniqueUsers,columnHeader:sm.numUniqueUsers}),renderCell:e=>a()(cm,{value:e.numUniqueUsers}),widthData:{width:120,maxWidth:120},sortable:!0},ctr:{id:"ctr",headerTitle:a()(ku,{tooltipMessageDescriptor:om.ctr,columnHeader:sm.ctr}),renderCell:e=>a()(cm,{value:Math.round(1e3*e.ctr)/1e3,isPercentage:!0}),widthData:{width:120,maxWidth:120},sortable:!0}},lm=(0,x.Yd)(rm).map((e=>rm[e]));function dm(e){let{searchAnalyticsDataList:t,runNewSearch:i,sort:n,setSort:o,loadNextPage:s,loading:r,error:l}=e;window.__c={n:"SpaceAnalyticsTable"};const c=(0,Ze.VK)((()=>t.map((e=>({id:e.queryText,isClickable:!1,...e})))),[t]),u=(0,d.useMemo)((()=>function(e){const t=Fa.Fi[e.field];if(!t)return;return{column:rm[t],sortAscending:"asc"===e.direction}}(n)),[n]),m=(0,xe.yK)((e=>(0,Oe.b)({columnRenderInfo:lm,theme:e,containerMarginTop:0})),[]),p=(0,xe.yK)((e=>({emptyQuery:{marginTop:15,marginBottom:40,textAlign:"center"},loadingSpinner:{margin:"24px auto 24px"}})),[]);return l?a()(tt,{error:l,runNewSearch:i}):a()("div",{},void 0,a()(Oe.D,{hideHeaderRowPadding:!0,allowHorizontalScroll:!0,setStickyHeaderRow:!0,maxHeight:500,columnRenderInfo:lm,rows:c,sortState:u,onSortStateChanged:e=>{o(function(e){const t=Fa.hx[e.column.id],i=e.sortAscending?"asc":"desc";if(!t)return{field:"num_searches",direction:i};return{field:t,direction:i}}(e))},onScrollBottom:s,renderNoRowsComponent:()=>a()(Ae.Z,{isSmall:!0,style:p.emptyQuery},void 0,!r&&0===t.length&&a()(v.FormattedMessage,{id:"settings.workspaceAnalytics.searchTable.table.empty",defaultMessage:"No search query analytics to display."})),styles:m}),r?a()(Ve.Z,{style:p.loadingSpinner}):null)}function cm(e){let{value:t,isPercentage:i}=e;window.__c={n:"CenteredNumericCell"};const n=(0,xe.yK)((e=>({centered:{width:"100%",textAlign:"center"}})),[]),o=i?`${t}%`:t;return a()(Ae.Z,{style:n.centered},void 0,o)}function um(e){window.__c={n:"SpaceAnalyticsSearchTab"};const{spaceStore:t}=e,i=(0,xe.yK)((()=>({header:{display:"flex",width:"100%",justifyContent:"space-between",alignItems:"center",marginBottom:16},sectionTitle:{fontWeight:f.Z.fontWeight.semibold,fontSize:16,display:"flex",alignItems:"center"},helpInfo:{marginLeft:4}})),[]),n=(0,d.useRef)(!1),{searchAnalyticsDataList:o,timeRange:r,sort:c,loading:u,error:m,loadNextPage:p,runNewSearch:g,setTimeRange:h,setSort:y}=function(e){let{spaceStore:t}=e;const i=(0,Pe.O7)(),[n,a]=(0,d.useState)(am),o=(0,d.useRef)(im),s=(0,d.useRef)(nm),r=(0,v.useIntl)(),c=(0,d.useCallback)((async e=>{let{fetchFromFirstPage:r,ignoreSearchInputComparison:d}=e;const c=!l().isEqual(n.sort,o.current)||!l().isEqual(n.timeRange,s.current);if(!d&&!c)return;o.current=n.sort,s.current=n.timeRange;let u=n.loading,m=n.error,p=n.hasNextPage,g=n.paginationToken;if(r&&(a((e=>({...am,timeRange:e.timeRange,sort:e.sort}))),u=am.loading,m=am.error,p=am.hasNextPage,g=am.paginationToken),!p||u)return;if(m)return;a((e=>({...e,loading:!0})));const h=await T.loadSearchAnalytics(i,{spaceId:t.id,sort:n.sort,timeRange:n.timeRange,startCursor:g});if("failed"===h.type)return void a((e=>({...e,loading:!1,error:h})));const f=h.data.results;a((e=>{const t=[],i=new Set(e.searchAnalyticsDataList.map((e=>e.queryText)));for(const a of f){const e=a.queryText;i.has(e)||(t.push(a),i.add(e))}const n=[...e.searchAnalyticsDataList,...t];return{...e,searchAnalyticsDataList:n,loading:!1,error:void 0,numPagesLoaded:e.numPagesLoaded+1,paginationToken:h.data.nextCursor,hasNextPage:Boolean(h.data.nextCursor)}}))}),[i,t,n.sort,n.timeRange,n.loading,n.error,n.hasNextPage,n.paginationToken]);(0,d.useEffect)((()=>{n.shouldReRunSearch&&(a((e=>({...e,shouldReRunSearch:!1}))),c({fetchFromFirstPage:!0,ignoreSearchInputComparison:!1}))}),[n.shouldReRunSearch,c]);const u=(0,d.useCallback)((async()=>{n.shouldReRunSearch||await c({fetchFromFirstPage:!1,ignoreSearchInputComparison:!0})}),[n.shouldReRunSearch,c]),m=(0,d.useCallback)((async e=>{await c({fetchFromFirstPage:!0,ignoreSearchInputComparison:e||!1})}),[c]),p=(0,d.useCallback)((e=>{"all_time"!==e&&(a((t=>({...t,timeRange:e,shouldReRunSearch:!0}))),b.yef(i,{daysFilter:e}))}),[i]),g=(0,d.useCallback)((e=>{a((t=>({...t,sort:e,shouldReRunSearch:!0}))),b.$fF(i,{column:e.field,isAscending:"asc"===e.direction})}),[i]),h=(0,d.useMemo)((()=>{if(n.error)return new Error((0,kn.wf)(r,n.error))}),[n.error,r]);return{...n,error:h,loadNextPage:u,runNewSearch:m,setTimeRange:p,setSort:g}}({spaceStore:t});(0,d.useEffect)((()=>{n.current||(g(!0),n.current=!0)}),[g]);const S=(0,Ze.VK)((()=>t.getName()),[t]);return"NotFoundError"===(null==m?void 0:m.name)?a()(yu,{type:"empty",spaceName:S}):d.createElement(d.Fragment,null,a()("div",{style:i.header},void 0,a()(Ae.Z,{style:i.sectionTitle},void 0,a()(v.FormattedMessage,{id:"settings.workspaceAnalytics.searchTab.searchQueries.title",defaultMessage:"Search queries"}),a()(We.Z,{placement:We.Z.Placement.Bottom,render:e=>d.createElement(Nr.Z,s()({},e,{href:(0,H.UY)("guides.workspaceAnalytics"),analyticsFrom:"workspace_analytics_faq",style:i.helpInfo})),renderTooltip:()=>a()(v.FormattedMessage,{id:"settings.workspaceAnalytics.searchTab.searchQueries.tooltip",defaultMessage:"Displays popular search queries in the workspace from the {dateRange}",values:{dateRange:z.default.formatMessage(Fa.xX[r])}})})),a()(wu.f,{currentFilter:r,onChangeFilter:h,hideAllTime:!0})),a()(dm,{searchAnalyticsDataList:o,runNewSearch:g,sort:c,setSort:y,loadNextPage:p,loading:u,error:m}))}var mm=i(16444);function pm(e){let{data:t,loading:i,error:n,daysFilter:o,setDaysFilter:r}=e;window.__c={n:"UsersAnalyticsSummaries"};const[l,c]=(0,Su.e)(),u=(0,xe.yK)((e=>({title:{fontWeight:f.Z.fontWeight.medium,fontSize:16,marginBlock:"8px 4px",display:"flex",alignItems:"center"},container:{display:"flex",flexDirection:"column",gap:16},helpInfo:{marginLeft:4},titleContainer:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",gap:16},summaryCard:{height:70},cardContainer:{justifyContent:"flex-start",gap:18},cardTextContainer:{alignItems:"flex-start"}})),[]),{activeMembersCount:m,previousActiveMembersCount:p,activeGuestsCount:g,previousActiveGuestsCount:h}=t;return d.createElement("div",{style:u.container,ref:l},a()("div",{style:u.titleContainer},void 0,a()(Ae.Z,{style:u.title},void 0,a()(v.FormattedMessage,{id:"settings.workspaceAnalytics.usersTab.userEngagement.title",defaultMessage:"User engagement"}),a()(We.Z,{placement:ka.u.Bottom,render:e=>d.createElement(Nr.Z,s()({},e,{href:(0,H.UY)("guides.workspaceAnalytics"),analyticsFrom:"workspace_analytics_faq",style:u.helpInfo})),renderTooltip:()=>a()(v.FormattedMessage,"all_time"!==o?{id:"settings.workspaceAnalytics.usersTab.userEngagement.tooltip.lastDays",defaultMessage:"Active members and guests have viewed at least one page within the {dateRange}",values:{dateRange:z.default.formatMessage(Fa.xX[o])}}:{id:"settings.workspaceAnalytics.usersTab.userEngagement.tooltip.allTime",defaultMessage:"Active members and guests have viewed at least one page in the workspace"})})),a()(wu.f,{currentFilter:o,onChangeFilter:r})),a()(Ol,{gap:16},void 0,a()(Vl,{row:1,col:1},void 0,a()(Mu,{style:u.summaryCard,loading:i,error:n,title:a()(v.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.activeMembersCount",defaultMessage:"{activeMembersCount} active members",values:{activeMembersCount:a()(bu,{abbreviateNumber:c<640,num:m})}}),byline:void 0!==p?a()(em,{userType:"members",daysFilter:o,count:m,previousCount:p}):null})),a()(Vl,{row:1,col:2},void 0,a()(Mu,{style:u.summaryCard,loading:i,error:n,title:a()(v.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.activeGuestsCount",defaultMessage:"{activeGuestsCount} active guests",values:{activeGuestsCount:a()(bu,{abbreviateNumber:c<640,num:g})}}),byline:void 0!==h?a()(em,{userType:"guests",daysFilter:o,count:g,previousCount:h}):null}))))}var gm=i(88775);const hm=(0,v.defineMessages)({page_views:{id:"workspaceAnalytics.usersTab.usersTable.pageViews.tooltip",defaultMessage:"Total number of page views for the user across all pages in the workspace"},page_edits:{id:"workspaceAnalytics.usersTab.usersTable.pageEdits.tooltip",defaultMessage:"Total number of page edits for the user across all pages in the workspace"}}),fm=(0,v.defineMessages)({user:{id:"spaceAnalyticsUsersTab.column.user",defaultMessage:"User"},page_views:{id:"spaceAnalyticsUsersTab.column.pageViews",defaultMessage:"Page views"},page_edits:{id:"spaceAnalyticsUsersTab.column.pageEdits",defaultMessage:"Page edits"},last_active:{id:"spaceAnalyticsUsersTab.column.lastActive",defaultMessage:"Last active"},teams:{id:"spaceAnalyticsUsersTab.column.teams",defaultMessage:"Teamspaces"}}),vm={user:{id:"user",renderCell:function(e){window.__c={n:"UserCell"};const t=(0,xe.yK)((e=>({container:{height:52}})),[]);return a()(Ma.Z,{containerStyle:t.container,actorStore:e.userStore,spaceRole:e.role&&(0,Ma.K)(e.role)})},headerTitle:z.default.formatMessage(fm.user),widthData:{width:100},sortable:!1},page_views:{id:"page_views",renderCell:function(e){window.__c={n:"PageViewsCell"};const{page_views:t}=e,i=(0,xe.yK)((e=>({eyeHideIcon:{width:20,height:20,color:e.lightIconColor},cell:{marginLeft:10}})),[]);if(void 0===t)return a()(We.Z,{placement:We.Z.Placement.Bottom,render:e=>d.createElement("div",e,m.Z.eyeHidePadded(i.eyeHideIcon)),renderTooltip:e=>a()(v.FormattedMessage,{id:"spaceAnalyticsUsersTab.optedOutUser.icon.tooltip",defaultMessage:"User has disabled page view tracking"})});return a()(Ae.Z,{},void 0,t)},headerTitle:a()(ku,{tooltipMessageDescriptor:hm.page_views,columnHeader:fm.page_views}),widthData:{width:80},sortable:!0},page_edits:{id:"page_edits",renderCell:function(e){const{page_edits:t}=e;return a()(Ae.Z,{},void 0,t)},headerTitle:a()(ku,{tooltipMessageDescriptor:hm.page_edits,columnHeader:fm.page_edits}),widthData:{width:80},sortable:!0},last_active:{id:"last_active",renderCell:function(e){const t=e.last_active;let i;i=t?a()(ze,{dateTs:t}):a()(Ae.Z,{isSecondaryColor:!0},void 0,a()(v.FormattedMessage,{id:"settings.workspaceAnalytics.usersTab.userTable.lastActiveTimestamp.noLastActive",defaultMessage:"No activity"}));return a()("div",{},void 0,i)},headerTitle:z.default.formatMessage(fm.last_active),widthData:{width:50},sortable:!0},teams:{id:"teams",renderCell:function(e){const{userStore:t,role:i}=e;if(!i)return a()(Ae.Z,{},void 0,a()(v.FormattedMessage,{id:"settings.workspaceAnalytics.usersTab.teamsColumn.guest",defaultMessage:"None"}));return a()(gm.Z,{member:{userId:t.id,role:i}})},headerTitle:z.default.formatMessage(fm.teams),widthData:{width:50},sortable:!1}};const ym=(0,x.Yd)(vm).map((e=>vm[e]));function Sm(e){window.__c={n:"UsersTable"};const t=(0,Pe.O7)(),[i,n]=(0,d.useState)(25),{usersAndStats:o,filter:s,onUserTabFilterChange:r,usersAndStatsError:l}=e,c=(0,Ze.VK)((()=>{const{currentSpaceStore:e}=A.default.state,t=(null==e?void 0:e.getPermissionItems().filter(vt.jg))||[],i={};for(const n of t)i[n.user_id]=n.role;return i}),[]),[u,m]=(0,d.useState)({column:vm.last_active,sortAscending:!1}),p=(0,d.useCallback)((e=>{b.gEE(t,{column:e.column.id,isAscending:e.sortAscending}),m(e)}),[m,t]),g=o.map((e=>{let{userStore:t,stats:i}=e;return{id:i.userId,userStore:t,isClickable:!1,last_active:i.lastActive,page_views:i.numPageViews,page_edits:i.numPageEdits,role:c[i.userId]}})).sort(function(e){switch(e.column.id){case"last_active":return(t,i)=>(0,Fa.Zj)(t.last_active,i.last_active,e.sortAscending);case"page_views":return(t,i)=>(0,Fa.yM)(t.page_views,i.page_views,e.sortAscending);case"page_edits":return(t,i)=>e.sortAscending?t.page_edits-i.page_edits:i.page_edits-t.page_edits;default:return(e,t)=>0}}(u)),h=(0,d.useMemo)((()=>g.slice(0,i)),[g,i]),f=(0,xe.yK)((e=>({error:{color:qn.ZP.red},dateFilterPill:{display:"flex",marginTop:10,marginBottom:15,flexFlow:"row",alignItems:"center"},timeFilterDescription:{marginRight:5}})),[]);const y=(0,d.useCallback)((e=>{b.IwD(t,{daysFilter:e}),r({tableFilter:e})}),[t,r]),S=(0,xe.yK)((e=>(0,Oe.b)({columnRenderInfo:ym,theme:e,containerMarginTop:0})),[]);return d.createElement(d.Fragment,null,l&&a()(Ae.Z,{isMultiline:!1,style:f.error},void 0,l),a()("div",{style:f.dateFilterPill},void 0,a()(Ae.Z,{isSecondaryColor:!0,style:f.timeFilterDescription},void 0,a()(v.FormattedMessage,{id:"workspaceAnalytics.timeFilter.description",defaultMessage:"Views and edits from"})),a()(wu.f,{currentFilter:s,onChangeFilter:y})),a()(Oe.D,{allowHorizontalScroll:!0,hideHeaderRowPadding:!0,setStickyHeaderRow:!0,maxHeight:500,sortState:u,onSortStateChanged:p,columnRenderInfo:ym,rows:h,renderNoRowsComponent:()=>a()("div",{},void 0,"N/A"),styles:S,onScrollBottom:function(){i<o.length&&n(i+25)}}))}function bm(e){var t,i;let{spaceStore:n,usersTabData:o,onUserTabFilterChange:r,userEngagement:l}=e;window.__c={n:"SpaceAnalyticsUsersTab"};const[c,u]=(0,Su.e)(),m=(0,xe.yK)((e=>({container:{display:"flex",flexDirection:"column",gap:16},titleContainer:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",gap:16},sectionTitle:{fontWeight:f.Z.fontWeight.medium,fontSize:16},sectionTitleLeft:{marginBlock:"8px 4px",marginBottom:5,display:"flex",alignItems:"center"},helpInfo:{marginLeft:4},wrapper:{display:"flex",flexDirection:"row",justifyContent:"space-around"},numUsersCaption:{display:"flex"},overviewText:{textAlign:"center"},error:{color:qn.ZP.red},tableHeader:{marginTop:20,flexDirection:"row",display:"flex",justifyContent:"space-between",alignItems:"end"},tooltip:{marginLeft:3},infoIcon:{height:14,width:14,color:e.mediumTextColor}})),[]),p=(0,Pe.O7)(),g=(0,v.useIntl)(),h=(0,d.useCallback)((e=>{b.KCu(p,{daysFilter:e});r({graphFilter:"all_time"===e?"last_90_days":e}),l.setDaysFilter(e)}),[r,l,p]),y=(0,Ze.VK)((()=>n.getName()),[n]);if("NotFoundError"===(null==o||null===(t=o.usersAndStatsError)||void 0===t?void 0:t.name)||"NotFoundError"===(null===(i=l.error)||void 0===i?void 0:i.name))return a()(yu,{type:"empty",spaceName:y});const S=Math.floor(u-8);return a()("div",{style:m.container},void 0,a()(pm,{data:l.data,loading:l.loading,error:l.error,daysFilter:l.daysFilter,setDaysFilter:h}),a()(Mm,{},void 0,d.createElement("div",{ref:c},o?a()(wm,{width:S,dailyUsersData:o.dailyUsersData,userEngagementDaysFilter:l.daysFilter,daysFilter:o.graphFilter,dailyUsersError:o.dailyUsersError&&mu(o.dailyUsersError,g)}):a()(Cm,{}))),a()("div",{style:m.tableHeader},void 0,a()("div",{style:m.sectionTitleLeft},void 0,a()(Ae.Z,{style:m.sectionTitle},void 0,a()(v.FormattedMessage,{id:"settings.workspaceAnalytics.usersTab.allUsers.title",defaultMessage:"All members in Notion"})),a()(We.Z,{placement:ka.u.Bottom,render:e=>d.createElement(Nr.Z,s()({},e,{href:(0,H.UY)("guides.workspaceAnalytics"),analyticsFrom:"workspace_analytics_faq",style:m.helpInfo})),renderTooltip:()=>o&&"all_time"!==o.tableFilter?a()(v.FormattedMessage,{id:"settings.workspaceAnalytics.allMembers.tooltip.lastDays",defaultMessage:"Per member workspace activity over the {dateRange}",values:{dateRange:z.default.formatMessage(Fa.xX[o.tableFilter])}}):a()(v.FormattedMessage,{id:"settings.workspaceAnalytics.allMembers.tooltip.allTime",defaultMessage:"All time per member workspace activity"})})),a()(hu,{analyticsType:he.Users})),o?a()(Sm,{filter:o.tableFilter,usersAndStats:o.usersAndStats,onUserTabFilterChange:r,usersAndStatsError:o.usersAndStatsError&&mu(o.usersAndStatsError,g)}):null)}function Mm(e){window.__c={n:"DisplayBox"};const t=(0,xe.yK)((e=>({border:{borderRadius:3,overflow:"hidden",border:`1px solid ${e.regularDividerColor}`,backgroundColor:e.contentBackground,color:e.regularTextColor,padding:20}})),[]);return a()("div",{style:t.border},void 0,e.children)}function wm(e){window.__c={n:"UsersOverTimeGraph"};const{width:t,dailyUsersData:i,userEngagementDaysFilter:n,daysFilter:o,dailyUsersError:r}=e,l=(0,xe.yK)((e=>({graphHeader:{marginBottom:10,display:"flex",justifyContent:"space-between"},graphTitle:{fontSize:f.Z.fontSize.UIRegular.desktop,fontWeight:"bolder",display:"flex",alignItems:"center",height:24},graphCaption:{fontSize:f.Z.fontSize.UISmall.desktop},graphTooltip:{marginLeft:5,width:14,height:14},helpInfo:{marginLeft:4},emptyGraphBody:{textAlign:"center",paddingTop:50,paddingBottom:50},error:{color:qn.ZP.red},graphSubLabel:{paddingTop:4,color:"grey"}})),[]),{blueLayer:c}=(0,mm.useTimeSeriesPalette)(),u=(0,Ze.VK)((()=>{if(0===i.length)return;return{startDate:i[0].ds,endDate:i[i.length-1].ds}}),[i]),m=(0,Ze.VK)((()=>i.map((e=>({ds:e.ds,values:{active_members:e.active_members||0}})))),[i]);let p;return p=!u||i.length<3?a()("div",{style:l.emptyGraphBody},void 0,a()(Ae.Z,{isSecondaryColor:!0},void 0,a()(v.FormattedMessage,{id:"workspaceAnalytics.usersOverTime.emptyGraph",defaultMessage:"Not enough data to display graph"}))):a()(Pt.LazyTimeSeries,{startDate:u.startDate,endDate:u.endDate,width:t,data:m,height:300,layers:[{key:"active_members",...c,renderLabel:e=>a()(v.FormattedMessage,{id:"workspaceAnalytics.usersOverTime.activeMembers",defaultMessage:"{activeMembers, plural, one {1 active member} other {{activeMembers} active members}}",values:{activeMembers:e}})}],renderTooltipSubLabel:()=>a()("div",{style:l.graphSubLabel},void 0,a()(v.FormattedMessage,{id:"workspaceAnalytics.usersOverTime.activeMembers.sublabel",defaultMessage:"Viewed a page in the {dateRange}",values:{dateRange:z.default.formatMessage(Fa.xX[o])}}))}),d.createElement(d.Fragment,null,a()("div",{style:l.graphHeader},void 0,a()(Ae.Z,{style:l.graphTitle},void 0,a()(v.FormattedMessage,{id:"workspaceAnalytics.membersOverTime.title",defaultMessage:"Active members over time"}),"all_time"===n&&a()(We.Z,{placement:ka.u.Bottom,render:e=>d.createElement(Nr.Z,s()({},e,{href:(0,H.UY)("guides.workspaceAnalytics"),analyticsFrom:"workspace_analytics_faq",style:l.helpInfo})),renderTooltip:()=>a()(v.FormattedMessage,{id:"settings.workspaceAnalytics.membersOverTime.allTimeTooltip",defaultMessage:"All Time selection shows members who have viewed a page in the last 90 days."})}))),r&&a()(Ae.Z,{isMultiline:!1,style:l.error},void 0,r),p)}function Cm(){return a()("div",{},void 0,a()(Sa.Z,{paragraphs:[{lineHeight:18,lineMargin:0,sectionWidths:[100],repeat:0,sectionMargin:0}]}),a()(Sa.Z,{paragraphs:[{lineHeight:300,lineMargin:0,sectionWidths:[100],repeat:0,sectionMargin:12}]}))}const _m={[he.Overview]:a()(v.FormattedMessage,{id:"workspaceAnalyticsTabs.overview.title",defaultMessage:"Overview"}),[he.Users]:a()(v.FormattedMessage,{id:"workspaceAnalyticsTabs.members.title",defaultMessage:"Members"}),[he.Content]:a()(v.FormattedMessage,{id:"workspaceAnalyticsTabs.content.title",defaultMessage:"Content"}),[he.Search]:a()(v.FormattedMessage,{id:"workspaceAnalyticsTabs.search.title",defaultMessage:"Search"})};const km=function(e){let{spaceStore:t}=e;window.__c={n:"SpaceAnalytics"};const i=(0,xe.yK)((e=>({headingStyle:{marginBottom:0,paddingBottom:0,fontSize:16,fontWeight:f.Z.fontWeight.medium,display:"flex",justifyContent:"space-between"},title:{display:"flex",alignItems:"center"},helpInfo:{marginLeft:4},tabsStyle:{paddingLeft:0,paddingRight:0,marginTop:-6,marginBottom:14}})),[]),n=(0,Pe.O7)(),o=(0,Ze.VK)((()=>{var e;return null===(e=A.default.state.currentUserStore)||void 0===e?void 0:e.id}),[]),r=function(e){let{spaceId:t}=e;const i=(0,Pe.O7)(),[n,a]=(0,d.useState)("last_90_days"),[{status:o,value:s,error:r}]=(0,fs.r5)((async()=>{const e=await T.getContentEngagementAnalytics(i,{spaceId:t,daysFilter:n});switch(e.type){case"success":return{pageViews:e.data.pageViews,uniquePageViews:e.data.uniquePageViews,pagesCreated:e.data.pagesCreated,pageEdits:e.data.pageEdits,topPages:e.data.topPages};case"failed":throw e.body;default:(0,x.t1)(e)}}),[i,t,n]);return{data:(0,d.useMemo)((()=>s||pu),[s]),loading:"pending"===o||"idle"===o,error:r,daysFilter:n,setDaysFilter:a}}({spaceId:t.id}),l=function(e){let{spaceStore:t,userId:i}=e;const n=(0,Pe.O7)(),[a,o]=(0,d.useState)("last_90_days"),[{status:s,value:r,error:l}]=(0,fs.r5)((async()=>{if(!i||!(0,g.wv)({permissions:t.getPermissionItems()},i))return gu;const e=await T.getUserEngagementAnalytics(n,{spaceId:t.id,daysFilter:a});switch(e.type){case"success":return{activeMembersCount:e.data.activeMembersCount,previousActiveMembersCount:e.data.previousActiveMembersCount,activeGuestsCount:e.data.activeGuestsCount,previousActiveGuestsCount:e.data.previousActiveGuestsCount,topTeamspaces:e.data.topTeamspaces,topViewers:e.data.topViewers,topEditors:e.data.topEditors};case"failed":throw e.body;default:(0,x.t1)(e)}}),[n,t,i,a]);return{data:(0,d.useMemo)((()=>r||gu),[r]),loading:"pending"===s||"idle"===s,error:l,daysFilter:a,setDaysFilter:o}}({spaceStore:t,userId:o}),[c,u]=(0,Ze.AF)(ve),p=(0,Ze.VK)((()=>Boolean(null==t?void 0:t.getSettings().disable_page_analytics)),[t]),h=(0,Ze.VK)((()=>null==t?void 0:t.getName()),[t]),y=(0,d.useCallback)((async e=>{await async function(e){var t,i,n;const{environment:a,spaceStore:o,spaceAnalyticsStore:s,setState:r,graphFilter:l,tableFilter:d}=e,c=l||(null===(t=s.usersTabData)||void 0===t?void 0:t.graphFilter)||lu,u=d||(null===(i=s.usersTabData)||void 0===i?void 0:i.tableFilter)||lu,m=(null===(n=s.usersTabData)||void 0===n?void 0:n.userTableSort)||du,[p,g]=await Promise.all([cu({environment:a,filter:c,spaceId:o.id,spaceAnalyticsStore:s}),uu({environment:a,filter:u,sort:m,spaceStore:o,spaceAnalyticsStore:s})]),h=(0,Cn.Rp)(p)||!p?[]:p,f=(0,Cn.Rp)(g)||!g?[]:g;r({currentSpaceId:o.id,currentTab:s.currentTab,usersTabData:{graphFilter:c,tableFilter:u,userTableSort:m,dailyUsersError:(0,Cn.Rp)(p)?p:void 0,dailyUsersData:h,usersAndStatsError:(0,Cn.Rp)(g)?g:void 0,usersAndStats:f}})}({environment:n,spaceStore:t,spaceAnalyticsStore:c,setState:u,graphFilter:e.graphFilter,tableFilter:e.tableFilter})}),[n,t,c,u]),S=(0,d.useCallback)((e=>{b.nKJ(n,{tab:e}),u({...c,currentTab:e})}),[u,c,n]),M=(0,Ze.VK)((()=>{const e=[];return function(e){return Boolean(null==e?void 0:e.canAdmin())}(t)&&e.push(he.Overview),function(e){return Boolean(null==e?void 0:e.canAdmin())}(t)&&e.push(he.Users),e.push(he.Content),function(e){return Boolean(null==e?void 0:e.canAdmin())}(t)&&e.push(he.Search),e}),[t]),C=(0,Ze.VK)((()=>M.length>1),[M]),_=c.currentTab||M[0];(0,d.useEffect)((()=>{!async function(){const e=t.id;e&&ve.shouldRefreshState(e)&&(_===he.Users?await y({graphFilter:"last_90_days",tableFilter:"last_90_days"}):_===he.Content||_===he.Overview||_===he.Search||(0,x.t1)(_))}()}));const k=(0,d.useCallback)((()=>{w.navigateToExternalURL({environment:n,url:(0,H.UY)("guides.workspaceAnalytics")})}),[n]),I=(0,Ze.VK)((()=>t.getCreatedTime()<16593264e5),[t]),P=M.map((e=>_m[e])),Z=p?a()(yu,{type:"disabled",spaceName:h}):d.createElement(d.Fragment,null,C&&a()(ts.Z,{tabs:P,selectedIndex:M.indexOf(_),onChange:e=>{S(M[e])},style:i.tabsStyle}),function(e){const{currentTab:t,spaceAnalyticsStore:i,onUserTabFilterChange:n,spaceStore:o}=e;switch(t){case he.Content:return a()(zu,{spaceStore:o,contentEngagement:e.contentEngagementData});case he.Users:return a()(bm,{spaceStore:o,usersTabData:i.usersTabData,onUserTabFilterChange:n,userEngagement:e.userEngagementData});case he.Overview:return a()(tm,{contentEngagement:e.contentEngagementData,userEngagement:e.userEngagementData,spaceStore:o,onUserTabFilterChange:n});case he.Search:return a()(um,{spaceStore:o});default:(0,x.t1)(t)}}({currentTab:_,spaceAnalyticsStore:c,onUserTabFilterChange:y,spaceStore:t,contentEngagementData:r,userEngagementData:l}));return a()(Ee.Z,{},void 0,a()(Be.Z,{large:!0,style:i.headingStyle},void 0,a()("div",{style:i.title},void 0,a()(v.FormattedMessage,{id:"settings.workspaceAnalytics.title",defaultMessage:"Workspace analytics"}),I&&a()(We.Z,{placement:ka.u.Right,render:e=>d.createElement(Nr.Z,s()({},e,{href:(0,H.UY)("guides.workspaceAnalytics"),analyticsFrom:"workspace_analytics_faq",style:i.helpInfo})),renderTooltip:()=>a()(v.FormattedMessage,{id:"settings.workspaceAnalytics.dataDisclaimerTooltip",defaultMessage:"Data available from August 1, 2022 onwards"})})),a()(Re.Z,{isSmall:!0,onClick:k,icon:m.Z.help},void 0,a()(v.FormattedMessage,{id:"workspaceAnalytics.title.helpButton",defaultMessage:"Learn more"}))),Ee.Z.renderDivider(),Z)};var Tm=i(86080);var Im=i(51456);class Pm extends B.default{getInitialState(){return{churnSurveyModalOpen:!1,page:"default"}}}const Zm=Pm;var xm=i(13630);const Fm=function(e){let{handleExportClick:t}=e;window.__c={n:"ExportSpaceTab"};const i=(0,Ze.VK)((()=>A.default.state),[]),{currentSpaceStore:n}=i,o=(0,Ze.VK)((()=>xm.Z.state),[]),s=(0,Pe.O7)();return(0,d.useEffect)((()=>{De.zh({environment:s,spaceId:null==n?void 0:n.id})}),[null==n?void 0:n.id,s]),a()(d.Fragment,{},void 0,a()(Be.Z,{},void 0,a()(v.FormattedMessage,{id:"spaceBasicSettings.exportContentSection.title",defaultMessage:"Export content"})),a()("div",{style:{display:"flex",alignItems:"center",gap:8}},void 0,a()(Re.Z,{disabled:!!o.count,isLarge:!0,onClick:t},void 0,a()(v.FormattedMessage,{id:"spaceBasicSettings.exportContentSection.exportButton.label",defaultMessage:"Export all workspace content"})),o.count?a()(Bd.gq,{gap:4},void 0,a()(Ve.Z,{}),a()(Ae.Z,{isSmall:!0},void 0,a()(v.FormattedMessage,{id:"spaceBasicSettings.exportContentSection.exportInProgress",defaultMessage:"Export in progress"}))):d.createElement(d.Fragment,null)),a()("div",{style:{height:12}}),a()(Nr.Z,{title:a()(v.FormattedMessage,{id:"spaceBasicSettings.exportContentSection.helpButton.caption",defaultMessage:"Learn about exporting workspaces."}),href:(0,H.UY)("guides.exportWorkspace"),analyticsFrom:"space_settings"}),Ee.Z.renderDivider())};var Am=i(93007),Em=i(33411);const Bm=(0,v.defineMessages)({workspaceDomainInputPlaceholder:{id:"spaceBasicSettingsDomain.domainSection.workspaceDomainInput.placeholder",defaultMessage:"Your domain"},copyDomainTooltip:{id:"spaceBasicSettingsDomain.workspaceDomain.tooltip",defaultMessage:"Click to copy link"}}),Dm=()=>{window.__c={n:"AvailableField"};const e=(0,xe.Fg)();return a()("div",{style:{color:e.invoiceGreen,display:"flex",flexDirection:"row",alignItems:"center",fontSize:"14px"}},void 0,m.Z.circleCheckFilled({height:16,width:16,margin:"0 4px 0 8px",color:e.invoiceGreen}),a()("span",{},void 0,a()(v.FormattedMessage,{defaultMessage:"Available",id:"spaceBasicSettings.domainSection.workspaceDomainInput.validationMessage.available"})))},Rm=()=>a()("div",{style:{color:qn.ZP.red,display:"flex",flexDirection:"row",alignItems:"center",fontSize:"14px"}},void 0,m.Z.warning({height:16,width:16,margin:"0 4px 0 8px"}),a()("span",{},void 0,a()(v.FormattedMessage,{defaultMessage:"Used",id:"spaceBasicSettings.domainSection.workspaceDomainInput.validationMessage.used"}))),Lm=()=>a()("div",{style:{color:qn.ZP.red,display:"flex",flexDirection:"row",alignItems:"center",fontSize:"14px"}},void 0,m.Z.warning({height:16,width:16,margin:"0 4px 0 8px"}),a()("span",{},void 0,a()(v.FormattedMessage,{defaultMessage:"Not allowed",id:"spaceBasicSettings.domainSection.workspaceDomainInput.validationMessage.notAllowed"}))),Nm=()=>a()(Em.Z,{show:!0,showDelay:500,showHold:300,render:()=>a()(Ve.Z,{style:{textAlign:"center",visibility:"visible",display:"inline",marginLeft:8}})}),Om=e=>{window.__c={n:"SpaceBasicSettingsDomain"};const[t,i]=(0,Ze.AF)(e.spaceBasicSettingsStore),{domain:n,domainState:o}=t,r=(0,Pe.O7)(),l=(0,xe.Fg)(),[c,u]=(0,d.useState)(!0),m=d.createRef();return d.createElement(d.Fragment,null,a()(Be.Z,{},void 0,a()(v.FormattedMessage,{id:"spaceBasicSettings.domainSection.title",defaultMessage:"Domain"})),a()("div",{style:{display:"flex",alignItems:"center"}},void 0,a()("div",{style:{background:l.inputBackground,borderRadius:3,boxShadow:"rgb(15 15 15 / 10%) 0px 0px 0px 1px inset",display:"flex"}},void 0,d.createElement(Wi.Z,{type:"text",style:{background:"none",boxShadow:"none",padding:"4px 6px",width:255},ref:m,value:n,placeholder:z.default.formatMessage(Bm.workspaceDomainInputPlaceholder),readOnly:!e.canAdminSpaceStore,onChange:e.handleSpaceUrlChange,onFocus:e=>{u(!1),e.target.select()}})),c&&e.domainIsAutogenerated&&a()("div",{style:{color:qn.ZP.blue,fontSize:f.Z.fontSize.UIRegular.desktop,fontWeight:500,textAlign:"right",padding:"4px 6px",whiteSpace:"nowrap"},onClick:()=>{var e;null===(e=m.current)||void 0===e||e.focusInput(),u(!1),i({...t,domain:""})}},void 0,a()(v.FormattedMessage,{id:"spaceBasicSettings.changeDomain.cta.text",defaultMessage:"Set your own"})),n&&"available"===o&&a()(Dm,{}),"inuse"===o&&a()(Rm,{}),"disallowed"===o&&a()(Lm,{}),"loading"===o&&Nm()),a()(Ae.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:4}},void 0,((e,t)=>{const i=t=>a()(We.Z,{delayThreshold:0,renderTooltip:()=>z.default.formatMessage(Bm.copyDomainTooltip),render:i=>d.createElement(Jo.Z,s()({onClick:()=>{Tt.RD({environment:e,stringValue:t,copiedMessage:Tt.tq.copiedLinkToClipboard})}},i),t)});return a()("div",{style:{paddingTop:8}},void 0,a()(v.FormattedMessage,{id:"spaceBasicSettings.domainSection.workspaceDomainInput.viewPublicPage.caption",defaultMessage:"Pages shared to web will be under {linkText}.",values:{linkText:i(`${t}.${et.default.publicDomainName}`)}}),a()("div",{style:{paddingTop:6}}),a()(v.FormattedMessage,{id:"spaceBasicSettings.domainSection.workspaceDomainInput.joinWorkspace.caption",defaultMessage:"Anyone with an allowed email domain can join this workspace via {linkText}.",values:{linkText:i(`${window.location.host}/${t}`)}}))})(r,n)))},Vm=e=>{window.__c={n:"SpaceBasicSettingsPublicHomePageInputMenu"};const t=(0,v.useIntl)(),i=(0,xe.Fg)(),n=(0,Pe.O7)(),o=(0,Ze.VK)((()=>(0,j.M9)(n)),[n]),s=!Boolean(o),[r,l]=(0,Ze.AF)(ge);return a()("div",{onClick:()=>{o&&Pr.y(n,{from:"public_domain_home_page",for:o})}},void 0,d.createElement(Wi.Z,{type:"text",ref:e.textInputRef,style:{background:i.inputBackground,borderRadius:3,boxShadow:"rgb(15 15 15 / 10%) 0px 0px 0px 1px inset",display:"flex",padding:"4px 6px"},value:r.query,onChange:e=>{l({...r,query:e.target.value})},onFocus:()=>{s&&l({...r,openDropdown:!0})},disabled:!s,left:m.Z.search({fill:i.mediumIconColor,width:16,height:16,marginRight:8,marginLeft:8,flexGrow:0,flexShrink:0}),placeholder:t.formatMessage({defaultMessage:"Select a page shared to web",id:"spaceBasicSettings.PublicHomePageSection.input.placeholder"})}))};var Um=i(29026),Wm=i(11470);const Km=()=>a()(Em.Z,{show:!0,showDelay:500,showHold:300,render:()=>a()(Ve.Z,{style:{textAlign:"center",visibility:"visible",display:"inline",marginLeft:8}})}),zm=async(e,t)=>{if(!Fe.Z.state.online)return[];const i=await _n.UJ({environment:t,query:e,source:"public_home_page_menu",limit:Um.Xv});return""===e?i.splice(0,5):i},Gm=e=>{window.__c={n:"SpaceBasicSettingsPublicHomePageSearchResults"};const t=(0,Pe.O7)(),[i,n]=(0,Ze.AF)(e.spaceBasicSettingsStore,Se),[o,r]=(0,Ze.AF)(ge),{query:l}=o,[{value:c,status:u}]=(0,fs.r5)((()=>zm(l,t)),[l,t]),m=(0,Ze.VK)((()=>(0,V.RM)()),[]);if(!(l||c&&0!==c.length))return null;return a()("div",{style:{marginTop:2,marginBottom:2}},void 0,a()(lt.Z,{type:lt.i.Vertical,sections:[{key:"recent public pages section",render:e=>d.createElement(ct.Z,e),items:"idle"===u||"pending"===u?[{key:"loading spinner",render:Km,action:()=>{}}]:m&&c&&0!==c.length?[...c.map((e=>{const t=He.G.createChildStore(m,{table:hn.iU,id:e.id});return{key:`${e.id} page`,render:e=>d.createElement(Wm.Z,s()({store:t},e)),action:()=>{n({...i,publicHomePage:e.id}),r({...o,openDropdown:!1,displaySummary:!0})}}}))]:[{key:"no results",render:()=>a()(Ae.Z,{isSmall:!0,style:{marginLeft:8}},void 0,a()(v.FormattedMessage,{id:"spaceBasicSettings.PublicHomePageSection.dropdownLabel.noResults",defaultMessage:"No results"})),action:()=>{}}]}],initialFocus:void 0}))},qm=e=>{window.__c={n:"SpaceBasicSettingsPublicHomePageSummary"};const[t,i]=(0,Ze.AF)(e.spaceBasicSettingsStore,Se),[n,o]=(0,Ze.AF)(ge),[s,r]=(0,Ze.VK)((()=>{const e=(0,V.RM)();if(!e||!t.publicHomePage)return[];const i=He.G.createChildStore(e,{table:hn.iU,id:t.publicHomePage});return[i,i.getIcon()]}),[t]);return s?a()("div",{style:{display:"flex",alignItems:"center"}},void 0,a()("div",{style:{display:"flex",paddingRight:8,alignItems:"center"}},void 0,r&&a()(je.Z,{icon:r,isEmptyPage:!1,size:18,disabled:!0,style:{display:"inline-flex",marginRight:2,verticalAlign:"text-top"}}),a()(qu.Z,{store:s,style:{display:"inline",whiteSpace:"normal",marginRight:Boolean(r)?3:0,wordBreak:"break-word"}})),a()(Re.Z,{onClick:()=>{o({...n,displaySummary:!1}),i({...t,publicHomePage:void 0})}},void 0,a()(v.FormattedMessage,{id:"spaceBasicSettings.PublicHomePageSection.dropdownLabel",defaultMessage:"Clear"}))):null},Hm=e=>{window.__c={n:"SpaceBasicSettingsPublicHomePage"};const t=(0,Pe.O7)(),i=d.createRef(),[n,o]=(0,Ze.AF)(ge),[r]=(0,Ze.AF)(e.spaceBasicSettingsStore),{openDropdown:l,displaySummary:c}=n,{publicHomePage:u,domain:m}=r,p=`${m}.${et.default.publicDomainName}`,g=(0,Ze.VK)((()=>(0,j.M9)(t)),[t]),h=!Boolean(g);return d.createElement(d.Fragment,null,a()(Be.Z,{style:{display:"flex",alignItems:"center"}},void 0,a()("span",{style:{marginRight:8}},void 0,a()(v.FormattedMessage,{id:"spaceBasicSettings.PublicHomePageSection.title",defaultMessage:"Public home page"})),g&&a()(Zr.Z,{subscriptionTier:g,analyticsName:"public_domain_home_page",desktopStyle:{marginTop:-1}})),h&&u&&c?a()(qm,{spaceBasicSettingsStore:e.spaceBasicSettingsStore}):a()(dt.ZP,{alignmentToOrigin:dt.ZP.Alignment.Start,keepFocus:t.device.isPhone,onDismiss:()=>{var e;null===(e=i.current)||void 0===e||e.handleBlur(),o({...n,openDropdown:!1,displaySummary:!0})},origin:a()(Vm,{textInputRef:i}),open:l,popupType:dt.ZP.PopupType.Popup,style:{width:250},render:()=>a()(rt.Z,{menuType:it.og.Popup,width:250},void 0,a()(Gm,{spaceBasicSettingsStore:e.spaceBasicSettingsStore}))}),a()(Ae.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:8}},void 0,a()(v.FormattedMessage,{id:"spaceBasicSettings.PublicHomePageSection.caption",defaultMessage:"Access your public home page via {linkText}.",values:{linkText:a()(We.Z,{delayThreshold:0,renderTooltip:()=>a()(v.FormattedMessage,{id:"spaceBasicSettings.PublicHomePageSection.caption.tooltip",defaultMessage:"Click to copy link"}),render:e=>d.createElement(Jo.Z,s()({onClick:()=>{Tt.RD({environment:t,stringValue:p,copiedMessage:Tt.tq.copiedLinkToClipboard})}},e),p)})}})))};var jm=i(82328),Qm=i(40004);function Ym(){return a()(v.FormattedMessage,{id:"spaceBasicSettings.workspaceNameSection.nameInput.caption",defaultMessage:"You can use your organization or company name. Keep it simple."})}const $m=(0,v.defineMessages)({nameInputPlaceholder:{id:"spaceBasicSettings.nameInput.placeholder",defaultMessage:"e.g. company name"},workspaceDomainInputPlaceholder:{id:"spaceBasicSettings.domainSection.workspaceDomainInput.placeholder",defaultMessage:"URL"},allowedEmailDomainsInputPlaceholder:{id:"spaceBasicSettings.allowedEmailDomainsSection.emailDomainInput.placeholder",defaultMessage:"Type an email domain…"},copyDomainTooltip:{id:"spaceBasicSettings.workspaceDomain.tooltip",defaultMessage:"Click to copy link"}});class Xm extends c.Z{constructor(){super(...arguments),this.storeTypes={spaceBasicSettingsStore:Se,securitySettingsStore:me.Z,store:Zm,tokenQuery:B.default.createClass("")},this.handleEnableAiFeatureClick=()=>{const{securitySettingsStore:e}=this.props;e&&e.setState({...e.state,enableAiFeature:!e.state.enableAiFeature})},this.handleSpaceNameChange=e=>{this.stores.spaceBasicSettingsStore.setState({...this.stores.spaceBasicSettingsStore.state,name:e.target.value})},this.handleCheckDomainAvailability=e=>{const{spaceBasicSettingsStore:t}=this.stores,{spaceStore:i}=this.props;C._u({environment:this.environment,spaceStore:i,domain:e}).then((e=>{if("success"!==e.type)this.stores.spaceBasicSettingsStore.setState({...this.stores.spaceBasicSettingsStore.state,domainState:"loading"});else{const i=e.data.domain===t.state.domain;this.stores.spaceBasicSettingsStore.setState({...this.stores.spaceBasicSettingsStore.state,domainState:i?e.data.domainState:t.state.domainState})}}))},this.checkSpaceDomainAvailabilityDebounced=r.debounce(this.handleCheckDomainAvailability,250),this.handleSpaceUrlChange=e=>{const t=C.$U(e.target.value);this.checkSpaceDomainAvailabilityDebounced(t),this.stores.spaceBasicSettingsStore.setState({...this.stores.spaceBasicSettingsStore.state,domain:t}),this.forceUpdate()},this.handleConfirm=async()=>{const{spaceStore:e}=this.props,{spaceBasicSettingsStore:t,securitySettingsStore:i}=this.stores;await C.Y5({environment:this.environment,spaceId:e.id,spaceBasicSettingsStore:t})&&(await C.OF({environment:this.environment,spaceStore:e,spaceBasicSettingsStore:t,securitySettingsStore:i}),ge.setState(ge.getInitialState()),_e.Z.setState({..._e.Z.state,open:!1}))},this.handleCancelClick=()=>{_e.Z.setState({..._e.Z.state,open:!1}),ge.setState(ge.getInitialState())},this.handleExportClick=()=>{const{currentSpaceStore:e}=A.default.state;e&&De.q$({environment:this.environment,root:{table:"space",id:e.id,spaceId:e.id},isCollectionViewExportTypeSupported:!0})},this.handleExportMembersClick=()=>{const{currentSpaceStore:e}=A.default.state,{data:t}=ke.default.state;e&&t&&"subscribed_admin"===t.type&&De.$G({spaceStore:e,subscriptionData:t,intl:this.props.intl})},this.handleLeaveClick=()=>{const{spaceStore:e}=this.props,{currentUserSettingsStore:t}=A.default.state;t&&M.showDialog({message:a()(v.FormattedMessage,{id:"spaceBasicSettings.leaveWorkspaceConfirmationDialog.prompt",defaultMessage:"Are you sure you want to leave this workspace?"}),showCancel:!0,keepFocus:!0,items:[{label:a()(v.FormattedMessage,{id:"spaceBasicSettings.leaveWorkspaceConfirmationDialog.leaveButton.label",defaultMessage:"Leave"}),color:"red",onAccept:async()=>{await C.bf({environment:this.environment,spaceId:e.id,userSettingsStore:t})&&(b.z01(this.environment),_e.Z.setState({..._e.Z.state,open:!1}))}}]})},this.renderChurnSurveyModal=()=>{const{data:e}=ke.default.state,t=this.stores.store.state,i=j.XX(e);if(i&&t.churnSurveyModalOpen)return a()(Qm.Z,{churnType:t.churnType,currentPlan:t.churnType,isWorkspaceDeletion:!0,periodEnd:i.periodEnd,hasAI:h.de(i.addOns),hasPendingChanges:Boolean(i.schedule||i.willCancelAt),customerId:i.customerId,onAccept:()=>{const{store:e}=this.stores;e.state.churnSurveyModalOpen&&e.state.onAccept()},onClose:()=>{const{store:e}=this.stores;e.state.churnSurveyModalOpen&&e.state.onClose(),e.reset()}})},this.handleDeleteClick=async()=>{const e=(0,Q.zt)();if(!e)return;const{data:t}=ke.default.state,i=j.XX(t);if(b.YO0(this.environment),i){if(!(await new Promise((t=>{const{store:i}=this.stores;i.setState({...i.state,churnType:e,churnSurveyModalOpen:!0,onAccept:async()=>{t(!0),await this.showWorkspaceDeletionConfirmation()},onClose:()=>t(!1)})}))))return}await this.showWorkspaceDeletionConfirmation()},this.showWorkspaceDeletionConfirmation=async()=>{const{currentUserSettingsStore:e}=A.default.state;if(!e)return;const{spaceStore:t,intl:i}=this.props,n=(0,Zo.rn)(this.environment,t)||i.formatMessage({defaultMessage:"Untitled workspace",id:"spaceBasicSettings.deleteWorkspace.untitledWorkspace.placeholder"}),o=(0,ac.Bd)(_a.SP)?a()(v.FormattedMessage,{id:"spaceBasicSettings.deleteWorkspaceConfirmationDialog.prompt",defaultMessage:"This action cannot be undone. This will permanently delete the workspace, including all pages and files. Please type the name of the workspace to confirm."}):d.createElement(d.Fragment,null,a()(Am.Z,{style:{marginTop:16},translations:{es:"Esta acción no se puede deshacer. Esto eliminará permanentemente el espacio de trabajo, incluidas todas las páginas y archivos. Por favor escriba el nombre del espacio de trabajo para confirmar.",ru:"Это действие не может быть отменено. Это навсегда удалит рабочее пространство, включая все страницы и файлы. Пожалуйста, введите название рабочей области для подтверждения.",zh:"此操作无法撤消。 这将永久删除工作区，包括所有页面和文件。 请输入要确认的工作空间的名称。",de:"Diese Aktion kann nicht rückgängig gemacht werden. Dadurch wird der Arbeitsbereich einschließlich aller Seiten und Dateien dauerhaft gelöscht. Bitte geben Sie den Namen des Arbeitsbereichs zur Bestätigung ein.",fr:"Cette action ne peut pas être annulée. Cela supprimera définitivement l'espace de travail, y compris toutes les pages et tous les fichiers. Veuillez saisir le nom de l'espace de travail pour confirmer.",ja:"この操作を元に戻すことはできません。 これにより、すべてのページとファイルを含むワークスペースが完全に削除されます。 確認するワークスペースの名前を入力してください。",it:"Questa azione non può essere annullata. Questo eliminerà definitivamente l'area di lavoro, incluse tutte le pagine e i file. Digita il nome dell'area di lavoro per confermare.",pt:"Essa ação não pode ser desfeita. Isso excluirá permanentemente o espaço de trabalho, incluindo todas as páginas e arquivos. Por favor, digite o nome do espaço de trabalho para confirmar.",nl:"Deze actie kan niet ongedaan gemaakt worden. Hiermee wordt de werkruimte permanent verwijderd, inclusief alle pagina's en bestanden. Typ de naam van de werkruimte om te bevestigen.",pl:"Tego działania nie można cofnąć. Spowoduje to trwałe usunięcie obszaru roboczego, w tym wszystkich stron i plików. Wpisz nazwę obszaru roboczego, aby potwierdzić.",sv:"Den här åtgärden kan inte ångras. Detta tar bort arbetsytan permanent, inklusive alla sidor och filer. Vänligen skriv in arbetsplatsens namn för att bekräfta.",uk:"Цю дію не можна скасувати. Це дозволить остаточно видалити робочу область, включаючи всі сторінки та файли. Введіть назву робочої області для підтвердження.",no:"Denne handlingen kan ikke fortrykkes. Dette vil permanent slette arbeidsområdet, inkludert alle sider og filer. Vennligst skriv navnet på arbeidsområdet for å bekrefte.",tr:"Bu işlem geri alınamaz. Bu, tüm sayfaları ve dosyaları içeren çalışma alanını kalıcı olarak siler. Lütfen onaylamak için çalışma alanının adını yazın.",cs:"Tuto akci nelze vrátit zpět. Tím se trvale odstraní pracovní prostor včetně všech stránek a souborů. Zadejte prosím název pracovního prostoru, který chcete potvrdit.",vi:"Hành động này không thể được hoàn tác. Điều này sẽ xóa vĩnh viễn không gian làm việc, bao gồm tất cả các trang và tệp. Vui lòng nhập tên của không gian làm việc để xác nhận.",da:"Denne handling kan ikke fortrydes. Dette vil permanent slette arbejdsområdet, inklusive alle sider og filer. Indtast navnet på arbejdsområdet for at bekræfte.",hu:"Ez a művelet nem visszavonható. Ez véglegesen törli a munkaterületet, beleértve az összes oldalt és fájlt. Kérjük, írja be a munkaterület nevét a megerősítéshez.",ar:"لا يمكن التراجع عن هذا الإجراء. سيؤدي ذلك إلى حذف مساحة العمل كليا ، بما يشمل جميع الصفحات والملفات. يرجى كتابة اسم مساحة العمل للتأكيد.",th:"การกระทำนี้ไม่สามารถยกเลิกได้ นี่จะเป็นการลบพื้นที่ทำงานอย่างถาวรรวมถึงหน้าและไฟล์ทั้งหมด โปรดพิมพ์ชื่อของพื้นที่ทำงานเพื่อยืนยัน",he:"לא ניתן לבטל פעולה זו. פעולה זו תמחק לצמיתות את סביבת העבודה, כולל כל הדפים והקבצים. הקלד את שם מרחב העבודה כדי לאשר.",fi:"Tätä toimintoa ei voi peruuttaa. Tämä poistaa työtilan pysyvästi, mukaan lukien kaikki sivut ja tiedostot. Vahvista kirjoittamalla työtilan nimi.",id:"Tindakan ini tidak bisa dibatalkan. Ini akan secara permanen menghapus ruang kerja, termasuk semua halaman dan file. Silakan ketik nama ruang kerja untuk mengonfirmasi."}}));await Tm.b({message:a()("div",{},void 0,a()("div",{},void 0,o)),acceptLabel:a()(v.FormattedMessage,{id:"spaceBasicSettings.deleteWorkspaceConfirmationDialog.deleteWorkspaceButton.label",defaultMessage:"Permanently delete workspace"}),requiredInputValue:n})&&(C.Ns({environment:this.environment,spaceId:t.id,userSettingsStore:e}),b.BPl(this.environment),_e.Z.setState({..._e.Z.state,open:!1}))},this.handleRecordIconChange=e=>{const{spaceStore:t}=this.props;N.createAndCommit({userAction:"SpaceBasicSettings.handleRecordIconChange",environment:this.environment,perform:i=>{Eo.sO({store:t.getIconStore(),value:e,transaction:i})}})}}willMount(e){super.willMount(e);const{spaceStore:t}=this.props,{spaceBasicSettingsStore:i}=this.stores,n=i.getValueForSpace(t);n&&i.setState(n)}renderComponent(){return Fe.Z.state.online?this.renderSettings():this.renderOfflineMessage()}renderOfflineMessage(){return a()(Ee.Z,{},void 0,a()(Ae.Z,{isSmall:!0,style:{textAlign:"center"}},void 0,a()(v.FormattedMessage,{id:"spaceBasicSettings.offlineMessage",defaultMessage:"Please go online to manage settings."})))}validateDomain(){const{spaceBasicSettingsStore:e}=this.stores,{domain:t,domainState:i}=e.state;return!!t&&("available"===i||"current-space"===i)}renderSettings(){const{spaceStore:e}=this.props,{spaceBasicSettingsStore:t}=this.stores,{name:i}=t.state,{data:n}=ke.default.state,{device:o}=this.environment;if(!n)return;const s=e.canAdmin(),r=(0,Zo.Cx)(e),l=(0,Zo.jv)(e),c=j.qF(this.environment),u=s&&!e.getDisableExport(),m=s,p=(0,Q.zt)(),g="subscribed_admin"===n.type&&("enterprise"===p||"business"===p),h=e.getSettings().disable_page_analytics,f=_s.Z.getPublicSpaceData(this.environment,e.id);return a()(Ee.Z,{controlRow:s&&this.renderControlRow()},void 0,this.renderSpaceBasicHeader(),r&&a()(Ae.Z,{isSmall:!0,isMultiline:!0,style:{textAlign:"center"}},void 0,a()(v.FormattedMessage,{id:"spaceBasicSettings.guestLimitedAccessMessage",defaultMessage:"You are currently a guest in this workspace. Ask an admin to add you as a member in order to see other pages and workspace settings."})),r&&Ee.Z.renderDivider(),s&&a()(d.Fragment,{},void 0,a()(Be.Z,{},void 0,a()(v.FormattedMessage,{id:"spaceBasicSettings.workspaceNameSection.title",defaultMessage:"Name"})),a()(Wi.Z,{value:i,placeholder:z.default.formatMessage($m.nameInputPlaceholder),readOnly:!s,onChange:this.handleSpaceNameChange}),a()(Ae.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:4}},void 0,a()(Ym,{})),Ee.Z.renderDivider()),s&&a()(d.Fragment,{},void 0,a()(Be.Z,{},void 0,a()(v.FormattedMessage,{id:"spaceBasicSettings.workspaceIconSection.title",defaultMessage:"Icon"})),a()("div",{style:{width:72,height:72,border:`1px solid ${this.theme.regularDividerColor}`,borderRadius:6,display:"flex",justifyContent:"center",alignItems:"center"}},void 0,a()(je.Z,s?{bucket:"public",disabled:!1,icon:(0,Zo.Wd)(this.environment,e),isEmptyPage:!1,title:i,size:64,iconLoggingData:{recordTable:e.table,source:"workspace_settings"},onChange:this.handleRecordIconChange}:{disabled:!0,icon:(0,Zo.Wd)(this.environment,e),isEmptyPage:!1,title:i,size:64})),a()(Ae.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:8}},void 0,a()(v.FormattedMessage,{id:"spaceBasicSettings.workspaceIconSection.caption",defaultMessage:"Upload an image or pick an emoji. It will show up in your sidebar and notifications."})),Ee.Z.renderDivider()),(y=this.environment,!(null===(S=A.default.state.currentSpaceStore)||void 0===S||!S.canAdmin())&&(0,j.qb)(y,"enterprise")&&d.createElement(d.Fragment,null,this.renderSpaceBasicFeatureSubheader(),this.renderAiFeature(),Ee.Z.renderDivider())),this.renderSpaceBasicPublicSubHeader(),s&&d.createElement(d.Fragment,null,a()(Om,{canAdminSpaceStore:s,domainIsAutogenerated:null==f?void 0:f.domainIsAutogenerated,spaceStore:e,spaceBasicSettingsStore:t,handleSpaceUrlChange:this.handleSpaceUrlChange}),Ee.Z.renderDivider()),s&&c&&a()(d.Fragment,{},void 0,a()(Be.Z,{},void 0,a()(v.FormattedMessage,{id:"spaceBasicSettings.allowedEmailDomainsSection.title",defaultMessage:"Allowed email domains"})),this.renderAllowedEmailDomains(),a()(Ae.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:4}},void 0,a()(v.FormattedMessage,{id:"spaceBasicSettings.allowedEmailDomainsSection.emailDomainInput.caption",defaultMessage:"Anyone with email addresses at these domains can automatically join your workspace."})),Ee.Z.renderDivider()),s&&a()(d.Fragment,{},void 0,a()(Hm,{spaceBasicSettingsStore:t}),Ee.Z.renderDivider()),u&&a()(Fm,{handleExportClick:this.handleExportClick}),m&&a()(d.Fragment,{},void 0,a()(Be.Z,{style:{display:"flex",alignItems:"center"}},void 0,a()("span",{style:{marginRight:8}},void 0,a()(v.FormattedMessage,{id:"spaceBasicSettings.exportMembersSection.title",defaultMessage:"Export members"})),!g&&a()(Zr.Z,{subscriptionTier:"business",analyticsName:"space_export_members",desktopStyle:{marginTop:-1}})),a()("div",{style:{display:"flex"}},void 0,a()(Re.Z,{isLarge:!0,disabled:!g,onClick:this.handleExportMembersClick,disabledFeedback:!0},void 0,a()(v.FormattedMessage,{id:"spaceBasicSettings.exportMembersSection.exportAsCSVButton.label",defaultMessage:"Export members as CSV"}))),a()("div",{style:{height:12}}),a()(Nr.Z,{title:a()(v.FormattedMessage,{id:"spaceBasicSettings.exportMembersSection.helpButton.caption",defaultMessage:"Learn about exporting members."}),href:(0,H.UY)("guides.exportMembers"),analyticsFrom:"space_settings"}),Ee.Z.renderDivider()),s&&a()(d.Fragment,{},void 0,a()(Be.Z,{},void 0,a()(v.FormattedMessage,{id:"spaceBasicSettings.analytics.title",defaultMessage:"Analytics"})),a()("div",{style:{display:"flex",gap:12,flexDirection:"column"}},void 0,a()(es.Z,{isMobile:o.isMobile,title:a()(v.FormattedMessage,{id:"spaceBasicSettings.analytics.settings.title",defaultMessage:"Save and display page view analytics"}),caption:a()(v.FormattedMessage,{id:"spaceBasicSettings.analytics.settings.description",defaultMessage:"People with edit or full access will be able to see how many views a page has. If this is turned off, page views will not be stored for all pages in {workspaceName}.",values:{workspaceName:i}}),type:"toggle",isOn:!h,onToggle:()=>{const t=!h;N.createAndCommit({userAction:"SpaceBasicSettings.analyticsSettings.onSelectOption",environment:this.environment,perform:i=>{Eo.sW({store:e,data:{settings:{...e.getSettings(),disable_page_analytics:t}},transaction:i})}}),Im.j(this.environment,t?"page_analytics_workspace_opt_out":"page_analytics_workspace_opt_in")}}),a()(Nr.Z,{title:a()(v.FormattedMessage,{defaultMessage:"Learn about workspace analytics.",id:"spaceBasicSettings.workspaceAnalytics.helpButton.caption"}),href:(0,H.UY)("guides.workspaceAnalytics"),analyticsFrom:"workspace_analytics_faq"})),Ee.Z.renderDivider()),a()(Be.Z,{},void 0,a()(v.FormattedMessage,{id:"spaceBasicSettings.dangerousSettingsSection.title",defaultMessage:"Danger zone"})),a()("div",{style:{display:"flex"}},void 0,(l.length>1||r)&&a()(Re.Z,{isLarge:!0,onClick:this.handleLeaveClick,style:{marginRight:s?12:void 0}},void 0,a()(v.FormattedMessage,{id:"spaceBasicSettings.dangerousSettingsSection.leaveWorkspaceButton.label",defaultMessage:"Leave workspace"})),s&&d.createElement(d.Fragment,null,this.renderModal(),a()(Re.Z,{isLarge:!0,isRed:!0,onClick:this.handleDeleteClick},void 0,a()(v.FormattedMessage,{id:"spaceBasicSettings.dangerousSettingsSection.deleteWorkspaceButton.label",defaultMessage:"Delete entire workspace"})))),s&&a()(d.Fragment,{},void 0,a()("div",{style:{height:12}}),a()(Nr.Z,{title:a()(v.FormattedMessage,{id:"spaceBasicSettings.dangerousSettingsSection.deleteWorkspaceHelpButton.caption",defaultMessage:"Learn about deleting workspaces."}),href:(0,H.UY)("guides.deleteWorkspace"),analyticsFrom:"space_settings"})));var y,S}renderAiFeature(){var e;return a()("div",{},void 0,a()("div",{style:{display:"flex",alignItems:"center",cursor:"pointer"},onClick:this.handleEnableAiFeatureClick},void 0,a()("div",{style:this.getTitleStyle()},void 0,a()("div",{style:{display:"flex",alignItems:"center"}},void 0,m.Z.sparkles({width:16,height:16,marginRight:6}),a()(v.FormattedMessage,{id:"spaceBasicSettings.aiFeature.label",defaultMessage:"Notion AI"})),a()(Ae.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"80%"}},void 0,a()(v.FormattedMessage,{id:"spaceBasicSettings.aiFeature.ga.caption",defaultMessage:"Enable to provide AI-powered functionality for all members of your workspace.{br}By enabling Notion AI, you are agreeing to the <inlinelink>Notion AI Supplementary Terms</inlinelink>",values:{br:a()("br",{}),inlinelink:e=>a()(Jo.Z,{href:"https://notion.notion.site/fa9034c8b5a04818a6baf3eac2adddbb",external:!0,onClick:e=>e.stopPropagation()},void 0,e)}}))),a()("div",{style:{marginTop:5}},void 0,a()(dr.Z,{on:Boolean(null===(e=this.props.securitySettingsStore)||void 0===e?void 0:e.state.enableAiFeature)}))))}renderSpaceBasicPublicSubHeader(){return a()(Be.Z,{large:!0,divider:"full",style:{paddingTop:12}},void 0,a()(v.FormattedMessage,{id:"spaceBasicSettings.public.subtitle",defaultMessage:"Public settings"}))}renderSpaceBasicFeatureSubheader(){return a()(Be.Z,{large:!0,divider:"full",style:{paddingTop:12}},void 0,a()(v.FormattedMessage,{id:"spaceBasicSettings.feature.subtitle",defaultMessage:"Feature settings"}))}renderSpaceBasicHeader(){return a()(Be.Z,{large:!0,divider:"full"},void 0,a()(v.FormattedMessage,{id:"spaceBasicSettings.title",defaultMessage:"Workspace settings"}))}renderControlRow(){return a()("div",{style:{display:"flex"}},void 0,a()($e.Z,{isLarge:!0,onClick:this.handleConfirm,disabled:!this.validateDomain()},void 0,a()(v.FormattedMessage,{id:"spaceBasicSettings.updateButton.label",defaultMessage:"Update"})),a()(Re.Z,{isLarge:!0,style:{marginLeft:12},onClick:this.handleCancelClick},void 0,a()(v.FormattedMessage,{id:"spaceBasicSettings.cancelButton.label",defaultMessage:"Cancel"})))}renderAllowedEmailDomains(){const{device:e}=this.environment,{spaceStore:t}=this.props,{spaceBasicSettingsStore:i}=this.stores,{emailDomains:n}=i.state,o=t.canAdmin();return a()(dt.ZP,{popupType:e.isMobile?dt.ZP.PopupType.SlideUp:dt.ZP.PopupType.Popup,sameWidthAsOrigin:!0,open:this.stores.tokenQuery.state.length>0,origin:a()(Mi.Z,{placeholder:z.default.formatMessage($m.allowedEmailDomainsInputPlaceholder),value:this.stores.tokenQuery.state,onChange:e=>this.stores.tokenQuery.setState(e.target.value),readOnly:!o,onRemoveLastToken:()=>{const e=n.slice(0,n.length-1);i.setState({...i.state,emailDomains:e})},tokens:n.map((e=>a()(bi.Z,{showRemoveButton:!0,isSingle:!1,format:fi.l.Medium,onClickRemove:()=>{const t=n.filter((t=>t!==e));i.setState({...i.state,emailDomains:t})},value:e},e)))}),render:()=>{const t=this.stores.tokenQuery.state.trim(),{data:o}=ke.default.state,{spaceStore:r}=this.props,l=a()(v.FormattedMessage,{id:"spaceBasicSettings.allowedEmailDomainsSection.emailDomainsDropdown.placeholder",defaultMessage:"Type an email domain…"}),c=a()(v.FormattedMessage,{id:"spaceBasicSettings.allowedEmailDomainsSection.emailDomainsDropdown.placeholderNoResults",defaultMessage:"Type an email domain of a member of this workspace…"}),u=o?j.hn(o).map((e=>{if(("unsubscribed_admin"===o.type||"unsubscribed_member"===o.type||"subscribed_admin"===o.type)&&o.joinedMemberIds.includes(e.userId)){const t=He.U6.createChildStore(r,{table:Qt.KJ,id:e.userId}).getEmail();return t&&(0,ud.Gd)(t)}})).filter(((e,t,i)=>Boolean(e&&t===i.indexOf(e)&&!n.includes(e)))):[],m=(0,sa.ZP)(t,u,(e=>e)).map(((e,t)=>({key:t,render:t=>d.createElement(ot.Z,s()({},t,{title:e})),action:()=>{const t=[...n,e];i.setState({...i.state,emailDomains:t}),this.stores.tokenQuery.setState("")}})));let p;return p=e.isMobile?{menuType:it.og.ActionSheet}:{menuType:it.og.Popup,width:"100%"},d.createElement(rt.Z,p,a()(lt.Z,{type:lt.i.Vertical,initialFocus:m.length>0?0:void 0,sections:[{key:0,render:e=>d.createElement(ct.Z,s()({},e,{disableDesktopPadding:!0,title:m.length>0?l:c})),items:m}]}))},onDismiss:()=>{this.stores.tokenQuery.setState("")}})}renderModal(){const{churnSurveyModalOpen:e}=this.stores.store.state;return a()(jm.q,{isOpen:e,dismissUsing:"onlyEscape",onDismiss:()=>{const{store:e}=this.stores;e.state.churnSurveyModalOpen&&e.state.onClose(),e.reset()}},void 0,this.renderChurnSurveyModal())}getTitleStyle(){return{fontSize:14,marginRight:8,flexGrow:1}}}Xm.displayName="SpaceBasicSettings";const Jm=(0,v.injectIntl)(Xm);var ep=i(40141),tp=i(97832),ip=i(90403),np=i(78873);let ap=function(e){return e.Password="Password",e.CurrentEmail="TemporaryPasscode",e}({});class op extends B.default{getInitialState(){return{open:!1,authorized:!1,authorizationType:void 0}}}const sp=op;var rp=i(37770);const lp=(0,v.defineMessages)({dialogLabel:{id:"profileSettings.accountSecuritySection.emailSetting.dialogLabel",defaultMessage:"Change email"}});class dp extends c.Z{constructor(){super(...arguments),this.storeTypes={store:sp},this.renderModalContent=()=>{const{store:e}=this.stores,{state:t}=e;return a()("div",{style:{...this.styles.modal,...this.getColors().modal}},void 0,a()(rp.Z,{fetch:this.getAuthorizationType,loading:e=>e&&a()("div",{style:this.styles.loadingSpinner},void 0,a()(Ve.Z,{})),render:()=>a()(d.Fragment,{},void 0,t.authorizationType===ap.Password?this.renderVerifyPassword(t):t.authorizationType===ap.CurrentEmail?this.renderVerifyCurrentEmail(t):void 0,t.authorized&&this.renderSetNewEmail(t))}))},this.renderSetNewEmail=e=>{const{store:t}=this.stores,{userValue:i}=this.props;if(t.state.authorized)return a()(d.Fragment,{},void 0,a()("p",{style:this.styles.paragraph},void 0,a()(v.FormattedMessage,{id:"profileSettings.changeEmailModal.newEmailInstructions",defaultMessage:"Please enter a new email and we will send you a verification code."})),a()("div",{},void 0,this.renderNewEmailInput()),t.state.newEmailContainsVerifiedDomain&&(0,ud.Gd)(t.state.newEmail)!==(0,ud.Gd)((null==i?void 0:i.email)||"")&&this.renderClaimedEmailDomainWarning(e),t.state.newEmailPasscodeSent?this.renderNewEmailPasscodeInput(e):this.renderSendNewEmailPasscodeButton(e),this.renderEducationPlanDowngradeWarning())},this.handleSendCurrentEmailVerification=async()=>{const{userValue:e}=this.props,{store:t}=this.stores;if(!e)return;t.setState({...t.state,loading:!0});const i=await T.sendEmailVerification(this.environment,{email:e.email});"success"===i.type?t.setState({...t.state,currentEmailPasscodeSent:!0,currentEmailPasscode:"",error:void 0,loading:!1}):t.setState({...t.state,currentEmailPasscodeSent:!0,loading:!1,error:(0,kn.wf)(this.props.intl,i)})},this.handleChangeCurrentEmailPasscode=e=>{const{store:t}=this.stores;t.setState({...t.state,currentEmailPasscode:e.currentTarget.value,error:void 0})},this.handleChangePassword=e=>{const{store:t}=this.stores;t.setState({open:!0,authorized:!1,authorizationType:ap.Password,password:e.currentTarget.value,error:void 0})},this.handleClearPassword=()=>{const{store:e}=this.stores;e.setState({open:!0,authorized:!1,authorizationType:ap.Password,password:""})},this.handleSubmitAuthorization=async()=>{const{store:e}=this.stores;if(!e.state.authorized)if(e.state.authorizationType===ap.Password){if(!this.getUserCurrentEmail())return;e.setState({...e.state,loading:!0});const t=await T.authVerifyPassword(this.environment,{password:e.state.password});if("failed"===t.type)return void e.setState({...e.state,loading:!1,error:(0,kn.wf)(this.props.intl,t)});e.setState({...e.state,authorized:!0,newEmail:"",newEmailPasscode:"",newEmailPasscodeSent:!1,newEmailContainsVerifiedDomain:!1,error:void 0,loading:!1})}else e.state.authorizationType===ap.CurrentEmail&&e.setState({...e.state,authorized:!0,newEmail:"",newEmailPasscode:"",newEmailPasscodeSent:!1,newEmailContainsVerifiedDomain:!1,error:void 0,loading:!1})},this.handleChangeNewEmail=e=>{const{store:t}=this.stores;t.setState({...t.state,newEmail:e.currentTarget.value,error:void 0})},this.handleClearNewEmail=()=>{const{store:e}=this.stores;e.setState({...e.state,newEmail:"",newEmailPasscodeSent:!1,newEmailContainsVerifiedDomain:!1,error:void 0})},this.handleSendNewEmailVerification=async()=>{const{store:e}=this.stores;if(!e.state.authorized)return;const t=(0,ud.Gd)(e.state.newEmail);e.setState({...e.state,loading:!0});const[i,n]=await Promise.all([await T.sendEmailVerification(this.environment,{email:e.state.newEmail}),t?await T.getVerifiedEmailDomain(this.environment,{emailDomain:t}):void 0]);if("success"===i.type){const t=(0,x.$K)(n)&&"failed"===n.type?(0,kn.wf)(this.props.intl,n):void 0;e.setState({...e.state,newEmailPasscodeSent:!0,newEmailPasscode:"",error:t,loading:!1,newEmailContainsVerifiedDomain:(0,x.$K)(n)&&"success"===n.type&&void 0!==n.data.id})}else e.setState({...e.state,loading:!1,error:(0,kn.wf)(this.props.intl,i)})},this.handleChangeNewEmailPasscode=e=>{const{store:t}=this.stores;t.setState({...t.state,newEmailPasscode:e.currentTarget.value,error:void 0})},this.handleSubmit=async()=>{const{store:e}=this.stores;if(!e.state.authorized)return;const t=e.state.authorizationType===ap.Password?{type:"Password",password:e.state.password,newEmail:e.state.newEmail,newEmailPasscode:e.state.newEmailPasscode}:{type:"CurrentEmail",currentEmailPasscode:e.state.currentEmailPasscode,newEmail:e.state.newEmail,newEmailPasscode:e.state.newEmailPasscode};e.setState({...e.state,loading:!0});const i=await T.changeEmail(this.environment,t);if("success"===i.type)b.txh(this.environment,{new_email:e.state.newEmail,error:void 0}),e.setState({...e.state,loading:!1}),await this.closeModal();else{var n;const t=(0,kn.wf)(this.props.intl,i);if(b.txh(this.environment,{new_email:e.state.newEmail,error:t}),"IntercomError"===(null===(n=i.body)||void 0===n?void 0:n.name))return e.setState({...e.state,loading:!1}),void(await this.closeModal());e.setState({...e.state,loading:!1,error:t})}},this.handleSendUsMessageClick=()=>{il.j({environment:this.environment,from:"change_email_student"})},this.openModal=()=>{const{store:e}=this.stores;e.setState({open:!0,authorized:!1,authorizationType:void 0})},this.closeModal=async()=>{const{store:e}=this.stores,{hasEducationPlan:t}=this.props;e.reset(),t&&await Z.bi(this.environment)},this.getAuthorizationType=async()=>{const{store:e}=this.stores,{intl:t}=this.props,i=this.getUserCurrentEmail();if(!i)return;const n=await np.c({environment:this.environment,userEmail:i});n.error?e.setState({open:e.state.open,authorized:!1,authorizationType:void 0,error:t.formatMessage({id:"profileSettings.changeEmailModal.errorFetchingAccountData",defaultMessage:"Could not fetch account information for {currentEmail}."},{currentEmail:i})}):n.value.isSamlEnforced||!n.value.hasPassword?e.setState({open:!0,authorized:!1,authorizationType:ap.CurrentEmail,currentEmailPasscodeSent:!1,currentEmailPasscode:""}):e.setState({open:!0,authorized:!1,authorizationType:ap.Password,password:""})},this.styles={modal:{width:460,padding:32,borderRadius:3,fontSize:14},loadingSpinner:{width:"100%",display:"flex",alignItems:"center",justifyContent:"center"},paragraph:{marginTop:12,marginBottom:14},error:{color:qn.ZP.red,fontSize:12,marginTop:4,marginLeft:8},bold:{fontWeight:f.Z.fontWeight.bold},input:{padding:"4px 8px"},button:{marginTop:14,width:"100%"},educationPlanWarning:{display:"flex",marginTop:14,paddingTop:14},claimedEmailDomainWarning:{marginTop:14,marginBottom:14}}}renderComponent(){const{userValue:e}=this.props,{store:t}=this.stores;return d.createElement(d.Fragment,null,a()(es.Z,{type:"custom",isMobile:!1,title:a()(v.FormattedMessage,{id:"profileSettings.accountSecuritySection.emailSetting.label",defaultMessage:"Email"}),caption:e&&e.email,customButton:this.renderChangeEmailButton()}),a()(us.Z,{ariaLabel:z.default.formatMessage(lp.dialogLabel),open:t.state.open,onDismiss:this.closeModal,render:this.renderModalContent}))}renderChangeEmailButton(){const{userValue:e,areProfileEditsDisabled:t}=this.props,i=a()(Re.Z,{isLarge:!0,onClick:t?()=>{}:this.openModal,disabled:t,disabledFeedback:t},void 0,a()(v.FormattedMessage,{id:"profileSettings.accountSecuritySection.emailSetting.changeEmailButton.label",defaultMessage:"Change email"}));return t?a()(We.Z,{renderTooltip:()=>a()(v.FormattedMessage,{id:"editableUserAvatar.profilePhoto.disabledByOrganization",defaultMessage:"Profile editing has been disabled by your organization, {emailDomain}",values:{emailDomain:e?(0,ud.Gd)(e.email):""}}),placement:We.Z.Placement.Bottom,alignment:We.Z.Alignment.Center,render:e=>d.createElement("div",e,i)}):i}renderVerifyPassword(e){const{userValue:t}=this.props;if(t)return a()(d.Fragment,{},void 0,a()("p",{style:{margin:0}},void 0,this.renderCurrentEmail()),a()("p",{style:this.styles.paragraph},void 0,a()(v.FormattedMessage,{id:"profileSettings.changeEmailModal.enterPasswordInstructions",defaultMessage:"Please enter your password."})),a()(Wi.Z,{style:{display:"none"},type:"text",value:t.email,autoComplete:"username",disabled:!0}),a()(Wi.Z,{type:"password",disabled:e.authorized,value:e.password,onChange:this.handleChangePassword,showClearButton:!0,onClearButtonClick:this.handleClearPassword,onSubmit:this.handleSubmitAuthorization,placeholder:this.props.intl.formatMessage({id:"profileSettings.changeEmailModal.passwordInput.label",defaultMessage:"Password"}),style:this.styles.input,focusInitial:!0,autoComplete:"current-password"}),!e.authorized&&e.error&&a()("div",{style:this.styles.error},void 0,e.error),!e.authorized&&a()($e.Z,{isLarge:!0,style:this.styles.button,onClick:this.handleSubmitAuthorization,disabled:e.loading},void 0,e.loading?a()(Ve.Z,{}):a()(v.FormattedMessage,{id:"profileSettings.changeEmailModal.continueButton.label",defaultMessage:"Continue"})))}renderVerifyCurrentEmail(e){return a()(d.Fragment,{},void 0,a()("p",{style:{...this.styles.paragraph,marginTop:0}},void 0,this.renderCurrentEmail()," ",e.currentEmailPasscodeSent?a()(v.FormattedMessage,{id:"profileSettings.changeEmailModal.sentVerificationCodeToCurrentEmail",defaultMessage:"We've sent a temporary verification code to this email."}):a()(v.FormattedMessage,{id:"profileSettings.changeEmailModal.sendVerificationCodeToCurrentEmail",defaultMessage:"We'll send a temporary verification code to this email."})),e.currentEmailPasscodeSent?this.renderCurrentEmailPasscodeInput(e):this.renderSendCurrentEmailPasscodeButton())}renderSendCurrentEmailPasscodeButton(){return a()($e.Z,{isLarge:!0,onClick:this.handleSendCurrentEmailVerification,disabled:this.stores.store.state.loading},void 0,this.stores.store.state.loading?a()(Ve.Z,{}):a()(v.FormattedMessage,{id:"profileSettings.changeEmailModal.sendCurrentEmailVerificationCode.label",defaultMessage:"Send verification code"}))}renderCurrentEmailPasscodeInput(e){return a()(d.Fragment,{},void 0,a()(Wi.Z,{value:e.currentEmailPasscode,onChange:this.handleChangeCurrentEmailPasscode,onSubmit:this.handleSubmitAuthorization,placeholder:this.props.intl.formatMessage({id:"profileSettings.changeEmailModal.enterCurrentEmailVerificationCodeInput.placeholder",defaultMessage:"Enter verification code"}),focusInitial:!0,style:this.styles.input}),!e.authorized&&a()($e.Z,{isLarge:!0,style:this.styles.button,onClick:this.handleSubmitAuthorization,disabled:e.loading},void 0,e.loading?a()(Ve.Z,{}):a()(v.FormattedMessage,{id:"profileSettings.changeEmailModal.continueButton.label",defaultMessage:"Continue"})))}renderNewEmailInput(){const{store:e}=this.stores;if(e.state.authorized)return a()(Wi.Z,{value:e.state.newEmail,onChange:this.handleChangeNewEmail,onSubmit:this.handleSendNewEmailVerification,showClearButton:!0,onClearButtonClick:this.handleClearNewEmail,placeholder:this.props.intl.formatMessage({id:"profileSettings.changeEmailModal.newEmailInput.placeholder",defaultMessage:"Enter new email"}),style:this.styles.input,focusInitial:!0})}renderSendNewEmailPasscodeButton(e){return a()(d.Fragment,{},void 0,e.error&&a()("div",{style:this.styles.error},void 0,e.error),a()($e.Z,{isLarge:!0,style:this.styles.button,onClick:this.handleSendNewEmailVerification,disabled:e.loading},void 0,e.loading?a()(Ve.Z,{}):a()(v.FormattedMessage,{id:"profileSettings.changeEmailModal.sendVerificationCodeButton.label",defaultMessage:"Send verification code"})))}renderNewEmailPasscodeInput(e){const t=this.getSubmitHandler();return a()(d.Fragment,{},void 0,a()("p",{style:this.styles.paragraph},void 0,a()(v.FormattedMessage,{id:"profileSettings.changeEmailModal.verificationCodeSentMessage",defaultMessage:"We just sent you a temporary verification code to {newEmail}.",values:{newEmail:a()("span",{style:this.styles.bold},void 0,e.newEmail)}})),a()(Wi.Z,{value:e.newEmailPasscode,onChange:this.handleChangeNewEmailPasscode,onSubmit:t,placeholder:this.props.intl.formatMessage({id:"profileSettings.changeEmailModal.enterVerificationCodeInput.placeholder",defaultMessage:"Enter verification code"}),focusInitial:!0,style:this.styles.input}),e.error&&a()("div",{style:this.styles.error},void 0,e.error),a()($e.Z,{isLarge:!0,style:this.styles.button,onClick:t,disabled:e.loading},void 0,e.loading?a()(Ve.Z,{}):a()(v.FormattedMessage,{id:"profileSettings.changeEmailModal.changeEmailButton.label",defaultMessage:"Change email"})))}renderEducationPlanDowngradeWarning(){const{hasEducationPlan:e}=this.props;if(e)return a()("div",{style:{...this.styles.educationPlanWarning,...this.getColors().educationPlanWarning}},void 0,m.Z.help({width:14,marginTop:4,marginRight:6,fill:this.theme.lightIconColor})," ",a()("div",{},void 0,a()(v.FormattedMessage,{defaultMessage:"Changing your email may downgrade your workspace on a Free Education Plan to the basic Free Plan. You won't lose any data, but you'll need to upgrade to re-access paid features. Have questions about this? <sendmessagelink>Message support</sendmessagelink>.",id:"emailChangeSettings.downgradeEducationPlan.warning.message",values:{sendmessagelink:e=>a()(Jo.Z,{onClick:this.handleSendUsMessageClick},void 0,e)}})))}renderCurrentEmail(){const{userValue:e}=this.props;if(e)return a()(v.FormattedMessage,{id:"profileSettings.changeEmailModal.currentEmail",defaultMessage:"Your current email is {currentEmail}.",values:{currentEmail:a()("span",{style:this.styles.bold},void 0,e&&e.email)}})}renderClaimedEmailDomainWarning(e){return a()(Ae.Z,{isSmall:!0,isMultiline:!0,style:this.styles.claimedEmailDomainWarning},void 0,a()(v.FormattedMessage,{id:"profileSettings.changeEmailModal.claimedEmailDomainWarning",defaultMessage:"The email domain {newEmailDomain} has been claimed by an organization. If you continue with changing this email address, any workspaces created by this account can be managed by the organization. See <domainclaimlink>this page</domainclaimlink> for more info.",values:{newEmailDomain:(0,ud.Gd)(e.newEmail)??e.newEmail,domainclaimlink:e=>a()(Jo.Z,{href:(0,H.UY)("guides.domainManagement"),external:!0},void 0,e)}}))}showConfirmationModal(e){return M.confirmUserAction({message:a()(v.FormattedMessage,{id:"profileSettings.changeEmailModal.confirmationModal.title",defaultMessage:"Are you sure you want to change your email?"}),description:a()(v.FormattedMessage,{id:"profileSettings.changeEmailModal.confirmationModal.description",defaultMessage:"If you continue changing this email address to this domain, any workspaces created by this account can be managed by the organization.",values:{verifiedDomain:(0,ud.Gd)(e)}}),acceptLabel:a()(v.FormattedMessage,{id:"profileSettings.changeEmailModal.confirmationModal.acceptButton.label",defaultMessage:"Change email"}),cancelLabel:a()(v.FormattedMessage,{id:"profileSettings.changeEmailModal.confirmationModal.cancelButton.label",defaultMessage:"Go back"})})}getUserCurrentEmail(){const{store:e}=this.stores,{userValue:t,intl:i}=this.props;if(t)return t.email;e.setState({open:e.state.open,authorized:!1,authorizationType:void 0,error:i.formatMessage({id:"profileSettings.changeEmailModal.errorNoUserValue",defaultMessage:"User value is undefined."})})}getSubmitHandler(){const{store:e}=this.stores,{userValue:t}=this.props;if(!e.state.authorized)return()=>{};if(e.state.newEmailContainsVerifiedDomain&&(0,ud.Gd)(e.state.newEmail)!==(0,ud.Gd)((null==t?void 0:t.email)||"")){const t=e.state.newEmail;return async()=>{await this.showConfirmationModal(t)&&await this.handleSubmit()}}return this.handleSubmit}getColors(){return{modal:{background:this.theme.contentBackground},educationPlanWarning:{color:this.theme.lightTextColor,borderTop:`1px solid ${this.theme.regularDividerColor}`}}}}dp.displayName="EmailChangeSettings";const cp=(0,v.injectIntl)(dp);class up extends B.default{getInitialState(){return{open:!1}}}const mp=new up;class pp extends c.Z{constructor(){super(...arguments),this.handleLogOutFromActiveSessions=async()=>{b.AQD(this.environment),await T.logoutActiveSessions(this.environment,{}),this.openConfirmationModal()}}renderComponent(){const e=a()(v.FormattedMessage,{id:"manageActiveSessions.title",defaultMessage:"Log out of all devices"}),t=a()(v.FormattedMessage,{id:"manageActiveSessions.logOutActiveSessions.label",defaultMessage:"Log out of all other active sessions on other devices besides this one."});return d.createElement(d.Fragment,null,a()(es.Z,{type:"custom",isMobile:!1,title:e,caption:t,customButton:a()(Ii.Z,{style:{borderRadius:"0.25em"},onClick:this.handleLogOutFromActiveSessions},void 0,m.Z.chevronRightRoundedThin(this.getIconStyle()))}),this.renderManageActiveSessionsModal())}renderManageActiveSessionsModal(){const{open:e}=mp.state,t=this.getUserEmailAddress();return a()(us.Z,{open:e,onDismiss:this.closeConfirmationModal,innerStyle:{width:350,padding:24,display:"flex",flexDirection:"column"},render:()=>d.createElement(d.Fragment,null,a()("div",{style:{marginBottom:24}},void 0,a()(v.FormattedMessage,t?{id:"manageActiveSessions.confirmationModal.withEmail",defaultMessage:"You have been logged out from other active sessions for {email}.",values:{email:t}}:{id:"manageActiveSessions.confirmationModal.withoutEmail",defaultMessage:"You have been logged out from other active sessions for your account."})),a()($e.Z,{onClick:this.closeConfirmationModal},void 0,a()(v.FormattedMessage,{id:"manageActiveSessions.confirmationModal.close",defaultMessage:"Close"})))})}openConfirmationModal(){mp.setState({...mp.state,open:!0})}closeConfirmationModal(){mp.setState({...mp.state,open:!1})}getUserEmailAddress(){let e;const{currentUserStore:t}=A.default.state;return t&&(e=t.getEmail()),e}getSettingTextStyle(){return{display:"flex",flexDirection:"column",alignItems:"flex-start",width:"100%",height:"auto"}}getSettingStyle(){return{display:"flex",flexDirection:"row",alignItems:"center"}}getIconStyle(){return{width:20,height:20,fill:this.theme.lightIconColor}}}pp.displayName="ManageActiveSessions";const gp=pp;var hp=i(1799),fp=i(16010);class vp extends B.default{getInitialState(){return{step:"backupCodesUninitialized"}}}class yp extends fp.o{constructor(e,t){super(e,"backupCodes"),this.service=void 0,this.service=t}backupCodesInitialSetup(e){if(!this.checkStep("backupCodesUninitialized"))return;const{onLoadingComplete:t,onComplete:i}=e;this.store.setState({step:"backupCodesLoading"}),this.doCreateBackupCodes({forceRecreate:!1,onComplete:i,onLoadingComplete:t}).catch(this.handleUnexpectedError)}backupCodesShowCreate(){this.checkStep("backupCodesUninitialized")&&this.store.setState({step:"backupCodesRegenerateCodes"})}backupCodesRegenerateCodes(){this.checkStep("backupCodesRegenerateCodes")&&(this.store.setState({step:"backupCodesRegenerateCodes",isLoading:!0}),this.doCreateBackupCodes({forceRecreate:!0,onComplete:()=>{},onLoadingComplete:()=>{}}).catch(this.handleUnexpectedError))}exit(){this.store.setState({step:"backupCodesUninitialized"})}async doCreateBackupCodes(e){const{forceRecreate:t,onComplete:i,onLoadingComplete:n}=e,a=await this.withStep(["backupCodesLoading","backupCodesRegenerateCodes"],(()=>this.service.createBackupCodes(t)));if(!a)return;const{result:o}=a;if("already-exists"===o.status)i();else{const e=function(e){const t=z.default.getIntl(),i=t.formatMessage({id:"mfa.backupCodes.downloadableTextFile.title",defaultMessage:"Notion Backup Codes"}),n=t.formatMessage({id:"mfa.backupCodes.downloadableTextFile.createdAt",defaultMessage:"Created at {createdAt}"},{createdAt:`${new Date}`}),a=t.formatMessage({id:"mfa.backupCodes.downloadableTextFile.warningMessage",defaultMessage:"Please store these in a secure location and mark off codes as they are used."}),o=`${i}\n${n}\n\n${e.map(hp.K).join("\n")}\n\n${a}\n`;return encodeURIComponent(o)}(o.backupCodes);this.store.setState({step:"backupCodesShowCodes",backupCodes:o.backupCodes,mfaSettingId:o.mfaSettingId,backupCodesFile:e}),n()}}}var Sp=i(75752),bp=i(88175);function Mp(e){let{errorMessage:t,isLoading:i,onDisplayBackupCodes:n,onCancel:o,onDismiss:s}=e;const r=a()(v.FormattedMessage,{id:"mfa.regenerateBackupCodes.title",defaultMessage:"Regenerate backup codes"}),l=a()(v.FormattedMessage,{id:"mfa.regenerateBackupCodes.message",defaultMessage:"Backup codes are used to log in if you lose access to your password and second factors. <boldtext>Your existing codes won't work after regenerating new ones.</boldtext>",values:{boldtext:e=>a()("span",{style:{fontWeight:f.Z.fontWeight.semibold}},void 0,e)}}),d={text:i?a()(Ve.Z,{}):a()(v.FormattedMessage,{id:"mfa.regenerateBackupCodes.regenerateBackupCodes.button.message",defaultMessage:"Generate new backup codes"}),onClick:n,view:"outline",disabled:i,isRed:!0},c=[{text:a()(v.FormattedMessage,{id:"mfa.regenerateBackupCodes.cancel.button.message",defaultMessage:"Cancel"}),onClick:o,view:"outline",type:"button"}];return a()(bp.Z,{title:r,header:l,errorMessage:t,primaryAction:d,secondaryActions:c,onDismiss:s})}var wp=i(457);function Cp(e){let{backupCodes:t,backupCodeDownload:i,backupCodeFileName:n,errorMessage:o,onNoted:s,onDownload:r}=e;const l=a()(v.FormattedMessage,{id:"mfa.showBackupCodes.title",defaultMessage:"Save your backup codes"}),c=d.createElement(d.Fragment,null,a()(v.FormattedMessage,{id:"mfa.showBackupCodes.message",defaultMessage:"<boldtext>You can only see this once</boldtext>, so be sure to keep them to avoid getting locked out of your account.",values:{boldtext:e=>a()("span",{style:{fontWeight:f.Z.fontWeight.semibold}},void 0,e)}})),u={text:a()(v.FormattedMessage,{id:"mfa.showBackupCodes.codesNotedDown.button.message",defaultMessage:"I've saved them"}),onClick:s},m=[{text:a()(v.FormattedMessage,{id:"mfa.showBackupCodes.downloadAsTextFile.button.message",defaultMessage:"Download as text file"}),href:`data:text/plain;charset=UTF-8,${i}`,saveAs:n,view:"outline",type:"link",onClick:r}];return a()(bp.Z,{title:l,header:c,errorMessage:o,primaryAction:u,secondaryActions:m},void 0,a()(wp.Z,{type:"unencryptedCodes",backupCodes:t}))}function _p(e){const{backupCodesStateMachine:t,onGoToSettings:i,onDismiss:n}=e,o=t.useCurrentStep(),s=()=>t.backupCodesRegenerateCodes();switch(o.step){case"backupCodesUninitialized":case"backupCodesLoading":return null;case"backupCodesRegenerateCodes":return a()(Mp,{isLoading:o.isLoading,errorMessage:o.error,onDisplayBackupCodes:s,onDismiss:n,onCancel:i});case"backupCodesShowCodes":return a()(Cp,{errorMessage:o.error,backupCodes:o.backupCodes,backupCodeDownload:o.backupCodesFile,backupCodeFileName:"Notion Backup Codes.txt",onNoted:i});default:return(0,x.t1)(o)}}var kp=i(99657);function Tp(e){let{type:t,errorMessage:i,onDismiss:n,onAddMethod:o}=e;window.__c={n:"MFAPromptSetupComplete"};const s=(0,xe.yK)(Ip,[]),r=a()(v.FormattedMessage,{id:"mfa.setupComplete.confirmation.header",defaultMessage:"Every time you enter your password, Notion will ask you for a verification code to confirm your identity."}),l=[{text:a()(v.FormattedMessage,{id:"mfa.setupComplete.confirmation.viewTwoStepMethods.button.message",defaultMessage:"View 2-step methods"}),onClick:o,type:"button",view:"outline"}];return a()(bp.Z,{title:"totp"===t?a()(v.FormattedMessage,{id:"mfa.totp.setupComplete.confirmation.title",defaultMessage:"2-step verification with authenticator is turned on"}):"sms"===t?a()(v.FormattedMessage,{id:"mfa.sms.setupComplete.confirmation.title",defaultMessage:"2-step verification with phone number is turned on"}):(0,x.t1)(t),header:r,errorMessage:i,icon:m.Z.circleCheck(s.confirmationIcon),secondaryActions:l,onDismiss:n})}function Ip(e){return(0,xe.EM)({confirmationIcon:{width:30,fill:"green"}})}i(30541);var Pp=i(4387),Zp=i(49682);const xp={name:"United States",countryCode:"1",regionCode:"US"},Fp=[{name:"China",countryCode:"86",regionCode:"CN"}];function Ap(e){let{isLoading:t,phoneNumber:i,country:n,errorMessage:o,onDismiss:r,onBack:c,onContinue:u}=e;window.__c={n:"MFAPromptSMSAddPhone"};const p=(0,xe.yK)(Ep,[]),g=(0,v.useIntl)(),[h,f]=(0,d.useState)(i??""),[y,S]=(0,d.useState)([]),[b,M]=(0,d.useState)(""),[w,C]=(0,d.useState)(n??xp),k=(0,Ze.qz)(void 0,Zt.Z),[T,I]=(0,d.useState)(void 0),P=(0,d.useMemo)((()=>(0,Pp.PG)(w.regionCode)),[w.regionCode]),Z=(0,d.useCallback)((e=>{const t=e.target.value.replace(/\D/g,"");f(P.reset(t))}),[P]);(0,d.useEffect)((()=>{f(n!==w?P.reset(h??""):P.reset(i??""));const e=new Intl.DisplayNames(["en"],{type:"region"}),t=(0,Pp.wJ)();let a=-1;const o=t.map(((t,i)=>{const n=(0,Pp.t7)(t).toString(),o=e.of(t);return t===w.regionCode&&(a=i),{name:o??t,countryCode:n,regionCode:t}}));-1!==a&&o.unshift(o.splice(a,1)[0]),S(o),Fp.some((e=>l().isEqual(e,w)))?I(Zp.Qj.smsUnsupportedPhoneNumber(w.name)):I(void 0)}),[w]);const x=a()(v.FormattedMessage,{id:"profileSettings.mfa.sms.addPhoneTitle",defaultMessage:"Add a phone number"}),F=a()(v.FormattedMessage,{id:"profileSettings.mfa.sms.addPhoneHeader",defaultMessage:"Enter your phone number to receive a 2-step verification code."}),A={text:t?a()(Ve.Z,{}):a()(v.FormattedMessage,{id:"profileSettings.mfa.sms.continueButton",defaultMessage:"Continue"}),onClick:()=>u(w,h.trim()),disabled:t||""===h||void 0!==T},E=[{text:a()(v.FormattedMessage,{id:"profileSettings.mfa.sms.addPhoneNeedHelp",defaultMessage:"Need help?"}),href:(0,H.UY)("guides.mfa"),isExternal:!0,type:"link",view:"plain"}],B=g.formatMessage({id:"profileSettings.mfa.sms.phoneNumberInput.placeholder",defaultMessage:"Enter phone number"}),D=g.formatMessage({defaultMessage:"Search country code",id:"profileSettings.mfa.sms.countryCodeSelect.placeholder"}),R=e=>a()("div",{style:p.countryCodeSelectTitle},void 0,e.name,a()(Ae.Z,{isSmall:!0},void 0,`+${e.countryCode}`)),L=a()(Et.ZP,{popupType:Et.Z4.Popup,placementToOrigin:oc.Iw.Bottom,alignmentToOrigin:oc.lU.Start,buttonPopupStore:k,renderOrigin:e=>d.createElement(Re.Z,e,`+${w.countryCode}`),render:e=>a()(rt.Z,{menuType:it.og.Popup,minWidth:280,maxHeight:"30vh",header:a()(ct.Z,{isInput:!0},void 0,a()(Mc.ZP,{value:b,onChange:e=>M(e.target.value),focus:!0,focusAfterAnimation:!0,placeholder:D}))},void 0,a()(lt.Z,{type:lt.i.Vertical,initialFocus:0,sections:[{key:"countries",render:e=>d.createElement(ct.Z,e),items:(0,sa.ZP)(b,y,(e=>/\d/.test(b)?`${e.countryCode}`:e.name)).map((t=>({key:t.regionCode,render:e=>d.createElement(ot.Z,s()({},e,{title:R(t),right:t.name===w.name?m.Z.thinCheck(p.selectedCountryCodeIcon):void 0})),action:()=>{M(""),C(t),e.close()}})))}]}))});return a()(bp.Z,{onDismiss:r,onBack:c,title:x,header:F,errorMessage:T||o,primaryAction:A,secondaryActions:E},void 0,a()("div",{style:p.container},void 0,a()("div",{style:p.countryCodeDropdownMenu},void 0,L),a()(Wi.Z,{autoFocus:!0,value:h,placeholder:B,spellCheck:!1,style:p.phoneNumberInput,onChange:Z,disabled:t||void 0!==T,customElementAttributes:_.pf})))}function Ep(e){return(0,xe.EM)({container:{width:"100%",display:"flex",flexDirection:"row",justifyContent:"space-between",marginTop:16,marginBottom:4},countryCodeDropdownMenu:{marginRight:5},selectedCountryCodeIcon:{width:15,height:15},countryCodeSelectTitle:{paddingTop:8,paddingBottom:8},phoneNumberInput:{background:"light"===e.mode?qn.ZP.transparent:e.inputBackground}})}var Bp=i(56839);function Dp(e){const{smsStateMachine:t,onGoToSettings:i,onDismiss:n,onStartBackupCodes:o}=e,s=t.useCurrentStep();switch(s.step){case"smsUninitialized":return null;case"smsSendingSMS":case"smsSetPhoneNumber":return a()(Ap,{phoneNumber:s.phoneNumber,country:s.country,isLoading:"smsSendingSMS"===s.step,errorMessage:s.error,onDismiss:n,onBack:i,onContinue:(e,i)=>t.smsCreateSMS(e,i)});case"smsVerifyCode":case"smsResendSMS":case"smsBackupCodesLoading":case"smsVerifying":return a()(Bp.ZP,{isLoading:"smsVerifying"===s.step||"smsBackupCodesLoading"===s.step,errorMessage:s.error,phoneNumber:`+${s.country.countryCode} ${s.phoneNumber}`,onDismiss:n,onBack:()=>t.smsRestart(),onVerifyCode:e=>t.smsVerifyCode({code:e,onVerified:o}),resentStatus:"smsResendSMS"===s.step?"resending":"resentAt"in s&&void 0!==s.resentAt?"resent":"not-resent",resentAt:"resentAt"in s&&s.resentAt?s.resentAt:0,onResendLink:()=>t.smsResendSMS()});case"smsVerified":return null;case"smsComplete":return a()(Tp,{type:"sms",errorMessage:s.error,onAddMethod:i,onDismiss:n});default:return(0,x.t1)(s)}}function Rp(e){window.__c={n:"MFAAuthenticatorNameInput"};const{placeholder:t,value:i,maxlength:n,style:o,onChange:s}=e,r=(0,xe.yK)((e=>(0,xe.EM)({input:{background:qn.ZP.transparent,color:e.darkTextColor,...o}})),[o]);return a()(Wi.Z,{value:i,placeholder:t,maxlength:n,style:r.input,inputStyle:f.Z.textOverflowStyle,autoFocus:!0,spellCheck:!1,onChange:s,autoComplete:"off",customElementAttributes:_.pf})}function Lp(e){let{isLoading:t,qrCode:i,friendlyName:n,errorMessage:o,onDismiss:s,onBack:r,onCantScanCode:l,onContinue:c}=e;window.__c={n:"MFAPromptTOTPScanQRCode"};const u=(0,xe.yK)(Np,[]),m=(0,v.useIntl)(),[p,g]=(0,d.useState)(n??""),h=(0,d.useCallback)((e=>{g(e.target.value)}),[g]),f=a()(v.FormattedMessage,{id:"profileSettings.mfa.totp.scanQRCodeTitle",defaultMessage:"Scan code in authenticator app"}),y=a()(v.FormattedMessage,{id:"profileSettings.mfa.totp.scanQRCodeHeader",defaultMessage:"Generate a verification code with an authenticator app, then enter a name to remember it by."}),S={text:a()(v.FormattedMessage,{id:"profileSettings.mfa.totp.continueButton",defaultMessage:"Continue"}),onClick:()=>c(p),disabled:!i||t||0===p.length},b=[{text:a()(v.FormattedMessage,{id:"profileSettings.mfa.totp.cantScanCodeButton",defaultMessage:"Can't scan code?"}),onClick:l,type:"button",view:"plain",disabled:t}],M=m.formatMessage({id:"profileSettings.mfa.totp.authenticatorNameInput.placeholder",defaultMessage:"Enter authenticator name"});return a()(bp.Z,{onDismiss:s,onBack:r,title:f,header:y,errorMessage:o,primaryAction:S,secondaryActions:b},void 0,a()("div",{style:u.body},void 0,a()("div",{style:u.qrCodeContainer},void 0,i?a()("img",{style:u.qrCode,src:i}):a()(Ve.Z,{})),a()(Rp,{placeholder:M,value:p,maxlength:30,onChange:h})))}function Np(e){return(0,xe.EM)({body:{width:"100%",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},qrCodeContainer:{display:"flex",justifyContent:"center",alignItems:"center",width:116,height:116,marginBottom:15},qrCode:{width:"100%"}})}function Op(e){let{textCode:t,friendlyName:i,errorMessage:n,isLoading:o,onDismiss:s,onBack:r,onUseQrCode:l,onContinue:c}=e;window.__c={n:"MFAPromptTOTPTypeTextCode"};const u=(0,xe.yK)(Vp,[]),[m,p]=(0,d.useState)(i??""),g=(0,v.useIntl)(),h=(0,d.useCallback)((e=>{p(e.target.value)}),[p]),f=a()(v.FormattedMessage,{id:"profileSettings.mfa.totp.typeTextCodeTitle",defaultMessage:"Type code from authenticator app"}),y=a()(v.FormattedMessage,{id:"profileSettings.mfa.totp.typeText.message",defaultMessage:"Input this setup key in your authenticator app, then enter a name to remember it by.",values:{authenticatorlink:e=>a()(Jo.Z,{external:!0,href:(0,H.UY)("guides.mfa")},void 0,e)}}),S={text:a()(v.FormattedMessage,{id:"profileSettings.mfa.totp.continueButton",defaultMessage:"Continue"}),onClick:()=>c(m),disabled:o||0===m.length},b=[{text:a()(v.FormattedMessage,{id:"profileSettings.mfa.totp.scanQRCodeButton",defaultMessage:"Scan QR code"}),onClick:l,type:"button",view:"plain",disabled:o}],M=g.formatMessage({id:"profileSettings.mfa.totp.authenticatorNameInput",defaultMessage:"Enter authenticator name"});return a()(bp.Z,{onDismiss:s,onBack:r,title:f,header:y,errorMessage:n,primaryAction:S,secondaryActions:b},void 0,a()("div",{style:u.body},void 0,a()("div",{style:u.content},void 0,a()("div",{style:u.textCode},void 0,t)),a()(Rp,{placeholder:M,value:m,maxlength:30,onChange:h})))}function Vp(e){return(0,xe.EM)({body:{width:"100%",display:"flex",flexDirection:"column",justifyContent:"center"},textCode:{fontWeight:f.Z.fontWeight.medium,fontSize:f.Z.fontSize.UIRegular.desktop,color:e.darkTextColor,textAlign:"center",verticalAlign:"middle"},content:{display:"flex",flexDirection:"column",justifyContent:"center",height:50,marginBottom:15}})}var Up=i(18469);function Wp(e){const{totpStateMachine:t,onGoToSettings:i,onStartBackupCodes:n,onDismiss:o}=e,r=t.useCurrentStep();switch(r.step){case"totpUninitialized":return null;case"totpLoadingQRCode":case"totpDisplayQRCode":const e="totpLoadingQRCode"===r.step?{isLoading:!0,qrCode:void 0}:{isLoading:r.isLoading,qrCode:r.qrCode};return d.createElement(Lp,s()({},e,{friendlyName:"totpDisplayQRCode"===r.step?r.friendlyName:void 0,errorMessage:r.error,onDismiss:o,onBack:i,onCantScanCode:()=>t.totpDisplayTextCode(),onContinue:e=>t.totpDisplayVerification(e)}));case"totpDisplayTextCode":return a()(Op,{textCode:r.rawString,friendlyName:r.friendlyName,errorMessage:r.error,isLoading:r.isLoading,onDismiss:o,onBack:i,onUseQrCode:()=>t.totpDisplayQRCode(),onContinue:e=>t.totpDisplayVerification(e)});case"totpVerifyCode":case"totpBackupCodesLoading":case"totpVerifying":return a()(Up.ZP,{isLoading:"totpVerifying"===r.step||"totpBackupCodesLoading"===r.step,errorMessage:r.error,onDismiss:o,onBack:()=>t.totpDisplayQRCode(),onVerifyCode:e=>t.totpVerifyCode({code:e,onVerified:n})});case"totpVerified":return null;case"totpComplete":return a()(Tp,{type:"totp",errorMessage:r.error,onDismiss:o,onAddMethod:i});default:return(0,x.t1)(r)}}function Kp(e){window.__c={n:"RootRouter"};const{rootStateMachine:t,settingsStateMachine:i,totpStateMachine:n,smsStateMachine:o,backupCodesStateMachine:r,onReloadSettings:l}=e,c=t.useCurrentStep(),[{showSettings:u,onRootExit:m}]=(0,d.useState)((()=>({onRootExit:()=>t.exit((()=>{i.exit(),n.exit(),o.exit(),r.exit(),l&&l()})),showSettings:()=>t.rootShowSettings({refresh:!0,startConfirmIdentity:()=>{i.settingsConfirmIdentityForSettings()}})}))),p=()=>t.rootCloseSettings((()=>{i.exit(),l&&l()})),g=()=>t.rootStartTOTP((()=>n.totpStart())),h=()=>t.rootStartSMS((()=>o.smsStart())),f=()=>{t.rootShowSettings({refresh:!0,startConfirmIdentity:()=>{n.exit(),i.settingsShow({refresh:!0})}})},v=()=>{t.rootShowSettings({refresh:!0,startConfirmIdentity:()=>{o.exit(),i.settingsShow({refresh:!0})}})},y=()=>{r.exit(),t.rootEndBackupCodes({completeTotp:()=>{n.totpComplete()},completeSMS:()=>{o.smsComplete()},showSettings:u})},S=()=>{r.backupCodesInitialSetup({onLoadingComplete:()=>{n.totpBackupCodesComplete(),t.rootShowBackupCodesFromTOTP()},onComplete:()=>{n.totpBackupCodesComplete(),n.totpComplete(),y()}})},b=()=>{r.backupCodesInitialSetup({onLoadingComplete:()=>{o.smsBackupCodesComplete(),t.rootShowBackupCodesFromSMS()},onComplete:()=>{o.smsBackupCodesComplete(),o.smsComplete(),y()}})},M=()=>{t.rootStartBackupCodesFromSettings((()=>r.backupCodesShowCreate()))},w=i.useCurrentStep(),C=n.useCurrentStep(),_=o.useCurrentStep(),k=r.useCurrentStep();let T;switch(c.step){case"rootUninitialized":break;case"rootSettings":T={open:"settingsUninitialized"!==w.step,onDismiss:m,render:()=>a()(kp.Z,{settingsStateMachine:i,onDismiss:p,onStartTOTP:g,onStartSMS:h,onStartBackupCodes:M})};break;case"rootTOTP":T={open:"totpUninitialized"!==C.step,onDismiss:m,render:()=>a()(Wp,{totpStateMachine:n,onGoToSettings:f,onStartBackupCodes:S,onDismiss:m})};break;case"rootSMS":T={open:"smsUninitialized"!==_.step,onDismiss:m,render:()=>a()(Dp,{smsStateMachine:o,onGoToSettings:v,onStartBackupCodes:b,onDismiss:m})};break;case"rootBackupCodes":T={open:"backupCodesUninitialized"!==k.step,onDismiss:"backupCodesRegenerateCodes"===k.step?m:void 0,render:()=>a()(_p,{backupCodesStateMachine:r,onGoToSettings:y,onDismiss:m})};break;default:throw(0,x.t1)(c)}return T?d.createElement(us.Z,s()({},T,{preventHideChildrenWhileOpening:!0})):null}class zp extends B.default{getInitialState(){return{step:"rootUninitialized"}}}class Gp extends fp.o{constructor(e){super(e,"root")}rootShowSettings(e){const{refresh:t,startConfirmIdentity:i}=e;if(this.checkStep("rootSettings")){if(!t)return}else this.store.setState({step:"rootSettings"});i()}rootStartBackupCodesFromSettings(e){this.checkStep("rootSettings")&&(this.store.setState({step:"rootBackupCodes",source:"settings"}),e())}rootStartTOTP(e){this.checkStep("rootSettings")&&(this.store.setState({step:"rootTOTP"}),e())}rootShowBackupCodesFromTOTP(){this.checkStep("rootTOTP")&&this.store.setState({step:"rootBackupCodes",source:"totp"})}rootStartSMS(e){this.checkStep("rootSettings")&&(this.store.setState({step:"rootSMS"}),e())}rootShowBackupCodesFromSMS(){this.checkStep("rootSMS")&&this.store.setState({step:"rootBackupCodes",source:"sms"})}rootEndBackupCodes(e){const t=this.checkStep("rootBackupCodes");if(t)switch(t.source){case"settings":return this.store.setState({step:"rootSettings"}),e.showSettings();case"sms":return this.store.setState({step:"rootSMS"}),e.completeSMS();case"totp":return this.store.setState({step:"rootTOTP"}),e.completeTotp();default:(0,x.t1)(t.source)}}rootCloseSettings(e){e(),this.store.setState({step:"rootUninitialized"})}exit(e){this.store.setState({step:"rootUninitialized"}),e()}}var qp=i(24173);class Hp extends B.default{getInitialState(){return{step:"smsUninitialized"}}}class jp extends fp.o{constructor(e,t){super(e,"sms"),this.service=void 0,this.service=t}smsStart(){this.checkStep("smsUninitialized")&&this.store.setState({step:"smsSetPhoneNumber"})}smsRestart(){const e=this.checkStep(["smsResendSMS","smsVerifyCode","smsVerifying"]);e&&this.store.setState({step:"smsSetPhoneNumber",country:e.country,phoneNumber:e.phoneNumber,error:void 0})}smsCreateSMS(e,t){this.checkStep("smsSetPhoneNumber")&&(this.store.setState({country:e,phoneNumber:t,step:"smsSendingSMS"}),this.doCreateSMS().catch(this.handleUnexpectedError))}smsResendSMS(){const e=this.checkStep(["smsVerifyCode","smsVerifying"]);e&&(this.store.setState({...e,step:"smsResendSMS",error:void 0}),this.doResendSMS().catch(this.handleUnexpectedError))}smsVerifyCode(e){const{code:t,onVerified:i}=e,n=this.checkStep("smsVerifyCode");n&&(this.store.setState({...n,step:"smsVerifying",error:void 0}),this.doVerifyCode({code:t,onVerified:i}).catch(this.handleUnexpectedError))}smsBackupCodesComplete(){this.checkStep("smsBackupCodesLoading")&&this.store.setState({step:"smsVerified"})}smsComplete(){this.checkStep("smsVerified")&&this.store.setState({step:"smsComplete"})}exit(){this.store.setState({step:"smsUninitialized"})}async doCreateSMS(){const e=await this.withStep("smsSendingSMS",(e=>this.service.createSMS(e.country.countryCode,e.phoneNumber)));if(!e)return;const{result:t,state:i}=e;switch(t.status){case"created":this.store.setState({...i,step:"smsVerifyCode",mfaSettingId:t.mfaSettingId,error:void 0});break;case"already_verified_phone_number":this.store.setState({step:"smsSetPhoneNumber",error:Zp.Qj.smsAlreadyVerifiedPhoneNumber});break;case"invalid_country_code":this.store.setState({step:"smsSetPhoneNumber",error:Zp.Qj.smsInvalidCountryCode});break;case"invalid_phone_number":this.store.setState({step:"smsSetPhoneNumber",error:Zp.Qj.smsInvalidPhoneCode});break;default:return(0,x.t1)(t)}}async doVerifyCode(e){const{code:t,onVerified:i}=e,n=await this.withStep("smsVerifying",(e=>this.service.verifySMS({mfaSettingId:e.mfaSettingId,code:t})));if(!n)return;const{result:a,state:o}=n;switch(a.status){case"match":this.store.setState({step:"smsBackupCodesLoading",country:o.country,phoneNumber:o.phoneNumber}),i();break;case"error":this.store.setState({...o,step:"smsVerifyCode",error:Zp.Qj.unexpectedError});break;case"incorrect":this.store.setState({...o,step:"smsVerifyCode",error:Zp.Qj.smsIncorrectCode});break;default:return(0,x.t1)(a.status)}}async doResendSMS(){const e=await this.withStep("smsResendSMS",(e=>this.service.sendSMS({mfaSettingId:e.mfaSettingId})));if(!e)return;const{result:t,state:i}=e;switch(t.status){case"ok":this.store.setState({...i,step:"smsVerifyCode",mfaSettingId:i.mfaSettingId,error:void 0,resentAt:Date.now()});break;case"error":this.store.setState({...i,step:"smsVerifyCode",mfaSettingId:i.mfaSettingId,error:Zp.Qj.unexpectedError});break;default:return(0,x.t1)(t.status)}}}class Qp extends B.default{getInitialState(){return{step:"totpUninitialized"}}}class Yp extends fp.o{constructor(e,t){super(e,"totp"),this.service=void 0,this.service=t}totpStart(){this.checkStep("totpUninitialized")&&(this.store.setState({step:"totpLoadingQRCode"}),this.doCreateTOTP().catch(this.handleUnexpectedError))}totpDisplayTextCode(){const e=this.getCurrentStep();switch(e.step){case"totpDisplayQRCode":case"totpVerifyCode":this.store.setState({...e,step:"totpDisplayTextCode",error:void 0,isLoading:!1})}}totpDisplayQRCode(){const e=this.getCurrentStep();switch(e.step){case"totpDisplayTextCode":case"totpVerifyCode":this.store.setState({...e,step:"totpDisplayQRCode",error:void 0,isLoading:!1})}}totpDisplayVerification(e){this.checkStep(["totpDisplayQRCode","totpDisplayTextCode"])&&this.doRenameTOTP(e).catch(this.handleUnexpectedError)}totpVerifyCode(e){const{code:t,onVerified:i}=e,n=this.checkStep("totpVerifyCode");n&&(this.store.setState({...n,step:"totpVerifying",error:void 0}),this.doVerifyCode({code:t,onVerified:i}).catch(this.handleUnexpectedError))}totpBackupCodesComplete(){this.checkStep("totpBackupCodesLoading")&&this.store.setState({step:"totpVerified"})}totpComplete(){this.checkStep("totpVerified")&&this.store.setState({step:"totpComplete"})}exit(){this.store.setState({step:"totpUninitialized"})}async doCreateTOTP(){const e=await this.withStep("totpLoadingQRCode",(()=>this.service.createTOTP()));if(!e)return;const{result:t}=e;this.store.setState({step:"totpDisplayQRCode",qrCode:t.qrCode,rawString:t.secret,mfaSettingId:t.mfaSettingId,isLoading:!1})}async doRenameTOTP(e){const t=await this.withStep(["totpDisplayQRCode","totpDisplayTextCode"],(t=>this.service.renameSettings({mfaSettingId:t.mfaSettingId,friendlyName:e})));if(!t)return;const{result:i,state:n}=t;switch(i.status){case"saved":this.store.setState({...n,step:"totpVerifyCode",friendlyName:e,error:void 0});break;case"duplicate":this.store.setState({...n,isLoading:!1,error:Zp.Qj.totpDuplicateFriendlyName});break;case"empty":this.store.setState({...n,isLoading:!1,error:Zp.Qj.totpEmptyFriendlyName});break;case"bad_friendly_name":this.store.setState({...n,isLoading:!1,error:Zp.Qj.totpBadFriendlyName});break;default:return(0,x.t1)(i)}}async doVerifyCode(e){const{code:t,onVerified:i}=e,n=await this.withStep("totpVerifying",(e=>this.service.verifyTOTP({mfaSettingId:e.mfaSettingId,code:t})));if(!n)return;const{result:a,state:o}=n;switch(a.status){case"match":this.store.setState({step:"totpBackupCodesLoading"}),i();break;case"error":this.store.setState({...o,step:"totpVerifyCode",error:Zp.Qj.unexpectedError});break;case"incorrect":this.store.setState({...o,step:"totpVerifyCode",error:Zp.Qj.totpIncorrectCode});break;default:return(0,x.t1)(a.status)}}}function $p(e){let{status:t,numMfaSettings:i,onReloadSettings:n,regenerateBackupCodes:o}=e;window.__c={n:"MFASettings"};const s=(0,Pe.O7)(),[{rootStateMachine:r,settingsStateMachine:l,totpStateMachine:c,smsStateMachine:u,backupCodesStateMachine:m}]=(0,d.useState)((()=>{const e=new Sp.r(s),t={totpStore:new Qp,settingsStore:new qp.c,smsStore:new Hp,backupCodesStore:new vp,rootStore:new zp};return{mfaService:e,rootStateMachine:new Gp(t.rootStore),settingsStateMachine:new qp.W(t.settingsStore,e),totpStateMachine:new Yp(t.totpStore,e),smsStateMachine:new jp(t.smsStore,e),backupCodesStateMachine:new yp(t.backupCodesStore,e)}})),p=s.device.isMobile,g=(0,xe.yK)((e=>({configureButton:{marginTop:p?12:0,marginBottom:p?4:0},regenerateBackupCodesBadge:{fontWeight:f.Z.fontWeight.medium,letterSpacing:0,fontSize:11,color:e.blueColor,background:"light"===e.mode?qn.ZP.diffBackground:"rgba(35, 131, 226, 0.2)",whiteSpace:"nowrap",width:"fit-content"}})),[p]),h=(0,Ze.VK)((()=>_e.Z.state.highlightedSetting===_e.R.TwoStepVerification),[]);return d.createElement(d.Fragment,null,a()(es.Z,{type:"toggleToButton",isMobile:!1,title:a()(v.FormattedMessage,{id:"profileSettings.accountSecuritySection.twoStepVerificationSetting.label",defaultMessage:"2-step verification"}),caption:a()(v.FormattedMessage,"on"===t?{id:"profileSettings.accountSecuritySection.twoStepVerificationSetting.settingConfigured.message",defaultMessage:"You have {numMfaSettings} verification methods turned on.",values:{numMfaSettings:i}}:{id:"profileSettings.accountSecuritySection.twoStepVerificationSetting.message",defaultMessage:"Add an additional layer of security to your account during login."}),isOn:"on"===t,buttonStyle:g.configureButton,buttonLabel:a()(v.FormattedMessage,{id:"profileSettings.accountSecuritySection.twoStepVerificationSettingButton.label",defaultMessage:"Change verification methods"}),onClick:()=>{!function(e){let{rootStateMachine:t,settingsStateMachine:i}=e;t.rootShowSettings({refresh:!1,startConfirmIdentity:()=>i.settingsConfirmIdentityForSettings()})}({rootStateMachine:r,settingsStateMachine:l})},tooltipLabel:a()(v.FormattedMessage,{id:"profileSettings.accountSecuritySection.twoStepVerificationSettingButton.tooltip",defaultMessage:"A password is required to enable 2-step verification"}),disableTooltip:"disabled"!==t,disabled:"disabled"===t,badge:o&&a()(ip.Z,{style:g.regenerateBackupCodesBadge,content:a()(v.FormattedMessage,{id:"profileSettings.accountSecuritySection.twoStepVerificationSetting.regenerateBackupCodes.badge",defaultMessage:"Regenerate backup codes"})}),shouldHighlight:h}),a()(Kp,{onReloadSettings:n,rootStateMachine:r,settingsStateMachine:l,totpStateMachine:c,smsStateMachine:u,backupCodesStateMachine:m}))}var Xp=i(1548),Jp=i(30045);class eg extends c.Z{constructor(){super(...arguments),this.storeTypes={isEducationStore:B.default.createClass(!1)},this.handleUploadProfilePhoto=()=>{b.Her(this.environment),mr.cR({environment:this.environment,onStart:this.handleUploadStart,bucket:"public",onError:this.handleUploadError,onComplete:this.handleUploadComplete,accept:"image/*"})},this.handleRemoveProfilePhoto=()=>{this.props.spaceProfileSettingsStore.setState({...this.props.spaceProfileSettingsStore.state,profilePhoto:void 0}),N.createAndCommit({userAction:"SpaceProfileSettings.handleRemoveProfilePhoto",environment:this.environment,perform:e=>{const{currentUserStore:t}=A.default.state;t&&S.A({userStore:t,data:{profilePhoto:null},transaction:e})}})},this.handleNameChange=e=>{const t=e.target.value;b.O$H(this.environment,{from:this.props.spaceProfileSettingsStore.state.name,to:t}),this.props.spaceProfileSettingsStore.setState({...this.props.spaceProfileSettingsStore.state,name:t}),N.createAndCommit({userAction:"SpaceProfileSettings.handleNameChange",environment:this.environment,perform:e=>{const{currentUserStore:i}=A.default.state;i&&S.A({userStore:i,data:{name:t},transaction:e})}})},this.handleUploadStart=()=>{this.props.spaceProfileSettingsStore.setState({...this.props.spaceProfileSettingsStore.state,uploadingProfilePhoto:!0})},this.handleUploadError=()=>{this.props.spaceProfileSettingsStore.setState({...this.props.spaceProfileSettingsStore.state,uploadingProfilePhoto:!1}),M.showErrorMessage(a()(v.FormattedMessage,{id:"profileSettings.profilePhotoSection.uploadProfilePhotoError.message",defaultMessage:"Upload failed."}))},this.handleUploadComplete=e=>{const t=e[0];this.props.spaceProfileSettingsStore.setState({...this.props.spaceProfileSettingsStore.state,profilePhoto:t,uploadingProfilePhoto:!1}),N.createAndCommit({userAction:"SpaceProfileSettings.handleUploadComplete",environment:this.environment,perform:e=>{const{currentUserStore:i}=A.default.state;i&&S.A({userStore:i,data:{profilePhoto:t},transaction:e})}})}}async willMount(e){super.willMount(e);const{isEducationStore:t}=this.stores,{spaceProfileSettingsStore:i}=this.props,{currentUserStore:n,currentUserSettingsStore:a,currentUserRootStore:o}=A.default.state;if(n&&a){const t=i.getValueForUser(n,a,e.intl);t&&i.setState({...i.state,...t})}if(o){const e=((0,j.xR)({environment:this.environment,userRootStore:o})||[]).some((e=>e===et.default.pricing.student.productId));t.setState(e)}await I(this.environment,i)}willUnmount(){_e.Z.state.highlightedSetting&&_e.Z.setState({..._e.Z.state,highlightedSetting:void 0}),super.willUnmount()}renderComponent(){return Fe.Z.state.online?this.renderSettings():this.renderOfflineMessage()}renderOfflineMessage(){return a()(Ee.Z,{},void 0,a()(Ae.Z,{isSmall:!0,style:{textAlign:"center"}},void 0,a()(v.FormattedMessage,{defaultMessage:"Please go online to manage your profile.",id:"profileSettings.offline.message"})))}renderSettings(){const{currentUserStore:e}=A.default.state;if(!e)return;const t=e.getValue();if(!t)return;const{name:i}=this.props.spaceProfileSettingsStore.state;return a()(Ee.Z,{},void 0,this.renderPersonalSettings({currentUserStore:e,currentUserValue:t,userName:i}))}renderPersonalSettings(e){var t;const{userName:i,currentUserStore:n,currentUserValue:o}=e,s=function(e,t){return e.isDefined()?e.getIsSuspended()?{type:"suspended"}:rr({profilePhoto:e.getProfilePhoto(),name:e.getFullName(t),email:e.getEmail()}):{type:"icon"}}(n,z.default.getIntl()),r=(0,ud.Gd)(o.email),l=Boolean(null===(t=this.props.spaceProfileSettingsStore.state.emailDomainSettings)||void 0===t||null===(t=t.settings)||void 0===t?void 0:t.prevent_profile_edits);return d.createElement(d.Fragment,null,this.renderMyProfileHeader({emailDomainForUser:r}),a()("div",{style:{display:"flex",flexDirection:"column"}},void 0,a()("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"}},void 0,a()(or,{size:60,avatarType:s,isOffline:!Fe.Z.state.online,onUploadProfilePhoto:this.handleUploadProfilePhoto,onRemoveProfilePhoto:this.handleRemoveProfilePhoto,disabled:l,disabledTooltipMessage:a()(v.FormattedMessage,{id:"editableUserAvatar.profilePhoto.disabledByOrganization",defaultMessage:"Profile editing has been disabled by your organization, {emailDomain}",values:{emailDomain:r}})}),a()("div",{style:{marginLeft:20,width:250}},void 0,a()(lr.Z,{},void 0,a()(v.FormattedMessage,{id:"profileSettings.personalInfoSection.nameInput.label",defaultMessage:"Preferred name"})),this.renderUserNameDisplay({userName:i,emailDomainForUser:r,areProfileEditsDisabled:l}))),"photo"!==s.type&&!l&&a()("div",{style:{color:this.theme.mediumIconColor,fontSize:14,marginTop:8}},void 0,a()(v.FormattedMessage,{id:"editableUserAvatar.profilePhoto.addPhoto",defaultMessage:"Add photo"}))),a()(Xo.Z,{size:48,isHidden:!0}),this.renderAccountSecuritySection({currentUserValue:o}),a()(Xo.Z,{size:48,isHidden:!0}),this.renderAccountSupportSection())}renderUserNameDisplay(e){const{userName:t,emailDomainForUser:i,areProfileEditsDisabled:n}=e;return n?a()(We.Z,{renderTooltip:()=>a()(v.FormattedMessage,{id:"editableUserAvatar.profilePhoto.disabledByOrganization",defaultMessage:"Profile editing has been disabled by your organization, {emailDomain}",values:{emailDomain:i}}),placement:We.Z.Placement.Bottom,alignment:We.Z.Alignment.Center,render:e=>d.createElement("div",s()({},e,{style:{opacity:.4}}),a()(Wi.Z,{disabled:!0,value:t}))}):a()(Wi.Z,{value:t,onChange:this.handleNameChange})}renderMyProfileHeader(e){var t;const{emailDomainForUser:i}=e,n=Boolean(null===(t=this.props.spaceProfileSettingsStore.state.emailDomainSettings)||void 0===t?void 0:t.isDomainVerified),o=k.default.checkGate("enable_managed_users_dashboard");return a()(Be.Z,{large:!0,divider:"full"},void 0,o&&n?a()("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-start",margin:"0 0 8px"}},void 0,a()(ip.Z,{style:{fontWeight:f.Z.fontWeight.medium,letterSpacing:0,whiteSpace:"nowrap",width:"fit-content",margin:0},content:a()(v.FormattedMessage,{id:"profileSettings.myProfile.managedByline",defaultMessage:"Your account is managed by {domain}",values:{domain:i}})}),a()(We.Z,{render:e=>d.createElement("div",e,m.Z.info({marginLeft:4,height:14,width:14,opacity:.5})),renderTooltip:()=>a()(v.FormattedMessage,{id:"profileSettings.myProfile.managedByTooltip",defaultMessage:"Contact your organization's administrator to change your profile information."})})):null,a()(v.FormattedMessage,{id:"profileSettings.myProfile.title",defaultMessage:"My profile"}))}renderAccountSecuritySection(e){var t;const{currentUserValue:i}=e,n=this.props.spaceProfileSettingsStore.state.accountSettings,o=Boolean(null===(t=this.props.spaceProfileSettingsStore.state.emailDomainSettings)||void 0===t||null===(t=t.settings)||void 0===t?void 0:t.prevent_profile_edits),s=()=>{I(this.environment,this.props.spaceProfileSettingsStore)};return d.createElement(d.Fragment,null,a()(Be.Z,{large:!0,divider:"full"},void 0,a()(v.FormattedMessage,{id:"profileSettings.accountSecurity.title",defaultMessage:"Account security"})),a()(cp,{userValue:i,hasEducationPlan:this.stores.isEducationStore.state,areProfileEditsDisabled:o}),a()(Xo.Z,{size:18,isHidden:!0}),a()(Xp.Z,{hasPassword:n.hasPassword,hasPasswordActions:n.canConfigurePassword,isEducationPlan:this.props.isEducationPlan,samlEnforced:n.isSamlEnforced,email:i.email,isError:Boolean(n.error),onReloadSettings:s,mfaStatus:n.mfaStatus}),a()(Xo.Z,{size:18,isHidden:!0}),a()($p,{status:n.mfaStatus,numMfaSettings:n.numMfaSettings,onReloadSettings:s,regenerateBackupCodes:n.regenerateBackupCodes}))}renderAccountSupportSection(){var e;const t=(null===(e=this.props.spaceProfileSettingsStore.state.emailDomainSettings)||void 0===e?void 0:e.settings)??{};return d.createElement(d.Fragment,null,a()(Be.Z,{large:!0,divider:"full"},void 0,a()(v.FormattedMessage,{id:"profileSettings.support.title",defaultMessage:"Support"})),a()(Jp.Z,{emailDomainSettings:t}),a()(Xo.Z,{size:18,isHidden:!0}),a()(gp,{}),a()(Xo.Z,{size:18,isHidden:!0}),a()(tp.Z,{userEmailDomainSettings:this.props.spaceProfileSettingsStore.state.emailDomainSettings}))}}eg.displayName="SpaceProfileSettings";const tg=(0,v.injectIntl)(eg);function ig(e){let{users:t,store:i,extraColumns:n,initialSort:o}=e;window.__c={n:"UserTableBox"};const[s,r]=(0,d.useState)(o),c=(0,v.useIntl)();function u(e,t){return a()(Ii.Z,{disabled:!t.sortable,ignoreLocalHoverState:!0,onClick:()=>{!function(e){r({column:e,asc:(null==s?void 0:s.column)===e&&!(null!=s&&s.asc)})}(e)},style:{display:"flex",alignItems:"center"}},void 0,t.title,t.sortable&&s&&s.column===e&&function(e){const{up:t}=e,i={width:10,height:10,marginLeft:4};return t?m.Z.arrowDownSmall({...i,transform:"rotate(180deg)"}):m.Z.arrowDownSmall(i)}({up:s.asc}))}const p=(0,d.useMemo)((()=>({title:a()(v.FormattedMessage,{id:"spacePermissionsSettings.userTable.userColumn.header",defaultMessage:"User"}),style:{width:"60%"},sortable:!0,renderer:e=>a()(Ma.Z,{actorStore:e}),getValue:e=>e.getDisplayName(c)})),[c]),g=(0,d.useMemo)((()=>({name:p,...n})),[n,p]),h=l().keys(g).map((e=>({key:e,header:u(e,g[e]),style:g[e].style}))),f=(0,Ze.VK)((()=>{const e=t.map((e=>He.U6.createChildStore(i,{table:Qt.KJ,id:e.userId}))).filter((e=>e.isDefined()));return s?e.sort(((e,t)=>{const i=g[s.column].getValue(e),n=g[s.column].getValue(t);var a=i<n?-1:i>n?1:0;return s.asc?a:-1*a})):e}),[t,i,g,s]);return a()(Dd.Z,{columns:h,rows:f.map((e=>{const t=Object.values(g).map((t=>t.renderer?t.renderer(e):d.createElement(d.Fragment,null,t.getValue(e))));return{key:e.id,columns:t}}))})}var ng=function(e){return e[e.UserUserSimilarity=0]="UserUserSimilarity",e}(ng||{});const ag={[ng.UserUserSimilarity]:a()(v.FormattedMessage,{id:"spaceSettingsDebugZone.userUserSimilarity.title",defaultMessage:"User Similarity"})};function og(){const e=(0,ms.mS)();return["on"===k.default.getGroup("user_similarity_debugging")||e?ng.UserUserSimilarity:void 0].filter(x.$K)}function sg(e){let{store:t}=e;window.__c={n:"DebugZoneUserUserSimilarityTab"};const{isOnline:i,subscriptionDataStoreData:n,userSimilarityData:o,visibleUsersLoaded:s,visibleUsers:r}=(0,Ze.VK)((()=>{var e,i;const n=null===(e=ke.default.state)||void 0===e?void 0:e.data,a=n?j.CM(n):[],o=l().every(a.map((e=>He.U6.createChildStore(t,{table:Qt.KJ,id:e.userId}).isReady())));return{isOnline:Fe.Z.state.online,subscriptionDataStoreData:n,userSimilarityData:(null===(i=ke.default.state.data)||void 0===i?void 0:i.userSimilarity)||{},visibleUsersLoaded:o,visibleUsers:a}}),[t]);if(!i)return a()(Ae.Z,{isSmall:!0,style:{textAlign:"center"}},void 0,a()(v.FormattedMessage,{id:"spacePermissionsSettings.offlineMessage",defaultMessage:"Please go online to manage members."}));if(!n)return a()(Ve.Z,{style:{margin:"calc(50% - 1em) auto"}});if(!s)return a()(Ve.Z,{style:{margin:"calc(50% - 1em) auto"}});const c={style:{},title:d.createElement(d.Fragment,null,"Similarity Score"),sortable:!0,renderer:e=>{var t;return d.createElement(d.Fragment,null,(null===(t=o[e.id])||void 0===t?void 0:t.toFixed(3))||0)},getValue:e=>o[e.id]||0};return a()(ig,{users:r,store:t,extraColumns:{similarityColumn:c},initialSort:{column:"similarityColumn",asc:!1}})}function rg(e){let{store:t}=e;window.__c={n:"SpaceSettingsDebugZone"};const{tabs:i}=(0,Ze.VK)((()=>({tabs:og()})),[]),[n,o]=(0,d.useState)(i[0]);return a()(Ee.Z,{},void 0,a()(ts.Z,{tabs:i.map((e=>ag[e])),selectedIndex:i.indexOf(n),onChange:e=>o(i[e]),style:{paddingLeft:0,paddingRight:0,marginTop:-6,marginBottom:14},tabTitleStyle:{fontSize:16}}),n===ng.UserUserSimilarity&&a()(sg,{store:t}))}const lg=(0,v.defineMessages)({accountTab:{id:"spaceSettingsSidebar.accountTab.title",defaultMessage:"My account"},settingsTab:{id:"spaceSettingsSidebar.settingsTab.title",defaultMessage:"Settings"},teamsTab:{id:"spaceSettingsSidebar.teamsTab.title",defaultMessage:"Teamspaces"},peopleTab:{id:"spaceSettingsSidebar.peopleTab.title",defaultMessage:"People"},membersTab:{id:"spaceSettingsSidebar.membersTab.title",defaultMessage:"Members"},plansTab:{id:"spaceSettingsSidebar.plansTab.title",defaultMessage:"Plans"},upgradeTab:{id:"spaceSettingsSidebar.upgradeTab.title",defaultMessage:"Upgrade"},billingTab:{id:"spaceSettingsSidebar.billingTab.title",defaultMessage:"Billing"},subscriptionTab:{id:"spaceSettingsSidebar.subscriptionTab.title",defaultMessage:"Subscription"},connectedAppsTab:{id:"spaceSettingsSidebar.connectedAppsTab.title",defaultMessage:"My connected apps"},userConnectionsTab:{id:"spaceSettingsSidebar.userConnectionsTab.title",defaultMessage:"My connections"},securitySAMLTab:{id:"spaceSettingsSidebar.securityAndSAMLTab.title",defaultMessage:"Security & identity"},securityTab:{id:"spaceSettingsSidebar.securityTab.title",defaultMessage:"Security"},identityProvisioningTab:{id:"spaceSettingsSidebar.identity&ProvisioningTab.title",defaultMessage:"Identity & provisioning"},adminContentSearchTab:{id:"spaceSettingsSidebar.adminContentSearch.title",defaultMessage:"Content search"},languageAndRegionTab:{id:"spaceSettingsSidebar.languageAndRegionTab.title",defaultMessage:"Language & region"},integrationsTab:{id:"spaceSettingsSidebar.integrationsTab.title",defaultMessage:"Integrations"},spaceConnectionsTab:{id:"spaceSettingsSidebar.spaceConnectionsTab.title",defaultMessage:"Connections"},experimentsTab:{id:"spaceSettingsSidebar.experimentsTab.title",defaultMessage:"Experiments"},auditLogTab:{id:"spaceSettingsSidebar.auditLogTab.title",defaultMessage:"Audit log"},notificationsAndSettings:{id:"spaceSettingsSidebar.notificationsAndSettings.title",defaultMessage:"My notifications & settings"},mySettings:{id:"spaceSettingsSidebar.mySettings.title",defaultMessage:"My settings"},myNotifications:{id:"spaceSettingsSidebar.myNotifications.title",defaultMessage:"My notifications"},debugZoneTab:{id:"spaceSettingsSidebar.debugZoneTab.title",defaultMessage:"Debug Zone"},analyticsTab:{id:"spaceSettingsSidebar.analyticsTab.title",defaultMessage:"Analytics"},importTab:{id:"spaceSettingsSidebar.importsTab.title",defaultMessage:"Import"}}),dg={width:20,height:20},cg={profile:e=>m.Z.typesCreatedBy(dg),notifications_and_settings:()=>m.Z.settingsNotificationsAndPersonal(dg),user_settings:()=>m.Z.settingsNotificationsAndPersonal(dg),notifications:()=>m.Z.settingsNotifications(dg),connected_apps:()=>m.Z.settingsConnectedApps(dg),language_and_region:()=>m.Z.settingsLanguage(dg),settings:()=>m.Z.settings(dg),teams:()=>m.Z.settingsWorkspace(dg),members:()=>m.Z.settingsMembers(dg),plans:()=>{const{data:e}=ke.default.state;return e&&j.YK(e)?m.Z.settingsPlans(dg):m.Z.settingsUpgrade(dg)},billing:()=>m.Z.settingsBilling(dg),subscription:()=>m.Z.settingsSubscription(dg),security:()=>m.Z.settingsSecurity(dg),identity_provisioning:()=>m.Z.settingsIdentityProvisioning(dg),admin_content_search:()=>m.Z.contentSearch(dg),integrations:()=>m.Z.settingsIntegration(dg),experiments:()=>m.Z.sparkles(dg),audit_log:()=>m.Z.ledger(dg),debug_zone:()=>m.Z.templates(dg),analytics:()=>m.Z.magnifyingGlass(dg),imports:()=>m.Z.import(dg)},ug={profile:()=>`${z.default.formatMessage(lg.accountTab)}`,notifications_and_settings:()=>z.default.formatMessage(lg.notificationsAndSettings),user_settings:()=>z.default.formatMessage(lg.mySettings),notifications:()=>z.default.formatMessage(lg.myNotifications),connected_apps:()=>z.default.formatMessage(lg.userConnectionsTab),language_and_region:()=>z.default.formatMessage(lg.languageAndRegionTab),settings:()=>z.default.formatMessage(lg.settingsTab),teams:()=>z.default.formatMessage(lg.teamsTab),members:()=>(0,K.F$)()?z.default.formatMessage(lg.peopleTab):z.default.formatMessage(lg.membersTab),plans:()=>{const{data:e}=ke.default.state;return e&&j.YK(e)?z.default.formatMessage(lg.plansTab):z.default.formatMessage(lg.upgradeTab)},billing:()=>z.default.formatMessage(lg.billingTab),subscription:()=>z.default.formatMessage(lg.subscriptionTab),security:()=>z.default.formatMessage(lg.securityTab),identity_provisioning:()=>z.default.formatMessage(lg.identityProvisioningTab),admin_content_search:()=>z.default.formatMessage(lg.adminContentSearchTab),integrations:()=>z.default.formatMessage(lg.spaceConnectionsTab),experiments:()=>z.default.formatMessage(lg.experimentsTab),audit_log:()=>z.default.formatMessage(lg.auditLogTab),debug_zone:()=>z.default.formatMessage(lg.debugZoneTab),analytics:()=>z.default.formatMessage(lg.analyticsTab),imports:()=>z.default.formatMessage(lg.importTab)},mg={profile:()=>null,notifications_and_settings:()=>null,user_settings:()=>null,notifications:()=>null,connected_apps:()=>null,language_and_region:()=>null,settings:()=>null,teams:()=>null,members:()=>null,plans:()=>null,billing:()=>null,subscription:()=>null,security:()=>null,identity_provisioning:()=>null,admin_content_search:()=>null,integrations:()=>null,experiments:()=>null,audit_log:()=>null,debug_zone:()=>null,analytics:()=>null,imports:()=>null};var pg=i(94919);const gg={workspaceBalance:a()(v.FormattedMessage,{id:"spaceSubscriptionBilling.subscriptionSettingsSection.workspaceSubscriptionBalance.title",defaultMessage:"Workspace balance"}),applyCoupon:a()(v.FormattedMessage,{id:"spaceSubscriptionBilling.subscriptionSettingsSection.applyCoupon.title",defaultMessage:"Apply coupon"}),discount:a()(v.FormattedMessage,{id:"spaceSubscriptionBilling.subscriptionSettingsSection.discount.title",defaultMessage:"Discount"})};var hg=i(34859);class fg extends B.default{getInitialState(){return{paymentMethodModalOpen:!1,billingIntervalModalOpen:!1,billingEmailModalOpen:!1,vatIdModalOpen:!1,addressModalOpen:!1,billingEventsLimit:20,applyCouponModalOpen:!1,addressErrorMessage:void 0}}setAddressField(e){const t=this.state.temporaryAddress?this.state.temporaryAddress:{name:"",businessName:"",addressLine1:"",addressLine2:"",zipCode:"",city:"",state:"",country:""};this.setState({...this.state,temporaryAddress:{...t,...e},addressErrorMessage:void 0})}}const vg=fg;var yg=i(18647);const Sg=(0,v.defineMessages)({apply_credit:{id:"spaceSubscriptionBilling.applyCreditButton.label",defaultMessage:"Apply credit"},update:{id:"spaceSubscriptionBilling.updateButton.label",defaultMessage:"Update"},add:{id:"spaceSubscriptionBilling.addButton.label",defaultMessage:"Add"},apply:{id:"spaceSubscriptionBilling.apply.label",defaultMessage:"Apply"}});class bg extends c.Z{renderComponent(){const{title:e,caption:t,buttonArgs:i}=this.props,n=d.createElement(v.FormattedMessage,Sg[i.buttonPurpose]);return a()("div",{style:{display:"flex",alignItems:"center",fontSize:14}},void 0,a()("div",{style:{marginRight:"auto"}},void 0,e),a()("div",{style:{color:this.theme.mediumTextColor}},void 0,t),a()("div",{style:{minWidth:110,display:"flex",justifyContent:"flex-end"}},void 0,i.showButton&&a()(Xe.Z,{isBlue:!0,onClick:i.onClick,style:bg.buttonStyle},void 0,n)))}}bg.displayName="SubscriptionBillingSettingOption",bg.buttonStyle={marginLeft:18,marginRight:-4,fontWeight:f.Z.fontWeight.medium};const Mg=(0,v.injectIntl)(bg);function wg(e){window.__c={n:"BillingRow"};const{mainLabel:t,valueLabel:i,metadataLabel:n,button:o}=e,s=(0,xe.yK)((e=>({row:{display:"flex",alignItems:"center",gap:40,padding:"11px 0",borderBottom:`1px solid ${e.regularDividerColor}`},labelArea:{flex:1,display:"flex",flexDirection:"column",gap:6},mainLabel:{fontWeight:400,fontSize:14,lineHeight:"17px",letterSpacing:"-0.154px"},valueLabel:{fontWeight:400,fontSize:12,lineHeight:"14px",color:e.mediumTextColor},metadataLabel:{fontSize:12,lineHeight:"14px",textAlign:"right",color:e.mediumTextColor},buttonArea:{},button:{minWidth:144}})),[]);return a()("div",{style:s.row},void 0,a()("div",{style:s.labelArea},void 0,a()("div",{style:s.mainLabel},void 0,t),a()("div",{style:s.valueLabel},void 0,i)),n?a()("div",{style:s.metadataLabel},void 0,n):null,o?a()("div",{style:s.buttonArea},void 0,a()(Re.Z,{isLarge:!0,onClick:o.onClick,style:s.button},void 0,o.label)):null)}function Cg(e){var t;window.__c={n:"BillingHistory"};const{spaceStore:i,upcomingInvoiceData:n}=e,o=(0,Pe.O7)(),s=(0,xe.yK)((e=>({emptyList:{color:e.mediumTextColor,fontSize:14},header:{marginBottom:4}})),[]),[{status:r,value:l}]=(0,fs.r5)((async()=>await T.getBillingHistory(o,{spaceId:i.id,limit:50})),[o,i]);if("resolved"!==r||!l||"failed"===l.type||null===(t=l.data)||void 0===t||!t.events)return null;const d=i.id,c=l.data.events??[],u=n?`/invoice/upcoming?spaceId=${d}`:void 0,m=0===c.length&&!u;return a()("div",{style:{marginTop:40}},void 0,a()(Be.Z,{large:!0,divider:"full",style:s.header},void 0,a()(v.FormattedMessage,{id:"spaceSubscriptionBillingV2.invoices",defaultMessage:"Invoices"})),m?a()("div",{style:s.emptyList},void 0,a()(v.FormattedMessage,{id:"spaceSubscriptionBilling.invoicesSection.noInvoicesMessage",defaultMessage:"This workspace has no payments yet."})):null,u?a()(wg,{mainLabel:a()(v.FormattedMessage,{id:"spaceSubscriptionBillingV2.upcomingInvoice",defaultMessage:"Upcoming invoice"}),button:{label:a()(v.FormattedMessage,{id:"spaceSubscriptionBillingV2.viewInvoice",defaultMessage:"View invoice"}),onClick:()=>{window.open(u,"_blank")}}}):null,c.map((e=>{const t=(0,Hn.Yx)(e.timestamp,"long",_a.SP);let i;i="paid"===e.status?e.total<0?a()(v.FormattedMessage,{id:"spaceSubscriptionBilling.invoicesSection.invoiceStatus.credited",defaultMessage:"Credited"}):a()(v.FormattedMessage,{id:"spaceSubscriptionBilling.invoicesSection.invoiceStatus.paid",defaultMessage:"Paid"}):e.attempted?a()(v.FormattedMessage,{id:"spaceSubscriptionBilling.invoicesSection.invoiceStatus.failed",defaultMessage:"Failed"}):a()(v.FormattedMessage,{id:"spaceSubscriptionBilling.invoicesSection.invoiceStatus.due",defaultMessage:"Due"});const n=a()(pg.W,{cost:{amount:e.total,currencyCode:e.currencyCode},trailingZeroDisplay:"stripIfInteger"});return a()(wg,{mainLabel:t,valueLabel:a()(v.FormattedMessage,{id:"spaceSubscriptionBillingV2.invoiceSummary",defaultMessage:"{invoiceStatus} · {formattedAmount}",values:{invoiceStatus:i,formattedAmount:n}}),button:{label:a()(v.FormattedMessage,{id:"spaceSubscriptionBillingV2.viewInvoice",defaultMessage:"View invoice"}),onClick:()=>{const t=`/invoice/${e.id}`;window.open(t,"_blank")}}},e.id)})))}var _g=i(19234),kg=i(6906);var Tg=i(99498),Ig=i(89859),Pg=i(17153),Zg=i(94191),xg=i(90850);class Fg extends B.default{getInitialState(){return{temporaryCouponCode:void 0,couponCodeInput:void 0,error:void 0}}}const Ag=Fg,Eg=(0,v.defineMessages)({couponCodePlaceholder:{id:"couponEntryInput.placeholder",defaultMessage:"Coupon code"},couponCodeNotFoundError:{id:"couponEntryInput.error.noPromo",defaultMessage:"Invalid coupon code"}});class Bg extends c.Z{constructor(){super(...arguments),this.storeTypes={couponCode:Ag}}didMount(){const e=(0,xg.Zk)(this.environment.currentUser.id);e&&this.stores.couponCode.setState({...this.stores.couponCode.state,temporaryCouponCode:e})}renderComponent(){return a()("div",{style:this.getContainerStyle()},void 0,a()("div",{style:{display:"flex",flexDirection:"row"}},void 0,a()(Wi.Z,{textarea:!1,value:this.stores.couponCode.state.couponCodeInput,placeholder:z.default.formatMessage(Eg.couponCodePlaceholder),onSubmit:()=>this.checkCouponCode(),onChange:e=>{this.stores.couponCode.setState({...this.stores.couponCode.state,couponCodeInput:e.target.value})},style:{height:32,paddingLeft:10,marginRight:this.props.hideApply?0:10}}),a()(Vo.Z,{request:this.stores.couponCode.state.temporaryCouponCode||null,performRequest:async e=>{if(e)return this.applyCouponCode(e)},render:(e,t,i)=>{if(!this.props.hideApply)return a()(Re.Z,{isLarge:!1,onClick:()=>this.checkCouponCode()},void 0,a()(ss.Z,{loaded:i,spinnerSize:16,showSpinnerTimeout:500},void 0,a()(v.FormattedMessage,{id:"couponEntryInput.button.apply",defaultMessage:"Apply"})))}})),this.stores.couponCode.state.error&&a()(Ae.Z,{isMultiline:!1,style:{paddingTop:8,color:qn.ZP.red}},void 0,this.stores.couponCode.state.error))}checkCouponCode(){const e=this.stores.couponCode.state.couponCodeInput;e&&(this.stores.couponCode.setState({...this.stores.couponCode.state,temporaryCouponCode:e}),this.stores.couponCode.setState({...this.stores.couponCode.state,couponCodeInput:""}))}async applyCouponCode(e){const t=await T.getPromoCode(this.environment,{code:e});if("success"===t.type){var i;if(t.data.promo)return null!==(i=t.data.promo.applies_to)&&void 0!==i&&i.length&&!t.data.promo.applies_to.includes(this.props.plan)?void this.showError(e):(this.stores.couponCode.setState({...this.stores.couponCode.state,error:void 0}),this.props.handlePromo(t.data.promo),b.p8V(this.environment,{code:e,valid:!0,id:t.data.promo.id}),t.data.promo);this.showError(e)}else if("failed"===t.type){const e=t.error.name;this.stores.couponCode.setState({...this.stores.couponCode.state,error:e})}else(0,x.t1)(t)}showError(e){this.stores.couponCode.setState({...this.stores.couponCode.state,error:z.default.formatMessage(Eg.couponCodeNotFoundError)}),b.p8V(this.environment,{code:e,valid:!1,id:void 0})}getContainerStyle(){return{display:"flex",flexDirection:"column",...this.props.style?this.props.style:void 0}}}Bg.displayName="CouponEntryInput";const Dg=Bg;var Rg=i(86664),Lg=i(16100),Ng=i(38479),Og=i(94699);function Vg(e){window.__c={n:"AddressModal"};const{addressErrorMessage:t,customerData:i,getUpdatedAddress:n,handleAddressAccept:o,handleModalClose:s,temporaryAddress:r,updateAddress:l}=e,d=(0,Ng.y)(),{updatedAddress:c,shouldShowBusinessName:u}=(0,Ze.VK)((()=>({updatedAddress:n(),shouldShowBusinessName:(0,Q.mq)()})),[n]),m=(0,xe.yK)((e=>({modal:{display:"flex",flexDirection:"column",maxHeight:"75vh"},modalBody:{width:500,background:e.popoverBackground,padding:24,borderRadius:3},footer:{display:"flex",justifyContent:"flex-end",padding:"16px 24px",background:e.cardContentBackground},modalTitle:{fontSize:18,marginBottom:16,fontWeight:f.Z.fontWeight.medium}})),[]),p=(0,Lg.useElementsOptions)({type:"address"});return a()(Rg.Elements,{stripe:(0,Lg.getStripe)(),options:p},void 0,a()("div",{style:m.modal},void 0,a()("div",{style:m.modalBody},void 0,a()("div",{style:m.modalTitle},void 0,a()(v.FormattedMessage,{id:"spaceSubscriptionBillingV2.changeYourAddressModal.title",defaultMessage:"Change your address"})),a()(Og.J,{address:r||{name:i.customerName||"",businessName:"",addressLine1:"",addressLine2:"",zipCode:"",city:"",state:"",country:""},availableCountries:d,updateAddress:l,shouldShowBusinessName:u}),a()("div",{style:{color:qn.ZP.red,marginTop:10}},void 0,t)),a()("div",{style:m.footer},void 0,a()(Re.Z,{isLarge:!0,onClick:s},void 0,a()(v.FormattedMessage,{id:"spaceSubscriptionBillingV2.changeBillingAddressModal.cancelButton.label",defaultMessage:"Cancel"})),a()($e.Z,{style:{marginLeft:12},isLarge:!0,disabled:void 0===c,onClick:o},void 0,a()(v.FormattedMessage,{id:"spaceSubscriptionBillingV2.changeBillingAddressModal.updateButton.label",defaultMessage:"Update"})))))}function Ug(e){window.__c={n:"LegacyBillingModal"};const t=(0,xe.yK)((e=>({wrapper:{width:500,background:e.popoverBackground,padding:24,borderRadius:3},modalTitle:{fontSize:18,marginBottom:16,fontWeight:f.Z.fontWeight.medium}})),[]),i=d.createElement(v.FormattedMessage,Sg[e.acceptAction]);return a()("div",{style:t.wrapper},void 0,a()("div",{style:t.modalTitle},void 0,e.title),e.children,a()("div",{style:{marginBottom:20}},void 0,e.helpButton),a()("div",{style:{display:"flex",justifyContent:"flex-end"}},void 0,a()(Re.Z,{isLarge:!0,onClick:e.onClose,style:{marginRight:12}},void 0,a()(v.FormattedMessage,{id:"spaceSubscriptionBillingV2.cancelButton.label",defaultMessage:"Cancel"})),a()($e.Z,{isLarge:!0,onClick:e.onAccept},void 0,i)))}function Wg(){return(0,xe.yK)((e=>({button:{width:"100%",height:40,marginTop:24},cancellationButton:{marginRight:12,border:void 0},section:{display:"flex",alignItems:"center",fontSize:14,paddingTop:16,paddingBottom:16,background:"var(--core-gray-50, #F7F7F5)",borderRadius:4,margin:"12px 0",borderWidth:.5,borderStyle:"solid",borderColor:"#E3E2E0"},textSection:{marginRight:"auto",paddingRight:32},allChanges:{color:e.mediumTextColor,fontSize:12,paddingLeft:8,paddingRight:8}})),[])}function Kg(){return a()(v.FormattedMessage,{id:"spaceSubscriptionBilling.scheduledChanges.cancel.label",defaultMessage:"<bold>Cancel changes</bold>",values:{bold:e=>a()("b",{},void 0,e)}})}function zg(e){window.__c={n:"AllChangesText"};const t=Wg(),i=(0,v.useIntl)().formatList(e.scheduledChanges.filter(Boolean),{type:"conjunction",style:"narrow"});return a()("div",{style:t.allChanges},void 0,i)}function Gg(e){window.__c={n:"PendingChangesText"};const{periodEndDate:t,scheduledChanges:i}=e,n=(0,Hn.Yx)(t,"medium",_a.SP),o=(0,xe.yK)((e=>({leftSection:{display:"flex",paddingLeft:12},title:{fontWeight:f.Z.fontWeight.medium,paddingLeft:8,paddingRight:8},icon:{width:14,height:14,marginTop:4}})),[]);return a()("div",{style:o.leftSection},void 0,m.Z.alarmClock(o.icon),a()("div",{},void 0,a()("div",{style:o.title},void 0,a()(v.FormattedMessage,{id:"spaceSubscriptionBilling.scheduledChanges.pendingChanges.title",defaultMessage:"Pending changes scheduled for {date}",values:{date:n}})),a()(zg,{scheduledChanges:i})))}function qg(e){window.__c={n:"CancelPendingCancellationChanges"};const{customerData:t}=e,i=Wg(),n=(0,Pe.O7)();return a()(Re.Z,{isLarge:!0,onClick:()=>Pg.LZ({environment:n,customerData:t}),style:i.cancellationButton},void 0,a()(Kg,{}))}function Hg(e){window.__c={n:"CancelPendingChanges"};const{customerData:t}=e,i=Wg(),n=(0,Pe.O7)();return a()(Re.Z,{isLarge:!0,onClick:()=>Pg.y5({environment:n,customerData:t}),style:i.cancellationButton},void 0,a()(Kg,{}))}function jg(e){window.__c={n:"ScheduledChangesBillingSection"};const{stripeCustomerData:t}=e,i=Wg(),{scheduledChanges:n,periodEndDate:o}=(0,Ze.VK)((()=>(0,Zg.Tg)(t)),[t]),{cancelledChanges:s}=(0,Ze.VK)((()=>(0,Zg.n8)(t)),[t]);if(t.isSubscribed&&t.willCancelAt)return a()("div",{style:i.section},void 0,a()("div",{style:i.textSection},void 0,a()(Gg,{scheduledChanges:s,periodEndDate:t.willCancelAt})),a()(qg,{customerData:e.stripeCustomerData}));const r=(0,Zg.dY)(t);return(0,Zg.dA)(t)||r&&(0,Zg.bM)(t)?a()("div",{style:i.section},void 0,a()("div",{style:i.textSection},void 0,a()(Gg,{scheduledChanges:n,periodEndDate:o})),a()(Hg,{customerData:e.stripeCustomerData})):null}var Qg=i(62216),Yg=i(30751),$g=i(37030);function Xg(e){window.__c={n:"PaymentModal"};const{onClose:t,onAccept:i,customerData:n,spaceStore:o}=e,s=(0,Pe.O7)(),r=(0,v.useIntl)(),l=(0,xe.Fg)(),d=(0,Ze.VK)((()=>Yg.Z.selectedCurrencyCode),[]),c=(0,Lg.useElementsOptions)({type:"setup",currency:d});if(!(0,Ze.VK)((()=>Qg.rR()),[]))return a()(Pt.LazySpaceSubscriptionUpdatePaymentMethodModal,{customerData:n,spaceStore:o,onComplete:t});const u=[];return a()(Rg.Elements,{stripe:(0,Lg.getStripe)(),options:c},void 0,a()(Rg.ElementsConsumer,{},void 0,(e=>{let{elements:n,stripe:d}=e;return a()(Ug,{theme:l,title:"Payment method",onAccept:async()=>{if(!n||!d)return;const{error:e}=await n.submit();if(e)return;const t=await d.createPaymentMethod({elements:n});!t.error&&t.paymentMethod?(await Z.Mg({environment:s,spaceStore:o,paymentData:{type:"paymentMethodId",value:t.paymentMethod.id},from:"space_settings-billing_tab-update_payment_method"}),i()):t.error&&M.showErrorMessage(Lg.translateStripeError(s,r,t.error))},onClose:t,acceptAction:"update"},void 0,a()($g.k,{paymentMethods:u,temporaryPaymentMethod:"credit_card",payButtonState:"enabled"}))})))}const Jg={offline:a()(v.FormattedMessage,{defaultMessage:"Please go online to manage billing.",id:"spaceSubscriptionBillingV2.offline.message"})};class eh extends c.Z{constructor(){super(...arguments),this.couponEntryInput=null,this.storeTypes={store:vg,billingHistoryRequestStore:xo.Z},this.renderPlanTypeName=e=>{switch(e){case"personal":return a()(v.FormattedMessage,{id:"spaceSubscriptionBillingV2.planType.personal",defaultMessage:"Personal"});case"plus":case"team":return a()(v.FormattedMessage,{id:"spaceSubscriptionBillingV2.planType.plus",defaultMessage:"Plus"});case"business":return a()(v.FormattedMessage,{id:"spaceSubscriptionBillingV2.planType.business",defaultMessage:"Business"});case"enterprise":return a()(v.FormattedMessage,{id:"spaceSubscriptionBillingV2.planType.enterprise",defaultMessage:"Enterprise"});default:return null}},this.renderPaymentMethodModal=()=>{const{customerData:e,spaceStore:t}=this.props;return a()(Xg,{customerData:e,spaceStore:t,onClose:this.handleModalClose,onAccept:this.handleModalClose})},this.renderSingleTextFieldModal=(e,t,i,n,o)=>a()(Ug,{theme:this.theme,title:t,acceptAction:o,onAccept:n,onClose:this.handleModalClose},void 0,a()(Wi.Z,{focus:!0,selectAll:!0,value:e,onChange:i,onSubmit:n,style:eh.modalInputStyle})),this.renderBillingEmailModal=()=>{const{customerData:e}=this.props,{temporaryBillingEmail:t}=this.stores.store.state,i=void 0!==t?t:e.billingEmail||"",n=e.billingEmail?"update":"add";return this.renderSingleTextFieldModal(i,a()(v.FormattedMessage,{id:"spaceSubscriptionBillingV2.changeBillingEmailModal.title",defaultMessage:"Change billing email"}),this.handleBillingEmailChange,this.handleBillingEmailAccept,n)},this.renderVatIdModal=()=>{const{customerData:e}=this.props,{temporaryVatId:t}=this.stores.store.state,i=void 0!==t?t:e.vatId||"",n=e.vatId?"update":"add";return a()(Ug,{theme:this.theme,title:a()(v.FormattedMessage,{id:"spaceSubscriptionBillingV2.changeVATIDModal.title",defaultMessage:"Change VAT/GST number"}),acceptAction:n,onAccept:this.handleVatIdAccept,onClose:this.handleModalClose},void 0,a()(Wi.Z,{focus:!0,selectAll:!0,value:i,onChange:this.handleVatIdChange,onSubmit:this.handleVatIdAccept,style:eh.modalInputStyle}),a()("div",{style:{color:this.theme.mediumTextColor,fontSize:f.Z.fontSize.UISmall.desktop,marginTop:-10}},void 0,a()(v.FormattedMessage,{id:"spaceSubscriptionBillingV2.changeVATIDModal.subtitle",defaultMessage:"Please include your country code"})))},this.renderApplyCouponModal=()=>this.props.customerData.isSubscribed?a()(Ug,{theme:this.theme,title:a()(v.FormattedMessage,{id:"spaceSubscriptionBillingV2.applyCouponModal.title",defaultMessage:"Apply coupon"}),acceptAction:"apply",onAccept:()=>{this.couponEntryInput&&this.couponEntryInput.checkCouponCode()},onClose:this.handleModalClose},void 0,d.createElement(Dg,{ref:e=>this.couponEntryInput=e,hideApply:!0,plan:this.props.customerData.plan,handlePromo:async e=>{this.handleModalClose();await Z.Mg({environment:this.environment,spaceStore:this.props.spaceStore,coupon:e&&"coupon"===e.source?e.code:void 0,promoCodeId:e&&"promo_code"===e.source?e.code:void 0,from:"space_settings-billing_tab"})&&M.showMessage({message:a()(v.FormattedMessage,{id:"spaceSubscriptionBillingV2.applyCouponModal.successMessage",defaultMessage:"Coupon applied!"})})}})):null,this.handleChangePlanClick=()=>{_e.Z.setState({open:!0,openedFrom:"upsell",currentTab:"plans",defaultSubtab:void 0,highlightedSetting:void 0})},this.handlePaymentMethodChangeClick=()=>{this.stores.store.setState({...this.stores.store.state,paymentMethodModalOpen:!0})},this.handleBillingIntervalChangeClick=()=>{const{customerData:e}=this.props,t="interval"in e?e.interval:"year",i="year"===t?"month":"year";Pg.af({environment:this.environment,from:"billing_page",view:"billing_interval",temporaryBillingInterval:i,billingInterval:t})},this.handleAddressChangeClick=()=>{this.stores.store.setState({...this.stores.store.state,addressModalOpen:!0})},this.handleVatIdChangeClick=()=>{var e;const{customerData:t}=this.props,i=null===(e=t.address)||void 0===e?void 0:e.country;if(!i)return void M.showErrorMessage(a()(v.FormattedMessage,{id:"spaceSubscriptionBillingV2.vatId.missingCountry",defaultMessage:"To update your VAT/GST number, please update your billing address."}));!{AE:"ae_trn",AT:"eu_vat",AU:"au_abn",BE:"eu_vat",BG:"eu_vat",CA:"ca_bn",CH:"ch_vat",CY:"eu_vat",CZ:"eu_vat",DE:"eu_vat",DK:"eu_vat",EE:"eu_vat",ES:"eu_vat",FI:"eu_vat",FR:"eu_vat",GB:"gb_vat",GR:"eu_vat",HR:"eu_vat",HU:"eu_vat",IE:"eu_vat",IN:"in_gst",IT:"eu_vat",KR:"kr_brn",LT:"eu_vat",LU:"eu_vat",LV:"eu_vat",MT:"eu_vat",NL:"eu_vat",NZ:"nz_gst",PL:"eu_vat",PT:"eu_vat",RO:"eu_vat",RU:"ru_inn",SE:"eu_vat",SG:"sg_gst",SI:"eu_vat",SK:"eu_vat"}[i]?M.showErrorMessage(a()(v.FormattedMessage,{id:"spaceSubscriptionBillingV2.vatId.vatNotRequired",defaultMessage:"A VAT/GST number is not required for your tax jurisdiction."})):this.stores.store.setState({...this.stores.store.state,vatIdModalOpen:!0})},this.handleModalClose=()=>{this.stores.store.reset()},this.handleBillingEmailChange=e=>{this.stores.store.setState({...this.stores.store.state,temporaryBillingEmail:e.target.value})},this.handleBillingEmailAccept=async()=>{const{spaceStore:e,customerData:t}=this.props,{temporaryBillingEmail:i}=this.stores.store.state;i!==t.billingEmail&&await Z.Mg({environment:this.environment,spaceStore:e,billingEmail:i,from:"space_settings-billing_tab"}),this.handleModalClose()},this.handleVatIdChange=e=>{this.stores.store.setState({...this.stores.store.state,temporaryVatId:e.target.value})},this.handleVatIdAccept=async()=>{const{spaceStore:e,customerData:t}=this.props,{temporaryVatId:i}=this.stores.store.state;i!==t.vatId&&await Z.Mg({environment:this.environment,spaceStore:e,vatId:i,from:"space_settings-billing_tab"}),this.handleModalClose()},this.handleAddressAccept=async()=>{const{spaceStore:e}=this.props,t=this.getUpdatedAddress();if(t&&(0,_g.A)(t))try{await Z.y3({environment:this.environment,spaceStore:e,address:t}),this.handleModalClose()}catch(i){}else this.stores.store.setState({...this.stores.store.state,addressErrorMessage:this.props.intl.formatMessage({id:"spaceSubscriptionBillingV2.address.invalidError",defaultMessage:"Your address is invalid. Please update your address so we can process your payment."})})},this.getUpdatedAddress=()=>{const{customerData:e}=this.props,{temporaryAddress:t}=this.stores.store.state;if(t&&t!==e.address)return t},this.handleBillingEmailChangeClick=()=>{this.stores.store.setState({...this.stores.store.state,billingEmailModalOpen:!0})}}willMount(){Z.bi(this.environment),Z.px(this.environment)}renderComponent(){return Fe.Z.state.online?this.renderBilling():eh.renderOfflineMessage()}static renderOfflineMessage(){return a()(Ee.Z,{},void 0,a()(Ae.Z,{isSmall:!0,style:{textAlign:"center"}},void 0,Jg.offline))}renderPlanRow(){const{subscriptionData:e,customerData:t}=this.props;let i,n;const o=j.XX(e);o&&(i=a()(pg.W,{cost:{amount:o.planAmount*o.quantity,currencyCode:o.currencyCode},trailingZeroDisplay:"stripIfInteger"}),n=(0,Hn.Yx)(o.periodEnd,"medium",_a.SP));const s=t.willCancelAt,r=a()(v.FormattedMessage,s?{id:"spaceSubscriptionBillingV2.cancels",defaultMessage:"Cancels"}:{id:"spaceSubscriptionBillingV2.renews",defaultMessage:"Renews"});let l;if(o)switch(o.interval){case"month":l=a()(v.FormattedMessage,{id:"spaceSubscriptionBillingV2.priceAndRenewalDate.month",defaultMessage:"{planCharge} per month · {renewalOrCancellationMessage} {renewalDate}",values:{planCharge:i,renewalDate:n,renewalOrCancellationMessage:r}});break;case"year":l=a()(v.FormattedMessage,{id:"spaceSubscriptionBillingV2.priceAndRenewalDate.year",defaultMessage:"{planCharge} per year · {renewalOrCancellationMessage} {renewalDate}",values:{planCharge:i,renewalDate:n,renewalOrCancellationMessage:r}});break;default:(0,x.t1)(o.interval)}return a()(wg,{mainLabel:a()(v.FormattedMessage,{id:"spaceSubscriptionBillingV2.plan",defaultMessage:"Plan"}),metadataLabel:l,valueLabel:o?this.renderPlanTypeName(j.NW(o.productId)):"Free",button:{label:a()(v.FormattedMessage,{id:"spaceSubscriptionBillingV2.changePlan",defaultMessage:"Change plan"}),onClick:this.handleChangePlanClick}})}renderAdditionalFeaturesRowMetadataLabel(e,t){const{customerData:i}=this.props,n=i.isSubscribed?i.interval:"month",o=a()(pg.W,{cost:{amount:e.cost,currencyCode:i.currencyCode??"USD"},trailingZeroDisplay:"stripIfInteger"}),s=i.periodEnd;return a()(v.FormattedMessage,t?{id:"spaceSubscriptionBillingV2.priceAndRenewalDate.cancels",defaultMessage:"{planCharge} per {interval} · Cancels {date}",values:{planCharge:o,interval:n,date:(0,Hn.Yx)(t,"medium",_a.SP)}}:s?{id:"spaceSubscriptionBillingV2.priceAndRenewalDate.renews",defaultMessage:"{planCharge} per {interval} · Renews {date}",values:{planCharge:o,interval:n,date:(0,Hn.Yx)(s,"medium",_a.SP)}}:{id:"spaceSubscriptionBillingV2.priceAndRenewalDate.priceOnly",defaultMessage:"{planCharge} per {interval}",values:{planCharge:o,interval:n}})}renderAdditionalFeaturesRow(e){const{customerData:t}=this.props,i=Zg.A0(t);let n;var o;i&&(n=(0,h.ls)(null===(o=ke.default.state.data)||void 0===o?void 0:o.addOns)??t.periodEnd);const s={label:a()(v.FormattedMessage,i?{id:"spaceSubscriptionBillingV2.resubscribe",defaultMessage:"Resubscribe"}:{id:"spaceSubscriptionBillingV2.removeFromPlan",defaultMessage:"Remove from plan"}),onClick:async()=>{if(n){if(t.willCancelAt){const e=t.customerId?await Ig.y(this.environment,{offerType:"add_on_upgrade_flow",customerId:t.customerId}):void 0;return Tg.k2(),void Tg.Cl(e)}await Pg.y5({environment:this.environment,customerData:t})}else Tg.Kj()}};return a()(wg,{mainLabel:a()(v.FormattedMessage,{id:"spaceSubscriptionBillingV2.additionalFeatures",defaultMessage:"Additional features"}),metadataLabel:this.renderAdditionalFeaturesRowMetadataLabel(e,n),valueLabel:"Notion AI",button:s})}renderAdditionalFeaturesRows(){const{customerData:e}=this.props;return e.addOns.map((e=>a()(d.Fragment,{},e.feature,this.renderAdditionalFeaturesRow(e))))}renderBillingPeriodRow(){return(0,Q.iJ)()||!this.props.customerData.isSubscribed&&(0,h.E3)(this.props.customerData.addOns)?null:a()(wg,{mainLabel:a()(v.FormattedMessage,{id:"spaceSubscriptionBillingV2.billingPeriod",defaultMessage:"Billing period"}),valueLabel:this.renderBillingInterval(),button:{label:a()(v.FormattedMessage,{id:"spaceSubscriptionBillingV2.editPeriod",defaultMessage:"Edit period"}),onClick:this.handleBillingIntervalChangeClick}})}renderBillingEmailRow(){const{customerData:e}=this.props;return a()(wg,{mainLabel:a()(v.FormattedMessage,{id:"spaceSubscriptionBillingV2.billingEmail",defaultMessage:"Billing email"}),valueLabel:e.billingEmail??"",button:{label:a()(v.FormattedMessage,{id:"spaceSubscriptionBillingV2.editEmail",defaultMessage:"Edit email"}),onClick:this.handleBillingEmailChangeClick}})}renderPaymentMethodRow(){return a()(wg,{mainLabel:a()(v.FormattedMessage,{id:"spaceSubscriptionBillingV2.paymentMethod",defaultMessage:"Payment method"}),valueLabel:this.renderPaymentMethodType(),metadataLabel:this.renderPaymentMethodSummary(),button:{label:a()(v.FormattedMessage,{id:"spaceSubscriptionBillingV2.editMethod",defaultMessage:"Edit method"}),onClick:this.handlePaymentMethodChangeClick}})}renderAddressRow(){const{customerData:e}=this.props;return a()(wg,{mainLabel:a()(v.FormattedMessage,{id:"spaceSubscriptionBillingV2.billedTo",defaultMessage:"Billed to"}),valueLabel:this.renderAddressString(e.address),button:{label:a()(v.FormattedMessage,{id:"spaceSubscriptionBillingV2.editInformation",defaultMessage:"Edit information"}),onClick:this.handleAddressChangeClick}})}renderVATRow(){const{customerData:e}=this.props;return a()(wg,{mainLabel:a()(v.FormattedMessage,{id:"spaceSubscriptionBillingV2.vatGst",defaultMessage:"VAT/GST number"}),valueLabel:a()("div",{},void 0,e.vatId||"-"),button:{label:a()(v.FormattedMessage,{id:"spaceSubscriptionBillingV2.editNumber",defaultMessage:"Edit number"}),onClick:this.handleVatIdChangeClick}})}renderBilling(){const{paymentMethodModalOpen:e,billingEmailModalOpen:t,addressModalOpen:i,vatIdModalOpen:n,applyCouponModalOpen:o}=this.stores.store.state;return a()("div",{style:eh.wrapStyle},void 0,a()(yg.Z,{style:eh.scrollerStyle,type:hg.Z.Y},void 0,a()(Be.Z,{large:!0,divider:"full",style:eh.settingHeaderStyle},void 0,a()(v.FormattedMessage,{id:"spaceSubscriptionBillingV2.billing",defaultMessage:"Billing"})),a()(jg,{stripeCustomerData:this.props.customerData}),this.renderPlanRow(),this.renderAdditionalFeaturesRows(),this.renderBillingPeriodRow(),a()("div",{style:{height:40}}),a()(Be.Z,{large:!0,divider:"full",style:eh.settingHeaderStyle},void 0,a()(v.FormattedMessage,{id:"spaceSubscriptionBillingV2.paymentDetails",defaultMessage:"Payment details"})),this.renderPaymentMethodRow(),this.renderAddressRow(),this.renderBillingEmailRow(),this.renderVATRow(),a()(Cg,{spaceStore:this.props.spaceStore,upcomingInvoiceData:this.props.upcomingInvoiceData}),a()(us.Z,{open:e,render:this.renderPaymentMethodModal,onDismiss:this.handleModalClose}),a()(us.Z,{open:t,render:this.renderBillingEmailModal,onDismiss:this.handleModalClose}),a()(us.Z,{open:i,render:()=>a()(Vg,{addressErrorMessage:this.stores.store.state.addressErrorMessage,customerData:this.props.customerData,getUpdatedAddress:this.getUpdatedAddress,handleAddressAccept:this.handleAddressAccept,handleModalClose:this.handleModalClose,temporaryAddress:this.stores.store.state.temporaryAddress,updateAddress:e=>{this.stores.store.setAddressField(e)}}),onDismiss:this.handleModalClose}),a()(us.Z,{open:n,render:this.renderVatIdModal,onDismiss:this.handleModalClose}),a()(us.Z,{open:o,render:this.renderApplyCouponModal,onDismiss:this.handleModalClose})))}renderPaymentMethodType(){const{customerData:e}=this.props,t=e.isSubscribed?e.billing:"charge_automatically";if("send_invoice"===t)return a()(v.FormattedMessage,{id:"spaceSubscriptionBilling.subscriptionSettingsSection.paymentMethod.value.achOrWireTransfer",defaultMessage:"ACH or Wire Transfer"});if("charge_automatically"!==t)return a()(v.FormattedMessage,{id:"spaceSubscriptionBilling.subscriptionSettingsSection.paymentMethod.value.none",defaultMessage:"None"});switch(e.paymentMethodType){case"card":return a()(v.FormattedMessage,{id:"spaceSubscriptionBillingV2.paymentMethodType.creditCard",defaultMessage:"Credit card"});case"link":return a()(v.FormattedMessage,{id:"spaceSubscriptionBillingV2.paymentMethodType.link",defaultMessage:"Stripe Link"});default:return a()(v.FormattedMessage,{id:"spaceSubscriptionBillingV2.paymentMethodType.other",defaultMessage:"Other"})}}renderPaymentMethodSummary(){const{customerData:e}=this.props,t=e.isSubscribed?e.billing:"charge_automatically";if("send_invoice"===t)return a()(v.FormattedMessage,{id:"spaceSubscriptionBilling.subscriptionSettingsSection.paymentMethod.value.achOrWireTransfer",defaultMessage:"ACH or Wire Transfer"});if("charge_automatically"!==t)return a()(v.FormattedMessage,{id:"spaceSubscriptionBilling.subscriptionSettingsSection.paymentMethod.value.none",defaultMessage:"None"});switch(e.paymentMethodType){case"card":return a()(v.FormattedMessage,{id:"spaceSubscriptionBillingV2.paymentMethod.creditCard",defaultMessage:"{creditCardBrand} ending in {lastFourDigits}",values:{creditCardBrand:(0,kg.Z)(e.brand),lastFourDigits:e.last4}});default:return}}renderBillingInterval(){const{customerData:e}=this.props;return e.isSubscribed?"month"===e.interval?a()(v.FormattedMessage,{id:"spaceSubscriptionBillingV2.subscriptionSettingsSection.billingInterval.value.monthly",defaultMessage:"Monthly"}):a()(v.FormattedMessage,{id:"spaceSubscriptionBillingV2.subscriptionSettingsSection.billingInterval.value.yearly",defaultMessage:"Yearly"}):a()(v.FormattedMessage,{id:"spaceSubscriptionBillingV2.subscriptionSettingsSection.billingInterval.value.monthly",defaultMessage:"Monthly"})}renderAddressString(e){return e?this.props.intl.formatList([e.name,e.businessName,e.addressLine1,e.country].filter(Boolean),{type:"conjunction",style:"narrow"}):""}}eh.displayName="SpaceSubscriptionBillingV2",eh.wrapStyle={display:"flex",flexDirection:"column",height:"100%"},eh.scrollerStyle={height:"100%",padding:"36px 60px"},eh.modalInputStyle={marginTop:12,marginBottom:20},eh.settingHeaderStyle={marginBottom:4};const th=(0,v.injectIntl)(eh);class ih extends c.Z{constructor(){super(...arguments),this.storeTypes={store:vg,billingHistoryRequestStore:xo.Z}}willMount(){Z.bi(this.environment)}renderComponent(){const{data:e}=this.props;return Fe.Z.state.online?a()("div",{style:ih.wrapStyle},void 0,a()(yg.Z,{style:ih.scrollerStyle,type:hg.Z.Y},void 0,a()(Be.Z,{large:!0,divider:"full"},void 0,d.createElement(v.FormattedMessage,lg.billingTab)),this.renderCredit(e),this.renderSeparator(),a()(Cg,{spaceStore:this.props.spaceStore,upcomingInvoiceData:void 0}))):ih.renderOfflineMessage()}static renderOfflineMessage(){return a()(Ee.Z,{},void 0,a()(Ae.Z,{isSmall:!0,style:{textAlign:"center"}},void 0,Jg.offline))}renderCredit(e){var t;const i=null===(t=e.customerData)||void 0===t?void 0:t.stripe.currencyCode;if(!i)return null;const n=-Math.min(0,e.accountBalance);return a()(Mg,{title:gg.workspaceBalance,caption:a()("div",{},void 0,a()(pg.W,{cost:{amount:n,currencyCode:i},trailingZeroDisplay:"stripIfInteger"})),buttonArgs:{showButton:!1,buttonPurpose:"apply_credit",onClick:l().noop}})}renderSeparator(){return a()("div",{style:{flex:"none",marginTop:30}})}}ih.displayName="SpaceSubscriptionBillingUnsubscribed",ih.wrapStyle={display:"flex",flexDirection:"column",height:"100%"},ih.scrollerStyle={height:"100%",padding:"36px 60px"};const nh=ih;var ah=i(17126),oh=i(21571),sh=i(71993),rh=i(7036);class lh extends B.default{getInitialState(){return{termType:"yearly"}}}const dh=new lh;var ch=i(91754),uh=i(32617),mh=i(10644),ph=i(49369),gh=i(24684);const hh=function(e){return!!e.device.isMobile||e.WindowSizeStore.state.width<960};var fh=i(73796);class vh extends c.Z{renderComponent(){const e="yearly"===dh.state.termType?"monthly":"yearly";return a()("div",{style:vh.getTermToggleStyle(this.theme),onClick:()=>{b.iw$(this.environment,{from:"pricing_grid_top",toggle_to:e}),dh.setState({...dh.state,termType:e})}},void 0,a()("div",{style:{marginRight:8}},void 0,a()(v.FormattedMessage,{id:"pricingGrid.pricingTermToggle.payAnnually.label",defaultMessage:"Pay annually"})),a()(dr.Z,{on:"monthly"===dh.state.termType}),a()("div",{style:{marginLeft:8}},void 0,a()(v.FormattedMessage,{id:"pricingGrid.pricingTermToggle.payMonthly.label",defaultMessage:"Monthly"})))}static getTermToggleStyle(e){return{cursor:"pointer",fontSize:14,color:e.mediumTextColor,display:"flex",alignItems:"center",marginBottom:8}}}vh.displayName="PricingTermToggle";const yh=vh;var Sh=i(78641);const bh=["free","plus","business","enterprise"];class Mh extends c.Z{willMount(e){const t=j.XX(e.data);t&&e.data&&dh.setState({termType:"year"===t.interval?"yearly":"monthly"})}renderComponent(){const e=(0,gh.Sl)();return a()("div",{},void 0,a()("table",{style:Mh.getTableStyle()},void 0,this.renderHeader(),a()("tbody",{},void 0,e.map(((e,t)=>this.renderSection(e,t))))))}renderCheck(){return m.Z.thinCheck({display:"inline",height:12,width:12,color:this.theme.regularTextColor})}upgradeLink(e,t){const{planState:i}=this.props;if(i)return a()(Jo.Z,{onClick:i.plans[e].onClick,style:{fontSize:12,fontWeight:500,textDecoration:"none",color:this.theme.mediumTextColor,lineHeight:1.2}},void 0,t||a()(v.FormattedMessage,{id:"pricingGrid.planAttribute.button.upgrade",defaultMessage:"Upgrade"}))}renderPlanContent(e){const{label:t,upgradeCta:i,upgradeCTALabel:n}=e;return t&&i?a()(d.Fragment,{},void 0,t,a()("br",{}),this.upgradeLink(i,n)):t||(i?a()(d.Fragment,{},void 0,a()(v.FormattedMessage,{id:"pricingGrid.planAttribute.notInTrial",defaultMessage:"Not in trial"}),a()("br",{}),this.upgradeLink(i,n)):this.renderCheck())}renderPlan(e,t,i){return a()("td",{style:{...Mh.getRowStyle(this.theme),...Mh.getValueStyle(),...Mh.getActiveStyle(this.theme,this.isPlanActive(e)),...this.getBorderStyle(e)}},void 0,i.hasFeature&&a()(We.Z,{delayThreshold:0,placement:We.Z.Placement.Right,renderTooltip:()=>(0,gh.O_)(t),textWrap:!0,render:e=>d.createElement("div",s()({style:{cursor:"help",lineHeight:1.3,padding:"6px 0"}},e),this.renderPlanContent(i))}))}renderItem(e,t){const i="auto",n=this.props.planState&&this.props.planState.isTeamTrial;return a()("tr",{},`table-row-${t}`,a()("td",{style:{...Mh.getRowStyle(this.theme),...Mh.getRowLabelStyle(this.theme),width:i,maxWidth:i,minWidth:i}},void 0,a()(We.Z,{delayThreshold:0,placement:We.Z.Placement.Right,renderTooltip:()=>(0,gh.O_)(e.tooltip),textWrap:!0,render:t=>d.createElement("span",s()({},t,{style:Mh.getTooltipInnerStyle()}),e.label,e.isComingSoon&&this.renderBadge("comingSoon"),e.isBeta&&this.renderBadge("beta"))})),bh.map((t=>{const i="plus"===t&&n?"teamTrial":t;return this.renderPlan(t,e.tooltip,e.plans[i])})))}renderEmptyTableCell(e,t){return a()("td",{style:{...Mh.getSectionStyle(this.theme,t),...Mh.getValueStyle(),...Mh.getActiveStyle(this.theme,this.isPlanActive(e)),...this.getBorderStyle(e),color:qn.ZP.lightTextColor,fontWeight:400}})}renderEmptyTableCells(e){return a()(d.Fragment,{},void 0,bh.map((t=>this.renderEmptyTableCell(t,e))))}renderSection(e,t){const i="auto";return a()(d.Fragment,{},`table-section-${t}`,a()("tr",{},void 0,a()("td",{style:{...Mh.getSectionStyle(this.theme,t),width:i,maxWidth:i,minWidth:i}},void 0,e.label),this.renderEmptyTableCells(t)),e.items.map(((e,t)=>this.renderItem(e,t))))}renderButton(e,t){const i=this.getProductCost(e),n=t.plans[e],o=`notion-pricing-grid-upgrade-${e}`;let s;switch(n.buttonType){case"current":s=a()(v.FormattedMessage,{id:"pricingGrid.currentPlanButton.label",defaultMessage:"Current"});break;case"upgrade":s=a()(v.FormattedMessage,{id:"pricingGrid.upgradePlanButton.label",defaultMessage:"Upgrade"});break;case"downgrade":s=a()(v.FormattedMessage,{id:"pricingGrid.downgradePlanButton.label",defaultMessage:"Downgrade"});break;case"will-downgrade":s=a()(v.FormattedMessage,{id:"pricingGrid.willDowngradePlanButton.label",defaultMessage:"Future plan"});break;case"resubscribe":s=a()(v.FormattedMessage,{id:"pricingGrid.resubscribePlanButton.label",defaultMessage:"Resubscribe"});break;default:x.t1(n.buttonType)}if("current"===n.buttonType)return this.renderDisabledButtonWithTooltip({tooltip:a()(v.FormattedMessage,{id:"pricingGrid.currentPlan.tooltip",defaultMessage:"This is your current active plan"}),label:a()(v.FormattedMessage,{id:"pricingGrid.currentPlan.largeScreenLabel",defaultMessage:"Current plan"}),buttonClassName:o,wrapTooltip:!1});if(!t.canSwitchPlans){let e;return e=t.isInAppPurchase?a()(v.FormattedMessage,{id:"pricingGrid.switchPlanFromInAppPurchase.tooltip",defaultMessage:"You're currently subscribed through an in-app purchase with Apple. To switch plans, cancel your subscription with Apple first."}):a()(v.FormattedMessage,{id:"pricingGrid.switchPlanAsMember.tooltip",defaultMessage:"You need to be an administrator of this workspace to switch plans."}),this.renderDisabledButtonWithTooltip({tooltip:e,label:s,buttonClassName:o,wrapTooltip:!0})}return"will-downgrade"===n.buttonType?this.renderDisabledButtonWithTooltip({tooltip:a()(v.FormattedMessage,{id:"pricingGrid.willDowngradePlan.tooltip",defaultMessage:"This is the plan after your current plan expires"}),label:a()(v.FormattedMessage,{id:"pricingGrid.willDowngradePlan.largeScreenLabel",defaultMessage:"Future plan"}),buttonClassName:o,wrapTooltip:!1}):"downgrade"===n.buttonType?a()(Re.Z,{isLarge:!0,style:{width:"100%"},onClick:()=>{b.rOZ(this.environment,{plan:e,currency_code:Yg.Z.selectedCurrencyCode,from:"pricing_grid_top",button_text:n.buttonType}),n.onClick()},className:o},void 0,s):a()($e.Z,{isLarge:!0,style:{width:"100%"},disabled:!i,onClick:()=>{b.rOZ(this.environment,{plan:e,currency_code:Yg.Z.selectedCurrencyCode,from:"pricing_grid_top",button_text:n.buttonType}),n.onClick()},className:o},void 0,s)}renderDisabledButtonWithTooltip(e){const{tooltip:t,label:i,buttonClassName:n,wrapTooltip:o}=e;return a()(We.Z,{style:{width:o?320:"auto"},textWrap:o,renderTooltip:()=>t,render:e=>d.createElement(Re.Z,s()({style:{width:"100%",opacity:.5},isLarge:!0,disabled:!0},e,{className:n}),i)})}renderSalesContactLink(e){const t=`setup_${e}_trial`;return a()(Jo.Z,{onClick:()=>{const{currentUserStore:e}=A.default.state,i=null!=e&&e.isDefined()?e.getModel():void 0;b.EUb(this.environment),fh.Z.setState({open:!0,email:i&&i.getEmail(),name:null==i?void 0:i.getDisplayName(this.props.intl),question:t})}},void 0,a()("div",{style:Mh.getUpgradeButtonBelowLinkStyle()},void 0,a()(v.FormattedMessage,{id:"pricingGrid.requestATrial",defaultMessage:"or Request a Trial"})))}getPlanName(e){const{intl:t}=this.props;switch(e){case"free":return t.formatMessage(id.a.free);case"plus":return t.formatMessage(id.a.plus);case"business":return t.formatMessage(id.a.business);case"enterprise":return t.formatMessage(id.a.enterprise);default:x.t1(e)}}getTerms(e){switch(e){case"free":return;case"plus":case"business":case"enterprise":return"per_member_per_month";default:x.t1(e)}}getProductCost(e){var t;if("free"===e)return{amount:0,currencyCode:Yg.Z.selectedCurrencyCode};const i="monthly"===dh.state.termType?"month":"year",n=Yg.Z.getPrice(this.environment,(t=>t.billingInterval===i&&t.product===e));return n.isLoaded?null===(t=n.result)||void 0===t?void 0:t.getMonthlyUnitCost().toMoneyValue():void 0}renderHeaderTitle(e){const t=this.getPlanName(e),i=this.getProductCost(e),n=this.getTerms(e);return a()("td",{style:{...Mh.getHeaderStyle(),...Mh.getActiveStyle(this.theme,this.isPlanActive(e)),...this.getBorderStyle(e)}},void 0,a()("div",{style:this.getHeaderTitleStyle()},void 0,t),i?a()("div",{style:{display:hh(this.environment)?"block":"flex"}},void 0,a()("div",{style:Mh.getHeaderPriceStyle()},void 0,a()(pg.W,{cost:i,trailingZeroDisplay:"stripIfInteger"})),n?a()("div",{style:this.getHeaderTermsStyle(this.theme)},void 0,(0,gh.X6)(this.props.intl,n)):null):a()(Sh.u,{}))}renderHeaderTitles(){return a()("tr",{},void 0,a()("td",{}),bh.map((e=>a()(d.Fragment,{},e,this.renderHeaderTitle(e)))))}renderHeaderAction(e){const{planState:t}=this.props;if(t)return a()("td",{style:{...Mh.getHeaderStyle(),...Mh.getActiveStyle(this.theme,this.isPlanActive(e)),...this.getBorderStyle(e)}},void 0,this.renderButton(e,t),this.renderHeaderSubAction(e))}renderHeaderSubAction(e){if((0,ql.Rs)(e))return a()("div",{style:{marginTop:7}},void 0,this.renderSalesContactLink(e))}renderHeaderActions(){if(this.props.planState)return a()("tr",{},void 0,a()("td",{style:{width:"28%",verticalAlign:"top",paddingTop:16}},void 0,a()(yh,{})),bh.map((e=>this.renderHeaderAction(e))))}renderHeader(){return a()("thead",{},void 0,this.renderHeaderTitles(),this.renderHeaderActions())}renderBadge(e){return a()("div",{style:{background:this.theme.buttonHoveredBackground,fontSize:10,fontWeight:500,letterSpacing:"0.015em",color:this.theme.mediumTextColor,display:"inline",textTransform:"uppercase",padding:"2px 4px",marginLeft:6,borderRadius:3,whiteSpace:"nowrap",position:"relative",top:-1}},void 0,"comingSoon"===e&&a()(v.FormattedMessage,{id:"pricingGrid.comingSoonBadge",defaultMessage:"Coming soon"}),"beta"===e&&a()(v.FormattedMessage,{id:"pricingGrid.betaBadge",defaultMessage:"Beta"}))}isPlanActive(e){return Boolean(this.props.planState&&this.props.planState.plans[e].isActive)}static getTableStyle(){return{fontSize:14,width:"100%",tableLayout:"fixed",borderCollapse:"initial"}}static getSectionStyle(e,t){const i={borderBottom:`1px solid ${e.regularDividerColor}`,paddingBottom:7,paddingRight:15,fontWeight:500,verticalAlign:"bottom"};return 0===t?{...i,paddingTop:0}:{...i,paddingTop:20}}static getUpgradeButtonBelowLinkStyle(){return{fontSize:12}}static getRowStyle(e){return{borderBottom:`1px solid ${e.regularDividerColor}`}}static getRowLabelStyle(e){return{color:e.mediumTextColor,paddingRight:10,paddingTop:5,paddingBottom:6,verticalAlign:"top"}}static getValueStyle(){return{paddingLeft:10,paddingRight:10,textAlign:"left",overflow:"hidden",verticalAlign:"top"}}static getActiveStyle(e,t){const i=e.cardSidebarBackground;return{background:t?i:qn.ZP.transparent}}getBorderStyle(e){return{borderLeft:`1px solid ${this.theme.lightDividerColor}`,borderRight:["enterprise"].includes(e)?`1px solid ${this.theme.lightDividerColor}`:void 0}}static getHeaderStyle(){return{paddingLeft:10,paddingRight:10,verticalAlign:"top",width:"18%",paddingTop:10}}getHeaderTitleStyle(){return{fontSize:16,fontWeight:hh(this.environment)?500:700,lineHeight:1.3,marginBottom:2,paddingTop:40}}static getHeaderPriceStyle(){return{fontSize:20,marginRight:7}}static getTooltipInnerStyle(){return{cursor:"help",width:"100%",display:"inline-block"}}getHeaderTermsStyle(e){return{fontSize:10,lineHeight:1,color:e.mediumTextColor,width:70,paddingTop:hh(this.environment)?0:3}}}Mh.displayName="PricingGrid";const wh=(0,v.injectIntl)(Mh);function Ch(e){window.__c={n:"StudentUpgrade"};const{handleEducationPlanClick:t}=e,i=(0,xe.yK)((e=>({subsection:{fontSize:14,marginTop:40},subsectionTitle:{fontSize:20,fontWeight:f.Z.fontWeight.bold,marginBottom:12},content:{color:e.mediumTextColor,marginBottom:15},paragraph:{marginBottom:4},link:{textDecoration:"underline"}})),[]);return a()("div",{style:i.subsection},void 0,a()("div",{style:i.subsectionTitle},void 0,a()(v.FormattedMessage,{id:"spaceSubscriptionPlans.studentsAndEducatorsSection.title",defaultMessage:"Students & educators"})),a()("div",{style:i.content},void 0,d.createElement(d.Fragment,null,a()(v.FormattedMessage,{id:"spaceSubscriptionPlans.studentsAndEducatorsSection.description",defaultMessage:"<p>Students and educators can get access to the Plus Plan features (with a 1-member limit) for free! Just sign up with your school email address, or change your existing email in the 'My account' tab.</p>",values:{p:e=>a()("div",{style:i.paragraph},void 0,e)}}),a()("div",{},void 0,a()(Jo.Z,{onClick:t,style:i.link},void 0,a()(v.FormattedMessage,{defaultMessage:"Get the Education Plan",id:"sidebarStudentPlanPrompt.eligible.getFreePromptPlus"}))),a()("div",{},void 0,a()(Jo.Z,{external:!0,href:(0,H.UY)("guides.students")},void 0,a()(v.FormattedMessage,{id:"spaceSubscriptionPlans.studentSection.link",defaultMessage:"For more info, go to notion.com/students."}))))))}function _h(e){window.__c={n:"TrialBanner"};const{subscriptionData:t}=e,i=(0,xe.yK)((e=>({text:{color:e.accentColors[500]}})),[]),n=j.XX(t);return n&&n.trialEnd?n.trialEnd<ah.ou.now().toSeconds()?null:a()(ch.Z,{type:ch.$.Beige,isMobile:!1},void 0,a()("div",{style:i.text},void 0,a()(v.FormattedMessage,{id:"SpaceSubscriptionPlans.trials.bannerText",defaultMessage:"Your workspace is on a free trial until {trialEndDate}",values:{trialEndDate:(0,Hn.Yx)(1e3*n.trialEnd,"long",_a.SP)}}))):null}class kh extends c.Z{constructor(){super(...arguments),this.storeTypes={store:Zm,downgradeModalStore:rh.ZP,securitySettingsStore:me.Z},this.renderChurnSurveyModal=()=>{const e=this.stores.store.state,{data:t}=this.props,i=j.XX(t),n=Q.zt();if(e.churnSurveyModalOpen&&n&&i)return a()(Qm.Z,{churnType:e.churnType,currentPlan:n,isWorkspaceDeletion:!1,periodEnd:i.periodEnd,hasAI:(0,h.de)(i.addOns),hasPendingChanges:Boolean(i.schedule||i.willCancelAt),customerId:i.customerId,onAccept:this.handleChurnSurveyModalAccept,onClose:this.handleChurnSurveyModalClose})},this.handleFreeClick=async()=>{const{data:e}=this.props;let t="no_confirmation_required";e&&"subscribed_admin"===e.type&&(t=await new Promise((e=>{const{store:t}=this.stores;t.setState({...t.state,churnType:"free",churnSurveyModalOpen:!0,onAccept:t=>e(t?"churn_immediately":"churn_by_end_of_billing_period"),onClose:()=>e("no_churn")})})),"no_churn"===t)||await Z.EO({environment:this.environment,spaceStore:this.props.spaceStore,planType:"personal",from:"space_settings-plans_tab",cancelImmediately:"churn_immediately"===t})},this.handleEducationPlanClick=()=>{const{spaceStore:e}=this.props;Z.r7({environment:this.environment,spaceStore:e})},this.handlePlanChangeClick=async e=>{const{spaceStore:t,data:i}=this.props,n=j.XX(i);if(!n||!j.MM(i))return void Z.I0(this.environment,{subscriptionTier:e,from:"pricing_grid"});const a=Q.zt();if(a&&ql.rC[e]<ql.rC[a]){if(!(await new Promise((t=>{const{store:i}=this.stores;i.setState({...i.state,churnType:e,churnSurveyModalOpen:!0,onAccept:()=>t(!0),onClose:()=>t(!1)})}))))return;try{const i=await async function(e){const{billingInterval:t,environment:i,product:n}=e;await Yg.Z.waitUntilReady();const a=Yg.Z.getPrice(i,(e=>e.product===n&&e.billingInterval===t));if(!a.result)throw new Error("Could not find price model");return a.result}({environment:this.environment,billingInterval:n.interval,product:e});await Z.Mg({environment:this.environment,spaceStore:t,plan:i.externalId,from:"space_settings-plans_tab"})}catch(o){oh.IE(o),M.showErrorMessage("Sorry, something went wrong. Please try again.")}}else{const t="yearly"===dh.state.termType?"year":"month";Pg.af({environment:this.environment,from:"plans_page",view:"plans",temporarySubscriptionTier:e,billingInterval:t,pageSection:"all_plans_grid"})}},this.handleChurnSurveyModalAccept=e=>{const{store:t}=this.stores;t.state.churnSurveyModalOpen&&t.state.onAccept(e),t.reset()},this.handleChurnSurveyModalClose=()=>{const{store:e}=this.stores;if(e.state.churnSurveyModalOpen&&e.state.onClose(),"grid"===e.state.page)return e.reset(),void e.setState({...e.state,page:"grid"});e.reset()}}willMount(){Z.bi(this.environment),Z.px(this.environment)}renderComponent(){if(Fe.Z.state.online){const e=Qg.$r(),{churnSurveyModalOpen:t,page:i}=this.stores.store.state,n="grid"===i,o=!e||n;return d.createElement(d.Fragment,null,this.renderBanner(j.wY(this.props.data),this.props.intl),a()(_h,{subscriptionData:this.props.data}),n?a()(Th,{handlePlansBackButtonClick:this.handlePlansBackButtonClick}):null,a()(yg.Z,{style:{height:"100%",padding:n?"0px 30px 100px 60px":"100px 0px 100px 60px"},type:hg.Z.Y},void 0,a()(uh.ZP,{data:this.props.data,spaceStore:this.props.spaceStore,spaceSubscriptionPlansStore:this.stores.store}),o?d.createElement(d.Fragment,null,a()(Xo.Z,{size:0}),this.renderPricingGrid(),this.allowEducationUpgrade()?a()(Ch,{handleEducationPlanClick:this.handleEducationPlanClick}):null,this.renderFAQ(),a()(us.Z,{innerStyle:{width:300,height:"auto",overflow:"scroll"},open:t,render:this.renderChurnSurveyModal,onDismiss:this.handleChurnSurveyModalClose})):null))}return a()(mh.Z,{})}renderPricingGrid(){const e=this.getPlanState();return a()(wh,{planState:e,data:this.props.data})}renderFAQ(){return a()("div",{style:kh.subsectionStyle},void 0,a()("div",{style:kh.subsectionTitleStyle},void 0,a()(v.FormattedMessage,{id:"spaceSubscriptionPlans.faqSection.title",defaultMessage:"FAQ"})),a()(Jo.Z,{external:!0,href:(0,H.UY)("guides.billingAndPaymentRevised")},void 0,a()(v.FormattedMessage,{id:"spaceSubscriptionPlans.faqSection.link",defaultMessage:"Plans, Billing & Payment"})))}handlePlansBackButtonClick(){const{store:e}=this.stores;e.setState({...e.state,page:"default"})}renderBanner(e,t){const i=(0,Q.zt)();if(!i)return null;if((0,uh.lu)(e,i)){const n=(0,uh.QH)(e,i);return a()(ch.Z,{type:ch.$.Beige,isMobile:!1},void 0,a()("div",{style:{color:this.theme.accentColors[500]}},void 0,n&&t.formatMessage(n)))}return null}getMemberCount(){return j.su(this.props.data)}canSwitchPlans(){const e=j.wY(this.props.data);return this.props.spaceStore.canAdmin()&&!e}calculateButtonState(e){const{data:t}=this.props,i=j.DH(t);return(0,ql.QM)(e)?{free:"current",plus:"upgrade",business:"upgrade",enterprise:"upgrade"}:(0,ql.Aw)(e)?{free:i?"current":"downgrade",plus:"upgrade",business:"upgrade",enterprise:"upgrade"}:(0,ql.eR)(e)?{free:"downgrade",plus:i?"resubscribe":"current",business:"upgrade",enterprise:"upgrade"}:"business"===e?{free:"downgrade",plus:"downgrade",business:i?"resubscribe":"current",enterprise:"upgrade"}:"enterprise"===e?{free:"downgrade",plus:"downgrade",business:"downgrade",enterprise:i?"resubscribe":"current"}:void(0,x.t1)(e)}isButtonStateActive(e){return["current","resubscribe"].includes(e)}getPlanState(){const e=Q.zt();if(!e)return;const t=j.wY(this.props.data),i=this.calculateButtonState(e);return{plans:{free:{buttonType:i.free,isActive:this.isButtonStateActive(i.free),onClick:this.handleFreeClick},plus:{buttonType:i.plus,isActive:this.isButtonStateActive(i.plus),onClick:()=>this.handlePlanChangeClick("plus")},business:{buttonType:i.business,isActive:this.isButtonStateActive(i.business),onClick:()=>this.handlePlanChangeClick("business")},enterprise:{buttonType:i.enterprise,isActive:this.isButtonStateActive(i.enterprise),onClick:()=>this.handlePlanChangeClick("enterprise")}},isTeamTrial:!1,isInAppPurchase:t,canSwitchPlans:this.canSwitchPlans(),memberCount:this.getMemberCount()}}allowEducationUpgrade(){const{data:e}=this.props,t=this.getPlanState(),i=Q.zt();return t&&t.canSwitchPlans&&!j.wl(e)&&1===t.memberCount&&("free"===i||"personal"===i)}}function Th(e){window.__c={n:"AllPlansButton"};const{handlePlansBackButtonClick:t}=e,i=(0,xe.yK)((()=>({backButton:{display:"inline-flex",padding:10},icon:{height:16,marginTop:4,width:16},settingHeader:{alignItems:"center",display:"flex",flexGrow:1,fontSize:16,fontWeight:f.Z.fontWeight.medium,justifyContent:"space-between",marginBottom:0,padding:"10px 0 10px 5px"},wrapper:{display:"flex",padding:"30px 30px 0px 60px"}})),[]),{availableCurrencyCodes:n,selectedCurrencyCode:o}=(0,Ze.VK)((()=>({availableCurrencyCodes:Yg.Z.availableCurrencyCodes,selectedCurrencyCode:Yg.Z.selectedCurrencyCode})),[]);return a()("div",{style:i.wrapper},void 0,a()(Kd.Z,{style:i.backButton,onClick:t},void 0,m.Z.chevronLeft(i.icon)),a()(Be.Z,{large:!0,style:i.settingHeader},void 0,a()(v.FormattedMessage,{id:"spaceSubscriptionPlans.allPlans.title",defaultMessage:"All plans"}),a()(ph.V,{availableCurrencyCodes:n,onSelectCurrency:sh.y,selectedCurrencyCode:o})))}kh.displayName="SpaceSubscriptionPlans",kh.subsectionStyle={fontSize:14,marginTop:40},kh.subsectionTitleStyle={fontSize:20,fontWeight:f.Z.fontWeight.bold,marginBottom:12};const Ih=(0,v.injectIntl)(kh);var Ph=i(26234),Zh=i(74452);const xh="teamColumn",Fh="ownersColumn",Ah="membersColumn",Eh="AccessLevelColumn",Bh="lastUpdatedColumn",Dh="contextMenuColumn",Rh=[xh,Ah,Eh,Bh],Lh="filterAccessAny",Nh="filterAccessOnlyOpen",Oh="filterAccessOnlyClosed",Vh="filterAccessOnlyPrivate",Uh="filterOwnerAny",Wh="filterOwnerShowOrphaned",Kh="filterOwnerById";class zh extends B.default{getInitialState(){return{searchQuery:"",sortColumn:Bh,sortAscending:!1,showOnlyArchivedTeams:!1,filterByOwner:{type:Uh},filterAccess:Lh,showTeamsWithSecurityOverrides:!1}}}const Gh=new zh;function qh(e){let{environment:t,teamIds:i}=e;const{currentSpaceStore:n,currentUserStore:a}=A.default.state;return n&&a?i.map((e=>{const i=He.zX.createChildStore(n,{table:yt.e0,id:e,spaceId:n.id});if(i.canRead())return i;const a=n&&Wd.Dv({environment:t,teamId:i.id,spaceStore:n,from:"manage_teams_table"});return null!=a&&a.canRead()?a:void 0})).filter(x.$K):[]}var Hh=i(51923);class jh extends B.default{getInitialState(){return{tokenQuery:"",showAutoCompletePopup:!1,defaultTeams:{}}}addedAndCurrentTeams(){return Object.values(this.state.defaultTeams).filter((e=>{let{state:t}=e;return"current-default"===t||"add-default"===t}))}addedTeams(){return Object.values(this.state.defaultTeams).filter((e=>{let{state:t}=e;return"add-default"===t}))}removedTeams(){return Object.values(this.state.defaultTeams).filter((e=>{let{state:t}=e;return"remove-default"===t}))}}const Qh=new jh;function Yh(e){var t;let{team:i}=e;return null===(t=Qh.state.defaultTeams[i.id])||void 0===t?void 0:t.state}function $h(e){let{team:t,persistedDefaultTeams:i}=e;if(i.includes(t))Xh({store:t,state:"current-default"});else{const e={...Qh.state.defaultTeams};delete e[t.id],Qh.setState({...Qh.state,defaultTeams:e})}}function Xh(e){const t=Qh.state;Qh.setState({...t,defaultTeams:{...t.defaultTeams,[e.store.id]:e}})}var Jh=i(75024),ef=i(30676),tf=i(47082);function nf(e){let{}=e;window.__c={n:"DefaultTeamsInput"};const t=(0,Pe.Fy)(),i=(0,v.useIntl)(),n=(0,Pe.O7)(),{allTeams:o,loaded:r}=(0,Ze.VK)((()=>{const e=R.state;return"loaded"!==e.loadingState?{allTeams:[],loaded:!1}:{allTeams:qh({environment:n,teamIds:e.unarchivedTeamIds}),loaded:!0}}),[n]),[c,u]=(0,d.useState)(!1),m=(0,Ze.qz)(Qh),p=(0,Ze.VK)((()=>A.default.state.currentSpaceStore),[]),{defaultTeams:g,tokenQuery:h}=(0,Ze.VK)((()=>{const{defaultTeams:e,tokenQuery:t}=m.state;return{defaultTeams:e,tokenQuery:t}}),[m]),f=!h,{addedTeams:y,removedTeams:S,addedAndCurrentTeams:b}=(0,Ze.VK)((()=>({addedAndCurrentTeams:m.addedAndCurrentTeams(),addedTeams:m.addedTeams(),removedTeams:m.removedTeams()})),[m]),M=(0,Ze.VK)((()=>o.reduce(((e,t)=>(e[t.id]=t.getName(),e)),{})),[o]),w=(0,Ze.VK)((()=>o.filter((e=>e.isDefault()))),[o]);(0,d.useEffect)((()=>function(e){let{persistedDefaultTeams:t}=e;const i=t.reduce(((e,t)=>(e[t.id]={state:"current-default",store:t},e)),{}),n=Qh.state;Qh.setState({...n,defaultTeams:i})}({persistedDefaultTeams:w})),[w]);const C=y.length>0||S.length>0,_=e=>function(e){let{team:t,persistedDefaultTeams:i}=e;"add-default"===Yh({team:t})?$h({team:t,persistedDefaultTeams:i}):Xh({store:t,state:"remove-default"})}({team:e,persistedDefaultTeams:w}),k=e=>{!function(e){let{team:t,persistedDefaultTeams:i}=e;"remove-default"===Yh({team:t})?$h({team:t,persistedDefaultTeams:i}):Xh({store:t,state:"add-default"})}({team:e,persistedDefaultTeams:w}),m.update((e=>({...e,showAutoCompletePopup:!1,tokenQuery:""})))},T=new Set(S.map((e=>e.store.id))),I=n.currentUser.id,P=(0,Ze.VK)((()=>I?o.filter((e=>{const t=e.getMembers(),i=e.getSettingsStore().getValue();return!!i&&((0,jt.pd)({membership:t},I)&&"open"===(0,jt.B5)(i))})):[]),[o,I]),Z=function(e){let{query:t,addedAndCurrentTeams:i,eligibleDefaultTeams:n,teamIdsToNames:a}=e;const o=new Set;for(const s of i)o.add(s.store.id);return(0,sa.ZP)(t,n,(e=>a[e.id]??""))}({query:h,addedAndCurrentTeams:b,teamIdsToNames:M,eligibleDefaultTeams:P}),x=[];Z.length>0&&!f&&x.push({key:"default-teams-list",render:e=>d.createElement(ct.Z,s()({},e,{title:a()(v.FormattedMessage,{id:"defaultTeamsInput.defaultTeamList.title",defaultMessage:"Teamspaces"}),loading:!1})),items:Z.map((e=>({key:e.id,render:t=>d.createElement(ef.F,s()({},t,{teamStore:e})),action:()=>k(e)})))});const F=(0,Ze.VK)((()=>m.state.showAutoCompletePopup&&x.length>0),[m,x.length]),E=(0,xe.yK)((e=>({defaultTeamsHeader:{fontSize:14,marginBottom:2},inputAndButtonContainer:{paddingTop:12,display:"flex"},inputContainer:{flexGrow:1},tokenInputMenu:{borderRadius:F?sf:of,margin:0},menuList:{maxHeight:300,border:`1px solid ${e.regularDividerColor}`,borderTop:0,borderRadius:rf},updateButton:{marginLeft:10,height:35}})),[F]);return d.createElement(d.Fragment,null,a()("div",{style:E.defaultTeamsHeader},void 0,a()(v.FormattedMessage,{id:"teamsWorkspaceSettings.defaultTeams.title",defaultMessage:"Default teamspaces"})),a()(Ae.Z,{isSmall:!0,isMultiline:!0},void 0,a()(v.FormattedMessage,{id:"teamsWorkspaceSettings.defaultTeams.caption",defaultMessage:"Choose teamspaces that all new and current workspace members will automatically join"})),a()("div",{style:E.inputAndButtonContainer},void 0,a()("div",{style:E.inputContainer},void 0,a()(dt.ZP,{popupType:dt.ZP.PopupType.Popup,placementToOrigin:dt.ZP.Placement.Bottom,sameWidthAsOrigin:!0,open:F,borderRadius:rf,onDismiss:()=>m.update((e=>({...e,showAutoCompletePopup:!1}))),origin:a()(tf.Z,{disabled:!r||c,style:E.tokenInputMenu,focusInitial:t.isMobile,focusAfterAnimation:!0,format:tf.Z.Format.Share,inputDivStyle:{alignItems:"center"},value:h,onChange:e=>m.update((t=>({...t,tokenQuery:e.target.value,showAutoCompletePopup:!0}))),type:"default-teams",tokens:Object.values(g).filter((e=>!T.has(e.store.id))).map((e=>a()(af,{teamStore:e.store,onClickRemove:_},e.store.id))),placeholder:i.formatMessage({id:"teamsWorkspaceSettings.defaultTeams.inputPlaceholder",defaultMessage:"Select a default teamspace..."}),onRemoveLastToken:()=>{const e=b,t=l().last(e);t&&_(t.store)},onEmptySubmit:l().identity,showBorder:!0}),render:()=>a()(rt.Z,{menuType:it.og.Popup,tokenInputHeader:!0,disableHeaderBorder:!0},void 0,a()("div",{style:E.menuList},void 0,a()(lt.Z,{type:lt.i.Vertical,initialFocus:0,sections:x})))})),a()($e.Z,{style:E.updateButton,disabled:!C||c,isLarge:!0,onClick:async()=>{if(p){u(!0);try{await async function(e){let{addedTeams:t,removedTeams:i,environment:n,spaceStore:a}=e;if(!a.isDefined())return!1;const o=a.getPermissionItems();return await Wd.lH({addedStores:t.map((e=>{let{store:t}=e;return t})),removedStores:i.map((e=>{let{store:t}=e;return t})),environment:n,spaceValue:{permissions:o},createNewTeamFlowId:void 0,from:"workspace_settings"})}({environment:n,addedTeams:y,removedTeams:S,spaceStore:p})}finally{u(!1)}}}},void 0,a()(v.FormattedMessage,{id:"teamsWorkspaceSettings.updateButton.label",defaultMessage:"Update"}))))}function af(e){window.__c={n:"DefaultTeamsToken"};const t=(0,Pe.Fy)(),{teamStore:i,onClickRemove:n}=e,{name:o}=(0,Ze.VK)((()=>({name:i.getName()})),[i]);return a()(bi.Z,{showRemoveButton:!0,isSingle:!1,format:t.isMobile?fi.l.Large:fi.l.Medium,style:{marginLeft:6},onClickRemove:()=>n(i),value:a()("div",{style:{display:"flex",alignItems:"center"}},void 0,a()(Mt.p,{disabled:!0,store:i,size:14,style:{marginRight:4}}),o)})}const of=3,sf=(0,Jh.wK)({topLeft:of,topRight:of,bottomLeft:0,bottomRight:0}),rf=(0,Jh.wK)({topLeft:0,topRight:0,bottomLeft:of,bottomRight:of});var lf=i(17224);function df(e){let{selectItems:t,currentSelectedItem:i,onChange:n,icon:o}=e;return a()(Pi.Z,{items:t,getKey:e=>e.key,selectedItem:i,onSelect:n,renderItem:e=>d.createElement(ot.Z,s()({title:e.value.name},e,{checkState:i.key===e.value.key})),renderOrigin:e=>d.createElement(at.Z,s()({},e,{title:i.originName??i.name,on:!i.showFilterAsOffWhenSelected,icon:o}))})}const cf={[Lh]:{key:Lh,name:a()(v.FormattedMessage,{id:"manageTeamsAccessFilter.accessFilter.filterAllTeams",defaultMessage:"Any"}),originName:a()(v.FormattedMessage,{id:"manageTeamsAccessFilter.accessSelectPlaceolder",defaultMessage:"Access"}),showFilterAsOffWhenSelected:!0},[Nh]:{key:Nh,name:a()(v.FormattedMessage,{id:"manageTeamsAccessFilter.accessFilter.filterOpenTeams",defaultMessage:"Open"})},[Oh]:{key:Oh,name:a()(v.FormattedMessage,{id:"manageTeamsAccessFilter.accessFilter.filterClosedTeams",defaultMessage:"Closed"})},[Vh]:{key:Vh,name:a()(v.FormattedMessage,{id:"manageTeamsAccessFilter.accessFilter.filterPrivateTeams",defaultMessage:"Private"})}},uf=l().compact([cf.filterAccessAny,cf.filterAccessOnlyOpen,cf.filterAccessOnlyClosed,cf.filterAccessOnlyPrivate]);function mf(e){let{manageTeamsStore:t}=e;window.__c={n:"ManageTeamsAccessFilter"};const i=(0,Pe.O7)(),n=(0,Ze.VK)((()=>t.state.filterAccess),[t]),o=(0,xe.yK)((e=>({keyIcon:{width:18,height:18,...n!==Lh?{fill:qn.ZP.blue}:{fill:e.mediumIconColor}}})),[n]),s=(0,d.useCallback)((e=>{t.update((t=>({...t,filterAccess:e.key}))),lf.GZ(i,{filter:"access",value:e.key})}),[t,i]),r=cf[n];return a()(df,{selectItems:uf,currentSelectedItem:r,onChange:s,icon:m.Z.key(o.keyIcon)})}const pf="showArchived",gf="hideArchived",hf={[gf]:{key:gf,name:a()(v.FormattedMessage,{id:"manageTeamsArchivedFilter.archivedFilter.hideArchivedTeams",defaultMessage:"Active"}),originName:a()(v.FormattedMessage,{id:"manageTeamsArchivedFilter.archivedSelectPlaceolder",defaultMessage:"Archived"}),showFilterAsOffWhenSelected:!0},[pf]:{key:pf,name:a()(v.FormattedMessage,{id:"manageTeamsArchivedFilter.archivedFilter.showArchivedTeams",defaultMessage:"Archived"})}};function ff(e){let{manageTeamsStore:t}=e;window.__c={n:"ManageTeamsArchivedFilter"};const i=(0,Pe.O7)(),n=(0,Ze.VK)((()=>t.state.showOnlyArchivedTeams),[t]),o=(0,xe.yK)((e=>({archiveIcon:{width:16,height:16,marginRight:5,...n?{fill:qn.ZP.blue}:{fill:e.mediumIconColor}}})),[n]),s=[hf.hideArchived,hf.showArchived],r=(0,d.useCallback)((e=>{t.update((t=>({...t,showOnlyArchivedTeams:e.key===pf}))),lf.GZ(i,{filter:"archived",value:e.key})}),[t,i]),l=hf[n?pf:gf];return a()(df,{selectItems:s,currentSelectedItem:l,onChange:r,icon:m.Z.archiveFilled(o.archiveIcon)})}const vf="ShowTeamsWithNoOwnersId";function yf(e){let{teamStores:t,manageTeamsStore:i}=e;window.__c={n:"ManageTeamsOwnerFilter"};const n=(0,Pe.O7)(),o=(0,Ze.VK)((()=>i.state.filterByOwner),[i]),r=function(e){switch(e.type){case Uh:return;case Kh:return e.id;case Wh:return vf;default:(0,x.t1)(e)}}(o),c=(0,Ze.VK)((()=>A.default.state.currentSpaceStore),[]),u=(0,v.useIntl)(),p=(0,Ze.VK)((()=>{const e=t.flatMap((e=>(0,jt.XO)({membership:e.getMembers()})));return l().uniq(e)}),[t]),g=(0,xe.yK)((e=>({icon:{marginRight:2,fill:e.mediumIconColor},blueFill:{fill:qn.ZP.blue}})),[]),h=(0,d.useCallback)((e=>{if(c)return hl({userId:e,currentSpaceStore:c}).getValue()}),[c]),f=(0,d.useCallback)((e=>{const t=e[e.length-1];let a;a=t===r||void 0===t?{type:Uh}:t===vf?{type:Wh}:{type:Kh,id:t},i.update((e=>({...e,filterByOwner:a}))),lf.GZ(n,{filter:"owner",value:a.type})}),[r,i,n]),y=(0,d.useCallback)((async e=>{let{query:t}=e;if(!c)return[];const i=(await _n.pz({query:t,currentSpaceStore:c,userIds:p})).map((e=>e.id));return""===t?[vf,...i]:i}),[c,p]),S=(0,d.useCallback)(((e,t)=>{if(!c)return null;if(e===vf)return d.createElement(ot.Z,s()({},t,{title:a()(v.FormattedMessage,{id:"manageTeamsOwnerFilter.noOwnersFilterOption",defaultMessage:"No owners"}),checkState:o.type===Wh,className:"notranslate"}));const i=h(e);return i?d.createElement(On.Z,s()({},t,{key:e,actor:(0,Ln.m3)(i),checkState:r===e})):null}),[c,h,r,o.type]),b=(0,Ze.VK)((()=>{if(o.type!==Kh)return;const e=h(o.id);return e?(0,Yt.Nz)(u,e):void 0}),[o,h,u]);let M;return M=o.type===Wh?a()(v.FormattedMessage,{id:"manageTeamsOwnerFilter.filterTitle.onlyOrphanedTeams",defaultMessage:"Owner: None"}):a()(v.FormattedMessage,b?{id:"manageTeamsOwnerFilter.filterTitle.withSpecifiedOwner",defaultMessage:"Owner: {teamOwnerName}",values:{teamOwnerName:b}}:{id:"manageTeamsOwnerFilter.filterTitle.unset",defaultMessage:"Owner"}),a()(Qi.Z,{mode:Qi.z.Pill,title:M,disabled:0===t.length,icon:m.Z.person,iconStyles:{...g.icon,...o.type!==Uh&&g.blueFill},items:l().compact([r]),hasItemsSelected:(0,x.$K)(r),onChange:f,labelText:{title:M,tokenInputPlaceholder:u.formatMessage({defaultMessage:"Search teamspace owner...",id:"manageTeamsOwnerFilter.searchOwner.placeholder"}),resultSectionTitle:u.formatMessage({defaultMessage:"Select users",id:"manageTeamsOwnerFilter.searchOwner.resultsTitle"}),componentDebugName:"ManageTeamsSearchOwnerFilter"},performRequest:y,renderResultMenuItem:S,renderToken:()=>null,renderFilter:()=>null,renderItemForSummary:()=>null,addItemLabel:null,focused:!1})}const Sf="showAll",bf="showTeamsWithSecurityOverrides",Mf={[Sf]:{key:Sf,name:a()(v.FormattedMessage,{id:"ManageTeamsSecurityOverridesFilter.showAllOption",defaultMessage:"Show all"}),originName:a()(v.FormattedMessage,{id:"ManageTeamsSecurityOverridesFilter.showAllPlaceholder",defaultMessage:"Security"}),showFilterAsOffWhenSelected:!0},[bf]:{key:bf,name:a()(v.FormattedMessage,{id:"ManageTeamsSecurityOverridesFilter.showTeamsWithSecurityOverrides",defaultMessage:"Has overrides"})}};function wf(e){let{manageTeamsStore:t}=e;window.__c={n:"ManageTeamsSecurityOverridesFilter"};const i=(0,Pe.O7)(),n=(0,Ze.VK)((()=>t.state.showTeamsWithSecurityOverrides),[t]),o=(0,xe.yK)((e=>({securityIcon:{width:14,height:14,marginRight:5,fill:e.mediumIconColor},blueFill:{fill:qn.ZP.blue}})),[]),s=[Mf.showAll,Mf[bf]],r=(0,d.useCallback)((e=>{t.setState({...t.state,showTeamsWithSecurityOverrides:e.key===bf}),lf.GZ(i,{filter:"securityOverrides",value:e.key})}),[t,i]),l=Mf[n?bf:Sf];return a()(df,{selectItems:s,currentSelectedItem:l,onChange:r,icon:m.Z.integrationSecurity({...o.securityIcon,...n&&o.blueFill})})}function Cf(e){let{manageTeamsStore:t,teamStores:i}=e;window.__c={n:"ManageTeamsFilterRow"};const n=(0,xe.yK)((()=>({container:{display:"flex",alignItems:"center",marginTop:20},searchContainer:{maxWidth:250,marginRight:"auto"},archivedTeamsSwitch:{display:"flex",alignItems:"center",marginLeft:15,marginRight:15},archivedTeamsLabel:{marginLeft:10},dropdownContainer:{display:"flex",alignContent:"stretch",marginLeft:5}})),[]),o=(0,Ze.VK)((()=>t.state.searchQuery),[t]),s=(0,d.useCallback)((e=>{t.update((t=>({...t,searchQuery:e})))}),[t]);return a()("div",{style:n.container},void 0,a()(_f,{style:n.searchContainer,onChange:s,value:o}),a()("div",{style:n.dropdownContainer},void 0,a()(ff,{manageTeamsStore:t}),a()(yf,{teamStores:i,manageTeamsStore:t}),a()(mf,{manageTeamsStore:t}),a()(wf,{manageTeamsStore:t})))}function _f(e){let{style:t,value:i,onChange:n}=e;window.__c={n:"Search"};const o=(0,v.useIntl)(),s=(0,xe.yK)((e=>({input:{boxShadow:e.inputBoxShadow,borderRadius:100,fontSize:12},searchIcon:{width:14,height:14,marginRight:6,flexGrow:0,flexShrink:0,fill:e.mediumIconColor}})),[]),r=(0,d.useCallback)((e=>n(e.target.value)),[n]);return a()(Wi.Z,{placeholder:o.formatMessage({defaultMessage:"Search teamspaces...",id:"manageTeamsFilterRow.searchFilter.placeholder"}),style:{...s.input,...t},value:i,onChange:r,left:m.Z.search(s.searchIcon),format:Wi.Z.Format.Small,showClearButton:!0})}var kf=i(12534),Tf=i(48690),If=i(92350),Pf=i(11913),Zf=i(98742),xf=i(45660),Ff=i(4657),Af=i(13380);function Ef(e){let{teamStore:t,accessLevel:i,isTeamOwner:n,onChangeAccessLevel:o,width:r}=e;window.__c={n:"ManageTeamsAccessCell"};const l=(0,Pe.O7)(),c=(0,If.vR)(t),u=(0,Ff.U)({teamStore:t,onChange:o,isDefault:c}),p=c?"default":i,g=u.find((e=>e.key===p)),h=!n||Boolean(null==g?void 0:g.disableAllOptionsTooltip),y=(null==g?void 0:g.disableAllOptionsTooltip)||h&&!n&&a()(v.FormattedMessage,{id:"manageTeamsAccessCell.onlyTeamOwnersCanChangeAccessLevel",defaultMessage:"Only teamspace owners can change teamspace access levels"}),S=(0,xf.e)(),b=(0,xe.yK)((e=>{const t=e.lightTextColor;return{selectButton:{paddingLeft:8,marginLeft:-8,maxWidth:r},label:{...h&&{color:t},fontSize:f.Z.fontSize.UIRegular.desktop,fontWeight:f.Z.fontWeight.regular},chevron:{width:10,marginLeft:4,fill:e.mediumIconColor,...h&&{fill:t}},tooltip:{width:200}}}),[h,r]);if(!g)throw new Error(`Selected access level is not an option found in team access level option: ${p}`);return a()(Pi.Z,{items:u,getKey:e=>e.key,selectedItem:g,onSelect:e=>"private"===e.key&&S?Pr.y(l,{from:"team_security_settings",for:"business"}):e.onSelect(),renderItem:e=>a()(We.Z,{textWrap:!0,style:b.tooltip,placement:ka.u.Bottom,disableTooltip:!e.value.tooltip,renderTooltip:()=>e.value.tooltip,render:t=>d.createElement(ot.Z,s()({title:e.value.title},(0,Zf.Z)(e,t)))}),disabled:h,renderOrigin:e=>a()(We.Z,{textWrap:!0,style:b.tooltip,disableTooltip:!y,renderTooltip:()=>y,alignment:ka.v.Center,placement:ka.u.Left,render:t=>d.createElement(Xe.Z,s()({style:b.selectButton,disabled:h},(0,Zf.Z)(e,t)),a()(Af.s,{style:b.label},void 0,g.level),m.Z.chevronDown(b.chevron))})})}function Bf(e){let{teamOwners:t,manageTeamsStore:i}=e;window.__c={n:"ManageTeamsOwnersCell"};const n=(0,Ze.VK)((()=>A.default.state.currentSpaceStore),[]),o=(0,v.useIntl)(),s=(0,Ze.VK)((()=>{if(!n)return;const{filterByOwner:e}=i.state;let a=t[0];if(e.type===Kh){const i=e.id;t.includes(i)&&(a=i)}return a?hl({userId:a,currentSpaceStore:n}):void 0}),[n,i,t]),r=(0,Ze.VK)((()=>{if(null!=s&&s.isDefined())return(0,Yt.Nz)(o,s.getModel())}),[s,o]),l=(0,xe.yK)((e=>({container:{display:"flex",alignItems:"center",fontSize:f.Z.fontSize.UIRegular.desktop,overflow:"hidden"},userAvatar:{paddingRight:6},nMoreOwnersText:{paddingLeft:3,color:e.mediumTextColor},noOwners:{marginRight:8,color:e.lightTextColor},userName:{flexShrink:1}})),[]);return t.length<1?a()("div",{style:l.noOwners},void 0,a()(v.FormattedMessage,{id:"manageTeamsOwnersCell.noOwners",defaultMessage:"No owners"})):a()("div",{style:l.container},void 0,a()($t.Z,{style:l.userAvatar,avatarShouldShowShadow:!0,userStore:s,size:20}),a()(Af.s,{style:l.userName},void 0,r),t.length>1&&a()("div",{style:l.nMoreOwnersText},void 0,a()(v.FormattedMessage,{id:"manageTeamsOwnersCell.nMoreOwnersLabel",defaultMessage:"+{numAdditionalOwners}",values:{numAdditionalOwners:t.length-1}})))}const Df=[xh,Fh,Eh,Bh,Dh],Rf={[Eh]:{headerTitle:a()(v.FormattedMessage,{id:"manageTeamsTable.columnTitle.access",defaultMessage:"Access"}),renderCell:e=>{let{data:t,environment:i}=e;return a()(Ef,{teamStore:t.store,accessLevel:t.accessLevel,isTeamOwner:t.isCurrentUserOwnerOfTeam,onChangeAccessLevel:(e,n)=>Wd.Ju({environment:i,store:t.store,accessLevel:e,isDefault:n,teamName:t.name,from:"manage_teams_table"}),width:90})},colWidth:{width:90},hasClickableContents:!0},[xh]:{headerTitle:a()(v.FormattedMessage,{id:"manageTeamspacesTable.columnTitle.teamspace",defaultMessage:"Teamspace"}),renderCell:e=>{let{data:t}=e;return a()(Lf,{teamStore:t.store,isArchivedTeam:t.isArchivedTeam,name:t.name})},colWidth:{minWidth:30,widthPercent:35}},[Fh]:{headerTitle:a()(v.FormattedMessage,{id:"manageTeamsTable.columnTitle.owners",defaultMessage:"Owners"}),renderCell:e=>{let{data:t,manageTeamsStore:i}=e;return a()(Bf,{teamOwners:t.owners,manageTeamsStore:i})},colWidth:{minWidth:60,widthPercent:25}},[Ah]:{headerTitle:a()(v.FormattedMessage,{id:"manageTeamsTable.columnTitle.members",defaultMessage:"Members"}),renderCell:e=>{let{data:t}=e;return a()(Af.s,{},void 0,a()(v.FormattedMessage,{id:"manageTeamsTable.numMembersCell",defaultMessage:"{numTeamMembers, plural, one {# member} other {# members}}",values:{numTeamMembers:t.members.length}}))},colWidth:{minWidth:40,widthPercent:15}},[Bh]:{headerTitle:a()(v.FormattedMessage,{id:"manageTeamsTable.columnTitle.updated",defaultMessage:"Updated"}),renderCell:e=>{let{data:t}=e;return t.lastUpdated&&a()(Nf,{lastUpdatedMillis:t.lastUpdated})},colWidth:{minWidth:50,widthPercent:15}},[Dh]:{headerTitle:void 0,renderCell:e=>{let{data:t}=e;return a()(Pf.o,{teamStore:t.store,from:"manage_teams_table"})},colWidth:{width:30},hasClickableContents:!0}};function Lf(e){let{teamStore:t,name:i,isArchivedTeam:n}=e;window.__c={n:"TeamCell"};const o=(0,Pe.O7)(),s=(0,v.useIntl)(),r=(0,If.e4)(t),c=(0,xe.yK)((e=>({container:{display:"flex",alignItems:"center",overflow:"hidden"},teamIcon:{marginRight:12},nameAndMembersContainer:{display:"flex",flexDirection:"column",minWidth:0},nameAndArchivedPillContainer:{display:"flex"},nameText:{lineHeight:"18px",fontWeight:f.Z.fontWeight.regular},smallText:{fontSize:(0,Jh.yv)(o,"UISmall"),color:e.mediumTextColor,fontWeight:f.Z.fontWeight.regular},archivedTag:{marginLeft:5}})),[o]),u=(0,Ze.VK)((()=>A.default.state.currentSpaceStore),[]),m=(0,Ze.VK)((()=>{if(!u)return;const e=(0,F.tO)({teamStore:t,spaceStore:u}).length;return(0,cc.uf)(e,"compact",s)}),[u,s,t]),p=a()(v.FormattedMessage,{id:"manageTeamsTableColumnData.numMembersLabel",defaultMessage:"{numMembers, plural, one {1 member} other {{numMembers} members}}",values:{numMembers:m}}),g=r?d.createElement(d.Fragment,null," • ",a()(v.FormattedMessage,{id:"manageTeamsTableColumnData.joinedLabel",defaultMessage:"Joined"})):void 0,h=l().compact([p,g]);return a()("div",{style:c.container},void 0,a()(Mt.p,{style:c.teamIcon,size:28,store:t,disabled:!0}),a()("div",{style:c.nameAndMembersContainer},void 0,a()("div",{style:c.nameAndArchivedPillContainer},void 0,a()(Af.s,{style:c.nameText},void 0,i),n&&a()(Nn.Z,{desktopStyle:c.archivedTag,mobileStyle:c.archivedTag},void 0,a()(v.FormattedMessage,{id:"manageTeamsTable.archivedTag",defaultMessage:"Archived"}))),a()(Af.s,{style:c.smallText},void 0,h)))}function Nf(e){let{lastUpdatedMillis:t}=e;return a()(Af.s,{},void 0,(0,Hn.Yx)(t,"very_short",_a.SP))}function Of(e){let{teamStores:t,manageTeamsStore:i}=e;window.__c={n:"ManageTeamsTable"};const n=(0,Pe.O7)(),o=(0,Ze.VK)((()=>A.default.state.currentSpaceStore),[]),s=(0,Ze.VK)((()=>A.default.state.currentUserStore),[]),{sortAscending:r,sortColumn:c}=(0,Ze.VK)((()=>{const{sortAscending:e,sortColumn:t}=i.state;return{sortAscending:e,sortColumn:t}}),[i]),u=(0,Ze.VK)((()=>{const e=null==s?void 0:s.id;return e?l().compact(t.map((t=>{if(!t.canRead()||!t.isReady())return;const i=t.getMembers(),n=(0,jt.XO)({membership:i});return{store:t,name:t.getName()??"",owners:n,isCurrentUserOwnerOfTeam:n.includes(e),members:(0,F.tO)({teamStore:t,spaceStore:o}),hasSecurityOverrides:t.hasSecurityOverrides(),accessLevel:t.getTeamAccessLevel(),isArchivedTeam:(0,jt.m4)({archived_by:t.getArchivedBy()}),lastUpdated:t.getLastEditedTime()}}))):[]}),[o,null==s?void 0:s.id,t]),m=(0,Ze.VK)((()=>{const{showOnlyArchivedTeams:e,filterByOwner:t,showTeamsWithSecurityOverrides:n,filterAccess:a}=i.state;return u.filter((t=>e?t.isArchivedTeam:!t.isArchivedTeam)).filter((e=>!n||e.hasSecurityOverrides)).filter((e=>{if(a===Nh&&"open"!==e.accessLevel)return!1;if(a===Oh&&"closed"!==e.accessLevel)return!1;if(a===Vh&&"private"!==e.accessLevel)return!1;switch(t.type){case Wh:return 0===e.owners.length;case Kh:return e.owners.includes(t.id);case Uh:return!0;default:(0,x.t1)(t)}}))}),[i,u]),p=(0,Ze.VK)((()=>{const{sortAscending:e,sortColumn:t}=i.state;return function(e){let{data:t,sortColumn:i,sortAscending:n}=e;const a=[n?"asc":"desc"],o=[n?"desc":"asc"];switch(i){case xh:return l().orderBy(t,(e=>e.name),o);case Ah:return l().orderBy(t,(e=>e.members.length),a);case Eh:return l().orderBy(t,(e=>yt.bx.indexOf(e.accessLevel)),a);case Bh:return l().orderBy(t,(e=>e.lastUpdated),a);default:(0,x.t1)(i)}}({data:m,sortAscending:e,sortColumn:t})}),[i,m]),g=(0,Ze.VK)((()=>(0,sa.ZP)(i.state.searchQuery,p,(e=>e.name))),[i,p]),h=(0,d.useCallback)((e=>Wd.RF({environment:n,teamId:e,tab:Tf.a.Members,from:"manage_teams_table"})),[n]),f=(0,xe.yK)((e=>({container:{marginTop:17,tableLayout:"fixed",borderCollapse:"collapse",width:"100%",minWidth:Df.reduce(((e,t)=>e+Hf(Rf[t].colWidth)+Gf),0)},tableHeaderRow:{borderTop:`1px solid ${e.tableDividerColor}`,borderBottom:`1px solid ${e.tableDividerColor}`},noTeamsLabel:{marginTop:15,marginBottom:40,textAlign:"center"}})),[]),v=(0,d.useCallback)((e=>{const{sortColumn:t,sortAscending:a}=i.state,o=e===t&&!a;i.setState({...i.state,sortAscending:o,sortColumn:e}),lf.dw(n,{sortBy:e,sortOrder:a?"ascending":"descending"})}),[i,n]),y=(0,d.useCallback)((()=>{i.reset()}),[i]);return d.createElement(d.Fragment,null,a()("table",{style:f.container},void 0,a()("tr",{style:f.tableHeaderRow},void 0,Df.map((e=>a()(Uf,{column:e,onSortableColumnClick:v,sortAscending:r,sortColumn:c},`header_${e}`)))),a()("tr",{},void 0,Df.map((e=>a()("td",{},`padding_row_${e}`)))),g.map((e=>a()(Vf,{onShowTeamSettings:h,teamData:e,manageTeamsStore:i},`${e.store.id}_row`)))),a()(Kf,{style:f.noTeamsLabel,numItemsAfterFilter:g.length,numItemsBeforeFilter:t.length,onResetFilters:y}))}function Vf(e){let{teamData:t,manageTeamsStore:i,onShowTeamSettings:n}=e;window.__c={n:"TeamRow"};const[o,s]=(0,d.useState)(!1),r=(0,d.useCallback)((()=>s(!0)),[]),l=(0,d.useCallback)((()=>s(!1)),[]),c=(0,d.useCallback)((e=>{zf(e,(()=>n(t.store.id)))}),[n,t.store.id]),u=(0,xe.yK)((e=>({teamRow:{cursor:"pointer",borderBottom:`1px solid ${e.tableDividerColor}`}})),[]);return a()("tr",{onMouseLeave:l,onMouseEnter:r,style:u.teamRow,onClick:c},void 0,Df.map((e=>a()(Wf,{isRowHovered:o,teamData:t,columnData:Rf[e],manageTeamsStore:i},`${t.store.id}_${e}`))))}function Uf(e){let{column:t,onSortableColumnClick:i,sortColumn:n,sortAscending:o}=e;window.__c={n:"HeaderCell"};const s=Rf[t],r=(0,xe.yK)((e=>({th:jf(s),innerDiv:{display:"flex",alignItems:"center",minWidth:Hf(s.colWidth),height:32},text:{fontSize:f.Z.fontSize.UISmall.desktop,fontWeight:f.Z.fontWeight.regular,color:e.mediumTextColor},sortButton:{padding:5,margin:-5,overflow:"hidden",maxWidth:"100%"},sortIcon:{fill:e.mediumTextColor,width:12,height:12,marginLeft:4}})),[s]),l=a()(Af.s,{style:r.text},void 0,s.headerTitle),d=(c=t,Rh.includes(c)?a()(Xe.Z,{style:r.sortButton,onClick:()=>i(t)},void 0,l,(()=>{if(t===n)return m.Z.arrowDownSmall({...r.sortIcon,...o&&{transform:"rotate(180deg)"}})})()):l);var c;return a()("th",{style:r.th},void 0,a()("div",{style:r.innerDiv},void 0,d))}function Wf(e){let{teamData:t,columnData:i,isRowHovered:n,manageTeamsStore:o}=e;window.__c={n:"Cell"};const s=(0,Pe.O7)(),r=(0,xe.yK)((e=>({td:{...jf(i),...n&&{background:e.buttonHoveredBackground}},innerDiv:{minWidth:Hf(i.colWidth),fontSize:f.Z.fontSize.UIRegular.desktop,color:e.regularTextColor,height:56,display:"flex",alignItems:"center"}})),[i,n]),l=zf,d=Boolean(i.hasClickableContents);return a()("td",{style:r.td},void 0,a()("div",{style:r.innerDiv,onClick:d?l:void 0},void 0,i.renderCell({environment:s,data:t,manageTeamsStore:o})))}function Kf(e){let{style:t,numItemsBeforeFilter:i,numItemsAfterFilter:n,onResetFilters:o}=e;const s=0!==i;if(0!==n)return null;let r;return r=a()(v.FormattedMessage,s?{id:"manageTeamsTable.emptyManageTeamTableDisclaimer.teamsFilteredOut",defaultMessage:"Could not find any teamspaces. <linkbutton>Reset your filters</linkbutton>",values:{linkbutton:e=>a()(Jo.Z,{onClick:o},void 0,e)}}:{id:"manageTeamsTable.emptyManageTeamTableDisclaimer.noTeamsExist",defaultMessage:"Could not find any teamspaces."}),a()(Ae.Z,{isSmall:!0,style:t},void 0,r)}function zf(e,t){(0,kf.ZP)({event:e,context:kf.Af.ManageTeamsRowClick,callback:t})}const Gf=10,qf={paddingLeft:Gf/2,paddingRight:Gf/2};function Hf(e){return"minWidth"in e?e.minWidth:e.width}function jf(e){let t={};return t="width"in e.colWidth?{width:e.colWidth.width}:{width:`${e.colWidth.widthPercent}%`,minWidth:e.colWidth.minWidth},{...qf,...t}}function Qf(e){let{}=e;window.__c={n:"ManageTeamsBrowser"};const{isMobile:t=!1}=(0,Pe.Fy)(),i=(0,Pe.O7)(),n=(0,Ze.qz)(Gh),o=(0,xe.yK)((()=>({container:{marginTop:8},header:{display:"flex",justifyContent:"space-between",alignItems:"center"},subheader:{display:"flex",flexDirection:"column"}})),[]),{unarchivedTeamIds:s,archivedTeamIds:r,isLoading:l}=(0,Ze.VK)((()=>{const e=R.state;return"loaded"!==e.loadingState?{unarchivedTeamIds:[],archivedTeamIds:[],isLoading:!0}:{unarchivedTeamIds:e.unarchivedTeamIds,archivedTeamIds:e.archivedTeamIds,isLoading:!1}}),[]),c=(0,Ze.VK)((()=>l?[]:qh({environment:i,teamIds:[...s,...r]})),[r,i,l,s]),u=(0,d.useCallback)((()=>Wd.lo("workspace_settings")),[]);return a()("div",{style:o.container},void 0,a()(Be.Z,{large:!t,style:o.header,small:!0},void 0,a()("div",{style:o.subheader},void 0,a()(v.FormattedMessage,{id:"manageTeamsBrowser.title",defaultMessage:"Manage teamspaces"}),a()(Ae.Z,{isSmall:!0,style:{marginTop:3}},void 0,a()(v.FormattedMessage,{id:"manageTeamsBrowser.subtitle",defaultMessage:"Manage all teamspaces you have access here"}))),a()($e.Z,{onClick:u,isLarge:!0,className:W.myM},void 0,a()(v.FormattedMessage,{id:"manageTeamsBrowser.newTeamButton.text",defaultMessage:"New teamspace"}))),l?a()(Ve.Z,{}):d.createElement(d.Fragment,null,a()(Cf,{teamStores:c,manageTeamsStore:n}),a()(Of,{teamStores:c,manageTeamsStore:n})))}var Yf=i(44615),$f=i(2688);function Xf(){window.__c={n:"ManageTeamsListener"};const e=(0,Pe.O7)(),{currentSpaceStore:t,currentUserStore:i}=(0,Ze.VK)((()=>{const{currentSpaceStore:e,currentUserStore:t}=A.default.state;return{currentSpaceStore:e,currentUserStore:t}}),[]);return(0,d.useEffect)((()=>{if("loading"===R.state.loadingState||!t||!i)return;const n=$f.Z.addListener((0,Yf.pD)({userId:i.id,spaceId:t.id}),((t,i)=>{L({environment:e,messageStoreEmitValue:i})}),void 0,e);return function(){n&&$f.Z.removeListener(n,e)}}),[t,i,e]),null}const Jf=d.memo(Xf);function ev(e){let{title:t,description:i,disabled:n=!1,selected:o,onChange:s=(()=>{})}=e;return a()("div",{style:{display:"flex",alignItems:"center",cursor:"pointer"},onClick:()=>!n&&s(!o)},void 0,a()("div",{style:{fontSize:14,marginRight:8,flexGrow:1}},void 0,t,i&&a()(Ae.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"80%"}},void 0,i)),a()("div",{style:{marginTop:5}},void 0,a()(dr.Z,{on:o,disabled:n})))}function tv(){window.__c={n:"Header"};const e=(0,Pe.Fy)();return a()(Be.Z,{large:!e.isMobile||void 0,divider:e.isMobile?void 0:"full"},void 0,a()(v.FormattedMessage,{id:"teamsWorkspaceSettings.title",defaultMessage:"Teamspace settings"}))}function iv(){window.__c={n:"TeamSecuritySettings"};const e=(0,Pe.O7)(),t=(0,Ze.VK)((()=>A.default.state.currentSpaceStore),[]),i=(0,Ze.qz)(void 0,me.Z),n=(0,Ze.VK)((()=>t&&i.getValueForSpace(t)),[t,i]),o=(0,Ze.VK)((()=>(0,K.F$)()),[]),s=(null==n?void 0:n.disableTeamCreation)??!1,r=(null==n?void 0:n.disableTeamGuests)??!1,l=void 0===n,c=(0,d.useCallback)((()=>{t&&n&&async function(e){let{newSettingValue:t,environment:i,workspaceSecuritySettings:n,spaceStore:o}=e;const s=a()(v.FormattedMessage,"allowTeamCreation"===t?{id:"manageTeamsHelpers.confirmChangeSecuritySetting.allowTeamCreation",defaultMessage:"Are you sure you want allow all members of this workspace to create teams?"}:{id:"manageTeamsHelpers.confirmChangeSecuritySetting.workspaceOwners.disableTeamCreation",defaultMessage:"Are you sure you want to limit teamspace creation to only workspace owners?"});!!(await M.confirmUserAction({message:s}))&&Jc.n(i,{securitySettingsState:{...n,disableTeamCreation:"disableTeamCreation"===t},spaceStore:o})}({newSettingValue:s?"allowTeamCreation":"disableTeamCreation",environment:e,spaceStore:t,workspaceSecuritySettings:n})}),[t,s,e,n]);return d.createElement(d.Fragment,null,a()(Xo.Z,{size:34}),a()(ev,{disabled:l,onChange:c,title:a()(v.FormattedMessage,{id:"teamWorkspacesSettings.disableTeamCreation.workspaceOwners.title",defaultMessage:"Limit teamspace creation to only workspace owners"}),description:a()(v.FormattedMessage,{id:"teamWorkspacesSettings.disableTeamCreation.workspaceOwners.caption",defaultMessage:"Only allow workspace owners to create teamspaces"}),selected:s}),a()(Xo.Z,{size:34}),o&&d.createElement(d.Fragment,null,a()(ev,{disabled:l,onChange:async function(){if(t&&n){if(!Boolean(n.disableTeamGuests)){if(!(await M.confirmUserAction({message:a()(v.FormattedMessage,{id:"teamWorkspacesSettings.disableTeamGuests.confirmDisable.message",defaultMessage:"Are you sure you want to disable teamspace guests?"}),description:a()(v.FormattedMessage,{id:"teamWorkspacesSettings.disableTeamGuests.confirmDisable.description",defaultMessage:"This action will remove all teamspace guests from the workspace."}),acceptLabel:a()(v.FormattedMessage,{id:"teamWorkspacesSettings.disableTeamGuests.confirmDisable.acceptButton",defaultMessage:"Disable and remove teamspace guests"})})))return}Jc.n(e,{securitySettingsState:{...n,disableTeamGuests:!n.disableTeamGuests},spaceStore:t})}},title:a()(v.FormattedMessage,{id:"teamWorkspacesSettings.disableTeamGuests.workspaceOwners.title",defaultMessage:"Allow teamspace owners to add teamspace guests"}),description:a()(v.FormattedMessage,{id:"teamWorkspacesSettings.disableTeamGuests.workspaceOwners.caption",defaultMessage:"This will allow teamspace owners with membership admin permissions to add teamspace guests. Disabling will remove all teamspace guests."}),selected:!r}),a()(Xo.Z,{size:34})))}function nv(e){let{}=e;window.__c={n:"TeamsWorkspaceSettings"};const t=(0,xe.yK)((()=>({learnMoreLinkContainer:{paddingTop:6,paddingBottom:20}})),[]);return a()(Ee.Z,{},void 0,a()(tv,{}),a()(Hh.Z,{helpCenterLocation:"settingsAndPermissions",analyticsFrom:"teams_learn_more_workspace_settings",containerStyle:t.learnMoreLinkContainer}),a()(nf,{}),a()(iv,{}),a()(Qf,{}),a()(Jf,{}))}var av=i(47292),ov=i(3924),sv=i(66836),rv=i(75493),lv=i(2832),dv=i(73966);function cv(e){let{isMobile:t}=e;window.__c={n:"ManualUpdateTimezoneSetting"};const i=(0,Pe.O7)(),n=z.default.getIntl(),o=(0,Ze.VK)((()=>A.default.state.currentUserSettingsStore),[]),{currentTimeZone:s,auto_update_disabled:r}=(0,Ze.VK)((()=>{const e=null==o?void 0:o.getSettings();return{currentTimeZone:null==e?void 0:e.time_zone,auto_update_disabled:null==e?void 0:e.disable_auto_set_timezone}}),[o]),l=(0,Ze.VK)((()=>lv.S.map((e=>({key:e,label:(0,rv.Z)(n,e)})))),[n]);return(o&&a()(es.Z,{isMobile:t,disabled:!r,title:a()(v.FormattedMessage,{id:"dateAndTimeSettings.timeZone.title",defaultMessage:"Time Zone"}),caption:a()(v.FormattedMessage,{id:"dateAndTimeSettings.timeZone.caption",defaultMessage:"Current time zone setting."}),type:"dropdown",currentOption:s??"error_fetch_timezone",options:l,onSelectOption:e=>{dv.l6({environment:i,userSettingsStore:o,timeZone:e})}}))??null}function uv(e){let{isMobile:t}=e;window.__c={n:"AutoUpdateTimezoneSetting"};const i=(0,Pe.O7)(),n=(0,Ze.VK)((()=>A.default.state.currentUserSettingsStore),[]),o=(0,Ze.VK)((()=>{var e;return null==n||null===(e=n.getSettings())||void 0===e?void 0:e.disable_auto_set_timezone}),[n])??!1,s=(0,d.useCallback)((e=>{const t=!o;dv.k2({environment:i,userSettingsStore:e,disableAutoSetTimezone:t}),t||dv.wk({environment:i,userSettingsStore:e})}),[i,o]),r=a()(v.FormattedMessage,{id:"dateAndTimeSettings.autoTimeZone.title",defaultMessage:"Set timezone automatically using your location"}),l=a()(v.FormattedMessage,{id:"dateAndTimeSettings.autoTimeZone.caption",defaultMessage:"Reminders, notifications and emails are delivered based on your time zone."});return(n&&a()(es.Z,{isMobile:t,title:r,caption:l,type:"toggle",isOn:!o,onToggle:()=>s(n)}))??null}var mv=i(79331),pv=i(16347);const gv=(0,ov.M)((function(e){let{passwordRequestStore:t,userEmailDomainSettings:i}=e;window.__c={n:"UserSettings"};const{isPhone:n,isIOS:o,isMobile:s}=(0,Pe.Fy)(),r=(0,Pe.O7)(),l=(0,Ze.VK)((()=>Fe.Z.state.online),[]),c=(0,Ze.VK)((()=>s&&t?(0,mv.E)({isPhone:n,isIOS:o,passwordRequestStore:t,userEmailDomainSettings:i}):(0,mv.Z)({environment:r})),[r,s,n,o,t,i]),u=(0,Ze.VK)((()=>k.default.checkGate("update_user_setting_timezone_enabled")),[]),m=[u?{key:"timezone-auto",renderSettingsItem:()=>a()(uv,{isMobile:s})}:void 0,u?{key:"timezone-manual",renderSettingsItem:()=>a()(cv,{isMobile:s})}:void 0].filter(x.$K),p=[(0,Ze.VK)((()=>(0,sv.h)(r)),[r])?{key:"cookies",renderSettingsItem:()=>a()(sv.Z,{isMobile:s})}:void 0,{key:"view-history",renderSettingsItem:()=>a()(pv.H,{isMobile:s})}].filter(x.$K);return l?a()(Ee.Z,{disableScroller:s},void 0,a()(Be.Z,{large:!s,divider:"full"},void 0,a()(v.FormattedMessage,{id:"mySettings.settingsSection.title",defaultMessage:"My settings"})),a()(Yc.O,{items:c}),u&&d.createElement(d.Fragment,null,a()(Xo.Z,{size:48,isHidden:!0}),a()(Be.Z,{large:!s,divider:"full"},void 0,a()(v.FormattedMessage,{id:"notificationAndPersonalSettings.dateAndTimeSection.title",defaultMessage:"Date & time"})),a()(Yc.O,{items:m})),a()(Xo.Z,{size:48,isHidden:!0}),a()(Be.Z,{large:!s,divider:"full"},void 0,a()(v.FormattedMessage,{id:"mySettings.privacySection.title",defaultMessage:"Privacy"})),a()(Yc.O,{items:p})):a()(Ee.Z,{},void 0,a()(Ae.Z,{isSmall:!0,style:{textAlign:"center"}},void 0,a()(v.FormattedMessage,{defaultMessage:"Please go online to manage settings.",id:"mySettings.goOnline.prompt"})))})),hv=(0,v.defineMessages)({dialogLabel:{id:"spaceSettings.dialogLabel",defaultMessage:"Settings & members"}});class fv extends c.Z{constructor(){super(...arguments),this.lastSpaceSettingsStoreState=void 0,this.lastSpaceSettingsModalStoreOpen=!1,this.storeTypes={spaceBasicSettingsStore:Se,spaceProfileSettingsStore:Ce,securitySettingsStore:me.Z,samlSettingsStore:ue,spaceDomainSettingsStore:Me},this.renderContent=()=>{const e={profile:this.renderProfile,notifications_and_settings:this.renderNotificationsAndSettings,user_settings:this.renderMySettings,notifications:this.renderMyNotifications,language_and_region:this.renderLanguageAndRegion,connected_apps:this.renderConnectedApps,debug_zone:this.renderDebugZone,settings:this.renderSettings,teams:this.renderTeamsSettings,members:this.renderMembers,analytics:this.renderAnalytics,plans:this.renderPlans,billing:this.renderBilling,subscription:this.renderSubscription,security:this.renderSecurity,identity_provisioning:this.renderIdentityProvisioning,admin_content_search:this.renderAdminContentSearch,integrations:this.renderIntegrations,experiments:this.renderExperiments,audit_log:this.renderAuditLog,imports:this.renderImports};return a()(ds.Z,{capture:!0,allowEsc:!0,render:t=>a()(cs.Z,{capture:!0,ignoreBlockSelection:!0,restoreSelection:!0,focusOffscreenInput:!1,render:()=>d.createElement(ru,s()({sidebar:this.renderSidebar()},t),e[_e.Z.state.currentTab]())})})},this.renderTabDot=e=>{const{currentSpaceStore:t}=A.default.state;return"members"===e&&this.environment.device.isDesktop&&null!=t&&t.canEditMembership()&&(0,K.p1)()&&Te.Z.state.count>0?a()(zd.z,{color:this.theme.redBadgeBackground}):null},this.renderProfile=()=>a()(tg,{isEducationPlan:j.wl(ke.default.state.data),spaceProfileSettingsStore:this.stores.spaceProfileSettingsStore}),this.renderNotificationsAndSettings=()=>a()(Hc.Z,{isMobile:!1}),this.renderLanguageAndRegion=()=>a()(qc,{}),this.renderSettings=()=>a()(Jm,{spaceStore:this.props.spaceStore,spaceBasicSettingsStore:this.stores.spaceBasicSettingsStore,securitySettingsStore:this.stores.securitySettingsStore}),this.renderMySettings=()=>a()(gv,{}),this.renderMyNotifications=()=>a()(Xc,{}),this.renderTeamsSettings=()=>a()(nv,{}),this.renderMembers=()=>a()(ep.Z,{store:this.props.spaceStore,unreadAccessRequests:Te.Z.state.count}),this.shouldRenderAnalyticsTab=()=>{var e;const{device:t}=this.environment;return!t.isMobile&&"enterprise"===(null===(e=this.props.spaceStore)||void 0===e?void 0:e.getSubscriptionTier())},this.shouldRenderAdminContentSearchTab=()=>{const{device:e,currentUser:t}=this.environment,{spaceStore:i}=this.props,n=i.getModel();return k.default.checkGate("admin_content_search_tab")&&!e.isMobile&&t.id&&n&&(0,u.H)({spaceModel:n,userId:t.id})},this.renderAnalytics=()=>{const{spaceStore:e}=this.props;return this.shouldRenderAnalyticsTab()?a()(km,{spaceStore:e}):null},this.renderPlans=()=>{const{data:e}=ke.default.state,{data:t}=Ie.Z.state;if(e)return a()(Ih,{spaceStore:this.props.spaceStore,upcomingInvoiceData:t,securitySettingsStore:this.stores.securitySettingsStore,data:e})},this.renderBilling=()=>{const{data:e}=ke.default.state,{data:t}=Ie.Z.state;if(!e)return null;const i="unsubscribed_admin"===e.type&&e.customerData&&(0,h.E3)(e.customerData.stripe.addOns);if("subscribed_admin"===e.type||i){var n;const i=null===(n=e.customerData)||void 0===n?void 0:n.stripe;return i?a()(th,{spaceStore:this.props.spaceStore,subscriptionData:e,upcomingInvoiceData:t,customerData:i}):null}return e&&"unsubscribed_admin"===e.type?a()(nh,{spaceStore:this.props.spaceStore,data:e}):void 0},this.renderExperiments=()=>a()(Ee.Z,{},void 0,a()(ms.Ub,{})),this.shouldRenderMembersPrompt=()=>{var e,t;const{currentSpaceViewStore:i,currentSpaceStore:n,currentUserStore:a}=A.default.state;if(null==a||!a.id)return!1;if(null==n||!n.isDefined())return!1;if(!(0,Q.wP)()||!(0,g.wv)({permissions:n.getPermissionItems()},a.id)||!(0,q.U7)())return!1;const o=null==i?void 0:i.getSettings();return"dismissed"!==(null==o||null===(e=o.enterprise_settings_prompt)||void 0===e?void 0:e.status)&&"hidden"!==(null==o||null===(t=o.enterprise_settings_prompt)||void 0===t?void 0:t.status)&&(P.W7(this.environment),!0)},this.shouldRenderDomainClaimPrompt=()=>{var e,t;const{currentSpaceViewStore:i,currentSpaceStore:n,currentUserStore:a}=A.default.state;if(null==a||!a.id)return!1;if(null==n||!n.isDefined())return!1;if(!(0,Q.wP)()||!(0,g.wv)({permissions:n.getPermissionItems()},a.id))return!1;const o=null==i?void 0:i.getSettings();return"dismissed"!==(null==o||null===(e=o.domain_claim_settings_prompt)||void 0===e?void 0:e.status)&&"hidden"!==(null==o||null===(t=o.domain_claim_settings_prompt)||void 0===t?void 0:t.status)&&(P.cm(this.environment),!0)},this.shouldRenderAnalyticsPrompt=()=>{var e,t;const{currentSpaceViewStore:i,currentSpaceStore:n,currentUserStore:a}=A.default.state;if(!this.shouldRenderAnalyticsTab())return!1;if(null==a||!a.id)return!1;if(null==n||!n.isDefined())return!1;const o=null==i?void 0:i.getSettings();return"dismissed"!==(null==o||null===(e=o.space_analytics_settings_prompt)||void 0===e?void 0:e.status)&&"hidden"!==(null==o||null===(t=o.space_analytics_settings_prompt)||void 0===t?void 0:t.status)&&(P.lo(this.environment),!0)},this.shouldRenderMfaPrompt=()=>{var e,t;const{currentSpaceViewStore:i,currentSpaceStore:n,currentUserStore:a}=A.default.state;if(null==a||!a.id)return!1;if(null==n||!n.isDefined())return!1;const o=null==i?void 0:i.getSettings();return"dismissed"!==(null==o||null===(e=o.mfa_settings_prompt)||void 0===e?void 0:e.status)&&"hidden"!==(null==o||null===(t=o.mfa_settings_prompt)||void 0===t?void 0:t.status)&&("off"===this.stores.spaceProfileSettingsStore.state.accountSettings.mfaStatus&&(P.GZ(this.environment),!0))},this.shouldRenderAuditLog=()=>{const{device:e}=this.environment;return!e.isMobile&&(0,Q.wP)()&&this.props.spaceStore.canAdmin()},this.renderAuditLog=()=>this.shouldRenderAuditLog()?d.createElement(d.Fragment,null,a()(Ee.Z,{},void 0,a()(_o,{spaceStore:this.props.spaceStore}))):null,this.renderSubscription=()=>a()(Ee.Z,{},void 0,a()(Zh.Z,{})),this.renderImports=()=>a()(Ee.Z,{},void 0,a()(Xd,{})),this.renderConnectedApps=()=>a()(av.Z,{location:"settings-page"}),this.renderDebugZone=()=>a()(rg,{store:this.props.spaceStore}),this.renderSecurity=()=>a()(nu,{spaceStore:this.props.spaceStore,securitySettingsStore:this.stores.securitySettingsStore,userStore:this.props.userStore}),this.renderIdentityProvisioning=()=>a()(Td,{spaceStore:this.props.spaceStore,samlConfigStore:this.stores.samlSettingsStore,domainSettingsStore:this.stores.spaceDomainSettingsStore,userStore:this.props.userStore}),this.renderAdminContentSearch=()=>a()(wn,{spaceStore:this.props.spaceStore,userStore:this.props.userStore}),this.renderIntegrations=()=>a()(ls,{spaceStore:this.props.spaceStore,userStore:this.props.userStore}),this.renderNewFeaturePrompt=()=>{if(this.shouldRenderAnalyticsPrompt()){const{currentSpaceStore:e}=A.default.state,t=null!=e&&e.canAdmin()?a()(v.FormattedMessage,{id:"enterpriseSpaceAnalyticsSettingsPrompt.caption.workspaceOwner",defaultMessage:"Explore how members & guests are engaging with this workspace, common searches that are made, and content engagement metrics with workspace analytics."}):a()(v.FormattedMessage,{id:"enterpriseSpaceAnalyticsSettingsPrompt.caption.member",defaultMessage:"See how your content is performing by reviewing metrics like number of views or unique visitors using workspace analytics."});return a()(ou,{onDismiss:()=>P.TY(this.environment),onClick:()=>{this.attemptCloseCurrentTab((()=>{_e.Z.setState({..._e.Z.state,currentTab:"analytics",defaultSubtab:void 0}),this.stores.spaceDomainSettingsStore.reset(),b.XI1(this.environment,{tab:"analytics"}),P.pE(this.environment)}))},onView:t=>{"enterprise"===(null==e?void 0:e.getSubscriptionTier())&&P.pE(t)},onClickLearnMore:()=>{const e=(0,H.UY)("guides.workspaceAnalytics");w.navigateToExternalURL({environment:this.environment,url:e})},descriptionMessage:t,title:a()(v.FormattedMessage,{id:"enterpriseSpaceAnalyticsSettingsPrompt.title",defaultMessage:"New workspace analytics"}),buttonText:a()(v.FormattedMessage,{id:"enterpriseSpaceAnalyticsSettingsPrompt.cta",defaultMessage:"View metrics"}),icon:m.Z.magnifyingGlass(this.getSettingsPromptIconStyle())})}if(this.shouldRenderMfaPrompt())return a()(ou,{onClick:()=>{this.attemptCloseCurrentTab((()=>{_e.Z.setState({..._e.Z.state,open:!0,currentTab:"profile",defaultSubtab:void 0,highlightedSetting:_e.R.TwoStepVerification}),b.XI1(this.environment,{tab:"profile"})}))},onView:P.E6,onDismiss:()=>P.ZJ(this.environment),onClickLearnMore:()=>{const e=(0,H.UY)("guides.mfa");w.navigateToExternalURL({environment:this.environment,url:e})},descriptionMessage:a()(v.FormattedMessage,{id:"mfaSettingsPrompt.description",defaultMessage:"2-step verification, also known as 2FA or MFA, is now available. Add a secondary method of verification used during login."}),title:a()(v.FormattedMessage,{id:"mfaSettingsPrompt.title",defaultMessage:"Add an extra layer of security to your account."}),buttonText:a()(v.FormattedMessage,{id:"mfaSettingsPrompt.button.label",defaultMessage:"Enable 2-step verification"}),icon:m.Z.lockedFilled(this.getSettingsPromptIconStyle())})},this.handleModalOpen=()=>{Z.bi(this.environment),this.resetAuditLogSetting(),y.kj({environment:this.environment,spaceId:this.props.spaceStore.id,canAdmin:this.props.spaceStore.canAdmin()})},this.handleModalDismiss=()=>this.attemptCloseCurrentTab((()=>{_e.Z.setState({..._e.Z.state,open:!1}),ge.reset(),this.stores.spaceDomainSettingsStore.reset(),this.resetAuditLogSetting(),Te.Z.reset()}))}async willMount(e){super.willMount(e);const{spaceStore:t}=this.props,{securitySettingsStore:i}=this.stores,n=i.getValueForSpace(t);n&&i.setState(n),await I(this.environment,this.stores.spaceProfileSettingsStore)}willMountOrUpdate(e){super.willMountOrUpdate(e);const{open:t}=_e.Z.state,i=_e.Z.state;this.lastSpaceSettingsModalStoreOpen===t&&l().isEqual(this.lastSpaceSettingsStoreState,i)||t&&b.SUq(this.environment,{tab:i.currentTab,from:i.openedFrom}),this.lastSpaceSettingsModalStoreOpen=t,this.lastSpaceSettingsStoreState=l().clone(i)}renderComponent(){const{open:e}=_e.Z.state;return a()(us.Z,{ariaLabel:z.default.formatMessage(hv.dialogLabel),open:e,innerStyle:{width:1150,maxWidth:"calc(100vw - 100px)",height:"calc(100vh - 100px)",overflow:"hidden",borderRadius:5,maxHeight:715},onOpen:this.handleModalOpen,onDismiss:this.handleModalDismiss,render:this.renderContent,className:W.zYS})}renderSidebar(){const{spaceStore:e}=this.props,{data:t}=ke.default.state,i=j.wY(t),n=(0,ms.mS)(),o=og().length>0,s=e.canAdmin();return a()("div",{style:fv.sidebarStyle},void 0,a()("div",{style:fv.sidebarTabsStyle},void 0,a()("div",{},void 0,a()("div",{style:this.getSidebarHeader()},void 0,a()(v.FormattedMessage,{id:"spaceSettings.sidebar.personalSettingsSection.title",defaultMessage:"Account"})),this.renderUserDetails(),this.renderTabButton("profile"),(0,G.rB)()?d.createElement(d.Fragment,null,this.renderTabButton("user_settings"),this.renderTabButton("notifications")):d.createElement(d.Fragment,null,this.renderTabButton("notifications_and_settings")),this.renderTabButton("connected_apps"),this.renderTabButton("language_and_region"),o&&this.renderTabButton("debug_zone"),a()(Xo.Z,{size:18,isHidden:!0}),a()("div",{style:this.getSidebarHeader()},void 0,a()(v.FormattedMessage,{id:"spaceSettings.sidebar.workspaceSettingsSection.title",defaultMessage:"Workspace"})),this.renderTabButton("settings"),e.canAdmin()&&(0,F.bq)()&&this.renderTabButton("teams"),e.canRead()&&this.renderTabButton("members"),this.shouldRenderAnalyticsTab()&&this.renderTabButton("analytics"),e.canRead()&&this.renderTabButton("plans"),this.shouldRenderBillingTab(i)&&this.renderTabButton("billing"),i&&this.renderTabButton("subscription"),e.canAdmin()&&this.renderTabButton("security"),e.canAdmin()&&this.renderTabButton("identity_provisioning"),this.shouldRenderAdminContentSearchTab()&&this.renderTabButton("admin_content_search"),s&&this.renderTabButton("integrations"),(0,U.c)()&&!this.environment.device.isMobile&&a()("span",{onClick:()=>{const e=(0,p.ZP)();de.Z.setState({flowId:e}),b.Syn(this.environment,{from:"settings",flowId:e})}},void 0,this.renderTabButton("imports")),this.shouldRenderAuditLog()&&this.renderTabButton("audit_log"),n&&this.renderTabButton("experiments"),e.canRead()&&a()(ko.Z,{source:"settings"}),e.canRead()&&!(0,h.E3)(null==t?void 0:t.addOns)&&a()(Ph.Z,{source:"settings"}))),this.renderNewFeaturePrompt())}renderUserDetails(){const e=(0,V.B7)(this.environment),t={size:20,hasTooltip:!0,avatarShouldShowShadow:!0,userStore:e};return a()("div",{style:{display:"flex",alignItems:"center",height:44,paddingLeft:12,paddingRight:12}},void 0,a()("div",{style:this.getIconWrapStyle()},void 0,d.createElement($t.Z,t)),e?a()("div",{},void 0,this.renderUserName(e),e.getEmail()&&a()(Ae.Z,{isSmall:!0},void 0,e.getEmail())):a()(v.FormattedMessage,{id:"spaceSettings.sidebar.personalSettingsSection.userDetails.title",defaultMessage:"Me"}))}renderUserName(e){const t=z.default.getIntl(),i=e.getFullName(t);return i&&a()(Ae.Z,{style:{fontWeight:f.Z.fontWeight.medium}},void 0,i)}renderTabButton(e){const t=_e.Z.state.currentTab===e,i=cg[e](this.environment),n=ug[e](),o=mg[e]();return a()(Ii.Z,{hovered:t,style:{display:"flex",alignItems:"center",justifyContent:"space-between",paddingLeft:12,paddingRight:12,borderRadius:3,marginTop:1,marginBottom:1,minHeight:27},onClick:i=>{t||this.attemptCloseCurrentTab((()=>{_e.Z.setState({..._e.Z.state,currentTab:e,defaultSubtab:void 0}),this.stores.spaceDomainSettingsStore.reset(),b.XI1(this.environment,{tab:e})}))}},void 0,a()("div",{style:{display:"flex",alignItems:"center",...t&&{fontWeight:f.Z.fontWeight.semibold}}},void 0,a()("div",{style:this.getIconWrapStyle()},void 0,i),a()(Ae.Z,{isMultiline:!0},void 0,n),o),this.renderTabDot(e))}shouldRenderBillingTab(e){var t;const{spaceStore:i}=this.props,{data:n}=ke.default.state;return!(!n||e||!i.canAdmin())&&("subscribed_admin"===n.type||(!("unsubscribed_admin"!==n.type||!(0,h.E3)(null===(t=n.customerData)||void 0===t?void 0:t.stripe.addOns))||!!(0,j.MM)(n)))}async attemptCloseCurrentTab(e){const{spaceStore:t}=this.props,{spaceProfileSettingsStore:i}=this.stores,{currentUserStore:n,currentUserSettingsStore:o}=A.default.state;if(!n||!o)throw new Error("No user or settings store.");const s=a()(v.FormattedMessage,{id:"spaceSettings.closeSettingsDialog.confirmationMessage",defaultMessage:"Your changes have not been saved. Save changes?"}),r=a()(v.FormattedMessage,{id:"spaceSettings.closeSettingsDialog.confirmationButton.label",defaultMessage:"Yes"}),d=a()(v.FormattedMessage,{id:"spaceSettings.closeSettingsDialog.cancelationButton.label",defaultMessage:"No"}),{currentTab:c}=_e.Z.state;if("profile"===c){if(!l().isEqual(i.state,i.getValueForUser(n,o,z.default.getIntl()))){const{profilePhoto:t,name:n,startDayOfWeek:r}=i.state;return n?M.showDialog({message:s,showCancel:!0,keepFocus:!0,items:[{label:a()(v.FormattedMessage,{id:"spaceSettings.closeSettingsDialog.updateSettingsButton.label",defaultMessage:"Update"}),color:"blue",onAccept:()=>{N.createAndCommit({userAction:"SpaceSettings.attemptCloseCurrentTab",environment:this.environment,perform:e=>{const{currentUserStore:i}=A.default.state;if(i&&S.A({userStore:i,data:{name:n,profilePhoto:t},transaction:e}),o){const t=o.getSettings();(null==t?void 0:t.start_day_of_week)!==r&&O.d2({userSettingsStore:o,data:{start_day_of_week:r},transaction:e})}}}),e()}}],handleCancel:()=>{e()}}):M.showErrorMessage(a()(v.FormattedMessage,{id:"profileSettings.personalInfoSection.nameMissing.message",defaultMessage:"Please fill in name."})),!0}e()}else if("settings"===c&&t.canEdit()){const{spaceBasicSettingsStore:i}=this.stores,{securitySettingsStore:n}=this.stores,a=!l().isEqual(n.state,n.getValueForSpace(t)),o=!l().isEqual(i.state,i.getValueForSpace(t));if(a||o){if(await M.confirmUserAction({message:s,acceptLabel:r,cancelLabel:d})){if(!(await C.Y5({environment:this.environment,spaceId:t.id,spaceBasicSettingsStore:i})))return!1;o&&C.OF({environment:this.environment,spaceStore:this.props.spaceStore,spaceBasicSettingsStore:i}),a&&this.updateSecuritySettingsStore(n),e()}else e();return!0}e()}else if("audit_log"===c)this.resetAuditLogSetting(),e();else if("analytics"===c)ve.reset(),e();else if("plans"===c&&t.canAdmin()){const{securitySettingsStore:i}=this.stores,n=i.getValueForSpace(t);!l().isEqual(i.state,i.getValueForSpace(t))&&n&&(i.setState(n),this.updateSecuritySettingsStore(i)),e()}else"teams"===c?(E.Z.reset(),R.reset(),e()):e();return!1}resetAuditLogSetting(){oe.reset(),le.reset()}updateSecuritySettingsStore(e){const{disablePublicAccess:t,disableGuests:i,disableMoveToSpace:n,disableExport:a,disableSpacePageEdits:o,disablePublicAccessRequests:s,disableTeamCreation:r,disableMembershipRequests:l,disableGuestMembershipRequests:d,enableAiFeature:c,disableTeamGuests:u}=e.state;N.createAndCommit({userAction:"SpaceSettings.attemptCloseCurrentTab",environment:this.environment,perform:e=>{C.Xr({environment:this.environment,disablePublicAccess:t,disableGuests:i,disableMoveToSpace:n,disableExport:a,disableSpacePageEdits:o,disablePublicAccessRequests:s,transaction:e,spaceStore:this.props.spaceStore,disableTeamCreation:r,disableMembershipRequests:l,disableGuestMembershipRequests:d,enableAiFeature:Boolean(c),disableTeamGuests:u})}})}getSidebarHeader(){return{fontSize:12,lineHeight:1,marginBottom:1,color:this.theme.mediumTextColor,fontWeight:f.Z.fontWeight.semibold,alignItems:"center",display:"flex",height:24,paddingLeft:12,paddingRight:11,textOverflow:"ellipsis",overflow:"hidden"}}getIconWrapStyle(){return{width:20,height:20,marginRight:8,color:this.theme.regularIconColor,fill:this.theme.regularIconColor}}getSettingsPromptIconStyle(){return{width:14,height:14,color:this.theme.regularIconColor}}}fv.displayName="SpaceSettings",fv.theme=void 0,fv.sidebarStyle={display:"flex",flexDirection:"column",height:"100%",justifyContent:"space-between",paddingTop:10,paddingLeft:4,paddingRight:4},fv.sidebarTabsStyle={overflow:"auto",paddingBottom:12};const vv=fv},13787:(e,t,i)=>{i.r(t),i.d(t,{default:()=>C});var n=i(23174),a=i.n(n),o=i(67294),s=i(83355),r=i(49085),l=i(8848),d=i(53397),c=i(89101),u=i(82990),m=i(5366),p=i(54642),g=i(28020),h=i(33846),f=i(92083),v=i(9209),y=i(42922),S=i(74194),b=i(53953),M=i(42402);class w extends s.Z{constructor(){super(...arguments),this.storeTypes={promoCodeStore:h.Z,promoError:r.default.createClass(void 0)},this.handleModalDismiss=()=>{v.Z.setState({open:!1})},this.handleChangeEmail=()=>{this.handleModalDismiss(),f.Z.setState({open:!0,openedFrom:"upsell",currentTab:"profile",defaultSubtab:void 0,highlightedSetting:void 0})},this.handleInputChange=e=>{this.stores.promoCodeStore.setState({...this.stores.promoCodeStore.state,inputValue:e.target.value.toUpperCase()}),this.stores.promoError.setState(void 0)},this.handleSubmitPromoCode=async()=>{const e=this.stores.promoCodeStore.state.inputValue;if(e){const t=await p.getPromoCode(this.environment,{code:e});"failed"!==t.type&&t.data.promo?v.Z.state.open&&(await v.Z.state.handlePromoCode(this.stores.promoCodeStore.state.inputValue),this.handleModalDismiss()):this.stores.promoError.setState(this.props.intl.formatMessage({defaultMessage:"Promo code {code} does not exist",id:"studentNotEligibleModal.numberedList.item2.promocode.errorMessage"},{code:e}))}}}renderComponent(){const{open:e}=v.Z.state;return a()(b.Z,{open:e,innerStyle:w.wrapStyle,preventHideChildrenWhileOpening:!0,render:()=>this.renderModalContents(),onDismiss:this.handleModalDismiss})}renderModalContents(){return a()("div",{style:{fontSize:14}},void 0,a()("div",{},void 0,a()(m.FormattedMessage,{defaultMessage:"<p>Unfortunately you are not eligible for a free Education plan if you use this email address.</p><p>K-12 students, K-12 educators, and personal email addresses such as Gmail and Outlook are not eligible to receive the <pricinglink>Education Plan</pricinglink> for free, but anyone is welcome to use the <pricinglink>Free Plan</pricinglink> for free with unlimited storage.</p>",id:"studentNotEligibleModal.header",values:{br:a()("br",{}),p:e=>a()("p",{style:{marginTop:0,marginBottom:8}},void 0,1===e.length?e[0]:o.Children.toArray(e)),pricinglink:e=>a()(M.Z,{external:!0,href:c.AR.pricing},void 0,e)}})),this.renderSchoolEmailCodePrompt(),this.renderPromoCode(),this.renderContactUs())}renderSchoolEmailCodePrompt(){const e=(0,g.B7)(this.environment);return a()("div",{style:{display:"flex",marginTop:16}},void 0,a()("div",{style:{width:18,flexShrink:0,color:this.theme.mediumTextColor}},void 0,a()(m.FormattedMessage,{defaultMessage:"1.",id:"studentNotEligibleModal.numberedList.firstItem"})),a()("div",{style:{flexGrow:1}},void 0,a()("div",{style:{color:this.theme.mediumTextColor}},void 0,a()(m.FormattedMessage,{defaultMessage:"Your current email is:",id:"studentNotEligibleModal.numberedList.changeEmailItem.message"})),a()("div",{style:{fontWeight:u.Z.fontWeight.medium,marginTop:0}},void 0,e&&e.getEmail()),a()("div",{style:{color:this.theme.mediumTextColor,marginTop:4}},void 0,a()(m.FormattedMessage,{defaultMessage:"Thousands of university, college, and post-secondary school domains are already eligible, not just .edu emails!",id:"studentNotEligibleModal.numberedList.changeEmailItem.message2"})),a()(y.Z,{style:{marginTop:12},onClick:this.handleChangeEmail,isLarge:!0},void 0,a()(m.FormattedMessage,{defaultMessage:"Change email",id:"studentNotEligibleModal.numberedList.changeEmailItem.button.label"}))))}renderPromoCode(){const e=this.stores.promoError.state,t=this.props.intl.formatMessage({defaultMessage:"Enter code…",id:"studentNotEligibleModal.numberedList.item2.promocodePlaceholder"});return a()("div",{style:{display:"flex",marginTop:16}},void 0,a()("div",{style:{width:18,flexShrink:0,color:this.theme.mediumTextColor}},void 0,a()(m.FormattedMessage,{defaultMessage:"2.",id:"studentNotEligibleModal.numberedList.secondItem"})),a()("div",{style:{flexGrow:1}},void 0,a()("div",{style:{color:this.theme.mediumTextColor}},void 0,a()(m.FormattedMessage,{defaultMessage:"Have a student promo code?",id:"studentNotEligibleModal.numberedList.promoCodeItem.message"})),a()("div",{style:{display:"flex",marginTop:12}},void 0,a()(S.Z,{style:{marginRight:8,height:32},value:this.stores.promoCodeStore.state.inputValue,onChange:this.handleInputChange,onSubmit:this.handleSubmitPromoCode,placeholder:t}),a()(y.Z,{onClick:this.handleSubmitPromoCode,disabled:!this.stores.promoCodeStore.state.inputValue,isLarge:!0},void 0,a()(m.FormattedMessage,{defaultMessage:"Submit",id:"studentNotEligibleModal.numberedList.promoCodeItem.submitButton"}))),a()("div",{style:{color:l.ZP.red,fontSize:12,marginTop:4,marginLeft:8,height:20}},void 0,e)))}renderContactUs(){return a()("div",{style:{display:"flex",alignItems:"center",color:this.theme.lightTextColor,borderTop:`1px solid ${this.theme.regularDividerColor}`,paddingTop:14}},void 0,d.Z.help({width:14,marginTop:1,marginRight:6,fill:this.theme.lightIconColor})," ",a()("div",{},void 0,a()(m.FormattedMessage,{defaultMessage:"Have questions about this? <inlinelink>More info & FAQs</inlinelink>.",id:"studentNotEligibleModal.contactUsSection.message",values:{inlinelink:e=>a()(M.Z,{href:"https://www.notion.so/Notion-for-students-teachers-adc631df15ee4ab9a7a33dd50f4c16fe",external:!0},void 0,e)}})))}}w.displayName="StudentNotEligibleModal",w.wrapStyle={padding:"24px 36px 24px",minWidth:300,maxWidth:400};const C=(0,m.injectIntl)(w)},6202:(e,t,i)=>{i.d(t,{Z:()=>m});var n=i(23174),a=i.n(n),o=(i(67294),i(83355)),s=i(8848),r=i(87279),l=i(42922),d=i(64921),c=i(28992);class u extends o.Z{renderComponent(){return a()(c.Z,{title:this.renderButton()})}renderButton(){const{isMobile:e}=this.environment.device;return e?a()(d.Z,{onClick:this.props.onClick,mobileFeedback:!0,disabled:this.props.disabled,style:u.buttonMobileStyle},void 0,this.props.title):a()(l.Z,{onClick:this.props.onClick,disabled:this.props.disabled,style:{width:"100%",maxWidth:300,display:"flex",margin:"auto"}},void 0,this.props.title)}}u.displayName="SubmitButtonMenuItem",u.contextTypes={...r.mw,...o.w},u.buttonMobileStyle={width:"100%",color:s.ZP.blue};const m=u},69735:(e,t,i)=>{i.r(t),i.d(t,{TopbarMoreMenu:()=>ni});var n=i(23174),a=i.n(n),o=i(67294),s=i(480),r=i(81954),l=i(24405),d=i(5366),c=i(10434),u=i.n(c),m=i(13991),p=i(15145),g=i(41432),h=i(53397),f=i(98459),v=i(70203),y=i(82990),S=i(93286),b=i(62967),M=i(50906),w=i(43132),C=i(79257),_=i(47307),k=i(54532),T=i(3297),I=i(96802),P=i(94419),Z=i(72711),x=i(19785),F=i(5978),A=i(37834),E=i(21325),B=i(12359),D=i(29919),R=i(93405),L=i(72495),N=i(8848),O=i(98742),V=i(64921),U=i(58032),W=i(64369);function K(e,t){let{id:i,caption:n,focused:r,isActive:d,onClick:c,onMouseDown:m,onMouseEnter:p,onMouseLeave:g,role:h,style:f,tooltip:v,ignoreLocalHoverState:y,disallowTabbing:S}=e;window.__c={n:"FontMenuItem"};const b=(0,s.Fy)(),M=(0,l.yK)((()=>({optionItem:{display:"flex",flexDirection:"column",alignItems:"center",minWidth:34,justifyContent:"flex-end"},button:{width:"100%",...b.isMobile?{padding:16,paddingTop:20,transition:"color 300ms, border 300ms",lineHeight:1}:{padding:6,paddingTop:10,borderRadius:3,transition:"color 300ms, border 300ms",lineHeight:1},justifyContent:"center",color:d?N.ZP.blue:"inherit"}})),[d,b]);return a()(U.Z,{renderTooltip:()=>v,placement:U.Z.Placement.Bottom,delayThreshold:80,render:e=>{const s=(0,O.Z)(e,{onMouseEnter:p,onMouseLeave:g}),{onMouseDown:l,...d}=s;return o.createElement(V.Z,u()({},d,{id:i,role:h,ref:t,mobileFeedback:b.isMobile,onClick:c,onMouseDown:s.onMouseDown||m,hovered:r,style:M.button,ignoreLocalHoverState:y,disallowTabbing:S,className:"notranslate"}),a()("div",{style:M.optionItem},void 0,a()("div",{style:{...f,height:25}},void 0,"Ag"),a()(W.Z,{isSmall:!0,style:{marginTop:4}},void 0,n)))}})}const z=o.forwardRef(K);var G=i(83355),q=i(87279);class H extends G.Z{constructor(){super(...arguments),this.desktopStyle={display:"flex",justifyContent:"space-between",marginLeft:14,marginRight:14}}renderComponent(){return o.createElement(L.Z,this.props,a()("div",{style:this.environment.device.isMobile?this.getMobileStyle():this.desktopStyle},void 0,this.props.children))}getMobileStyle(){return{display:"flex",justifyContent:"space-around",boxShadow:`0 1px 0 ${this.theme.regularDividerColor}`,background:this.theme.popoverBackground}}}H.displayName="FontSectionMenuItem",H.contextTypes={...q.mw,...G.w};const j=H;i(57658);var Q=i(27006),Y=i(77420),$=i(97880),X=i(39248),J=i(74181),ee=i(21202),te=i(15070),ie=i(79315),ne=i(52275),ae=i(70301);class oe extends G.Z{renderComponent(){const{bot:e}=this.props,{currentUserRootStore:t}=ie.default.state;if(e&&t)return o.createElement(ne.Z,u()({},this.props,{icon:a()(ae.Z,{botValue:e}),title:(0,te.Mh)(e)}))}}oe.displayName="BotMenuItem",oe.contextTypes={...q.mw,...G.w};const se=oe;var re=i(68894),le=i(68785),de=i(28992),ce=i(43765),ue=i(31278),me=i(76798),pe=i(84015),ge=i(31076),he=i(26825),fe=i(48019),ve=i(78140),ye=i(40721),Se=i(95030);const be=(0,o.forwardRef)((function(e,t){const{context:i,parent:n,isSharedDirectly:l,botStore:d,botPermissionSourcePage:c,originConnectionLabel:m,...p}=e,g=(0,s.O7)(),h=(0,r.VK)((()=>ie.default.state.currentSpaceStore),[]),f=i.blocks[0],v=(0,r.VK)((()=>f.canAdmin()&&(null==h?void 0:h.canRead())),[f,h]),{botCapabilities:y,botName:S}=(0,r.VK)((()=>({botCapabilities:d.getCapabilities(),botName:d.getName()})),[d]);return o.createElement(Se.Z,u()({},p,{key:d.id,renderOrigin:e=>o.createElement(ne.Z,u()({},e,{title:m,icon:a()(ae.Z,{botStore:d,showActiveDot:!0,style:{position:"relative"}})})),renderExtension:(e,t)=>{let s;return s=g.device.isPhone?{menuType:q.og.Modal,right:a()(ye.DoneMenuText,{}),onClickRight:t.close,...e}:{menuType:q.og.Popup,width:220,...e},o.createElement(ve.Z,s,a()(fe.Z,{context:i,initialFocus:0,onAccept:n.onAccept,sections:[Me({isSharedDirectly:l,botCapabilities:y,botPermissionSourcePage:c}),...v?[we({isSharedDirectly:l,botId:d.id,botName:S})]:[]]}))},onFocus:n.onFocus,focused:p.focused,openOnFocus:!1,ref:t}))}));function Me(e){const{botCapabilities:t,isSharedDirectly:i,botPermissionSourcePage:n}=e,a=(0,he.uH)(t);return{key:"active connection capabilities section",render:e=>o.createElement(L.Z,u()({},e,{topBorder:!1})),actions:[...i?[]:[Xe(n)],Je(a)]}}function we(e){const{isSharedDirectly:t,botId:i,botName:n}=e;return{key:"active connection disconnect section",render:e=>o.createElement(L.Z,e),actions:t?[et(i,n)]:[tt(i)]}}var Ce=i(55384),_e=i(9844),ke=i(31299),Te=i(41623),Ie=i(28187),Pe=i(38755),Ze=i(68216);const xe=(0,o.forwardRef)((function(e,t){const{context:i,parent:n,alreadyConnectedIntegrationIds:l,alreadyConnectedBotIds:d,originButtonLabel:c,...m}=e,p=i.blocks[0],g=(0,s.O7)(),f=(0,r.VK)((()=>ie.default.state.currentSpaceStore),[]),v=(0,r.VK)((()=>null==f?void 0:f.getBotSettingsStore().getValue()),[f]),y=(0,r.VK)((()=>null!=v&&v.integration_restrictions&&null!=v&&v.integration_approval_statuses?Object.keys(v.integration_approval_statuses):[]),[v]),[S,b]=(0,o.useState)(""),[w,C]=(0,o.useState)({status:"loading"});(0,o.useEffect)((()=>{Promise.all([async function(e){return await ke.RF({environment:g,query:e})}(S),async function(e){return await ke.sC({query:e,environment:g,spaceId:null==f?void 0:f.id,botSettings:v})}(S)]).then((e=>{let[t,i]=e;const n=new Set,a=function(e){const{alreadyConnectedBotIds:t,alreadyConnectedIntegrationIds:i,botValues:n,environment:a}=e,o=[];for(const s of n){const e=s.id,n=t.has(e)||s.integration_id&&i.has(s.integration_id),r=Ce.kk.fromValue(Y.cZ,s),l=(0,Te.Nq)(a,r)||(0,Pe.Fn)(a)&&(0,Te.f_)(r);!n&&l&&o.push(s)}return o}({alreadyConnectedBotIds:d,alreadyConnectedIntegrationIds:l,botValues:t,environment:g}).map((e=>(e.integration_id&&n.add(e.integration_id),{table:Y.cZ,value:e})));let o=i.map((e=>{if(f){const t=Ze.t1.createChildStore(f,{id:e,table:_e.K2}),i=t.computeWithRecordValues((e=>{let{getRecordValueAndSubscribe:i}=e;return i(t)}));if(i&&!(0,J.VM)(i)){return{table:_e.K2,value:i}}}})).filter($.$K).filter((e=>!(n.has(e.value.id)||l.has(e.value.id))));if(J.Cb.name.toLowerCase().includes(S.toLowerCase())){const e={table:"legacy_integration",value:J.Cb};o=[...o,e]}const s=[...a,...o].sort(((e,t)=>{var i,n;const a=null===(i=e.value.name)||void 0===i?void 0:i.toLowerCase(),o=null===(n=t.value.name)||void 0===n?void 0:n.toLowerCase();return a&&o?a<o?-1:a>o?1:0:0}));C({results:s,status:"ready"})})).catch((e=>C({status:"error"})))}),[S,f,d,v,y,g,l,p]);return o.createElement(Se.Z,u()({},m,{renderOrigin:(e,t)=>o.createElement(R.Z,u()({},e,{ref:t,title:c,svg:h.Z.plus})),renderExtension:(e,t)=>{const n=g.device.isMobile?{menuType:q.og.Modal,right:a()(ye.DoneMenuText,{}),onClickRight:t.close,...e}:{menuType:q.og.Popup,width:220,...e},s=g.device.isMobile?{menuType:q.og.Modal,topbarStyle:{height:0}}:{menuType:q.og.Popup,width:220,maxHeight:"16vh",...e},r=Boolean(p.canAdmin()&&(null==f?void 0:f.canRead()));return o.createElement(ve.Z,u()({},n,{onClick:e=>{e.stopPropagation()}}),a()(fe.Z,{initialFocus:0,context:i,onAccept:()=>{M.sSR(g)},sections:[...r?[Fe(S,b),""===S?Ae({searchResults:w,resultsMenuProps:s}):Be({searchResults:w,resultsMenuProps:s})]:[],De(r,J.Cb)]}))},onFocus:n.onFocus,focused:m.focused,openOnFocus:!0,ref:t}))}));function Fe(e,t){return{key:"search connections section",render:e=>o.createElement(L.Z,u()({},e,{isInput:!0})),actions:[Ge(e,t)]}}function Ae(e){const{searchResults:t,resultsMenuProps:i}=e,n=new Set;return{key:"search initial connections section",render:e=>o.createElement(Ee,u()({},e,{resultsMenuProps:i})),actions:[..."ready"===t.status?t.results.map((e=>"bot"===e.table?(e.value.integration_id&&n.add(e.value.integration_id),He(e.value)):at(e)?(0,Ie.F6)()&&!(0,Ie.SG)()?void 0:Qe(e.value):je(e.value))).filter($.$K):"loading"===t.status?[ze()]:[qe()]]}}function Ee(e){window.__c={n:"IntegrationSearchResultsSection"};const{resultsMenuProps:t,...i}=e,n=(0,o.useRef)(null),a=(0,o.useCallback)((()=>{var e;const t=null===(e=n.current)||void 0===e||null===(e=e.querySelector('[role="menuitem"]'))||void 0===e?void 0:e.clientHeight,i=window.innerHeight<600?3:7;n.current&&t&&(n.current.style.maxHeight=i*t+.5*t+"px")}),[]);return(0,o.useEffect)((()=>(a(),window.addEventListener("resize",a),()=>{window.removeEventListener("resize",a)})),[a]),o.createElement(ve.Z,u()({},t,{innerRef:n}),o.createElement(L.Z,u()({},i,{isInput:!0,topBorder:!1,style:{margin:0,paddingTop:0,paddingBottom:0}})))}function Be(e){const{searchResults:t,resultsMenuProps:i}=e;let n=[];return n="error"===t.status?[qe()]:"loading"===t.status?[ze()]:"ready"===t.status&&t.results.length>0?t.results.map((e=>e.table===Y.cZ?He(e.value):at(e)?(0,Ie.F6)()&&!(0,Ie.SG)()?void 0:Qe(e.value):je(e.value))).filter($.$K):[{key:"connections search error",displayName:Le.default.formatMessage(We.connectionNoSearchResultsLabel),analyticsName:We.connectionNoSearchResultsLabel.defaultMessage,searchName:We.connectionNoSearchResultsLabel.defaultMessage,closeParentMenu:!1,validators:[Re.Gg,Re.J5,Ke],render:e=>a()(ce.Z,{title:Le.default.formatMessage(We.connectionNoSearchResultsLabel)}),action:()=>{}}],{key:"connections search results",render:e=>o.createElement(Ee,u()({},e,{resultsMenuProps:i})),actions:n}}function De(e,t){const i=e,n=!(0,Ie.F6)()||(0,Ie.SG)();return{key:"manage connections section",render:t=>o.createElement(L.Z,u()({},t,{style:{marginTop:e?6:0}})),actions:[...!i&&n?[Qe(t)]:[],{key:"manage connections",displayName:Le.default.formatMessage(We.manageConnectionsLabel),analyticsName:We.manageConnectionsLabel.defaultMessage,searchName:We.manageConnectionsLabel.defaultMessage,closeParentMenu:!1,validators:[Re.Gg,Re.J5,Re.ff(Re.tq)],render:e=>o.createElement(R.Z,u()({},e,{title:Le.default.formatMessage(We.manageConnectionsLabel),svg:h.Z.settings})),action:()=>{Oe.r({currentTab:"connected_apps",openedFrom:"topbar"})}}]}}var Re=i(70183),Le=i(33929),Ne=i(76463),Oe=i(91376),Ve=i(76464),Ue=i(14946);const We=(0,d.defineMessages)({connectionLoadingLabel:{id:"topbar.connectionsSection.connectionLoading.label",defaultMessage:"Connections loading…"},connectionSearchPlaceholderLabel:{id:"topbar.connectionsSection.topbarMoreConnectionsSubMenu.label",defaultMessage:"Search for connections..."},connectionSearchErrorLabel:{id:"topbar.connectionsSection.connectionSearchError.label",defaultMessage:"Something went wrong"},connectionNoSearchResultsLabel:{id:"topbar.connectionsSection.noSearchResults.label",defaultMessage:"No results"},connectionSearchResultLabel:{id:"topbar.connectionsSection.connectionSearchResult.label",defaultMessage:"{name}"},slackEmptyLabel:{id:"topbar.connectionSection.slackEmpty.label",defaultMessage:"Slack"},slackConnectedLabel:{id:"topbar.connectionSection.slackConnected.label",defaultMessage:"Connected to Slack channel"},manageConnectionsLabel:{id:"topbar.connectionsSection.manageConnections.label",defaultMessage:"Manage connections"},addConnectionsLabel:{id:"topbar.connectionsSection.addConnections.label",defaultMessage:"Add connections"},fromParentPageLabel:{id:"topbar.connectionsSection.fromParenPage.label",defaultMessage:"From"},capabilitiesLabel:{id:"topbar.connectionsSection.capabilities.label",defaultMessage:"Capabilities"},disconnectLabel:{id:"topbar.connectionSection.disconnectIntegration.label",defaultMessage:"Disconnect"},disconnectConfirmationLabel:{id:"topbar.connectionSection.disconnectIntegrationConfirmation.label",defaultMessage:"{botName} will be removed from this page and all child pages. Continue?"},restrictionLabel:{id:"topbar.connectionSection.restrictIntegration.label",defaultMessage:"Restrict"},restrictionConfirmationLabel:{id:"topbar.connectionSection.restrictIntegrationConfirmation.label",defaultMessage:"Are you sure you want to remove this permission and restrict access? This page will no longer share settings from the parent page."},restrictionAcceptLabel:{id:"topbar.connectionSection.restrictAccept.label",defaultMessage:"Restrict access"},connectionLabel:{id:"topbar.connectionSection.connectionIntegration.label",defaultMessage:"{connectionName}"},connectionBotConfirmlabel:{id:"topbar.connectionSection.connectBotConfirmation.label",defaultMessage:"{botName} will have access to this and all child pages. Continue?"},connectionIntegrationConfirmlabel:{id:"topbar.connectionSection.connectIntegrationConfirmation.label",defaultMessage:"{integrationName} is developed by a third party partner and you will be redirected outside of Notion to authorize this connection. Continue?"}}),Ke=Re.ff(Re.xD([Re.tq,Re.ff(Re.xD([Re.zz,Re.J5]))]));function ze(){return{key:"connections loading",displayName:Le.default.formatMessage(We.connectionLoadingLabel),analyticsName:We.connectionLoadingLabel.defaultMessage,searchName:We.connectionLoadingLabel.defaultMessage,closeParentMenu:!1,validators:[Re.Gg,Re.J5,Ke],render:e=>o.createElement(de.Z,u()({},e,{icon:a()(le.Z,{}),title:Le.default.formatMessage(We.connectionLoadingLabel)})),action:()=>{}}}function Ge(e,t){return{key:"search connections input",analyticsName:We.connectionSearchPlaceholderLabel.defaultMessage,displayName:Le.default.formatMessage(We.connectionSearchPlaceholderLabel),searchName:We.connectionSearchPlaceholderLabel.defaultMessage,closeParentMenu:!1,validators:[Re.Gg,Re.J5,Ke],render:()=>a()(re.ZP,{value:e,onChange:e=>t(e.target.value),placeholder:Le.default.formatMessage(We.connectionSearchPlaceholderLabel),focus:!0}),action:()=>{}}}function qe(){return{key:"connections search error",displayName:Le.default.formatMessage(We.connectionSearchErrorLabel),analyticsName:We.connectionSearchErrorLabel.defaultMessage,searchName:We.connectionSearchErrorLabel.defaultMessage,closeParentMenu:!1,validators:[Re.Gg,Re.J5,Ke],render:e=>a()(ce.Z,{title:Le.default.formatMessage(We.connectionSearchErrorLabel)}),action:()=>{}}}function He(e){const{id:t,name:i}=e,n=Le.default.formatMessage(We.connectionSearchResultLabel,{name:i});return{key:`${t}`,displayName:n,analyticsName:n,searchName:i,closeParentMenu:!1,validators:[Re.Gg,Re.J5,Ke],render:(t,i)=>o.createElement(se,u()({},t,{bot:e,focused:t.focused,onClick:async()=>{await it(i.blocks[0],i.environment,e)},ref:t.ref})),action:async t=>{await it(t.blocks[0],t.environment,e)}}}function je(e){const{id:t,name:i,info:n}=e,a=Le.default.formatMessage(We.connectionLabel,{connectionName:i});return{key:`${t}`,displayName:a,analyticsName:a,searchName:i,closeParentMenu:!1,validators:[Re.Gg,Re.J5,Ke,Re.ff(Re.tq)],render:e=>o.createElement(ne.Z,u()({},e,{title:a,icon:o.createElement("img",{src:n.icon,style:{width:18,height:"auto"},ref:e.ref})})),action:async t=>{let{environment:i}=t;e.id!==J.T0&&await async function(e,t){const{id:i,name:n}=e,a=await _.confirmUserAction({message:Le.default.formatMessage(We.connectionIntegrationConfirmlabel,{integrationName:n})}),o=(0,X.E)(i,n);a&&F.navigateToExternalURL({environment:t,url:o,targetSelf:!1})}(e,i)}}}function Qe(e){const t=Le.default.formatMessage(We.slackEmptyLabel);return{key:"slack empty",displayName:t,analyticsName:We.slackEmptyLabel.defaultMessage,searchName:t,closeParentMenu:!0,validators:[Re.Gg,Re.J5,Re.YP,Re.tJ,Re.OF,Re.ff(Re.Fx)],render:i=>a()(U.Z,{placement:U.Z.Placement.Left,render:n=>o.createElement(ne.Z,u()({},(0,O.Z)(n,i),{title:t,icon:a()("img",{src:e.info.icon,style:{height:18}})})),renderTooltip:ge.WH}),action:e=>{var t;Ue.Lh({environment:e.environment,blockId:null===(t=e.blocks)||void 0===t||null===(t=t[0])||void 0===t?void 0:t.id,intl:Le.default.getIntl()})}}}function Ye(){const e=Le.default.formatMessage(We.slackConnectedLabel);return{key:"slack connected inherited",displayName:e,analyticsName:We.slackConnectedLabel.defaultMessage,searchName:e,closeParentMenu:!0,validators:[Re.Gg,Re.J5,Re.ur,Re.ff(Re.Fx)],render:(e,t,i)=>o.createElement(ge.N,u()({blockStore:t.blocks[0]},e)),action:e=>{}}}function $e(){const e=Le.default.formatMessage(We.slackConnectedLabel);return{key:"slack connected on block",displayName:e,analyticsName:We.slackConnectedLabel.defaultMessage,searchName:e,closeParentMenu:!0,validators:[Re.Gg,Re.J5,Re.Rd,Re.ff(Re.Fx)],render:(e,t,i)=>o.createElement(ge.g1,u()({blockStore:t.blocks[0]},e)),action:e=>{const{slackIntegrationStore:t}=(0,Ie.Jk)(e.blocks[0]);Ue.Hw(e.environment,t,Le.default.getIntl())}}}function Xe(e){const t=Le.default.formatMessage(We.fromParentPageLabel);return{key:"from parent page",displayName:t,analyticsName:t,searchName:t,closeParentMenu:!1,validators:[Re.Gg,Re.J5],action:()=>{},render:(t,i)=>{let{blocks:n}=i;const o=n[0],s=Ze.G.createChildStore(o,{table:ee.iU,id:e.blockId});return a()(nt,{parentBlockStore:s})}}}function Je(e){const t=Le.default.formatMessage(We.capabilitiesLabel);return{key:"capabilities",displayName:t,analyticsName:t,searchName:t,closeParentMenu:!1,validators:[Re.Gg,Re.J5],action:()=>{},render:()=>a()(pe._,{role:e})}}function et(e,t){const i=Le.default.formatMessage(We.disconnectLabel);return{key:"disconnect integration",displayName:i,analyticsName:i,searchName:We.disconnectLabel.defaultMessage,closeParentMenu:!1,validators:[Re.Gg,Re.J5],action:async i=>{let{blocks:n,environment:a}=i;const o=n[0];await async function(e,t,i,n){await _.confirmUserAction({message:Le.default.formatMessage(We.disconnectConfirmationLabel,{botName:n})})&&Ne.RN({botId:i,store:e,environment:t})}(o,a,e,t)},render:e=>o.createElement(R.Z,u()({},e,{svg:h.Z.disconnect,title:i,focused:!0}))}}function tt(e){const t=Le.default.formatMessage(We.disconnectLabel),i=Le.default.formatMessage(We.restrictionLabel);return{key:"restrict page from permission model",displayName:i,analyticsName:i,searchName:We.restrictionLabel.defaultMessage,closeParentMenu:!1,validators:[Re.Gg,Re.J5],action:async t=>{let{blocks:i,environment:n}=t;const a=i[0];await async function(e,t,i){if(await _.confirmUserAction({message:Le.default.formatMessage(We.restrictionConfirmationLabel),acceptLabel:Le.default.formatMessage(We.restrictionAcceptLabel)})){const n={type:"bot_permission",role:"none",bot_id:e};B.createAndCommit({userAction:"TopbarMoreConnections.restrictPagePermissions",environment:i,perform:e=>{Ve.Pk({environment:i,store:t,permissionItem:n,shouldInherit:!0,transaction:e})}})}}(e,a,n)},render:e=>o.createElement(R.Z,u()({},e,{svg:h.Z.disconnect,title:t,focused:!0}))}}async function it(e,t,i){await _.confirmUserAction({message:Le.default.formatMessage(We.connectionBotConfirmlabel,{botName:i.name})})&&Ne.v2({botValue:i,store:e,environment:t})}function nt(e){window.__c={n:"FromParentPageMenuItem"};const{parentBlockStore:t}=e,i=(0,r.VK)((()=>t.getIcon()),[t]),n=(0,r.VK)((()=>t.isEmptyPage()),[t]),c=(0,s.O7)(),m=(0,l.Fg)(),[g,h]=(0,o.useState)("transparent"),f=c.device.isMobile?{fontSize:14,paddingLeft:4}:{fontSize:12,paddingLeft:4};return o.createElement(ce.Z,u()({},e,{title:a()("span",{style:{display:"flex",alignItems:"center",justifyContent:"flex-start"}},void 0,a()(d.FormattedMessage,{id:"topbar.connectionSection.parentPage.label",defaultMessage:"From"}),a()("span",{style:{display:"flex",alignItems:"center",padding:2,borderRadius:2,marginLeft:2,cursor:"pointer",backgroundColor:g,color:m.regularTextColor,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},onClick:()=>{F.navigateToBlock({environment:c,store:t,pageVisitSource:p.tY.LinkInPage})},onMouseEnter:()=>{h(m.selectLightGray[100])},onMouseLeave:()=>{h("transparent")},onMouseDown:()=>{h(m.selectLightGray[200])},onMouseUp:()=>{h(m.selectLightGray[100])}},void 0,a()(ue.Z,{disabled:!0,icon:i,isEmptyPage:n,size:12,style:{margin:"0px 2px"}}),a()(me.Z,{store:t}))),textWrapperStyle:f}))}function at(e){return"legacy_integration"===e.table&&e.value.id===J.Cb.id}var ot=i(67669);function st(e,t,i){const n=function(e){var t;const i=e.blocks[0],n=(0,ot.YO)(i).filter((0,$.AO)((e=>(0,Q.FB)(e.permissionItem)?{true:{...e,permissionItem:e.permissionItem}}:{false:e})));if(0===n.length)return{status:"no bots"};const a=new Map,o=null===(t=ie.default.state.currentSpaceStore)||void 0===t?void 0:t.id,s=n.map((e=>{let{from:t,permissionItem:n}=e;const s=Ze.t1.createChildStore(i,{table:Y.cZ,id:n.bot_id,spaceId:o});if("block"===t.table)return a.set(n.bot_id,t),s})).filter($.$K);if(s.every((e=>e.isReady()))){const t=s.filter((t=>t.isDefined()&&Boolean((0,Te.Nq)(e.environment,t.getModel()))));if((0,Pe.Fn)(e.environment)){const e=t.map((e=>e.getIntegrationId())),i=new Set(e),n=s.filter((e=>!(!e.isDefined()||i.has(e.getIntegrationId())||!Boolean((0,Te.f_)(e.getModel()))||(i.add(e.getIntegrationId()),0))));t.push(...n)}return{status:"ready",botStores:t,botIdToSharedPageIds:a}}return{status:"loading"}}(e),{status:a}=n;if("no bots"===a||"loading"===a)return n;{const{botStores:e,botIdToSharedPageIds:a}=n;return{status:"ready",botActions:e.map((e=>{if(e.isDefined()){const n=e.getIntegrationId();n&&t.add(n);const s=a.get(e.id);if(s)return i.add(e.id),function(e){const{botStore:t,botPermissionSourcePage:i}=e,{id:n}=t,a=t.getName(),s=Le.default.formatMessage(We.connectionLabel,{connectionName:a});return{key:`${n}`,displayName:s,analyticsName:s,searchName:s,closeParentMenu:!1,validators:[Re.Gg,Re.J5],action:()=>{},render:(e,n,a)=>{const r=n.blocks[0].id===i.blockId;return o.createElement(be,u()({},e,{context:n,parent:a,isSharedDirectly:r,botStore:t,botPermissionSourcePage:i,originConnectionLabel:s}))}}}({botStore:e,botPermissionSourcePage:s})}})).filter($.$K)}}}function rt(e){const t=new Set,i=new Set,n=st(e,t,i),a=function(e,t){const i=Le.default.formatMessage(We.addConnectionsLabel);return{key:"add connections action",displayName:i,analyticsName:We.addConnectionsLabel.defaultMessage,searchName:We.addConnectionsLabel.defaultMessage,closeParentMenu:!1,validators:[Re.Gg,Re.J5,Ke],action:()=>{},render:(n,a,s)=>o.createElement(xe,u()({},n,{context:a,parent:s,alreadyConnectedIntegrationIds:e,alreadyConnectedBotIds:t,originButtonLabel:i}))}}(t,i);if("no bots"===n.status)return{loadingAction:[],connectedActions:[],searchSubMenu:a};if("loading"===n.status)return{loadingAction:[ze()],connectedActions:[],searchSubMenu:a};{const{botActions:e}=n;return{loadingAction:[],connectedActions:e,searchSubMenu:a}}}function lt(e){const{loadingAction:t,connectedActions:i,searchSubMenu:n}=rt(e);return{key:"topbar connections",render:e=>o.createElement(L.Z,u()({},e,{topBorder:!0,title:a()(d.FormattedMessage,{id:"topbar.connectionSection.label",defaultMessage:"Connections"})})),actions:[...t,...[Ye(),$e()],...i,n]}}var dt=i(64536),ct=i(42115),ut=i(95477),mt=i(28020),pt=i(4708),gt=i(21969),ht=i(84210),ft=i(41984),vt=i(9919),yt=i(10161),St=i(90848),bt=i(30496),Mt=i(11689),wt=i(43339);const Ct=(0,d.defineMessages)({undoTurnPageIntoWikiName:{id:"action.undoTurnPageIntoWiki.name",defaultMessage:"Undo wiki"},customizePageLabel:{id:"action.customizePage.label",defaultMessage:"Customize page"},fontDefaultName:{id:"action.setPageFont.default.fuzzySearchKeywords",defaultMessage:"Font Default"},fontDefaultCaption:{id:"action.setPageFont.default.caption",defaultMessage:"Default"},fontDefaultTooltip:{id:"action.setPageFont.default.tooltip",defaultMessage:"The default sans-serif workhorse"},fontSerifName:{id:"action.setPageFont.serif.fuzzySearchKeywords",defaultMessage:"Font Serif"},fontSerifCaption:{id:"action.setPageFont.serif.caption",defaultMessage:"Serif"},fontSerifTooltip:{id:"action.setPageFont.serif.tooltip",defaultMessage:"Good for publishing"},fontMonoName:{id:"action.setPageFont.mono.fuzzySearchKeywords",defaultMessage:"Font Mono"},fontMonoCaption:{id:"action.setPageFont.mono.caption",defaultMessage:"Mono"},fontMonoTooltip:{id:"action.setPageFont.mono.tooltip",defaultMessage:"Good for drafting and notes"},fontSmallTextKeywords:{id:"action.fontSmallText.fuzzySearchKeywords",defaultMessage:"Font Small Text"},fontSmallTextLabel:{id:"action.fontSmallText.label",defaultMessage:"Small text"},fontStyleSection:{id:"action.section.fontStyle",defaultMessage:"Style"},fullWidthLabel:{id:"action.fullWidth.label",defaultMessage:"Full width"},lockPageName:{id:"action.lockPage.name",defaultMessage:"Lock page"},unlockPageName:{id:"action.unlockPageName.name",defaultMessage:"Unlock page"},openAIAssistant:{id:"action.openMobileAIAssistant.name",defaultMessage:"Open AI Assistant"},openinMacAppName:{id:"action.openinMacApp.name",defaultMessage:"Open in Mac app"},openinWindowsAppName:{id:"action.openinWindowsApp.name",defaultMessage:"Open in Windows app"},openiniOSAppName:{id:"action.openiniOSApp.name",defaultMessage:"Open in iOS app"},openinAndroidAppName:{id:"action.openinAndroidApp.name",defaultMessage:"Open in Android app"},pageUpdates:{id:"action.pageUpdates.title",defaultMessage:"Page updates"},pageHistoryName:{id:"action.pageHistory.name",defaultMessage:"Page history"},showDeletedPagesName:{id:"action.showDeletedPages.name",defaultMessage:"Show deleted pages"}});function _t(e){return(0,b.PH)({key:`font ${e.font||"default"}`,displayName:e.displayName,analyticsName:e.displayName.defaultMessage,validators:[Re.or([Re.ff(Re.YG),Re.f7]),Re.J5],render:(t,i,n)=>{const a=i.blocks[0].getFormat().page_font,s=e.font===a||!e.font&&!a;return o.createElement(z,u()({},t,{isActive:s,font:e.font,tooltip:e.tooltip,style:e.style,caption:e.caption}))},closeParentMenu:!1,action:(t,i)=>{let{blocks:n,environment:a}=t;B.createAndCommit({userAction:"actionRegistry.createFontAction",environment:a,perform:t=>{I.FH({stores:n,update:{page_font:e.font},transaction:t}),M.G14(a,{type:e.font||"default"})}})}})}const kt=_t({displayName:Ct.fontDefaultName,caption:o.createElement(d.FormattedMessage,Ct.fontDefaultCaption),font:void 0,tooltip:o.createElement(d.FormattedMessage,Ct.fontDefaultTooltip),style:{fontSize:24,fontFamily:y.Z.getCompositeFontFamily(m.SP).sans,position:"relative",top:-2}}),Tt=_t({displayName:Ct.fontSerifName,caption:o.createElement(d.FormattedMessage,Ct.fontSerifCaption),font:"serif",tooltip:o.createElement(d.FormattedMessage,Ct.fontSerifTooltip),style:{fontSize:25,fontFamily:y.Z.getCompositeFontFamily(m.SP).serif}}),It=_t({displayName:Ct.fontMonoName,caption:o.createElement(d.FormattedMessage,Ct.fontMonoCaption),font:"mono",tooltip:o.createElement(d.FormattedMessage,Ct.fontMonoTooltip),style:{fontSize:26,fontFamily:y.Z.getCompositeFontFamily(m.SP).mono,position:"relative",top:-3,letterSpacing:-1}}),Pt=(0,b.$J)({key:"font section",title:Ct.fontStyleSection,render:e=>o.createElement(j,e),actions:[kt,Tt,It]}),Zt=(0,S.wL)({key:"small text",displayName:Ct.fontSmallTextKeywords,label:Le.default.formatMessage(Ct.fontSmallTextLabel),property:"page_small_text",validators:[Re.ff(Re.tq),Re.or([Re.ff(Re.YG),Re.f7]),Re.J5],afterAction:(e,t)=>M.DRv(t,{type:e?"small":"large"})}),xt=(0,S.wL)({key:"full width",displayName:Ct.fullWidthLabel,label:Le.default.formatMessage(Ct.fullWidthLabel),property:"page_full_width",validators:[Re.ff(Re.Mn),Re.ff(Re.YG),Re.J5],afterAction:(e,t)=>M.LDb(t,{type:e?"full_width":"default_width"})}),Ft=(0,b.$J)({key:"page style",render:e=>o.createElement(L.Z,e),actions:[Zt,xt]}),At=(0,S.Li)([Re.KS],S.sY.turnPageIntoWikiFullName),Et=(0,b.PH)({key:"undo turn page into wiki",displayName:Ct.undoTurnPageIntoWikiName,analyticsName:Ct.undoTurnPageIntoWikiName.defaultMessage,svg:h.Z.undo,validators:[Re.U7,Re.U_,Re.ff(Re.p1),Re.f7,Re.QL("wiki_database")],closeParentMenu:!0,action:async e=>{let{environment:t,blocks:i}=e;await _.confirmUserAction({message:a()("div",{style:{textAlign:"center"}},void 0,a()(d.FormattedMessage,{defaultMessage:"Are you sure you want to turn <bold>{pageName}</bold> back into a normal page?",id:"action.undoTurnIntoWiki.message",values:{pageName:v.Q(i[0].getTitleValue()),bold:e=>a()("span",{style:{fontWeight:y.Z.fontWeight.semibold}},void 0,e)}})),description:a()("div",{style:{textAlign:"center"}},void 0,a()(d.FormattedMessage,{defaultMessage:"This will remove properties like owners and verification from your pages",id:"action.undoTurnIntoWiki.description"}))})&&B.createAndCommit({userAction:"actionRegistry.undoTurnIntoAction.wiki",environment:t,perform:e=>{D.Cq({environment:t,blocks:i,transaction:e,source:"page_menu"})}})}}),Bt=(0,b.PH)({key:"customize page",displayName:Ct.customizePageLabel,analyticsName:Ct.customizePageLabel.defaultMessage,svg:h.Z.customizePage,validators:[Re.U_,Re.ff(Re.YG)],closeParentMenu:!0,render:e=>o.createElement(R.Z,u()({},e,{title:o.createElement(d.FormattedMessage,Ct.customizePageLabel),svg:h.Z.customizePage,shortcuts:[]})),action:e=>{C.bA({originRect:e.originRect})}}),Dt=(0,b.PH)({key:"page lock",displayName:Ct.lockPageName,analyticsName:Ct.lockPageName.defaultMessage,svg:h.Z.locked,validators:[Re.ff(Re.YG),Re.J5,Re.ff(Re.p1)],closeParentMenu:!1,action:(e,t)=>{let{blocks:i,environment:n}=e;const a=i[0];Z.bo({environment:n,store:a,lock:!0})}}),Rt=(0,b.PH)({key:"page unlock",displayName:Ct.unlockPageName,analyticsName:Ct.unlockPageName.defaultMessage,svg:h.Z.unlocked,validators:[Re.ff(Re.YG),Re.J5,Re.p1],closeParentMenu:!1,action:(e,t)=>{let{blocks:i,environment:n}=e;const a=i[0];Z.bo({environment:n,store:a,lock:!1})}}),Lt=(0,b.PH)({key:"open ai assistant",displayName:Ct.openAIAssistant,analyticsName:Ct.openAIAssistant.defaultMessage,svg:h.Z.sparkles,validators:[Re.jl,Re.Fx,Re.Mn,Re.g5,Re.QL("assistant-on-mobile")],closeParentMenu:!0,action:e=>{St.Z.setState({...St.Z.state,open:!0})}}),Nt=(0,b.PH)({key:"copy link to block non-desktop",displayName:S.sY.copyLinkNavigableTypeName,analyticsName:S.sY.copyLinkNavigableTypeName.defaultMessage,svg:h.Z.link,shortcuts:["copyCurrentPageLinkifiedBlockTitle"],validators:[Re.jl,Re.U7,Re.ff(Re.d)],closeParentMenu:!0,action:(e,t)=>{w.Hs({...e,event:t})}}),Ot=(0,b.PH)({key:"duplicate",displayName:S.sY.duplicateName,analyticsName:S.sY.duplicateName.defaultMessage,svg:h.Z.duplicate,validators:[Re.DF,Re.J5,Re.KE,Re.xk,Re.ff(Re.P9(g.Ti.externalObjectInstancePage))],shortcuts:["duplicate"],closeParentMenu:!0,action:e=>{let{environment:t}=e;const i=mt.np();if(!i)return;const n=i.getParentCollectionStore();n&&E.M_(t)&&B.createAndCommit({userAction:"actionRegistry.duplicateToCollection",environment:t,perform:e=>{const[a,o]=k.Qi({environment:t,stores:[i],addCopyName:(0,ft.Z)(i),transaction:e,deepCopyTransclusionContainers:!0,resolveTemplateVariables:!i.isInsideTemplate(),targetSpaceId:(0,f.CG)(n.pointer.spaceId),baseUrl:ut.default.domainBaseUrl,publicDomainName:ut.default.publicDomainName,preferDuplicateLocation:"local"}),s=a[0];x.zw({childStore:s,parentStore:n,transaction:e}),i.isTemplate()&&P.R3({parent:n.getTemplatePagesStore(),append:s,transaction:e}),F.navigateToBlock({environment:t,store:s,pageVisitSource:p.tY.Duplicate})}})}}),Vt=(0,b.PH)({key:"duplicate",displayName:S.sY.duplicateName,analyticsName:S.sY.duplicateName.defaultMessage,svg:h.Z.duplicate,validators:[Re.U7,Re.KE,Re.ff(Re.xk),...S.kv],shortcuts:["duplicate"],closeParentMenu:!0,action:e=>{let{blocks:t,environment:i}=e;if(!E.M_(i))return;const n=t[0].getParentStore();"block"!==(null==n?void 0:n.table)&&"team"!==(null==n?void 0:n.table)&&"space"!==(null==n?void 0:n.table)||T.VE({environment:i,store:t[0],newParent:n})}}),Ut=(0,b.PH)({key:"open in mac app",displayName:Ct.openinMacAppName,analyticsName:Ct.openinMacAppName.defaultMessage,svg:h.Z.notionLogo,validators:[Re.U7,Re.ff(Re.tY),Re.ff(Re.tq),Re.V5],closeParentMenu:!0,action:(e,t)=>{let{blocks:i,environment:n}=e;const a=(0,ht.ZP)({store:i[0],fullyQualified:!1,pageVisitSource:p.tY.AppRedirect});F.openInNativeApp({url:(0,gt.W)(a),environment:n})}}),Wt=(0,b.PH)({key:"open in windows app",displayName:Ct.openinWindowsAppName,analyticsName:Ct.openinWindowsAppName.defaultMessage,svg:h.Z.notionLogo,validators:[Re.U7,Re.ff(Re.tY),Re.ff(Re.tq),Re.ED],closeParentMenu:!0,action:(e,t)=>{let{blocks:i,environment:n}=e;const a=(0,ht.ZP)({store:i[0],fullyQualified:!1,pageVisitSource:p.tY.AppRedirect});F.openInNativeApp({url:(0,gt.W)(a),environment:n})}}),Kt=(0,b.PH)({key:"open in ios app",displayName:Ct.openiniOSAppName,analyticsName:Ct.openiniOSAppName.defaultMessage,svg:h.Z.notionLogo,validators:[Re.U7,Re.ff(Re.tY),Re.gn],closeParentMenu:!0,action:(e,t)=>{let{blocks:i,environment:n}=e;const a=(0,ht.ZP)({store:i[0],fullyQualified:!1,pageVisitSource:p.tY.AppRedirect});F.openInNativeApp({url:a,environment:n})}}),zt=(0,b.PH)({key:"open in android app",displayName:Ct.openinAndroidAppName,analyticsName:Ct.openinAndroidAppName.defaultMessage,svg:h.Z.notionLogo,validators:[Re.U7,Re.ff(Re.tY),Re.Dt],closeParentMenu:!0,action:(e,t)=>{let{blocks:i,environment:n}=e;const a=(0,ht.ZP)({store:i[0],fullyQualified:!1,pageVisitSource:p.tY.AppRedirect});F.openInNativeApp({url:a,environment:n})}}),Gt=(0,b.PH)({key:"open page updates",analyticsName:"Open page updates",displayName:Ct.pageUpdates,svg:h.Z.bell,validators:[Re.RF,Re.tq],closeParentMenu:!0,action:()=>{bt.Z.setState({open:!0})}}),qt=(0,b.PH)({key:"action page history",displayName:Ct.pageHistoryName,analyticsName:Ct.pageHistoryName.defaultMessage,svg:h.Z.versionHistory,validators:[Re.or([Re._T,Re.k5]),Re.Gg,Re.DF,Re.jl],closeParentMenu:!0,action:e=>{let{environment:t,blocks:i}=e;return A.jN({environment:t,blockStore:i[0],from:"topbar"})},render:(e,t)=>{let{onClick:i,key:n,...s}=e,{environment:r}=t;return a()(ct.Z,{requireUpgradeToTier:!1,analyticsName:"history_modal",onClick:i,alwaysAllowClick:!0,render:(e,t)=>o.createElement(R.Z,u()({},(0,O.Z)(s,e),{title:Le.default.formatMessage(Ct.pageHistoryName),svg:h.Z.versionHistory,dontShrinkRight:!0,right:t})),renderUpgradeTooltip:()=>{}},n)}}),Ht=(0,b.PH)({key:"open page trash",displayName:Ct.showDeletedPagesName,analyticsName:Ct.showDeletedPagesName.defaultMessage,svg:h.Z.showDeletedPages,validators:[Re.DF,Re.J5,Re.oY,Re.jl,Re.ff(Re.nJ)],closeParentMenu:!0,action:()=>{Mt.Z.setState({open:!0}),wt.Z.setState({...wt.Z.state,currentTab:"in_current_page"})}}),jt=(0,b.$J)({key:"pageHistory",render:e=>o.createElement(L.Z,e),actions:[Gt,S.Yw,qt,dt.pageAnalyticsMenu,Ht,S.Op]});var Qt=i(33665),Yt=i(13713),$t=i(83182),Xt=i(939),Jt=i.n(Xt),ei=i(49427);class ti extends G.Z{constructor(){super(...arguments),this.wordCount=0}willMount(){this.wordCount=this.getWordCount()}renderComponent(){return a()(o.Fragment,{},void 0,this.wordCount)}getWordCount(){const e=ei.Z.find((e=>e.props.store===this.props.store));if(e){const t=e.getContentWrapEl();if(t)return Jt()(t.innerText)}return 0}}ti.displayName="PageWordCount";const ii=ti;function ni(e){window.__c={n:"TopbarMoreMenu"};const{blockStore:t,onClickOriginRect:i,handleAccept:n,handleDismiss:c}=e,u=(0,s.O7)(),m=(0,s.Fy)(),p=(0,r.VK)((()=>({environment:u,blocks:[t],originRect:i,publicEditMode:void 0})),[u,t,i]),g=(0,r.VK)((()=>(0,pt.gE)()),[]),f=(0,r.VK)((()=>function(e){const{environment:t,context:i,showGetNotified:n}=e,a=i.blocks[0],s=a.getFollowSettingsKey(),r=(0,pt.m7)(),l=yt.default.checkGate("property_updates_notifications"),c=(0,d.defineMessages)({getNotifiedFor:{defaultMessage:"Get notified",id:"topbar.moreButton.getNotified"}}),u=l?vt.CA({followSettingsKey:s,environment:t,blockStore:a,from:"more_menu",useCopyChanges:r}):vt.Zk({followSettingsKey:s,environment:t,blockStore:a,from:"more_menu"});return[Pt,Ft,S.ww,(0,b.$J)({key:"topbar move or turn into actions",render:e=>o.createElement(L.Z,e),actions:[At,S.Ao]}),(0,b.$J)({key:"topbar database edit lock",render:e=>o.createElement(L.Z,e),actions:[S.cO,S.YZ,S.Bj,S.BC,S.fK,S.MR,Et]}),(0,b.$J)({key:"topbar page edit lock",render:e=>o.createElement(L.Z,e),actions:[Bt,Dt,Rt]}),(0,b.$J)({key:"topbar primary actions",render:e=>o.createElement(L.Z,e),actions:[Lt,S._p,S.zm,...n?[(0,b.MV)({key:"get notified for",displayName:c.getNotifiedFor,analyticsName:c.getNotifiedFor.defaultMessage,svg:h.Z.bell,width:300,validators:[],subActions:()=>[(0,b.$J)({key:"get notified for",render:e=>o.createElement(L.Z,e),actions:u.map((e=>{let{action:t}=e;return t}))})]})]:[],S.aU,Nt,Ot,Vt,S.DN,Ut,Wt,Kt,zt,S.l1,S.GZ]}),jt,(0,b.$J)({key:"topbar import actions",render:e=>o.createElement(L.Z,e),actions:[S.AP,S.q$,S.mS]}),lt(i)]}({environment:u,context:p,showGetNotified:"variant_1"===g})),[u,p,g]),v=(0,r.VK)((()=>!t.isCollectionView()&&t.canEdit()&&t.hasContent()),[t]),y=(0,r.VK)((()=>t.canEdit()),[t]),M=(0,r.VK)((()=>t.canEdit()&&t.isCollectionView()),[t]),w=(0,l.yK)((e=>({caption:{color:e.lightTextColor}})),[]),C=m.isMobile?{menuType:q.og.Modal,title:a()(d.FormattedMessage,{defaultMessage:"Actions",id:"topbarMoreButton.mobileActionsMenu.title"}),right:a()(ye.DoneMenuText,{}),onClickRight:c}:{menuType:q.og.Popup,maxHeight:"80vh"};return o.createElement(ve.Z,C,a()(fe.Z,{sections:f,onAccept:n,context:p}),a()(L.Z,{topBorder:!0},void 0,v&&a()(de.Z,{caption:a()("span",{style:w.caption},void 0,a()(d.FormattedMessage,{id:"pageMoreButton.wordCount.caption",defaultMessage:"Word count: {count}",values:{count:a()(ii,{store:t})}}))}),y&&a()(Yt.Z,{store:t,isPageMoreButton:!0})),M&&a()(ai,{}))}function ai(){return a()(L.Z,{topBorder:!0},void 0,a()($t.Z,{title:a()(d.FormattedMessage,{defaultMessage:"Learn about databases",id:"topbar.moreButton.collectionHelpButton"}),href:(0,Qt.UY)("guides.database"),analyticsFrom:"topbar_more_button"}))}},457:(e,t,i)=>{i.d(t,{Z:()=>u});var n=i(23174),a=i.n(n),o=(i(67294),i(13991)),s=i(24405),r=i(8848),l=i(1799),d=i(97880),c=i(82990);function u(e){window.__c={n:"MFABackupCodes"};const{type:t}=e,i=(0,s.yK)((e=>({pane:{display:"flex",whiteSpace:"pre-line",flexDirection:"column",alignItems:"center",justifyContent:"center",borderRadius:4,backgroundColor:r.FN.light.yellow[50],paddingTop:8,paddingBottom:8,marginBottom:10},textCode:{fontFamily:c.Z.getHeaderFontFamily({pageFont:"mono",locale:o.SP}),fontWeight:c.Z.fontWeight.regular,fontSize:c.Z.fontSize.UIRegular.desktop,font:c.Z.baseFontFamily.emailMono,color:r.FN.light.brown[500],textAlign:"center"},redactedBackupCode:{textDecoration:"line-through",opacity:.2}})),[]);return a()("div",{style:i.pane},void 0,a()("div",{style:i.textCode},void 0,"status"===t?e.status.map(((e,t)=>a()("div",{style:e.hasBeenUsed?i.redactedBackupCode:{}},t,l.A))):"unencryptedCodes"===t?e.backupCodes.map(l.K).join("\n"):(0,d.t1)(t)))}},56839:(e,t,i)=>{i.d(t,{R$:()=>h,ZP:()=>f});var n=i(23174),a=i.n(n),o=i(96486),s=i(67294),r=i(24405),l=i(82990),d=i(5366),c=i(33665),u=i(68785),m=i(88175),p=i(73602),g=i(11898);const h=6;function f(e){let{isLoading:t,phoneNumber:i,errorMessage:n,resentStatus:l,resentAt:f,onDismiss:y,onBack:S,onVerifyCode:b,onResendLink:M}=e;window.__c={n:"MFAPromptSMSVerification"};const w=(0,r.yK)(v,[]),[C,_]=(0,s.useState)([]),k=a()(d.FormattedMessage,{id:"profileSettings.mfa.sms.verifyCodeTitle",defaultMessage:"Verify phone number"}),T=s.createElement(s.Fragment,null,a()(d.FormattedMessage,{id:"profileSettings.mfa.sms.verifyCodeHeader.default",defaultMessage:"Enter the code sent to {phoneNumber} to complete setup.",values:{phoneNumber:i}})," ",s.createElement(p.y,{resentAt:f,resentStatus:l,onResendLink:M})),I={text:t?a()(u.Z,{}):a()(d.FormattedMessage,{id:"profileSettings.mfa.sms.verifyCodeButton",defaultMessage:"Verify code"}),onClick:()=>b(C.join("")),disabled:t||"resending"===l||(0,o.compact)(C).length!==h},P=[{text:a()(d.FormattedMessage,{id:"profileSettings.mfa.sms.verifyCodeNeedHelp",defaultMessage:"Need help?"}),href:(0,c.UY)("guides.mfa"),isExternal:!0,type:"link",view:"plain"}];return a()(m.Z,{title:k,header:T,errorMessage:n,primaryAction:I,secondaryActions:P,onDismiss:y,onBack:S,disableBackButton:t},void 0,a()("div",{style:w.body},void 0,a()(g.ZP,{numInputs:h,format:"settings",disabled:!1,value:C,onChange:_,autoFocus:!0,isValidKey:g.rN})))}function v(e){return(0,r.EM)({body:{width:"100%",display:"flex",flexDirection:"column",justifyContent:"center",marginTop:16,marginBottom:4},textCode:{fontWeight:l.Z.fontWeight.medium,fontSize:l.Z.fontSize.UIRegular.desktop,lineHeight:1.2,color:e.darkTextColor,marginTop:32,marginBottom:32,textAlign:"center"}})}},18469:(e,t,i)=>{i.d(t,{R$:()=>g,ZP:()=>h});var n=i(23174),a=i.n(n),o=i(96486),s=i(67294),r=i(24405),l=i(82990),d=i(5366),c=i(33665),u=i(68785),m=i(88175),p=i(11898);const g=6;function h(e){let{isLoading:t,errorMessage:i,onDismiss:n,onBack:l,onVerifyCode:h}=e;window.__c={n:"MFAPromptTOTPVerification"};const v=(0,r.yK)(f,[]),[y,S]=(0,s.useState)([]),b=a()(d.FormattedMessage,{id:"profileSettings.mfa.totp.verifyCodeTitle",defaultMessage:"Verify code"}),M=a()(d.FormattedMessage,{id:"profileSettings.mfa.totp.verifyCodeHeader",defaultMessage:"Enter the one-time code from authenticator to complete setup."}),w={text:t?a()(u.Z,{}):a()(d.FormattedMessage,{id:"profileSettings.mfa.totp.verifyCodeButton",defaultMessage:"Verify code"}),onClick:()=>h(y.join("")),disabled:t||(0,o.compact)(y).length!==g},C=[{text:a()(d.FormattedMessage,{id:"profileSettings.mfa.totp.needHelp",defaultMessage:"Need help?"}),href:(0,c.UY)("guides.mfa"),isExternal:!0,type:"link",view:"plain"}];return a()(m.Z,{title:b,header:M,errorMessage:i,primaryAction:w,secondaryActions:C,onDismiss:n,onBack:l,disableBackButton:t},void 0,a()("div",{style:v.body},void 0,a()(p.ZP,{numInputs:g,format:"settings",disabled:t,value:y,onChange:e=>{S(e)},autoFocus:!0,isValidKey:p.rN})))}function f(e){return(0,r.EM)({body:{width:"100%",display:"flex",flexDirection:"column",justifyContent:"center",marginTop:16,marginBottom:4},textCode:{fontWeight:l.Z.fontWeight.medium,fontSize:l.Z.fontSize.UIRegular.desktop,lineHeight:1.2,color:e.darkTextColor,marginTop:32,marginBottom:32,textAlign:"center"}})}},32357:(e,t,i)=>{i.d(t,{Z:()=>x});var n=i(23174),a=i.n(n),o=i(67294),s=i(83355),r=i(49085),l=i(53397),d=i(5366),c=i(97880),u=i(50906),m=i(57688),p=i(43250),g=i(4708),h=i(79817),f=i(45094),v=i(38755),y=i(8323),S=i(23537),b=i(85834),M=i(78291),w=i(42922),C=i(64921),_=i(12508),k=i(63296),T=i(31278),I=i(64369),P=i(22193);class Z extends s.Z{constructor(){super(...arguments),this.storeTypes={contextualInviteStore:b.ZP,isSpaceCardSelected:r.default.createClass(!1)},this.containerStyle={padding:12,display:"flex",flexDirection:"column",gap:16},this.iconStyle={width:20,height:20,fill:this.theme.lightIconColor}}didMount(){u.$24(this.environment,h.Oh(this.environment,this.stores.contextualInviteStore)),(0,S.$)(this.environment)&&this.stores.contextualInviteStore.setState({...this.stores.contextualInviteStore.state,selection:b.uq.page_guest})}renderComponent(){const{contextualInviteStore:e}=this.stores,t=e.getGuestEmails();if(!t.length)return null;const i=(0,S.$)(this.environment),n=(0,g.uW)({shouldCheck:e.state.inviteStage===b.TG.share_workspace});return o.createElement(o.Fragment,null,"copy_and_ui"===n?a()("div",{style:{paddingTop:16,paddingBottom:16,paddingLeft:18,paddingRight:18,background:"#F9F9F8",borderBottomWidth:1,borderBottomStyle:"solid",borderBottomColor:this.theme.regularDividerColor}},void 0,this.renderSpaceCard({showSpaceCardToggle:i,inviteModalExperimentGroup:n})):null,a()("div",{className:p.B8p,style:{...this.containerStyle,paddingTop:16,paddingBottom:16,paddingLeft:18,paddingRight:18}},void 0,a()("div",{},void 0,a()("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between"}},void 0,a()("div",{},void 0,e.state.inviteStage===b.TG.share_workspace?this.renderShareWorkspace({useZeroTeamsExperience:i,guestEmails:t}):o.createElement(o.Fragment,null,a()(I.Z,{style:{fontWeight:600,marginBottom:4}},void 0,a()(d.FormattedMessage,{id:"contextualInvite.requestToWorkspace.title",defaultMessage:"Request to add to workspace"})),a()(I.Z,{isMultiline:!0,isSmall:!0},void 0,a()(d.FormattedMessage,{id:"contextualInvite.requestToWorkspace.subtitle",defaultMessage:"Do you want to send a request to your workspace admin to add {emailCount, plural, one {this person} other {these people}} to the workspace?",values:{emailCount:t.length}}))),"copy_and_ui"!==n?a()("div",{style:{display:"flex",flexWrap:"wrap",marginTop:16,marginBottom:16}},void 0,this.renderEmailTokensSubtitle(t)):null)),"copy_and_ui"!==n?this.renderSpaceCard({showSpaceCardToggle:i}):null,a()("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:18}},void 0,a()(k.Z,{isLarge:!0,style:{marginRight:10},onClick:()=>{this.selectPageGuestOption(),this.handleInviteClick()}},void 0,a()(d.FormattedMessage,{id:"contextualInvite.skip.button",defaultMessage:"Skip for now"})),a()(w.Z,{isLarge:!0,disabled:i&&!this.stores.isSpaceCardSelected.state,onClick:()=>{e.state.inviteStage===b.TG.share_workspace&&this.selectWorkspaceMemberOption(),e.state.inviteStage===b.TG.request_workspace&&this.selectRequestWorkspaceMemberOption(),this.handleInviteClick()}},void 0,e.state.inviteStage===b.TG.share_workspace?a()(d.FormattedMessage,{id:"ContextualInvite.addToWorkspace.button",defaultMessage:"Add to workspace"}):a()(d.FormattedMessage,{id:"ContextualInvite.sendRequest.button",defaultMessage:"Send request"}))))))}getBillingInterval(){const e="year";if(!M.default.state.data)return e;const t="customerData"in M.default.state.data?M.default.state.data.customerData:void 0;return t&&"stripe"in t&&"interval"in t.stripe?"year"===t.stripe.interval?"year":"month":e}renderShareWorkspace(e){let{useZeroTeamsExperience:t,guestEmails:i}=e;return o.createElement(o.Fragment,null,a()(I.Z,{style:{fontWeight:600,marginBottom:4}},void 0,a()(d.FormattedMessage,{id:"contextualInvite.addToWorkspace.title",defaultMessage:"Add to workspace"})),a()(I.Z,{isMultiline:!0,isSmall:!0,style:{marginBottom:6}},void 0,a()(d.FormattedMessage,{id:"contextualInvite.addToWorkspace.subtitle",defaultMessage:"Do you want to add {emailCount, plural,\n\t\t\t\t\t\t\t\t\tone {this person}\n\t\t\t\t\t\t\t\t\tother {these people}\n\t\t\t\t\t\t\t\t} to the workspace in addition to the page? {isPaid, select,\n\t\t\t\t\t\t\t\t\ttrue {This is a billable event.}\n\t\t\t\t\t\t\t\t\tother {}\n\t\t\t\t\t\t\t\t}",values:{emailCount:i.length,isPaid:!(0,y.QM)()}})),a()(I.Z,{isMultiline:!0,isSmall:!0},void 0,a()(d.FormattedMessage,t?{id:"contextualInvite.addToWorkspace.zeroTeams.subtitle.blockLimit",defaultMessage:"Adding them as a member will auto-create a teamspace{isFreeTier, select,\n\t\t\t\t\t\t\t\t\tfree { and apply the 1,000 block limit to your workspace.}\n\t\t\t\t\t\t\t\t\tother {}\n\t\t\t\t\t\t\t\t}",values:{isFreeTier:(0,y.QM)()?"free":"paid"}}:{id:"contextualInvite.addToWorkspace.zeroTeams.subtitle",defaultMessage:"{isFreeTier, select,\n\t\t\t\t\t\t\t\t\tfree {This action will apply the 1,000 block limit to your workspace.}\n\t\t\t\t\t\t\t\t\tother {}\n\t\t\t\t\t\t\t\t}",values:{emailCount:i.length,isFreeTier:(0,y.QM)()?"free":"paid"}})))}renderEmailTokensSubtitle(e){const{spaceStore:t}=this.props;return e.map((e=>a()(P.Z,{store:t,tokenType:"guest",showRemoveButton:!1,target:{source:"email",type:"newUser",value:{email:e},spaceRole:"not_in_space"}},e)))}renderSpaceCard(e){let{showSpaceCardToggle:t,inviteModalExperimentGroup:i}=e;const{spaceStore:n}=this.props,o=(0,v.Wd)(this.environment,n),s=this.getSpaceName(),r=n.getPublicSpaceData();let c;r&&"none"!==r.role&&(c=a()(d.FormattedMessage,{id:"contextualInvite.spaceCard.subtitle",defaultMessage:"{numberOfWorkspaceMembers, plural, one {{numberOfWorkspaceMembers} member} other {{numberOfWorkspaceMembers} members}} · {planType}",values:{numberOfWorkspaceMembers:this.props.intl.formatNumber(r.memberCount),planType:this.props.intl.formatMessage((0,f.em)(r.subscriptionTier))}}));const u=o||s?a()(T.Z,{disabled:!0,icon:o,isEmptyPage:!1,title:s,size:30,style:{color:this.theme.regularTextColor,marginRight:12}}):l.Z.folder(this.iconStyle);return a()(C.Z,{style:{display:"flex",borderWidth:1,borderStyle:"solid",borderColor:this.theme.regularDividerColor,borderRadius:5,padding:12,justifyContent:"space-between",alignItems:"center",backgroundColor:"copy_and_ui"===i?this.theme.contentBackground:void 0},disabled:!t,onClick:()=>this.stores.isSpaceCardSelected.setState(!this.stores.isSpaceCardSelected.state)},void 0,a()("div",{style:{display:"flex"}},void 0,u,a()("div",{},void 0,a()(I.Z,{},void 0,s),a()(I.Z,{isSmall:!0},void 0,c))),t&&a()(_.Z,{round:!0,checked:this.stores.isSpaceCardSelected.state,fill:this.theme.contentBackground,size:20,onClick:()=>this.stores.isSpaceCardSelected.setState(!this.stores.isSpaceCardSelected.state)}))}getSpaceName(){const{spaceStore:e}=this.props;return(0,v.rn)(this.environment,e)}selectWorkspaceMemberOption(){this.stores.contextualInviteStore.setState({...this.stores.contextualInviteStore.state,selection:b.uq.workspace_member})}selectRequestWorkspaceMemberOption(){this.stores.contextualInviteStore.setState({...this.stores.contextualInviteStore.state,selection:b.uq.request_workspace_member})}selectPageGuestOption(){this.stores.contextualInviteStore.setState({...this.stores.contextualInviteStore.state,selection:b.uq.page_guest})}async handleInviteClick(){const{contextualInviteStore:e}=this.stores,{spaceStore:t,blockStore:i,intl:n}=this.props;if(e.state.inviteStage===b.TG.closed||e.state.inviteStage===b.TG.share_page)return;const{selection:a}=e.state;switch(a){case b.uq.request_workspace_member:u.cir(this.environment,{...h.Oh(this.environment,e),from:"share_menu"}),await h.fC({environment:this.environment,spaceStore:t,originId:i.id,originType:"share_menu",reasonMessage:void 0,contextualInviteStore:e,intl:n});break;case b.uq.workspace_member:if(u.E0y(this.environment,h.Oh(this.environment,e)),(0,S.$)(this.environment)){e.setState({...e.state,inviteStage:b.TG.closed});if(!(await m.HD({environment:this.environment,flowId:e.state.flowId??"",trackCreateTeamComplete:!1})))return}await h.j_({environment:this.environment,spaceStore:t,contextualInviteStore:e,from:"page_contextual_invite",intl:n});break;case b.uq.page_guest:e.reset();break;default:(0,c.t1)(a)}}}Z.displayName="ContextualInvite";const x=(0,d.injectIntl)(Z)},22193:(e,t,i)=>{i.d(t,{Z:()=>F});var n=i(10434),a=i.n(n),o=i(23174),s=i.n(o),r=i(67294),l=i(480),d=i(81954),c=i(24405),u=i(8848),m=i(84619),p=i(33728),g=i(53397),h=i(97880),f=i(82990),v=i(7928),y=i(5366),S=i(75472),b=i(16639),M=i(21115),w=i(53353),C=i(26781),_=i(25464),k=i(79315),T=i(55899),I=i(78291),P=i(58032),Z=i(45653),x=i(85567);const F=function(e){window.__c={n:"InviteTargetToken"};const{store:t,target:i}=e,n=(0,l.Fy)(),o=(0,y.useIntl)(),F=(0,c.yK)((()=>({verifiedDomain:{margin:"0",backgroundColor:"rgba(83, 168, 63, 0.1)"},disabled:{margin:"0",backgroundColor:"rgba(211, 79, 67, 0.1)",border:"dashed #D9655B 1px",paddingLeft:5},normal:{margin:"0"},guest:{margin:"0",backgroundColor:"rgba(218, 163, 64, 0.2)"},tokenContent:{display:"flex",alignItems:"center",maxWidth:"100%"},tokenSpan:{maxWidth:"100%"},tokenText:{marginLeft:4,...f.Z.textOverflowStyle}})),[]),A=(0,d.VK)((()=>{const{data:e}=I.default.state,t=e?M.CM(e):[],i={};return t.forEach((e=>{i[e.userId]=e})),i}),[]),E=(0,d.VK)((()=>{const e=k.default.state.currentSpaceStore;return new Set(null==e?void 0:e.getEmailDomains())}),[]),B=(0,w.Z)(t),D=(0,C.i)(t),R=(0,d.VK)((()=>{if(e.tokenType)return e.tokenType;if("group"===i.type)return"group";if("existingUser"===i.type&&!Boolean(i.spaceRole)){const e=A[i.value.id];i.spaceRole=e?e.role:"not_in_space"}if(!(0,S.OA)(i))return"member";const t=(0,p.Gd)(i.value.email);return t&&E.has(t)?"verifiedDomain":B.isStoreInTeam&&!B.teamAllowsGuests?"teamGuestDisabled":!B.isStoreInTeam&&!B.spaceAllowsGuests||B.isStoreInTeam&&!B.teamAllowsGuests&&!B.spaceAllowsGuests?"spaceGuestDisabled":"guest"}),[e.tokenType,i,A,E,B]),L=(0,d.VK)((()=>{switch(R){case"member":case"group":return F.normal;case"guest":return F.guest;case"verifiedDomain":return F.verifiedDomain;case"spaceGuestDisabled":case"teamGuestDisabled":case"teamGroupOwner":return F.disabled;default:(0,h.t1)(R)}}),[R,F]);function N(){const e=g.Z.help({height:16,width:16,color:"#D34F43"});switch(R){case"member":return(0,T.fZ)(i)?s()(Z.Z,{userValue:i.value,size:16}):(0,T.KU)(i)?s()(Z.Z,{size:16,avatar:i.value}):s()(Z.Z,{size:16});case"guest":return g.Z.globe2({height:16,width:16,color:"#DAA340"});case"verifiedDomain":return g.Z.circleCheck({height:16,width:16,color:"#53A83F"});case"group":return s()("div",{style:{height:16,width:16,backgroundColor:u.ZP.whiteWithAlpha(.8),borderRadius:"50%",display:"flex",justifyContent:"center",alignItems:"center"}},void 0,g.Z.typesPerson({height:12,width:12,color:u.ZP.mediumTextColor}));case"spaceGuestDisabled":case"teamGuestDisabled":case"teamGroupOwner":return e;default:(0,h.t1)(R)}}function O(t){const n=N();let a=function(){switch(i.type){case"newUser":return i.value.email.trim();case"existingUser":return(0,v.Nz)(o,i.value);case"group":return(0,b.kF)({intl:o,group:i.value});default:(0,h.t1)(i)}}(),r=F.tokenText;return e.onlyShowTokenType&&(["guest","teamGuestDisabled","spaceGuestDisabled"].includes(t)?(a="Guest",r={...r,color:"#DAA340"}):(a="Member",r={...r,color:"#53A83F"})),s()("div",{style:F.tokenContent},void 0,n,s()("div",{style:r},void 0,a))}function V(t){var i;t.stopPropagation(),null===(i=e.onClickRemove)||void 0===i||i.call(e)}const U="newUser"===i.type?i.value.email:i.value.id,W="group"!==i.type?i.value.email:void 0;return s()(P.Z,{placement:_.u.Top,renderTooltip:()=>function(e){const{tokenType:t,target:i,email:n}=e;return"guest"===t?s()(y.FormattedMessage,{defaultMessage:"{email} will be invited as a guest",id:"inviteTargetToken.guest.tooltip",values:{email:n}}):"spaceGuestDisabled"===t||"teamGuestDisabled"===t?D:"teamGroupOwner"===t&&"group"===i.type?s()(y.FormattedMessage,{defaultMessage:"Groups cannot be added as team owners.",id:"inviteTargetToken.groupTeamOwner.tooltip"}):"verifiedDomain"===t&&"group"!==i.type?r.createElement(r.Fragment,null,s()(y.FormattedMessage,{defaultMessage:"{email}{br}will automatically be added to the workspace{br}since @{domain} is a verified domain.",id:"inviteTargetToken.verifiedDomain.tooltip",values:{email:i.value.email,br:s()("br",{}),domain:(0,p.Gd)(i.value.email)}})):"group"===i.type?i.value.name:n}({tokenType:R,email:W,target:i}),render:t=>r.createElement("span",a()({style:F.tokenSpan},t),s()(x.Z,{isSingle:!1,format:n.isMobile?m.l.Large:m.l.Medium,showRemoveButton:e.showRemoveButton,onClickRemove:V,disabledFeedback:!0,value:O(R),style:L,shouldWrap:!1}))},U)}},20346:(e,t,i)=>{i.d(t,{Z:()=>v});var n=i(23174),a=i.n(n),o=(i(67294),i(480)),s=i(81954),r=i(24405),l=i(53397),d=i(5366),c=i(50906),u=i(33665),m=i(23537),p=i(16354),g=i(89728),h=i(64369);function f(e){window.__c={n:"LearnAboutSharingLink"};const t=(0,o.O7)(),{device:i,WindowSizeStore:n}=t,f=(0,s.VK)((()=>({left:n.getSafePaddingLeftCSS(8),right:n.getSafePaddingRightCSS(12)})),[n]),v=(0,s.VK)((()=>(0,m.bq)()),[]),y=(0,r.yK)((e=>({button:{display:"flex",alignItems:"center",width:i.isMobile?"100%":void 0,height:i.isMobile?44:24,paddingTop:i.isMobile?12:4,paddingBottom:i.isMobile?12:4,paddingLeft:f.left,paddingRight:f.right},helpIcon:{width:i.isMobile?16:14,height:i.isMobile?16:14,fill:i.isMobile?e.mediumIconColor:e.lightIconColor}})),[i.isMobile,f]);return a()(p.Z,{href:(0,u.UY)("guides.sharing"),onClick:()=>c.Fsx(t,{from:"sharing"}),style:{width:i.isMobile?"100%":void 0},external:!0},void 0,a()(g.Z,{mobileFeedback:i.isMobile,isSmall:!0,style:{...y.button,...e.style},disabled:Boolean(e.disableHover)},void 0,a()("div",{style:{marginLeft:i.isMobile?2:0,marginRight:i.isMobile?8:6}},void 0,l.Z.help(y.helpIcon)),a()(h.Z,{isSmall:!0,isMobile:i.isMobile,isSecondaryColor:!i.isMobile},void 0,a()(d.FormattedMessage,v?{defaultMessage:"Learn more",id:"blockPermissionsSettings.learnMore.prompt"}:{defaultMessage:"Learn about sharing",id:"blockPermissionsSettings.learnAboutSharing.prompt"}))))}f.displayName="LearnAboutSharingLink";const v=f},37432:(e,t,i)=>{i.d(t,{Z:()=>U});var n=i(10434),a=i.n(n),o=i(23174),s=i.n(o),r=i(96486),l=i.n(r),d=i(67294),c=i(83355),u=i(15145),m=i(8848),p=i(27006),g=i(21202),h=i(29369),f=i(97880),v=i(82990),y=i(5366),S=i(47307),b=i(57688),M=i(84210),w=i(21115),C=i(23537),_=i(31075),k=i(61766),T=i(68216),I=i(48690),P=i(78291),Z=i(64921),x=i(84076),F=i(31278),A=i(76798),E=i(58032),B=i(64369),D=i(7567),R=i(81954),L=i(24405);function N(e){window.__c={n:"NameAndIconWrap"};const{store:t}=e,i=(0,R.VK)((()=>t.getIcon()),[t]),n=(0,L.yK)((()=>({container:{whiteSpace:"nowrap",fontWeight:v.Z.fontWeight.bold},recordIcon:{marginRight:4,display:"inline-block",verticalAlign:"middle"},recordTitle:{display:"inline"}})),[]);return s()("span",{style:n.container},void 0,i&&s()(F.Z,{disabled:!0,icon:i,isEmptyPage:!1,size:12,style:n.recordIcon}),s()(A.Z,{store:t,style:n.recordTitle}))}const O=function(e){const{store:t}=e;return s()(y.FormattedMessage,{defaultMessage:"This access is based on {inlineIconAndName}. Changing this access will restrict permissions of this page.",id:"blockPermissionsSettings.restrictedPermissions.tooltip",values:{inlineIconAndName:s()(N,{store:t})}})};class V extends c.Z{constructor(){super(...arguments),this.storeTypes={buttonPopupStore:k.Z},this.permissionItemStore=void 0,this.handleRoleSelect=async e=>{if(this.isDisplayOnlyPermissionItem(this.props.permissionItem))return;const t=this.props.permissionItem,i=l().clone(t);i.role=e;const n=this.props.currentBlockStore.isTopLevel();if(n&&p.ix(i)){const{data:e}=P.default.state,a=e?w.su(e):1;if(!(0,C.bq)()&&p.YX(t.role)&&!p.YX(i.role)&&a>1){if(!(await S.confirmUserAction({message:s()("span",{},void 0,s()(y.FormattedMessage,{defaultMessage:"Are you sure you want to make this page private? <semibold>Only you will be able to access it.</semibold>",values:{semibold:e=>s()("span",{style:{fontWeight:v.Z.fontWeight.semibold}},void 0,e)},id:"blockPermissionsSettings.confirmationDialog.private.message"})),acceptLabel:s()(y.FormattedMessage,{defaultMessage:"Move to Private",id:"blockPermissionsSettings.confirmationDialog.privateButton.label"})})))return}else if(!(0,C.bq)()&&n&&!p.YX(t.role)&&p.YX(i.role)){if(!(await S.confirmUserAction({message:s()("span",{},void 0,s()(y.FormattedMessage,{defaultMessage:"Are you sure you want to share this page with the workspace? <semibold>It will be accessible by all {memberCount} members.</semibold>",id:"blockPermissionsSettings.confirmationDialog.workspace.message",values:{semibold:e=>s()("span",{style:{fontWeight:v.Z.fontWeight.semibold}},void 0,e),memberCount:a}})),acceptLabel:s()(y.FormattedMessage,{defaultMessage:"Move to workspace",id:"blockPermissionsSettings.confirmationDialog.workspaceButton.label"})})))return}}await(0,_.i)({oldPermissionItem:t,newPermissionItem:i,wasInherited:this.isInherited(),environment:this.environment,store:this.props.currentBlockStore,sudoModeStore:this.props.sudoModeStore,location:this.props.location,fromPermissionWrapper:this.props.fromPermissionWrapper})},this.handleUserItemClick=()=>{this.stores.buttonPopupStore.setState({...this.stores.buttonPopupStore.state,open:!0})},this.getPermissionItemStore=()=>{const{from:e,currentBlockStore:t}=this.props,i=e.table;return i===g.iU?T.G.createChildStore(t,{table:g.iU,id:e.blockId}):i===h.e0?T.zX.createChildStore(t,{table:h.e0,id:e.teamId}):void(0,f.t1)(i)}}willMountOrUpdate(){this.permissionItemStore=this.getPermissionItemStore()}renderComponent(){const{device:e}=this.environment,t=this.props.onClick?this.props.onClick:this.handleUserItemClick,i=this.isDisabled(),n=this.renderTooltip();return s()(E.Z,{delayThreshold:0,renderTooltip:()=>n,textWrap:!0,disableTooltip:!Boolean(n),style:{maxWidth:240},render:n=>d.createElement(Z.Z,a()({disabled:i,mobileFeedback:e.isMobile,ignoreLocalHoverState:this.props.ignoreLocalHoverState,style:{...i?{cursor:"not-allowed"}:{}},onClick:t},n),this.renderMenuItem()),placement:E.Z.Placement.Left})}renderMenuItem(){const{device:e}=this.environment,{showInherited:t,permissionItem:i}=this.props,n=this.isUserItem(),a=this.isInherited();return s()("div",{className:"notranslate",style:this.getMenuItemStyle()},void 0,s()("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",width:32,height:32,marginRight:e.isMobile?12:10,...this.props.iconStyle}},void 0,this.props.icon),s()("div",{style:{marginRight:"auto",minWidth:0}},void 0,s()("div",{style:{display:"flex",flexDirection:"row"}},void 0,s()(B.Z,{style:{...!n&&{fontWeight:400}}},void 0,this.props.title),this.props.tag&&s()("div",{style:{marginLeft:4}},void 0,this.props.tag)),this.props.subtitle&&s()(B.Z,{isSmall:!0},void 0,this.props.subtitle),t&&a&&this.renderInheritedRecordTitle()),s()("div",{style:{display:"flex",alignItems:"center",flexShrink:0,marginLeft:8}},void 0,this.props.permissionRoleSelect?this.props.permissionRoleSelect:!this.isDisplayOnlyPermissionItem(i)&&s()(D.ZP,{role:this.role,table:g.iU,blockType:this.props.currentBlockStore.getType(),type:i.type,disabled:this.isDisabled(),isUserPermission:this.permissionItemIsUserItem(i),onChange:this.handleRoleSelect,onUpgradeButtonClick:this.props.onUpgradeButtonClick,upgradeButtonName:this.props.upgradeButtonName,buttonPopupStore:this.stores.buttonPopupStore,buttonStyle:{marginRight:-8,color:this.theme.mediumTextColor,fontSize:e.isMobile?14:12},showPermissionOverrideWarning:a,isRemovableOverride:this.props.isRemovableOverride})))}renderTooltip(){return this.isInherited()?!this.isTeamOuterItem()&&this.permissionItemStore?s()(O,{store:this.permissionItemStore}):null:this.props.nonInheritedTooltip}renderInheritedRecordTitle(){const e=this.permissionItemStore||this.getPermissionItemStore(),t=e.table===g.iU?(0,M.ZP)({store:e,fullyQualified:!1,pageVisitSource:u.tY.LinkInPage}):void 0,i=e.table===h.e0?()=>{e.table===h.e0&&b.RF({environment:this.environment,teamId:e.id,tab:I.a.Members,from:"permission_item"})}:void 0,{device:n}=this.environment,a=e.getIcon(),o="team"!==e.table&&e.isEmptyPage();return s()(B.Z,{isSmall:!0,style:{lineHeight:1.4}},void 0,n.isMobile?s()(y.FormattedMessage,{defaultMessage:"Based on {linkBoxWithPageTitle}",id:"pagePermissionItem.inheritedRecordPermissions.setting",values:{linkBoxWithPageTitle:s()(x.Z,{disabled:n.isMobile,underline:!n.isMobile,inline:!0,href:t,onClick:i},void 0,s()(A.Z,{store:e,style:{display:"inline"}}))}}):s()(y.FormattedMessage,{defaultMessage:"From {linkBoxWithPageTitle}",id:"pagePermissionItem.fromInheritedRecordPermissions.setting",values:{linkBoxWithPageTitle:s()(x.Z,{disabled:n.isMobile,underline:!1,inline:!0,href:t,onClick:i,innerStyle:{display:"inline-flex",alignItems:"center",borderBottom:`0.5px solid ${m.ZP.mediumTextColor}`}},void 0,s()(F.Z,{disabled:!0,style:{marginRight:4},icon:a,size:14,isEmptyPage:o}),s()(A.Z,{store:e,style:{display:"inline",fontWeight:v.Z.fontWeight.semibold}}))}}))}permissionItemIsUserItem(e){const t=this.environment.currentUser.id;return"user_permission"===e.type&&e.user_id===t}isUserItem(){return"user_permission"===this.props.permissionItem.type}isTeamOuterItem(){return"team_overview_permission"===this.props.permissionItem.type}get role(){const{permissionItem:e,currentBlockStore:t}=this.props;if(this.isDisplayOnlyPermissionItem(e))return"none";if("content_only_editor"===e.role&&this.isInherited()){var i,n;const a=t.getParentCollectionStore(),o=null==a?void 0:a.getParentBlockStore();return o&&o.table===(null===(i=this.permissionItemStore)||void 0===i?void 0:i.table)&&o.id===(null===(n=this.permissionItemStore)||void 0===n?void 0:n.id)?e.role:"read_and_write"}return e.role}isDisabled(){return"hidden_permission"===this.props.permissionItem.type||!this.isTeamOuterItem()&&!this.props.currentBlockStore.canAdmin()}isInherited(){var e;return(null===(e=this.permissionItemStore)||void 0===e?void 0:e.id)!==this.props.currentBlockStore.id}isDisplayOnlyPermissionItem(e){return"team_overview_permission"===e.type||"hidden_permission"===e.type}getMenuItemStyle(){const{WindowSizeStore:e}=this.environment;return{display:"flex",alignItems:"center",minHeight:this.props.isCompact?44:52,paddingTop:8,paddingBottom:8,paddingLeft:e.getSafePaddingLeftCSS(14),paddingRight:e.getSafePaddingRightCSS(14)}}}V.displayName="PermissionItem",V.iconSize=32;const U=V},53469:(e,t,i)=>{i.r(t),i.d(t,{OfflineMessage:()=>Jn,default:()=>ea});var n=i(10434),a=i.n(n),o=i(23174),s=i.n(o),r=i(67294),l=i(480),d=i(81954),c=i(24405),u=i(5366),m=i(43250),p=i(87279),g=i(33665),h=i(96486),f=i.n(h),v=i(26825),y=i(27006),S=i(21202),b=i(90468),M=i(29369),w=i(28020),C=i(98165),_=i(67669),k=i(23537),T=i(79315),I=i(68216);function P(e){const{store:t}=e;if(t.getParentTable()===b.bx)return!1;const i=(0,C.Om)(t),n=i?(0,v.Wo)((0,C.fJ)(i)):[],a=t.getPermissionItems(),o={};for(const s of n)o[(0,v.OC)(s)]=s;for(const s of a){const e=s.role,t=o[(0,v.OC)(s)];if(t){if((0,y.iC)(e)&&(0,y.iC)(t.role)&&(0,v.xO)(e,t.role))return!0;if(y.KF(t)&&!y.KF(s))return!0}else if((0,y.ix)(s)||(0,y.ZQ)(s)||(0,y.RI)(s))return!0}return!1}function Z(e){const{store:t}=e,i=(0,C.uJ)(t)[1];return{parentStore:i,canAccessParent:i&&i.canRead()}}function x(e){const{mostPermissivePermissions:t,store:i,teamId:n,type:a}=e;if(!n)return;const o=t.find((e=>{let{permissionItem:t}=e;return t.type===a}));if(o)return o;const s=t.find((e=>{let{permissionItem:t}=e;return y.Le(t)}));return"explicit_team_guest_permission"!==a||s?{permissionItem:{type:a,role:"none",team_id:n},from:(null==s?void 0:s.from)??{table:S.iU,blockId:i.id}}:void 0}function F(e){const{environment:t,spaceStore:i,store:n}=e,a=(0,_.YO)(n);let o=[];i&&(o=i.getPermissionGroups());const s=C.VP(n),r=function(e){let{mostPermissivePermissions:t,store:i}=e;return t.find((e=>{let{permissionItem:t}=e;return y.$D(t)}))||{permissionItem:{type:"public_permission",role:"none"},from:{table:S.iU,blockId:i.id}}}({mostPermissivePermissions:a,store:n}),l=function(e){let{mostPermissivePermissions:t,store:i,teamStore:n}=e;const a=t.find((e=>{let{permissionItem:t}=e;return y.ix(t)}));if(a)return a;const o=t.find((e=>y.Le(e.permissionItem)));return{permissionItem:{type:"space_permission",role:"none"},from:null!=o&&o.from||!n||"none"!==n.getSpacePermissionRole()?(null==o?void 0:o.from)??{table:S.iU,blockId:i.id}:{table:M.e0,teamId:n.id}}}({mostPermissivePermissions:a,store:n,teamStore:s}),d=x({mostPermissivePermissions:a,store:n,teamId:null==s?void 0:s.id,type:"explicit_team_guest_permission"}),c=x({mostPermissivePermissions:a,store:n,teamId:null==s?void 0:s.id,type:"explicit_team_permission"}),u=x({mostPermissivePermissions:a,store:n,teamId:null==s?void 0:s.id,type:"explicit_team_owner_permission"});let m=a.filter((e=>{let{permissionItem:t}=e;return y.hV(t)}));m=f().sortBy(m,(e=>{if(i){return i.getPermissionGroups().findIndex((t=>t.id===e.permissionItem.group_id))}return e.permissionItem.group_id}));let p=a.filter((e=>{let{permissionItem:t}=e;return(y.zU(t)||y.LW(t))&&t.team_id!==(null==s?void 0:s.id)}));const g=new Map;p.forEach(((e,t)=>{let{permissionItem:i}=e;g.has(i.team_id)||g.set(i.team_id,t)})),p=f().sortBy(p,[e=>{let{permissionItem:t}=e;return g.get(t.team_id)||0},e=>{let{permissionItem:t}=e;return"explicit_team_owner_permission"===t.type?0:1}]);const h=a.filter((e=>{let{permissionItem:t}=e;return y.jg(t)})),v=(0,w.k_)(t).state,b=Boolean(null==s?void 0:s.isDefined());let T=v&&v.showWorkspaceSection||i&&"team"===i.getPlanType()||"none"!==l.permissionItem.role;(0,k.bq)()&&(T=i&&"team"===i.getPlanType()||"none"!==l.permissionItem.role);const I=T||b||h.length>1||h.length&&!y.zz(h[0].permissionItem.role)||m.length||y.YX(l.permissionItem.role);return{showRestrictedPermissionBanner:a.some((e=>y.Le(e.permissionItem)&&e.from.table===S.iU&&e.from.blockId===n.id)),showTeamPermission:b,showSpacePermission:T,mostPermissivePublicItem:r,mostPermissiveTeamOwnerItem:u,mostPermissiveTeamMemberItem:c,mostPermissiveTeamGuestItem:d,mostPermissiveSpaceItem:l,pagePermissionUIModel:{showUserPermissions:I,mostPermissiveGroupPermissions:m,mostPermissiveTeamPermissions:p,mostPermissiveUserPermissions:h,spacePermissionGroups:o},permissionItemsCount:(I?h.length:0)+p.length+m.length+(T?1:0)+(b?1:0)}}var A=i(92994),E=i(88632),B=i(85834),D=i(97238),R=i(52878),L=i(1743),N=i(56940),O=i(78140),V=i(40721),U=i(64369),W=i(46247),K=i(32357),z=i(97880),G=i(55899),q=i(41892),H=i(8848),j=i(53397),Q=i(82990),Y=i(51456);var $=i(51077),X=i(73063),J=i(66957),ee=i(22421);function te(e){let{inviteTargetsStore:t,mostPermissivePublicItem:i}=e;window.__c={n:"ShareMenuHeader"};const{display:n,source:a}=(0,d.VK)((()=>{const{display:e}=D.ZP.state;if(e===D.wV.Invite){const{source:t}=D.ZP.state;return{display:e,source:t}}return{display:e,source:void 0}}),[]);switch(n){case D.wV.MainShareMenu:case D.wV.Publish:return s()(ne,{mostPermissivePublicItem:i});case D.wV.Invite:if("notion"===a)return s()(oe,{inviteTargetsStore:t});if("slack"===a)return s()(se,{});throw(0,z.t1)(a);default:(0,z.t1)(n)}}const ie=[D.XF.Share,D.XF.Publish];function ne(e){let{mostPermissivePublicItem:t}=e;window.__c={n:"ShareMenuTabs"};const i=(0,l.O7)(),n=r.useRef(null),{isMobile:o}=i.device,m=(0,d.VK)((()=>D.ZP.state.tab),[]),p=(0,c.yK)((e=>({tabStyle:{color:e.lightTextColor,...o&&{width:"50%",textAlign:"center"}},selectedTabStyle:{fontWeight:Q.Z.fontWeight.medium},tabTitleStyle:{color:"inherit"},style:o?{marginBottom:8,justifyContent:"space-between"}:{marginBottom:14}})),[o]),g=(0,c.yK)((()=>({publishTabContainer:{display:"flex",alignItems:"center"}})),[]),h=(0,r.useCallback)((e=>{const t=ie[e];t!==m&&(!function(e,t){Y.j(e,"share_menu_tab_click",t)}(i,{tab:t}),t===D.XF.Share&&D.ZP.setState({...D.ZP.state,display:D.wV.MainShareMenu,tab:D.XF.Share}),t===D.XF.Publish&&D.ZP.setState({...D.ZP.state,display:D.wV.Publish,tab:D.XF.Publish}))}),[m,i]),f="none"!==t.permissionItem.role,v=[r.createElement(r.Fragment,null,o?s()(u.FormattedMessage,{defaultMessage:"Permissions",id:"shareMenu.permissionsTab.title"},"permissions"):s()(u.FormattedMessage,{defaultMessage:"Share",id:"shareMenu.shareTab.title"},"share")),r.createElement("div",{key:"publishTab",ref:n,style:g.publishTabContainer},s()(u.FormattedMessage,{defaultMessage:"Publish",id:"shareMenu.publishTab.title"},"publish"),f&&ae.publishedCheckIcon({opacity:m===D.XF.Publish?1:.5}),s()(ee.jG,{originRef:n}))];return r.createElement(J.Z,a()({},p,{tabs:v,selectedIndex:ie.indexOf(m),onChange:h}))}const ae={[D.XF.Share]:j.Z.iOSShare({height:17,width:17,marginRight:4}),[D.XF.Publish]:j.Z.globe3({height:15,width:15,marginRight:4}),publishedCheckIcon:e=>{let{opacity:t}=e;return j.Z.circleCheckFilled({color:H.ZP.blue,width:14,height:14,marginLeft:4.5,opacity:t})}};function oe(e){let{inviteTargetsStore:t}=e;window.__c={n:"InviteFromNotionHeader"};const i=(0,c.yK)((()=>({container:{display:"flex",margin:"0 12px 6px",height:48}})),[]),n=(0,r.useCallback)((()=>{t.reset(),D.ZP.setState({...D.ZP.state,display:D.wV.MainShareMenu,tab:D.XF.Share})}),[t]);return s()("div",{style:i.container},void 0,s()(re,{onClick:n}))}function se(){window.__c={n:"InviteFromSlackHeader"};const e=(0,u.useIntl)(),t=(0,c.yK)((()=>({container:{display:"flex",justifyContent:"space-between",margin:"0 12px",height:48,alignItems:"center"},titleLabel:{display:"flex",fontSize:12,alignItems:"center",fontWeight:Q.Z.fontWeight.semibold}})),[]),i=(0,r.useCallback)((()=>{D.ZP.setState({...D.ZP.state,tab:D.XF.Share,display:D.wV.Invite,source:D.T5.Notion,focus:D.Sw.Search,emailMessage:""})}),[]),n=r.createElement(r.Fragment,null,s()($.Z,{type:"image_url",imageURL:q.Z.images.externalIntegrations.slackIconPng,size:18,imageStyle:{marginLeft:4,marginRight:4}}),s()(u.FormattedMessage,{defaultMessage:"Slack",id:"shareMenu.slackIntegrationName.label"}));return s()("div",{style:t.container},void 0,s()(U.Z,{style:t.titleLabel},void 0,s()(u.FormattedMessage,{id:"shareMenu.addFromSlack.label",defaultMessage:"Add people from {integrationNameWithLogo}",values:{integrationNameWithLogo:n}})),s()(X.Z,{ariaLabel:e.formatMessage({id:"shareMenuHeader.goBackToInviteFromNotionMenu.iconButton",defaultMessage:"Close slack integration and go back to the main invite flow."}),icon:j.Z.closeSmall,style:{borderRadius:"100%"},onClick:i}))}function re(e){window.__c={n:"BackButton"};const{onClick:t}=e,i=(0,u.useIntl)(),n=(0,c.yK)((()=>({topContainer:{display:"flex",alignItems:"center",width:"max-content"},backButtonPressedStyle:{backgroundColor:"transparent"},iconButton:{marginRight:6,height:24,width:24},arrowIcon:{height:16,width:16,strokeWidth:Q.Z.fontWeight.semibold},sendInviteLabel:{fontWeight:Q.Z.fontWeight.medium}})),[]);return s()("div",{style:n.topContainer},void 0,s()(X.Z,{icon:j.Z.arrowLeftThick,iconStyle:n.arrowIcon,style:n.iconButton,onClick:t,ariaLabel:i.formatMessage({id:"shareMenu.backButton.iconButton",defaultMessage:"Go back to main share menu."})}),s()(U.Z,{style:n.sendInviteLabel},void 0,s()(u.FormattedMessage,{id:"shareMenu.sendInvite.label",defaultMessage:"Send invite"})))}function le(e){const{store:t}=e;return(0,d.VK)((()=>{const e=T.default.state.currentSpaceStore,i=(0,C.VP)(t);return i?{isPublicAccessDisabled:Boolean(i.getDisablePublicAccess()),disabledBy:"team"}:{isPublicAccessDisabled:Boolean(null==e?void 0:e.getDisablePublicAccess()),disabledBy:"space"}}),[t])}var de=i(31075),ce=i(42922);function ue(e){window.__c={n:"PublishToWeb"};const{store:t,mostPermissivePublicItem:i,permissionItemArgs:n}=e,{permissionItem:a,from:o}=i,{sudoModeStore:m,location:p}=n,g=(0,l.O7)(),h=(0,d.VK)((()=>t.canAdmin()),[t]),{isPublicAccessDisabled:f}=le({store:t}),v=!h||f,y=(0,c.yK)((e=>({container:{display:"flex",flex:1,justifyContent:"center",alignItems:"center",flexDirection:"column",padding:32,textAlign:"center",cursor:v?"not-allowed":""},icon:{height:30,width:30,marginBottom:10,fill:e.mediumIconColor},title:{fontWeight:Q.Z.fontWeight.semibold,fontSize:14,marginBottom:6},caption:{marginLeft:26,marginRight:26,marginBottom:20},button:{display:"flex",width:"100%",padding:16,cursor:v?"not-allowed":"pointer"}})),[v]),b=(0,d.VK)((()=>{var e;return null===(e=T.default.state.currentSpaceStore)||void 0===e?void 0:e.getDisableMoveToSpace()}),[]),M=o.table===S.iU?o.blockId:o.teamId,w=(0,r.useCallback)((()=>{const e=!b&&a.allow_duplicate;(0,de.i)({oldPermissionItem:a,newPermissionItem:{...a,role:"reader",allow_duplicate:e},wasInherited:M!==t.id,environment:g,store:t,sudoModeStore:m,location:p})}),[g,M,p,b,a,t,m]);return s()("div",{style:y.container},void 0,j.Z.globe3(y.icon),s()("div",{style:y.title},void 0,s()(u.FormattedMessage,{defaultMessage:"Publish to web",id:"publishTab.publishToWeb.title"})),s()(U.Z,{isMultiline:!0,isSecondaryColor:!0,style:y.caption},void 0,s()(me,{store:t})),s()(ce.Z,{style:y.button,disabled:v,onClick:w},void 0,s()(u.FormattedMessage,{defaultMessage:"Publish to web",id:"publishTab.publishToWeb.button"})))}function me(e){let{store:t}=e;window.__c={n:"PublishToWebMessage"};const{isPublicAccessDisabled:i,disabledBy:n}=le({store:t}),a=(0,d.VK)((()=>t.canAdmin()),[t]);return s()(u.FormattedMessage,i?"team"===n?{defaultMessage:"Publishing to web is disabled for this page via teamspace settings.",id:"publishTab.publishToWeb.disabledByTeamspace.caption"}:{defaultMessage:"Publishing to web is disabled for this page via workspace settings.",id:"publishTab.publishToWeb.disabledByWorkspace.caption"}:a?{defaultMessage:"Publish a static website of this page. You can allow others to view, duplicate, and remix.",id:"publishTab.publishToWeb.hasFullAccess.caption"}:{defaultMessage:"You must have full access to this page to publish to web.",id:"publishTab.publishToWeb.noFullAccess.caption"})}var pe=i(15145),ge=i(5978),he=i(84210),fe=i(81236),ve=i(63296),ye=i(58032),Se=i(91376);function be(e){window.__c={n:"LearnAboutAutogeneratedDomainsCTA"};const t=(0,l.O7)(),{WindowSizeStore:i}=t,{safePaddingLeftCSS:n,safePaddingRightCSS:o}=(0,d.VK)((()=>({safePaddingLeftCSS:i.getSafePaddingLeftCSS(8),safePaddingRightCSS:i.getSafePaddingRightCSS(8)})),[i]),{isMobile:m}=(0,l.Fy)(),{spaceStore:p,canChangeSettings:g,publicSpaceData:h}=(0,d.VK)((()=>{const e=T.default.state.currentSpaceStore;return e?{spaceStore:e,canChangeSettings:e.canAdmin(),publicSpaceData:fe.Z.getPublicSpaceData(t,e.id)}:{}}),[t]),f=(0,c.yK)((t=>({container:{boxShadow:`0 -1px 0 ${t.regularDividerColor}`,width:"100%",display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",textAlign:"center",padding:"8px 8px",paddingLeft:n,paddingRight:o,color:t.mediumTextColor,backgroundColor:t.inputBackground,...e.style}})),[e.style,n,o]);if(!p)return null;if(m)return null;if(!h)return null;return h.domainIsAutogenerated&&g?s()("span",{style:f.container},void 0,s()("div",{style:{display:"flex"}},void 0,r.createElement(U.Z,a()({isSmall:!0,isMobile:!1,isSecondaryColor:!0,style:{paddingRight:"4px"}},e.labelStyle),s()(u.FormattedMessage,{defaultMessage:"Set a domain for your public links in",id:"blockPermissionsSettings.learnAboutAutogeneratedDomains.setDomainForPublicLinks"})),s()("span",{style:{cursor:"pointer",userSelect:"none",WebkitUserSelect:"none",color:H.ZP.inherit},onClick:()=>{Se.r({currentTab:"settings"})}},void 0,r.createElement(U.Z,a()({isSmall:!0,isMobile:!1,isSecondaryColor:!1,style:{textDecoration:"underline"}},e.labelStyle),s()(u.FormattedMessage,{defaultMessage:"Settings",id:"blockPermissionsSettings.learnAboutAutogeneratedDomains.openSettingsCTA"}))))):null}var Me=i(98459),we=i(50906),Ce=i(43132),_e=i(33929),ke=i(21115),Te=i(5162),Ie=i(10161),Pe=i(64921),Ze=i(74194),xe=i(89728),Fe=i(24006),Ae=i(60442),Ee=i(42115),Be=i(37432),De=i(13991),Re=i(7057),Le=i(63143),Ne=i(61766),Oe=i(31194),Ve=i(52275),Ue=i(31945),We=i(32163),Ke=i(72495),ze=i(93289),Ge=i(95030);function qe(e){window.__c={n:"PublicPermissionItemLinkExpirationMenu"};const t=(0,l.Fy)(),[,,i]=(0,d.AF)(void 0,Ne.Z),n=(0,c.Fg)(),o=(0,l.O7)(),g=(0,d.VK)((()=>(0,ke.y$)(o)),[o]),{buttonMenuItemStyle:h}=(0,c.yK)((()=>({buttonMenuItemStyle:{opacity:e.disabled?.6:1,cursor:e.disabled?"not-allowed":""}})),[e.disabled]);return r.createElement(Ue.ZP,a()({},e.upsellEvents,{disablePopup:!g,disabled:e.disabled,popupType:t.isMobile?Ue.Z4.SlideUp:Ue.Z4.Popup,buttonPopupStore:i,renderOrigin:t=>r.createElement(Ve.Z,a()({},t,{focused:!1,disabled:e.disabled,style:h,title:s()(U.Z,{},void 0,s()(u.FormattedMessage,{id:"publicPermissionItem.expirationTime.label",defaultMessage:"Link expires"})," ",e.upgradeLabel),right:r.createElement(xe.Z,a()({},t,{disabled:e.disabled,ignoreLocalHoverState:!0,style:{paddingLeft:0,paddingRight:0}}),s()(He,{permissionItem:e.permissionItem}),j.Z.chevronDown({width:10,marginLeft:4,fill:n.lightIconColor}))})),alignmentToOrigin:Oe.lU.End,placementToOrigin:Oe.Iw.Bottom,render:i=>{const n=[{key:"options",render:e=>r.createElement(Ke.Z,e),items:Qe().map((t=>({key:t.type,action:()=>{je(e,o,t.time),i.close()},render:e=>r.createElement(Ve.Z,a()({},e,{focused:e.focused,disabled:!1,title:t.title,caption:t.caption}))})))},{key:"custom",render:e=>r.createElement(Ke.Z,a()({},e,{topBorder:!0})),items:[{key:"custom",action:()=>{i.close()},render:(t,n)=>r.createElement(Ge.Z,a()({},t,{renderOrigin:e=>r.createElement(Ve.Z,a()({},e,{disabled:!1,title:s()(u.FormattedMessage,{id:"publicPermissionItem.expiration.chooseDate",defaultMessage:"Choose date"})})),onFocus:n.onFocus,disableDefaultClick:!0,renderExtension:(t,n)=>s()("div",{style:{padding:"18px 14px 14px"}},void 0,r.createElement(ze.Z,a()({},t,{firstDayOfWeek:w.AK.state,value:e.permissionItem.expiration_timestamp||(new Date).getTime(),onChange:t=>{je(e,o,t),n.close(),i.close()},disabledDays:{before:new Date}})))}))}]}];let l;return l=t.isMobile?{menuType:p.og.Modal,title:s()(u.FormattedMessage,{id:"publicPermissionsMenu.expiration.mobile.title",defaultMessage:"Expiration time"}),right:s()(u.FormattedMessage,{id:"publicPermissionsMenu.expiration.mobile.label",defaultMessage:"Done"}),onClickRight:i.close}:{menuType:p.og.Popup,width:264},r.createElement(O.Z,a()({className:m.IpQ},l),s()(We.Z,{type:We.i.Vertical,initialFocus:void 0,sections:n}))}}))}function He(e){const{permissionItem:t}=e;return!t.expiration_timestamp||(0,y.o7)(t)?s()(u.FormattedMessage,{id:"publicPermissionItem.expiration.never",defaultMessage:"Never"}):s()(U.Z,{},void 0,e.permissionItem.expiration_timestamp&&(0,Re.tv)(e.permissionItem.expiration_timestamp,De.SP))}function je(e,t,i){const{permissionItem:n,onChange:a}=e;if("public_permission"!==n.type)return;if(void 0!==i&&i<=(new Date).getTime())return;const o=n,s=f().clone(o),r=i;s.expiration_timestamp=r,a(s),we.n4j(t,{expiration_time:r})}function Qe(){const e=(new Date).getTime()+Le.U6,t=(new Date).getTime()+Le.A0,i=(new Date).getTime()+7*Le.A0;return[{type:"never",time:void 0,title:s()(u.FormattedMessage,{id:"publicPermissionItem.expiration.never",defaultMessage:"Never"})},{type:"hour",time:e,title:s()(u.FormattedMessage,{id:"permissionItem.publicPermissionItem.expiration.hour",defaultMessage:"In an hour"}),caption:new Intl.DateTimeFormat(De.SP,{hour:"numeric",minute:"numeric"}).format(e)},{type:"day",time:t,title:s()(u.FormattedMessage,{id:"permissionItem.publicPermissionItem.expiration.day",defaultMessage:"In a day"}),caption:new Intl.DateTimeFormat(De.SP,{day:"numeric",month:"long",hour:"numeric",minute:"numeric"}).format(t)},{type:"week",time:i,title:s()(u.FormattedMessage,{id:"permissionItem.publicPermissionItem.expiration.week",defaultMessage:"In a week"}),caption:new Intl.DateTimeFormat(De.SP,{day:"numeric",month:"long",hour:"numeric",minute:"numeric"}).format(i)}]}function Ye(e){window.__c={n:"PageLinkOptions"};const{permissionItem:t,onUpgradeButtonClick:i,onChange:n,currentBlockStore:o}=e,m=(0,l.O7)(),p=(0,d.VK)((()=>!o.canAdmin()),[o]),g=(0,d.VK)((()=>{var e;return Boolean(null===(e=T.default.state.currentSpaceStore)||void 0===e?void 0:e.getDisableMoveToSpace())}),[]),h=y.RF(t.role),f=!1!==t.allow_duplicate,v=y.J5(t.role),S=Boolean(t.allow_search_engine_indexing),b=(0,r.useCallback)((()=>{n({role:v?"comment_only":"read_and_write"})}),[v,n]),M=(0,r.useCallback)((()=>{n({role:h?"reader":"comment_only"})}),[h,n]),w=(0,r.useCallback)((()=>{const e=!S;n({allow_search_engine_indexing:e}),we.g0v(m,{allow_search_engine_indexing:e})}),[m,n,S]),C=(0,r.useCallback)((()=>{const e=!f;n({allow_duplicate:e}),we.l7z(m,{allow_duplicate:e})}),[f,m,n]),_=(0,d.VK)((()=>Ie.default.checkGate("expiring_public_links")),[]),k=(0,d.VK)((()=>!(0,ke.y$)(m)&&(0,ke.M9)(m)),[m]),I=(0,d.VK)((()=>!(0,ke.f3)(m)&&(0,ke.M9)(m)),[m]),P=(0,d.VK)((()=>at(m)),[m]),Z=(0,d.VK)((()=>p||g&&!f),[p,f,g]),x=(0,c.yK)((()=>({optionLabel:{marginRight:"auto",opacity:p?.6:1},optionButton:p?{...P,cursor:"not-allowed"}:P})),[p,P]);return r.createElement(r.Fragment,null,r.createElement(r.Fragment,null,_&&s()(Ee.Z,{alwaysAllowClick:Boolean(t.expiration_timestamp),onClick:()=>{},analyticsName:"public_permission_item_expiration",requireUpgradeToTier:k,tooltipPlacement:ye.Z.Placement.Left,renderTooltip:et,renderUpgradeTooltip:tt,onUpgradeClick:i,render:(e,i)=>s()(qe,{upsellEvents:e,upgradeLabel:i,permissionItem:t,onChange:n,disabled:p})}),s()(ye.Z,{placement:ye.Z.Placement.Left,renderTooltip:Xe,render:e=>r.createElement(Pe.Z,a()({onClick:b,style:x.optionButton,disabled:p},e),s()(U.Z,{style:x.optionLabel},void 0,s()(u.FormattedMessage,{defaultMessage:"Allow editing",id:"pagePermissionItem.allowEdits.setting"})),s()(Fe.Z,{on:v,onClick:b,disabled:p}))}),s()(ye.Z,{placement:ye.Z.Placement.Left,renderTooltip:Je,render:e=>r.createElement(Pe.Z,a()({onClick:M,style:x.optionButton,disabled:p},e),s()(U.Z,{style:x.optionLabel},void 0,s()(u.FormattedMessage,{defaultMessage:"Allow comments",id:"pagePermissionItem.allowComments.setting"})),s()(Fe.Z,{on:h,onClick:M,disabled:p}))})),s()(ye.Z,{placement:ye.Z.Placement.Left,renderTooltip:g&&!f?nt:it,render:e=>r.createElement(Pe.Z,a()({onClick:C,disabled:Z,style:x.optionButton},e),s()(U.Z,{style:x.optionLabel},void 0,s()(u.FormattedMessage,{defaultMessage:"Allow duplicate as template",id:"pagePermissionItem.allowDuplicateTemplate.setting"})),s()(Fe.Z,{on:f,onClick:C,disabled:Z}))}),s()(Ee.Z,{requireUpgradeToTier:I,alwaysAllowClick:t.allow_search_engine_indexing,analyticsName:"allow_search_engine_indexing",onClick:w,onUpgradeClick:i,tooltipPlacement:ye.Z.Placement.Left,renderTooltip:et,renderUpgradeTooltip:tt,render:(e,t)=>r.createElement(Pe.Z,a()({style:x.optionButton,disabled:p},e),s()(U.Z,{style:x.optionLabel},void 0,s()(u.FormattedMessage,{defaultMessage:"Search engine indexing",id:"pagePermissionItem.allowSearchEngines.setting"})," ",t),s()(Fe.Z,{on:S,onClick:w,disabled:p||Boolean(t)}))}))}function $e(e){window.__c={n:"PageLinkButton"};const[t,i]=r.useState(!1),[n,a]=r.useState(void 0),{currentBlockStore:o}=e,m=(0,l.O7)(),p=(0,d.VK)((()=>at(m)),[m]),g=(0,c.yK)((()=>({container:{...p,height:"auto"},flex:{flex:1},wrapper:{display:"flex",padding:"1px 0"},input:{flex:1,borderTopRightRadius:0,borderBottomRightRadius:0,paddingRight:0},button:{height:28,borderTopLeftRadius:0,borderBottomLeftRadius:0,borderLeft:"none"}})),[p]),h=(0,d.VK)((()=>(0,he.ZP)({store:o,preferPublicLink:!0,getSpaceDomain:()=>{var e;return null===(e=fe.Z.getPublicSpaceData(m,(0,Me.CG)(o.getSpaceId())))||void 0===e?void 0:e.domain},pageVisitSource:pe.tY.CopyLink})),[o,m]),f=(0,r.useCallback)((()=>{m.mobileNative&&(0,Te.Y)("supportsNativeCopy")?m.mobileNative.copyText(h,_e.default.formatMessage(Ce.tq.copiedLinkToClipboard)):Ce.RD({environment:m,stringValue:h,copiedMessage:Ce.tq.copiedLinkToClipboard}),clearTimeout(n),i(!0),a(window.setTimeout((()=>{i(!1)}),1e3)),we.c7L(m)}),[m,h,n]);return s()("div",{style:g.container},void 0,s()("div",{style:g.flex},void 0,s()("div",{style:g.wrapper},void 0,s()(Ze.Z,{value:h,disabled:!0,style:g.input}),s()(ve.Z,{onClick:f,style:g.button},void 0,s()(u.FormattedMessage,t?{id:"pageShareMenu.copiedLinkButton.label",defaultMessage:"✓ Copied"}:{id:"pageShareMenu.copyMaybePublicLinkButton.label.web",defaultMessage:"Copy web link"})))))}function Xe(){return s()(Ae.Z,{caption:s()(u.FormattedMessage,{defaultMessage:"Any logged in Notion user can edit this page. Share the secret link with people you trust.",id:"pagePermissionItem.allowEdits.tooltip"}),imageHeight:120,imageWidth:240,imageURL:q.Z.images.tooltips.share.allowEditingPng})}function Je(){return s()(Ae.Z,{caption:s()(u.FormattedMessage,{defaultMessage:"Any logged in Notion user can comment on this page.",id:"pagePermissionItem.allowComments.tooltip"}),imageHeight:120,imageWidth:240,imageURL:q.Z.images.tooltips.share.allowCommentsPng})}function et(){return s()(Ae.Z,{caption:s()(u.FormattedMessage,{defaultMessage:"If allowed, your public page may appear in search engines such as Google, but only if you or someone else links to it elsewhere on the web.",id:"pagePermissionItem.allowSearchEngine.tooltip"}),imageHeight:120,imageWidth:240,imageURL:q.Z.images.tooltips.share.allowSearchEnginesPng})}function tt(){return s()(Ae.Z,{imageURL:q.Z.images.tooltips.upsells.searchEngineIndexingPng,imageWidth:240,imageHeight:100,title:s()(u.FormattedMessage,{defaultMessage:"Upgrade for search engine indexing",id:"pagePermissionItem.searchEngineUpgradeTooltip.title"}),caption:s()(u.FormattedMessage,{defaultMessage:"Have your page appear in search engine results.",id:"pagePermissionItem.searchEngineUpgradeTooltip.caption"})})}function it(){return s()(Ae.Z,{caption:s()(u.FormattedMessage,{defaultMessage:"If allowed, this will allow other people to duplicate your public page to their workspace.",id:"pagePermissionItem.allowDuplicateTemplate.tooltip"}),imageHeight:120,imageWidth:240,imageURL:q.Z.images.tooltips.share.allowDuplicatePng})}function nt(){return s()(Ae.Z,{caption:s()(u.FormattedMessage,{defaultMessage:"This workspace does not allow page duplication to other workspaces.",id:"pagePermissionItem.duplicateTemplateDisabled.tooltip"}),imageWidth:240})}function at(e){const t=e.WindowSizeStore;return{display:"flex",alignItems:"center",width:"100%",height:e.device.isMobile?36:30,paddingTop:5,paddingBottom:5,paddingLeft:t.getSafePaddingLeftCSS(14),paddingRight:t.getSafePaddingRightCSS(14)}}function ot(e){window.__c={n:"PublishToWebSettings"};const{store:t,mostPermissivePublicItem:i,permissionItemArgs:n}=e,{permissionItem:o,from:m}=i,{sudoModeStore:p,location:g,onUpgradeButtonClick:h}=n,f=(0,l.O7)(),{isMobile:v}=f.device,y=(0,c.yK)((e=>({title:{color:e.blueColor,fontWeight:Q.Z.fontWeight.medium,fontSize:14,display:"flex",alignItems:"center",margin:"0px 16px 10px",paddingTop:v?4:0},icon:{height:16,width:16,marginRight:6},linkSharingOptions:{margin:"10px 2px"},learnAboutDomainsCTA:{fontSize:14,margin:"8px 8px",padding:0,backgroundColor:void 0,boxShadow:void 0,textAlign:"left",alignItems:"flex-start"},buttonGroup:{margin:"10px 14px 16px",display:"flex",gap:10},button:{flexGrow:1,height:34},disabledButton:{opacity:.7,cursor:"not-allowed"}})),[v]),b=(0,d.VK)((()=>!t.canAdmin()),[t]),M=m.table===S.iU?m.blockId:m.teamId,w=(0,r.useCallback)((e=>{(0,de.i)({oldPermissionItem:o,newPermissionItem:{...o,...e},wasInherited:M!==t.id,environment:f,store:t,sudoModeStore:p,location:g})}),[o,M,t,f,p,g]),C=(0,r.useCallback)((()=>{w({role:"none"})}),[w]),_=(0,d.VK)((()=>(0,he.ZP)({store:t,preferPublicLink:!0,getSpaceDomain:()=>{var e;return null===(e=fe.Z.getPublicSpaceData(f,t.getSpaceId()))||void 0===e?void 0:e.domain},pageVisitSource:pe.tY.LinkInPage})),[t,f]),k=(0,r.useCallback)((()=>{!function(e){Y.j(e,"view_public_site_click")}(f),ge.navigate({url:_,environment:f,openInNew:"tab"})}),[f,_]);return s()("div",{},void 0,s()("div",{style:y.title},void 0,j.Z.blueCircleDot(y.icon),s()(u.FormattedMessage,{defaultMessage:"This page is live on the web",id:"publishTab.settings.liveOnWeb.title"})),s()($e,{currentBlockStore:t}),s()(be,{style:y.learnAboutDomainsCTA,labelStyle:{isSmall:!1}}),s()("div",{style:y.linkSharingOptions},void 0,s()(Ye,{currentBlockStore:t,permissionItem:o,onChange:w,onUpgradeButtonClick:h})),s()("div",{style:y.buttonGroup},void 0,s()(ye.Z,{disableTooltip:!b,renderTooltip:()=>s()(u.FormattedMessage,{defaultMessage:"You must have full access to this page to unpublish it",id:"publishTab.settings.liveOnWeb.unpublishTooltip"}),render:e=>r.createElement(ve.Z,a()({onClick:C,disabled:b,style:b?{...y.button,...y.disabledButton}:y.button},e),s()(u.FormattedMessage,{defaultMessage:"Unpublish",id:"publishTab.settings.liveOnWeb.unpublish"}))}),s()(ce.Z,{onClick:k,style:y.button},void 0,s()(u.FormattedMessage,{defaultMessage:"View site",id:"publishTab.settings.liveOnWeb.viewSite"}))))}function st(e){const{store:t,mostPermissivePublicItem:i,permissionItemArgs:n}=e,{permissionItem:a}=i,o="none"!==a.role;return s()(o?ot:ue,{store:t,mostPermissivePublicItem:i,permissionItemArgs:n})}var rt=i(94044),lt=i(5500),dt=i(54642),ct=i(95209),ut=i(48429),mt=i(4708),pt=i(79817),gt=i(53353),ht=i(26781),ft=i(29987),vt=i(34859),yt=i(30874),St=i(29798),bt=i(78291),Mt=i(3386),wt=i(18647),Ct=i(7567),_t=i(44385),kt=i(29477),Tt=i(68626),It=i(77719),Pt=i(68785);function Zt(e){window.__c={n:"ImportContactsButton"};const{onClickAuthenticated:t}=e,i=(0,l.O7)(),[n,a]=r.useState(!1),o=(0,d.VK)((()=>T.default.state.currentSpaceStore),[]),m=(0,d.VK)((()=>{const e=null==o?void 0:o.getBotSettingsStore().getValue();return"approved_only"!==(null==e?void 0:e.integration_restrictions)||Boolean((null==e?void 0:e.integration_approval_statuses)&&e.integration_approval_statuses[lt.nO])}),[o]),p=(0,d.VK)((()=>yt.Z.integrations.state.find((e=>e.id===lt.nO))),[]),g=(0,d.VK)((()=>yt.Z.completeSlackAuthentications.state),[]),h=(0,c.yK)((e=>({circleCheck:{height:14,width:14,marginLeft:6,color:H.ZP.blue},chevron:{height:12,width:12,marginLeft:6},title:{display:"flex",alignItems:"center",color:H.ZP.uiLightBlack,size:14},integrationName:{display:"flex"},integrationIcon:{marginLeft:4,marginRight:4},container:{height:36,bottom:0,width:"100%",backgroundColor:e.modalBackground,pointerEvents:"all",transitionProperty:"max-height",transitionDuration:"0.3s",boxShadow:"0px -4px 4px rgba(0, 0, 0, 0.03)",padding:3},button:{width:"100%",paddingTop:15,paddingBottom:15,paddingLeft:9},loadingSpinner:{width:14,height:14,marginLeft:6}})),[]);if(!o)return r.createElement(r.Fragment,null);if(!m)return r.createElement(r.Fragment,null);const f=s()("div",{style:h.integrationName},void 0,s()($.Z,{type:"image_url",imageURL:q.Z.images.externalIntegrations.slackIconPng,size:18,imageStyle:h.integrationIcon}),s()(u.FormattedMessage,{defaultMessage:"Slack",id:"importContactsButton.integrationName"})),v=n?s()(Pt.Z,{style:h.loadingSpinner}):r.createElement(r.Fragment,null,g.length>0&&j.Z.circleCheckFilled(h.circleCheck),j.Z.chevronRight(h.chevron));return s()("div",{style:h.container},void 0,s()(xe.Z,{style:h.button,onClick:async()=>{0===g.length?await async function(){const e=i.currentUser.id;if(!p||!o||!e)return;try{var n;a(!0);const e=await It.hM({environment:i,integration:p,spaceId:o.id,from:"share_menu"});if(Tt.x.isFail(e))return;const s=null===(n=e.value.externalAuthentication)||void 0===n?void 0:n.parent_id;if(!s)return;const r=Ie.default.getEligibleGroup({experimentId:"import_slack_contacts",defaultGroup:2e3,parameter:"load_contacts_timeout"}),l=Number(r);await Promise.race([dt.loadContacts(i,{botId:s,spaceId:o.id,integrationId:p.id}),(0,kt.Vs)(Number.isNaN(l)?2e3:l)]),null==t||t()}finally{a(!1)}}():g.length>0&&(null==t||t())}},void 0,s()("div",{style:h.title},void 0,s()(u.FormattedMessage,{defaultMessage:"Add contacts from {integrationNameWithLogo}",id:"importContactsButton.integrationButton.label",values:{integrationNameWithLogo:f}}),v)))}var xt=i(33728),Ft=i(26907),At=i(8323);const Et=f().debounce((e=>{let{environment:t,flowId:i,subscriptionTier:n,origin:a}=e;we.UWw(t,{invite_flow_id:i,subscription_tier:n,invite_origin:a})}),1e3);var Bt=i(47082),Dt=i(22193);const Rt=function(e){window.__c={n:"InviteTargetsInput"};const{flowId:t,store:i,disabled:n,placeholder:a,right:o,focus:r,onFocus:u,onSubmit:m}=e,p=(0,l.O7)(),g=(0,l.Fy)(),h=(0,d.qz)(e.inviteTargetsStore,G.ZP),f=(0,d.VK)((()=>h.state.inviteTargets),[h]),v=(0,d.VK)((()=>h.state.tokenQuery),[h]),y=f.map((e=>{const t="newUser"===e.type?e.value.email:e.value.id;return s()(Dt.Z,{store:i,target:e,showRemoveButton:!0,onClickRemove:()=>function(e){const{targetToRemove:t,inviteTargetsStore:i}=e;if(0===i.state.inviteTargets.length)return;const n=i.state.inviteTargets.filter((e=>e!==t));0===n.length?i.setState({...i.state,inviteTargets:[]}):i.setState({...i.state,inviteTargets:n})}({inviteTargetsStore:h,targetToRemove:e})},t)})),S=(0,c.yK)((e=>({tokenSpan:{maxWidth:"100%"},tokenInputMenuItem:{paddingTop:0===f.length?0:6,paddingLeft:6,paddingRight:6,paddingBottom:0,borderRadius:3,minHeight:"unset",...r&&{background:"none"},...n&&{background:e.inputBackground,color:e.mediumTextColor,fill:H.ZP.white,opacity:.4}},tokenInputMenuItemInput:{paddingTop:0===f.length?6:0}})),[f,r,n]);return s()(Bt.Z,{focus:r,focusAfterAnimation:!0,onClick:()=>{g.isMobile||null==u||u()},format:Bt.Z.Format.Share,value:v,onChange:e=>async function(e){const{environment:t,event:i,flowId:n,inviteTargetsStore:a,inviteOrigin:o}=e;a.setState({...a.state,tokenQuery:i.target.value}),Et({environment:t,flowId:n,subscriptionTier:(0,At.zt)(),origin:o});const s=i.target.value,{extractedEmails:r,newInputValue:l}=(0,xt.zI)(s),d=(await ct.M5(t,r)).filter((e=>!Ft.H({inviteTargetsStore:a,target:e}))),c=[...a.state.inviteTargets,...d];a.setState({...a.state,inviteTargets:c,tokenQuery:l})}({environment:p,event:e,inviteTargetsStore:h,inviteOrigin:"page_contextual_invite",flowId:t}),type:"email",tokens:y,disabled:n,autoComplete:"off",placeholder:a,onRemoveLastToken:()=>{h.setState({...h.state,inviteTargets:h.state.inviteTargets.slice(0,-1)})},right:o,showBorder:!0,inputStyle:S.tokenInputMenuItemInput,style:S.tokenInputMenuItem,onSubmit:m})};var Lt=i(75472),Nt=i(77907),Ot=i(83355);class Vt extends Ot.Z{renderComponent(){return s()(Pe.Z,{hovered:this.props.hovered,onClick:this.props.onClick,disabled:this.props.disabled,disabledFeedback:!0,style:{...this.getButtonStyle(),...this.props.isLarge&&{height:32},...this.props.style},hoveredStyle:{background:this.theme.buttonHoveredBackground},pressedStyle:{background:this.theme.buttonPressedBackground},onFocus:this.props.onFocus,onBlur:this.props.onBlur,onMouseDown:this.props.onMouseDown,onMouseEnter:this.props.onMouseEnter,onMouseLeave:this.props.onMouseLeave,className:this.props.className},void 0,this.props.children)}getButtonStyle(){return{display:"inline-flex",alignItems:"center",justifyContent:"center",flexShrink:0,whiteSpace:"nowrap",height:28,borderRadius:3,boxShadow:this.theme.plainButtonBoxShadow,background:this.theme.inputBackground,color:this.theme.mediumTextColor,fill:H.ZP.white,lineHeight:1.2,paddingLeft:12,paddingRight:12,fontSize:14}}}Vt.displayName="InputButton";const Ut=Vt;const Wt=function(e){window.__c={n:"PermissionsInviteEntry"};const{store:t}=e,{isMobile:i}=(0,l.Fy)(),n=(0,d.VK)((()=>t.canEditMembership()),[t]),o=(0,c.yK)((()=>({buttonContainer:{display:"flex",alignItems:"center",gap:rt.p_},inputButton:{flex:1,justifyContent:"flex-start",height:30,overflow:"hidden"},blueButton:{minWidth:rt.UF}})),[]);return s()(ye.Z,{renderTooltip:()=>s()(u.FormattedMessage,{id:"inviteUserButton.tooltip.fullAccessOnlyMessage",defaultMessage:"Only those with full access can add people."}),disableTooltip:n,render:t=>r.createElement("div",a()({style:o.buttonContainer},t),s()(Ut,{onClick:e.onClick,disabled:!n&&!0,style:o.inputButton},void 0,s()("div",{style:Q.Z.textOverflowStyle},void 0,s()(u.FormattedMessage,{defaultMessage:"Add emails or people",id:"ContexualInvites.inviteUserModal.searchInput.placeholderWithoutBots"}))),!i&&s()(ce.Z,{isLarge:!0,onClick:e.onClick,disabled:!n&&!0,style:o.blueButton},void 0,s()(u.FormattedMessage,{id:"inviteUserButton.invitePersonLabel",defaultMessage:"Invite"})))})};function Kt(e){window.__c={n:"MobileInviteSection"};const{store:t,permissionItemArgs:i}=e,{onUpgradeButtonClick:n,sudoModeStore:a}=i,o=(0,d.qz)(void 0,R.Z),{permissionsInviteStore:r}=(0,d.VK)((()=>o.state),[o]),u=(0,d.VK)((()=>T.default.state.currentSpaceStore),[]),m=(0,d.VK)((()=>o.stage),[o]),p=(0,d.VK)((()=>r.state.modalOpen),[r]),g=(0,l.O7)(),h=(0,d.VK)((()=>t.canAdmin()),[t]),f=(0,d.VK)((()=>{const{data:e}=bt.default.state;return Boolean(e&&ke.YK(e))}),[]),v=(0,d.VK)((()=>function(e){const{store:t}=e,i=(0,C.VP)(t),n=T.default.state.currentSpaceStore;return Boolean((null==n?void 0:n.getDisableGuests())||(null==i?void 0:i.getDisableGuests()))}({store:t})),[t]),y=(0,c.yK)((e=>({button:{display:"flex",alignItems:"center",minHeight:52},buttonInner:{width:"100%"},modalButton:{height:36}})),[]);return u?m!==B.TG.closed?s()(Nt.LazyUniversalMemberInvite,{universalInviteStore:o,mode:"milestone_2",spaceStore:u,sudoModeStore:a,store:t,disabled:!h,membersOnly:v,isSubscribed:f,onUpgradeButtonClick:n,upgradeButtonName:"invite_permission_block",shouldGrow:!0,buttonStyle:{height:36}}):s()(Pe.Z,{mobileFeedback:!0,disabled:!0,style:y.button},void 0,s()("div",{style:y.buttonInner},void 0,p&&s()(Nt.LazyPermissionsInviteWithModal,{store:t,disabled:!h,membersOnly:v,isSubscribed:f,onUpgradeButtonClick:n,upgradeButtonName:"invite_permission_block",shouldGrow:!0,buttonStyle:y.modalButton,permissionsInviteStore:r}),s()(Wt,{store:t,onClick:()=>(0,Lt.z5)({environment:g,permissionsInviteStore:r,store:t,isSubscribed:f,renderInShareModal:!1})}))):null}var zt=i(19889),Gt=i(7928),qt=i(91536),Ht=i(64684);function jt(){const{data:e}=bt.default.state,t=e?ke.CM(e):[],i=new Map;return t.forEach((e=>{i.set(e.userId,e)})),i}function Qt(e){const{spaceVisibleUserMap:t,blockStore:i,userId:n}=e,a=t.get(n);if(!a||"none"!==a.role)return;if(!a.isTeamGuest)return"guest";const o=C.VP(i);if(!o)return"guest";return(0,Ht.s8)({team:{membership:o.getRawMembership()},userId:n})?"team_level_guest":"guest"}var Yt=i(65598),$t=i(16639),Xt=i(12793),Jt=i(31278),ei=i(25735);function ti(e){window.__c={n:"GroupPermissionTooltip"};const{group:t}=e,i=(0,u.useIntl)(),n=(0,$t.kF)({intl:i,group:t});return s()(ei.Y,{group:t,limit:15,noMembersMessage:s()(Ae.Z,{imageURL:q.Z.images.tooltips.share.sharedPng,imageWidth:240,imageHeight:120,caption:s()(u.FormattedMessage,{defaultMessage:"For all members of the {groupName} group, this page will show up in the <boldtext>Shared</boldtext> section in their sidebar.",values:{boldtext:e=>s()("span",{style:{fontWeight:Q.Z.fontWeight.bold}},void 0,e),groupName:n},id:"blockPermissionsSettings.groupPermission.tooltip"})})})}const ii=function(e){window.__c={n:"BlockGroupPermissionItem"};const{store:t,groupPermission:i,spaceId:n,fromPermissionWrapper:o}=e,l=(0,u.useIntl)(),c=(0,d.VK)((()=>{const{currentSpaceStore:e}=T.default.state;if(!e)return!1;return e.getPermissionGroups().find((e=>e.id===i.permissionItem.group_id))}),[i.permissionItem.group_id]);if(!c)return null;const p=c.user_ids||[],g=(0,$t.kF)({intl:l,group:c}),h=c.icon&&s()(Jt.Z,{disabled:!0,title:g,icon:c.icon?{pointer:{table:"space",id:n},icon:c.icon}:void 0,isEmptyPage:!1,size:18});return s()("div",{style:{fontWeight:400},className:m.gGc},c.id,r.createElement(Be.Z,a()({currentBlockStore:t,permissionItem:i.permissionItem,from:i.from,icon:s()(Xt.Z,{size:Be.Z.iconSize}),title:g,tag:h,ignoreLocalHoverState:e.ignoreLocalHoverState,showInherited:e.showInherited,nonInheritedTooltip:s()(ti,{group:c}),subtitle:s()("div",{},void 0,s()(u.FormattedMessage,{defaultMessage:"Group",id:"blockPermissionsSettings.groupPermission.label"})," · ",s()(u.FormattedMessage,{defaultMessage:"{numberOfGroupMembers, plural, one {{numberOfGroupMembers} person} other {{numberOfGroupMembers} people}}",id:"blockPermissionsSettings.groupPermission.none",values:{numberOfGroupMembers:p.length}})),upgradeButtonName:"group_permission_item",isRemovableOverride:e.isRemovableOverride,fromPermissionWrapper:o},e.permissionItemArgs)))};var ni=i(88198),ai=i(45653);function oi(e){window.__c={n:"Icon"};const{userValue:t,shouldShowPendingInvitation:i}=e,n=(0,c.yK)((()=>({iconPlaceholder:{height:Be.Z.iconSize,width:Be.Z.iconSize,borderRadius:20}})),[]);return t?s()(ai.Z,{userValue:t,size:Be.Z.iconSize,initialOverrideStyle:i?{borderStyle:"dashed"}:void 0}):s()(li,{style:n.iconPlaceholder})}function si(e){window.__c={n:"Title"};const{userValue:t,guestLabel:i,shouldShowPendingInvitation:n}=e,a=(0,u.useIntl)(),o=(0,c.yK)((()=>({titlePlaceholder:{height:8,width:81,borderRadius:3},pendingInvitation:{color:H.ZP.PendingInvitationTextColor}})),[]);if(!t)return s()(li,{style:o.titlePlaceholder});const l=(0,Gt.Nz)(a,t);return r.createElement(r.Fragment,null,l?s()("div",{style:{display:"flex",gap:4}},void 0,s()(U.Z,{className:"notranslate",style:n?o.pendingInvitation:void 0},void 0,l),i&&s()(ni.b,{labelType:i})):s()(u.FormattedMessage,{defaultMessage:"Invitation sent",id:"blockPermissionsSettings.sentInvitation.message"}))}function ri(e){window.__c={n:"Subtitle"};const{userValue:t,shouldShowPendingInvitation:i}=e,n=(0,c.yK)((()=>({uiLabel:{display:"flex"},subtitlePlaceholder:{height:8,width:139,borderRadius:3,marginTop:10},dotSeparator:{marginLeft:2,marginRight:2},pendingInvitation:{color:H.ZP.PendingInvitationTextColor}})),[]);return null!=t&&t.email?i?s()(U.Z,{isSmall:!0,style:n.pendingInvitation},void 0,s()(u.FormattedMessage,{id:"blockPermissionsSettings.invitationSent",defaultMessage:"Pending Invitation"})):s()(U.Z,{isSmall:!0},void 0,t.email):s()(li,{style:n.subtitlePlaceholder})}function li(e){window.__c={n:"Placeholder"};const t=(0,c.yK)((t=>({placeholder:{...e.style,background:t.lightDividerColor}})),[e.style]);return s()("div",{style:t.placeholder})}const di=function(e){window.__c={n:"BlockUserPermissionItem"};const{store:t,userPermission:i,spaceVisibleUserMap:n,fromPermissionWrapper:o}=e,l=(0,d.VK)((()=>I.U6.createChildStore(t,{table:zt.KJ,id:i.permissionItem.user_id}).getValue()),[t,i.permissionItem.user_id]),c=(0,d.VK)((()=>{if(null!=l&&l.id)return Qt({spaceVisibleUserMap:n,userId:l.id,blockStore:t})}),[t,n,l]),u=(0,d.VK)((()=>!0!==(null==l?void 0:l.onboarding_completed)&&(0,mt.fJ)()),[l]);return s()("div",{},i.permissionItem.user_id,r.createElement(Be.Z,a()({currentBlockStore:t,permissionItem:i.permissionItem,from:i.from,ignoreLocalHoverState:e.ignoreLocalHoverState,icon:s()(oi,{userValue:l,shouldShowPendingInvitation:u}),title:s()(si,{userValue:l,guestLabel:c,shouldShowPendingInvitation:u}),subtitle:s()(ri,{userValue:l,shouldShowPendingInvitation:u}),showInherited:e.showInherited,upgradeButtonName:"user_permission_item",isRemovableOverride:e.isRemovableOverride,fromPermissionWrapper:o},e.permissionItemArgs)))};function ci(e){let{permissions:t}=e;window.__c={n:"ExpandablePermissionsList"};const[i,n]=(0,r.useState)(!1),a=(0,c.yK)((e=>({button:{display:i?"none":"inline-flex",padding:10,width:"100%"},icon:{width:14,transform:"rotate(90deg)",marginLeft:14,marginRight:18,fill:e.lightIconColor},list:{display:i?"block":"none"}})),[i]);return r.createElement(r.Fragment,null,s()(Pe.Z,{onClick:()=>n(!0),style:a.button},void 0,s()("div",{},void 0,j.Z.dots(a.icon)),s()(U.Z,{isSmall:!0,isSecondaryColor:!0},void 0,s()(u.FormattedMessage,{id:"blockPermissionsSettings.permissionsList.expandButton",defaultMessage:"{count} more people",values:{count:t.length}}))),s()("div",{style:a.list},void 0,t))}const ui=function(e){window.__c={n:"MorePeoplePermissionItem"};const{store:t}=e,i=(0,c.yK)((e=>({icon:{width:17,height:17,fill:e.mediumIconColor},iconContainer:{backgroundColor:e.lightDividerColor,borderRadius:32}})),[]),n={table:S.iU,blockId:t.id};return s()(Be.Z,{icon:j.Z.personBadgeQuestionMark(i.icon),iconStyle:i.iconContainer,title:s()(u.FormattedMessage,{defaultMessage:"More people may have access",id:"blockPermissionsSettings.permissionItem.hiddenAccess"}),nonInheritedTooltip:s()(u.FormattedMessage,{defaultMessage:"This page may be shared with additional people through a parent page or teamspace that you don't have access to",id:"blockPermissionsSettings.hiddenAccess.tooltip"}),permissionRoleSelect:r.createElement(r.Fragment,null),currentBlockStore:t,permissionItem:{type:"hidden_permission"},from:n,upgradeButtonName:"team_permission_item"})};var mi=i(38755),pi=i(84076),gi=i(93686),hi=i(6148);const fi=(0,u.defineMessages)({fullAccess:{id:"permissionsLevelBanner.fullAccess.label",defaultMessage:"You have full access to this page {hasAttribution, select, true {via {attribution}} other {}}"},editor:{id:"permissionsLevelBanner.editor.label",defaultMessage:"You have edit access to this page {hasAttribution, select, true {via {attribution}} other {}}"},contentEditor:{id:"permissionsLevelBanner.contentEditor.label",defaultMessage:"You have edit access to content on this page {hasAttribution, select, true {via {attribution}} other {}}"},commenter:{id:"permissionsLevelBanner.commenter.label",defaultMessage:"You have comment access to this page {hasAttribution, select, true {via {attribution}} other {}}"},reader:{id:"permissionsLevelBanner.reader.label",defaultMessage:"You have view access to this page {hasAttribution, select, true {via {attribution}} other {}}"}});function vi(e){let{store:t}=e;window.__c={n:"PermissionLevelBanner"};const i=(0,l.O7)(),n=(0,d.VK)((()=>(0,w.B7)(i)),[i]),o=(0,d.VK)((()=>t.canEditContentOnly()),[t]),m=(0,c.yK)((e=>({container:{backgroundColor:e.accentColors.gray[50],borderRadius:4,height:34,marginLeft:14,marginRight:14,marginTop:5,marginBottom:5,paddingRight:14,display:"flex",alignItems:"center"},banner:{fontSize:12,display:"inline-flex"},icon:{marginLeft:14,marginRight:8},attribution:{display:"inline-flex",alignItems:"center",fill:e.regularIconColor,marginLeft:5}})),[]),{role:p,attribution:g}=(0,d.VK)((()=>{if(!n)return{role:"none",attribution:null};const e=(0,_.Dt)({userId:n.id,store:t}),a=function(e){let{environment:t,calculatedPermission:i,store:n}=e;const a=(0,C.Pj)(n)||T.default.state.currentSpaceStore;if(!a)return null;if((0,y.hV)(i)){const e=(0,mi.TC)({spaceStore:a,groupId:i.group_id}),t=null==e?void 0:e.name;return t?r.createElement(r.Fragment,null,j.Z.group({width:18,marginRight:5}),t):null}if((0,y.fG)(i)){var o;const e=i.team_id||(null===(o=(0,C.VP)(n))||void 0===o?void 0:o.id);if(!e)return null;const t=I.zX.createChildStore(a,{table:M.e0,id:e,spaceId:a.id});return r.createElement(r.Fragment,null,s()(gi.p,{disabled:!0,store:t,size:18,style:{marginRight:5}}),s()(hi.q,{navigableParentStore:t,showUnderline:!0}))}if((0,y.ix)(i))return(0,y.KF)(i)?s()(u.FormattedMessage,{defaultMessage:"the link",id:"permissionsLevelBanner.spacePermission.attribution"}):r.createElement(r.Fragment,null,s()(gi.p,{disabled:!0,store:a,size:18,style:{marginRight:5}}),(0,mi.rn)(t,a));if((0,y.$D)(i))return s()(pi.Z,{underline:!0,inline:!0,onClick:()=>{D.ZP.setState({...D.ZP.state,display:D.wV.Publish,tab:D.XF.Publish})}},void 0,s()(u.FormattedMessage,{defaultMessage:"the published site",id:"permissionsLevelBanner.publicPermission.attribution"}));return null}({environment:i,calculatedPermission:e,store:t});return{role:e.role,attribution:a}}),[n,t,i]);if((0,r.useEffect)((()=>{p&&we.hYM(i,{share_menu_session_id:D.ZP.state.sessionId,role:p})}),[]),!(0,y.iC)(p))return null;const h=function(e){switch(e){case"editor":return fi.fullAccess;case"read_and_write":return fi.editor;case"content_only_editor":return fi.contentEditor;case"comment_only":return fi.commenter;case"reader":return fi.reader;case"none":case"membership_admin":return null;default:(0,z.t1)(e)}}(p);return h?s()(ye.Z,{delayThreshold:0,renderTooltip:()=>s()(u.FormattedMessage,{defaultMessage:"Content editors can edit pages, but cannot change view and database settings.",id:"database.viewSettings.mainTab.contentOnlyEditorPill.subtitle"}),disableTooltip:!o,textWrap:!0,style:{maxWidth:180},render:e=>r.createElement("div",a()({style:m.container},e),s()(ai.Z,{userStore:n,size:20,style:m.icon}),s()(U.Z,{style:m.banner},void 0,r.createElement(u.FormattedMessage,a()({},h,{values:{hasAttribution:Boolean(g),attribution:s()("span",{style:m.attribution},void 0,g)}})))),placement:ye.Z.Placement.Left}):null}function yi(){return s()(Si,{},void 0,s()(u.FormattedMessage,{id:"blockPermissionsSettings.permissionsList.moreAttribution",defaultMessage:"More people with access"}))}function Si(e){window.__c={n:"AttributionWrapper"};const{children:t}=e,{WindowSizeStore:i}=(0,l.O7)(),{paddingLeft:n,paddingRight:a}=(0,d.VK)((()=>({paddingLeft:i.getSafePaddingLeftCSS(14),paddingRight:i.getSafePaddingRightCSS(14)})),[i]),o=(0,c.yK)((e=>({label:{color:e.mediumTextColor,fontWeight:Q.Z.fontWeight.medium,paddingLeft:n,paddingRight:a,paddingTop:8,paddingBottom:6}})),[n,a]);return s()(U.Z,{isSmall:!0,style:o.label},void 0,t)}const bi=function(e){window.__c={n:"PermissionsAttributionHeader"};const{store:t}=e,{parentStore:i,canAccessParent:n}=(0,d.VK)((()=>Z({store:t})),[t]);return s()(Si,{},void 0,s()(u.FormattedMessage,n?{id:"blockPermissionsSettings.permissionsList.attribution",defaultMessage:"From {attribution}",values:{attribution:s()(hi.q,{navigableParentStore:i})}}:{id:"blockPermissionsSettings.permissionsList.genericHeader",defaultMessage:"People with access"}))};var Mi=i(70183);function wi(e){window.__c={n:"RestrictedBanner"};const{store:t}=e,i=(0,l.O7)(),n=(0,d.VK)((()=>function(e){const{store:t,environment:i}=e;return Mi.or([Mi.zz,Mi.xD([Mi.c2,Mi.ff(Mi.zz)])])({environment:i,blocks:[t],publicEditMode:void 0})}({store:t,environment:i})),[t,i]);return s()(hi.Z,{type:"unrestrict",showRestoreButton:n,store:t,sudoModeStore:e.sudoModeStore})}function Ci(e){window.__c={n:"ElevatedBanner"};const{store:t}=e;return(0,d.VK)((()=>P({store:t})),[t])?s()(hi.Z,{type:"restore-team",showRestoreButton:!1,store:t,sudoModeStore:e.sudoModeStore}):null}const _i=function(e){window.__c={n:"PermissionsWarningBanner"};const{store:t,showRestrictedPermissionBanner:i}=e,{canAccessParent:n}=(0,d.VK)((()=>Z({store:t})),[t]);return n?s()(i?wi:Ci,{store:t,sudoModeStore:e.sudoModeStore}):null};var ki=i(20346);function Ti(){const e=(0,l.O7)(),{currentSpaceStore:t}=(0,d.Kw)(T.default);return(0,d.VK)((()=>t?(0,mi.rn)(e,t):""),[e,t])}var Ii=i(23063);const Pi=[{key:"private",title:e=>s()(u.FormattedMessage,"variant1"===e?{id:"linkSharingPill.visibilityTitle.private",defaultMessage:"Private"}:{id:"linkSharingPill.visibilityTitle.inviteOnly",defaultMessage:"Invite only"}),caption:s()(u.FormattedMessage,{id:"linkSharingPill.visibilityCaption.inviteOnly",defaultMessage:"Only you and people invited can access"}),icon:j.Z.lockedFilled},{key:"unlisted",title:(e,t)=>s()(u.FormattedMessage,"variant1"===e?{id:"linkSharingPill.visibilityTitle.unlisted",defaultMessage:"Unlisted"}:{id:"linkSharingPill.visibilityTitle.anyoneWithLink",defaultMessage:"Anyone with link at {spaceName}",values:{spaceName:t}}),caption:s()(u.FormattedMessage,{id:"linkSharingPill.visibilityCaption.anyoneWithLink",defaultMessage:"People invited and workspace members with link can access"}),icon:j.Z.link},{key:"open",title:(e,t)=>s()(u.FormattedMessage,"variant1"===e?{id:"linkSharingPill.visibilityTitle.open",defaultMessage:"Open"}:{id:"linkSharingPill.visibilityTitle.everyoneInWorkspace",defaultMessage:"Everyone at {spaceName}",values:{spaceName:t}}),caption:s()(u.FormattedMessage,{id:"linkSharingPill.visibilityCaption.everyoneInWorkspace",defaultMessage:"All workspace members can search and access"}),icon:j.Z.openPage}];function Zi(e){window.__c={n:"MobileLinkSharingPill"};const{store:t,spacePermission:i}=e,n=Fi(i.permissionItem),o=(0,d.VK)((()=>t.canAdmin()),[t]),l=(0,A.a)("link_sharing_pill"),m=Ti(),p=(0,d.VK)((()=>{const e=T.default.state.currentSpaceStore;return null!=e&&e.isDefined()?e:null}),[]),[g,h]=(0,r.useState)(!1),f=(0,c.yK)((e=>({chevron:{width:12,fill:e.mediumIconColor,marginLeft:"auto"},button:{height:42,color:e.mediumTextColor,marginBottom:8,padding:"0 6px",marginLeft:-6,marginRight:-6,width:"100%"},icon:{fill:e.regularIconColor,width:32,height:32,backgroundColor:e.lightDividerColor,padding:6,borderRadius:4,marginRight:12},animation:{maxHeight:220},enterAnimation:{maxHeight:0},exitAnimation:{maxHeight:0},container:{overflow:"hidden"}})),[]),v=Pi.find((e=>e.key===n));return v&&p?s()("div",{style:f.container},void 0,s()(xe.Z,{style:f.button,icon:v.icon,iconStyle:f.icon,disabled:!o,disabledFeedback:!0,onClick:()=>h(!g)},void 0,s()("div",{},void 0,s()(U.Z,{isSmall:!0},void 0,s()(u.FormattedMessage,{id:"linkSharingPill.visibilityMobileTitle",defaultMessage:"Page visibility"})),s()(U.Z,{},void 0,v.title(l,m))),o&&(g?j.Z.chevronDown(f.chevron):j.Z.chevronUpRounded(f.chevron))),s()(Ii.Z,{isVisible:g,animationStyle:f.animation,enterAnimationStyle:f.enterAnimation,exitAnimationStyle:f.exitAnimation,springConfig:{maxHeight:{stiffness:60,damping:12,precision:.1}},render:()=>r.createElement(xi,a()({},e,{parentCloseCallback:()=>h(!1)}))})):null}function xi(e){window.__c={n:"PrivacyMenu"};const{store:t,spacePermission:i,sudoModeStore:n,location:o,isRestricted:u,parentCloseCallback:m}=e,g=(0,l.O7)(),h=g.device.isMobile,f=Fi(i.permissionItem),M=(0,A.a)("link_sharing_pill"),w=i.from,_=w.table===S.iU?w.blockId:w.teamId,k=!(w.table===t.table&&_===t.id),I=(0,d.VK)((()=>{const{currentSpaceStore:e}=T.default.state;return!!e&&t.isTopLevelWorkspacePage(e.id)}),[t]),P=Ti(),Z=(0,d.VK)((()=>{const e=function(e){const{store:t}=e;if(t.getParentTable()===b.bx)return;const i=(0,C.Om)(t);if(!i)return;const n=(0,v.Wo)((0,C.fJ)(i));for(const a of n)if((0,y.ix)(a))return a}({store:t});return e?Fi(e):"private"}),[t]),x=(0,r.useRef)(null),F=(0,c.yK)((e=>{const t={width:14,fill:h?e.regularIconColor:e.mediumTextColor};return{icon:{fill:h?e.regularIconColor:e.mediumTextColor,width:16},iconContainer:{alignSelf:"center",marginLeft:h?13:9},hiddencheckmark:{...t,visibility:"hidden"},selectedCheckmark:{...t,visibility:"visible"},checkmarkContainer:{marginLeft:12},selectedTitle:{fontWeight:Q.Z.fontWeight.semibold},mobileScroller:{border:`1px solid ${e.regularDividerColor}`,borderRadius:8,marginBottom:24},mobileButton:{paddingTop:8,paddingBottom:8},mobileButtonDivider:{borderBottom:`1px solid ${e.regularDividerColor}`},caption:{whiteSpace:"normal"}}}),[h]);return s()(O.Z,{menuType:p.og.Popup,disableScroller:!0,scrollerStyle:h?F.mobileScroller:{}},void 0,s()(We.Z,{type:We.i.Vertical,initialFocus:void 0,sections:[{key:"visibilityOptions",render:e=>r.createElement(Ke.Z,a()({},e,{disableDesktopPadding:h})),items:Pi.map(((e,l)=>{const d=e.key,c=f===d,p=c?F.selectedCheckmark:F.hiddencheckmark,v=l!==Pi.length-1,y={...h?F.mobileButton:{},...h&&v?F.mobileButtonDivider:{}};return{key:d,render:t=>s()("div",{},void 0,"unlisted"===d&&r.createElement("div",{ref:x},s()(ee.C8,{originRef:x})),r.createElement(Ve.Z,a()({title:e.title(M,P),caption:s()(U.Z,{isSmall:!0,isMultiline:!0,style:F.caption},void 0,e.caption),icon:e.icon(F.icon),desktopIconStyle:F.iconContainer,titleStyle:c&&!h?F.selectedTitle:void 0,right:j.Z.thinCheck(p),rightStyle:F.checkmarkContainer,style:y},t))),action:()=>{if(c)return;const e=i.permissionItem,a={type:"space_permission",role:Ai(e,f,d)};"unlisted"===d&&(a.unlisted_timestamp=Date.now());const s=function(e,t){if(e===t)return!1;switch(t){case"open":return!1;case"unlisted":return"open"===e;case"private":return!0;default:(0,z.t1)(t)}}(Z,d)&&!u&&!I;(0,de.i)({oldPermissionItem:e,newPermissionItem:a,wasInherited:k,environment:g,store:t,sudoModeStore:n,location:o,restrictingVisibility:s}),m()}}}))}]}))}function Fi(e){return"none"===e.role?"private":e.unlisted_timestamp?"unlisted":"open"}function Ai(e,t,i){return"private"===i?"none":"private"===t?"reader":e.role}const Ei=function(e){window.__c={n:"LinkSharingPill"};const{store:t,spacePermission:i}=e,n=Fi(i.permissionItem),o=(0,d.VK)((()=>t.canAdmin()),[t]),l=(0,A.a)("link_sharing_pill"),m=Ti(),p=(0,d.VK)((()=>{const e=T.default.state.currentSpaceStore;return null!=e&&e.isDefined()?e:null}),[]),g=(0,d.qz)(void 0,Ne.Z),h=(0,r.useRef)(null),f=(0,c.yK)((e=>({chevron:{width:12,marginLeft:4,fill:e.mediumIconColor},popup:{overflow:"visible",width:"100%",minWidth:430},button:{justifyContent:"center",borderRadius:32,height:32,color:e.mediumTextColor,paddingLeft:12,maxWidth:380},title:{...Q.Z.textOverflowStyle},icon:{fill:e.mediumTextColor,width:16}})),[]);return p?s()(Ue.ZP,{buttonPopupStore:g,popupType:Ue.Z4.Popup,popupWrapStyle:f.popup,renderOrigin:e=>{const t=Pi.find((e=>e.key===n));return t?s()(ye.Z,{placement:ye.Z.Placement.Bottom,alignment:ye.Z.Alignment.Start,disableTooltip:o,renderTooltip:()=>s()(u.FormattedMessage,{defaultMessage:"You must have full access to change the privacy setting",id:"linkSharingPill.disabledTooltip.message"}),render:i=>r.createElement(ve.Z,a()({},e,{ref:h,style:f.button,icon:t.icon,iconStyle:f.icon,disabled:!o,disabledFeedback:!0},i),s()("div",{style:f.title},void 0,t.title(l,m)),o&&j.Z.chevronDown(f.chevron),s()(ee.iq,{originRef:h,handlePrimaryButtonClick:()=>{g.setState({...g.state,open:!0})}}))}):null},placementToOrigin:Oe.Iw.Bottom,alignmentToOrigin:Oe.lU.Start,sameWidthAsOrigin:!0,render:t=>r.createElement(xi,a()({},e,{parentCloseCallback:()=>t.close()}))}):null};var Bi=i(32739),Di=i(95477);function Ri(e){window.__c={n:"MobilePageLinkButtonInner"};const{store:t,buttonPopupStore:i,events:n}=e,o=(0,l.O7)(),{device:d,mobileNative:m}=o,p=(0,c.yK)((e=>({button:{flex:1,height:36,minHeight:36}})),[]);return r.createElement(ce.Z,a()({onClick:()=>{d.isMobileNative?function(e){const{store:t,mobileNative:i}=e,n=(0,Bi.u5)({schemeUrl:(0,he.ZP)({store:t,pageVisitSource:pe.tY.CopyLink}),baseUrl:Di.default.domainBaseUrl});i&&i.share(n)}({store:t,mobileNative:m}):Oi({store:t,buttonPopupStore:i,environment:o}),we.V5j(o)},style:p.button},n),d.isMobileNative?s()(u.FormattedMessage,{id:"pageShareMenu.shareLinkButton.label",defaultMessage:"Share link"}):s()(u.FormattedMessage,{id:"pageShareMenu.copyLinkButton.label",defaultMessage:"Copy link"}))}function Li(e){window.__c={n:"PageLinkButtonInner"};const{store:t,buttonPopupStore:i,events:n}=e,o=(0,l.O7)(),d=(0,c.yK)((e=>({button:{height:24,paddingLeft:8,paddingRight:8,color:e.regularTextColor,marginLeft:"auto"},icon:{width:14,height:14,fill:e.regularIconColor,marginLeft:0,marginRight:6},label:{color:e.regularTextColor}})),[]);return r.createElement(xe.Z,a()({isSmall:!0,onClick:()=>{Oi({store:t,buttonPopupStore:i,environment:o}),we.V5j(o)},style:d.button},n),j.Z.link(d.icon),s()(U.Z,{isSmall:!0,style:d.label},void 0,s()(u.FormattedMessage,{id:"blockPermissionsSettings.copyLinkButton.label",defaultMessage:"Copy link"})))}function Ni(e){const{calculatedPermissions:t}=e,i=t.mostPermissivePublicItem.permissionItem;if((0,y.YX)(i.role))return s()(u.FormattedMessage,{defaultMessage:"This page has public link access, so anyone with the link will be able to view the page.",id:"blockPermissionsSettings.publicLinkInfo.tooltip"});const n=t.mostPermissiveSpaceItem.permissionItem;return(0,y.YX)(n.role)?s()(u.FormattedMessage,{defaultMessage:"This page has workspace access, so anyone in the workspace will be able to view the link.",id:"blockPermissionsSettings.workspacePermissions.tooltip"}):t.permissionItemsCount>1?s()(u.FormattedMessage,{defaultMessage:"Only you and other invited members and guests will be able to view the link.",id:"blockPermissionsSettings.userPermissions.tooltip"}):s()(u.FormattedMessage,{defaultMessage:"Only you can access this page, so the link will only work for you.",id:"blockPermissionsSettings.privatePermissions.tooltip"})}async function Oi(e){const{store:t,buttonPopupStore:i,environment:n}=e,a=(0,he.ZP)({store:t,pageVisitSource:pe.tY.CopyLink});await Ce.RD({environment:n,stringValue:a,copiedMessage:Ce.tq.copiedLinkToClipboard}),i&&i.setState({open:!1})}const Vi=function(e){window.__c={n:"PageLinkButton"};const{store:t,buttonPopupStore:i,calculatedPermissions:n}=e,{device:a}=(0,l.O7)(),o=(0,c.yK)((()=>({tooltip:{width:280}})),[]);return s()(ye.Z,{delayThreshold:0,placement:ye.Z.Placement.Bottom,renderTooltip:()=>s()(Ni,{calculatedPermissions:n}),textWrap:!0,style:o.tooltip,render:e=>a.isMobile?s()(Ri,{store:t,buttonPopupStore:i,events:e}):s()(Li,{store:t,buttonPopupStore:i,events:e})})};const Ui=function(e){window.__c={n:"ShareMenuFooter"};const{isMobile:t}=(0,l.Fy)(),i="control"!==(0,A.a)("link_sharing_pill"),n=(0,c.yK)((e=>({container:{display:"flex",alignItems:t&&i?"normal":"center",boxShadow:`0 -1px 0 ${e.regularDividerColor}`,flexDirection:t&&i?"column":"row",justifyContent:"space-between",padding:t||i?"8px 14px":"4px 4px"}})),[t,i]),{mostPermissiveSpaceItem:a,showRestrictedPermissionBanner:o}=e.calculatedPermissions;return r.createElement(r.Fragment,null,s()("div",{style:n.container},void 0,i&&t&&s()(Zi,{store:e.store,sudoModeStore:e.permissionItemArgs.sudoModeStore,location:e.permissionItemArgs.location,spacePermission:a,isRestricted:o}),i&&!t&&s()(Ei,{store:e.store,sudoModeStore:e.permissionItemArgs.sudoModeStore,location:e.permissionItemArgs.location,spacePermission:a,isRestricted:o}),!t&&!i&&s()(ki.Z,{}),s()(Vi,{store:e.store,buttonPopupStore:e.buttonPopupStore,calculatedPermissions:e.calculatedPermissions})))};var Wi=i(90965);function Ki(e){window.__c={n:"UnlistedPermissionItem"};const{store:t,spacePermission:i,fromPermissionWrapper:n}=e,o=(0,c.yK)((e=>({icon:{width:17,height:17,fill:e.mediumIconColor},iconContainer:{backgroundColor:e.lightDividerColor,borderRadius:32}})),[]);return r.createElement(Be.Z,a()({icon:j.Z.link(o.icon),iconStyle:o.iconContainer,title:s()(u.FormattedMessage,{defaultMessage:"Members with the link",id:"blockPermissionsSettings.permissionItem.linkAccess"}),currentBlockStore:t,permissionItem:i.permissionItem,from:i.from,upgradeButtonName:"space_permission_item",fromPermissionWrapper:n},e.permissionItemArgs))}function zi(e){window.__c={n:"Title"};const{spaceStore:t}=e,i=(0,l.O7)(),n=(0,d.VK)((()=>(0,mi.rn)(i,t)),[i,t]);return s()(u.FormattedMessage,{defaultMessage:"Everyone at {workspaceName}",id:"blockPermissionsSettings.permissionItem.workspaceAccessNew",values:{workspaceName:n}})}function Gi(e){window.__c={n:"Subtitle"};const{spaceStore:t}=e,i=(0,d.VK)((()=>(0,Wi.t5)((0,mi.jv)(t))),[t]);return s()(u.FormattedMessage,{defaultMessage:"{numberOfWorkspaceMembers, plural, one {{numberOfWorkspaceMembers} person} other {{numberOfWorkspaceMembers} people}}",id:"blockPermissionsSettings.spacePermission.none",values:{numberOfWorkspaceMembers:i}})}function qi(){return s()(u.FormattedMessage,{defaultMessage:"Applies to all members in your workspace.",id:"blockPermissionsSettings.spacePermission.tooltip"})}const Hi=function(e){window.__c={n:"SpacePermissionItem"};const{store:t,spacePermission:i,fromPermissionWrapper:n}=e,o=(0,d.VK)((()=>{const e=T.default.state.currentSpaceStore;return null!=e&&e.isDefined()?e:null}),[]),l=(0,c.yK)((()=>({container:{width:"100%"}})),[]);return o?i.permissionItem.unlisted_timestamp?r.createElement(Ki,e):s()("div",{style:l.container,className:m.afv},void 0,r.createElement(Be.Z,a()({currentBlockStore:t,permissionItem:i.permissionItem,from:i.from,icon:s()(gi.p,{disabled:!0,store:o,size:Be.Z.iconSize}),title:s()(zi,{spaceStore:o}),nonInheritedTooltip:s()(qi,{}),subtitle:s()(Gi,{spaceStore:o}),upgradeButtonName:"space_permission_item",fromPermissionWrapper:n},e.permissionItemArgs))):null};var ji=i(79362);function Qi(e){const{teamName:t,isCompact:i}=e;return s()(u.FormattedMessage,i?{defaultMessage:"Teamspace guests",id:"blockPermissionsSettings.permissionItem.teamGuestAccess.compact"}:t?{defaultMessage:"Teamspace guests of {teamName}",id:"blockPermissionsSettings.permissionItem.teamGuestAccess",values:{teamName:t}}:{id:"blockPermissionsSettings.permissionItem.teamspaceGuestsTeamName.hidden",defaultMessage:"Teamspace guests of a private teamspace"})}function Yi(e){const{membersCount:t,isCompact:i}=e;return i?null:s()(u.FormattedMessage,{defaultMessage:"{membersCount, plural, one {{membersCount} person} other {{membersCount} people}}",id:"blockPermissionsSettings.teamPermission.subtitle",values:{membersCount:t}})}function $i(e){window.__c={n:"TeamGuestPermissionTooltip"};const{teamName:t}=e,i=(0,c.yK)((()=>({tooltip:{whiteSpace:"normal",maxWidth:240}})),[]);return t?s()("div",{style:i.tooltip},void 0,s()(u.FormattedMessage,{defaultMessage:"Applies to all teamspace guests of {teamName}.",values:{teamName:t},id:"blockPermissionsSettings.teamGuestPermission.tooltip"})):null}const Xi=function(e){var t;window.__c={n:"TeamGuestPermissionItem"};const{store:i,blockTeamGuestPermission:n,isExternalTeam:o,fromPermissionWrapper:l}=e,{permissionItem:u}=n,p=(0,d.VK)((()=>T.default.state.currentSpaceStore),[]),g=y.bm(u)?u.team_id:null===(t=C.VP(i))||void 0===t?void 0:t.id,{teamStore:h,teamIsDefined:f,teamName:v,teamIcon:S,membersCount:b}=(0,d.VK)((()=>{if(!p||!g)return{};const e=I.zX.createChildStore(p,{table:M.e0,id:g,spaceId:p.id});return null!=e&&e.isDefined()?{teamStore:e,teamIsDefined:null==e?void 0:e.isDefined(),teamName:e.getName(),teamIcon:e.getIcon(),membersCount:(0,k.xf)({teamStore:e,spaceStore:p}).length}:{}}),[p,g]),w=!o,_=(0,c.yK)((()=>({container:{width:"100%"}})),[]);if(!h)return null;const P=S&&ji.V2(S.icon)?ji.mk(S.icon):"gray",Z=S?{...S,icon:`/icons/user-circle_${P}.svg`}:void 0;return s()("div",{style:_.container,className:m.YHn},void 0,r.createElement(Be.Z,a()({isCompact:w,currentBlockStore:i,permissionItem:u,icon:f?s()(gi.p,{disabled:!0,store:h,size:Be.Z.iconSize,icon:Z}):j.Z.privateTeam(),title:s()(Qi,{teamName:v,isCompact:w}),nonInheritedTooltip:s()($i,{teamName:v}),from:n.from,subtitle:f&&s()(Yi,{membersCount:b,isCompact:w}),upgradeButtonName:"team_permission_item",fromPermissionWrapper:l},e.permissionItemArgs)))};function Ji(e){const{teamName:t,isCompact:i}=e;return s()(u.FormattedMessage,i&&t?{defaultMessage:"Teamspace members",id:"blockPermissionsSettings.permissionItem.teamAccessV2"}:t?{defaultMessage:"Members of {teamName}",id:"blockPermissionsSettings.permissionItem.teamAccess",values:{teamName:t}}:{id:"blockPermissionsSettings.permissionItem.membersTeamName.hidden",defaultMessage:"Members of a private teamspace"})}function en(e){const{membersCount:t,isCompact:i}=e;return i?null:s()(u.FormattedMessage,{defaultMessage:"{membersCount, plural, one {{membersCount} person} other {{membersCount} people}}",id:"blockPermissionsSettings.teamPermission.subtitle",values:{membersCount:t}})}function tn(e){window.__c={n:"TeamMemberPermissionTooltip"};const{teamName:t}=e,i=(0,c.yK)((()=>({tooltip:{whiteSpace:"normal",maxWidth:240}})),[]);return t?s()("div",{style:i.tooltip},void 0,s()(u.FormattedMessage,{defaultMessage:"Applies to all owners and members of {teamName}.",values:{teamName:t},id:"blockPermissionsSettings.teamPermission.tooltip"})):null}const nn=function(e){var t;window.__c={n:"TeamMemberPermissionItem"};const{store:i,blockTeamPermission:n,isExternalTeam:o,fromPermissionWrapper:l}=e,{permissionItem:u}=n,p=(0,d.VK)((()=>T.default.state.currentSpaceStore),[]),g=y.zU(u)?u.team_id:null===(t=C.VP(i))||void 0===t?void 0:t.id,{teamStore:h,teamIsDefined:f,teamName:v,membersCount:S}=(0,d.VK)((()=>{if(!p||!g)return{};const e=I.zX.createChildStore(p,{table:M.e0,id:g,spaceId:p.id});return{teamStore:e,teamIsDefined:null==e?void 0:e.isDefined(),teamName:null==e?void 0:e.getName(),membersCount:(0,k.xf)({teamStore:e,spaceStore:p}).length}}),[p,g]),b=!o,w=(0,c.yK)((()=>({container:{width:"100%"}})),[]);return h?s()("div",{style:w.container,className:m.YHn},void 0,r.createElement(Be.Z,a()({isCompact:b,currentBlockStore:i,permissionItem:n.permissionItem,from:n.from,icon:f?s()(gi.p,{disabled:!0,store:h,size:Be.Z.iconSize}):j.Z.privateTeam(),title:s()(Ji,{teamName:v,isCompact:b}),nonInheritedTooltip:s()(tn,{teamName:v}),subtitle:f&&s()(en,{membersCount:S,isCompact:b}),upgradeButtonName:"team_permission_item",fromPermissionWrapper:l},e.permissionItemArgs))):null};var an=i(62512);function on(e){const{store:t,teamOwners:i,teamStore:n,teamName:a}=e;if(a){const e=i.map((e=>I.U6.createChildStore(t,{table:zt.KJ,id:e})));return s()(an.n,{teamStore:n,ownerStores:e})}return j.Z.privateTeam()}function sn(e){const{teamName:t,isCompact:i}=e;return s()(u.FormattedMessage,i&&t?{defaultMessage:"Teamspace owners",id:"blockPermissionsSettings.permissionItem.teamOwnerAccessV2",values:{teamName:t}}:t?{defaultMessage:"Owners of {teamName}",id:"blockPermissionsSettings.permissionItem.teamOwnerAccess",values:{teamName:t}}:{id:"blockPermissionsSettings.permissionItem.teamName.hidden",defaultMessage:"Owners of a private teamspace"})}function rn(e){const{teamOwnersCount:t,isCompact:i}=e;return i||0===t?null:s()(u.FormattedMessage,{defaultMessage:"{teamOwnersCount, plural, one {{teamOwnersCount} person} other {{teamOwnersCount} people}}",id:"blockPermissionsSettings.teamOwnerPermission.subtitle",values:{teamOwnersCount:t}})}function ln(e){window.__c={n:"TeamOwnerPermissionTooltip"};const{teamName:t}=e,i=(0,c.yK)((()=>({tooltip:{whiteSpace:"normal",maxWidth:240}})),[]);return t?s()("div",{style:i.tooltip},void 0,s()(u.FormattedMessage,{defaultMessage:"Applies to all owners of {teamName}",values:{teamName:t},id:"blockPermissionsSettings.teamOwnerPermission.tooltip"})):null}const dn=function(e){var t;window.__c={n:"TeamOwnerPermissionItem"};const{store:i,blockTeamOwnerPermission:n,isExternalTeam:o,fromPermissionWrapper:l}=e,{permissionItem:u}=n,p=(0,d.VK)((()=>T.default.state.currentSpaceStore),[]),g=y.LW(u)?u.team_id:null===(t=C.VP(i))||void 0===t?void 0:t.id,{teamStore:h,teamName:f,teamOwners:v}=(0,d.VK)((()=>{if(!p||!g)return{undefined:void 0};const e=I.zX.createChildStore(p,{table:M.e0,id:g,spaceId:p.id});return{teamStore:e,teamName:e.getName(),teamOwners:(0,Ht.XO)({membership:e.getMembers()})}}),[p,g]),S=!o,b=(0,c.yK)((()=>({container:{width:"100%"}})),[]);return h?s()("div",{style:b.container,className:m.ZmO},void 0,r.createElement(Be.Z,a()({isCompact:S,currentBlockStore:i,permissionItem:n.permissionItem,from:n.from,icon:s()(on,{store:i,teamName:f,teamStore:h,teamOwners:v}),title:s()(sn,{teamName:f,isCompact:S}),nonInheritedTooltip:s()(ln,{teamName:f}),subtitle:s()(rn,{teamOwnersCount:v.length,isCompact:S}),upgradeButtonName:"team_owner_permission_item",fromPermissionWrapper:l},e.permissionItemArgs))):null};var cn=i(92350),un=i(33241);function mn(e){const{teamName:t}=e;return s()(u.FormattedMessage,t?{defaultMessage:"Everyone at {teamName}",id:"blockPermissionsSettings.permissionItem.teamspaceAccess",values:{teamName:t??""}}:{defaultMessage:"Everyone at a private teamspace",id:"blockPermissionsSettings.permissionItem.teamspace.hidden"})}function pn(e){const{membersCount:t}=e;return s()(u.FormattedMessage,{defaultMessage:"{membersCount, plural, one {{membersCount} person} other {{membersCount} people}}",id:"blockPermissionsSettings.teamPermission.subtitle",values:{membersCount:t}})}const gn=function(e){var t;window.__c={n:"TeamPermissionItem"};const{store:i,blockTeamMemberPermission:n,blockTeamOwnerPermission:o,blockTeamGuestPermission:u}=e,m=(0,l.O7)(),p=(0,l.Fy)(),[g,h]=(0,r.useState)(!1),{permissionItem:f}=n,v=(0,d.VK)((()=>T.default.state.currentSpaceStore),[]),b=y.zU(f)?f.team_id:null===(t=C.VP(i))||void 0===t?void 0:t.id,w=o.permissionItem.role,_=f.role,k={type:"team_overview_permission",role:w===_?_:"none"===_||"none"===w?"limited":"access"},{teamStore:P,teamIsDefined:Z,teamName:x}=(0,d.VK)((()=>{if(!v||!b)return{undefined:void 0};const e=I.zX.createChildStore(v,{table:M.e0,id:b,spaceId:v.id});return{teamStore:e,teamIsDefined:null==e?void 0:e.isDefined(),teamName:null==e?void 0:e.getName()}}),[v,b]),F=(0,cn.KR)(P),A=(0,d.VK)((()=>{if(!v)return!1;return!v.getDisableTeamGuests()&&((null==P||!P.isDefault())&&(0,mt.F$)())}),[v,P]),E=(0,r.useCallback)((()=>{const e=!1===g;if(h(!g),e){if(!P)return;we.dSV(m,{share_menu_session_id:D.ZP.state.sessionId,type:"team",team_id:P.id})}}),[m,g,h,P]),B=(0,c.yK)((e=>({icon:{width:10,marginLeft:4,fill:e.lightIconColor},teamPermissionsContainer:{paddingLeft:16,display:g?"block":"none"},roleButton:{marginRight:-8,color:e.mediumTextColor,fontSize:p.isMobile?14:12}})),[g,p.isMobile]),R=j.Z.chevronUpRounded(B.icon);return P?r.createElement(r.Fragment,null,r.createElement(Be.Z,a()({currentBlockStore:i,permissionItem:k,from:n.from,icon:Z?s()(gi.p,{disabled:!0,store:P,size:Be.Z.iconSize}):j.Z.privateTeam(),title:s()(mn,{teamName:x}),subtitle:Z&&s()(pn,{membersCount:F}),upgradeButtonName:"team_permission_item",onClick:E,permissionRoleSelect:g?R:s()(un.d,{role:k.role,icon:j.Z.expandThin,disabled:!0,buttonStyle:B.roleButton,table:S.iU,isRemovable:!1,isCurrentUser:!1})},e.permissionItemArgs)),s()("div",{style:B.teamPermissionsContainer},void 0,o&&s()(dn,{store:i,permissionItemArgs:e.permissionItemArgs,blockTeamOwnerPermission:o,fromPermissionWrapper:"expandable_permission"}),n&&s()(nn,{store:i,permissionItemArgs:e.permissionItemArgs,blockTeamPermission:n,fromPermissionWrapper:"expandable_permission"}),A&&u&&s()(Xi,{store:i,permissionItemArgs:e.permissionItemArgs,blockTeamGuestPermission:u,fromPermissionWrapper:"expandable_permission"}))):null};function hn(e){const{store:t,permissionItemArgs:i}=e,{showTeamPermission:n,showSpacePermission:a,mostPermissiveTeamOwnerItem:o,mostPermissiveTeamMemberItem:l,mostPermissiveTeamGuestItem:d,mostPermissiveSpaceItem:c,pagePermissionUIModel:u}=e.calculatedPermissions,m=Number(n)+Number(a);return r.createElement(r.Fragment,null,n&&o&&l&&s()(gn,{store:t,blockTeamOwnerPermission:o,blockTeamMemberPermission:l,blockTeamGuestPermission:d,permissionItemArgs:i}),a&&s()(Hi,{store:t,spacePermission:c,permissionItemArgs:i,fromPermissionWrapper:"permission_list"}),s()(fn,{store:t,pagePermissions:u,numberPermissionsAlreadyRendered:m,permissionItemArgs:i}))}function fn(e){window.__c={n:"PagePermissionsList"};const t=(0,u.useIntl)(),i=(0,d.VK)((()=>{const e=T.default.state.currentSpaceStore;return null!=e&&e.isDefined()?e.id:""}),[]),{store:n,pagePermissions:a,numberPermissionsAlreadyRendered:o,permissionItemArgs:l,showHeader:c}=e,{showUserPermissions:m,mostPermissiveGroupPermissions:p,mostPermissiveTeamPermissions:g,mostPermissiveUserPermissions:h,spacePermissionGroups:v}=a,S=(0,d.VK)((()=>jt()),[]),b=(0,d.VK)((()=>{const e=m?function(e){const{mostPermissiveUserPermissions:t,spaceVisibleUserMap:i}=e,n={};return t.forEach((t=>{n[t.permissionItem.user_id]=s()(di,{store:e.store,userPermission:t,showInherited:!1,permissionItemArgs:e.permissionItemArgs,spaceVisibleUserMap:i,fromPermissionWrapper:"permission_list"})})),n}({store:n,mostPermissiveUserPermissions:h,permissionItemArgs:l,spaceVisibleUserMap:S}):[];return f().compact(Object.keys(e).map((i=>{const a=I.U6.createChildStore(n,{table:zt.KJ,id:i}),o=a.getModel();if(!a.isReady()||o)return{title:(0,Gt.Nz)(t,o),permissionItem:e[i]}})))}),[m,h,l,n,t,S]),M=i?function(e){const{spaceId:t,spacePermissionGroups:i,mostPermissiveGroupPermissions:n}=e,a={};return n.forEach((n=>{const o=n.permissionItem.group_id;i.find((e=>e.id===o))&&(a[o]=s()(ii,{store:e.store,groupPermission:n,spaceId:t,showInherited:!1,permissionItemArgs:e.permissionItemArgs,fromPermissionWrapper:"permission_list"}))})),a}({store:n,spaceId:i,spacePermissionGroups:v,mostPermissiveGroupPermissions:p,permissionItemArgs:l}):[],w=function(e){const{store:t,mostPermissiveTeamPermissions:i,permissionItemArgs:n}=e;return i.map((e=>y.LW(e.permissionItem)?s()(dn,{store:t,blockTeamOwnerPermission:e,isExternalTeam:!0,permissionItemArgs:n,fromPermissionWrapper:"permission_list"},`${e.permissionItem.team_id}.owner`):y.bm(e.permissionItem)?s()(Xi,{store:t,blockTeamGuestPermission:e,isExternalTeam:!0,permissionItemArgs:n,fromPermissionWrapper:"permission_list"},`${e.permissionItem.team_id}.teamGuest`):s()(nn,{store:t,blockTeamPermission:e,isExternalTeam:!0,permissionItemArgs:n,fromPermissionWrapper:"permission_list"},`${e.permissionItem.team_id}.member`)))}({store:n,mostPermissiveTeamPermissions:g,permissionItemArgs:l}),C=[...b,...Object.keys(M).map((e=>{const i=v.find((t=>t.id===e));return{title:i?(0,$t.kF)({intl:t,group:i}):"",permissionItem:M[e]}}))];C.sort(((e,t)=>e.title.localeCompare(t.title)));const _=w.concat(C.map((e=>e.permissionItem))),k=_.length;if(0===k)return null;if(k>5-o){const e=Math.max(2-o,0);return r.createElement(r.Fragment,null,c&&s()(yi,{}),_.slice(0,e),s()(ci,{permissions:_.slice(e,-1)}),_[k-1])}return r.createElement(r.Fragment,null,c&&s()(yi,{}),_)}function vn(e,t){return e.from.table===S.iU&&e.from.blockId===t.id}const yn=function(e){window.__c={n:"PermissionsList"};const t=(0,l.O7)(),{device:i}=t,{store:n,permissionItemArgs:a,calculatedPermissions:o}=e,{sudoModeStore:u}=a,{permissionItemsCount:m,pagePermissionUIModel:p,showRestrictedPermissionBanner:g}=o,h=(0,d.VK)((()=>{const e=T.default.state.currentSpaceStore;if(!e)return!0;if(n.isTopLevelPrivatePage({spaceStore:e,environment:t}))return!0;const i=(0,C.uJ)(n);for(const n of i)if((0,Yt.NZ)(n)&&n.isTopLevelPrivatePage({spaceStore:e,environment:t}))return!0;return!1}),[n,t]);let v=null;const y=(0,d.VK)((()=>function(e){const{store:t,showRestrictedPermissionBanner:i}=e,{canAccessParent:n}=Z({store:t});return n&&(i||P({store:t}))}({store:n,showRestrictedPermissionBanner:g})),[n,g]),{canAccessParent:S}=(0,d.VK)((()=>Z({store:n})),[n]),M={...o};if(!y&&S){const[e,t]=function(e,t){const{mostPermissiveGroupPermissions:i,mostPermissiveTeamPermissions:n,mostPermissiveUserPermissions:a}=t,[o,s]=f().partition(i,(t=>vn(t,e))),[r,l]=f().partition(n,(t=>vn(t,e))),[d,c]=f().partition(a,(t=>vn(t,e))),u={...t,mostPermissiveGroupPermissions:s,mostPermissiveTeamPermissions:l,mostPermissiveUserPermissions:c},m={...t,mostPermissiveGroupPermissions:o,mostPermissiveTeamPermissions:r,mostPermissiveUserPermissions:d};return[u,m]}(n,p);M.pagePermissionUIModel=e,v=s()(fn,{store:n,pagePermissions:t,numberPermissionsAlreadyRendered:0,permissionItemArgs:a,showHeader:!0})}const w=(0,d.VK)((()=>!function(e){const{store:t}=e,i=(0,C.uJ)(t),n=i.find((e=>e instanceof I.G&&e.isRestricted())),a=i[i.length-1];return n||a.getParentTable()===b.bx&&a.canRead()}({store:n})),[n]),_=i.isMobile?vt.Z.None:vt.Z.Y,k=(0,c.yK)((e=>({scroller:{paddingBottom:10,minHeight:i.isMobile||0===m?void 0:1===m?60:90}})),[i,m]);return(0,r.useEffect)((()=>{qt.oE({environment:t,calculatedPermissions:o})}),[]),r.createElement(r.Fragment,null,s()(wt.Z,{style:k.scroller,type:_},void 0,!h&&s()(vi,{store:n}),s()(_i,{store:n,showRestrictedPermissionBanner:g,sudoModeStore:u}),!y&&m>0&&s()(bi,{store:n}),s()(hn,{store:n,calculatedPermissions:M,permissionItemArgs:a}),v,w&&s()(ui,{store:n})),!i.isMobile&&s()(Ui,{store:n,buttonPopupStore:e.buttonPopupStore,calculatedPermissions:M,permissionItemArgs:a}))};i(57658);var Sn=i(59054),bn=i(98742),Mn=i(21752),wn=i(43765),Cn=i(76798),_n=i(69507),kn=i(70268),Tn=i(62385);function In(e){window.__c={n:"PublicPermissionLevelBanner"};const{publicPermission:t}=e,i=(0,c.yK)((e=>({banner:{backgroundColor:e.accentColors.gray[50],borderRadius:4,height:34,marginLeft:14,marginRight:14,marginTop:5,marginBottom:5,paddingRight:14,display:"flex",alignItems:"center"},label:{fontSize:12,display:"inline-flex",marginRight:10},icon:{height:20,width:20,marginLeft:14,marginRight:8,color:e.mediumIconColor},manageButton:{color:e.regularTextColor,fontWeight:Q.Z.fontWeight.medium}})),[]),n=t.permissionItem.role;return y.YX(n)?s()("div",{style:i.banner},void 0,s()(U.Z,{style:i.label},void 0,j.Z.globe3(i.icon),s()(Pn,{role:n})),s()(Tn.Z,{style:i.manageButton,onClick:()=>D.ZP.setState({...D.ZP.state,display:D.wV.Publish,tab:D.XF.Publish})},void 0,s()(u.FormattedMessage,{id:"shareMenu.managePublishSettingsButton.label",defaultMessage:"Manage"}))):null}function Pn(e){const{role:t}=e;switch(t){case"read_and_write":return s()(u.FormattedMessage,{id:"shareMenu.publicPermissionBanner.canEdit",defaultMessage:"This page allows edits from anyone on the web"});case"comment_only":return s()(u.FormattedMessage,{id:"shareMenu.publicPermissionBanner.canComment",defaultMessage:"This page allows comments from anyone on the web"});case"reader":return s()(u.FormattedMessage,{id:"shareMenu.publicPermissionBanner.canRead",defaultMessage:"This page can be viewed by anyone on the web"});case"editor":case"membership_admin":case"content_only_editor":case"none":return null;default:(0,z.t1)(t)}}function Zn(e){window.__c={n:"ShareMenuSearchRequestImpl"};const{store:t,shouldShowSlackOnly:i,calculatedPermissions:n,permissionItemArgs:o,tokenQuery:m,showShimmer:p,error:g,ready:h,result:f}=e,v=n.pagePermissionUIModel,b=(0,l.O7)(),M=(0,d.qz)(e.inviteTargetsStore,G.ZP),w=(0,d.qz)(e.menuListStore,St.Z),k=(0,d.VK)((()=>jt()),[]),T=(0,d.VK)((()=>mt.Rv()),[]),I=(0,d.VK)((()=>mt.KP()),[]),P=(0,d.VK)((()=>I),[I]),Z=(0,c.yK)((e=>({sectionMenuItem:{paddingTop:0,display:"flex",flexDirection:"column",gap:2},zeroState:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",textAlign:"center",color:e.mediumTextColor,fontSize:14,position:"relative",pointerEvents:"auto",paddingTop:10,marginTop:110},zeroStateText:{width:"70%",alignSelf:"center"},zeroStateIcon:{height:54,width:54,marginBottom:12,fill:e.mediumIconColor}})),[]),{inPageTargets:x,notInPageTargets:F,filteredImportedContacts:A}=(0,d.VK)((()=>{const{inviteUsers:e,inviteGroups:i,importedContacts:a=[]}=f??{inviteUsers:[],inviteGroups:[],importedContacts:[]},o=[...e,...i],s=[],r=[],l=new Set;o.forEach((e=>{"group"!==e.type&&l.add(e.value.email.toLowerCase());const i=Boolean(Lt.Zp({store:t,target:e})),a=function(e){const{inviteTarget:t,blockStore:i,spacePermission:n,teamMemberPermission:a,groupPermission:o}=e,s=t.type;if("newUser"===s)return{role:"none",type:"user_permission",user_id:t.value.email};if("existingUser"===s)return mt.KP()?_.uY({userId:t.value.id,store:i}):_.Dt({userId:t.value.id,store:i});if("group"===s){const e={role:"none",type:"group_permission",group_id:t.value.id},s=(0,C.VP)(i),r=null==s?void 0:s.getMembers().find((e=>(0,Ht.lF)({groupId:t.value.id,teamMember:e}))),l=s&&a&&r;if(!mt.KP()){return[n,...l?[a]:[],o??{permissionItem:e,from:{table:S.iU,blockId:i.id}}].sort(((e,t)=>y.xm[t.permissionItem.role]-y.xm[e.permissionItem.role]))[0].permissionItem}return[n,...l?[a]:[],o||{permissionItem:e,from:{table:S.iU,blockId:i.id}}].sort(((e,t)=>y.xm[t.permissionItem.role]-y.xm[e.permissionItem.role]))}(0,z.t1)(s)}({inviteTarget:e,blockStore:t,spacePermission:n.mostPermissiveSpaceItem,teamMemberPermission:n.mostPermissiveTeamMemberItem,groupPermission:"group"===e.type?v.mostPermissiveGroupPermissions.find((t=>t.permissionItem.group_id===e.value.id)):void 0}),o=Array.isArray(a)?a[0].permissionItem:a;if("existingUser"===e.type&&!Boolean(e.spaceRole)){const t=k.get(e.value.id);e.spaceRole=t?t.role:"not_in_space"}(i||y.YX(o.role??"none"))&&"newUser"!==e.type?s.push({inviteTarget:e,permissionItem:o,mostPermissivePermissions:Array.isArray(a)?a:void 0}):"newUser"!==e.type&&r.push(e)}));const d=a.filter((e=>!l.has(e.value.email.toLowerCase())));return{inPageTargets:s,notInPageTargets:r,filteredImportedContacts:d}}),[t,f,n.mostPermissiveSpaceItem,n.mostPermissiveTeamMemberItem,v.mostPermissiveGroupPermissions,k]),{isValidEmail:E,isEmailInTargets:B}=(0,d.VK)((()=>{const e=(0,xt.H3)(m);return{isValidEmail:(0,xt.oH)(e),isEmailInTargets:[...x.map((e=>{let{inviteTarget:t}=e;return t})),...F].some((t=>"group"!==t.type&&t.value.email===e))}}),[m,x,F]),D=E&&!B,R=(0,d.VK)((()=>D&&mt.bx()),[D]);if(g)return s()(_n.l,{loading:!h},void 0,s()(wn.Z,{title:s()(u.FormattedMessage,{id:"inviteUserModal.searchInput.errorMessage",defaultMessage:"Something went wrong"})}));if(!h&&p)return s()(kn.B,{areaHeight:window.innerHeight});const L={key:"user results",render:e=>r.createElement(Ke.Z,a()({},e,{style:Z.sectionMenuItem,loading:!h,title:s()(u.FormattedMessage,{id:"shareMenuSearchRequest.suggestedEmail.title",defaultMessage:"Keep typing an email to invite"})})),items:[{key:m,render:e=>r.createElement(Ve.Z,a()({icon:j.Z.addPerson({width:24,height:24}),title:r.createElement(r.Fragment,null,s()(u.FormattedMessage,{id:"shareMenuSearchRequest.inviteNewUser.buttonItem",defaultMessage:"Invite {tokenQuery}",values:{tokenQuery:m}})),right:R?s()(Dt.Z,{store:t,onlyShowTokenType:!0,showRemoveButton:!1,target:{source:"email",type:"newUser",value:{email:m},spaceRole:"not_in_space"}},m):null,rightStyle:{marginRight:4}},e)),action:async()=>{const e=(0,xt.H3)(m);if(!(0,xt.oH)(e))return;const t=await ct.M5(b,[e]);if(!t.length)return;const i=t[0];Ft.H({target:i,inviteTargetsStore:M})||(M.setState({inviteTargets:[...M.state.inviteTargets,i],tokenQuery:""}),w.unsetFocus())}}]},N=!i&&F.length>0&&0===m.length,O={key:"suggested",render:e=>r.createElement(Ke.Z,a()({},e,{style:Z.sectionMenuItem,title:s()(u.FormattedMessage,{id:"shareMenuSearchRequest.suggestedSection.title",defaultMessage:"Suggested"}),loading:!h})),items:F.map(((e,i)=>({key:"newUser"===e.type?e.value.email:e.value.id,render:i=>{const n=Ft.H({target:e,inviteTargetsStore:M});return r.createElement(On,a()({},i,{invited:!1,inviteTarget:e,isInInviteTargets:n,blockStore:t,spaceVisibleUserMap:k}))},action:()=>xn({inviteTarget:e,inviteTargetsStore:M,menuListStore:w})})))},V=!i&&m.length>0&&x.length>0,U={key:"in page",render:e=>r.createElement(Ke.Z,a()({},e,{style:Z.sectionMenuItem,title:s()(u.FormattedMessage,{id:"shareMenuSearchRequest.inPageSection.title",defaultMessage:"In page"}),loading:!h})),items:x.map((e=>{const{inviteTarget:i,permissionItem:n,mostPermissivePermissions:l}=e,{type:d}=i;if("existingUser"===d){const e=!!l&&l.length>1;if(I&&e)return{key:i.value.id,render:e=>r.createElement(En,a()({},e,{blockStore:t,inviteTarget:i,permissionItem:n,mostPermissivePermissions:l,spaceVisibleUserMap:k,permissionItemArgs:o})),action:()=>{}};{const e=v.mostPermissiveUserPermissions.find((e=>e.permissionItem.user_id===i.value.id));return e?{key:i.value.id,render:i=>r.createElement(Ve.Z,a()({},i,{itemMarginLeft:0,itemMarginRight:0,title:s()(di,{store:t,userPermission:e,showInherited:!0,ignoreLocalHoverState:!0,spaceVisibleUserMap:k,permissionItemArgs:o})})),action:()=>{}}:{key:i.value.id,render:e=>r.createElement(En,a()({},e,{blockStore:t,inviteTarget:i,permissionItem:n,spaceVisibleUserMap:k,permissionItemArgs:o})),action:()=>xn({inviteTarget:i,inviteTargetsStore:M,menuListStore:w})}}}if("group"===d){if(I)return{key:i.value.id,render:s=>r.createElement(En,a()({},s,{blockStore:t,inviteTarget:i,permissionItem:n,mostPermissivePermissions:e.mostPermissivePermissions,spaceVisibleUserMap:k,permissionItemArgs:o})),action:()=>{}};{const e=v.mostPermissiveGroupPermissions.find((e=>e.permissionItem.group_id===i.value.id));return e?{key:i.value.id,render:i=>r.createElement(Ve.Z,a()({},i,{itemMarginLeft:0,itemMarginRight:0,title:s()(ii,{store:t,groupPermission:e,spaceId:t.getSpaceId(),showInherited:!0,permissionItemArgs:o})})),action:()=>{}}:{key:i.value.id,render:e=>r.createElement(En,a()({},e,{blockStore:t,inviteTarget:i,permissionItem:n,spaceVisibleUserMap:k,permissionItemArgs:o})),action:()=>xn({inviteTarget:i,inviteTargetsStore:M,menuListStore:w})}}}(0,z.t1)(d)}))},W=!i&&F.length>0&&m.length>0,K={key:"not in page",render:e=>r.createElement(Ke.Z,a()({},e,{style:Z.sectionMenuItem,title:m.length>0&&s()(u.FormattedMessage,{id:"shareMenuSearchRequest.notInPageSection.title",defaultMessage:"Not in page"}),loading:!h})),items:F.map((e=>({key:"newUser"===e.type?e.value.email:e.value.id,render:i=>r.createElement(On,a()({},i,{invited:!1,inviteTarget:e,isInInviteTargets:Ft.H({target:e,inviteTargetsStore:M}),blockStore:t,spaceVisibleUserMap:k})),action:()=>xn({inviteTarget:e,inviteTargetsStore:M,menuListStore:w})})))},q=T&&A.length>0,H={key:"imported contacts",render:e=>r.createElement(Ke.Z,a()({},e,{style:Z.sectionMenuItem,title:s()(u.FormattedMessage,{id:"shareMenuSearchRequest.importedContactsSection.title",defaultMessage:"From Slack"}),loading:!h})),items:A.map((e=>({key:e.value.email,render:i=>r.createElement(On,a()({},i,{invited:!1,inviteTarget:e,isInInviteTargets:Ft.H({target:e,inviteTargetsStore:M}),blockStore:t,spaceVisibleUserMap:k})),action:()=>{Ft.H({target:e,inviteTargetsStore:M})?M.setState({...M.state,inviteTargets:M.state.inviteTargets.filter((t=>"newUser"!==t.type||e.value.email!==t.value.email))}):(M.setState({inviteTargets:[...M.state.inviteTargets,e],tokenQuery:""}),w.unsetFocus())}})))};let Q=[];return D&&Q.push(L),N&&Q.push(O),V&&Q.push(U),W&&Q.push(K),q&&Q.push(H),i&&(Q=[H],0===H.items.length)?s()(Vn,{styles:Z}):0===Q.length&&(Q=[L],0===m.length)?s()(Un,{styles:Z,shouldShowSlackMessage:T}):r.createElement(r.Fragment,null,P&&s()(In,{publicPermission:n.mostPermissivePublicItem}),s()(We.Z,{type:We.i.Vertical,initialFocus:m.length>0?0:void 0,sections:Q,store:w}))}function xn(e){const{inviteTarget:t,inviteTargetsStore:i,menuListStore:n}=e;if(Ft.H({target:t,inviteTargetsStore:i})){const e=i.state.inviteTargets.filter((e=>"group"===t.type&&"group"===e.type||"existingUser"===t.type&&"existingUser"===e.type?t.value.id!==e.value.id:"newUser"!==t.type||"newUser"!==e.type||t.value.email!==e.value.email));return i.setState({...i.state,inviteTargets:e}),void n.unsetFocus()}i.setState({inviteTargets:[...i.state.inviteTargets,t],tokenQuery:""}),n.unsetFocus()}const Fn=r.forwardRef(((e,t)=>{window.__c={n:"InPageGroupResultItem"};const{blockStore:i,inviteTarget:n,permissionItem:o,mostPermissivePermissions:m,permissionItemArgs:p}=e,g=(0,l.O7)(),h=(0,u.useIntl)(),[f,v]=(0,r.useState)(!1),y=(0,d.VK)((()=>T.default.state.currentSpaceStore),[]),b=(0,d.VK)((()=>i.getSpaceId()),[i]),M=(0,d.VK)((()=>mt.KP()&&m&&m.length>0),[m]),w=(0,d.VK)((()=>{if("group"===n.type)return(0,$t.kF)({group:n.value,intl:h})}),[n,h]),C=(0,d.VK)((()=>{if(y&&"group"===n.type&&n.value.icon)return{pointer:{table:y.table,id:y.id},icon:n.value.icon}}),[y,n]),_=(0,d.VK)((()=>y?"group"!==n.type?0:(0,$t.rm)({group:n.value,spaceStore:y,limit:void 0}).totalNumberMembers:0),[y,n]),k=(0,r.useCallback)((()=>{if(M){const e=!1===f;v(!f),e&&we.dSV(g,{share_menu_session_id:D.ZP.state.sessionId,type:"group",group_id:n.value.id})}}),[g,M,f,v,n]),I=(0,c.yK)((e=>({titleContainer:{display:"flex",alignItems:"center",paddingTop:8,paddingBottom:8,marginLeft:2,minHeight:36},groupInfoContainer:{display:"flex",flexDirection:"column"},nameAndIconContainer:{display:"flex",alignItems:"center"},groupNameLabel:{marginLeft:10,marginRight:4},groupMembersLabel:{marginLeft:10},permissionRoleButton:{marginRight:-6,color:e.mediumTextColor,fontSize:12},container:{whiteSpace:"nowrap",fontWeight:Q.Z.fontWeight.bold},recordIcon:{marginRight:4,display:"inline-block",verticalAlign:"middle"},recordTitle:{display:"inline"},tooltip:{maxWidth:180},expandablePermissionList:{paddingLeft:16},roundedPermissionItem:{borderRadius:3,overflow:"hidden",marginRight:4}})),[]);return s()(ye.Z,{delayThreshold:0,placement:ye.Z.Placement.Left,textWrap:!0,style:I.tooltip,renderTooltip:()=>s()(Bn,{blockStore:i,blockPermissionItem:o}),render:n=>r.createElement(r.Fragment,null,r.createElement("div",n,r.createElement(Ve.Z,a()({},e,(0,bn.Z)(e,{onClick:k}),{ref:t,title:s()("div",{style:I.titleContainer},void 0,s()(Xt.Z,{size:32}),s()("div",{style:I.groupInfoContainer},void 0,s()("div",{style:I.nameAndIconContainer},void 0,s()(U.Z,{style:I.groupNameLabel},void 0,w),Boolean(null==C?void 0:C.icon)&&s()(Jt.Z,{disabled:!0,bucket:"public",title:w,icon:C,size:18,isEmptyPage:!1})),s()(U.Z,{isSmall:!0,style:I.groupMembersLabel},void 0,M&&f?s()(Dn,{}):r.createElement(r.Fragment,null,s()(u.FormattedMessage,{defaultMessage:"Group",id:"blockPermissionsSettings.groupPermission.label"})," · ",s()(u.FormattedMessage,{defaultMessage:"{numberOfGroupMembers, plural, one {{numberOfGroupMembers} person} other {{numberOfGroupMembers} people}}",id:"blockPermissionsSettings.groupPermission.none",values:{numberOfGroupMembers:_}}))))),right:s()(un.d,{table:S.iU,disabled:!0,icon:M?f?j.Z.chevronUpRounded:j.Z.expandThin:void 0,role:o.role??"none",isRemovable:!1,isCurrentUser:!1,buttonStyle:I.permissionRoleButton})}))),M&&f&&s()("div",{style:I.expandablePermissionList},void 0,null==m?void 0:m.map(((e,t)=>{const n=e.permissionItem.type;let a=null;switch(n){case"space_permission":a=s()(Hi,{store:i,spacePermission:e,permissionItemArgs:p,fromPermissionWrapper:"expandable_permission"});break;case"explicit_team_permission":a=s()(nn,{store:i,blockTeamPermission:e,isExternalTeam:!0,permissionItemArgs:p,fromPermissionWrapper:"expandable_permission"});break;case"group_permission":a=s()(ii,{spaceId:b,store:i,groupPermission:e,permissionItemArgs:p,showInherited:!0,isRemovableOverride:!1,fromPermissionWrapper:"expandable_permission"});break;case"user_permission":break;case"explicit_team_owner_permission":case"explicit_team_guest_permission":break;case"public_permission":case"bot_permission":case"deleted_permission":case"restricted_permission":case"exclusive_user_permission":break;case"team_owner_permission":case"team_permission":break;default:(0,z.t1)(n)}return s()("div",{style:I.roundedPermissionItem},t,a)}))))})})),An=r.forwardRef(((e,t)=>{window.__c={n:"InPageUserResultItem"};const{blockStore:i,inviteTarget:n,permissionItem:o,mostPermissivePermissions:u,spaceVisibleUserMap:m,permissionItemArgs:p}=e,g=(0,l.O7)(),[h,f]=(0,r.useState)(!1),v="existingUser"===n.type?I.U6.createChildStore(i,{table:zt.KJ,id:n.value.id}):void 0,y=(0,d.VK)((()=>"none"===n.spaceRole?Qt({spaceVisibleUserMap:m,userId:n.value.id,blockStore:i}):(0,Mn.K)(n.spaceRole)),[n,m,i]),b=(0,d.VK)((()=>i.getSpaceId()),[i]),M=(0,d.VK)((()=>mt.KP()&&u&&u.length>0),[u]),w=(0,r.useCallback)((()=>{if(M){const e=!1===h;f(!h),e&&we.dSV(g,{share_menu_session_id:D.ZP.state.sessionId,type:"user",userId:n.value.id})}}),[g,M,h,f,n]),C=(0,c.yK)((e=>({permissionRoleButton:{marginRight:-6,color:e.mediumTextColor,fontSize:12},container:{whiteSpace:"nowrap",fontWeight:Q.Z.fontWeight.bold},cellMemberAvatarContainer:{paddingTop:8,paddingBottom:8},recordIcon:{marginRight:4,display:"inline-block",verticalAlign:"middle"},recordTitle:{display:"inline"},tooltip:{maxWidth:180},expandablePermissionList:{paddingLeft:24},roundedPermissionItem:{borderRadius:3,overflow:"hidden",marginRight:4}})),[]);return s()(ye.Z,{delayThreshold:0,placement:ye.Z.Placement.Left,textWrap:!0,style:C.tooltip,renderTooltip:()=>s()(Bn,{blockStore:i,blockPermissionItem:o}),render:n=>r.createElement(r.Fragment,null,r.createElement("div",n,r.createElement(Ve.Z,a()({},e,(0,bn.Z)(e,{onClick:w}),{ref:t,title:s()(Mn.Z,{isLarge:!0,actorStore:v,containerStyle:C.cellMemberAvatarContainer,spaceRole:y,caption:M&&h?s()(Dn,{}):void 0}),right:s()(un.d,{table:S.iU,disabled:!0,icon:M?h?j.Z.chevronUpRounded:j.Z.expandThin:void 0,role:o.role??"none",isRemovable:!1,isCurrentUser:!1,buttonStyle:C.permissionRoleButton})}))),M&&h&&s()("div",{style:C.expandablePermissionList},void 0,null==u?void 0:u.map(((e,t)=>{const n=e.permissionItem.type;let a=null;switch(n){case"space_permission":a=s()(Hi,{store:i,spacePermission:e,permissionItemArgs:p,fromPermissionWrapper:"expandable_permission"});break;case"explicit_team_owner_permission":a=s()(dn,{store:i,blockTeamOwnerPermission:e,isExternalTeam:!0,permissionItemArgs:p,fromPermissionWrapper:"expandable_permission"});break;case"explicit_team_permission":a=s()(nn,{store:i,blockTeamPermission:e,isExternalTeam:!0,permissionItemArgs:p,fromPermissionWrapper:"expandable_permission"});break;case"explicit_team_guest_permission":a=s()(Xi,{store:i,blockTeamGuestPermission:e,isExternalTeam:!0,permissionItemArgs:p,fromPermissionWrapper:"expandable_permission"});break;case"group_permission":a=s()(ii,{store:i,spaceId:b,groupPermission:e,permissionItemArgs:p,showInherited:!0,isRemovableOverride:!1,fromPermissionWrapper:"expandable_permission"});break;case"user_permission":a=s()(di,{store:i,userPermission:e,permissionItemArgs:p,spaceVisibleUserMap:m,showInherited:!0,isRemovableOverride:!1,fromPermissionWrapper:"expandable_permission"});break;case"public_permission":case"bot_permission":case"deleted_permission":case"restricted_permission":case"exclusive_user_permission":break;case"team_owner_permission":case"team_permission":break;default:(0,z.t1)(n)}return s()("div",{style:C.roundedPermissionItem},t,a)}))))})})),En=r.forwardRef(((e,t)=>{const{inviteTarget:i}=e,n=i.type;switch(n){case"group":return r.createElement(Fn,a()({},e,{ref:t,inviteTarget:i}));case"existingUser":return r.createElement(An,a()({},e,{ref:t,inviteTarget:i}));default:(0,z.t1)(n)}}));function Bn(e){window.__c={n:"InPageItemTooltip"};const{blockStore:t,blockPermissionItem:i}=e,n=(0,l.O7)(),a=(0,d.VK)((()=>T.default.state.currentSpaceStore),[]),o=(0,d.VK)((()=>{if(a)return(0,mi.Wd)(n,a)}),[n,a]),m=(0,d.VK)((()=>{const e=i.type;if("explicit_team_permission"===e||"explicit_team_owner_permission"===e||"explicit_team_guest_permission"===e){return I.zX.createChildStore(t,{table:M.e0,id:i.team_id})}}),[t,i]),p=(0,d.VK)((()=>null==m?void 0:m.getIcon()),[m]),g=(0,c.yK)((()=>({container:{fontWeight:Q.Z.fontWeight.bold,...Q.Z.textOverflowStyle},recordIcon:{marginRight:4,display:"inline-block",verticalAlign:"middle"},recordTitle:{display:"inline"}})),[]),h=i.type;return"space_permission"===h?s()(u.FormattedMessage,{id:"shareMenu.searchResult.spacePermission.tooltip",defaultMessage:"Everyone at {spaceIconAndName} has access.",values:{spaceIconAndName:s()("span",{style:g.container},void 0,o&&s()(Jt.Z,{disabled:!0,icon:o,isEmptyPage:!1,size:12,style:g.recordIcon}),a&&s()(Cn.Z,{store:a,style:g.recordTitle}))}}):"explicit_team_owner_permission"===h?s()(u.FormattedMessage,{id:"shareMenu.searchResult.teamPermission.tooltip",defaultMessage:"Teamspace owners of {teamIconAndName} have access.",values:{teamIconAndName:s()("span",{style:g.container},void 0,p&&s()(Jt.Z,{disabled:!0,icon:p,isEmptyPage:!1,size:12,style:g.recordIcon}),m&&s()(Cn.Z,{store:m,style:g.recordTitle}))}}):"explicit_team_permission"===h?s()(u.FormattedMessage,{id:"shareMenu.searchResult.teamMemberPermission.tooltip",defaultMessage:"Teamspace members of {teamIconAndName} have access.",values:{teamIconAndName:s()("span",{style:g.container},void 0,p&&s()(Jt.Z,{disabled:!0,icon:p,isEmptyPage:!1,size:12,style:g.recordIcon}),m&&s()(Cn.Z,{store:m,style:g.recordTitle}))}}):"explicit_team_guest_permission"===h?s()(u.FormattedMessage,{id:"shareMenu.searchResult.teamGuestPermission.tooltip",defaultMessage:"Teamspace guests of {teamIconAndName} have access.",values:{teamIconAndName:s()("span",{style:g.container},void 0,p&&s()(Jt.Z,{disabled:!0,icon:p,isEmptyPage:!1,size:12,style:g.recordIcon}),m&&s()(Cn.Z,{store:m,style:g.recordTitle}))}}):"group_permission"===h?s()(u.FormattedMessage,{id:"shareMenu.searchResult.groupPermission.tooltip",defaultMessage:"This group has access."}):"user_permission"===h||"exclusive_user_permission"===h||"public_permission"===h||"restricted_permission"===h||"deleted_permission"===h||"team_permission"===h||"team_owner_permission"===h||"bot_permission"===h?r.createElement(r.Fragment,null,y.YX(i.role??"none")&&s()(u.FormattedMessage,{id:"shareMenu.searchResult.userPermission.tooltip",defaultMessage:"This user has access"})):void(0,z.t1)(h)}function Dn(){return s()(u.FormattedMessage,{id:"shareMenu.inPageSearchResult.caption",defaultMessage:"Permission from"})}function Rn(e){window.__c={n:"CircleCheckmark"};const{checked:t}=e,i=(0,c.yK)((e=>({circleCheckmark:{display:"flex",justifyContent:"center",alignItems:"center",width:22,height:22,borderRadius:"50%",borderStyle:"solid",borderWidth:1.75,borderColor:t?H.ZP.blue:e.buttonPressedBackground,backgroundColor:t?H.ZP.blue:"transparent",marginRight:6},checkIcon:{height:12,width:12,color:"white"}})),[t]);return s()("div",{style:i.circleCheckmark},void 0,t&&j.Z.check(i.checkIcon))}const Ln=r.forwardRef(((e,t)=>{window.__c={n:"NotInPageGroupResultItem"};const{inviteTarget:i,isInInviteTargets:n,disabled:o}=e,l=(0,u.useIntl)(),m=(0,d.VK)((()=>T.default.state.currentSpaceStore),[]),p=(0,d.VK)((()=>(0,$t.kF)({group:i.value,intl:l})),[i,l]),g=(0,d.VK)((()=>{if(m&&i.value.icon)return{pointer:{table:m.table,id:m.id},icon:i.value.icon}}),[m,i]),h=(0,d.VK)((()=>{if(!m)return 0;return(0,$t.rm)({group:i.value,spaceStore:m,limit:void 0}).totalNumberMembers}),[m,i]),f=(0,c.yK)((()=>({titleContainer:{display:"flex",alignItems:"center",paddingTop:8,paddingBottom:8,marginLeft:2,minHeight:36},groupInfoContainer:{display:"flex",flexDirection:"column"},nameAndIconContainer:{display:"flex",alignItems:"center"},groupNameLabel:{marginLeft:10,marginRight:4},groupMembersLabel:{marginLeft:10}})),[]),v=s()("div",{style:f.titleContainer},void 0,s()(Xt.Z,{size:32}),s()("div",{style:f.groupInfoContainer},void 0,s()("div",{style:f.nameAndIconContainer},void 0,s()(U.Z,{style:f.groupNameLabel},void 0,p),Boolean(null==g?void 0:g.icon)&&s()(Jt.Z,{disabled:!0,bucket:"public",title:p,icon:g,size:18,isEmptyPage:!1})),s()(U.Z,{isSmall:!0,style:f.groupMembersLabel},void 0,s()(u.FormattedMessage,{defaultMessage:"Group",id:"blockPermissionsSettings.groupPermission.label"})," · ",s()(u.FormattedMessage,{defaultMessage:"{numberOfGroupMembers, plural, one {{numberOfGroupMembers} person} other {{numberOfGroupMembers} people}}",id:"blockPermissionsSettings.groupPermission.none",values:{numberOfGroupMembers:h}}))));return r.createElement(Ve.Z,a()({},e,{ref:t,title:v,right:s()(Rn,{checked:n}),disabled:o}))})),Nn=r.forwardRef(((e,t)=>{window.__c={n:"NotInPageUserResultItem"};const{inviteTarget:i,blockStore:n,isInInviteTargets:o,disabled:l,spaceVisibleUserMap:u,...m}=e,p=(0,c.yK)((()=>({cellMemberAvatarContainer:{paddingTop:8,paddingBottom:8},iconBox:{position:"absolute",bottom:-3,right:-3},iconBoxImage:{background:"white",padding:2,borderRadius:"100%"}})),[]),g=(0,d.VK)((()=>"existingUser"===i.type?Qt({spaceVisibleUserMap:u,userId:i.value.id,blockStore:n}):void 0),[i,u,n]),h=(0,r.useMemo)((()=>"existingUser"===i.type?{actorStore:I.U6.createChildStore(n,{table:zt.KJ,id:i.value.id}),avatar:void 0}:"newUser"===i.type?{actorStore:void 0,avatar:{email:i.value.email,name:"slack"===i.source?i.value.name:void 0,avatarUrl:"slack"===i.source?i.value.avatar_url:void 0}}:void(0,z.t1)(i)),[i,n]);return r.createElement(Ve.Z,a()({},m,{ref:t,title:r.createElement(Mn.Z,a()({isLarge:!0},h,{containerStyle:p.cellMemberAvatarContainer,avatarBadge:"newUser"===i.type&&"slack"===i.source?s()($.Z,{type:"image_url",imageURL:q.Z.images.externalIntegrations.slackIconPng,size:18,style:p.iconBox,imageStyle:p.iconBoxImage}):void 0,spaceRole:g})),disabled:l,right:!l&&s()(Rn,{checked:o})}))})),On=r.forwardRef(((e,t)=>{const{inviteTarget:i,blockStore:n,spaceVisibleUserMap:o}=e,s=i.type;switch(s){case"group":return r.createElement(Ln,a()({},e,{ref:t,inviteTarget:i}));case"newUser":case"existingUser":return r.createElement(Nn,a()({},e,{ref:t,inviteTarget:i,blockStore:n,spaceVisibleUserMap:o}));default:(0,z.t1)(s)}}));function Vn(e){const{styles:t}=e;return s()("div",{style:t.zeroState},void 0,j.Z.personBadgeExclamationMark(t.zeroStateIcon),s()("div",{style:t.zeroStateText},void 0,s()("div",{style:{fontWeight:Q.Z.fontWeight.semibold,marginBottom:4}},void 0,s()(u.FormattedMessage,{id:"shareMenuSearchRequest.noImportedContacts.title",defaultMessage:"No contacts found"})),s()("div",{},void 0,s()(u.FormattedMessage,{id:"shareMenuSearchRequest.noImportedContacts.text",defaultMessage:"Try connecting a different Slack workspace or typing an email address"}))))}function Un(e){const{styles:t,shouldShowSlackMessage:i}=e;return s()("div",{style:t.zeroState},void 0,j.Z.addPersonCircle(t.zeroStateIcon),s()("div",{style:t.zeroStateText},void 0,s()("div",{style:{fontWeight:Q.Z.fontWeight.semibold,marginBottom:4}},void 0,s()(u.FormattedMessage,{id:"shareMenuSearchRequest.noSuggestions.title",defaultMessage:"Search or add people"})),s()("div",{},void 0,s()(u.FormattedMessage,i?{id:"shareMenuSearchRequest.noSuggestions.text",defaultMessage:"Try connecting a Slack workspace or typing an email address"}:{id:"shareMenuSearchRequest.noSuggestions.defaultText",defaultMessage:"Try typing an email address"}))))}const Wn=function(e){window.__c={n:"ShareMenuSearchRequest"};const t=(0,l.O7)(),i=(0,u.useIntl)(),[n,o]=(0,r.useState)(!0),s=(0,d.VK)((()=>e.inviteTargetsStore.state.tokenQuery),[e.inviteTargetsStore]),c=(0,d.VK)((()=>{if(e.shouldShowSlackOnly)return{userLimit:0,botLimit:0,groupLimit:0,importContactLimit:e.sectionRenderLimit};const t=yt.Z.completeSlackAuthentications.state.length>0&&mt.Rv();return{userLimit:e.sectionRenderLimit,botLimit:0,groupLimit:e.shouldShowGroups?e.sectionRenderLimit:0,importContactLimit:t?e.sectionRenderLimit:0}}),[e.sectionRenderLimit,e.shouldShowGroups,e.shouldShowSlackOnly]),[{value:m,status:p}]=(0,Sn.r5)((async()=>ct.jL({query:s,sectionLimit:c,membersOnly:e.membersOnly,environment:t,intl:i}).finally((()=>o(!1)))),[t,i,e.membersOnly,s,c],{debounce:40});return r.createElement(Zn,a()({},e,{tokenQuery:s,showShimmer:n,ready:"pending"!==p,error:"rejected"===p,result:m}))};function Kn(e){window.__c={n:"InviteContent"};const t=(0,l.O7)(),i=(0,d.qz)(e.inviteTargetsStore,G.ZP),n=(0,d.VK)((()=>i.state.inviteTargets),[i]),{display:a,source:o,focus:u,emailMessage:m}=(0,d.VK)((()=>{const{display:e}=D.ZP.state;return e===D.wV.Invite?D.ZP.state:{display:e,source:void 0,focus:void 0,emailMessage:""}}),[]),p=(0,d.VK)((()=>T.default.state.currentSpaceStore),[]),g=(0,d.VK)((()=>o===D.T5.Notion&&0===n.length&&(0,mt.Rv)()),[n.length,o]),h=(0,d.VK)((()=>yt.Z.completeSlackAuthentications.state),[]),f=(0,r.useCallback)((()=>{i.reset()}),[i]),[v,y]=(0,r.useState)(!1);(0,r.useEffect)((()=>{if(p&&!v&&g){for(const e of h)dt.loadContacts(t,{botId:e.id,spaceId:p.id,integrationId:lt.nO}).catch((e=>{}));y(!0)}}),[g]);const S=a===D.wV.Invite&&n.length>0,b=(0,c.yK)((()=>({scroller:{flexGrow:1}})),[]);return a!==D.wV.Invite?null:r.createElement(r.Fragment,null,s()(wt.Z,{type:vt.Z.Y,style:b.scroller},void 0,s()(Wn,{inviteTargetsStore:i,store:e.store,menuListStore:e.menuListStore,shouldShowGroups:!0,shouldShowSlackOnly:o===D.T5.Slack,membersOnly:!1,sectionRenderLimit:10,calculatedPermissions:e.calculatedPermissions,permissionItemArgs:e.permissionItemArgs})),g&&s()(Zt,{onClickAuthenticated:()=>{D.ZP.setState({...D.ZP.state,tab:D.XF.Share,display:D.wV.Invite,focus:D.Sw.Search,source:D.T5.Slack,emailMessage:m}),i.setState({...i.state,tokenQuery:""})}}),s()(Hn,{open:S&&!g,focus:u===D.Sw.Message,value:m,onFocus:()=>{o&&a===D.wV.Invite&&D.ZP.setState({...D.ZP.state,focus:D.Sw.Message,tab:D.XF.Share,display:a,source:o,emailMessage:m})},onChange:e=>{D.ZP.setState({...D.ZP.state,focus:u,tab:D.XF.Share,display:a,source:o,emailMessage:e.target.value})},onCancel:async()=>{await ut.zd({environment:t,inviteTargetsStore:i})&&(ut.a6(t),f())},maxLength:1e3}))}function zn(e){window.__c={n:"InviteSection"};const{store:t,menuListStore:i,sudoModeStore:n,contextualInviteStore:o}=e,m=(0,l.O7)(),p=(0,u.useIntl)(),g=(0,d.qz)(e.inviteTargetsStore,G.ZP),{display:h,source:f,focus:v,emailMessage:y}=(0,d.VK)((()=>{const{display:e}=D.ZP.state;return e===D.wV.Invite?D.ZP.state:{display:e,source:void 0,focus:void 0,emailMessage:""}}),[]),[S,b]=(0,r.useState)("editor"),M=(0,d.VK)((()=>t.getType()),[t]),w=(0,d.VK)((()=>o.state.flowId),[o]),C=(0,d.VK)((()=>g.state.inviteTargets),[g]),k=(0,d.VK)((()=>T.default.state.currentSpaceStore),[]),I=(0,d.VK)((()=>new Set(null==k?void 0:k.getEmailDomains())),[k]),P=(0,d.VK)((()=>{const{data:e}=bt.default.state,t=e?ke.CM(e):[],i={};return t.forEach((e=>{i[e.userId]=e})),i}),[]),Z=e=>{const t=e.type;if("existingUser"===t){const t=P[e.value.id];if(!t)return!0;return"none"===t.role&&!t.isTeamGuest&&t.isPageGuest}return"newUser"===t||"group"!==t&&void 0},x=e=>!pt.$s({contextualInviteUser:e,allowedDomains:I}),F=(0,d.VK)((()=>t.canEditMembership()),[t]),A=(0,d.VK)((()=>{const e=C.filter((e=>{let{type:t}=e;return"newUser"===t})).map((e=>{let{value:t}=e;return t.email})),t=C.filter((e=>{let{type:t}=e;return"existingUser"===t})).map((e=>{let{value:t}=e;return t.id}));return _.dA(m,[...e,...t])}),[m,C]),E=(0,gt.Z)(t),B=(0,d.VK)((()=>{const e=E.isStoreInTeam&&!E.teamAllowsGuests,t=!E.isStoreInTeam&&!E.spaceAllowsGuests||E.isStoreInTeam&&!E.teamAllowsGuests&&!E.spaceAllowsGuests,i=C.some((e=>"newUser"===e.type||("existingUser"===e.type?"none"===e.spaceRole||"not_in_space"===e.spaceRole:void 0)));return(e||t)&&i}),[C,E]),R=(0,d.VK)((()=>{const{currentSpaceStore:e}=T.default.state;return(0,mt.gp)({currentSpaceStore:e})}),[]),L=(0,ht.i)(t),N=y.length>1e3,O=C.length>0,V=(0,c.yK)((()=>({permissionsRoleSelectButton:{display:"flex",whiteSpace:"nowrap",height:20,margin:0,borderRadius:3,color:H.ZP.uiGray}})),[]);async function U(){const e=ft.default.mark("share_menu.invite_user_lag");await ut.qg({environment:m,intl:p,inviteOrigin:"page_share_modal",role:S,emailMessage:y,inviteTargetsStore:g,blockStore:t,sudoModeStore:n,onInviteClick:()=>{g.reset(),D.ZP.setState({...D.ZP.state,tab:D.XF.Share,display:D.wV.MainShareMenu}),(e=>{o.setState({...o.state,invitedUsers:e.filter(Z).map(pt.Si).filter(z.$K).filter(x)}),k&&pt.fr({environment:m,spaceStore:k,contextualInviteStore:o})})(C)},onInviteComplete:e=>ut.Cv({success:e,inviteTargets:C})}),ft.default.measure(e,{environment:m})}async function W(){void 0===i.state.focus.indexGlobal&&void 0===i.state.focus.indexLocal&&void 0===i.state.focus.section&&await U()}let K;return K=B?L:N?s()(u.FormattedMessage,{id:"shareMenu.inviteButton.emailOverMaxLength.tooltip",defaultMessage:"Message exceeds the limit of 1000 characters."}):void 0,s()(ye.Z,{disableTooltip:F,renderTooltip:()=>{if(!F)return s()(u.FormattedMessage,{id:"shareMenu.inviteButton.fullAccessOnlyMessage.tooltip",defaultMessage:"Only those with full access can add people."})},render:e=>r.createElement("div",a()({style:{display:"flex"}},e),s()(Rt,{store:t,inviteTargetsStore:g,flowId:w,disabled:!F,origin:"share_menu_v2",focus:v===D.Sw.Search,onFocus:()=>{D.ZP.setState({...D.ZP.state,tab:D.XF.Share,display:D.wV.Invite,focus:D.Sw.Search,source:f||D.T5.Notion,emailMessage:y||""}),we.yEH(m,{source:f||D.T5.Notion})},onSubmit:W,placeholder:R?p.formatMessage({id:"shareMenu.inviteTargetsInput.placeholder.exp",defaultMessage:"Email or group, separated by commas"}):p.formatMessage({id:"shareMenu.inviteTargetsInput.placeholder",defaultMessage:"Add people, groups, or emails..."}),right:O&&s()(Ct.ZP,{disabled:!F,role:S,table:"block",type:"user_permission",blockType:M,isInvite:!0,upgradeButtonName:"invite_permission_block",buttonStyle:V.permissionsRoleSelectButton,isMenuItem:!1,onChange:e=>b(e)})}),A?s()(Gn,{onClick:()=>ct.Vu({environment:m,upgradeButtonName:"user_permission_item"})}):s()(qn,{tooltip:K,disabled:!F||B||N,onClick:async()=>{h!==D.wV.MainShareMenu?await U():D.ZP.setState({...D.ZP.state,tab:D.XF.Share,display:D.wV.Invite,focus:D.Sw.Search,source:D.T5.Notion,emailMessage:""})}}))})}function Gn(e){const{onClick:t}=e;return s()(ye.Z,{disableTooltip:!1,renderTooltip:()=>s()(_t.e,{}),render:e=>r.createElement(ce.Z,a()({isLarge:!0,style:{marginLeft:8},onClick:t},e),s()(u.FormattedMessage,{id:"shareMenu.inviteButton.upgrade",defaultMessage:"Upgrade"}))})}function qn(e){const{tooltip:t,disabled:i,onClick:n}=e;return s()(ye.Z,{disableTooltip:!Boolean(t),renderTooltip:()=>t,render:e=>r.createElement(ce.Z,a()({isLarge:!0,style:{marginLeft:8},disabled:i,onClick:n},e),s()(u.FormattedMessage,{id:"shareMenu.inviteButton.invite",defaultMessage:"Invite"}))})}function Hn(e){window.__c={n:"EmailMessageInput"};const{open:t,focus:i,value:n,maxLength:a,onFocus:o,onChange:r,onCancel:l}=e,d=(0,u.useIntl)(),m=n.length/a>=.8,p=(0,rt.TQ)(n),g=m||p,h=(0,c.yK)((e=>({container:{maxHeight:t?100:0,position:"absolute",bottom:0,width:"100%",backgroundColor:e.modalBackground,pointerEvents:t?"all":"none",transitionProperty:"max-height",transitionDuration:"0.3s",boxShadow:"0px -4px 4px rgba(0, 0, 0, 0.03)",overflow:"hidden",zIndex:1},input:{maxHeight:t?100:0,borderTop:1,borderTopStyle:"solid",borderTopColor:e.regularDividerColor,padding:18,fontSize:14,transitionProperty:"max-height",transitionDuration:"0.3s"}})),[t]),f=d.formatMessage({id:"shareMenu.emailMessageInput.placeholder",defaultMessage:"Add a message to your invite..."});return s()("div",{style:h.container},void 0,g&&s()(jn,{value:n,maxLength:a,shouldShowLengthWarning:m,shouldShowLinkWarning:p}),s()(Ze.Z,{textarea:!0,focusInitial:!1,format:Ze.B.Transparent,placeholder:f,maxlength:a,focus:i,value:n,onFocus:o,onChange:r,inputStyle:h.input,onCancel:l}))}function jn(e){window.__c={n:"EmailMessageWarning"};const{shouldShowLengthWarning:t,shouldShowLinkWarning:i,value:n,maxLength:a}=e,o=(0,c.yK)((e=>({container:{position:"absolute",top:0,display:"flex",justifyContent:"center",fontSize:12,color:e.lightTextColor,width:"100%"},warning:{display:"flex",justifyContent:"center",width:"calc(100% - 36px)",backgroundColor:e.modalBackground,marginTop:1}})),[]);return s()("div",{style:o.container},void 0,s()("div",{style:o.warning},void 0,t&&s()(u.FormattedMessage,{defaultMessage:"{characters} / {maxCharacters} characters",id:"ContextualInvite.permissions_invites.messageLengthWarning",values:{characters:n.length,maxCharacters:a}}),t&&i&&" · ",i&&s()(u.FormattedMessage,{defaultMessage:"Links will be omitted from your message",id:"ContextualInvite.permissions_invites.removeLinkWarning"})))}const Qn=function(e){window.__c={n:"ShareMenuInviteTab"};const{store:t,permissionItemArgs:i,inviteTargetsStore:n}=e,a=(0,l.Fy)(),o=(0,d.qz)(void 0,St.Z),{display:r}=(0,d.VK)((()=>D.ZP.state),[]),u=(0,c.yK)((()=>({container:{position:"relative",height:r!==D.wV.MainShareMenu?540:"unset",transition:"all",transitionDuration:"0.3s",display:"flex",flexDirection:"column",maxHeight:540},searchBar:{paddingLeft:14,paddingRight:14,paddingBottom:8}})),[r]);return s()(Mt.Z,{capture:!0,onTab:function(e){e.preventDefault(),a.isMobile||r!==D.wV.MainShareMenu||D.ZP.setState({...D.ZP.state,tab:D.XF.Share,display:D.wV.Invite,focus:D.Sw.Search,source:D.T5.Notion,emailMessage:""})}},void 0,s()("div",{style:u.container},void 0,s()("div",{style:u.searchBar},void 0,a.isMobile?s()(Kt,{store:t,permissionItemArgs:i}):s()(zn,{store:t,inviteTargetsStore:n,menuListStore:o,sudoModeStore:i.sudoModeStore,contextualInviteStore:e.contextualInviteStore})),r===D.wV.MainShareMenu&&s()(yn,{store:t,calculatedPermissions:e.calculatedPermissions,buttonPopupStore:e.buttonPopupStore,permissionItemArgs:i}),r===D.wV.Invite&&!a.isMobile&&s()(Kn,{store:t,inviteTargetsStore:n,menuListStore:o,calculatedPermissions:e.calculatedPermissions,permissionItemArgs:e.permissionItemArgs})))};const Yn=function(e){window.__c={n:"WorkspaceOwnerPermissionOverride"};const{store:t,sudoModeStore:i}=e,n=(0,d.VK)((()=>i.state.changePermissionsEnabled),[i]),a=(0,d.VK)((()=>i&&i.shouldUserHaveAccessToPrivatePageBlock()&&!i.doesUserAlreadyHaveEditorAccessOnBlock(t.id)&&i.state.privatePageStore),[i,t]),o=(0,c.yK)((e=>({container:{background:e.cardBackground,padding:"12px 18px",boxShadow:e.borderBoxShadow,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"baseline"},button:{fontWeight:Q.Z.fontWeight.medium,justifyContent:"center",marginTop:8,opacity:n?.5:1},icon:{width:16,height:16,marginRight:6,transition:"all 200ms ease",transform:n?"rotate(-90deg)":void 0}})),[n]);return a?s()("div",{style:o.container},void 0,s()(U.Z,{isMultiline:!0},void 0,s()(u.FormattedMessage,{id:"blockPermissionsSettings.workspaceOwner.canChangePermissionsMessage",defaultMessage:"As a <b>workspace owner</b>, you can change the permissions of this page to add yourself or others. Any changes will appear in the audit log.",values:{b:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return s()("b",{},void 0,t)}}})),s()(ve.Z,{disabled:n,style:o.button,onClick:()=>{i.setState({...i.state,changePermissionsEnabled:!0})}},void 0,j.Z.settingsSecurity(o.icon),s()(u.FormattedMessage,n?{id:"blockPermissionsSettings.workspaceOwner.isChangingPermissionsMessageButton",defaultMessage:"Changing permissions"}:{id:"blockPermissionsSettings.workspaceOwner.canChangePermissionsMessageButton",defaultMessage:"Change permissions"}))):null};function $n(e){window.__c={n:"ShareMenuContent"};const t=(0,d.VK)((()=>D.ZP.state.tab),[]);switch(t){case D.XF.Share:return r.createElement(Qn,e);case D.XF.Publish:return s()(st,{store:e.store,permissionItemArgs:e.permissionItemArgs,mostPermissivePublicItem:e.calculatedPermissions.mostPermissivePublicItem});default:(0,z.t1)(t)}}const Xn=function(e){window.__c={n:"ShareMenu"};const{store:t,permissionItemArgs:i}=e,n=(0,l.Fy)(),o=(0,d.qz)(e.inviteTargetsStore,G.ZP),u=(0,c.yK)((()=>({container:{display:"flex",flexDirection:"column",height:"100%"}})),[]);return s()("div",{style:u.container},void 0,i.sudoModeStore&&s()(Yn,{store:t,sudoModeStore:i.sudoModeStore}),!n.isMobile&&s()(te,{inviteTargetsStore:o,mostPermissivePublicItem:e.calculatedPermissions.mostPermissivePublicItem}),r.createElement($n,a()({inviteTargetsStore:o},e)))};function Jn(){window.__c={n:"OfflineMessage"};const e=(0,l.Fy)(),t=(0,c.yK)((()=>({container:{display:"flex",alignItems:"center",justifyContent:"center",height:160}})),[]);return s()("div",{style:t.container},void 0,s()(U.Z,{isMobile:e.isMobile,isSecondaryColor:!0,isMultiline:!0},void 0,s()(u.FormattedMessage,{defaultMessage:"Please go online to publish & share.",id:"blockPermissionsSettings.offline.prompt"})))}const ea=function(e){window.__c={n:"ShareMenuContainer"};const{store:t,sudoModeStore:i,onUpgradeButtonClick:n,location:o}=e,h=(0,l.O7)(),f=(0,l.Fy)(),v=(0,d.qz)(void 0,R.Z),{contextualInviteStore:y}=(0,d.VK)((()=>v.state),[v]),S=(0,d.VK)((()=>T.default.state.currentSpaceStore),[]),b=(0,d.VK)((()=>F({environment:h,spaceStore:S,store:t})),[h,S,t]);"control"!==(0,A.a)("link_sharing_pill")&&(b.showSpacePermission="none"!==b.mostPermissiveSpaceItem.permissionItem.role);const M=(0,d.VK)((()=>y.state.inviteStage),[y]),w=(0,d.VK)((()=>D.ZP.state.tab),[]),C=(0,c.yK)((()=>({title:{fontSize:18},topbarStyle:{paddingTop:15,paddingBottom:15,height:"auto"}})),[]),_=(0,r.useMemo)((()=>({onUpgradeButtonClick:n,sudoModeStore:i,location:o})),[n,i,o]);if(!S)return null;if(!f.isMobile&&(M===B.TG.share_workspace||M===B.TG.request_workspace))return s()(K.Z,{blockStore:t,spaceStore:S,contextualInviteStore:y});const k=f.isMobile?{menuType:p.og.Modal,disableHeaderShadow:!0,title:s()(U.Z,{isMobile:f.isMobile,style:C.title},void 0,s()(u.FormattedMessage,{defaultMessage:"Share",id:"blockPermissionsSettings.mobileShareMenu.title"})),additionalTopbarContent:s()(ne,{mostPermissivePublicItem:b.mostPermissivePublicItem}),left:s()(W.Z,{href:(0,g.UY)("guides.sharing"),analyticsFrom:"sharing"}),footer:w===D.XF.Share&&s()(Ui,{store:t,buttonPopupStore:e.buttonPopupStore,calculatedPermissions:b,permissionItemArgs:_}),topbarStyle:C.topbarStyle,right:s()(V.DoneMenuText,{}),onClickRight:e.onClose,whiteBackground:!0}:{menuType:p.og.Popup,maxHeight:"90vh"};return r.createElement(r.Fragment,null,r.createElement(O.Z,a()({},k,{className:m.B8p}),s()(L.Z,{capture:!0,allowEsc:!0},void 0,s()(N.Z,{capture:!0,ignoreBlockSelection:!0,restoreSelection:!1,focusOffscreenInput:!1,render:()=>E.Z.state.online?s()(Xn,{store:t,permissionItemArgs:_,calculatedPermissions:b,buttonPopupStore:e.buttonPopupStore,inviteTargetsStore:e.inviteTargetsStore,contextualInviteStore:y}):s()(Jn,{})}))))}},93638:(e,t,i)=>{i.r(t),i.d(t,{default:()=>A});var n=i(23174),a=i.n(n),o=i(96486),s=i.n(o),r=i(67294),l=i(83355),d=i(42875),c=i(94044),u=i(5366),m=i(4708),p=i(79817),g=i(87279),h=i(75472),f=i(65598),v=i(38755),y=i(23537),S=i(25464),b=i(79315),M=i(85834),w=i(52878),C=i(74194),_=i(78140),k=i(89728),T=i(44532),I=i(57806),P=i(32357),Z=i(20346);class x extends l.Z{constructor(){super(...arguments),this.storeTypes={universalInviteStore:w.Z},this.renderEmailInput=this.createComputedStore((()=>"milestone_2"===this.props.mode))}renderComponent(){const{universalInviteStore:e}=this.stores,{permissionsInviteStore:t,contextualInviteStore:i}=e.state,n=e.stage,{spaceStore:o}=this.props;if(this.environment.device.isMobile||n===M.TG.closed)return null;if(!(0,f.Mm)(this.props.store)&&(n===M.TG.share_workspace||n===M.TG.request_workspace))return a()(P.Z,{blockStore:this.props.store,spaceStore:o,contextualInviteStore:i});if(n===M.TG.share_page){const n={...this.props,renderInShareMenu:!0,spaceStore:o,permissionsInviteStore:t,contextualInviteStore:i,onInviteClick:()=>{(0,y.$)(this.environment)?i.setState({...i.state,inviteStage:M.TG.closed}):p.fr({environment:this.environment,spaceStore:o,contextualInviteStore:i})},onInviteComplete:e=>{p.x5({success:e,intl:this.props.intl,contextualInviteStore:i})},onCancel:async()=>{await(0,h.Aw)({environment:this.environment,permissionsInviteStoreState:t.state,from:"share_menu"})||e.reset()}};return this.renderEmailInput.state?r.createElement(F,n):r.createElement(I.default,n)}}}x.displayName="UniversalMemberInvite";class F extends I.PermissionsInviteBase{constructor(){super(...arguments),this.inviteTargetLength=this.createComputedStore((()=>this.stores.permissionsInviteStore.state.inviteTargets.length)),this.blockTitle=this.createComputedStore((()=>{if((0,f.Mm)(this.props.store))return"";const e=this.props.store;if(!e.isDefined())return"";const t=e.getModel().getRenderTitle({getRecordModel:e.getRecordModel,userTimeZone:(0,d.r)(),intl:this.props.intl});return t||e.getModel().getEmptyTitlePlaceholder({getRecordModel:e.getRecordModel,userTimeZone:(0,d.r)(),intl:this.props.intl})})),this.handleInviteInputSubmit=async()=>{const{permissionsInviteStore:e}=this.stores;"invitee"===e.state.inputFocus?e.setState({...e.state,inputFocus:"email-content"}):await super.handleInviteInputSubmit()},this.resetFocusOnClickEmpty=e=>{const{permissionsInviteStore:t}=this.stores;e.currentTarget===e.target&&t.setState({...t.state,inputFocus:"none"})}}renderComponent(){return this.renderInShareMenu.state?this.renderUniversalInviteInner():super.renderComponent()}renderUniversalInviteInner(){const{permissionsInviteStore:e}=this.stores;return a()("div",{style:this.getContainerStyle(),onClick:this.resetFocusOnClickEmpty},void 0,a()(T.ZP,{popupType:T.kQ.Popup,alignmentToOrigin:S.v.Start,placementToOrigin:S.u.Bottom,open:"invitee"===e.state.inputFocus,originGap:10,disableMouseCapture:!0,forceRemeasureStore:this.inviteTargetLength,origin:super.renderHeader(),onDismiss:()=>{e.setState({...e.state,inputFocus:"email-content"})},render:()=>{const e=super.renderSearchRequest(),t={menuType:g.og.Popup,disableScroller:!1};return a()("div",{},void 0,r.createElement(_.Z,t,e))},style:{width:360}}),this.renderEmailMessageInput(),this.renderSinglePlayerOptions(),this.renderActions())}renderEmailMessageInput(){const{permissionsInviteStore:e}=this.stores,t=this.getEmailMessage(),{inputFocus:i,emailMessage:n}=e.state,o=n.length/c.vr>=.8,s=(0,c.TQ)(n),r=o||s,l=(0,m._6)(this.environment),d="email-content"===i;return a()(C.Z,{textarea:!0,value:n,focus:d,focusInitial:!1,maxlength:c.vr,onFocus:()=>{e.setState({...e.state,inputFocus:"email-content"})},style:{background:d?"none":this.theme.inputBackground,alignItems:"flex-start",paddingLeft:12,paddingRight:12,paddingTop:8,paddingBottom:r?34:12},inputStyle:{minHeight:l?80:100},placeholder:t,onChange:t=>{e.setState({...e.state,emailMessage:t.target.value})},right:r&&this.renderMessageWarning({shouldShowLengthWarning:o,shouldShowLinkWarning:s}),isRightLastElementOfInput:!0,onSubmit:async()=>{await super.handleInviteClick()}})}renderSinglePlayerOptions(){if((0,f.Mm)(this.props.store))return null;const{contextualInviteStore:e,permissionsInviteStore:t}=this.stores,{currentSpaceStore:i}=b.default.state;if(!i)return null;if(!(0,y.$)(this.environment))return null;const{inviteTargets:n}=t.state;return!t.state.isInviteTargetsEmpty&&n.some((e=>h.OA(e)))?a()(P.Z,{blockStore:this.props.store,spaceStore:i,contextualInviteStore:e}):null}renderActions(){return a()("div",{style:{display:"flex",flexDirection:"row-reverse",justifyContent:"space-between",alignItems:"center",width:"100%"},onClick:this.resetFocusOnClickEmpty},void 0,a()("div",{style:{display:"flex",flexDirection:"row-reverse",justifyContent:"flex-end",gap:8}},void 0,this.renderDesktopInputRightInnerButton({isLarge:!1}),a()(k.Z,{style:{minWidth:c.UF,justifyContent:"center"},isLarge:!1,isLightGray:!0,onClick:()=>{var e,t;null===(e=(t=this.props).onCancel)||void 0===e||e.call(t)}},void 0,a()(u.FormattedMessage,{defaultMessage:"Cancel",id:"ContextualInvite.permissions_invites.button.cancel"}))),a()(Z.Z,{style:{paddingLeft:0,paddingRight:0},disableHover:!0}))}renderMessageWarning(e){const{permissionsInviteStore:t}=this.stores,{shouldShowLengthWarning:i,shouldShowLinkWarning:n}=e;return a()("span",{style:{fontSize:12,color:this.theme.lightTextColor,position:"absolute",bottom:8,left:12}},void 0,i&&a()(u.FormattedMessage,{defaultMessage:"{characters} / {maxCharacters} characters",id:"ContextualInvite.permissions_invites.messageLengthWarning",values:{characters:t.state.emailMessage.length,maxCharacters:c.vr}}),i&&n&&" · ",n&&a()(u.FormattedMessage,{defaultMessage:"Links will be omitted from your message",id:"ContextualInvite.permissions_invites.removeLinkWarning"}))}getEmailMessage(){const{currentUserStore:e,currentSpaceStore:t}=b.default.state,{permissionsInviteStore:i}=this.stores,{intl:n}=this.props,{inviteTargets:a}=i.state,o=!i.state.isInviteTargetsEmpty&&s().every(a,h.OA);if(!t)return n.formatMessage(c.VX.default);const r=null==e?void 0:e.getDisplayName(n),l=(0,v.rn)(this.environment,t);if(!r||!l)return n.formatMessage(c.VX.default);return(0,c.jm)({includeOptional:!1,isGuest:o,emailProps:{userName:r,pageName:this.blockTitle.state,spaceName:l},intl:this.props.intl})}getContainerStyle(){const{WindowSizeStore:e}=this.environment;return{display:"flex",alignItems:"center",minHeight:52,paddingTop:10,paddingBottom:10,paddingLeft:e.getSafePaddingLeftCSS(14),paddingRight:e.getSafePaddingRightCSS(14),flexDirection:"column",gap:10}}}const A=(0,u.injectIntl)(x)},40732:(e,t,i)=>{i.r(t),i.d(t,{isLimitReachedStage:()=>ne,isConfirmPurchaseStage:()=>ae,isCancellationStage:()=>oe,default:()=>re});var n=i(23174),a=i.n(n),o=i(67294),s=i(13991),r=i(480),l=i(81954),d=i(24405),c=i(41892),u=i(8848),m=i(94919),p=i(7057),g=i(53397),h=i(5366),f=i(3791),v=i(896),y=i(47425),S=i(97880),b=i(82990),M=i(47307),w=i(64964),C=i(21325),_=i(99498),k=i(65544),T=i(1865),I=i(52533),P=i(33665),Z=i(38755),x=i(80554),F=i(94191),A=i(31925),E=i(21115),B=i(8323),D=i(79315),R=i(78291),L=i(8711),N=i(30751),O=i(42922),V=i(11066),U=i(68785),W=i(92660),K=i(42402);function z(e){window.__c={n:"LimitReachedStage"};const{addOnFeature:t,canPurchaseAddOn:i,isSubscribed:n}=e,s=ie(),l=(0,r.O7)();return i&&n?a()(G,{addOnFeature:t,canPurchaseAddOn:i}):o.createElement(o.Fragment,null,g.Z.info(s.icon),a()(q,{addOnFeature:t,canPurchaseAddOn:i}),a()(H,{addOnFeature:t,canPurchaseAddOn:i}),a()(O.Z,{isLarge:!0,style:s.button,onClick:async()=>i?n?_.Cl(void 0):async function(e,t){await T.y(e,{from:"plans_page",for:t,addOnFeature:"ai"}),_.v5()}(l,"free"):_.v5()},void 0,a()(h.FormattedMessage,i?{id:"addOnUpgradeModal.purchase.button.label",defaultMessage:"Purchase"}:{id:"addOnUpgradeModal.gotIt.button.label",defaultMessage:"Got it"})))}function G(e){var t,i;window.__c={n:"ConfirmPurchase"};const{addOnFeature:n,canPurchaseAddOn:s}=e,d=(0,r.O7)(),u=ie(),m=(0,l.VK)((()=>(0,B.zt)()),[]),p=(0,l.VK)((()=>R.default.state.data),[]),g=(0,l.VK)((()=>L.Z.state.open?L.Z.state.coupon:null),[]),f=(0,l.VK)((()=>D.default.state.currentSpaceStore),[]);if(!f)return null;const v=(0,I.S$)({environment:d})&&(0,y.QR)(m);if(d.device.isMobileNative&&!v)return null;let b;if(!p||"unsubscribed_admin"!==p.type&&"subscribed_admin"!==p.type||(b=p),b&&"revenueCat"===(null===(t=b.customerData)||void 0===t?void 0:t.activeSubscriptionPlatform)){const e=a()(h.FormattedMessage,{id:"addOnUpgradeModal.errorMessage.switchPlanFromInAppPurchase",defaultMessage:"You're currently subscribed through an in-app purchase with Apple. To switch plans, cancel your subscription with Apple first."});return M.showErrorMessage(e),null}const w=a()(h.FormattedMessage,{id:"addOnUpgradeModal.errorMessage.notAdmin",defaultMessage:"You don't have permissions to upgrade this workspace to an add-on. If you think this is a mistake please contact your administrator."});if(!(0,E.GJ)(p))return M.showErrorMessage(w),null;const C=null===(i=b)||void 0===i||null===(i=i.customerData)||void 0===i?void 0:i.stripe;if(!C)return null;const _=C.isSubscribed?C.interval:"month",k=g?function(e){switch(e){case"ai_fifty_percent":return a()(h.FormattedMessage,{id:"addOnUpgradeModal.coupon.fiftyPercent.label",defaultMessage:"50% off discount"});default:(0,S.t1)(e)}}(g):"year"===_?a()(h.FormattedMessage,{id:"addOnUpgradeModal.coupon.twentyPercent.label",defaultMessage:"20% off discount"}):null;return o.createElement(o.Fragment,null,a()("img",{src:c.Z.images.pricing.aiLogoPng,style:u.aiLogo}),a()(q,{addOnFeature:n,canPurchaseAddOn:s}),a()(j,{addOnFeature:n}),k?function(e){window.__c={n:"DiscountBadge"};const t=ie();return a()(V.Z,{style:{...t.sharedStyleForDiscountBadge},disabled:!0},void 0,a()("div",{style:{...t.innerStyleForDiscountBadge}},void 0,e))}(k):null,a()(Q,{addOnFeature:n,interval:_,stripeData:C,spaceStore:f}))}function q(e){window.__c={n:"Title"};const{addOnFeature:t,canPurchaseAddOn:i}=e,n=ie();let o;switch(t){case"ai":o=a()(h.FormattedMessage,i?{id:"addOnUpgrade.title.admin",defaultMessage:"Get more Notion AI"}:{id:"addOnUpgrade.title.nonAdmin",defaultMessage:"Your workspace has run out of its Notion AI promotion"});break;default:(0,S.t1)(t)}return a()("h3",{style:n.title},void 0,o)}function H(e){window.__c={n:"Description"};const{addOnFeature:t,canPurchaseAddOn:i}=e;let n;const o=ie();switch(t){case"ai":n=a()(h.FormattedMessage,i?{id:"addOnUpgrade.description.admins",defaultMessage:"Your one-time promotion has ran out. To continue using AI features, purchase more AI uses for your workspace"}:{id:"addOnUpgrade.description.nonAdmins",defaultMessage:"Your workspace’s one-time Notion AI promotion is over. Contact a workspace admin to purchase unlimited AI for your team to use."});break;default:(0,S.t1)(t)}return a()("p",{style:o.paragraph},void 0,a()("div",{style:o.text},void 0,n))}function j(e){window.__c={n:"ConfirmationDescription"};const{addOnFeature:t}=e;let i;const n=(0,r.O7)(),o=ie(),s=(0,l.VK)((()=>D.default.state.currentSpaceStore),[]);if(!s)return null;const d=(0,l.VK)((()=>(0,Z.rn)(n,s)),[n,s]);switch(t){case"ai":i=a()(h.FormattedMessage,{id:"addOnUpgrade.confirmation.description.admins",defaultMessage:"Go unlimited with Notion AI for all members in {spaceName}.",values:{spaceName:d}});break;default:(0,S.t1)(t)}return a()("p",{style:o.paragraph},void 0,a()("div",{style:o.text},void 0,i))}function Q(e){window.__c={n:"ConfirmationBillingSummary"};const{addOnFeature:t,interval:i,stripeData:n,spaceStore:s}=e,d=ie(),c=(0,r.O7)(),u=(0,l.VK)((()=>(0,E.qX)()),[]),p=n.currencyCode??"USD",{tax:g,coupon:v}=(0,l.VK)((()=>({tax:L.Z.state.open?L.Z.state.tax:0,coupon:L.Z.state.open?L.Z.state.coupon:void 0})),[]),y=(0,l.VK)((()=>N.Z.getPrice(c,(e=>e.product===t&&e.billingInterval===i&&e.currencyCode===p))),[t,c,i,p]),S=(0,l.VK)((()=>N.Z.getPrice(c,(e=>e.product===t&&"month"===e.billingInterval&&e.currencyCode===p))),[t,p,c]);if((0,o.useEffect)((()=>{!async function(){if(y.result&&n&&n.address){const e=y.result.getCostPerBillingInterval({quantity:u,coupon:v}).amount;await k.nf({environment:c,priceForTaxCalculation:e,address:n.address,customerId:n.customerId,vatId:n.vatId})}}()}),[c,n,y,u,v]),!y.isLoaded||!S.isLoaded)return a()(U.Z,{});if(!y.result||!S.result)return null;const b=y.result,M=b.getCostPerBillingInterval({quantity:u,coupon:v}).withAddedAmount(g),T=S.result,I=T.getMonthlyUnitCost();let Z=T.getMonthlyCost({quantity:u});"year"===i&&(Z=Z.withMultipliedAmount(12));const{addOnCostItem:A,addOnCostItemWithMembers:B}=(0,x.OL)(t,u,i,a()(m.W,{cost:I.toMoneyValue(),trailingZeroDisplay:"stripIfInteger"}));return o.createElement(o.Fragment,null,a()("p",{style:d.monthlyCostText},void 0,a()("h3",{style:d.title},void 0,a()(h.FormattedMessage,{id:"addOnUpgrade.confirmation.monthlyCost.title",defaultMessage:"Add on"})),a()("div",{style:d.costSectionTitle},void 0,a()("div",{},void 0,A),a()("div",{style:d.rightAlign},void 0,a()(m.W,{cost:Z.toMoneyValue(),trailingZeroDisplay:"auto"}))),a()("div",{style:d.costSection},void 0,B),a()(Y,{cost:b.getCostPerBillingInterval({quantity:u}),fullCost:Z}),a()($,{price:b,coupon:v,quantity:u}),a()("div",{style:d.costSection},void 0,a()(h.FormattedMessage,{id:"addOnUpgrade.confirmation.costSection.taxes",defaultMessage:"Taxes:"}),a()("div",{style:d.rightAlign},void 0,a()(m.W,{cost:{amount:g,currencyCode:p},trailingZeroDisplay:"auto"}))),a()("div",{style:d.totalCostSection},void 0,a()("h3",{style:d.title},void 0,a()(h.FormattedMessage,{id:"addOnUpgrade.confirmation.costSection.total",defaultMessage:"Total"})),a()("div",{style:d.rightAlign},void 0,a()("h3",{style:d.title},void 0,a()(m.W,{cost:M.toMoneyValue(),trailingZeroDisplay:"auto"})))),a()("div",{style:d.perMonth},void 0,a()(h.FormattedMessage,{id:"addOnUpgrade.confirmation.costSection.interval.label",defaultMessage:"{interval, select, month {per month} other {per year}}",values:{interval:i}}))),a()(O.Z,{isLarge:!0,style:d.button,onClick:async()=>{const e=(0,f.aG)({addOnFeature:t,addOnTier:"base",addOnBillingInterval:i,addOnPricingModel:"standard",addOnPricingVariant:"retail",currencyCode:b.currencyCode,isCancellation:!1});await C.Mg({environment:c,spaceStore:s,from:"add_on_upgrade_modal",addOns:e,inAppOffer:v}),_.v5();const n=F.mV({type:"purchaseAddOn",addOnFeature:t});n&&w.oV(n)}},void 0,a()(h.FormattedMessage,{id:"addOnUpgradeModal.confirmPurchase.button.label",defaultMessage:"Confirm purchase"})),a()("p",{style:d.termsOfService},void 0,a()("div",{style:d.text},void 0,a()(h.FormattedMessage,{id:"addOnUpgrade.confirmation.prorated.description",defaultMessage:"Performance subject to <fairUsePolicies>fair use policies</fairUsePolicies>.{br}By clicking Confirm Purchase you agree to the <terms>Notion AI Supplementary Terms</terms>.",values:{br:a()("br",{}),fairUsePolicies:e=>a()(K.Z,{href:(0,P.UY)("ai.fairUsePolicies")},void 0,e),terms:e=>a()(K.Z,{href:(0,P.UY)("ai.terms")},void 0,e)}}))))}function Y(e){window.__c={n:"AnnualDiscount"};const t=ie(),{cost:i,fullCost:n}=e;if(i.amount===n.amount)return null;const s=n.minus(i),r=Math.floor(s.amount/n.amount*100);return o.createElement(o.Fragment,null,a()("div",{style:t.costSectionTitle},void 0,a()("div",{},void 0,a()(h.FormattedMessage,{id:"addOnUpgrade.confirmation.costSection.annual.dynamicDiscountMessage",defaultMessage:"<bold>Annual discount ({discountPercent}%)</bold>",values:{bold:e=>a()("b",{},void 0,e),discountPercent:r}})),a()("div",{style:t.greenRightAlign},void 0,a()(m.W,{cost:s.withMultipliedAmount(-1).toMoneyValue(),trailingZeroDisplay:"auto",currencySign:"standard"}))),a()("div",{style:t.costSection},void 0,a()(h.FormattedMessage,{id:"addOnUpgrade.confirmation.costSection.specialDiscount.annualPlanMessage",defaultMessage:"for being on the annual plan"})))}function $(e){window.__c={n:"CouponDiscount"};const t=ie(),{price:i,coupon:n,quantity:s}=e;if(!(0,v.pp)(n))return null;const r=i.getDiscountPerBillingInterval({quantity:s,coupon:n}).withMultipliedAmount(-1);return o.createElement(o.Fragment,null,a()("div",{style:t.costSectionTitle},void 0,a()("div",{},void 0,a()(h.FormattedMessage,{id:"addOnUpgrade.confirmation.costSection.specialDiscount",defaultMessage:"<bold>Special discount ({percentage})</bold>",values:{bold:e=>a()("b",{},void 0,e),percentage:(0,A.ov)(n)}})),a()("div",{style:t.greenRightAlign},void 0,a()(m.W,{cost:r,trailingZeroDisplay:"auto",currencySign:"standard"}))),a()("div",{style:t.costSection},void 0,a()(h.FormattedMessage,{id:"addOnUpgrade.confirmation.costSection.specialDiscount.threeMonthsMessage",defaultMessage:"for the next 3 months"})))}function X(e){window.__c={n:"CancellationStageCTA"};const{data:t,addOnFeature:i}=e,n=ie(),s=(0,r.O7)(),l=function(e,t){var i;return null===(i=e.addOns.find((e=>e.feature===t)))||void 0===i?void 0:i.billingInterval}(t,i);return l?o.createElement(o.Fragment,null,a()("div",{style:n.buttonWithTopPadding},void 0,a()(V.Z,{style:n.redButton,hoveredStyle:{background:u.ZP.redWithAlpha(.8)},onClick:async()=>{const e=D.default.state.currentSpaceStore,{data:t}=R.default.state;let n;var o;"unsubscribed_admin"!==(null==t?void 0:t.type)&&"subscribed_admin"!==(null==t?void 0:t.type)||(n=null===(o=t.customerData)||void 0===o?void 0:o.stripe.currencyCode);if(!e||!n)return M.showErrorMessage(a()(h.FormattedMessage,{id:"addOnUpgradeModal.cancellationStage.errorMessage",defaultMessage:"Unable to cancel add-on subscription. Please try again later."}));const r=(0,f.aG)({addOnFeature:i,addOnTier:"base",addOnBillingInterval:l,addOnPricingModel:"standard",addOnPricingVariant:"retail",currencyCode:n,isCancellation:!0});await C.Mg({environment:s,spaceStore:e,from:"add_on_upgrade_modal",addOns:r}),_.v5()}},void 0,a()(h.FormattedMessage,{id:"addOnUpgradeModal.midterm.yesButton.label",defaultMessage:"Schedule removal"}))),a()("div",{style:n.buttonWithTopPadding},void 0,a()(V.Z,{style:n.noButton,onClick:()=>_.v5()},void 0,a()(h.FormattedMessage,{id:"addOnUpgradeModal.noButton.label",defaultMessage:"Cancel"})))):null}function J(e){window.__c={n:"CancellationStageDescription"};const{data:t}=e,i=ie();let n,o=!1;if("subscribed_admin"===t.type||"unsubscribed_admin"===t.type){var r;const e=null===(r=t.customerData)||void 0===r?void 0:r.stripe;n=null==e?void 0:e.periodEnd,o=Boolean((null==e?void 0:e.schedule)||(null==e?void 0:e.willCancelAt))}return n?a()("p",{style:i.paragraph},void 0,a()("div",{style:i.text},void 0,a()(h.FormattedMessage,o?{id:"addOnUpgradeModal.midterm.cancellationWithPendingChanges.description",defaultMessage:"You can continue to enjoy Notion AI until the end of your billing period on <bold>{periodEnd}</bold>. This change will cancel your previous pending changes. You can resubscribe anytime.",values:{periodEnd:(0,p.Yx)(n,"long",s.SP),bold:e=>a()("b",{},void 0,e)}}:{id:"addOnUpgradeModal.midterm.cancellation.description",defaultMessage:"Thank you for your input! You can continue to enjoy Notion AI until the end of your billing period on <bold>{periodEnd}</bold>. You can resubscribe anytime.",values:{periodEnd:(0,p.Yx)(n,"long",s.SP),bold:e=>a()("b",{},void 0,e)}}))):null}function ee(e){window.__c={n:"CancellationStage"};const{addOnFeature:t,canPurchaseAddOn:i,data:n}=e,s=ie();if(!i)return null;let r;switch(t){case"ai":r=a()(h.FormattedMessage,{id:"addOnUpgradeModal.midterm.cancellation.title",defaultMessage:"Remove AI at the end of your billing period?"});break;default:(0,S.t1)(t)}return o.createElement(o.Fragment,null,a()("h3",{style:s.cancellationTitle},void 0,r),a()(J,{data:n}),a()(X,{data:n,addOnFeature:t}))}function te(){window.__c={n:"MobileMessage"};const e=ie(),t=(0,r.O7)();let i=a()(h.FormattedMessage,{id:"addOnUpgradeModal.mobileMessage.button.label",defaultMessage:"Use the web or desktop app to add Notion AI to your plan and go unlimited."});return(t.device.isIOS||t.device.isIpad)&&(i=a()(h.FormattedMessage,{id:"addOnUpgradeModal.mobileMessage.ios.button.label",defaultMessage:"You are out of free AI."})),o.createElement(o.Fragment,null,g.Z.info(e.icon),a()("h3",{style:e.title},void 0,a()(h.FormattedMessage,{id:"addOnUpgrade.title.nonAdmin",defaultMessage:"Your workspace has run out of its Notion AI promotion"})),a()("p",{style:e.paragraph},void 0,a()("div",{style:e.text},void 0,i)),a()(O.Z,{isLarge:!0,style:e.button,onClick:()=>_.v5()},void 0,a()(h.FormattedMessage,{id:"addOnUpgradeModal.gotIt.button.label",defaultMessage:"Got it"})))}function ie(){return(0,d.yK)((e=>({modal:{maxWidth:350,padding:24,fontSize:14,textAlign:"center"},largeModal:{maxWidth:420,padding:24,fontSize:14,textAlign:"center"},mobileModal:{padding:24,fontSize:14,textAlign:"center"},cancellationModal:{maxWidth:350,padding:"24px 16px 12px",fontSize:14,textAlign:"center"},innerModalPadding:{padding:"0px 8px"},cancellationInnerModalPadding:{padding:0},innerStyle:{borderRadius:10},title:{margin:0,marginBottom:0},cancellationTitle:{margin:0,marginBottom:0,marginTop:14},monthlyCostText:{textAlign:"left",paddingBottom:16},costSection:{margin:0,marginBottom:8,display:"flex",color:e.mediumTextColor},costSectionTitle:{display:"flex",color:e.mediumTextColor},totalCostSection:{display:"flex"},paymentMethodSection:{marginBottom:8,marginTop:8,display:"flex"},rightAlign:{position:"absolute",right:24},greenRightAlign:{position:"absolute",right:24,color:e.invoiceGreen},paragraph:{lineHeight:1.4,marginTop:4,marginBottom:12},termsOfService:{fontSize:"small",marginTop:8},text:{margin:0,color:e.mediumTextColor,marginBottom:8},icon:{display:"inline",height:24,fill:e.lightIconColor,marginTop:8,marginBottom:8},aiLogo:{height:60},button:{width:"100%"},buttonWithTopPadding:{paddingTop:12},noButton:{width:"100%",height:24,display:"inline-flex",alignItems:"center",justifyContent:"center"},cancelButton:{position:"absolute",top:"10px",right:"10px",background:e.buttonHoveredBackground,borderRadius:"100%",width:20,height:20,display:"flex",alignItems:"center",justifyContent:"center",zIndex:10},redButton:{width:"100%",color:u.ZP.white,background:e.redBadgeBackground,display:"inline-flex",alignItems:"center",justifyContent:"center",height:32,borderRadius:3,lineHeight:1.2,paddingLeft:12,paddingRight:12,fontWeight:b.Z.fontWeight.medium},closeIcon:{width:14,fill:e.mediumTextColor},hovered:{background:e.buttonPressedBackground},perMonth:{position:"absolute",right:24,display:"flex",color:e.mediumTextColor,marginTop:-4},sharedStyleForDiscountBadge:{display:"inline-flex",alignItems:"center",borderRadius:3},innerStyleForDiscountBadge:{padding:"2px 6px",borderRadius:3,color:e.regularTextColor,background:e.accentColors.gray[50],fontWeight:400,fontSize:14,lineHeight:"16px",letterSpacing:"0.04em",whiteSpace:"nowrap"}})),[])}function ne(){return se("limit_reached")}function ae(){return se("confirm_purchase")}function oe(){return se("cancel_plan")}function se(e){const t=L.Z.state;if(t.open)return t.stage===e}const re=function(e){window.__c={n:"AddOnUpgradeModal"};const{data:t}=e,i="ai",n=(0,E.GJ)(t),o=ie(),s=E.YK(t),l=(0,r.O7)().device.isMobile;return a()(W.Z,l?{innerStyle:o.innerStyle,requireOnline:!0,modalStore:L.Z,onDismiss:()=>_.v5(),render:()=>a()("div",{style:o.mobileModal},void 0,a()("div",{style:o.innerModalPadding},void 0,a()(te,{})))}:{innerStyle:o.innerStyle,requireOnline:!0,modalStore:L.Z,onDismiss:()=>_.v5(),render:()=>a()("div",{style:ae()||ne()&&s&&n?o.largeModal:oe()?o.cancellationModal:o.modal},void 0,a()("div",{style:oe()?o.cancellationInnerModalPadding:o.innerModalPadding},void 0,a()(V.Z,{onClick:()=>{_.v5()},style:o.cancelButton,hoveredStyle:o.hovered},void 0,g.Z.closeSmall(o.closeIcon)),ne()&&a()(z,{addOnFeature:i,canPurchaseAddOn:n,isSubscribed:s}),ae()&&a()(G,{addOnFeature:i,canPurchaseAddOn:n}),oe()&&a()(ee,{addOnFeature:i,canPurchaseAddOn:n,data:t})))})}},62889:(e,t,i)=>{i.r(t),i.d(t,{CreateTeamFromPageConfirmModal:()=>v});var n=i(23174),a=i.n(n),o=(i(67294),i(480)),s=i(24405),r=i(53397),l=i(5366),d=i(82990),c=i(57688),u=i(72684),m=i(42922),p=i(63296),g=i(92660),h=i(29551),f=i(51923);function v(){window.__c={n:"CreateTeamFromPageConfirmModal"};const e=(0,o.O7)(),t=(0,l.useIntl)(),i=(0,s.yK)((e=>({modal:{maxWidth:350,padding:24},loopIcon:{height:28,width:28,fill:e.darkTextColor},infoIcon:{height:16,width:16,fill:e.lightIconColor,marginRight:4},title:{marginTop:16,marginBottom:12,color:e.regularTextColor,fontWeight:d.Z.fontWeight.semibold,fontSize:18},description:{color:e.darkTextColor,textAlign:"center",fontSize:14,marginBottom:18},confirmButton:{width:"100%",marginBottom:8},cancelButton:{width:"100%",display:"flex",alignItems:"center",justifyContent:"center",marginBottom:14}})),[]);return a()(g.Z,{onDismiss:()=>{u.Z.setState({open:!1})},render:()=>a()("div",{style:i.modal},void 0,a()(h.gq,{flexDirection:"column",justifyContent:"center",alignItems:"center"},void 0,r.Z.loop(i.loopIcon),a()("div",{style:i.title},void 0,a()(l.FormattedMessage,{id:"createTeamFromPage.confirmModal.title",defaultMessage:"Turn into teamspace?"})),a()("div",{style:i.description},void 0,a()(l.FormattedMessage,{id:"createTeamFromPage.confirmModal.description",defaultMessage:"This will move this page into a newly created teamspace along with people who already have access to this page."})),a()(m.Z,{isLarge:!0,style:i.confirmButton,onClick:()=>{if(u.Z.state.open){const{pageStore:i,flowId:n}=u.Z.state;c.Sq({environment:e,intl:t,page:i,flowId:n}),u.Z.setState({open:!1})}}},void 0,a()(l.FormattedMessage,{id:"createTeamFromPage.confirmModal.confirmButton",defaultMessage:"Create teamspace"})),a()(p.Z,{isLarge:!0,style:i.cancelButton,onClick:()=>u.Z.setState({open:!1})},void 0,a()(l.FormattedMessage,{id:"createTeamFromPage.confirmModal.cancelButton",defaultMessage:"Cancel"})),a()(f.Z,{message:a()(l.FormattedMessage,{id:"createTeamFromPage.confirmModal.learnMore",defaultMessage:"Learn more about teamspaces"}),analyticsFrom:"teams_learn_more_turn_page_into_team",helpCenterLocation:"bestPractices"}))),requireOnline:!0,modalStore:u.Z})}},89350:(e,t,i)=>{i.r(t),i.d(t,{SidebarCreateTeamModal:()=>ve});var n=i(23174),a=i.n(n),o=i(96486),s=i.n(o),r=i(67294),l=i(480),d=i(53150),c=i(81954),u=i(24405),m=i(41892),p=i(53397),g=i(97880),h=i(82990),f=i(5366),v=i(50906),y=i(57688),S=i(33929),b=i(38755),M=i(23537),w=i(79315),C=i(68216),_=i(19522),k=i(33052),T=i(64921),I=i(74194),P=i(3386),Z=i(68785),x=i(53953),F=i(58032),A=i(64369),E=i(45653),B=i(13490),D=i(8323),R=i(78122),L=i(42922),N=i(51923);function O(){window.__c={n:"SidebarCreateTeamModalFooter"};const e=(0,l.O7)(),{currentSpaceStore:t,spaceViewStore:i}=(0,c.VK)((()=>({currentSpaceStore:w.default.state.currentSpaceStore,spaceViewStore:w.default.state.currentSpaceViewStore})),[]),n=(0,c.VK)((()=>_.Z.state),[]),o=(0,M.OX)(),d=function(){const e=(0,c.VK)((()=>D.Mk()&&!_.Z.state.isDefault),[]),t=_.F.Team,i=_.F.Members;return e?[t,i]:[t]}(),{screen:m,pageNumber:p,teamId:h}=n,v=""===n.name,S=(0,u.yK)((e=>({box:{justifyContent:"space-between",alignItems:"center",display:"flex",width:"100%",paddingTop:22},button:{marginLeft:8},previous:{fontSize:14,color:e.mediumTextColor,cursor:"pointer"},learnMoreLink:{overflow:"hidden"}})),[]),b=(0,r.useCallback)(((i,n)=>{t&&function(e){let{pageOrder:t,pageNumber:i,teamId:n,currentSpaceStore:a,environment:o,from:s}=e;const r=i+1;if(r<=t.length)_.Z.update((e=>({...e,loading:!1,screen:t[r-1],pageNumber:r})));else if(n){const e=C.zX.createChildStore(a,{table:"team",id:n,spaceId:a.id});y.hI({environment:o,teamStore:e,shouldScroll:!0}),y.ED({environment:o,from:s,teamStore:e})}}({pageOrder:d,pageNumber:p,teamId:n||h,currentSpaceStore:t,environment:e,from:i})}),[t,e,p,d,h]),k=s().debounce((async()=>{if(!t||!i)return;let a=h;switch(m){case _.F.Team:a=await async function(e){var t;let{spaceStore:i,environment:n,shouldShowZeroTeamsExperience:a,sidebarCreateTeamModalStoreState:o}=e;const{name:s,description:r,icon:l,flowId:d,accessLevel:c,isDefault:u,persona:m}=o;if(!(await(0,R.Xg)({environment:n,spaceStore:i,teamName:s})))return;let p;_.Z.update((e=>({...e,loading:!0}))),p=a?await y.HD({environment:n,name:s,description:r,icon:l,flowId:d,trackCreateTeamComplete:!0,persona:m}):await y.Cm({environment:n,name:s,description:r,icon:l,accessLevel:c,isDefault:u,flowId:d,createTeamHome:!0,createTemplates:!0,persona:m});if(!p)return;const g=null===(t=p)||void 0===t?void 0:t.id;return _.Z.update((e=>({...e,teamId:g}))),g}({spaceStore:t,environment:e,shouldShowZeroTeamsExperience:o,sidebarCreateTeamModalStoreState:n});break;case _.F.Members:break;default:(0,g.t1)(m)}a?b("success",a):_.Z.update((e=>({...e,loading:!1})))}),1e3,{leading:!0,trailing:!1}),T=(0,r.useCallback)(k,[k]);return a()("div",{style:S.box},void 0,a()(N.Z,{containerStyle:S.learnMoreLink,helpCenterLocation:"bestPractices",analyticsFrom:"teams_learn_more_sidebar_create_team_modal"}),a()("div",{style:{display:"inline-flex"}},void 0,a()(L.Z,{isLarge:!0,onClick:T,disabled:v,style:S.button},void 0,a()(f.FormattedMessage,{id:"sidebarCreateTeamModal.footer.createTeam",defaultMessage:"Create teamspace"}))))}var V=i(10434),U=i.n(V),W=i(87279),K=i(17311),z=i(31194),G=i(52275),q=i(31945),H=i(61519),j=i(78140),Q=i(32163),Y=i(72495),$=i(38294);const X={marketing:{title:$.J.marketing,icon:p.Z.marketing},sales:{title:$.J.sales,icon:p.Z.sales},product:{title:$.J.product,icon:p.Z.product},eng:{title:$.J.eng,icon:p.Z.engineering},other:{title:a()(f.FormattedMessage,{id:"sidebarCreateTeamModal.functions.generalTitle",defaultMessage:"General"}),icon:p.Z.settingsMembers},no_template:{title:a()(f.FormattedMessage,{id:"sidebarCreateTeamModal.functions.noneTitle",defaultMessage:"Blank"}),icon:p.Z.noTemplate}};const J=function(){window.__c={n:"SidebarCreateTeamModalPersonaSelection"};const e=(0,l.O7)(),t=(0,c.VK)((()=>_.Z.state.persona),[]),{teamId:i,flowId:n}=(0,c.VK)((()=>_.Z.state),[]),o=(0,u.yK)((e=>({chevron:{width:12,marginLeft:3,marginRight:3,fill:e.lightIconColor},button:{border:`1px solid ${e.regularDividerColor}`,borderRadius:K.Z.borderRadius,margin:0,width:"100%"},icon:{width:16,height:16}})),[]);return a()(q.ZP,{popupType:q.Z4.Popup,renderOrigin:e=>{const i=X[t];return i?r.createElement(G.Z,U()({},e,{buttonStyle:o.button,title:i.title,icon:i.icon?i.icon(o.icon):void 0,right:p.Z.chevronDown(o.chevron),focused:!1})):null},placementToOrigin:z.Iw.Bottom,alignmentToOrigin:z.lU.Start,sameWidthAsOrigin:!0,render:t=>a()(j.Z,{menuType:W.og.Popup},void 0,a()(Q.Z,{type:Q.i.Vertical,initialFocus:void 0,sections:[{key:"functions",render:e=>r.createElement(Y.Z,e),items:Object.entries(X).map((s=>{let[l,d]=s;const c=l,u=d.icon?d.icon(o.icon):void 0;return{key:c,render:e=>r.createElement(r.Fragment,null,"no_template"===c?r.createElement(r.Fragment,null,a()(H.Z,{size:12}),r.createElement(G.Z,U()({title:d.title,icon:u},e))):r.createElement(G.Z,U()({title:d.title,icon:u},e))),action:()=>{_.Z.update((e=>({...e,persona:c}))),i&&v.YYV(e,{teamId:i,flowId:n,persona:c}),t.close()}}})).filter(g.$K)}]}))})};var ee=i(65426),te=i(30688),ie=i(93686);const ne={userSelect:"none",WebkitUserSelect:"none",position:"relative",padding:"22px 26px"},ae={createTeamContainer:{...ne,width:480},addMembersContainer:{...ne,width:500},full:{width:"100%"}},oe=(0,f.defineMessages)({teamNamePlaceholder:{id:"sidebarCreateTeamModal.teamScreen.namePlaceholder",defaultMessage:"Acme Labs"},teamDescriptionPlaceholder:{id:"sidebarCreateTeamModal.teamScreen.descriptionPlaceholder",defaultMessage:"Details about your teamspace"}});function se(){window.__c={n:"TeamDescriptionRow"};const[e,t]=(0,c.AF)(_.Z);return r.createElement(r.Fragment,null,a()(B.Z,{hasMarginTop:!0},void 0,a()(f.FormattedMessage,{id:"sidebarCreateTeamModal.teamScreen.teamDescriptionLabel",defaultMessage:"Description"})),a()(I.Z,{value:e.description,placeholder:S.default.formatMessage(oe.teamDescriptionPlaceholder),textarea:!0,onChange:i=>{t({...e,description:i.target.value})}}))}function re(e){return a()("div",{id:e.titleAriaId,style:{fontSize:18,fontWeight:h.Z.fontWeight.semibold}},void 0,(()=>{switch(e.screen){case _.F.Team:return a()(f.FormattedMessage,{id:"sidebarCreateTeamModal.teamTitle.label",defaultMessage:"Create a new teamspace"});case _.F.Members:return a()(f.FormattedMessage,{id:"sidebarCreateTeamModal.membersTitle.label",defaultMessage:"Add people"});default:(0,g.t1)(e.screen)}})())}function le(e){window.__c={n:"ModalContent"};const t=(0,l.O7)(),[i]=(0,c.AF)(_.Z),n=(0,r.useCallback)(((e,i)=>{y.ED({environment:t,from:i,teamStore:e})}),[t]),{screen:o}=i;switch(o){case _.F.Team:return a()(ue,{titleAriaId:e.titleAriaId,descriptionAriaId:e.descriptionAriaId});case _.F.Members:const t=i.teamId;return t?a()(ge,{teamId:t,onCompleted:e=>{n(e,"success")},onCanceled:e=>{n(e,"dismiss_button")}}):null;default:(0,g.t1)(o)}}function de(){window.__c={n:"TeamIconAndNameRow"};const[e,t]=(0,c.AF)(_.Z),i=(0,c.VK)((()=>w.default.state.currentSpaceStore),[]),n=(0,u.yK)((e=>({container:{display:"inline-flex",width:"100%",verticalAlign:"middle"},icon:{marginRight:8,marginTop:1}})),[]);if(!i)return null;const o=e.icon?{icon:e.icon,pointer:{table:"space",id:i.id}}:void 0;return r.createElement(r.Fragment,null,a()(B.Z,{hasMarginTop:!0},void 0,a()(f.FormattedMessage,{id:"sidebarCreateTeamModal.teamScreen.teamNameLabel",defaultMessage:"Icon & name"})),a()("div",{style:n.container},void 0,a()(ie.p,{icon:o,size:26,style:n.icon,onChange:i=>{t({...e,icon:i})},iconLoggingData:{recordTable:"team",source:"team_creation"}}),a()(I.Z,{value:e.name,placeholder:S.default.formatMessage(oe.teamNamePlaceholder),onChange:i=>{t({...e,name:i.target.value})},preventSafariAutofill:!0})))}function ce(e){window.__c={n:"Description"};const t=(0,u.yK)((()=>({})),[]);return a()(A.Z,{id:e.descriptionAriaId,isMultiline:!0,isSmall:!0,isSecondaryColor:!0,style:t.description},void 0,(()=>{switch(e.screen){case _.F.Team:return a()(f.FormattedMessage,{id:"sidebarCreateTeamModal.teamDescription.label",defaultMessage:"Teamspaces are where your team organizes pages, permissions, and members"});case _.F.Members:return null;default:(0,g.t1)(e.screen)}})())}function ue(e){window.__c={n:"TeamScreen"};const[t]=(0,c.AF)(_.Z),i=(0,l.O7)();(0,r.useEffect)((()=>{if(t.open){const{from:e,flowId:n}=t;v.krX(i,{from:e,flowId:n})}}),[]);const n=(0,u.yK)((()=>({personaPickerDescription:{marginTop:3},tooltip:{maxWidth:300,whiteSpace:"pre-wrap"}})),[]);return a()("div",{style:ae.createTeamContainer},void 0,a()(re,{titleAriaId:e.titleAriaId,screen:_.F.Team}),a()(ce,{descriptionAriaId:e.descriptionAriaId,screen:_.F.Team}),a()("div",{style:ae.full},void 0,a()(de,{}),a()(se,{}),a()(F.Z,{render:e=>r.createElement("div",e,a()(B.Z,{hasMarginTop:!0},void 0,a()(f.FormattedMessage,{id:"sidebarCreateTeamModal.optionalTemplateSelection.label",defaultMessage:"Templates"})),a()(J,{})),renderTooltip:()=>a()("div",{style:n.tooltip},void 0,a()(f.FormattedMessage,{id:"sidebarCreateTeamModal.optionalFunctionSelectionDescription.label",defaultMessage:"This will determine the default templates in your teamspace. You can always change them later."})),placement:F.Z.Placement.Left}),a()(pe,{})),a()(O,{}))}function me(){window.__c={n:"ScreenLoadingSpinner"};const e=(0,c.VK)((()=>_.Z.state.loading),[]),t=(0,u.yK)((e=>({spinner:{width:"100%",height:"100%",backgroundColor:e.modalUnderlayBackground,position:"absolute",top:0,left:0}})),[]);return r.createElement(r.Fragment,null,e&&a()("div",{style:t.spinner},void 0,a()(Z.Z,{style:{position:"absolute",top:"50%",left:"50%"}})))}function pe(){window.__c={n:"AccessLevelSection"};const e=(0,u.yK)((e=>({openAccessMessage:{fontSize:13,color:e.mediumTextColor,marginTop:20,lineHeight:1.4,display:"flex"},iconContainer:{marginRight:8},openTeamIcon:{width:24,fill:e.mediumIconColor},teamAccessPopupContainer:{marginTop:20}})),[]),[t,i]=(0,c.AF)(_.Z),n=(0,M.OX)(),o=(0,l.O7)(),s=(0,c.VK)((()=>{const e=w.default.state.currentSpaceStore;return e?(0,b.rn)(o,e):"this workspace"}),[o]);return n?a()("div",{style:e.openAccessMessage},void 0,a()("div",{style:e.iconContainer},void 0,p.Z.openTeam(e.openTeamIcon)),a()(f.FormattedMessage,{id:"sidebarCreateTeamModal.teamScreen.openAccessLabel",defaultMessage:"Everyone at {spaceName} and new members will have access to this teamspace",values:{spaceName:s}})):r.createElement(r.Fragment,null,a()(B.Z,{hasMarginTop:!0},void 0,a()(f.FormattedMessage,{id:"sidebarCreateTeamModal.teamScreen.permissionsLabel",defaultMessage:"Permissions"})),a()(ee._,{currentAccessLevel:t.accessLevel,currentIsDefault:t.isDefault,onChange:(e,n)=>{i(n?{...t,accessLevel:"open",isDefault:n}:{...t,accessLevel:e,isDefault:n})}}))}function ge(e){window.__c={n:"MemberScreen"};const t=(0,l.O7)(),[,,i]=(0,c.AF)(_.Z),[,,n]=(0,c.AF)(void 0,k.Z);(0,c.VK)((()=>{const{defaultInviteTargets:e,flowId:t}=i.state;n.setState({...n.state,flowId:t}),e&&n.setState({...n.state,isInviteTargetsEmpty:!1,inviteTargets:e})}),[i,n]);const o=(0,c.VK)((()=>w.default.state.currentSpaceStore),[]);if(!o)return null;const s=C.zX.createChildStore(o,{table:"team",id:e.teamId,spaceId:o.id});return a()("div",{style:ae.full},void 0,a()("div",{style:ae.addMembersContainer},void 0,a()(te.Z,{store:s,permissionsInviteStore:n,isNewlyCreatedTeam:!0,onSubmitSuccessful:()=>{e.onCompleted(s),y.hI({environment:t,teamStore:s,shouldScroll:!0})},onDismiss:()=>{e.onCanceled(s)}})))}const he=[m.Z.images.avatars.avatar1Png,m.Z.images.avatars.avatar2Png,m.Z.images.avatars.avatar3Png];function fe(e){let{handleModalClose:t}=e;window.__c={n:"FirstTeamHeader"};const i=(0,u.yK)((e=>({container:{borderTopLeftRadius:5,borderTopRightRadius:5,background:e.inputBackground,boxShadow:e.inputBoxShadow},header:{display:"flex",padding:14,fontWeight:h.Z.fontWeight.medium},avatarGroup:{display:"flex",width:"100",marginLeft:4,alignSelf:"center"},avatar:{marginLeft:-4},message:{paddingLeft:14,paddingRight:14},closeButton:{zIndex:10,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"100%",background:e.buttonHoveredBackground,width:20,height:20,padding:4},closeButtonHover:{background:e.buttonPressedBackground},closeButtonIcon:{width:16,fill:e.mediumTextColor}})),[]);return a()("div",{style:i.container},void 0,a()("div",{style:i.header},void 0,a()("div",{style:i.avatarGroup},void 0,he.map(((e,t)=>a()(E.Z,{avatarShouldShowShadow:!0,style:i.avatar,size:28,avatar:{avatarUrl:e}},t)))),a()(A.Z,{style:i.message,isMultiline:!0,isSmall:!0},void 0,a()(f.FormattedMessage,{id:"sidebarCreateTeamModal.teamScreen.firstTeamHeader",defaultMessage:"Create your first teamspace to start using Notion with your teammates"})),a()(T.Z,{onClick:t,style:i.closeButton,hoveredStyle:i.closeButtonHover},void 0,p.Z.closeSmall(i.closeButtonIcon))))}function ve(){window.__c={n:"SidebarCreateTeamModal"};const e=(0,l.O7)(),[t,,]=(0,c.AF)(_.Z),i=(0,d.C)(),n=(0,d.C)(),o=(0,u.yK)((e=>({modal:{maxWidth:500,borderRadius:5},closeButton:{position:"absolute",top:14,right:14,zIndex:10,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"100%",background:e.buttonHoveredBackground,width:20,height:20},closeButtonHover:{background:e.buttonPressedBackground},closeButtonIcon:{width:14,fill:e.mediumTextColor},wrapper:{display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",userSelect:"none",WebkitUserSelect:"none"},container:{display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",userSelect:"none",WebkitUserSelect:"none"}})),[]),m=(0,r.useCallback)((t=>{y.ED({environment:e,from:t})}),[e]),{open:g,loading:h,screen:f}=t,v=(0,M.OX)(),S=(0,r.useRef)(v);return(0,r.useEffect)((()=>{h||(S.current=v&&f===_.F.Team)}),[h,f,v]),g?a()(x.Z,{ariaLabelledBy:i,ariaDescribedBy:n,open:g,innerStyle:o.modal,onDismiss:()=>{m("modal")},render:()=>{const{device:t}=e;return a()("div",{style:{height:"100%"}},void 0,!t.isMobile&&(S.current?a()(fe,{handleModalClose:()=>{m("close_button")}}):a()(T.Z,{onClick:()=>{m("close_button")},style:o.closeButton,hoveredStyle:o.closeButtonHover},void 0,p.Z.closeSmall(o.closeButtonIcon))),a()("div",{style:o.wrapper},void 0,a()(P.Z,{capture:!0,onBackspace:s().identity,onLeft:s().identity,onRight:s().identity,onSelectAll:s().identity,onRedo:s().identity,onUndo:s().identity,onCut:s().identity,onCopy:s().identity,onPaste:s().identity,onKeypress:s().identity,onDelete:s().identity,onTab:s().identity},void 0,a()(le,{titleAriaId:i,descriptionAriaId:n}))),a()(me,{}))}}):null}},65426:(e,t,i)=>{i.d(t,{_:()=>_});var n=i(23174),a=i.n(n),o=i(10434),s=i.n(o),r=i(67294),l=i(480),d=i(81954),c=i(24405),u=i(53397),m=i(87279),p=i(98742),g=i(92350),h=i(4657),f=i(25464),v=i(31194),y=i(52275),S=i(31945),b=i(78140),M=i(32163),w=i(72495),C=i(58032);function _(e){let{currentAccessLevel:t,currentIsDefault:i=!1,onChange:n,teamStore:o,disabledWithRightChevron:_=!1,style:k}=e;window.__c={n:"TeamAccessLevelButtonPopup"};const{device:T}=(0,l.O7)(),I=(0,g.ql)(o),P=(0,c.yK)((e=>({chevron:{width:12,marginLeft:3,marginRight:3,fill:e.lightIconColor},selectedButton:{width:"100%",margin:0,paddingTop:4,paddingBottom:4,border:`1px solid ${e.outlineButtonBorder}`,...k},selectedCheckmark:{width:T.isMobile?16:14},icon:{alignSelf:"center",marginTop:0}})),[T.isMobile,k]),Z=(0,d.VK)((()=>(null==o?void 0:o.isDefault())??i),[o,i]),x=Z?"default":t,F=(0,h.U)({teamStore:o,onChange:n,isDefault:Z});return a()(S.ZP,{popupType:T.isMobile?S.Z4.SlideUp:S.Z4.Popup,renderOrigin:e=>{const t=F.find((e=>e.key===x));if(!t)return null;const i=t.disableAllOptionsTooltip,n=_||Boolean(i)||Boolean(o)&&!I;return a()(C.Z,{placement:f.u.Bottom,alignment:f.v.Start,disableTooltip:!i||!I,renderTooltip:()=>i,style:{width:350},textWrap:!0,render:i=>r.createElement(y.Z,s()({},(0,p.Z)(e,i),{title:t.title,caption:t.caption,icon:t.icon({fill:t.iconColor}),desktopIconStyle:P.icon,disabled:n,right:_?u.Z.chevronRight(P.chevron):n?void 0:u.Z.chevronDown(P.chevron),focused:!1,shouldWrapCaption:!0,buttonStyle:P.selectedButton}))})},placementToOrigin:v.Iw.Bottom,alignmentToOrigin:v.lU.Start,sameWidthAsOrigin:!0,render:e=>{const t=[{key:"access levels",render:e=>r.createElement(w.Z,s()({},e,{topBorder:0!==e.index})),items:F.map((t=>{const i=t.key===x;return{key:t.key,render:e=>a()(C.Z,{placement:f.u.Top,disableTooltip:!t.tooltip,renderTooltip:()=>t.tooltip,render:n=>r.createElement(y.Z,s()({},(0,p.Z)(e,n),{title:t.title,caption:t.caption,icon:t.icon({fill:t.iconColor}),desktopIconStyle:P.icon,right:i?a()("div",{style:P.selectedCheckmark},void 0,u.Z.check()):void 0,disabled:t.disabled,shouldWrapCaption:!0}))}),action:()=>{t.onSelect(),e.close()}}}))}];return a()(b.Z,{menuType:m.og.Popup},void 0,a()(M.Z,{type:M.i.Vertical,initialFocus:void 0,sections:t}))}})}},67110:(e,t,i)=>{i.r(t),i.d(t,{default:()=>V});var n=i(23174),a=i.n(n),o=i(67294),s=i(480),r=i(81954),l=i(24405),d=i(33728),c=i(59054),u=i(5366),m=i(21325),p=i(4708),g=i(87279),h=i(75472),f=i(23537),v=i(79315),y=i(33052),S=i(78140),b=i(43579),M=i(91487),w=i(47082),C=i(10434),_=i.n(C),k=i(96486),T=i.n(k),I=i(53397),P=i(92350),Z=i(31194),x=i(52275),F=i(31945),A=i(32163),E=i(89728),B=i(72495),D=i(58032);function R(e){window.__c={n:"TeamRoleSelect"};const{disabled:t,selectedRole:i,allRoles:n,onChange:d,store:c,labelStyle:m}=e,{device:p}=(0,s.O7)(),h=(0,l.Fg)(),y=(0,P.ql)(c),b=(0,r.VK)((()=>{const{currentSpaceStore:e}=v.default.state;return null==e?void 0:e.canEditMembership()}),[]),M=(0,r.VK)((()=>c.isDefault()),[c]);return a()(F.ZP,{popupType:p.isMobile?F.Z4.SlideUp:F.Z4.Popup,renderOrigin:e=>o.createElement(E.Z,_()({style:m,disabled:t,disabledFeedback:!0},e),o.createElement(u.FormattedMessage,f.q9[i].label),I.Z.chevronDown({width:10,marginLeft:4,fill:h.lightIconColor})),placementToOrigin:Z.Iw.Bottom,render:e=>{const t=[{key:"roles",render:e=>o.createElement(B.Z,_()({},e,{topBorder:0!==e.index})),items:n.map((t=>{const n=!y&&"owner"===t,s=M&&"team_level_guest"===t,r=!b&&"team_level_guest"===t,l=!y&&"team_level_guest"===t,c=n||s||r||l;return{key:t,render:e=>a()(D.Z,{disableTooltip:!c,placement:D.Z.Placement.Right,textWrap:!0,renderTooltip:()=>n?a()(u.FormattedMessage,{id:"TeamRoleSelect.memberType.disableAddingOwnerForMembers",defaultMessage:"Teamspace members can't add owners"}):s?a()(u.FormattedMessage,{id:"TeamRoleSelect.memberType.disableAddingGuestsInDefaultTeam",defaultMessage:"Default teams can't contain teamspace guests"}):r||l?a()(u.FormattedMessage,{id:"TeamRoleSelect.memberType.disableAddingGuestForNonSpaceAdminsOrNonTeamOwners",defaultMessage:"You must be a workspace owner and a teamspace owner to add teamspace guests"}):void 0,render:n=>o.createElement("span",n,o.createElement(x.Z,_()({},e,{focused:!1,checkState:T().isEqual(t,i),disabled:c,disabledFeedback:c,title:a()("div",{style:{display:"flex",alignItems:"center"}},void 0,o.createElement(u.FormattedMessage,f.q9[t].label)),caption:a()("span",{style:{color:h.mediumTextColor}},void 0,o.createElement(u.FormattedMessage,f.q9[t].caption)),shouldWrapCaption:!0})))}),action:()=>{d(t),e.close()}}}))}];let s;return s=p.isMobile?{menuType:g.og.Modal,title:a()(u.FormattedMessage,{id:"teamPermissionsMenu.mobile.title",defaultMessage:"Select teamspace role"}),right:a()(u.FormattedMessage,{id:"teamPermissionsMenu.mobile.doneButton.label",defaultMessage:"Done"}),onClickRight:e.close}:{menuType:g.og.Popup,width:264},o.createElement(S.Z,s,a()(A.Z,{type:A.i.Vertical,initialFocus:void 0,sections:t}))}})}const L="member";function N(e){window.__c={n:"TeamPermissionsInviteInput"};const{store:t,permissionsInviteStore:i,onEmptySubmit:n}=e,o=(0,u.useIntl)(),s=(0,r.VK)((()=>Boolean(i.state.isFocused)),[i]),c=(0,r.VK)((()=>i.state.tokenQuery),[i]),m=(0,r.VK)((()=>i.state.inviteRole),[i]),p=(0,r.VK)((()=>i.state.inviteTargets),[i]),g=(0,l.yK)((e=>({inputTokenVerticalMargin:{marginTop:3,marginBottom:3},tokenMenuItem:{alignItems:"unset",borderRadius:3,paddingTop:5,paddingBottom:5,paddingLeft:8,paddingRight:5,boxShadow:s?e.outlineBlueInputBoxShadow:e.inputBoxShadow,maxHeight:"40vh"},inputDiv:{marginBottom:0}})),[s]);function f(e){if(i.state.isInviteTargetsEmpty)return;const t=i.state.inviteTargets.filter((t=>t!==e));0===p.length?i.setState({...i.state,inviteTargets:[],inviteRole:L,isInviteTargetsEmpty:!0}):i.setState({...i.state,inviteTargets:t})}function v(e){i.setState({...i.state,isFocused:e})}const y=p.map((e=>{const t="newUser"===e.type?e.value.email:`${e.type}-${e.value.id}`;return a()(M.Z,{target:e,onClickRemove:f,role:m,shouldWrap:!0,style:g.inputTokenVerticalMargin,backgroundColor:(0,h.gQ)(e)},t)}));return a()(w.Z,{focus:s,onClick:()=>v(!0),format:w.Z.Format.Share,value:c,onChange:function(e){const t=e.target.value,{extractedEmails:n,newInputValue:a}=(0,d.zI)(t),o=n.map((e=>({type:"newUser",value:{email:e},source:"email"}))).filter((e=>!(0,h.Nd)({target:e,permissionsInviteStore:i}))),s=[...i.state.inviteTargets,...o];s.length>0?(i.setState({...i.state,inviteTargets:s,isInviteTargetsEmpty:!1,tokenQuery:a}),v(!(o.length>0))):i.setState({...i.state,inviteTargets:[],isInviteTargetsEmpty:!0,tokenQuery:a})},onEmptySubmit:n,type:"email",placeholder:o.formatMessage({id:"teamPermissionsInvite.searchInput.placeholder",defaultMessage:"Search people or groups"}),tokens:y,onRemoveLastToken:function(){const e={...i.state};e.inviteTargets=e.inviteTargets.slice(0,-1),0===e.inviteTargets.length&&(e.isInviteTargetsEmpty=!0,e.inviteRole=L),i.setState(e)},focusAfterAnimation:!0,right:a()(O,{store:t,permissionsInviteStore:i}),style:g.tokenMenuItem,inputStyle:g.inputTokenVerticalMargin,inputDivStyle:g.inputDiv})}function O(e){window.__c={n:"TeamPermissionsInviteRoleSelect"};const{store:t,permissionsInviteStore:i}=e,n=(0,r.VK)((()=>{const e=v.default.state.currentSpaceStore;return!(null!=e&&e.getDisableTeamGuests())&&(0,p.F$)()}),[]),o=(0,r.VK)((()=>i.state.inviteRole),[i]),s=(0,l.yK)((()=>({teamRoleLabel:{marginTop:3,marginBottom:3,marginLeft:5}})),[]);function d(e){i.setState({...i.state,inviteRole:e})}return a()(R,n?{store:t,selectedRole:o,allRoles:f.ZN,onChange:d,labelStyle:s.teamRoleLabel}:{store:t,selectedRole:o,allRoles:f.$r,onChange:d,labelStyle:s.teamRoleLabel})}const V=function(e){window.__c={n:"TeamPermissionsInvite"};const{store:t,onEmptySubmit:i}=e,n=(0,s.O7)();(0,c.r5)((async()=>{await m.bi(n)}),[]);const o=(0,r.qz)(e.permissionsInviteStore,y.Z),d=(0,r.VK)((()=>Boolean(o.state.isFocused)),[o]),u=(0,r.VK)((()=>o.state.tokenQuery),[o]),p=(0,r.VK)((()=>d&&u.length>0),[d,u]),h=(0,l.yK)((e=>({permissionsInviteSearchRequest:{position:"absolute",width:"100%",borderRadius:3,backgroundColor:e.contentBackground,boxShadow:e.largeBoxShadow,marginTop:4},scroller:{zIndex:1}})),[]);function f(e){o.setState({...o.state,isFocused:e})}return a()("div",{onFocus:()=>f(!0),onBlur:()=>f(!1)},void 0,a()(S.Z,{menuType:g.og.Popup,header:a()(N,{store:t,permissionsInviteStore:o,onEmptySubmit:i}),scrollerStyle:h.scroller,width:"100%",tokenInputHeader:!1,disableScroller:!0},void 0,p&&a()("div",{style:h.permissionsInviteSearchRequest},void 0,a()(b.Z,{permissionsInviteStore:o,store:t,defaultRoleForSpaceBot:"editor",shouldShowBots:!1,shouldShowGroups:!0,sectionRenderLimit:10,membersOnly:!1,hideUserTypeToken:!0,disableInvitedUsers:!0}))))}},30688:(e,t,i)=>{i.d(t,{u:()=>N,Z:()=>O});var n=i(10434),a=i.n(n),o=i(23174),s=i.n(o),r=i(67294),l=i(480),d=i(81954),c=i(24405),u=i(33728),m=i(53397),p=i(82990),g=i(5366),h=i(50906),f=i(43132),v=i(95209),y=i(64964),S=i(57688),b=i(43250),M=i(4708),w=i(75472),C=i(8323),_=i(23537),k=i(77907),T=i(79315),I=i(42922),P=i(68785),Z=i(63296),x=i(89728),F=i(58032),A=i(64369),E=i(93686),B=i(13380);const D={button:{height:32},buttonContainer:{width:"100%",paddingTop:22,display:"flex",justifyContent:"end"},multiButtonContainer:{width:"100%",paddingTop:12,display:"flex",justifyContent:"space-between"},singleButtonContainer:{width:"100%",paddingTop:12,display:"flex",justifyContent:"right"},container:{display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",userSelect:"none",WebkitUserSelect:"none",width:"100%"},containerLeftAligned:{display:"flex",alignItems:"left",justifyContent:"left",flexDirection:"column",userSelect:"none",WebkitUserSelect:"none",width:"100%"},titleAndIcon:{paddingBottom:18,alignItems:"center",display:"flex"},addMembersTo:{minWidth:"25%"},icon:{paddingRight:3,paddingLeft:3},teamName:{paddingRight:10,fontWeight:p.Z.fontWeight.medium,...p.Z.textOverflowStyle,maxWidth:250},full:{width:"100%"},submitTooltip:{minWidth:250},subtitle:{paddingTop:16}};function R(e){var t;let{isLoading:i,isNewlyCreatedTeam:n,onDismiss:o,onSubmit:l,inviteTargets:c,includesGroups:u,inviteRole:m,canEditSpaceMembership:p,membershipRequestsDisabled:h,spaceAllowedDomains:f,hasTeamGuestsMatchAllowedDomain:v}=e;window.__c={n:"InviteSubmitButton"};const y=c.length>0,S=u&&"owner"===m,b=c.filter((e=>(0,w.OA)(e))).length>0&&h&&!p,C=(0,d.VK)((()=>(0,M.F$)()&&"team_level_guest"===m&&c.some((e=>"group"===e.type||"existingUser"===e.type&&"none"!==e.spaceRole&&"not_in_space"!==e.spaceRole))),[m,c]),_=S||C||b||v;if(i)return s()(I.Z,{style:{...D.button,minWidth:80},disabled:!0},void 0,s()(P.Z,{isWhite:!0}));if(n&&!y)return s()(Z.Z,{style:D.button,onClick:o,disabled:i},void 0,s()(g.FormattedMessage,{id:"teamPermissionsInviteOverlay.inviteModal.skipForNow",defaultMessage:"Skip for now"}));const k=S?s()(g.FormattedMessage,{id:"teamPermissionsInviteOverlay.inviteModal.addNMembers.groupsAsOwnersTooltip",defaultMessage:"Cannot add groups as teamspace owners. Remove any groups to continue."}):C?s()(g.FormattedMessage,{id:"teamPermissionsInviteOverlay.inviteModal.addNMembers.memberOrGroupInvitedAsTeamGuestTooltip",defaultMessage:"Cannot add space members or groups as teamspace guests. Remove them to continue."}):v?s()(g.FormattedMessage,{id:"teamPermissionsInviteOverlay.inviteModal.addNMembers.hasTeamGuestsMatchAllowedDomain",defaultMessage:"Cannot add users with {emailDomains} as teamspace guests. Remove them to continue.",values:{emailDomains:null==f||null===(t=f.map((e=>`@${e}`)))||void 0===t?void 0:t.join(", ")}}):null;return s()(F.Z,{textWrap:!0,style:D.submitTooltip,disableTooltip:!k,renderTooltip:()=>k,render:e=>r.createElement(I.Z,a()({style:D.button,onClick:l,disabled:!y||i||_},e),s()(g.FormattedMessage,{id:"teamPermissionsInviteOverlayV2.inviteButton.label",defaultMessage:"Invite"}))})}function L(e){let{inviteTargets:t,workspaceName:i,canEditSpaceMembership:n,membershipRequestsDisabled:a,isFreeTier:o,inviteRole:r,hasTeamGuestsMatchAllowedDomain:l}=e;if(void 0===n)return null;if(!t||0===t.length)return null;const d=t.map((e=>{if("group"!==e.type&&(0,w.OA)(e))return e.value.email})).filter((e=>e));if(!d||0===d.length)return null;const c=e=>s()("b",{},void 0,e),u=i??"this workspace";return n?o?s()(A.Z,{isSecondaryColor:!0,isMultiline:!0,isSmall:!0},void 0,1===d.length?s()(g.FormattedMessage,{id:"TeamPermissionsInviteOverlayV2.addSpaceMembershipSingularOwner.subtitle",defaultMessage:"<b>{guestEmail}</b> will be added to {workspaceName} as a workspace owner.",values:{guestEmail:d[0],workspaceName:u,b:c}}):s()(g.FormattedMessage,{id:"TeamPermissionsInviteOverlayV2.addSpaceMembershipPluralOwners.subtitle",defaultMessage:"<b>{numberOfOtherEmails, plural, one {{firstGuest} and {secondGuest}} other {{firstGuest} and {numberOfOtherEmails} more}}</b> will be added to {workspaceName} as workspace owners.",values:{firstGuest:d[0],secondGuest:d[1],numberOfOtherEmails:d.length-1,workspaceName:u,b:c}})):"team_level_guest"===r?l?null:s()(A.Z,{isSecondaryColor:!0,isMultiline:!0,isSmall:!0},void 0,1===d.length?s()(g.FormattedMessage,{id:"TeamPermissionsInviteOverlayV2.addSpaceMembershipSingular.teamGuest.subtitle",defaultMessage:"<b>{guestEmail}</b> will be added to {workspaceName} as a billed teamspace guest.",values:{guestEmail:d[0],workspaceName:u,b:c}}):s()(g.FormattedMessage,{id:"TeamPermissionsInviteOverlayV2.addSpaceMembershipPlural.teamGuest.subtitle",defaultMessage:"<b>{numberOfOtherEmails, plural, one {{firstGuest} and {secondGuest}} other {{firstGuest} and {numberOfOtherEmails} more}}</b> will be added to {workspaceName} as billed teamspace guests.",values:{firstGuest:d[0],secondGuest:d[1],numberOfOtherEmails:d.length-1,workspaceName:u,b:c}})):s()(A.Z,{isSecondaryColor:!0,isMultiline:!0,isSmall:!0},void 0,1===d.length?s()(g.FormattedMessage,{id:"TeamPermissionsInviteOverlayV2.addSpaceMembershipSingular.subtitle",defaultMessage:"<b>{guestEmail}</b> will be added to {workspaceName} as a billed workspace member.",values:{guestEmail:d[0],workspaceName:u,b:c}}):s()(g.FormattedMessage,{id:"TeamPermissionsInviteOverlayV2.addSpaceMembershipPlural.subtitle",defaultMessage:"<b>{numberOfOtherEmails, plural, one {{firstGuest} and {secondGuest}} other {{firstGuest} and {numberOfOtherEmails} more}}</b> will be added to {workspaceName} as billed workspace members.",values:{firstGuest:d[0],secondGuest:d[1],numberOfOtherEmails:d.length-1,workspaceName:u,b:c}})):s()(A.Z,{isSecondaryColor:!0,isMultiline:!0,isSmall:!0},void 0,a?s()(g.FormattedMessage,{id:"TeamPermissionsInviteOverlayV2.requestSpaceMembershipDisabled.subtitle",defaultMessage:"You can't add workspace guests to a teamspace. Ask your admin to add them as workspace members first."}):1===d.length?s()(g.FormattedMessage,{id:"TeamPermissionsInviteOverlayV2.requestSpaceMembershipSingular.subtitle",defaultMessage:"Request will be sent to your admin to add <b>{guestEmail}</b> as a member to {workspaceName}.",values:{guestEmail:d[0],workspaceName:u,b:c}}):s()(g.FormattedMessage,{id:"TeamPermissionsInviteOverlayV2.requestSpaceMembershipPlural.subtitle",defaultMessage:"Request will be sent to your admin to add <b>{numberOfOtherEmails, plural, one {{firstGuest} and {secondGuest}} other {{firstGuest} and {numberOfOtherEmails} more}}</b> as members to {workspaceName}.",values:{firstGuest:d[0],secondGuest:d[1],numberOfOtherEmails:d.length-1,workspaceName:u,b:c}}))}function N(e){window.__c={n:"InviteLink"};const{store:t,isSmall:i}=e,n=(0,l.O7)(),a=(0,c.yK)((e=>({button:{marginRight:5,marginLeft:5,height:32,fontSize:i?12:14},icon:{width:i?12:14,height:i?12:14}})),[i]);return s()(x.Z,{onClick:()=>{f.RD({environment:n,stringValue:_.W8(t.id),copiedMessage:f.tq.copiedLinkToClipboard}),h.XTk(n,{store:t})},icon:m.Z.link,style:a.button,iconStyle:a.icon,isBlue:!0},void 0,s()(g.FormattedMessage,i?{id:"teamPermissionsInviteOverlay.copyLinkCondensedButton.label",defaultMessage:"Copy link"}:{id:"teamPermissionsInviteOverlay.copyLinkButton.label",defaultMessage:"Copy invite link"}))}const O=function(e){let{store:t,permissionsInviteStore:i,isNewlyCreatedTeam:n,onSubmitSuccessful:a,onDismiss:o}=e;window.__c={n:"TeamPermissionsInviteOverlay"};const c=(0,l.O7)(),{teamName:m,workspaceName:p,canEditSpaceMembership:h,membershipRequestsDisabled:f,teamAccessLevel:I,spaceAllowedDomains:P}=(0,d.VK)((()=>{const{currentSpaceStore:e}=T.default.state;return{teamName:t.getName(),workspaceName:null==e?void 0:e.getName(),canEditSpaceMembership:null==e?void 0:e.canEditMembership(),membershipRequestsDisabled:null==e?void 0:e.getDisableMembershipRequests(),teamAccessLevel:t.getTeamAccessLevel(),spaceAllowedDomains:null==e?void 0:e.getEmailDomains()}}),[t]);(0,r.useEffect)((()=>()=>{n&&S.hI({environment:c,teamStore:t,shouldScroll:!0})}),[n,t,c]);const[Z,x]=(0,r.useState)(!1),F=(0,d.VK)((()=>i.state.inviteTargets),[i]),A=(0,d.VK)((()=>i.state.inviteTargets.length),[i]),O=(0,d.VK)((()=>i.state.inviteRole),[i]),V=(0,d.VK)((()=>{if(i.state.isInviteTargetsEmpty)return!1;return Boolean(i.state.inviteTargets.find((e=>"group"===e.type)))}),[i]),U=(0,d.VK)((()=>C.QM()),[]),W=(0,d.VK)((()=>!(null==P||!P.length||"team_level_guest"!==O||!(0,M.F$)())&&F.some((e=>"group"!==e.type&&(0,u.dy)(P,e.value.email)))),[P,O,F]),K=(0,d.VK)((()=>(0,M.s$)()?!U&&!_.U2(t):"open"===I&&(0,M.u3)()),[t,I,U]),z=async()=>{if(x(!0),A>0){const e=i.state.inviteTargets,n=await v.zK({environment:c,store:t,permissionsInviteStore:i,inviteOrigin:"team_invite_overlay"});if(void 0!==h)if(n){const i=(0,w.t0)({inviteTargets:e,recordStore:t,canEditSpaceMembership:h});if(!i)return;setTimeout((()=>{y.oV({label:i})}))}else setTimeout((()=>{y.oV({label:s()(g.FormattedMessage,{id:"TeamPermissionsInviteOverlay.inviteMembersFailure.message",defaultMessage:"Failed to send invites"})})}))}v.Mr({permissionsInviteStore:i}),x(!1),null==a||a()};return s()("div",{className:b.D$4,style:{...D.full}},void 0,s()("div",{style:D.containerLeftAligned},void 0,s()("div",{style:D.titleAndIcon},void 0,s()("div",{style:D.addMembersTo},void 0,s()(g.FormattedMessage,{id:"TeamPermissionsInviteOverlayV2.membersTitle.label",defaultMessage:"Invite people to"})),s()("div",{style:D.icon},void 0,s()(E.p,{disabled:!0,store:t,size:20})),s()(B.s,{style:D.teamName},void 0,m)),s()("div",{style:D.full},void 0,s()(k.LazyTeamPermissionsInvite,{store:t,permissionsInviteStore:i,onEmptySubmit:z}),s()("div",{style:D.subtitle},void 0,s()(L,{inviteTargets:F,workspaceName:p,canEditSpaceMembership:h,membershipRequestsDisabled:f,isFreeTier:U,inviteRole:O,hasTeamGuestsMatchAllowedDomain:W}))),s()("div",{style:K?D.multiButtonContainer:D.singleButtonContainer},void 0,s()("div",{style:K?D.multiButtonContainer:{}},void 0,K&&s()(N,{store:t}),s()(R,{isLoading:Z,onSubmit:z,onDismiss:()=>{v.Mr({permissionsInviteStore:i}),null==o||o()},isNewlyCreatedTeam:n,inviteTargets:F,includesGroups:V,inviteRole:O,canEditSpaceMembership:h,membershipRequestsDisabled:f,spaceAllowedDomains:P,hasTeamGuestsMatchAllowedDomain:W})))))}},86100:(e,t,i)=>{i.r(t),i.d(t,{default:()=>l});var n=i(23174),a=i.n(n),o=(i(67294),i(81954)),s=i(9019),r=i(30688);const l=function(e){window.__c={n:"TeamPermissionsInviteWithModal"};const[t,,i]=(0,o.AF)(e.permissionsInviteStore),n=()=>{i.reset()};return a()(s.Z,{modalStyle:{alignSelf:"center",overflow:"visible",top:0,width:500},open:t.modalOpen,onDismiss:n,renderContent:()=>a()("div",{style:{display:"flex",flexDirection:"column",alignItems:"end",padding:22}},void 0,a()(r.Z,{store:e.store,permissionsInviteStore:i,isNewlyCreatedTeam:!1,onSubmitSuccessful:n,onDismiss:n})),origin:e.origin})}},51923:(e,t,i)=>{i.d(t,{Z:()=>p});var n=i(23174),a=i.n(n),o=(i(67294),i(24405)),s=i(5366),r=i(97880),l=i(33665),d=i(74523),c=i(13380);function u(e){switch(e){case"bestPractices":return(0,l.UY)("guides.teamspacesLearnMore");case"workspaceOwnerGuide":return(0,l.UY)("guides.teamspacesWorkspaceOwner");case"settingsAndPermissions":return(0,l.UY)("guides.teamspacesSettingsAndPermissions");default:return(0,r.t1)(e)}}function m(e){return e||a()(c.s,{},void 0,a()(s.FormattedMessage,{defaultMessage:"Learn about teamspaces",id:"teamsLearnMoreLink"}))}function p(e){let{onClick:t,message:i,helpCenterLocation:n,analyticsFrom:s,containerStyle:r}=e;window.__c={n:"TeamsLearnMoreLink"};const l=(0,o.yK)((()=>({button:{maxWidth:"100%"}})),[]);return a()("div",{style:r},void 0,a()(d.Z,{buttonStyle:l.button,title:m(i),analyticsFrom:s,href:u(n),onClick:t}))}},62512:(e,t,i)=>{i.d(t,{n:()=>h});var n=i(23174),a=i.n(n),o=(i(67294),i(81954)),s=i(24405),r=i(7928),l=i(5366),d=i(31278),c=i(45653),u=i(37432),m=i(37708);const p=u.Z.iconSize,g=m.Kt;function h(e){let{ownerStores:t,teamStore:i,isSmall:n=!1}=e;window.__c={n:"TeamOwnerIcons"};const r=n?g:p,l=n?10:16,c=(0,s.yK)((e=>({container:{position:"relative",width:r,height:r},teamBadge:{position:"absolute",bottom:-5,right:-3,background:e.modalBackground,padding:.75,borderRadius:"0.25em"}})),[r]),{teamName:u,teamIcon:m}=(0,o.VK)((()=>({teamName:i.getName(),teamIcon:i.getIcon()})),[i]),h=e=>a()(d.Z,{disabled:!0,title:u,icon:m,isEmptyPage:!1,size:e});return 0===t.length?h(r):a()("div",{style:c.container},void 0,a()(f,{isSmall:n,store:t[0]}),a()("div",{style:c.teamBadge},void 0,h(l)))}function f(e){let{store:t,isSmall:i=!1,style:n={}}=e;window.__c={n:"OwnerIcon"};const u=(0,l.useIntl)(),m=i?g:p,h=(0,s.yK)((e=>({icon:{width:m,height:m,borderRadius:m,boxShadow:e.avatarBoxShadow,...n}})),[m,n]),f=(0,o.VK)((()=>null!=t&&t.isDefined()?(0,r.Nz)(u,null==t?void 0:t.getModel()):void 0),[u,t]),v=f?a()(c.Z,{avatarShouldShowShadow:!0,userStore:t,size:m}):a()(d.Z,{bucket:"public",disabled:!0,isEmptyPage:!1,title:f,size:m,icon:void 0});return a()("div",{style:h.icon},void 0,v)}},49469:(e,t,i)=>{i.d(t,{z:()=>r});var n=i(23174),a=i.n(n),o=(i(67294),i(24405)),s=i(82990);function r(e){let{title:t,subtitle:i,style:n}=e;window.__c={n:"TeamSettingsHeader"};const r=(0,o.yK)((e=>({base:{width:"100%"},title:{fontWeight:s.Z.fontWeight.medium,color:e.regularTextColor,fontSize:14},subtitle:{fontWeight:s.Z.fontWeight.regular,color:e.mediumTextColor,fontSize:12}})),[]);return a()("div",{style:{...r.base,...n}},void 0,a()("div",{style:r.title},void 0,t),i&&a()("div",{style:r.subtitle},void 0,i))}},37708:(e,t,i)=>{i.d(t,{oM:()=>c,MQ:()=>u,Kt:()=>m,Ph:()=>p});var n=i(23174),a=i.n(n),o=i(67294),s=i(24405),r=i(61519),l=i(89728),d=i(49469);const c=15,u=8,m=20;function p(e){window.__c={n:"TeamSettingsList"};const t=(0,s.yK)((()=>({button:{height:"auto",paddingLeft:0,paddingRight:0,display:"flex"},title:{marginBottom:10}})),[]);return Boolean(e.onClick)?o.createElement(o.Fragment,null,a()(d.z,{title:e.title,style:t.title}),a()(l.Z,{onClick:e.onClick,style:t.button},void 0,o.createElement(g,e))):o.createElement(o.Fragment,null,a()(d.z,{title:e.title,style:t.title}),o.createElement(g,e))}function g(e){let{title:t,rows:i,hideDividers:n=!1,itemStyle:l,onClick:d}=e;window.__c={n:"TeamSettingsListContainer"};const m=(0,s.yK)((e=>({container:{border:`1px solid ${e.regularDividerColor}`,borderRadius:4,width:"100%"},list:{listStyle:"none",padding:0,margin:0},listItem:{marginLeft:c,marginRight:c,paddingTop:u,paddingBottom:u,...l},divider:{marginLeft:c,marginRight:c,borderColor:`${e.regularDividerColor}`}})),[l]);return a()("div",{style:{...m.container}},void 0,a()("ul",{style:m.list},void 0,i.map(((e,t)=>o.createElement(o.Fragment,null,!n&&t>0&&a()(r.Z,{size:1,innerStyle:m.divider}),a()("li",{style:m.listItem},t,e))))))}},9281:(e,t,i)=>{i.r(t),i.d(t,{default:()=>De});var n=i(23174),a=i.n(n),o=i(67294),s=i(480),r=i(81954),l=i(24405),d=i(15145),c=i(5366),u=i(11002),m=i(50906),p=i(54642),g=i(51127),h=i(5299),f=i(70442),v=i(5978),y=i(87788);var S=i(12359),b=i(28020),M=i(77373),w=i(93959),C=i(54258),_=i(4708),k=i(98165),T=i(45096),I=i(94660),P=i(46740),Z=i(79315),x=i(37394),F=i(53953),A=i(10434),E=i.n(A),B=i(41892),D=i(53397),R=i(21202),L=i(97880),N=i(95477),O=i(92350);var V=i(82136),U=i(68216),W=i(42922),K=i(31945),z=i(62896),G=i(73063),q=i(16354),H=i(64369),j=i(90530),Q=(i(57658),i(87279)),Y=i(52275),$=i(78140),X=i(32163),J=i(72495),ee=i(45653),te=i(14254),ie=i(93686);function ne(e){window.__c={n:"TeamPickerButton"};const{renderOrigin:t,onTeamAccept:i,sectionTitle:n,showMemberCount:l,right:d,showPrivate:u,onPrivateAccept:m,captionItem:p}=e,g=(0,s.Fy)().isMobile,h=oe(),f=(0,O.E7)(),v=(0,r.VK)((()=>f.filter((e=>e.canAddOrRemoveTopLevelPages()))),[f]),y=(0,r.VK)((()=>Z.default.state.currentUserStore),[]),S=[];if(p){const e={key:"caption",render:e=>o.createElement(J.Z,E()({},e,{topBorder:!0})),items:[p]};S.push(e)}const b=v.map((e=>({key:e.id,action:()=>{i(e)},render:t=>o.createElement(ae,E()({},t,{team:e,onAccept:i,showMemberCount:l,right:d}))}))),M={key:"teams",render:e=>o.createElement(J.Z,E()({},e,{title:n})),items:b};if(S.push(M),u){const e={key:"private",render:e=>o.createElement(J.Z,E()({},e,{topBorder:b.length>0})),items:[{key:"private",action:()=>{},render:e=>o.createElement(Y.Z,E()({},e,{icon:a()("div",{style:{position:"relative"}},void 0,a()(ee.Z,{hasTooltip:!1,userStore:y}),D.Z.lockedFilled(h.privateItemLockIcon)),title:a()(c.FormattedMessage,{id:"teamPickerButton.addToPrivate",defaultMessage:"Add to Private"}),onClick:()=>{null==m||m()}}))}]};S.push(e)}return o.createElement(K.ZP,E()({},e,{popupType:g?K.Z4.SlideUp:K.Z4.Popup,renderOrigin:t,render:e=>{let t;return t=g?{menuType:Q.og.ActionSheet}:{menuType:Q.og.Popup,width:"100%"},o.createElement($.Z,t,a()(X.Z,{style:{width:g?void 0:256},type:X.i.Vertical,initialFocus:void 0,sections:S}))}}))}function ae(e){window.__c={n:"TeamItem"};const{team:t,onAccept:i,showMemberCount:n,right:s,...l}=e,d=oe(),u=(0,r.VK)((()=>t.getUserIdsInTeam().length),[t]);return o.createElement(Y.Z,E()({},l,{onClick:e=>i(t),icon:a()(ie.p,{store:t,size:20,disabled:!0}),title:a()(te.o,{teamStore:t}),right:l.focused?s:null,caption:n?a()("div",{style:d.caption},void 0,a()(c.FormattedMessage,{defaultMessage:"{numberOfMembers, plural, one {{numberOfMembers} member} other {{numberOfMembers} members}}",id:"teamPickerButton.teamItem.teamMemberCount",values:{numberOfMembers:u}})):null}))}function oe(){return(0,l.yK)((e=>({privateItemLockIcon:{position:"absolute",bottom:-2,right:-2,zIndex:1,width:10,height:10,fill:e.accentColors.red[500]},caption:{color:e.lightTextColor}})),[])}function se(e){window.__c={n:"TemplateDetail"};const t=(0,s.O7)(),i=function(e){const[t,i]=o.useState(!1);return o.useEffect((()=>{const t=window.matchMedia(e);function n(e){i(e.matches)}return t.addEventListener("change",n),()=>{t.removeEventListener("change",n)}}),[e]),t}("(max-width: 960px)"),n=(0,l.yK)((e=>({container:{width:"100%",height:"100%",overflow:"auto",flex:1,display:"flex",flexDirection:"column",alignItems:"stretch",background:e.contentBackground,color:e.regularTextColor},contentContainer:{margin:16,padding:"20px 24px",border:"1px solid rgba(0, 0, 0, 0.07)",borderRadius:8,background:e.sidebarBackground,display:"flex",flexDirection:"row",justifyContent:"space-between",columnGap:50,flexWrap:i?"wrap":"nowrap"},getTemplateColumn:{width:i?"100%":void 0,display:"flex",flexDirection:i?"column-reverse":"column"},madeByLabelV1:{marginTop:16,marginBottom:16},heroImg:{height:"100%",width:"100%"},getTemplateButton:{width:i?"100%":220,height:38,fontSize:16},addBadgeTeamTemplateButton:{textTransform:"none",color:e.blueColor},madeByV2Container:{marginBottom:16,display:"flex",flexDirection:"row",alignItems:"center",gap:6,width:"content-fit"},madeByV2Label:{fontSize:14,fontWeight:500},madeByV2AvatarContainer:{width:30,height:30,display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center",borderRadius:"50%",border:`1px solid ${e.outlineButtonBorder}`,overflow:"hidden",backgroundColor:"rgb(245, 245, 245)"},madeByV2Avatar:{width:30,height:30},madeByV2NotionAvatar:{width:16,height:16}})),[i]),{status:d,selectedTemplate:u,cloneTo:p,selectedTeam:g}=(0,r.VK)((()=>x.Z.state),[]),h=(0,r.VK)((()=>(0,_.s2)()),[]),f=(0,r.VK)((()=>{if("open"===d&&"preset"===(null==u?void 0:u.type)){const e=u.uri,t=(0,w.SP)(e),i=null==t?void 0:t.presets.find((t=>t.uri===e));if(t&&i)return{currentApp:t,currentPreset:i}}}),[d,u]),v=(0,r.VK)((()=>{if(u){if("preset"===u.type){var e;if(!f)return;const{currentPreset:i}=f,o=null===(e=i.previews)||void 0===e?void 0:e.find((e=>"previewRootId"in e)),s=o&&new U.G(t,{table:R.iU,id:o.previewRootId,spaceId:o.spaceId}),r=s?a()("div",{style:{overflow:"hidden",paddingTop:64,paddingLeft:64,paddingRight:64}},void 0,a()(j.Z,{store:s,loadingContainerStore:void 0,context:V.S.InAppTemplatePreview,paddingLeft:0,paddingRight:0,paddingBottom:0,pageCoverHeight:0,titleStyle:{fontSize:32},disabled:!0},s.id)):a()("img",{style:n.heroImg,src:B.Z.images.appPackages.projectPreview1Png});return[i.name,i.description,a()("img",{src:i.icon,style:{width:30,height:30}},i.uri),r]}if("pageTemplate"===u.type){const{template:e}=u,i=new U.G(t,{table:R.iU,id:e.previewRootId,spaceId:e.spaceId}),n=i.isCollectionView()?64:0,o=a()("div",{style:{overflow:"hidden",paddingTop:n,paddingLeft:n,paddingRight:n}},void 0,a()(j.Z,{store:i,loadingContainerStore:void 0,context:V.S.InAppTemplatePreview,paddingLeft:0,paddingRight:0,paddingBottom:0,pageCoverHeight:j.Z.defaultPageCoverHeight(t),disabled:!0,style:{...i.isFullWidth()?{width:"calc(100% - 64px)",margin:"0 32px"}:{}}}));return[e.name,e.description,a()("span",{style:{fontSize:20,height:30}},e.rootId,e.emoji?a()(z.Z,{},void 0,e.emoji):a()("img",{src:e.icon,style:{width:30,height:30}},e.icon)),o]}(0,L.t1)(u)}}),[f,t,u,n.heroImg]),y=(0,O.E7)(),S=(0,r.VK)((()=>y.filter((e=>e.canAddOrRemoveTopLevelPages()))),[y]),{creatorName:b,creatorAvatar:M,creatorUrl:C}=(0,r.VK)((()=>{if(!h||!u||"preset"===u.type)return{creatorName:"Notion",creatorAvatar:B.Z.images.notionLogoPng,creatorUrl:`${N.default.domainBaseUrl}/@notion`,duplicates:void 0};const{template:e}=u,{creatorName:t,creatorAvatar:i,creatorHandle:n,duplicates:a}=e;return{creatorName:t,creatorAvatar:t?i:void 0,creatorUrl:t&&n?`${N.default.domainBaseUrl}/@${n}`:void 0,duplicates:t?a:void 0}}),[h,u]);if("open"!==d||void 0===u||!v)return null;const[k,T,I,P]=v,Z=S.length>0&&"destination_picker"===p&&!g,F=a()(c.FormattedMessage,{id:"templateDetail.getTemplateButton.label",defaultMessage:"Get template"}),A=a()(W.Z,{style:n.getTemplateButton,onClick:()=>{e.onAcceptTemplate(u,g),m.ye(t,{template_name:k,from:x.Z.state.analyticsFrom,target_team:null==g?void 0:g.id})}},void 0,F),Q=a()(ne,{showMemberCount:!0,showPrivate:!0,placementToOrigin:K.pO.Top,originGap:4,sectionTitle:a()(c.FormattedMessage,{id:"templateDetail.addToTeamspace",defaultMessage:"Add to a teamspace"}),renderOrigin:e=>o.createElement(W.Z,E()({},e,{style:n.getTemplateButton}),F),onTeamAccept:i=>{e.onAcceptTemplate(u,i),m.ye(t,{template_name:k,from:x.Z.state.analyticsFrom,target_team:i.id})},onPrivateAccept:()=>{e.onAcceptTemplate(u),m.ye(t,{template_name:k,from:x.Z.state.analyticsFrom,target_team:"private"})},right:a()(G.Z,{isBlue:!0,style:{borderRadius:"100px",pointerEvents:"none"},icon:D.Z.plusThick,hovered:!0,caption:a()(c.FormattedMessage,{defaultMessage:"Add",id:"TemplateDetail.TeamItem.addButton"}),captionStyle:n.addBadgeTeamTemplateButton})}),Y=a()("div",{style:n.madeByLabelV1},void 0,a()(H.Z,{isSmall:!0},void 0,a()(c.FormattedMessage,{id:"templateDetail.madeBy.label",defaultMessage:"Made by"})),a()("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",marginTop:4}},void 0,a()("img",{src:B.Z.images.notionLogoPng,style:{width:15,height:16}}),a()("span",{style:{fontSize:14,fontWeight:500,marginLeft:5,marginRight:5}},void 0,"Notion"))),$=b?a()(q.Z,{style:{...n.madeByV2Container,...!C&&{cursor:"default"}},href:C,disabled:!C,external:!0},void 0,M&&a()("div",{style:n.madeByV2AvatarContainer},void 0,a()("img",{src:M,style:M===B.Z.images.notionLogoPng?n.madeByV2NotionAvatar:n.madeByV2Avatar})),a()(H.Z,{style:n.madeByV2Label},void 0,a()(c.FormattedMessage,{id:"templateDetail.madeBy.label.v2",defaultMessage:"By {author}",values:{author:b}}))):null;return o.createElement(o.Fragment,null,a()("div",{style:n.container},void 0,a()("div",{style:{height:"100%",overflowX:"hidden",overflowY:"auto",maskImage:"linear-gradient(black 80%, transparent 100%)",WebkitMaskImage:"linear-gradient(black 80%, transparent 100%)"}},void 0,a()("div",{style:{position:"relative"}},void 0,a()("div",{style:{marginTop:-20,opacity:1,zIndex:999,pointerEvents:"none"}},void 0,P),a()("div",{style:{backgroundColor:"transparent",position:"absolute",left:0,top:0,right:0,bottom:0,zIndex:1e3}}))),a()("div",{style:n.contentContainer},void 0,a()("div",{style:{display:"flex",flexDirection:"column"}},void 0,a()("div",{style:{display:"flex",flexDirection:"row",alignItems:"flex-start",marginBottom:h?0:20}},void 0,!h&&I,a()("div",{style:{display:"flex",flexDirection:"column",marginLeft:h?0:10}},void 0,a()("span",{style:{fontSize:20,fontWeight:700,lineHeight:1.2,marginTop:3,marginBottom:12}},void 0,k))),a()("div",{},void 0,h&&$),a()("div",{style:{fontSize:14}},void 0,T)),a()("div",{style:n.getTemplateColumn},void 0,Z?Q:A,!h&&Y))))}var re=i(96486),le=i.n(re),de=i(58573),ce=i(10482),ue=i(33929),me=i(33665),pe=i(31194),ge=i(73657),he=i(61519),fe=i(74194),ve=i(3386),ye=i(64921);function Se(e){window.__c={n:"SelectPill"};const{icon:t,title:i,on:n,wrapStyle:o,innerStyle:r,hideChevron:d}=e,c=(0,l.Fg)(),u=(0,s.O7)(),m=(0,l.yK)((e=>({button:{fontSize:14,display:"inline-flex",alignItems:"center",justifyContent:"center",whiteSpace:"nowrap",borderRadius:32,height:u.device.isMobile?28:24,lineHeight:u.device.isMobile?"28px":"24px",padding:"0 8px",border:`1px solid ${e.outlineButtonBorder}`,color:e.mediumTextColor,...n&&{color:e.blueColor,border:`1px solid ${e.filterPillBorder}`,background:e.filterPillBackground},...r}})),[u.device.isMobile,r,n]);return a()("div",{style:{borderRadius:14,marginRight:6,display:"inline-flex",...o}},void 0,a()(ye.Z,{style:m.button,hoveredStyle:n?{background:c.outlineBlueButtonHoveredBackground}:void 0,pressedStyle:n?{background:c.outlineBlueButtonPressedBackground}:void 0,onMouseEnter:e.onMouseEnter,onMouseLeave:e.onMouseLeave,onClick:e.onClick,onDoubleClick:e.onDoubleClick},void 0,t,i,!d&&D.Z.chevronDown({width:10,marginLeft:4,marginTop:1,fill:n?c.blueColor:c.lightIconColor})))}var be=i(14694);function Me(e){let{topCategoryId:t,categoryId:i}=e;window.__c={n:"TemplateGallerySidebarCategoryName"};const n=(0,c.useIntl)(),o=(0,l.yK)((e=>({sidebarTitle:{fontSize:12,color:e.lightTextColor,fontWeight:600,margin:"4px 4px 0 6px"}})),[]),s=(0,r.VK)((()=>{const e=function(){var e;if(!t)return;const n=T.oO(t);return n?null===(e=n.subcategories)||void 0===e?void 0:e.find((e=>e.id===i)):void 0}();if(e)return e.name;const a=ce._5[i];return a?n.formatMessage(a):""}),[t,i,n]);return a()(be.Z,{style:o.sidebarTitle},void 0,s)}function we(){window.__c={n:"TemplateGallerySidebarMoreFromCommunity"};const e=(0,s.O7)(),t=(0,r.VK)((()=>(0,_.s2)()),[]),i=(0,l.yK)((e=>({button:{height:28,padding:"0 4px",borderRadius:5,transition:"background 0.2s ease",color:e.mediumTextColor,alignItems:"flex-start",fontWeight:500,marginLeft:6,marginRight:6,width:"calc(100% - 12px)"},icon:{width:14,height:14,marginLeft:6,transform:"rotate(45deg)"},linkContentV2Container:{display:"flex",flexDirection:"column",gap:4},linkContentV2Title:{display:"flex",flexDirection:"row",alignItems:"center",fontWeight:600,fontSize:14},linkContentV2Subtitle:{maxWidth:250,whiteSpace:"inherit",overflow:"inherit",fontWeight:400,fontSize:13}})),[]),n=(0,o.useMemo)((()=>o.createElement(o.Fragment,null,D.Z.typesRelation(i.icon),a()(c.FormattedMessage,{defaultMessage:"More from the Community",id:"templateGallerySidebar.goToMarketingTemplateGalleryButton.label"}))),[i.icon]),d=(0,o.useMemo)((()=>a()("div",{style:i.linkContentV2Container},void 0,a()(H.Z,{isInline:!1,style:i.linkContentV2Title},void 0,a()(c.FormattedMessage,{defaultMessage:"More templates",id:"templateGallerySidebar.goToCommunityTemplateGalleryButton.labe2"}),D.Z.sendArrow(i.icon)),a()(H.Z,{isInline:!1,isSecondaryColor:!0,style:i.linkContentV2Subtitle},void 0,a()(c.FormattedMessage,{defaultMessage:"Discover thousands of templates made by Notion users like you",id:"templateGallerySidebar.goToCommunityTemplateGalleryButton.reason2"})))),[i.icon,i.linkContentV2Container,i.linkContentV2Subtitle,i.linkContentV2Title]);return a()(q.Z,{href:(0,me.UY)("templateGallery"),onClick:()=>m.T2x(e),style:{display:"flex",flexDirection:"row",alignItems:"center"},external:!0},void 0,t?d:n)}var Ce=i(8848),_e=i(82990),ke=i(98742),Te=i(51077),Ie=i(89728);function Pe(e){let{}=e;window.__c={n:"TemplateGalleryTopCategoryFilter"};const t=(0,l.yK)((e=>({newInAppGalleryTopCategoryFilterBarContainer:{border:`1px solid ${e.outlineButtonBorder}`,borderRadius:4,marginBottom:8},newInAppGalleryTopCategoryFilterButton:{display:"flex",alignItems:"center",justifyContent:"space-between",color:e.mediumTextColor,padding:"8px 12px",borderRadius:4,marginRight:0,fontSize:_e.Z.fontSize.UIRegular.desktop,background:e.inputBackground},newInAppGalleryTopCategoryFilterChevronIcon:{width:15,height:15,fill:e.mediumIconColor}})),[]),{selectedTopCategory:i}=(0,r.VK)((()=>x.Z.state),[]),n=(0,r.VK)((()=>y.Z.getTopTemplateCategories()),[]),s=(0,r.VK)((()=>i?T.oO(i):void 0),[i]),d=(0,r.VK)((()=>(0,_.s2)()&&(null==n?void 0:n.length)>0),[n]);return d?a()("div",{style:t.newInAppGalleryTopCategoryFilterBarContainer},void 0,a()(K.ZP,{popupType:K.Z4.Popup,alignmentToOrigin:K.vR.End,placementToOrigin:K.pO.Bottom,sameWidthAsOrigin:!0,render:e=>a()($.Z,{menuType:Q.og.Popup},void 0,a()(X.Z,{type:X.i.Vertical,initialFocus:void 0,sections:[{key:"top-category",items:n.map((e=>({key:e.id,action:()=>{if(!d)return;const t=(0,I.rq)(e);x.Z.setState({...x.Z.state,selectedTopCategory:e.id,allTemplates:t,limitResults:T.JL(t)})},render:t=>o.createElement(Y.Z,E()({},t,{title:a()(Ze,{category:e,showSelected:e.id===i})}))}))),render:e=>o.createElement(J.Z,e)}],onAccept:()=>e.close()})),renderOrigin:e=>o.createElement(Ie.Z,E()({},(0,ke.Z)(e,{onClick:()=>{}}),{style:t.newInAppGalleryTopCategoryFilterButton}),a()(Ze,{category:s}),D.Z.chevronDown(t.newInAppGalleryTopCategoryFilterChevronIcon))})):null}function Ze(e){let{category:t,showSelected:i=!1}=e;window.__c={n:"TemplateGalleryTopCategoryWithIcon"};const n=(0,l.yK)((e=>({selectedIconStyle:{width:14,height:14,fill:Ce.ZP.defaultText},categorySelection:{display:"flex",flexDirection:"row",alignItems:"center",gap:8,lineHeight:"20px"},categoryButtonContainer:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between"}})),[]);return t?a()("span",{style:n.categoryButtonContainer},void 0,a()("span",{style:n.categorySelection},void 0,a()(Te.Z,{type:"notion_icon",size:20,icon:t.icon.name,isLoading:!1,progressPercent:void 0,largeIcon:!0}),a()("span",{},void 0,t.name)),i&&a()("span",{},void 0,D.Z.thinCheck(n.selectedIconStyle))):null}const xe=(0,c.defineMessages)({allPersona:{id:"templateGallery.sidebar.persona.allTemplates",defaultMessage:"All templates"},noResults:{id:"templateGallery.sidebar.results",defaultMessage:"No results"}});function Fe(){window.__c={n:"TemplateGallerySidebar"};const[e,t]=(0,o.useState)(""),i=(0,c.useIntl)(),n=(0,l.Fg)(),d=(0,s.O7)(),u=(0,r.VK)((()=>(0,_.s2)()),[]),{selectedCategory:p,status:g}=(0,r.VK)((()=>x.Z.state),[]),[h,f]=(0,o.useState)(!1);(0,o.useEffect)((()=>{if(!h){const t=x.Z.state.selectedTemplate;var e;if(t)null===(e=document)||void 0===e||null===(e=e.getElementById(`tg-${"uri"in t?w.XR[t.uri]:t.template.name}`))||void 0===e||e.scrollIntoView({block:"center"}),f(!0)}}),[h]),(0,o.useEffect)((()=>{"closed"===g&&f(!1)}),[f,g]);const v=(0,l.yK)((e=>({sidebar:{height:"100%",width:275,background:e.sidebarBackground,alignContent:"center",display:"flex",flexDirection:"column",justifyContent:"space-between",alignItems:"stretch",boxShadow:e.sidebarBoxShadow},sidebarMoreFromCommunityContainer:{padding:12,borderTop:`1px solid ${e.accentColors.translucentGray[200]}`},header:{padding:"12px 12px 0 12px"},searchIcon:{width:14,height:14,marginRight:6,flexGrow:0,flexShrink:0,fill:e.mediumIconColor},searchBar:{height:32,borderRadius:5,fontSize:14,marginTop:0,marginBottom:8,padding:"16px 10px"},filterBar:{display:"flex",flexDirection:"row",width:273,flexWrap:"wrap",gap:6},newInAppGalleryBrandContainer:{display:"flex",alignItems:"center",width:"100%",gap:6,marginBottom:10},newInAppGalleryBrandName:{fontSize:15,fontWeight:600,color:e.regularTextColor},newInAppGalleryBrandIcon:{width:18,height:15,fill:e.regularTextColor},newInAppGallerySearchBarContainer:{padding:"0px 12px"}})),[]),y=(0,o.useMemo)((()=>a()(ve.Z,{capture:!0,onBackspace:le().identity,onLeft:le().identity,onRight:le().identity,onSelectAll:le().identity,onRedo:le().identity,onUndo:le().identity,onCut:le().identity,onCopy:le().identity,onPaste:le().identity,onKeypress:le().identity,onDelete:le().identity,onTab:le().identity},void 0,a()(fe.Z,{placeholder:i.formatMessage({id:"templateGallery.sidebar.searchbar.placeholder",defaultMessage:"Search templates"}),left:D.Z.search(v.searchIcon),showClearButton:!0,format:fe.Z.Format.Small,value:e,style:v.searchBar,onChange:e=>t(e.target.value)}))),[e,i,v.searchBar,v.searchIcon]),S=(0,o.useCallback)((e=>{var t,i;const n=[{key:"personas",render:e=>o.createElement(J.Z,E()({},e,{topBorder:0!==e.index})),items:[void 0,...(0,I.Io)({userPersona:null===(t=Z.default.state.currentUserSettingsStore)||void 0===t||null===(t=t.getSettings())||void 0===t?void 0:t.persona,subscriptionTier:null===(i=Z.default.state.currentSpaceStore)||void 0===i?void 0:i.getSubscriptionTier()}).filter((e=>"suggested"!==e))].map((t=>({key:t??"all",render:e=>o.createElement(Y.Z,E()({},e,{focused:!1,checkState:le().isEqual(t,p),title:a()("div",{style:{display:"flex",alignItems:"center"}},void 0,o.createElement(c.FormattedMessage,t?ce._5[t]:xe.allPersona)),shouldWrapCaption:!0})),action:()=>{x.Z.setState({...x.Z.state,selectedCategory:t}),e.close(),m.NgT(d,{persona:t??"all"})}})))}],s={menuType:Q.og.Popup,width:260};return o.createElement($.Z,s,a()(X.Z,{type:X.i.Vertical,initialFocus:void 0,sections:n}))}),[d,p]),b=(0,o.useMemo)((()=>a()("div",{style:v.filterBar},void 0,a()(K.ZP,{popupType:K.Z4.Popup,renderOrigin:e=>o.createElement(Se,E()({on:!0,icon:D.Z.person({width:14,marginRight:6,fill:n.blueColor}),title:a()("span",{},void 0,o.createElement(c.FormattedMessage,p?ce._5[p]:xe.allPersona))},e)),placementToOrigin:pe.Iw.Bottom,render:e=>S(e)}))),[S,p,v.filterBar,n.blueColor]);return a()("div",{style:v.sidebar},void 0,!u&&a()("div",{style:v.header},void 0,y,b),u&&o.createElement(o.Fragment,null,a()("div",{style:v.header},void 0,a()(q.Z,{href:(0,me.UY)("templateGallery"),onClick:()=>m.Ib5(d),style:v.newInAppGalleryBrandContainer,external:!0},void 0,D.Z.sidebarTemplates(v.newInAppGalleryBrandIcon),a()("span",{style:v.newInAppGalleryBrandName},void 0,a()(c.FormattedMessage,{id:"templateGallery.brand.title",defaultMessage:"Templates"}))),a()(Pe,{})),a()("div",{style:v.newInAppGallerySearchBarContainer},void 0,y)),a()(Ae,{currentQuery:e,selectedCategory:p}),u&&a()("div",{},void 0,a()(he.Z,{size:"0"}),a()("div",{style:v.sidebarMoreFromCommunityContainer},void 0,a()(we,{}))))}function Ae(e){window.__c={n:"TemplateGallerySidebarItemList"};const{currentQuery:t,selectedCategory:i}=e,n=""!==t||void 0!==i,{allTemplates:s,selectedTopCategory:d,status:u,limitResults:m}=(0,r.VK)((()=>x.Z.state),[]),p=(0,r.VK)((()=>(0,_.s2)()),[]),g=(0,l.yK)((e=>({button:{height:44,padding:"8px 0",borderRadius:4,marginBottom:4,transition:"all 0.2s ease",color:e.mediumTextColor,alignItems:"flex-start"},categoryDiv:{marginBottom:n?0:14},unSelectedItem:{color:e.mediumTextColor},selectedItem:{background:"dark"===e.mode?e.popoverHoveredBackground:e.buttonHoveredBackground,fontWeight:500,color:e.regularTextColor},hoveredItem:{borderRadius:4,background:e.buttonHoveredBackground},presetTitle:{fontSize:14,color:e.regularTextColor},presetDescription:{fontSize:12},sidebarTitle:{fontSize:12,color:e.lightTextColor,fontWeight:600,margin:"4px 4px 0 6px"},sidebarShowMore:{fontSize:12,color:e.lightTextColor,fontWeight:600,margin:"2px 2px 0 6px"}})),[n]),h=(0,r.VK)((()=>{if("open"!==u||void 0===s)return[];const e=new Set;return Object.fromEntries(Object.entries(s).filter((e=>{let[t]=e;return void 0===i||t===i})).map((i=>{let[n,a]=i;return[n,(0,de.ZP)(t.replaceAll("-",""),a,(e=>`${e.name}`.replaceAll("-",""))).filter((t=>{const i=e.has(t.name);return e.add(t.name),!i}))]})))}),[u,s,i,t]),f=(0,o.useCallback)((e=>{"open"===u&&void 0!==m&&x.Z.setState({...x.Z.state,limitResults:{...m,[e]:!1}})}),[m,u]);return"open"!==u?null:a()("div",{style:{flexGrow:1,width:"100%",overflowX:"hidden",overflowY:"auto"}},void 0,a()(J.Z,{desktopTitleStyle:{paddingLeft:8}},void 0,Object.entries(h).map((e=>{let[t,i]=e;if(0===i.length)return;const o=(null==m?void 0:m[t])&&!n&&i.length>I.IJ+1,s=o?i.length-I.IJ:0,r=o?i.slice(0,I.IJ):i;return a()("div",{style:g.categoryDiv},t,!n&&a()(Me,{topCategoryId:d,categoryId:t}),r.map((e=>"uri"in e?a()(Ee,{icon:e.icon,name:e.name,template:{type:"preset",uri:e.uri}},e.uri):a()(Ee,{icon:e.icon,emoji:e.emoji,name:e.name,template:{type:"pageTemplate",template:e}},e.id))),o&&s>0?a()(Y.Z,{style:g.sidebarShowMore,focused:!1,onClick:()=>f(t),title:a()(c.FormattedMessage,{defaultMessage:"{numNotShown} more...",id:"templateGallerySidebar.category.showMore",values:{numNotShown:s}})}):void 0)})),0===Object.values(h).flatMap((e=>e)).length&&a()(ge.Z,{caption:ue.default.formatMessage(xe.noResults),style:{lineHeight:"14px",padding:6,margin:0}}),!p&&a()(Y.Z,{desktopIconStyle:{alignSelf:"unset"},focused:!1,buttonStyle:{...g.button},title:a()(we,{})})))}function Ee(e){var t;window.__c={n:"TemplateGallerySidebarItem"};const i=(0,s.O7)(),n=(0,l.yK)((e=>({button:{height:28,padding:"0 4px",borderRadius:5,transition:"background 0.2s ease",color:e.mediumTextColor,alignItems:"flex-start",fontWeight:500,marginLeft:6,marginRight:6,width:"calc(100% - 12px)"},itemText:{marginLeft:5},unSelectedItemText:{color:e.mediumTextColor},selectedItemText:{color:e.regularTextColor},selectedItem:{background:"dark"===e.mode?e.popoverHoveredBackground:e.sidebarItemSelectedBackground,fontWeight:500},hoveredItem:{background:e.buttonHoveredBackground},presetIcon:{width:16,height:16,fontSize:16,color:e.regularEmojiColor},presetTitle:{fontSize:14},presetDescription:{fontSize:12}})),[]),{status:d,selectedTemplate:c,analyticsFrom:u}=(0,r.VK)((()=>x.Z.state),[]),p=(0,r.VK)((()=>"open"===d&&le().isEqual(c,e.template)),[d,e.template,c]),g=(0,o.useCallback)((()=>{const t="uri"in e.template?w.XR[e.template.uri]:e.template.template.previewRootId,n=(0,I.W4)({templateGalleryItem:t});v.navigate({environment:i,url:n}),m.n1D(i,{template_name:"preset"===e.template.type?e.template.uri:e.template.template.name,page_prepopulated_template_id:t,from:u})}),[u,i,e.template]);if("open"!==d)return null;const h=null!==(t=e.icon)&&void 0!==t&&t.startsWith("/")?a()("img",{src:e.icon,style:n.presetIcon}):a()("div",{style:n.presetIcon},void 0,a()(z.Z,{},void 0,e.emoji??e.icon??"")),f=`tg-${"uri"in e.template?w.XR[e.template.uri]:e.template.template.name}`;return a()(Y.Z,{id:f,desktopIconStyle:{alignSelf:"unset"},buttonStyle:{...n.button,...p?n.selectedItem:void 0},textWrapperStyle:{...p?n.selectedItemText:n.unSelectedItemText,...n.itemText},focused:!1,icon:h,title:a()("span",{style:n.presetTitle},void 0,e.name),shouldWrapCaption:!0,hoveredStyle:n.hoveredItem,onClick:g})}const Be=["companyHome","defaultWiki","engineeringWiki","salesWiki","teamWiki"];function De(){window.__c={n:"TemplateGalleryModal"};const e=(0,s.Fy)(),t=(0,s.O7)(),i=(0,c.useIntl)(),n=(0,o.useRef)(void 0),u=(0,l.yK)((t=>({modal:{width:e.isMobile?"auto":"90vw",height:e.isMobile?"auto":"90vh",borderRadius:8}})),[e.isMobile]),A=(0,r.VK)((()=>Z.default.state.currentSpaceStore),[]),{templateGalleryItem:E}=(0,r.VK)((()=>t.RouterStore.state.route),[t.RouterStore]),B=(0,r.VK)((()=>(0,_.s2)()),[]),{status:D,allTemplates:R,selectedTemplate:L,cloneTo:N,limitResults:O}=(0,r.VK)((()=>x.Z.state),[]);(0,o.useEffect)((()=>{if(E)return n.current=window.setTimeout((()=>{x.Z.setState({...x.Z.state,status:"closed"})}),1e4),()=>{void 0!==n.current&&window.clearTimeout(n.current)}}),[]);const V=(0,o.useRef)(void 0);(0,o.useEffect)((()=>{V.current&&(V.current=void 0)}),[null==A?void 0:A.id]),(0,o.useEffect)((()=>{var e;V.current||"closed"!==D&&(V.current=B?async function(e){const{environment:t,spaceId:i}=e,n=await p.getInAppCategoriesAndTemplates(t,{spaceId:i});return"success"===n.type&&(y.Z.setState({data:n.data}),"current"===n.data.version)}({environment:t,spaceId:null==A?void 0:A.id}):Promise.resolve(),null===(e=V.current)||void 0===e||e.then((()=>{var e,t;const{selectedTopCategory:i,allTemplates:n}=T.Lr({isNewInAppGalleryEnabled:B,userPersona:null===(e=Z.default.state.currentUserSettingsStore)||void 0===e||null===(e=e.getSettings())||void 0===e?void 0:e.persona,subscriptionTier:null===(t=Z.default.state.currentSpaceStore)||void 0===t?void 0:t.getSubscriptionTier()});x.Z.setState({...x.Z.state,selectedTopCategory:i,allTemplates:n,limitResults:T.JL(n)})})).finally((()=>{void 0!==n.current&&window.clearTimeout(n.current)})))}),[t,B,null==A?void 0:A.id,V,D]),(0,o.useEffect)((()=>{if(void 0!==R&&"opening"===D){const e=void 0!==L&&(void 0===E||"gallery"===E)?L:Re({templateGalleryItem:E,allTemplates:R});return x.Z.setState({...x.Z.state,status:"open",allTemplates:R,selectedTemplate:e,limitResults:O??T.JL(R),cloneTo:x.Z.state.cloneTo,analyticsFrom:x.Z.state.analyticsFrom}),void m.jWY(t,{template_name:"preset"===e.type?e.uri:e.template.name,from:x.Z.state.analyticsFrom})}}),[E,t,R,D,L,N,O]),(0,o.useEffect)((()=>{"open"===D&&void 0!==R&&void 0!==E&&"gallery"!==E&&x.Z.setState({...x.Z.state,selectedTemplate:Re({templateGalleryItem:E,allTemplates:R})})}),[R,D,E]);const U=(0,r.VK)((()=>{const e=(0,b.np)();if("open"===D&&"current_page"===N&&e&&e.isEmptyPage())return e}),[N,D]),W=(0,o.useCallback)((async(e,i)=>{var n,a,o;x.Z.setState({...x.Z.state,status:"closed",selectedTemplate:void 0});const{currentSpaceStore:s,currentSpaceViewStore:r}=Z.default.state,l=null==U||!U.getParentStore()||"block"!==(null===(n=U.getParentStore())||void 0===n?void 0:n.table)&&"space"!==(null===(a=U.getParentStore())||void 0===a?void 0:a.table)&&"team"!==(null===(o=U.getParentStore())||void 0===o?void 0:o.table)?i||s:U.getParentStore(),c=Date.now();let u;if("preset"!==e.type||e.uri.startsWith("notion://wiki")){const n="preset"===e.type?(0,C.CQ)(e.uri):e.template;if(!n)return;if(!s||!r)return;const a={environment:t,item:n,spaceStore:s,spaceViewStore:r,useMinimalTemplates:!1,from:"template_gallery"},o=U?await f.rC({...a,isPrivate:!1,initializeStore:U,type:"inExistingStore"}):i?await f.rC({...a,isPrivate:!1,teamStore:i,type:"inTeam",appendOrPrepend:"append"}):await f.rC({...a,isPrivate:!0,type:"inSpace"});u=o,o&&v.navigateToBlock({environment:t,store:o,pageVisitSource:d.tY.Create})}else{var y;const n=e.uri,a=null===(y=(0,w.SP)(n))||void 0===y?void 0:y.uri;if(!(a&&s&&r&&l))return;const o=i||k.VP(l);if(o){if(!(await async function(e){let{environment:t,spaceId:i,presetUri:n,teamStore:a}=e;const o=g.Y6(n);if(!o)return!0;if("tasks"===o)return!0;return await(0,P.l)({environment:t,spaceId:i,databaseCreationType:o,parentStore:a,teamId:a.id,from:"template_gallery"})}({environment:t,spaceId:s.id,presetUri:n,teamStore:o})))return}const d=U||(i?i.getTeamPagesStores().find((e=>e.getFormat().app_config_uri&&e.getFormat().app_config_uri===a)):void 0);S.createAndCommit({environment:t,userAction:"templateGallery.getTemplate",perform:e=>{const i=(0,M.p)().find((e=>e.uri===a)),o=null==i?void 0:i.presets.find((e=>e.uri===n));if(r&&o){const i=g.ZF({environment:t,spaceViewStore:r,appUri:a,presetUri:o.uri,appParentStore:l,temporaryContainerBlockStore:d,transaction:e,from:"template_gallery"});h.G({environment:t,spaceViewStore:r,appParentStore:l,transaction:e,blockStores:i,creationEntryPoint:{type:"preset",presetUri:o.uri}})}}}),p.finalizeAppTemplate(t,{})}const b="preset"===e.type?e.uri:e.template.name,_=Date.now()-c,T=U?!k.VP(U):!Boolean(i),I=T||null==i?void 0:i.id;m.enX(t,{template_name:b,destination:T?"private":"team",template_block_id:"pageTemplate"===e.type?e.template.rootId:void 0,template_duplication_duration_ms:_,team_id:I,created_page_id:u?u.id:null==U?void 0:U.id}),"preset"===e.type&&u&&m.bRT(t,{preset_uri:e.uri,created_block_stores:[u],from:"template_gallery",destination_team_id:I}),"pageTemplate"===e.type&&Ne(e.template.id)&&u&&m.Jw_(t,{from:"template_gallery",wiki_block_id:u.id,destination_team_id:I,wiki_template_id:e.template.id})}),[t,U]),K=(0,o.useCallback)((()=>{const{mainEditorCurrentBlockStore:e}=Z.default.state,{RouterStore:i}=t,n=i.state.route;if(e&&"page"===n.name){const e=(0,I.p8)();v.navigate({environment:t,url:e})}}),[t]);return a()(F.Z,{ariaLabel:i.formatMessage({id:"templateGallery.dialogLabel",defaultMessage:"Templates"}),open:"open"===D,innerStyle:u.modal,onDismiss:K,render:()=>"open"!==D?null:a()("div",{style:{height:"100%",display:"flex",flexDirection:"row",borderRadius:8,overflow:"hidden"}},void 0,a()(Fe,{}),a()(se,{onAcceptTemplate:W}))})}function Re(e){let{templateGalleryItem:t,allTemplates:i}=e;if(!t||"gallery"===t){var n;return"team"===(null===(n=Z.default.state.currentSpaceStore)||void 0===n?void 0:n.getPlanType())?{type:"preset",uri:"notion://projects/projects_preset"}:Le(i)}const a=Object.values(i).flatMap((e=>e)).find((e=>"uri"in e?w.XR[e.uri]===t:e.previewRootId===t));return a?"uri"in a?{type:"preset",uri:a.uri}:{type:"pageTemplate",template:a}:Le(i)}function Le(e){const t=e[Object.keys(e)[0]][0];return"uri"in t?{type:"preset",uri:t.uri}:{type:"pageTemplate",template:t}}function Ne(e){return Be.some((t=>u.Y[t].nameMessage.id===e))}},72340:(e,t,i)=>{i.d(t,{CN:()=>a,Tc:()=>o,$6:()=>s});var n=i(10161);const a=5;function o(e){return"on"===n.default.getEligibleGroup({experimentId:"parallel_confluence_importer_via_api",defaultGroup:"control"})}function s(e){return n.default.getEligibleGroup({experimentId:"special_case_confluence_file_size",defaultGroup:a.toString()})}},8989:(e,t,i)=>{i.d(t,{t:()=>o,b:()=>s});var n=i(10161),a=i(72340);function o(){return"on"===n.default.getEligibleGroup({experimentId:"generic_importer",defaultGroup:"control"})}function s(e){const t=n.default.getEligibleGroup({experimentId:"special_case_generic_file_size",defaultGroup:a.CN.toString()});return Number(t)}},4657:(e,t,i)=>{i.d(t,{U:()=>b});var n=i(23174),a=i.n(n),o=(i(30541),i(67294),i(480)),s=i(81954),r=i(24405),l=i(8848),d=i(53397),c=i(5366),u=i(64684),m=i(1865),p=i(74136);const g=function(e){let{tier:t}=e;const i=()=>a()(c.FormattedMessage,"business"===t?{id:"upgradeToBusinessBadge",defaultMessage:"Business"}:{id:"upgradeToEnterpriseBadge",defaultMessage:"Enterprise"});return a()(p.Z,{},void 0,a()(i,{}))};var h=i(38755),f=i(79315),v=i(12205),y=i(45660),S=i(35901);function b(e){let{teamStore:t,isDefault:i,onChange:n=(()=>{})}=e;const p=(0,o.O7)(),b=(0,v.J)(),w=(0,S.y)(null==t?void 0:t.id),C=(0,y.e)(),_="business",k=(0,s.VK)((()=>f.default.state.currentSpaceStore),[]),T=(0,s.VK)((()=>{if(k)return(0,h.rn)(p,k)}),[p,k]),I=(0,s.VK)((()=>{const e=null==t?void 0:t.getSettingsStore().getValue();return!!e&&("private"===(0,u.B5)(e)??!1)}),[t]),P=(0,r.yK)((()=>({openIcon:{width:20,height:20},lockIcon:{width:18,height:18},closedIcon:{width:20,height:20},iconContainer:{width:20,height:20,display:"flex",justifyContent:"center",alignItems:"center",marginLeft:5,marginRight:5}})),[]),Z=a()(c.FormattedMessage,{id:"TeamAccessLevelSwitcher.privateTeamspaceUpsellBusiness.tooltip",defaultMessage:"Upgrade to Business Plan to enable Private teamspaces"}),x=a()(c.FormattedMessage,{id:"TeamAccessLevelSwitcher.defaultTeamSpace.title",defaultMessage:"Default"}),F=a()(c.FormattedMessage,{id:"TeamAccessLevelSwitcher.openTeamspace.title",defaultMessage:"Open"}),A=a()(c.FormattedMessage,{id:"TeamAccessLevelSwitcher.closedTeamSpace.title",defaultMessage:"Closed"}),E=a()(c.FormattedMessage,{id:"TeamAccessLevelSwitcher.privateTeamSpace.title",defaultMessage:"Private"}),B="dark"===(0,r.Fg)().mode?l.ZP.uiLightGray:l.ZP.black,D=[{key:"open",icon:e=>a()("div",{style:P.iconContainer},void 0,d.Z.openTeam({...e,...P.openIcon})),iconColor:B,level:F,title:F,caption:a()(c.FormattedMessage,{id:"CreateTeamspaceMenu.openTeamspace.caption",defaultMessage:"Anyone can see and join this teamspace"}),disabled:!1,onSelect:()=>n("open",!1)},{key:"closed",icon:e=>a()("div",{style:P.iconContainer},void 0,d.Z.closedTeam({...e,...P.closedIcon})),iconColor:B,level:A,title:A,caption:a()(c.FormattedMessage,{id:"CreateTeamspaceMenu.closedTeamspace.caption",defaultMessage:"Anyone can see this teamspace but not join"}),disabled:!1,onSelect:()=>n("closed",!1)},{key:"private",icon:e=>a()("div",{style:P.iconContainer},void 0,d.Z.locked({...e,...P.lockIcon})),iconColor:B,level:E,title:C?a()(M,{title:E,badge:a()(g,{tier:_})}):E,caption:a()(c.FormattedMessage,{id:"CreateTeamspaceMenu.privateTeamspace.caption",defaultMessage:"Only members can see that this teamspace exists"}),disabled:C&&!b,tooltip:C?Z:void 0,onSelect:()=>{if(C&&!I)return m.y(p,{from:"team_security_settings",for:_,dontOpenPlansOnCancel:!0});n("private",!1)}}];if(i||b){const e=i&&(!b||w),t={key:"default",icon:e=>a()("div",{style:P.iconContainer},void 0,d.Z.globe2({...e,...P.lockIcon})),iconColor:B,level:x,title:x,caption:a()(c.FormattedMessage,{id:"CreateTeamspaceMenu.defaultTeamspace.caption",defaultMessage:"Everyone at {spaceName} must be a member",values:{spaceName:T}}),disabled:!1,disableAllOptionsTooltip:e?a()(c.FormattedMessage,b?{id:"TeamAccessLevelSwitcher.closeOrPrivateTeamspace.disabledTooltipOnlyDefaultTeam",defaultMessage:"Add another default teamspace to change teamspace permissions."}:{id:"TeamAccessLevelSwitcher.defaultTeamspace.disabledTooltipNonAdmin",defaultMessage:"You can't change this setting because you are not a workspace admin"}):void 0,onSelect:()=>n("open",!0)};D.unshift(t)}return D}function M(e){let{title:t,badge:i}=e;window.__c={n:"TitleWithBadge"};const n=(0,r.yK)((()=>({container:{display:"flex",flexWrap:"wrap",alignItems:"center"},badge:{marginLeft:5}})),[]);return a()("div",{style:n.container},void 0,t,a()("div",{style:n.badge},void 0,i))}},14275:(e,t,i)=>{i.r(t),i.d(t,{GlobalSearchStaticContext:()=>Ot,GlobalSearchStoresContext:()=>Vt,default:()=>Wt});var n=i(23174),a=i.n(n),o=i(96486),s=i.n(o),r=i(67294),l=i(83355),d=i(13991),c=i(49085),u=i(15145),m=i(49271),p=i(1800),g=i(84908),h=i(95477),f=i(43250),v=i(24042),y=i(2342),S=i(10434),b=i.n(S),M=i(81954),w=i(24405),C=i(36488),_=i(56940),k=i(78140),T=i(87279),I=i(35630),P=i(88632),Z=i(53397),x=i(70203),F=i(82990),A=i(5366),E=i(74194),B=i(68785),D=i(31278),R=i(33411),L=i(34700),N=i(80084),O=i(38755),V=i(79315),U=i(92338),W=i(29026);class K extends c.default{constructor(){super(...arguments),this.resetQuery=()=>{this.setState({...this.state,query:{...this.state.query,text:"",filters:(0,U.u4)()},limit:W.Xv})},this.updateQueryText=e=>{this.setState({...this.state,query:{...this.state.query,text:e},limit:W.Xv})}}getInitialState(){return{isOpen:!1,query:{text:"",filters:(0,U.u4)(),sort:{field:"relevance"}},limit:20}}}const z=new K;class G extends l.Z{constructor(){super(...arguments),this.typingTimer=void 0,this.combined=this.createComputedStore((()=>{var e,t;return N.oO({localResults:null===(e=this.props.searchResultStore.state.localResults)||void 0===e?void 0:e.results,serverResults:null===(t=this.props.searchResultStore.state.serverResults)||void 0===t?void 0:t.results})})),this.jumpToStore=this.createComputedStore((()=>{const e=this.combined.state,t=this.props.focusedIndexStore.state;if(!e||e.length<0||void 0===t)return;const i=e[t];return{focusedResultTitle:x.Jc(null==i?void 0:i.store.getTitleValue()),focusedResultIcon:null==i?void 0:i.store.getIcon()}})),this.renderLeft=e=>{var t;const{showSpinner:i}=this.props,n=this.styles,o={...this.getThemeColors().searchIcon,...n.searchIcon()},s=Boolean(z.state.query.text.trim()),r=null===(t=this.jumpToStore)||void 0===t||null===(t=t.state)||void 0===t?void 0:t.focusedResultIcon,l=s?a()(D.Z,{disabled:!0,icon:r,isEmptyPage:Boolean(r),size:20,style:o}):Z.Z.search(o);return a()(R.Z,{show:i,showDelay:500,showHold:200,render:e=>e?a()(B.Z,{style:o}):l})},this.handleQueryChange=e=>{this.handleTyping();const t=String(e.target.value);this.props.onQueryChange(t)},this.handleClearButtonClick=()=>{z.resetQuery()},this.styles={inputDesktop:{fontSize:18,height:G.DESKTOP_INPUT_HEIGHT,paddingLeft:16,paddingRight:16,flexGrow:0,flexShrink:0,zIndex:1,...(0,L.X)(!0,!0)},searchIcon:()=>{const{device:e}=this.environment;return{width:e.isMobile?16:18,height:e.isMobile?16:18,marginRight:e.isMobile?12:10,flexGrow:0,flexShrink:0}},input:{minWidth:0,...F.Z.textOverflowStyle,...(0,L.X)(!0,!1)},clearButton:{...(0,L.X)(!0,!1)}}}willUnmount(){this.typingTimer&&(clearTimeout(this.typingTimer),this.typingTimer=void 0)}renderComponent(){var e;const{device:t}=this.environment,{isOpen:i,searchResultStore:n}=this.props,o=this.styles,s=this.getThemeColors(),r=null===(e=this.jumpToStore.state)||void 0===e?void 0:e.focusedResultTitle,l=z.state.query.text,d=(null==r?void 0:r.slice(0,l.length).toLocaleLowerCase())===l.toLocaleLowerCase()&&l&&l.length<20&&!t.isMobile?l+(null==r?void 0:r.substring(l.length)):"",c=E.Z.Format.Transparent,u={...o.inputDesktop,...s.inputDesktop};return a()(E.Z,{format:c,placeholder:this.getPlaceholderText(),left:this.renderLeft(n),value:l,suggestedText:d,focus:i,focusInitial:!0,focusAfterAnimation:!0,showClearButton:!0,clearButtonStyle:o.clearButton,selectAll:!0,onChange:this.handleQueryChange,onClearButtonClick:this.handleClearButtonClick,style:u,inputStyle:o.input,window:this.props.window})}handleTyping(){const{onTypingChange:e}=this.props;this.typingTimer&&window.clearTimeout(this.typingTimer),e(!0),this.typingTimer=window.setTimeout((()=>e(!1)),G.TYPING_DEBOUNCE_MS)}getPlaceholderText(){const{currentSpaceStore:e}=V.default.state,t=e&&(0,O.rn)(this.environment,e);if(t)return this.props.intl.formatMessage({id:"searchInputMenuItem.placeholder.namedSpace",defaultMessage:"Search {spaceName}…"},{spaceName:t})}getThemeColors(){return{inputDesktop:{boxShadow:`0 1px 0 ${this.theme.regularDividerColor}`},inputMobile:{background:this.theme.inputBackground},searchIcon:{fill:this.theme.mediumIconColor}}}}G.displayName="SearchInputMenuItem",G.TYPING_DEBOUNCE_MS=300,G.DESKTOP_INPUT_HEIGHT=48,G.MAX_PLACEHOLDER_TITLE_LENGTH=100;const q=(0,A.injectIntl)(G);i(57658);var H=i(97880),j=i(32163),Q=i(43145),Y=i(72495),$=i(28020),X=i(15447),J=i(69327),ee=i(480),te=i(28992),ie=i(75024);const ne=e=>({fontSize:12,color:e.lightTextColor,marginLeft:6,paddingRight:4,paddingLeft:4,height:24}),ae=function(e){window.__c={n:"GlobalSearchFooterContainer"};const t=(0,ee.O7)(),{device:i}=t,n=(0,w.yK)((e=>({footer:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",fontSize:i.isMobile?F.Z.fontSize.UIRegular.mobile:F.Z.fontSize.UIRegular.desktop},footerWrapper:{flexShrink:0,...(0,L.X)(!0,!0)},footerText:{color:e.lightTextColor,fontSize:ie.yv(t,"UISmall"),...F.Z.textOverflowStyle},footerDebugButton:{...ne(e),marginRight:6}})),[i.isMobile,t]);return a()("footer",{style:n.footerWrapper},void 0,a()(Y.Z,{topBorder:!0,style:n.footer,disableDesktopPadding:!0},void 0,r.createElement(te.Z,b()({},e,{style:n.footerText}))))};function oe(){window.__c={n:"GlobalSearchFooterNavigationHints"};const e=(0,ee.O7)(),t=(0,A.useIntl)(),i=(0,w.yK)((t=>({upDownIcon:{marginRight:4,marginBottom:-2,display:"inline",width:12,height:12,fill:t.mediumIconColor},enterIcon:{marginRight:4,marginBottom:-2,display:"inline",width:11,height:11,fill:t.mediumIconColor},commandGlyph:{fontSize:.75*ie.yv(e,"UIRegular"),paddingRight:1,color:t.lightTextColor},footerText:{fontSize:ie.yv(e,"UISmall"),color:t.lightTextColor,...F.Z.textOverflowStyle},inlineHint:{display:"inline",marginRight:16}})),[e]),n={...ie.mK,...i.footerText};return a()("ul",{style:n},void 0,a()("li",{style:i.inlineHint},void 0,Z.Z.enter(i.enterIcon),t.formatMessage({id:"searchFooter.helpText.openNewTab",defaultMessage:"Open in a new tab"})))}var se=i(94184),re=i.n(se),le=i(8848),de=i(79362),ce=i(21202),ue=i(32739),me=i(45168),pe=i(24039),ge=i(90403),he=i(52275),fe=i(64133),ve=i(71669),ye=i(86176),Se=i(76798),be=i(58032),Me=i(69988),we=i(98742),Ce=i(98165),_e=i(8323),ke=i(16402),Te=i(68216),Ie=i(73299),Pe=i(40793),Ze=i(99208),xe=i(64921),Fe=i(31945),Ae=i(96525),Ee=i(40721),Be=i(89728),De=i(11470),Re=i(23537);class Le extends l.Z{constructor(){super(...arguments),this.getBreadcrumbCommonProps=e=>({maxWidth:this.props.ancestorMaxWidth,iconSize:this.props.iconSize,titleStyle:this.getTitleStyle(),iconStyle:Le.iconStyle,highlighter:this.props.highlighter})}renderComponent(){const{store:e}=this.props,t=e.getTitleStore();if(t&&t.isReady())return a()("div",{style:this.getStyle(),className:"notranslate"},void 0,this.renderAncestors())}renderAncestors(){const{store:e,maxAncestorCount:t}=this.props,i=Ce.uJ(e),n=e.isNavigableBlock()?i.slice(1):[...i];if(n.reverse(),i.reverse(),n.length>t){const[e,a,o]=[n[0],n.slice(1,n.length-t+1),n.slice(n.length-t+1)];if((0,Re.bq)()){const t=o.length;return[this.renderButtonForStore({store:e,showDivider:!this.props.isMobile}),this.renderBlocksAsPopup(this.props.isMobile?i:a),...o.map(((e,i)=>{const n=!this.props.hideCurrentPage||i!==t-1;return e instanceof Te.zX?r.createElement(Ze.Z,b()({key:e.id,store:e,showDivider:n},this.getBreadcrumbCommonProps(e))):r.createElement(Pe.Z,b()({key:e.id,store:e,showDivider:n},this.getBreadcrumbCommonProps(e)))}))]}{const e=n.filter((e=>e instanceof Te.G)),i=n.filter((e=>e instanceof Te.G)),a=e.length;return[r.createElement(Pe.Z,b()({key:e[0].id,store:e[0],showDivider:!this.props.isMobile},this.getBreadcrumbCommonProps(e[0]))),this.renderBlocksAsPopup(this.props.isMobile?i:e.slice(1,e.length-t+1)),...e.slice(e.length-t+1).map(((e,t)=>r.createElement(Pe.Z,b()({key:e.id,store:e,showDivider:!this.props.hideCurrentPage||t!==a-1},this.getBreadcrumbCommonProps(e)))))]}}{const e=n.length;return n.map(((t,i)=>this.renderButtonForStore({store:t,showDivider:!this.props.hideCurrentPage||i!==e-1})))}}renderButtonForStore(e){const{store:t,showDivider:i}=e;return t instanceof Te.zX?r.createElement(Ze.Z,b()({store:t,showDivider:i},this.getBreadcrumbCommonProps(t))):r.createElement(Pe.Z,b()({store:t,showDivider:i},this.getBreadcrumbCommonProps(t)))}getMenuListSections(e){const t=this.props.isMobile?Fe.Z4.SlideUp:Fe.Z4.Popup;return[{key:"results",render:e=>r.createElement(Y.Z,e),items:e.map(((e,i)=>({key:e.id,render:n=>r.createElement(Ae.Z,b()({},n,{stopClickPropagation:!0,popupType:t,renderOrigin:t=>r.createElement(De.Z,b()({},t,{isSubpage:0!==i,store:e,hidePath:!0,focused:!1})),render:e=>{}})),action:()=>{}})))}]}renderBlocksAsPopup(e){return a()(Fe.ZP,{popupType:this.props.isMobile?Fe.Z4.SlideUp:Fe.Z4.Popup,renderOrigin:e=>{var t;return this.props.isMobile?r.createElement(xe.Z,b()({style:{...Le.dividerWrapStyle},mobileFeedback:!0},e),a()(Ie.f,{}),a()("div",{style:Ne},void 0,"..."),a()(Ie.f,{})):a()("div",{style:Le.dividerWrapStyle},void 0,r.createElement(Be.Z,b()({isSmall:!0},e,{style:{paddingLeft:2,paddingRight:2,fontSize:null===(t=this.props.style)||void 0===t?void 0:t.fontSize}}),"..."),a()(Ie.f,{}))},render:t=>{let i;return i=this.props.isMobile?{menuType:T.og.Modal,title:a()(A.FormattedMessage,{defaultMessage:"Breadcrumb",id:"globalSearch.breadcrumb.mobileBreadcrumbMenu.title"}),right:a()(Ee.DoneMenuText,{}),onClickRight:t.close}:{menuType:T.og.Popup,width:240},r.createElement(k.Z,i,a()(j.Z,{type:j.i.Vertical,initialFocus:void 0,sections:this.getMenuListSections(e)}))}},"pages-popup")}getStyle(){return{display:"flex",alignItems:"center",lineHeight:1.2,fontSize:this.props.isMobile?F.Z.fontSize.UIRegular.mobile:F.Z.fontSize.UIRegular.desktop,color:this.theme.lightTextColor,filter:"grayscale(70%)",...this.props.style}}getTitleStyle(){return{lineHeight:1.2,fontSize:this.props.isMobile?F.Z.fontSize.UISmall.mobile:F.Z.fontSize.UISmall.desktop,color:this.theme.lightTextColor}}}Le.displayName="SearchPathBreadcrumb",Le.iconStyle={marginRight:3},Le.dividerWrapStyle={display:"flex",alignItems:"center",flexShrink:0};const Ne={marginLeft:3,marginRight:3};class Oe extends l.Z{constructor(){super(...arguments),this.storeTypes={explanationModalOpen:c.default.createClass(!1)},this.styles={title:{fontWeight:F.Z.fontWeight.medium,lineHeight:"20px"},jumpToTitle:{fontWeight:F.Z.fontWeight.medium,fontSize:15,lineHeight:"20px"},menuItem:{minHeight:36,paddingTop:this.environment.device.isMobile?12:8,paddingBottom:this.environment.device.isMobile?12:8},textWrapper:{marginLeft:10,alignItems:void 0,flex:void 0,width:"100%"},inlineTextWrapper:{alignItems:"baseline"},highlight:{fontWeight:F.Z.fontWeight.medium},vectorHighlight:{fontWeight:F.Z.fontWeight.medium,whiteSpace:"pre-wrap"},enterIcon:{height:14,width:14},uniqueIDBadgeWrapper:{display:"flex",gap:8,marginRight:8,alignItems:"center"},caption:{marginTop:1},debugArea:{fontFamily:"monospace"},timestamp:{fontSize:F.Z.fontSize.UISmall.desktop,fontWeight:F.Z.fontWeight.regular},toolTip:{maxWidth:300},toolTipTitle:{fontWeight:F.Z.fontWeight.medium,fontSize:F.Z.fontSize.UISmall.desktop},toolTipText:{fontWeight:F.Z.fontWeight.medium,fontSize:F.Z.fontSize.UISmall.desktop,marginLeft:0,paddingRight:20},toolTipValue:{fontSize:F.Z.fontSize.UISmall.desktop,fontWeight:F.Z.fontWeight.regular},toolTipMenuItem:{minHeight:20}},this.debugHitCustomRenderer=e=>{let{data:t,keyPath:i}=e;if(2===i.length&&"_explanation"===i[0])return{element:r.createElement(r.Fragment,null,a()("button",{onClick:e=>{this.stores.explanationModalOpen.setState(!0),e.stopPropagation()}},void 0,"show simplified explanation")),expanded:!1};const n=t._ltrlog;if(n)return function(e){const t=Object.keys(e[0])[0],i=e[0][t].map(((e,t)=>{const i=t%2==0?We:Ue;return a()("tr",{},e.name,a()("td",{style:i},void 0,`${t}`),a()("td",{style:i},void 0,`${e.name}`),a()("td",{style:i},void 0,`${e.value}`))}));return{element:r.createElement(r.Fragment,null,a()("div",{},void 0,a()("b",{},void 0,`Featureset: ${t}`)),a()("div",{style:{maxHeight:200,overflowY:"scroll"}},void 0,a()("table",{style:{border:"1px solid black"}},void 0,i))),expanded:!1}}(n);if(!["_score","matched_queries"].every((e=>t[e])))return null;const{_score:o,matched_queries:s}=t;return{element:r.createElement(r.Fragment,null,`score ${o}, ${(s??[]).length} matched query clauses`),expanded:!1}}}renderComponent(){const{focused:e,isLastInSection:t,isBeforeFocused:i,inline:n,className:o}=this.props,s=this.styles,l=this.getThemeColors(),d={...s.menuItem,...!n&&!t&&!i&&!e&&l.menuItemBorder},c={...s.caption,...l.caption},u={...s.timestamp,...l.timestamp},m={...s.textWrapper,...this.props.inline&&s.inlineTextWrapper},p={title:this.renderTitle(),icon:this.renderIcon(),caption:this.renderCaption(),body:this.renderPreview(),right:this.renderRight(e),rightStyle:e?void 0:u,dontShrinkRight:!0,captionStyle:c,style:d,spacerStyle:this.hasPath()?void 0:ze,textWrapperStyle:m,className:re()("notranslate",o),buttonStyle:{paddingLeft:2},hoveredStyle:{background:this.theme.buttonHoveredBackground}};return(0,_e.Mk)()?a()(be.Z,{delayThreshold:50,disableTooltip:!0,placement:be.Z.Placement.Right,originGap:18,renderTooltip:()=>this.renderTooltip(),style:s.toolTip,render:e=>r.createElement(he.Z,b()({},this.props,p,{disableTransition:!0,ignoreLocalHoverState:!0},(0,we.Z)(e,this.props)))}):r.createElement(he.Z,b()({},this.props,p,{disableTransition:!0,ignoreLocalHoverState:!0}))}renderTooltip(){return a()(pe.Z,{store:this.props.store})}renderTitle(){var e;const{store:t,result:i,placeholder:n,index:o}=this.props,s=this.styles,r=this.getThemeColors(),l=void 0===i,d={...(null==i?void 0:i.sources.includes(U.vp.Local))&&0===o?s.jumpToTitle:s.title,...!l&&r.nonHighlightedTextColor},c=[];if(i&&i.highlight)if(c.push(...(0,Me.fe)(i.highlight.pathText)),this.usesFullPageIndexingHighlight())c.push(...(0,Me.fe)(i.highlight.title));else{Te.G.createChildStore(this.props.store,{table:ce.iU,id:i.id,spaceId:i.spaceId}).isNavigableBlock()&&c.push(...(0,Me.fe)(i.highlight.text))}const u=this.getWordHighlighter({words:c}),m=null===(e=(0,Ce.VP)(t))||void 0===e?void 0:e.isArchived(),p=(0,me.e)(i);return a()("div",{style:{display:"flex",justifyContent:"space-between",...d}},void 0,a()("div",{style:{display:"flex"}},void 0,p&&this.renderUniqueIdHighlight(i),a()(Se.Z,{style:d,store:t,placeholder:n,highlighter:u}),!1,m&&a()(ge.Z,{content:a()(A.FormattedMessage,{id:"globalSearch.result.archived.badge.text",defaultMessage:"Archived"}),style:Ke})))}renderUniqueIdHighlight(e){var t;const{focused:i}=this.props,n=null==e||null===(t=e.highlight)||void 0===t?void 0:t.uniqueId;if(!n)return;const o="dark"===this.environment.ThemeStore.state.mode,s=this.styles,r=this.getWordHighlighter({words:[n]}),l=i?o?le.FN.dark.translucentGray[300]:le.se.light.darkgray.alpha(.09):o?le.FN.dark.translucentGray[200]:le.se.light.darkgray.alpha(.06);return a()("div",{style:s.uniqueIDBadgeWrapper},void 0,a()("div",{},void 0,a()(fe.Z,{text:n,highlighter:r})),a()("div",{style:{borderRight:`1.5px solid ${l}`,height:14,borderRadius:1}}))}renderRight(e){const{result:t}=this.props,i=Boolean(t);return a()("div",{style:{display:"flex",width:i?this.styles.enterIcon.width:void 0}},void 0,e?this.renderEnterIcon():this.renderTimestamp())}renderTimestamp(){const{result:e,lastViewed:t}=this.props;if(!e&&t)return(0,ke.IS)(t,{useCompactFormat:!0})}renderIcon(){const{store:e}=this.props,t=e.getIcon();if(t&&de.V2(t.icon)){const e=(0,ue.NV)({httpUrl:h.default.domainBaseUrl,protocol:h.default.protocol,includePort:!0}),i={width:20,height:20,objectFit:"cover",borderRadius:3,transition:"opacity 100ms ease-out"};return a()("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:20,width:20,borderRadius:"0.25em",flexShrink:0},className:`${f.S94} notranslate`},void 0,a()("div",{},void 0,a()(ve.Z,{src:`${e}${t.icon}?mode=${this.theme.mode}`,style:{...i,background:void 0},onContextMenu:e=>e.preventDefault()})))}return r.createElement(r.Fragment,null,a()(D.Z,{disabled:!0,icon:e.getIcon(),isEmptyPage:e.isEmptyPage(),size:20,largeIcon:!0}))}renderCaption(){const{store:e,inline:t,result:i}=this.props,n=this.getWordHighlighter({words:(0,Me.fe)(i&&i.highlight&&i.highlight.pathText),removeDuplicate:!0}),{device:o}=this.environment,s=t||o.isMobile?0:2;return r.createElement(r.Fragment,null,a()(ye.Z,{store:e,extraLength:s,showFullPathInTooltip:!0,highlighter:n}))}renderPreview(){var e,t;const{result:i}=this.props;if(!i)return;if(!i.highlight)return;if(Te.G.createChildStore(this.props.store,{table:ce.iU,id:i.id,spaceId:i.spaceId}).isNavigableBlock()&&!this.usesFullPageIndexingHighlight())return;if(!i.highlight.text)return;const n=i.highlight.text,o=(0,Me.ZP)(n);if(this.usesFullPageIndexingHighlight()){const e=e=>e.filter(Me.il).map((e=>e[0].toLowerCase())),t=t=>void 0===t?[]:e((0,Me.ZP)(t)),n=[...new Set([...t(i.highlight.title),...t(i.highlight.pathText)])],a=e=>n.some((t=>t.includes(e)));if(e(o).every((e=>a(e))))return}const s=this.styles,l=null!==(e=i.sources)&&void 0!==e&&e.includes(U.vp.VectorDBBlock)||null!==(t=i.sources)&&void 0!==t&&t.includes(U.vp.VectorDBCollection)?s.vectorHighlight:s.highlight,d=this.getThemeColors();return r.createElement(r.Fragment,null,a()(fe.Z,{text:n,highlighter:{tokenize:e=>(0,Me.Vu)(o),style:{...l,...d.highlight}}}))}usesFullPageIndexingHighlight(){const{result:e}=this.props;return e&&!e.sources.includes(U.vp.Local)}getWordHighlighter(e){const{words:t,removeDuplicate:i}=e;if(0===t.length)return;const n={...this.styles.highlight,...this.getThemeColors().highlight},a=i?new Set:void 0;return{tokenize:e=>(0,Me.XT)({text:e,patterns:t,uniqueTokenHighlighterContext:a}),style:n}}renderEnterIcon(){const{device:e}=this.environment,{focused:t}=this.props,i=this.styles,n=this.getThemeColors();if(e.isMobile)return;const a={...i.enterIcon,...n.enterIcon,opacity:t?1:0};return Z.Z.enter(a)}hasPath(){const{hidePath:e,store:t}=this.props;return!e&&(0,ye.L)(t)}getThemeColors(){return{nonHighlightedTextColor:{color:this.theme.mediumTextColor},menuItemBorder:{boxShadow:`0 1px 0 ${this.theme.lightDividerColor}`},highlight:{color:this.theme.regularTextColor},enterIcon:{fill:this.theme.mediumIconColor},caption:{color:this.theme.mediumTextColor},timestamp:{color:this.theme.lightTextColor},toolTipTitle:{color:this.theme.mediumTextColor},toolTipText:{color:this.theme.regularTextColor},toolTipValue:{color:this.theme.lightTextColor}}}}Oe.displayName="SearchResultMenuItem",Oe.contextTypes={...T.mw,...l.w};const Ve=Oe,Ue={paddingLeft:5,paddingRight:20,paddingTop:2,paddingBottom:2,border:"1px solid black",color:le.FN.dark.green[900]},We={...Ue,color:le.FN.dark.gray[30]};const Ke={fontWeight:F.Z.fontWeight.regular},ze={visibility:"hidden"};class Ge extends l.Z{constructor(){super(...arguments),this.storeTypes={isLoadingRecents:c.default.createClass(!1),endOfRecentsReached:c.default.createClass(!1)},this.renderComponent=()=>{if(!X.X4.state)return;const{device:e}=this.environment,t=this.defaultViewStyles,{currentSpaceStore:i}=V.default.state;if(!i)return;const n=(0,$.np)(),o=X.X4.state.filter((e=>e.pageId!==(null==n?void 0:n.id))),s={};o.forEach((e=>{let{pageId:t,visitedAt:i}=e;return s[t]=i}));const l=new Map;o.map(((t,i)=>{const n=X._5(t.visitedAt),a="Today"!==n&&"Yesterday"!==n,o={key:`${t.store.id}:${i}`,action:e=>this.props.onSelect({store:t.store,action:e}),render:i=>r.createElement(Ve,b()({},i,{inline:!e.isMobile,store:t.store,hidePath:!1,lastViewed:a?s[t.store.id]:void 0,buttonStyle:{paddingLeft:1}}))};var d;l.has(n)?null===(d=l.get(n))||void 0===d||d.push(o):l.set(n,[o])}));const d=[];for(const[r,u]of l.entries()){const e=this.getMessageFromBucket(r),i={key:r,items:u,render:i=>a()(Y.Z,{title:e,desktopTitleStyle:t.sectionHeader,disableDesktopPadding:!0,style:t.section},void 0,i.children)};d.push(i)}const c=!e.isMobile&&o.length>0;return r.createElement(r.Fragment,null,a()("div",{style:t.wrapper},void 0,a()(j.Z,{type:j.i.Vertical,initialFocus:0,disableKeyboardArrowWrap:!0,sections:d,unfocusOnScroll:!0}),a()(Q.Z,{onChange:this.handleScrollOffsetChange})),c&&a()(ae,{title:a()(oe,{})}))},this.handleScrollOffsetChange=e=>{this.getLastPageTimestamp()&&e<=200&&!this.stores.isLoadingRecents.state&&!this.stores.endOfRecentsReached.state&&this.loadMoreRecents()},this.loadMoreRecents=s().throttle((async()=>{const e=this.getLastPageTimestamp(),{currentSpaceStore:t}=V.default.state,i=this.environment.currentUser.id,n=null==t?void 0:t.id;if(!i||!n||!e)return;this.stores.isLoadingRecents.setState(!0);const a=await X.Od(e,{environment:this.environment,userId:i,spaceId:n});this.stores.isLoadingRecents.setState(!1),a||this.stores.endOfRecentsReached.setState(!0)}),300),this.defaultViewStyles={wrapper:{width:"100%",height:"100%",overflowX:"hidden",overflowY:"auto"},sectionHeader:{fontWeight:F.Z.fontWeight.semibold,marginBottom:7,marginLeft:2},section:{marginBottom:18}}}getLastPageTimestamp(){const{currentSpaceStore:e}=V.default.state;if(!e)return;const t=J.Z.getWithoutSubscribing(e.id),i=t[t.length-1];return null==i?void 0:i.visitedAt}getMessageFromBucket(e){switch(e){case"Today":return a()(A.FormattedMessage,{id:"globalSearch.recentPagesTimeBuckets.today.text",defaultMessage:"Today"});case"Yesterday":return a()(A.FormattedMessage,{id:"globalSearch.recentPagesTimeBuckets.yesterday.text",defaultMessage:"Yesterday"});case"Past Week":return a()(A.FormattedMessage,{id:"globalSearch.recentPagesTimeBuckets.pastWeek.text",defaultMessage:"Past Week"});case"Past 30 Days":return a()(A.FormattedMessage,{id:"globalSearch.recentPagesTimeBuckets.past30Days.text",defaultMessage:"Past 30 Days"});case"Older":return a()(A.FormattedMessage,{id:"globalSearch.recentPagesTimeBuckets.older.text",defaultMessage:"Older"})}(0,H.t1)(e)}}Ge.displayName="SearchDefaultBody";const qe=Ge;var He=i(87531),je=i(99417),Qe=i(29798),Ye=i(53953),$e=i(63296),Xe=i(77907),Je=i(32470);class et extends l.Z{constructor(){super(...arguments),this.storeTypes={requestModalOpen:c.default.createClass(!1),responseModalOpen:c.default.createClass(!1)},this.styles={footer:()=>{const{device:e}=this.environment;return{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",fontSize:e.isMobile?F.Z.fontSize.UIRegular.mobile:F.Z.fontSize.UIRegular.desktop}},footerText:{fontSize:ie.yv(this.environment,"UISmall"),...F.Z.textOverflowStyle},inlineHint:{display:"inline",marginRight:16},resultCountWrapper:{display:"flex",alignItems:"center",...F.Z.textOverflowStyle},resultCount:{fontWeight:F.Z.fontWeight.medium},resultText:{verticalAlign:"middle",marginRight:6},spinner:{display:"inline",width:12,height:12,verticalAlign:"middle"},keyboardShortcut:{marginRight:4,marginBottom:1,fontVariant:"all-small-caps",fontSize:1.1*ie.yv(this.environment,"UISmall")},commandGlyph:{fontSize:.75*ie.yv(this.environment,"UIRegular")},footerDebugButton:ne(this.theme),debugModalStyle:{maxHeight:"90vh",maxWidth:"90vw",height:"90vh",width:"90vw",overflow:"scroll",padding:10},navigationHints:{marginLeft:15}}}renderComponent(){const{shouldShow:e}=this.props;if(!e)return;const t=this.styles,i=this.getThemeColors(),n={...t.resultCount,...i.resultCount},{count:o,isLowerBound:s}=this.props.searchResultStore.getResultCount(),l=a()("span",{style:t.resultText},void 0,s?this.props.intl.formatMessage({id:"SearchResultsFooter.helpText.resultCountApproximate",defaultMessage:"{resultCount, plural, other {<resultwrapper>{resultCount}+</resultwrapper> results}}"},{resultCount:o,resultwrapper:e=>a()("span",{style:n},void 0,e)}):this.props.intl.formatMessage({id:"SearchResultsFooter.helpText.resultCount",defaultMessage:"{resultCount, plural, one {<resultwrapper>{resultCount}</resultwrapper> result} other {<resultwrapper>{resultCount}</resultwrapper> results}}"},{resultCount:o,resultwrapper:e=>a()("span",{style:n},void 0,e)})),d=a()("div",{style:t.resultCountWrapper},void 0,l,this.renderSpinner(this.props.showSpinner),a()("div",{style:t.navigationHints},void 0,a()(oe,{})));return a()(ae,{title:d,right:r.createElement(r.Fragment,null,this.renderSearchDebugButtons())})}renderSpinner(e){const t=this.styles;return a()(R.Z,{show:e,showDelay:500,showHold:200,render:e=>e&&a()(B.Z,{style:t.spinner})})}renderSearchDebugButtons(){var e;if(!Je.ZP.state.debug&&!Je.ZP.state.showDebugInfo)return;const{rawRequests:t,rawResponses:i}=(null===(e=this.props.searchResultStore.state.serverResults)||void 0===e||null===(e=e.debugInfo)||void 0===e?void 0:e.response)||{};return r.createElement(r.Fragment,null,t&&r.createElement(r.Fragment,null,a()(Ye.Z,{open:this.stores.requestModalOpen.state,innerStyle:this.styles.debugModalStyle,onDismiss:()=>{this.stores.requestModalOpen.setState(!1)},render:()=>a()(Xe.LazyAdminReactJson,{showCopyButton:"large",defaultCollapsed:!1,data:t})}),a()($e.Z,{style:this.styles.footerDebugButton,onClick:()=>this.stores.requestModalOpen.setState(!0)},void 0,"Open Request")),i&&r.createElement(r.Fragment,null,a()(Ye.Z,{open:this.stores.responseModalOpen.state,innerStyle:this.styles.debugModalStyle,onDismiss:()=>{this.stores.responseModalOpen.setState(!1)},render:()=>a()(Xe.LazyAdminReactJson,{showCopyButton:"large",data:{rawResponses:i},defaultCollapsed:!1})}),a()($e.Z,{style:this.styles.footerDebugButton,onClick:()=>this.stores.responseModalOpen.setState(!0)},void 0,"Open Response")))}getThemeColors(){return{footerText:{color:this.theme.lightTextColor},resultCount:{color:this.theme.mediumTextColor},keyboardShortcut:{color:this.theme.mediumTextColor}}}}et.displayName="SearchResultsFooter";const tt=(0,A.injectIntl)(et);var it=i(43765),nt=i(64369);function at(e){window.__c={n:"GlobalSearchActionMenuItem"};const{inline:t,title:i,icon:n,focused:a,isBeforeFocused:o,className:s}=e,l=(0,w.yK)((e=>({hoveredStyle:{background:e.buttonHoveredBackground}})),[]),d=(0,w.yK)((e=>({style:{minHeight:36,paddingTop:8,paddingBottom:8,...!t&&!o&&!a&&{boxShadow:`0 1px 0 ${e.lightDividerColor}`}},textWrapper:{marginLeft:10,alignItems:void 0,flex:void 0,width:"100%",display:"block",textOverflow:"ellipsis",...t&&{alignItems:"baseline"}},icon:{display:"block",flexShrink:0,height:18,width:18,color:e.mediumTextColor},enterIcon:{height:14,width:14,fill:e.mediumIconColor},iconContainer:{marginTop:1}})),[a,t,o]),c={title:i,icon:ot(n,d.icon,d.iconContainer),style:d.style,textWrapperStyle:d.textWrapper,right:st(a,d.enterIcon),className:re()("notranslate",s),buttonStyle:{paddingLeft:2},hoveredStyle:l.hoveredStyle};return r.createElement(he.Z,b()({},e,c,{disableTransition:!0,ignoreLocalHoverState:!0}))}function ot(e,t,i){return a()(nt.Z,{style:i},void 0,e(t))}function st(e,t){const i={...t,opacity:e?1:0};return a()("div",{style:{display:"flex"}},void 0,Z.Z.enter(i))}var rt=i(39634),lt=i(16354),dt=i(36507);class ct extends l.Z{constructor(){super(...arguments),this.handleSendMessageClick=()=>{rt.j({environment:this.environment,from:"quick_find"})},this.styles={menuItem:{marginTop:"auto",marginBottom:"auto"},caption:{marginTop:"auto"},reportProblemButton:{display:"inline"},searchDeletedButton:{display:"inline",lineHeight:"25px"}}}renderComponent(){return r.createElement(dt.Z,b()({},this.getErrorMessage(),{style:this.styles.menuItem,captionStyle:this.styles.caption,shouldWrapCaption:!0}))}renderNoResults(){return{title:ct.noResultsTitle,caption:this.renderNoResultsMessage()}}renderNoResultsMessage(){const e=z.state.query.filters,t=N.FN(e);if(!N.VD.isDeletedOnly(e.isDeletedOnly)){const e=this.styles,t=this.getThemeColors(),i={...e.searchDeletedButton,...t.searchDeletedButton};return a()(A.FormattedMessage,{id:"globalSearchErrorMenuItem.errorPrompt.searchDeleted",defaultMessage:"Some results may be in your deleted pages.{br}<searchdeleted>Search deleted pages</searchdeleted>",values:{searchdeleted:e=>a()(lt.Z,{onClick:this.props.handleSearchDeletedOnly,style:i},void 0,e),br:a()("br",{})}})}return a()(A.FormattedMessage,t?{defaultMessage:"Try different search terms or filters",id:"globalSearchErrorMenuItem.errorPrompt.searchTermsAndFilters"}:{defaultMessage:"Try different search terms",id:"globalSearchErrorMenuItem.errorPrompt.searchTerms"})}renderOffline(){return{title:ct.noResultsTitle,caption:a()(A.FormattedMessage,{defaultMessage:"Go online for more results.",id:"globalSearchErrorMenuItem.errorPrompt.goOnline"})}}renderRequestFailed(){const e=this.styles,t=this.getThemeColors(),i={...e.reportProblemButton,...t.reportProblemButton};return{title:a()(A.FormattedMessage,{id:"globalSearchErrorMenuItem.error.genericErrorMessage",defaultMessage:"Something went wrong"}),caption:a()(A.FormattedMessage,{id:"globalSearchErrorMenuItem.errorPrompt.refreshOrReport",defaultMessage:"Try refreshing or <reportlink>report a problem</reportlink>.",values:{reportlink:e=>a()(lt.Z,{onClick:this.handleSendMessageClick,style:i},void 0,e)}})}}getErrorMessage(){const{error:e}=this.props;switch(e.type){case U.Ix.NoResults.type:return this.renderNoResults();case U.Ix.Offline.type:return this.renderOffline();case U.Ix.RequestFailed.type:return this.renderRequestFailed();default:(0,H.t1)(e)}}getThemeColors(){return{reportProblemButton:{color:this.theme.blueColor},searchDeletedButton:{color:this.theme.blueColor}}}}ct.displayName="SearchErrorMenuItem",ct.contextTypes={...T.mw,...l.w},ct.noResultsTitle=a()(A.FormattedMessage,{defaultMessage:"No results",id:"globalSearchErrorMenuItem.error.noResults"});const ut=ct;function mt(e){if(e){switch(e){case"local":return a()(A.FormattedMessage,{id:"globalSearch.searchResultBuckets.recent.text",defaultMessage:"Jump back in"});case"server":return a()(A.FormattedMessage,{id:"globalSearch.searchResultBuckets.server.text",defaultMessage:"More results"});case"actions":return a()(A.FormattedMessage,{id:"globalSearch.searchActions.actions.text",defaultMessage:"Actions"});case"unique_id":return a()(A.FormattedMessage,{id:"globalSearch.searchResultBuckets.uniqueID.text",defaultMessage:"ID matches"});case"main":return a()(A.FormattedMessage,{id:"globalSearch.searchResultBuckets.bestMatches.text",defaultMessage:"Best Matches"})}(0,H.t1)(e)}}function pt(e,t,i,n){const{store:a}=e,o=a.isNavigableBlock()?a:a.getNavigableBlockStore();if(o)return{key:`${a.id}:${t}`,action:t=>{n.handleSelectResult({store:a,action:t,selectedResult:e,allSearchResults:i})},render:i=>r.createElement(Ve,b()({},i,{index:t,originalPosition:e.originalPosition,isFirstInSection:0===t,store:o,hidePath:!1,result:e,className:f.ulv,inline:!1}))}}const gt=(0,A.injectIntl)((function(e){var t;window.__c={n:"GlobalSearchResultsMenuList"};const[i,n]=(0,r.useState)(!1),o=(0,ee.Fy)().isMobile,l=(0,w.yK)((e=>({results:{flex:1,display:"flex",flexDirection:"column",overflow:"auto",height:"100%"},messageMenuItem:{...o&&{background:void 0,boxShadow:void 0}},actionMenuItemTitle:{fontWeight:F.Z.fontWeight.medium,lineHeight:"20px",fontSize:15,color:e.mediumTextColor,textOverflow:"ellipsis",overflow:"hidden",display:"block"},menuListContainer:{display:"flex",flexDirection:"column",gap:12,marginTop:o?13:void 0}})),[o]),{results:d,resultListStore:c,intl:u,showActions:m}=e,p=e.errorState,g=(0,M.VK)((()=>z.state.query.text),[]),h=m.length>0?{key:"actions",render:e=>r.createElement(Y.Z,b()({},e,{shouldShowBottomDivider:!1,disableDesktopPadding:!0,disableMobilePadding:!0,disableMobileBorders:!0,title:mt("actions")})),items:s().compact(m.map((e=>function(e){const{type:t,title:i,icon:n,action:a}=e;return{key:`actionMenuItem.${t}`,action:a,render:e=>r.createElement(at,b()({},e,{title:i,icon:n}))}}({...e,title:e.renderTitle(g,u,l.actionMenuItemTitle)}))))}:void 0,f=(0,M.VK)((()=>d?d.filter((e=>e.sources.includes(U.vp.ElasticsearchUniqueID))):[]),[d]),v=(0,r.useMemo)((()=>new Set(f.map((e=>e.id)))),[f]),y=(0,M.VK)((()=>f.length>0?{key:"uniqueIdSearchResultSection",render:e=>r.createElement(Y.Z,b()({},e,{shouldShowBottomDivider:!1,disableDesktopPadding:!0,disableMobilePadding:!0,disableMobileBorders:!0,title:mt("unique_id")})),items:s().compact(f.map(((t,i)=>pt(t,i,f,e))))}:void 0),[f,e]),S=(0,M.VK)((()=>(d||[]).filter((e=>!v.has(e.id)))),[d,v]),C=(0,M.VK)((()=>[]),[]),_=(0,M.VK)((()=>{const t=(()=>{if(0!==v.size)return v.size>0?"main":void 0})();return S.length>0?{key:"mainSearchResultSection",render:e=>r.createElement(Y.Z,b()({},e,{shouldShowBottomDivider:!1,disableDesktopPadding:!0,disableMobilePadding:!0,disableMobileBorders:!0,title:mt(t)})),items:s().compact(S.map(((t,i)=>pt(t,i,S,e))))}:void 0}),[S,v.size,e]),k=(0,M.VK)((()=>C.length>0?{key:"serverOnlySearchResultSection",render:e=>r.createElement(Y.Z,b()({},e,{shouldShowBottomDivider:!1,disableDesktopPadding:!0,disableMobilePadding:!0,disableMobileBorders:!0,title:mt("server")})),items:s().compact(C.map(((t,i)=>pt(t,i,C,e))))}:void 0),[C,e]),T=[h,y,_,k].filter(H.$K),I=(0,r.useCallback)(((t,a)=>{const{onMaybeLoadMoreResults:o}=e,s=t<=200;s&&!i&&o(),n(s)}),[i,e]),P=_||k?(null==h||null===(t=h.items)||void 0===t?void 0:t.length)??0:0;return a()("section",{style:l.results},void 0,T&&a()("div",{className:"search-results-list"},void 0,a()(j.Z,{type:j.i.Vertical,initialFocus:P,store:c,disableKeyboardArrowWrap:!0,sections:T,style:l.menuListContainer})),function(e,t){if(e.isLoading)return;if(e.showMajorError)return a()(ut,{error:e.serverError,handleSearchDeletedOnly:()=>{}});if(e.serverError&&e.serverError!==U.Ix.NoResults)return function(e,t){return a()(Y.Z,{disableMobilePadding:!0,disableMobileBorders:!0},void 0,a()(it.Z,{title:e,style:t}))}(e.serverError.message,t)}(p,l.messageMenuItem)||a()(Q.Z,{onChange:I}))}));const ht=function(e){window.__c={n:"GlobalSearchResultsBody"};const{searchResultStore:t}=e,i=(0,ee.O7)(),n=(0,ee.Fy)(),o=(0,w.yK)((e=>({container:{display:"flex",flexDirection:"column",width:"100%",flex:1,overflow:"hidden"},askAiLabel:{color:e.aiPurpleColor,fontWeight:F.Z.fontWeight.semibold},askAiQuery:{fontWeight:F.Z.fontWeight.regular},askAiIcon:{fill:e.aiPurpleColor}})),[]),s=(0,M.qz)(void 0,Qe.Z),l=(0,M.VK)((()=>s.state.focus.indexGlobal),[s]),{handleSelectResult:d,globalFocusedIndex:c}=(0,r.useContext)(Ot),{localResults:u,serverResults:m,clusterInfo:p,debugInfo:g,serverResultsLoading:h,hasPublicAccessPermission:f,errorState:v,serverResultsAllLoaded:y}=(0,M.VK)((()=>{var e,n;const{hasPublicAccessPermission:a}=N.bC(i);return{localResults:t.state.localResults,serverResults:t.state.serverResults,serverResultsLoading:t.state.serverResultsLoading,clusterInfo:null===(e=t.state.serverResults)||void 0===e?void 0:e.clusterInfo,debugInfo:null===(n=t.state.serverResults)||void 0===n?void 0:n.debugInfo,hasPublicAccessPermission:a,errorState:t.state.errorState,serverResultsAllLoaded:t.state.serverResultsAllLoaded}}),[t,i]),S=!1===v.isLoading&&v.showMajorError,b=Boolean(u||m),C=(0,r.useCallback)((()=>{!h&&!y&&void 0!==m&&z.update((e=>({...e,limit:e.limit+20})))}),[h,y,m]),_=(0,M.VK)((()=>N.oO({localResults:null==u?void 0:u.results,serverResults:null==m?void 0:m.results})),[u,m]),k=(0,M.VK)((()=>[{type:"assistant",renderTitle:(e,t,i)=>function(e,t){return a()("div",{className:"notranslate",style:t},void 0,e)}(r.createElement(r.Fragment,null,a()("span",{},void 0,"Ask AI "),a()("span",{style:o.askAiQuery},void 0,e)),{...i,...o.askAiLabel}),icon:e=>Z.Z.sparkles({...e,...o.askAiIcon}),action:()=>{He.Ky({environment:i})},shouldShow:()=>(0,je.jp)(i.device)&&z.state.query.text.split(" ").length-1>=2&&z.state.query.text.length>6}].filter((e=>e.shouldShow(i)))),[i,o],{useDeepEqual:!0}),T=(0,r.useCallback)((()=>s.update((e=>e.focus.isInitialized&&0===e.focus.section&&0===e.focus.indexLocal&&0===e.focus.indexGlobal?e:{...e,focus:k.length>0?{section:1,indexLocal:0,indexGlobal:k.length}:{section:0,indexLocal:0,indexGlobal:0}}))),[s,k]);return(0,r.useEffect)((()=>{T()}),[_,T]),(0,r.useEffect)((()=>{c.setState(l)}),[c,l]),a()("div",{style:o.container},void 0,a()(gt,{errorState:v,handleSelectResult:d,onMaybeLoadMoreResults:C,resultListStore:s,results:_,debugInfo:g,clusterInfo:p,publicAccessPermission:f,showActions:k}),a()(tt,{searchResultStore:t,combinedResults:_,showSpinner:h,shouldShow:!S&&b&&!n.isMobile}))};function ft(){window.__c={n:"GlobalSearchNavigationalView"};const{handleRecentPageSelect:e,searchResultStore:t}=(0,r.useContext)(Ot),{hasQuery:i}=(0,M.VK)((()=>({hasQuery:Boolean(z.state.query.text.trim())||N.VA(z.state.query.filters)})),[]),n={searchResultStore:t};return r.createElement(r.Fragment,null,i?r.createElement(ht,n):a()(qe,{onSelect:e}))}var vt=i(59054),yt=i(63143),St=i(68120),bt=i(29987);function Mt(e){let{dependencies:t,debugColumnStore:i,localDebounce:n=25,serverDebounce:a=275,searchResultStore:o,localSearchCache:l,permanentFilterOverride:d,enabled:c}=e;const u=(0,ee.O7)(),m=(0,M.VK)((()=>function(e){const{debugColumnStore:t}=e;return{shouldSearchLocal:!0,forcedClusterPattern:t.state.forcedClusterPattern,searchExperimentOverrides:t.state.searchExperimentOverrides,forcedBlockIds:t.state.forcedBlockIds}}({isOnline:t.isOnline,debugColumnStore:i})),[t.isOnline,i]),p=(0,r.useMemo)((()=>s().debounce(wt,a)),[a]);(0,vt.r5)((()=>c?async function(e){const{query:t,openAsPage:i,store:n,fetchServerResultsFn:a}=e;if(i&&s().isEqual(t,n.state.selectedQueryResultQuery))return;n.update((e=>({...e,localResults:e.localResults}))),function(e){const{shouldSearchLocal:t,parentStore:i,environment:n,query:a,limit:o,hasPublicAccessPermission:r,isOnline:l,localSearchCache:d,store:c,permanentFilterOverride:u}=e;let m;const p={...a,filters:{...a.filters,...u}};if(t){var g;m=N.b9(function(e){const{parentStore:t,requestInput:i,isOnline:n,environment:a,hasPublicAccessPermission:o,localSearchCache:s}=e,{query:r}=i;if(!s)return;if(!r.text.trim())return;if(o)return;const l=bt.default.mark("rum.local_quick_search_query"),d=void 0,c=N.Y_({query:i,localCachedPages:s,parentStore:t,environment:a,isOnline:n,shouldLimitLocalResultsWhenOnline:!0,applyScoreThresholdWhenOnline:!0,maxLocalResultsOverride:d});return bt.default.measure(l,{environment:a}),c}({parentStore:i,environment:n,requestInput:{query:p,limit:o},hasPublicAccessPermission:r,isOnline:l,localSearchCache:d})),s().isEmpty(null===(g=m)||void 0===g?void 0:g.results)&&(0,y.Xx)(c.state)&&c.state.serverResultsLoading?c.update((e=>({...e,clearLocalResultsOnServerResponse:!0}))):c.update((e=>({...e,clearLocalResultsOnServerResponse:!1,localResults:m})))}}(e),await a(e)}({...t,...m,store:o,fetchServerResultsFn:p,environment:u,localSearchCache:l,permanentFilterOverride:d}):Promise.resolve()),[t,m,o,p,u,l,d,c],{debounce:n})}async function wt(e){let{parentStore:t,environment:i,query:n,isOnline:a,publicAccessPermissionAncestorBlockId:o,currentSpaceStore:r,searchSessionId:l,searchExperimentOverrides:d,forcedClusterPattern:c,recentPagesForBoosting:u,store:m,forcedBlockIds:p,limit:g,permanentFilterOverride:h}=e;const f={query:{...n,filters:{...n.filters,...h}},limit:g};m.update((e=>({...e,serverResultsLoading:!0})));const v=m.state.serverResults,y=await async function(e){const{parentStore:t,requestInput:i,isOnline:n,environment:a,publicAccessPermissionAncestorBlockId:o,searchSessionId:s,source:r,spaceId:l,searchExperimentOverrides:d,forcedClusterPattern:c,recentPagesForBoosting:u,forcedBlockIds:m}=e,{query:p}=i;if(!p.text.trim()&&!N.FN(p.filters))return;if(!n)return{error:U.Ix.Offline};const g=bt.default.mark("rum.server_quick_search_query"),h=await N.MS({environment:a,input:i,spaceId:l,publicAccessPermissionAncestorBlockId:o,searchSessionId:s,source:r,searchExperimentOverrides:d,forcedClusterPattern:c,recentPagesForBoosting:"on"===(null==d?void 0:d["search-debug-only-no-recent-boosting"])?[]:u,forcedBlockIds:m});if(!h)return;if("failed"===h.type)return h.offline?{error:U.Ix.Offline}:{error:U.Ix.RequestFailed};const f=h.data.trackEventProperties,v=(0,St.Qr)(f)?{}:(0,yt.m8)((0,H.Yd)(f).map((e=>[`server-${e}`,f[e]]))),y=h.data.results.map(((e,i)=>({...e,serverEventProperties:v,originalPosition:i,store:Te.G.createChildStore(t,{table:ce.iU,id:e.id})})));return bt.default.measure(g,{environment:a}),{value:{results:y,total:h.data.total,debugInfo:h.data.debug,serverEventProperties:v,clusterInfo:h.data.clusterInfo}}}({parentStore:t,environment:i,requestInput:f,spaceId:null==r?void 0:r.id,searchSessionId:l,publicAccessPermissionAncestorBlockId:o,isOnline:a,source:void 0,searchExperimentOverrides:d,forcedClusterPattern:c,recentPagesForBoosting:u,forcedBlockIds:p}),S={query:{...z.state.query,filters:{...z.state.query.filters,...h}},limit:z.state.limit};if(!s().isEqual(f,S))return;const b=N.b9(y),M=v?N.Nu({existingResults:v,newPageResults:b}):b;if(y&&!y.error){const e=y.value.results;m.update((t=>({...t,serverError:null==y?void 0:y.error,serverResultsLoading:!1,serverResults:M,serverResultsAllLoaded:e.length<g,serverEventProperties:y.value.serverEventProperties,localResults:t.clearLocalResultsOnServerResponse?void 0:t.localResults,clearLocalResultsOnServerResponse:!1})))}else m.update((e=>({...e,serverError:null==y?void 0:y.error,serverResultsLoading:!1,serverResults:void 0,serverEventProperties:void 0,localResults:e.clearLocalResultsOnServerResponse?void 0:e.localResults,clearLocalResultsOnServerResponse:!1})))}const Ct={taskDB:{ancestors:["e02ed201-e893-4279-8bac-6b872dabf955"]},projectsDB:{ancestors:["37cedb80-b4aa-4674-b0b3-1e8c67f0be86"]},docsDB:{ancestors:["e6dce471-f27c-43fb-b28e-40d293f86f8c"]},searchTeam:{ancestors:["a02dd678-839d-4a63-9b74-a37f11df723f"]}},_t=!1;function kt(){const e=(0,ee.O7)(),{searchResultStore:t,secondarySearchResultStore:i,searchCreatedByMeResultStore:n,searchTaskDBResultStore:a,searchProjectsResultStore:o,searchDocsResultStore:s,searchSearchTeamResultStore:l}=(0,r.useContext)(Ot),{parentStore:d}=(0,r.useContext)(Vt),c=function(e){const t=(0,ee.O7)();return(0,M.VK)((()=>{const{hasPublicAccessPermission:i,publicAccessPermissionAncestorBlockId:n}=N.bC(t);return{isOnline:Boolean(P.Z.state.online),limit:z.state.limit,parentStore:e,hasPublicAccessPermission:i,publicAccessPermissionAncestorBlockId:n,currentSpaceStore:V.default.state.currentSpaceStore,debug:void 0,openAsPage:!1,recentPagesForBoosting:[],searchSessionId:void 0,searchMode:"default",currentSpaceViewStore:V.default.state.currentSpaceViewStore,query:z.state.query}}),[t,e])}(d),[{value:u}]=(0,vt.r5)((()=>c.hasPublicAccessPermission?Promise.resolve(void 0):c.currentSpaceStore?N.hb({environment:e,currentSpaceStore:c.currentSpaceStore,currentSpaceViewStore:c.currentSpaceViewStore,excludeCurrentPage:!0}):Promise.resolve(void 0)),[e,c.currentSpaceStore,c.currentSpaceViewStore,c.hasPublicAccessPermission]);Mt({dependencies:c,searchResultStore:t,localSearchCache:u,debugColumnStore:Je.v_,enabled:!0}),Mt({dependencies:c,searchResultStore:i,localSearchCache:u,debugColumnStore:Je.BJ,enabled:!1});const m=(0,M.VK)((()=>{var e;const t=null===(e=V.default.state.currentUserRootStore)||void 0===e?void 0:e.id;return{createdBy:t?[t]:[]}}),[]);Mt({dependencies:c,searchResultStore:n,localSearchCache:u,debugColumnStore:Je.v_,permanentFilterOverride:m,enabled:_t}),Mt({dependencies:c,searchResultStore:a,localSearchCache:u,debugColumnStore:Je.v_,permanentFilterOverride:Ct.taskDB,enabled:_t}),Mt({dependencies:c,searchResultStore:o,localSearchCache:u,debugColumnStore:Je.v_,permanentFilterOverride:Ct.projectsDB,enabled:_t}),Mt({dependencies:c,searchResultStore:s,localSearchCache:u,debugColumnStore:Je.v_,permanentFilterOverride:Ct.docsDB,enabled:_t}),Mt({dependencies:c,searchResultStore:l,localSearchCache:u,debugColumnStore:Je.v_,permanentFilterOverride:Ct.searchTeam,enabled:_t})}function Tt(e){return window.__c={n:"GlobalSearchContentPane"},kt(),a()(_.Z,{capture:!0,ignoreBlockSelection:!0,focusOffscreenInput:!1,restoreSelection:!0,render:()=>a()(C.Z,{capture:!0,allowMenuList:!0,render:t=>r.createElement(It,b()({},e,{ignoreAreaEvents:t}))})})}function It(e){window.__c={n:"GlobalSearchContentPaneInner"};const{ignoreAreaEvents:t}=e,{handleQueryChange:i,searchResultStore:n,globalFocusedIndex:o}=(0,r.useContext)(Ot),s=(0,w.yK)((e=>({body:{flex:1,overflow:"hidden",display:"flex",flexDirection:"column"},topbar:{height:void 0,marginTop:10,marginLeft:16,marginBottom:10,marginRight:16},topbarButton:{fontWeight:void 0,padding:0,color:e.mediumTextColor},scroller:{display:"flex",flexDirection:"row",flexWrap:"nowrap",justifyContent:"space-between",maxHeight:"100vh"},clearButton:{color:e.lightTextColor}})),[]),[l,d]=(0,r.useState)(!1),{shouldShowSpinner:c}=(0,M.VK)((()=>({shouldShowSpinner:Boolean(P.Z.state.online)&&Boolean(z.state.query.text)&&n.state.serverResultsLoading&&!l,hasQuery:Boolean(z.state.query.text.trim())})),[l,n]),u=(0,I.zY)(),m=(0,r.useMemo)((()=>a()(q,{isOpen:!0,onTypingChange:d,showSpinner:c,onQueryChange:i,searchResultStore:n,focusedIndexStore:o,window:u})),[c,u,i,n,o]),p=(0,r.useMemo)((()=>({menuType:T.og.Popup,maxHeight:"100%",maxWidth:"100%",minHeight:50,disableScroller:!0,scrollerStyle:s.scroller,...t})),[s,t]);return r.createElement(k.Z,b()({},p,{className:f.Oau}),a()("div",{style:s.body},void 0,m,a()(ft,{})))}var Pt=i(62134),Zt=i(45023),xt=i(22294);function Ft(e){window.__c={n:"GlobalSearchKeyboardShortcutStackListener"};const t=(0,I.zY)(),i=(0,ee.O7)(),n=(0,r.useCallback)((e=>{Pt.Zm(i,e)}),[i]),a=(0,r.useCallback)((e=>{const{shortcutMap:t}=i.KeyboardShortcutStackStore,n=s().findKey(t,((t,n)=>(0,Zt.Z)(i,e,t)));if(n&&!{cut:!0,copy:!0,paste:!0}[n]){if("esc"===n)return void g.closeGlobalSearchModal();Pt.dJ(i,e,n)}}),[i]),o=(0,r.useCallback)((()=>{xt.Z.setKeyboardMode(!1)}),[]);return(0,r.useEffect)((()=>t?(t.addEventListener("mousemove",o),t.addEventListener("keydown",a),t.addEventListener("cut",n),t.addEventListener("copy",n),t.addEventListener("paste",n),t.addEventListener("keypress",n),()=>{t.addEventListener("mousemove",o),t.removeEventListener("keydown",a),t.removeEventListener("cut",n),t.removeEventListener("copy",n),t.removeEventListener("paste",n),t.removeEventListener("keypress",n)}):()=>{}),[o,a,n,t]),null}var At=i(23078),Et=i.n(At),Bt=i(58710),Dt=i(27186);const Rt={};function Lt(e){window.__c={n:"ChildWindow"};const t=e.name.startsWith("Notion")?e.name:`Notion - ${e.name}`,[i,n]=(0,r.useState)(!0),[o,s]=(0,r.useState)({id:Bt.sI.length++});function l(){const e=Bt.r1.get(o);Bt.Ni(e)}(0,r.useEffect)((()=>(Bt.sI.push(o),()=>{Bt.sI.splice(Bt.sI.indexOf(o),1)})),[o]);const d=e.features||Rt,c=!1===e.draggableTop?null:a()("div",{style:{width:"100vw",height:"20px",appRegion:"drag"}});return a()(Et(),{onOpen:function(t){Bt.r1.set(o,t),e.onOpen&&e.onOpen(t),t.addEventListener("focus",l),t.addEventListener("mousemove",Dt.Js),t.addEventListener("mousedown",Dt.HY)},onUnload:function(){e.onUnload&&e.onUnload(),n(!1);const t=Bt.r1.get(o);null==t||t.removeEventListener("focus",l),null==t||t.removeEventListener("mousemove",Dt.Js),null==t||t.removeEventListener("mousedown",Dt.HY),Bt.Jj()===t&&Bt.Ni(void 0),Bt.r1.delete(o)},features:d,copyStyles:e.copyStyles,name:t,title:t},void 0,c,a()("div",{style:c?{marginTop:20}:void 0},void 0,i&&e.children))}function Nt(e){window.__c={n:"GlobalSearchWindow"};const[t,i]=(0,r.useState)(void 0);return a()(Lt,{name:"Notion Global Search Modal",onOpen:e=>{i(e)},draggableTop:!1,features:{show:!1,type:"panel",frame:!1,alwaysOnTop:!0}},void 0,a()(I.oB.Provider,{value:t},void 0,e.children))}const Ot=r.createContext(null),Vt=r.createContext(null);class Ut extends l.Z{constructor(){super(...arguments),this.searchResultStore=new y.ZP,this.secondarySearchResultStore=new y.ZP,this.searchCreatedByMeResultStore=new y.ZP,this.searchTaskDBResultStore=new y.ZP,this.searchProjectsResultStore=new y.ZP,this.searchDocsResultStore=new y.ZP,this.searchSearchTeamResultStore=new y.ZP,this.globalFocusedIndex=c.default.createValue(0),this.getStaticContext=s().memoize((()=>({handleSelectResult:this.handleQueryResultSelect,handleRecentPageSelect:this.handleRecentPageSelect,handleQueryChange:this.handleQueryChange,searchResultStore:this.searchResultStore,secondarySearchResultStore:this.secondarySearchResultStore,searchCreatedByMeResultStore:this.searchCreatedByMeResultStore,searchTaskDBResultStore:this.searchTaskDBResultStore,searchProjectsResultStore:this.searchProjectsResultStore,searchDocsResultStore:this.searchDocsResultStore,searchSearchTeamResultStore:this.searchSearchTeamResultStore,globalFocusedIndex:this.globalFocusedIndex}))),this.getStoresContext=s().memoize((e=>({parentStore:e}))),this.handleRecentPageSelect=e=>{this.handleSelectResult({...e,context:"recent_pages"})},this.handleQueryResultSelect=e=>{this.handleSelectResult({...e,context:"query_results"})},this.handleSelectResult=e=>{let{context:t,selectedResult:i,store:n}=e;"query_results"===t&&this.searchResultStore.update((e=>({...e,selectedQueryResultQuery:z.state.query})));const a=(0,p.Z)({pageModel:n.getModel(),pageId:n.id,baseUrl:h.default.domainBaseUrl,pageVisitSource:u.tY.SearchQuery});g.openPageFromGlobalSearch(a),g.closeGlobalSearchModal()},this.handleQueryChange=e=>{""!==e?z.updateQueryText(e):z.resetQuery()}}renderComponent(){const e=Boolean(v.Z.state.isGlobalSearchHost),t="light"===this.theme.mode?f.MsS:f.Xj_;return e?a()(Nt,{},void 0,a()(Ft,{}),a()(Ot.Provider,{value:this.getStaticContext()},void 0,a()(Vt.Provider,{value:this.getStoresContext(this.props.parentStore)},void 0,a()("div",{style:this.getStyle(),className:["notion-app-inner",t].join(" ")},void 0,a()(Tt,{onClose:()=>{}}))))):null}getStyle(){return{...(0,m.ZP)(d.SP),color:this.theme.regularTextColor,WebkitFontSmoothing:"auto",backgroundColor:this.theme.contentBackground}}}Ut.displayName="Search";const Wt=Ut},14568:(e,t,i)=>{i.d(t,{Z:()=>o});var n=i(35431);class a extends n.Z{}const o=new a},31075:(e,t,i)=>{i.d(t,{i:()=>g});var n=i(23174),a=i.n(n),o=(i(21703),i(67294),i(26825)),s=i(5366),r=i(50906),l=i(47307),d=i(76464),c=i(12359),u=i(64369),m=i(18878),p=i(29987);async function g(e){const{oldPermissionItem:t,newPermissionItem:i,wasInherited:n,environment:g,store:h,sudoModeStore:f,restrictingVisibility:v,fromPermissionWrapper:y}=e;if(!(0,o.Kf)(t,i))throw new Error("Permission type mismatch.");const S=!!f&&f.shouldSaveTransactionWithSudoMode(h),b=(0,o.nl)(t.role,i.role);if(n&&b!==i.role||v)return void(await async function(e){const{environment:t,useSudoMode:i,store:n,permissionItem:o,fromPermissionWrapper:r}=e,p="none"===o.role?{type:"remove",permissionItem:o}:{type:"restrict"},g="user_permission"===o.type&&o.user_id===t.currentUser.id;(g||await l.confirmUserAction({message:(0,m.mX)(p),acceptLabel:(0,m.nH)(p),cancelLabel:a()(s.FormattedMessage,{id:"restrictedPermissionConfirmationModal.actionButton.cancel",defaultMessage:"Close"}),description:a()(u.Z,{isSmall:!0,isMultiline:!0},void 0,a()(s.FormattedMessage,{id:"restrictedPermissionConfirmationModal.footer.whisperText",defaultMessage:"Admins will still be able to restore permissions from restricted pages."}))}))&&c.createAndCommit({userAction:"PermissionItem.onAccept",environment:t,useSudoMode:i,perform:e=>{d.Pk({environment:t,store:n,permissionItem:o,shouldInherit:!0,transaction:e,fromPermissionWrapper:r})}})}({environment:g,useSudoMode:S,store:h,permissionItem:i,fromPermissionWrapper:y}));!h.isTopLevel()&&t.role!==i.role&&b!==t.role&&r.SMF(g),c.createAndCommit({userAction:"PermissionItem.handlePermissionItemChange",environment:g,useSudoMode:S,perform:t=>{const n=p.default.mark("share_menu.update_page_permission_lag");d.ep({environment:g,store:h,permissionItems:[i],transaction:t,pagePermissionChangeLocation:e.location,metric:n,fromPermissionWrapper:y})}})}},22756:(e,t,i)=>{i.d(t,{Z:()=>o});var n=i(49085);class a extends n.default{getInitialState(){return{isModalOpen:!1,currentTab:"selectData",account:void 0,isAccountLinkingInProgress:!1,isAccountDelinkingInProgress:!1,workspaces:[],teamsAndProjects:[],selectedWorkspace:void 0,selectedProjectsAndTeamspaces:{},importCompletedTasks:!0,teams:void 0,loadMoreClicks:0,isLoadingProjects:!1,isLoadingAsanaWorkspaces:!1,result:void 0,isComplete:!1,loggerPageId:void 0,templateCreationInProgress:!1,isFetchingAsanaAccount:!1}}resetImport(){const{account:e,workspaces:t}=this.getState();this.setState({...this.getInitialState(),account:e,workspaces:t})}}const o=new a},74021:(e,t,i)=>{i.d(t,{Z:()=>o});var n=i(49085);class a extends n.default{getInitialState(){return{open:!1}}}const o=new a},17549:(e,t,i)=>{i.d(t,{Z:()=>o});var n=i(49085);class a extends n.default{getInitialState(){return{open:!1}}}const o=new a},85680:(e,t,i)=>{i.d(t,{Z:()=>o});var n=i(49085);class a extends n.default{getInitialState(){return{isOpen:!1}}}const o=new a},45214:(e,t,i)=>{i.d(t,{Z:()=>o});var n=i(49085);class a extends n.default{getInitialState(){return{open:!1}}}const o=new a},5188:(e,t,i)=>{i.d(t,{Z:()=>o});var n=i(49085);class a extends n.default{getInitialState(){return{open:!1}}}const o=new a},46096:(e,t,i)=>{i.d(t,{Z:()=>o});var n=i(49085);class a extends n.default{getInitialState(){return{open:!1}}}const o=new a},78900:(e,t,i)=>{i.d(t,{Z:()=>n});const n=new(i(61766).Z)},57222:(e,t,i)=>{i.d(t,{t:()=>n});const n=e=>({"en-US":{label:"English",caption:e.formatMessage({defaultMessage:"English (US)",id:"languagePicker.captions.englishUS"})},"de-DE":{label:"Deutsch",caption:e.formatMessage({defaultMessage:"German",id:"languagePicker.captions.germanDE"})},"ko-KR":{label:"한국어",caption:e.formatMessage({defaultMessage:"Korean",id:"languagePicker.captions.koreanKo"})},"zh-CN":{label:"简体中文",caption:e.formatMessage({defaultMessage:"Simplified Chinese",id:"languagePicker.captions.chineseS"})},"zh-TW":{label:"繁體中文",caption:e.formatMessage({defaultMessage:"Traditional Chinese",id:"languagePicker.captions.chineseT"})},"ja-JP":{label:"日本語",caption:e.formatMessage({defaultMessage:"Japanese",id:"languagePicker.captions.japaneseJa"})},"es-ES":{label:"Español (España)",caption:e.formatMessage({defaultMessage:"Spanish (Spain)",id:"languagePicker.captions.spanishEs"})},"es-LA":{label:"Español (Latinoamérica)",caption:e.formatMessage({defaultMessage:"Spanish (Latin America)",id:"languagePicker.captions.spanishLatam"})},"pt-BR":{label:"Português (Brasil)",caption:e.formatMessage({defaultMessage:"Portuguese (Brazil)",id:"languagePicker.captions.portugueseBr"})},"fr-FR":{label:"Français (France)",caption:e.formatMessage({defaultMessage:"French",id:"languagePicker.captions.frenchFr"})},"da-DK":{label:"Dansk",caption:e.formatMessage({defaultMessage:"Danish",id:"languagePicker.captions.danishDk"})},"fi-FI":{label:"Suomi",caption:e.formatMessage({defaultMessage:"Finnish",id:"languagePicker.captions.finnishFi"})},"nb-NO":{label:"Norsk",caption:e.formatMessage({defaultMessage:"Norwegian",id:"languagePicker.captions.norwegianNo"})},"nl-NL":{label:"Nederlands",caption:e.formatMessage({defaultMessage:"Dutch",id:"languagePicker.captions.dutchNl"})},"sv-SE":{label:"Svenska",caption:e.formatMessage({defaultMessage:"Swedish",id:"languagePicker.captions.swedishSe"})},pseudo:{label:"🤡Pseudolocale🤡",caption:e.formatMessage({defaultMessage:"Pseudolocale",id:"languagePicker.captions.pseudolocale"})}})}}]);