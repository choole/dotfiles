"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[7543],{98692:(i,t,e)=>{e.d(t,{Z:()=>v});var n=e(23174),a=e.n(n),s=e(67294),o=e(83355),r=e(8848),d=e(5366),l=e(91376),c=e(1865),u=e(62216),g=e(21115),f=e(78291),m=e(64921),b=e(61519),p=e(76844);class S extends o.Z{constructor(){super(...arguments),this.handleClick=i=>{if(!i)return l.r();c.y(this.environment,{from:"sidebar"===this.props.source?"block_limit_sidebar":"block_limit_settings",for:"plus"})}}renderComponent(){const{data:i}=f.default.state;if(!i)return;const t=g.GJ(i);if(0===g.Lz(this.environment,i))return;const e=g.zl(this.environment,i);return g.XZ(this.environment,i)?a()(s.Fragment,{},void 0,this.renderDivider("settings"===this.props.source),a()(m.Z,{style:S.buttonStyle,onClick:()=>this.handleClick(t)},void 0,a()("div",{style:S.headerStyle},void 0,a()(d.FormattedMessage,{id:"spaceSettings.sidebar.upgradeLink",defaultMessage:"Upgrade to go unlimited"})),a()("div",{style:S.labelStyle},void 0,a()("div",{style:this.usageLabelStyle(e)},void 0,g.cA(this.environment,i)),!(0,u.du)()&&a()(p.Z,{style:{marginTop:12,marginBottom:12},percent:e}),a()("div",{style:S.ctaStyle},void 0,this.renderCtaMessage(t))))):void 0}renderDivider(i){return a()(b.Z,i?{size:27,style:{paddingLeft:14,paddingRight:14}}:{size:0})}renderCtaMessage(i){return a()(d.FormattedMessage,i?{id:"spaceSettings.sidebar.button.upgrade",defaultMessage:"Upgrade plan"}:{id:"spaceSettings.sidebar.button.contactWorkspaceOwner",defaultMessage:"Contact a workspace owner"})}usageLabelStyle(i){return i>g.Tj&&!(0,u.du)()?(0,r.x7)("red",this.theme):{}}}S.displayName="BlockLimitUsage",S.buttonStyle={padding:14,fontSize:12,lineHeight:1.4},S.headerStyle={fontWeight:500,lineHeight:2},S.labelStyle={fontWeight:400},S.ctaStyle={textDecoration:"underline"};const v=S},76844:(i,t,e)=>{e.d(t,{Z:()=>r});var n=e(23174),a=e.n(n),s=e(96486),o=e.n(s);e(67294);const r=function(i){return i=o().assign({percent:.1},i),a()("div",{style:o().assign({position:"relative",minWidth:30,height:5,borderRadius:1,overflow:"hidden"},i.style)},void 0,a()("div",{style:{position:"absolute",top:0,left:0,height:"100%",width:"100%",background:"currentColor",opacity:.1}}),a()("div",{style:{position:"absolute",top:0,left:0,height:"100%",width:100*i.percent+"%",minWidth:2,background:"currentColor",opacity:.6}}))}},26234:(i,t,e)=>{e.d(t,{Z:()=>D});var n=e(23174),a=e.n(n),s=e(67294),o=e(480),r=e(81954),d=e(24405),l=e(53877),c=e(53397),u=e(5366),g=e(12359),f=e(1865),m=e(37181),b=e(38755),p=e(80554),S=e(21115),v=e(8323),h=e(70467),N=e(79315),y=e(64921),I=e(61519),L=e(76844);function x(i,t,e){if(e){if("warning"===t){if("settings"===i)return{disableWarningNotificationInSettings:!0,disableWarningNotificationInSidebar:e.disableWarningNotificationInSidebar,disableLimitNotificationInSettings:e.disableLimitNotificationInSettings,disableLimitNotificationInSidebar:e.disableLimitNotificationInSidebar,expirationDate:e.expirationDate};if("sidebar"===i)return{disableWarningNotificationInSettings:e.disableWarningNotificationInSettings,disableWarningNotificationInSidebar:!0,disableLimitNotificationInSettings:e.disableLimitNotificationInSettings,disableLimitNotificationInSidebar:e.disableLimitNotificationInSidebar,expirationDate:e.expirationDate}}if("limit_reached"===t){if("settings"===i)return{disableWarningNotificationInSettings:e.disableWarningNotificationInSettings,disableWarningNotificationInSidebar:e.disableWarningNotificationInSidebar,disableLimitNotificationInSettings:!0,disableLimitNotificationInSidebar:e.disableLimitNotificationInSidebar,expirationDate:e.expirationDate};if("sidebar"===i)return{disableWarningNotificationInSettings:e.disableWarningNotificationInSettings,disableWarningNotificationInSidebar:e.disableWarningNotificationInSidebar,disableLimitNotificationInSettings:e.disableLimitNotificationInSettings,disableLimitNotificationInSidebar:!0,expirationDate:e.expirationDate}}}return{disableWarningNotificationInSettings:"warning"===t&&"settings"===i,disableWarningNotificationInSidebar:"warning"===t&&"sidebar"===i,disableLimitNotificationInSettings:"limit_reached"===t&&"settings"===i,disableLimitNotificationInSidebar:"limit_reached"===t&&"sidebar"===i,expirationDate:(0,l.Xz)({date:Date.now(),daysToAdd:7})}}const w={padding:"4px 14px 8px 14px",fontSize:12,lineHeight:1.4},W={fontWeight:500,lineHeight:2,display:"flex"},k={fontWeight:400},C={textDecoration:"underline"};const D=function(i){window.__c={n:"AddOnLimitUsage"};const t=(0,p.MQ)(i.source),e=(0,h.l)(),n=(0,o.O7)(),D=(0,d.yK)((i=>({empty:{},cancelButton:{background:i.buttonHoveredBackground,borderRadius:"100%",width:20,height:20,display:"flex",alignItems:"center",justifyContent:"center",zIndex:10},dismissButton:{display:"flex",flexDirection:"row-reverse",position:"relative",top:10,right:-6},hovered:{background:i.buttonPressedBackground},closeIcon:{width:14,fill:i.mediumTextColor}})),[]),{membersCount:M,spaceName:O,settings:U,currentUserSettingsStore:_}=(0,r.VK)((()=>{var i;return{membersCount:(0,S.qX)(),spaceName:N.default.state.currentSpaceStore&&(0,b.rn)(n,N.default.state.currentSpaceStore),settings:null===(i=N.default.state.currentUserSettingsStore)||void 0===i||null===(i=i.getSettings())||void 0===i?void 0:i.addOnLimitNotifications,currentUserSettingsStore:N.default.state.currentUserSettingsStore}}),[n]),A=(0,r.VK)((()=>e?+e.spaceUsage/e.spaceLimit:0),[e]),{notificationType:Z,usageLabelStyles:z}=(0,r.VK)((()=>({notificationType:A>=p.Tq?"limit_reached":"warning",usageLabelStyles:D.empty})),[A,D.empty]);if(!_)return null;if(!t)return null;let F;"settings"===i.source&&M>=3&&(null!=U&&U.expirationDate?Date.now()<U.expirationDate&&(F=!0):(!function(i,t){g.createAndCommit({userAction:"addOnLimitNotifications.ai.initializeSettings",environment:i,perform:i=>{m.d2({transaction:i,userSettingsStore:t,data:{addOnLimitNotifications:{disableWarningNotificationInSettings:!1,disableWarningNotificationInSidebar:!1,disableLimitNotificationInSettings:!1,disableLimitNotificationInSidebar:!1,expirationDate:(0,l.Xz)({date:Date.now(),daysToAdd:7})}}})}})}(n,_),F=!0));const T=a()(u.FormattedMessage,"limit_reached"===Z?{id:"addOnLimitUsage.description.usedAllFreeResponses.admins",defaultMessage:"{spaceName} has used all their free AI responses.",values:{spaceName:O}}:{id:"addOnLimitUsage.description.approachingLimit.admins",defaultMessage:"{spaceName} has used {spaceUsage} of the {usageLimit} free responses provided to this workspace.",values:{spaceName:O,spaceUsage:(null==e?void 0:e.spaceUsage)??0,usageLimit:(null==e?void 0:e.spaceLimit)??0}});return a()(s.Fragment,{},void 0,function(i){if(i)return a()(I.Z,{size:27,style:{paddingLeft:14,paddingRight:14}});return a()(I.Z,{size:0})}("settings"===i.source),a()(y.Z,{style:w,onClick:()=>function(i,t){f.y(i,{from:"sidebar"===t?"ai_limit_sidebar":"ai_limit_settings",for:(0,v.zt)(),addOnFeature:"ai"})}(n,i.source)},void 0,!F&&a()("div",{style:D.dismissButton},void 0,a()(y.Z,{onClick:()=>function(i,t,e){var n;const{currentUserSettingsStore:a}=N.default.state;if(!a)return;const s={addOnLimitNotifications:x(t,e,null===(n=a.getSettings())||void 0===n?void 0:n.addOnLimitNotifications)};g.createAndCommit({userAction:"addOnLimitNotifications.ai.markNotificationAsDismissed",environment:i,perform:i=>{m.d2({transaction:i,userSettingsStore:a,data:s})}})}(n,i.source,Z),style:D.cancelButton,hoveredStyle:D.hovered},void 0,c.Z.closeSmall(D.closeIcon))),a()("div",{style:W},void 0,c.Z.sparkles({height:14,width:14,marginTop:4}),a()(u.FormattedMessage,{id:"spaceSettings.sidebar.addOnUpgradeLink",defaultMessage:"Notion AI"})),a()("div",{style:k},void 0,a()("div",{style:z},void 0,T),a()(L.Z,{style:{marginTop:12,marginBottom:12},percent:A}),a()("div",{style:C},void 0,a()(u.FormattedMessage,{id:"spaceSettings.sidebar.addOnPurchase.buttonLabel",defaultMessage:"Purchase"})))))}},80554:(i,t,e)=>{e.d(t,{Tq:()=>b,OL:()=>S,MQ:()=>v});var n=e(23174),a=e.n(n),s=e(67294),o=e(480),r=e(81954),d=e(5366),l=e(97880),c=e(54642),u=e(79315),g=e(78291),f=e(38755),m=e(21115);const b=1;async function p(i,t,e){var n;const a=g.default.state.data;if(!a)return!1;const s=m.XZ(i,a),o=u.default.state.currentSpaceStore;if(!(o&&(0,f.rn)(i,o))||!(0,m.GJ)(a))return!1;const r=null===(n=u.default.state.currentSpaceStore)||void 0===n?void 0:n.id;if(!r)return!1;const d=await c.getAIUsageEligibility(i,{spaceId:r});if("failed"===d.type)return!1;const l=d.data,p=l?+l.spaceUsage/l.spaceLimit:0;return(!1!==(null==l?void 0:l.isEligible)||!l.isSalesAssisted)&&(!s&&function(i,t,e){const n=i>=b?"limit_reached":"warning";if("warning"===n){if("settings"===t&&null!=e&&e.disableWarningNotificationInSettings||"sidebar"===t&&null!=e&&e.disableWarningNotificationInSidebar)return!1}else if("limit_reached"===n&&("settings"===t&&null!=e&&e.disableLimitNotificationInSettings||"sidebar"===t&&null!=e&&e.disableLimitNotificationInSidebar))return!1;return i>=.7}(p,t,e))}function S(i,t,e,n){switch(i){case"ai":return{addOnCostItem:a()("div",{},void 0,a()(d.FormattedMessage,{id:"addOnUpgrade.confirmation.costSection.unlimitedAI",defaultMessage:"<bold>Notion AI</bold>",values:{bold:i=>a()("b",{},void 0,i)}})),addOnCostItemWithMembers:a()("span",{style:{whiteSpace:"pre-wrap"}},void 0,a()(d.FormattedMessage,{id:"addOnUpgrade.confirmation.costSection.unlimitedAI.memberInfo",defaultMessage:"({memberCount, plural, one {{memberCount} member} other {{memberCount} members}} x {price} per month{interval, select, month {} other { x 12 months}})",values:{memberCount:t,interval:e,price:n}}))};default:(0,l.t1)(i)}}function v(i){const t=(0,o.O7)(),e=(0,r.VK)((()=>{var i;return null===(i=u.default.state.currentUserSettingsStore)||void 0===i||null===(i=i.getSettings())||void 0===i?void 0:i.addOnLimitNotifications}),[]),[n,a]=(0,s.useState)();return(0,s.useEffect)((()=>{!async function(){const n=await p(t,i,e);a(n)}()}),[t,i,e]),n}}}]);